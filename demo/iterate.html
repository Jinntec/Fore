<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes" name="viewport"/>

    <title>the iterate attribute</title>

<!--    <script src="../node_modules/webcomponentsjs/webcomponents-loader.js"></script>-->

    <link href="../resources/fore.css" rel="stylesheet">
    <link href="../resources/vars.css" rel="stylesheet">
    <link href="../resources/demo.css" rel="stylesheet">

    <style>
        fx-repeatitem{
            display: block;
        }
    </style>
</head>
<body>
<div class="wrapper">

    <h1>The <code>iterate</code> attribute</h1>
    <p>The <code>iterate</code> attribute is allowed on actions foreach of the the <code>iterate</code> finds
    <p>In this example the <code>message</code> action is executed for all of the messages in the instance</p>
    <demo-snippet>
        <template>
            <fx-fore>
                <fx-model>
                    <fx-instance>
                        <data>
                            <message>This is the first message!</message>
                            <message>And the second!</message>
                            <message>And the third!</message>
                        </data>
                    </fx-instance>
                </fx-model>

                <fx-trigger>
                    <button data-cy="counter">Show messages</button>
                    <fx-message iterate="./message">There is a message! {.}</fx-message>
                </fx-trigger>
            </fx-fore>
        </template>
    </demo-snippet>

    <h2>Deleting using iterate</h2>
    <p>The iterate attribute can be useful to 'empty out' a set of nodes.</p>
    <demo-snippet>
        <template>
            <fx-fore>
                <fx-model>
                    <fx-instance>
                      <data>
                        <item selected="true">A</item>
						<item selected="false">B</item>
						<item selected="false">C</item>
                        <item selected="true">D</item>
						<backup>
                          <item selected="true">A</item>
						  <item selected="false">B</item>
						  <item selected="false">C</item>
                          <item selected="true">D</item>
						</backup>
                      </data>
                    </fx-instance>

					<fx-bind ref="./item/@selected" type="boolean"></fx-bind>

                </fx-model>

				<fx-repeat ref="./item">
				  <template>
					<fx-control ref="./@selected" update-event="input" value-prop="checked">
                      <input type="checkbox">{.}</input>
                    </fx-control>
				  </template>
				</fx-repeat>

                <fx-trigger>
                    <button>Remove selected</button>
                    <fx-delete ref="." iterate="instance()/item[@selected='true']"></fx-delete>
                </fx-trigger>
                <fx-trigger>
                    <button>Select all</button>
                    <fx-setvalue ref="@selected" iterate="instance()/item[@selected='false']" value="'true'"></fx-setvalue>
                </fx-trigger>
                <fx-trigger>
                    <button>Select none</button>
                    <fx-setvalue ref="@selected" iterate="instance()/item[@selected='true']" value="'false'"></fx-setvalue>
                </fx-trigger>
                <fx-trigger>
                  <button>Reset</button>
				  <!-- TODO: does not work when the instance gets empty... -->
                    <fx-insert iterate="instance()/backup/item" ref="instance()/item" origin="." at="count(instance()/item)" position="after"></fx-insert>
                </fx-trigger>
            </fx-fore>
        </template>
    </demo-snippet>

</div>
<script type="module" src="./demo.js"></script>
</body>
</html>
