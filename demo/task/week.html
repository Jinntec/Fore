<div>
<!--
    <fx-group id="period" ref="period[@name='thisweek']">
        <h2>THIS WEEK</h2>
        <div class="dateDisplay">
            {dayOfWeekISO('last','wednesday')} - {dayOfWeekISO('next','wednesday')}
        </div>
-->
        <fx-repeat id="r-category" ref="category">
            <template draggable="true" drop-target="r-category">
                <fx-control id="category" class="category" ref="@name">
                    <input placeholder="project or category?">
                    <fx-trigger class="deletebtn">
                        <a href="#">&#x2715;</a>
                        <fx-delete ref=".."></fx-delete>
                    </fx-trigger>
                </fx-control>

                <fx-repeat id="r-task" ref="task[if(@done != instance('vars')/show-completed and instance('vars')/show-completed = 'false') then false() else true()]">
                    <template draggable="true" drop-target="r-task">
                        <!--
                                                        <fx-control class="task-{@done}" id="task" class="task" ref=".">
                                                            <input placeholder="specify the task">
                                                        </fx-control>
                        -->
                        <fx-control ref="@done" value-prop="checked" update-event="input" title="done at {@archived}">
                            <input type="checkbox" class="widget">

                            <details tabindex="0">
                                <summary class="more-actions">...</summary>
                                <section class="details-content">
                                    <fx-control ref="@due" create="create">
                                        <label>Due:
                                            <input type="date" class="widget">
                                        </label>
                                    </fx-control>
                                </section>
                                <fx-call function="close-details()" event="blur"></fx-call>
                            </details>

                            <fx-action event="value-changed">
                                <fx-call if=".='true'" function="playAudio()"></fx-call>
                                <fx-message>archived: {. = 'true'}</fx-message>
                                <fx-setattribute if="string-length(../@archived) = 0 and . = 'true'"
                                        ref=".." name="archived" value="timeStampLocal()"></fx-setattribute>
                            </fx-action>

                        </fx-control>
                        <fx-control class="task-{@done}" id="task" class="task" ref=".">
                            <input placeholder="specify the task" class="widget"></input>
<!--
                            <fx-trigger class="more-actions">
                                <a href="#" tabindex="-1">...</a>
                            </fx-trigger>
                            <fx-trigger class="deletebtn">
                                <a href="#">&#x2715;</a>
                                <fx-delete ref="."></fx-delete>
                            </fx-trigger>
-->
                        </fx-control>
                        <!--
                                                <fx-output class="output due" ref="@due"></fx-output>
                        -->

<!--
                        <fx-trigger class="more-actions">
                            <a href="#">...</a>
                        </fx-trigger>
-->
                        <fx-trigger class="deletebtn">
                            <a href="#">&#x2715;</a>
                            <fx-confirm message="really delete forever?">
                                <fx-delete ref="."></fx-delete>
                            </fx-confirm>
                        </fx-trigger>

                    </template>
                </fx-repeat>
                <fx-trigger class="" title="add card">
                    <a href="#">add task</a>
                    <fx-action>
                        <fx-insert ref="task" origin="instance()/template/task"></fx-insert>
                        <!--                        <fx-setfocus control="category" delay="300"></fx-setfocus>-->
                    </fx-action>
                </fx-trigger>

            </template>
        </fx-repeat>
<!--    <fx-droptarget></fx-droptarget>-->

        <fx-trigger class="" title="add card">
            <a href="#">add category</a>
            <fx-action>
                <fx-insert context="period[@name='thisweek']" ref="category"
                           origin="instance()/template/category"></fx-insert>
                <fx-setfocus control="category" delay="300"></fx-setfocus>
            </fx-action>
        </fx-trigger>

<!--    </fx-group>-->
</div>
