function e(e,t,n,r){const o={op:t,func:n,data:r};return e.push(o),o}function t(e,t){return e}class n{constructor(){this.program=[]}test(t,n){return e(this.program,5,t,void 0===n?null:n)}jump(t){return e(this.program,3,null,t)}record(n,r){return e(this.program,4,void 0===r?t:r,n)}bad(t=1){return e(this.program,1,null,t)}accept(){return e(this.program,0,null,null)}fail(t){return e(this.program,2,t||null,null)}}class r{constructor(e,t,n){this.programLength=e,this.maxFromByPc=t,this.maxSurvivorFromByPc=n}static fromProgram(e){const t=e.length,n=[],o=[];return e.forEach((e=>{n.push(0),o.push(0)})),e.forEach(((e,r)=>{switch(e.op){case 2:if(null===e.func)return;if(r+1>=t)throw new Error("Invalid program: program could run past end");n[r+1]+=1;break;case 1:case 4:if(r+1>=t)throw new Error("Invalid program: program could run past end");n[r+1]+=1;break;case 3:e.data.forEach((e=>{if(e<0||e>=t)throw new Error("Invalid program: program could run past end");n[e]+=1}));break;case 5:if(r+1>=t)throw new Error("Invalid program: program could run past end");o[r+1]+=1;break;case 0:o[r]+=1}})),new r(t,n,o)}static createStub(e){const t=[],n=[];for(let r=0;r<e;++r)t.push(e),n.push(e);return new r(e,t,n)}}class o{constructor(e){this.acceptingTraces=e,this.success=e.length>0}}class i{constructor(e){this.t=0,this.i=0,this.h=new Uint16Array(e),this.l=new Uint8Array(e)}getBadness(e){return this.l[e]}add(e,t){this.l[e]=t>255?255:t;const n=function(e,t,n,r,o){let i=r,a=o;for(;i<a;){const r=i+a>>>1;n<t[e[r]]?a=r:i=r+1}return i}(this.h,this.l,t,this.i,this.t);this.h.copyWithin(n+1,n,this.t),this.h[n]=e,this.t+=1}reschedule(e,t){const n=Math.max(this.l[e],t>255?255:t);if(this.l[e]!==n){const t=this.h.indexOf(e,this.i);if(t<0||t>=this.t)return void(this.l[e]=n);this.h.copyWithin(t,t+1,this.t),this.t-=1,this.add(e,n)}}getNextPc(){return this.i>=this.t?null:this.h[this.i++]}reset(){this.t=0,this.i=0,this.l.fill(0)}}class a{constructor(e){this.o=[];let t=e.length;e.forEach((e=>{this.o.push(e>0?t:-1),t+=e})),this.u=new Uint16Array(t)}clear(){this.u.fill(0,0,this.o.length)}add(e,t){const n=this.u[t],r=this.o[t];this.u[t]+=1,this.u[r+n]=e}has(e){return this.u[e]>0}forEach(e,t){const n=this.u[e],r=this.o[e];for(let e=r;e<r+n;++e)t(this.u[e])}}function s(e,t,n=!1){return null===e?t:Array.isArray(e)?(-1===e.indexOf(t)&&(n&&(e=e.slice()),e.push(t)),e):e===t?e:[e,t]}class u{constructor(e,t){this.prefixes=e,this.record=t}}function c(e,t){let n;if(null===t){if(!Array.isArray(e))return e;n=e}else n=e===u.EMPTY?[]:Array.isArray(e)?e:[e];return new u(n,t)}u.EMPTY=new u([],null);class l{constructor(e){this.p=[],this.v=[];for(let t=0;t<e;++t)this.p.push(0),this.v.push(null)}mergeTraces(e,t,n,r,o,i){let a=!1;return n.forEach(t,(t=>{const n=this.trace(t,r,o,i);var u,c,l;c=n,l=a,e=null===(u=e)?c:null===c?u:Array.isArray(c)?c.reduce(((e,t)=>s(e,t,e===c)),u):s(u,c,l),a=e===n})),e}trace(e,t,n,r){switch(this.p[e]){case 2:return this.v[e];case 1:return null}this.p[e]=1;let o=null;const i=t[e];if(null!==i)o=i;else if(!n.has(e))throw new Error("Trace without source at pc "+e);if(o=this.mergeTraces(o,e,n,t,n,r),null!==o){const t=r[e];null!==t&&(o=c(o,t))}return this.v[e]=o,this.p[e]=2,o}buildSurvivorTraces(e,t,n,r,o){for(let i=0,a=e.length;i<a;++i){if(!n.has(i)){t[i]=null;continue}this.v.fill(null),this.p.fill(0);const a=this.mergeTraces(null,i,n,e,r,o);if(null===a)throw new Error("No non-cyclic paths found to survivor "+i);t[i]=c(a,null)}this.v.fill(null)}}class p{constructor(e){this.g=[],this.k=[],this.m=[],this.A=new a(e.maxFromByPc),this.T=new a(e.maxSurvivorFromByPc),this.S=new l(e.programLength);for(let t=0;t<e.programLength;++t)this.g.push(null),this.k.push(null),this.m.push(null);this.k[0]=u.EMPTY}reset(e){this.A.clear(),this.T.clear(),this.g.fill(null),e&&(this.k.fill(null),this.m.fill(null),this.k[0]=u.EMPTY)}record(e,t){this.g[e]=t}has(e){return this.A.has(e)||null!==this.k[e]}add(e,t){this.A.add(e,t)}hasSurvivor(e){return this.T.has(e)}addSurvivor(e,t){this.T.add(e,t)}buildSurvivorTraces(){const e=this.k;this.S.buildSurvivorTraces(e,this.m,this.T,this.A,this.g),this.k=this.m,this.m=e}getTraces(e){const t=e.reduce(((e,t)=>s(e,this.k[t])),null);return null===t?[]:Array.isArray(t)?t:[t]}}class h{constructor(e){this.I=[],this.N=new i(e.programLength),this.M=new i(e.programLength),this.P=new p(e)}reset(){this.N.reset(),this.N.add(0,0),this.I.length=0,this.P.reset(!0)}getNextThreadPc(){return this.N.getNextPc()}step(e,t,n){const r=this.P.has(t);this.P.add(e,t);const o=this.N.getBadness(e)+n;r?this.N.reschedule(t,o):this.N.add(t,o)}stepToNextGeneration(e,t){const n=this.P.hasSurvivor(t);this.P.addSurvivor(e,t);const r=this.N.getBadness(e);n?this.M.reschedule(t,r):this.M.add(t,r)}accept(e){this.I.push(e),this.P.addSurvivor(e,e)}fail(e){}record(e,t){this.P.record(e,t)}nextGeneration(){this.P.buildSurvivorTraces(),this.P.reset(!1);const e=this.N;e.reset(),this.N=this.M,this.M=e}getAcceptingTraces(){return this.P.getTraces(this.I)}}class d{constructor(e){this.U=[],this.G=e,this.V=r.fromProgram(e),this.U.push(new h(this.V))}execute(e,t){const n=this.U.pop()||new h(this.V);n.reset();const r=e.length;let i,a=-1;do{let o=n.getNextThreadPc();if(null===o)break;for(++a,i=a>=r?null:e[a];null!==o;){const e=this.G[o];switch(e.op){case 0:null===i?n.accept(o):n.fail(o);break;case 2:{const r=e.func;if(null===r||r(t)){n.fail(o);break}n.step(o,o+1,0);break}case 1:n.step(o,o+1,e.data);break;case 5:if(null===i){n.fail(o);break}if(!(0,e.func)(i,e.data,t)){n.fail(o);break}n.stepToNextGeneration(o,o+1);break;case 3:{const t=e.data,r=t.length;if(0===r){n.fail(o);break}for(let e=0;e<r;++e)n.step(o,t[e],0);break}case 4:{const r=(0,e.func)(e.data,a,t);null!=r&&n.record(o,r),n.step(o,o+1,0);break}}o=n.getNextThreadPc()}n.nextGeneration()}while(null!==i);const s=new o(n.getAcceptingTraces());return n.reset(),this.U.push(n),s}}function f(e){return t=>t===e}function m(e,t){if(null===e||null===t)throw new Error("unescaped hyphen may not be used as a range endpoint");if(t<e)throw new Error("character range is in the wrong order");return n=>e<=n&&n<=t}function g(e){return!0}function y(){return!1}function v(e,t){return n=>e(n)||t(n)}function w(e,t){switch(t.kind){case"predicate":return void e.test(t.value);case"regexp":return void x(e,t.value,!1)}}function x(e,t,n){const r=e.program.length,o=e.jump([]);n&&(o.data.push(e.program.length),e.test((()=>!0)),e.jump([r]));const i=[];if(t.forEach((t=>{o.data.push(e.program.length),function(e,t){t.forEach((t=>{!function(e,t){const[n,{min:r,max:o}]=t;if(null!==o){for(let t=0;t<r;++t)w(e,n);for(let t=r;t<o;++t){const t=e.jump([]);t.data.push(e.program.length),w(e,n),t.data.push(e.program.length)}}else if(r>0){for(let t=0;t<r-1;++t)w(e,n);const t=e.program.length;w(e,n),e.jump([t]).data.push(e.program.length)}else{const t=e.program.length,r=e.jump([]);r.data.push(e.program.length),w(e,n),e.jump([t]),r.data.push(e.program.length)}}(e,t)}))}(e,t),i.push(e.jump([]))})),i.forEach((t=>{t.data.push(e.program.length)})),n){const t=e.program.length,n=e.jump([]);n.data.push(e.program.length),e.test((()=>!0)),e.jump([t]),n.data.push(e.program.length)}}function b(e,t){return{success:!0,offset:e,value:t}}function A(e){return b(e,void 0)}function E(e,t,n=!1){return{success:!1,offset:e,expected:t,fatal:n}}function N(e){return(t,n)=>{const r=n+e.length;return t.slice(n,r)===e?b(r,e):E(n,[e])}}function T(e,t){return(n,r)=>{const o=e(n,r);return o.success?b(o.offset,t(o.value)):o}}function B(e,t,n,r){return(o,i)=>{const a=e(o,i);return a.success?t(a.value)?a:E(i,n,r):a}}function I(e,t){return(n,r)=>{let o=null;for(const i of e){const e=i(n,r);if(e.success)return e;if(null===o||e.offset>o.offset?o=e:e.offset===o.offset&&void 0===t&&(o.expected=o.expected.concat(e.expected)),e.fatal)return e}return t=t||(null==o?void 0:o.expected)||[],o&&(o.expected=t),o||E(r,t)}}function C(e){return(t,n)=>{const r=e(t,n);return r.success||r.fatal?r:b(n,null)}}function S(e){return(t,n)=>{let r=[],o=n;for(;;){const n=e(t,o);if(!n.success){if(n.fatal)return n;break}if(r.push(n.value),n.offset===o)break;o=n.offset}return b(o,r)}}function O(e,t,n){return(r,o)=>{const i=e(r,o);if(!i.success)return i;const a=t(r,i.offset);return a.success?b(a.offset,n(i.value,a.value)):a}}function k(e){return O(e,S(e),((e,t)=>[e].concat(t)))}function D(e,t){return e}function R(e,t){return t}function M(e,t){return O(e,t,R)}function U(e,t){return O(e,t,D)}function F(e,t,n,r=!1){return M(e,r?L(U(t,n)):U(t,n))}function G(e,t){return(n,r)=>e(n,r).success?E(r,t):A(r)}function L(e){return(t,n)=>{const r=e(t,n);return r.success?r:E(r.offset,r.expected,!0)}}const P=(e,t)=>e.length===t?A(t):E(t,["end of input"]),H=["Lu","Ll","Lt","Lm","Lo","Mn","Mc","Me","Nd","Nl","No","Pc","Pd","Ps","Pe","Pi","Pf","Po","Zs","Zl","Zp","Sm","Sc","Sk","So","Cc","Cf","Co","Cn"],_={};function j(e){return e.codePointAt(0)}"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("").forEach(((e,t)=>{_[e]=t}));const X=e=>-1===e||-2===e;function q(e){return t=>!X(t)&&!e(t)}function V(e,t){return null===t?e:n=>e(n)&&!t(n)}const $=function(e,t){const n=new Map;let r=0;return["BasicLatin","Latin-1Supplement","LatinExtended-A","LatinExtended-B","IPAExtensions","SpacingModifierLetters","CombiningDiacriticalMarks","GreekandCoptic|Greek","Cyrillic","CyrillicSupplement","Armenian","Hebrew","Arabic","Syriac","ArabicSupplement","Thaana","NKo","Samaritan","Mandaic","SyriacSupplement",null,"ArabicExtended-A","Devanagari","Bengali","Gurmukhi","Gujarati","Oriya","Tamil","Telugu","Kannada","Malayalam","Sinhala","Thai","Lao","Tibetan","Myanmar","Georgian","HangulJamo","Ethiopic","EthiopicSupplement","Cherokee","UnifiedCanadianAboriginalSyllabics","Ogham","Runic","Tagalog","Hanunoo","Buhid","Tagbanwa","Khmer","Mongolian","UnifiedCanadianAboriginalSyllabicsExtended","Limbu","TaiLe","NewTaiLue","KhmerSymbols","Buginese","TaiTham","CombiningDiacriticalMarksExtended","Balinese","Sundanese","Batak","Lepcha","OlChiki","CyrillicExtended-C","GeorgianExtended","SundaneseSupplement","VedicExtensions","PhoneticExtensions","PhoneticExtensionsSupplement","CombiningDiacriticalMarksSupplement","LatinExtendedAdditional","GreekExtended","GeneralPunctuation","SuperscriptsandSubscripts","CurrencySymbols","CombiningDiacriticalMarksforSymbols|CombiningMarksforSymbols","LetterlikeSymbols","NumberForms","Arrows","MathematicalOperators","MiscellaneousTechnical","ControlPictures","OpticalCharacterRecognition","EnclosedAlphanumerics","BoxDrawing","BlockElements","GeometricShapes","MiscellaneousSymbols","Dingbats","MiscellaneousMathematicalSymbols-A","SupplementalArrows-A","BraillePatterns","SupplementalArrows-B","MiscellaneousMathematicalSymbols-B","SupplementalMathematicalOperators","MiscellaneousSymbolsandArrows","Glagolitic","LatinExtended-C","Coptic","GeorgianSupplement","Tifinagh","EthiopicExtended","CyrillicExtended-A","SupplementalPunctuation","CJKRadicalsSupplement","KangxiRadicals",null,"IdeographicDescriptionCharacters","CJKSymbolsandPunctuation","Hiragana","Katakana","Bopomofo","HangulCompatibilityJamo","Kanbun","BopomofoExtended","CJKStrokes","KatakanaPhoneticExtensions","EnclosedCJKLettersandMonths","CJKCompatibility","CJKUnifiedIdeographsExtensionA","YijingHexagramSymbols","CJKUnifiedIdeographs","YiSyllables","YiRadicals","Lisu","Vai","CyrillicExtended-B","Bamum","ModifierToneLetters","LatinExtended-D","SylotiNagri","CommonIndicNumberForms","Phags-pa","Saurashtra","DevanagariExtended","KayahLi","Rejang","HangulJamoExtended-A","Javanese","MyanmarExtended-B","Cham","MyanmarExtended-A","TaiViet","MeeteiMayekExtensions","EthiopicExtended-A","LatinExtended-E","CherokeeSupplement","MeeteiMayek","HangulSyllables","HangulJamoExtended-B","HighSurrogates","HighPrivateUseSurrogates","LowSurrogates","PrivateUseArea|PrivateUse","CJKCompatibilityIdeographs","AlphabeticPresentationForms","ArabicPresentationForms-A","VariationSelectors","VerticalForms","CombiningHalfMarks","CJKCompatibilityForms","SmallFormVariants","ArabicPresentationForms-B","HalfwidthandFullwidthForms","Specials","LinearBSyllabary","LinearBIdeograms","AegeanNumbers","AncientGreekNumbers","AncientSymbols","PhaistosDisc",null,"Lycian","Carian","CopticEpactNumbers","OldItalic","Gothic","OldPermic","Ugaritic","OldPersian",null,"Deseret","Shavian","Osmanya","Osage","Elbasan","CaucasianAlbanian",null,"LinearA",null,"CypriotSyllabary","ImperialAramaic","Palmyrene","Nabataean",null,"Hatran","Phoenician","Lydian",null,"MeroiticHieroglyphs","MeroiticCursive","Kharoshthi","OldSouthArabian","OldNorthArabian",null,"Manichaean","Avestan","InscriptionalParthian","InscriptionalPahlavi","PsalterPahlavi",null,"OldTurkic",null,"OldHungarian","HanifiRohingya",null,"RumiNumeralSymbols",null,"OldSogdian","Sogdian",null,"Elymaic","Brahmi","Kaithi","SoraSompeng","Chakma","Mahajani","Sharada","SinhalaArchaicNumbers","Khojki",null,"Multani","Khudawadi","Grantha",null,"Newa","Tirhuta",null,"Siddham","Modi","MongolianSupplement","Takri",null,"Ahom",null,"Dogra",null,"WarangCiti",null,"Nandinagari","ZanabazarSquare","Soyombo",null,"PauCinHau",null,"Bhaiksuki","Marchen",null,"MasaramGondi","GunjalaGondi",null,"Makasar",null,"TamilSupplement","Cuneiform","CuneiformNumbersandPunctuation","EarlyDynasticCuneiform",null,"EgyptianHieroglyphs","EgyptianHieroglyphFormatControls",null,"AnatolianHieroglyphs",null,"BamumSupplement","Mro",null,"BassaVah","PahawhHmong",null,"Medefaidrin",null,"Miao",null,"IdeographicSymbolsandPunctuation","Tangut","TangutComponents",null,"KanaSupplement","KanaExtended-A","SmallKanaExtension","Nushu",null,"Duployan","ShorthandFormatControls",null,"ByzantineMusicalSymbols","MusicalSymbols","AncientGreekMusicalNotation",null,"MayanNumerals","TaiXuanJingSymbols","CountingRodNumerals",null,"MathematicalAlphanumericSymbols","SuttonSignWriting",null,"GlagoliticSupplement",null,"NyiakengPuachueHmong",null,"Wancho",null,"MendeKikakui",null,"Adlam",null,"IndicSiyaqNumbers",null,"OttomanSiyaqNumbers",null,"ArabicMathematicalAlphabeticSymbols",null,"MahjongTiles","DominoTiles","PlayingCards","EnclosedAlphanumericSupplement","EnclosedIdeographicSupplement","MiscellaneousSymbolsandPictographs","Emoticons","OrnamentalDingbats","TransportandMapSymbols","AlchemicalSymbols","GeometricShapesExtended","SupplementalArrows-C","SupplementalSymbolsandPictographs","ChessSymbols","SymbolsandPictographsExtended-A",null,"CJKUnifiedIdeographsExtensionB",null,"CJKUnifiedIdeographsExtensionC","CJKUnifiedIdeographsExtensionD","CJKUnifiedIdeographsExtensionE","CJKUnifiedIdeographsExtensionF",null,"CJKCompatibilityIdeographsSupplement",null,"Tags",null,"VariationSelectorsSupplement",null,"SupplementaryPrivateUseArea-A|PrivateUse","SupplementaryPrivateUseArea-B|PrivateUse"].forEach(((e,o)=>{const i=t[o];null!==e&&e.split("|").forEach((e=>{const t=n.get(e),o=m(r,r+i-1);n.set(e,t?v(t,o):o)})),r+=i})),n}(0,[128,128,128,208,96,80,112,144,256,48,96,112,256,80,48,64,64,64,32,16,48,96,128,128,128,128,128,128,128,128,128,128,128,128,256,160,96,256,384,32,96,640,32,96,32,32,32,32,128,176,80,80,48,96,32,32,144,80,128,64,64,80,48,16,48,16,48,128,64,64,256,256,112,48,48,48,80,64,112,256,256,64,32,160,128,32,96,256,192,48,16,256,128,128,256,256,96,32,128,48,80,96,32,128,128,224,16,16,64,96,96,48,96,16,32,48,16,256,256,6592,64,20992,1168,64,48,320,96,96,32,224,48,16,64,96,32,48,48,32,96,32,96,32,96,32,48,64,80,64,11184,80,896,128,1024,6400,512,80,688,16,16,16,32,32,144,240,16,128,128,64,80,64,48,128,32,64,32,48,32,48,32,64,32,80,48,48,80,48,64,144,384,128,64,32,32,48,48,32,32,32,64,32,96,96,32,32,32,64,64,32,32,48,80,80,48,128,64,288,32,128,48,64,112,32,128,80,48,80,48,96,32,80,48,48,80,128,128,128,96,160,128,96,32,80,48,64,192,80,80,96,160,96,80,96,16,64,256,112,80,64,96,80,304,32,192,64,1024,128,208,2736,1072,16,4032,640,8576,576,48,96,48,144,688,96,96,160,64,32,6144,768,9472,256,48,64,400,2304,160,16,4944,256,256,80,144,32,96,32,128,1024,688,1360,48,208,80,368,64,1280,224,32,96,784,80,64,80,176,256,256,48,112,96,256,256,768,80,48,128,128,128,256,256,112,144,1280,42720,32,4160,224,5776,7488,3088,544,722400,128,128,240,65040,65536,65536]),Y=function(e){const t=new Map,n="bfUATCYATCPAQATAXATAOATBKJTBXCTBCZPATAQAZANAZADZPAXAQAXAbgUATAYDaATAZAaAGARAXAcAaAZAaAXAMBZADATBZAMAGASAMCTACWXACGDXXADHA3DAAPDAAtCAAFDBCAADCAABCCDBCCABCAABCCDCCAABCAAFCAADDAABCAABCBADCBDBGACADCGDCAEADACAEADACAEADAAPDAARDACAEADAABCBA7DFCAABCBDBABCCAJjDBAAGADaFRZDFLZNFEZGFAZAFAZQnvBAAADFAZACADABBFADCTACABDZBCATACCBACABACAABCQBACIDiCADBCCDCAXDDCADAXAABCBDBCyDvAhaAHEJBA1CAANDAgfBAABAClBBFATFDoTAOABBaBYABAHsOAHATAHBTAHBTAHABHGaBDGDTBBKcFXCTBYATBaBHKTAcABATBGfFAGJHUKJTDGBHAmiBAATAGAHGcAaAHFFBHBaAHDGBKJGCaBGATNBAcAGAHAGdHaBBmYBAAHKGABNKJGgHIFBaATCFABBHAYBGVHDFAHIFAHCFAHEBBTOBAGYHCBBTABAGKB0GUBAGHBUHOcAHfIAG1HAIAHAGAICHHIDHAIBGAHGGJHBTBKJTAFAGOHAIBBAGHBBGBBBGVBAGGBAGABCGDBBHAGAICHDBBIBBBIBHAGABHIABDGBBAGCHBBBKJGBYBMFaAYAGATAHABBHBIABAGFBDGBBBGVBAGGBAGBBAGBBAGBBBHABAICHBBDHBBBHCBCHABGGDBAGABGKJHBGCHATABJHBIABAGIBAGCBAGVBAGGBAGBBAGEBBHAGAICHEBAHBIABAIBHABBGABOGBHBBBKJTAYABGGAHFBAHAIBBAGHBBGBBBGVBAGGBAGBBAGEBBHAGAIAHAIAHDBBIBBBIBHABHHAIABDGBBAGCHBBBKJaAGAMFBJHAGABAGFBCGCBAGDBCGBBAGABAGBBCGBBCGCBCGLBDIBHAIBBCICBAICHABBGABFIABNKJMCaFYAaABEHAICHAGHBAGCBAGWBAGPBCGAHCIDBAHCBAHDBGHBBAGCBEGBHBBBKJBGTAMGaAGAHAIBTAGHBAGCBAGWBAGJBAGEBBHAGAIAHAIEBAHAIBBAIBHBBGIBBGGABAGBHBBBKJBAGBBMHBIBBAGHBAGCBAGoHBGAICHDBAICBAICHAGAaABDGCIAMGGCHBBBKJMIaAGFBBIBBAGRBCGXBAGIBAGABBGGBCHABDICHCBAHABAIHBFKJBBIBTABLGvHAGBHGBDYAGFFAHHTAKJTBBkGBBAGABAGEBAGXBAGABAGJHAGBHIGABBGEBAFABAHFBBKJBBGDBfGAaCTOaATAaCHBaFKJMJaAHAaAHAaAHAPAQAPAQAIBGHBAGjBDHNIAHETAHBGEHKBAHjBAaHHAaFBAaBTEaDTBBkGqIBHDIAHFIAHBIBHBGAKJTFGFIBHBGDHCGAICGBIGGCHDGMHAIBHBIFHAGAIAKJICHAaBClBACABECABBDqTAFADCmIFAABAGDBBGGBAGABAGDBBGoBAGDBBGgBAGDBBGGBAGABAGDBBGOBAG4BAGDBBmCBAABBHCTIMTBCGPaJBFiVBAABBDFBBOAmrJAAaATAGQUAGZPAQABCmKBAATCLCGHBGGMBAGDHCBKGRHCTBBIGRHBBLGMBAGCBAHBBLGzHBIAHGIHHAIBHKTCFATCYAGAHABBKJBFMJBFTFOATDHCcABAKJBFGiFAG0BGGEHBGhHAGABEmFBAABJGeBAHCIDHBICBDIBHAIFHCBDaABCTBKJGdBBGEBKGrBDGZBFKJMABCahGWHBIBHABBTBG0IAHAIAHGBAHAIAHAIBHHIFHJBBHAKJBFKJBFTGFATFBBHNJAhABAAHDIAGuHAIAHEIAHAIEHAIBGGBDKJTGaJHIaIBCHBIAGdIAHDIBHBIAHCGBKJGrHAIAHBICHAIAHCIBBHTDGjIHHHIBHBBCTEKJBCGCKJGdFFTBDIBGCqBBCCTHBHHCTAHMIAHGGDHAGFHAGBIAHBGABEDrF+DMFADhFkH5BAHEgVCAADHghBAADHCHDFBBCFBBDHCHDHCHDFBBCFBBDHBACABACABACABACADHCHDNBBDHEHDHEHDHEHDEBADBCDEAZADAZCDCBADBCDEAZCDDBBDBCDBAZCDHCEZCBBDCBADBCDEAZBBAUKcEOFTBRASAPARBSAPARATHVAWAcEUATIRASATDNBTCXAPAQATKXATANATJUAcEBAcJMAFABBMFXCPAQAFAMJXCPAQABAFMBCYfBPHMJDHAJCHLBOaBCAaDCAaBDACCDBCCDAaACAaBXACEaFCAaACAaACAaACDaADACDDAGDDAaBDBCBXECADDaAXAaBDAaAMPLiCADALDMAaBBDXEaEXBaDXAaBXAaBXAaGXAaeXBaBXAaAXAae3LEAAaHPAQAPAQAaTXBaGPAQA6QBAAXAadXYanXF6EBAABYaKBUM76NBAAMV62CAAXAaIXAa1XH6uBAAXA63DAAPAQAPAQAPAQAPAQAPAQAPAQAPAQAMdarXEPAQAXePAQAPAQAPAQAPAQAPAQAXP6/DAA3CCAAPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQAX+PAQAPAQAXfPAQA3BEAAavXUaBXFamBBafBB6nBAACuBADuBAABCCDBAFCCADDACADFFBCBgjBAADAaFADHCCADABETDMATBDlBADABEDABBG3BGFATABNHAGWBIGGBAGGBAGGBAGGBAGGBAGGBAGGBAGGBAHfTBRASARASATCRASATARASATIOATBOATARASATBRASAPAQAPAQAPAQAPAQATEFATJOBTDOATAPATMBvaZBA6YBAABL6VDAABZaLBDUATCaAFAGALAPAQAPAQAPAQAPAQAPAQAaBPAQAPAQAPAQAPAQAOAPAQBaALIHDIBOAFEaBLCFAGATAaBBAmVBAABBHBZBFBGAOAmZBAATAFCGABEGqBAmdBAABAaBMDaJGaBEajBLGPaeBAMJadMHaAMOafMJamMO6/EAAm1mBABJa/mvHFABPGUFAm2RAABCa2BIGnFFTBmLEAAFATCGPKJGBBTAtGAHAJCTAHJTAFAAbFBHBmFBAALJHBTFBHZWFIZBANDBA9FADHADCAAJFAZBADGAADDBATCDABCDALBBABCCBvGAFBDAGGHAGCHAGDHAGWIBHBIAaDBDMFaBYAaABFGzTDBHIBGxIPHBBHTBKJBFHRGFTCGATAGBHAKJGbHHTBGWHKIBBKTAGcBCHCIAGuHAIBHDIBHBICTMBAFAKJBDTBGEHAFAGIKJGEBAGoHFIBHBIBHBBIGCHAGHHAIABBKJBBTDGPFAGFaCGAIAHAIAGxHAGAHCGBHBGEHBGAHAGABXGBFATBGKIAHBIBTBGAFBIAHABJGFBBGFBBGFBIGGBAGGBADqZAFDDHBHjPBAAGiIBHAIBHAIBTAIAHABBKJBFmjuCABLGWBDGwhDgAA9/jBAmtFAABBmpBAABlDGBLDEBEGAHAGJXAGMBAGEBAGABAGBBAGBBAmrBAAZPBQmqFAAQAPABPG/BBG1BnGLYAaABBHPTGPAQATABFHPTAOBNBPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQATBPAQATDNCTCBATDOAPAQAPAQAPAQATCXAOAXCBATAYATBBDGEBAmGCAABBcABATCYATCPAQATAXATAOATBKJTBXCTBCZPATAQAZANAZADZPAXAQAXAPAQATAPAQATBGJFAGsFBGeBCGFBBGFBBGFBBGCBCYBXAZAaAYBBAaAXDaBBJcCaBBBGLBAGZBAGSBAGBBAGOBBGNBhm6BAABETCBDMsBCaIL0MDaQMBaCBAaLBDaABuasHAhBCAAGcBCGwBOHAMaBDGfMDBIGTLAGHLABEGlHEBEGdBATAGjBDGHTALEBpCnDnmNBAABBKJBFCjBDDjBDGnBHGzBKTAhPCAAm2EAABIGVBJGHhXCAAGFBBGABAGrBAGBBCGABBGWBATAMHGWaBMGGeBHMIBvGSBAGBBEMEGVMFBCTAGZBETAB/G3BDMBGBMPBBMtGAHCBAHBBEHDGDBAGCBAGcBBHCBDHAMIBGTIBGGcMBTAGcMCBfGHaAGbHBBDMETGBIG1BCTGGVBBMHGSBEMHGRBGTDBLMGhPBAAmIBAAB2CyBMDyBGMFGjHDBHKJhlEAAMehACAAGcMJGABHGVHKMDTEhFCAAGWBIIAHAIAG0HOTGBDMTKJBOHCIAGsICHDIBHBTBcATDBKcABBGYBGKJBFHCGjHEIAHHBAKJTDGAIBBIGiHATBGABIHBIAGvICHIIBGDTDHDTABBKJGATAGATCBAMTBKGRBAGYICHCIBHAIAHBTFHAhABAAGGBAGABAGDBAGOBAGJTABFGuHAICHHBEKJBFHBIBBAGHBBGBBBGVBAGGBAGBBAGEBAHBGAIBHAIDBBIBBBICBBGABFIABEGEIBBBHGBCHEhKCAAG0ICHHIBHCIAHAGDTEKJBATABATAHAGABfGvICHFIAHAIDHBIAHBGBTAGABHKJhlCAAGuICHDBBIDHBIAHBTWGDHBBhGvICHHIBHAIAHBTCGABKKJBFTMBSGqHAIAHAIBHFIAHAGABGKJB1GaBBHCIBHDIAHEBDKJMBTCaAh/CAAGrICHIIAHBTAhjBAACfDfKJMIBLGAhfCAAGHBBGmICHDBBHBIDHAGATAGAIABaGAHJGnHFIAGAHDTHHABHGAHFIBHCGtHMIAHBTCGATEBcG4hGEAAGIBAGkIAHGBAHFIAHAGATEBJKJMSBCTBGdBBHVBAIAHGIAHBIAHBhIBAAGGBAGBBAGlHFBCHABAHBBAHGGAHABHKJBFGFBAGBBAGfIEBAHBBAIBHAIAHAGABGKJh1EAAGSHBIBTBhGDAAMUaHYDaQBMTAmZOAAhlBAAruBAABATEBKmDDAAh7qAAmuQAABAcIhG/AAmGJAAh4GCAm4IAABGGeBAKJBDTBhfBAAGdBBHETABJGvHGTEaDFDTAaABJKJBAMGBAGUBEGShvKAACfDfMWTDhkBAAmKBAABDHAGAI2BGHDFMB/FBTAFABbm3fBABHmyLAAhMUCAmeEAABwGCBQGDBHmLGAAhDkAAmqBAABEGMBCGIBGGJBBaAHBTAcDhbNBA61DAABJamBBa7IBHCaCIFcHHHaBHGadHDa6BW6BBAAHCaAhZCAAMTBL6WBAABIMYhGCAACZDZCZDGBADRCZDZCABACBBBCABBCBBBCDBACHDDBADABADGBADKCZDZCBBACDBBCHBACGBADZCBBACDBACEBACABCCGBADZCZDZCZDZCZDZCZDZCZDZCZDbBBCYXADYXADFCYXADYXADFCYXADYXADFCYXADYXADFCYXADYXADFCADABBKx6/HAAH2aDHxaHHAaNHAaBTEBOHEBAHOhPVAAHGBAHQBBHGBAHBBAHEhUDAAGsBCHGFGBBKJBDGAaAhvFAAGrHDKJBEYAh/TAAmEDAABBMIHGBoChDhHGFABDKJBDTBhQMAAM6aAMCYAMDhLBAAMsaAMOhBDAAGDBAGaBAGBBAGABBGABAGJBAGDBAGABAGABFGABDGABAGABAGABAGCBAGBBAGABBGABAGABAGABAGABAGABAGBBAGABBGDBAGGBAGDBAGDBAGABAGJBAGQBEGCBAGEBAGQBzXBhNEAAarBD6jBAABLaOBBaOBAaOBAakBJMMBC6cBAABCa8B4acBMarBDaIBGaBBNaFhZCAA66DAAZE6VLAABJaMBCaKBE6zBAABL6YBAABGaLBTaLBDa3BHaJBFanBHadhRBAAaLBA6kBAABAaDBCaoBBaFBCacBB6GCAABLaNBBaDBDaCBEaCBMaFhpVAAmWbKABom0ABABKmdDAABBmBaBABNmw0BAhewAAmdIAAhiXwCcABd8fBAAh/BAAnvDAAhP4PA99/PABB99/PA".split(""),r=H.map((()=>[]));let o=0,i=0;for(;i<n.length;){const e=_[n[i]],t=(31&e)-2;let a=1+_[n[i+1]];switch(32&e?(a+=_[n[i+2]]<<6,a+=_[n[i+3]]<<12,a+=_[n[i+4]]<<18,i+=5):i+=2,t){case-2:{let e=0;for(let t=o;t<o+a;++t)r[e].push(f(t)),e=(e+1)%2;break}case-1:break;default:{const e=r[t];1===a?e.push(f(o)):e.push(m(o,o+a-1));break}}o+=a}const a=new Map;return H.forEach(((e,n)=>{const o=r[n].reduce(v,y);t.set(e,o);const i=e.charAt(0),s=a.get(i)||[];a.set(i,s),s.push(o)})),a.forEach(((e,n)=>{t.set(n,e.reduce(v,y))})),t}();function z(e){return 32===e||9===e||10===e||13===e}const Q=[f(j(":")),m(j("A"),j("Z")),f(j("_")),m(j("a"),j("z")),m(192,214),m(216,246),m(192,214),m(216,246),m(248,767),m(880,893),m(895,8191),m(8204,8205),m(8304,8591),m(11264,12271),m(12289,55295),m(63744,64975),m(65008,65533),m(65536,983039)].reduce(v),J=[Q,f(j("-")),f(j(".")),m(j("0"),j("9")),f(183),m(768,879),m(8255,8256)].reduce(v),W=Y.get("Nd"),K=q(W),Z=V(m(0,1114111),[Y.get("P"),Y.get("Z"),Y.get("C")].reduce(v)),ee=q(Z);function te(e){return 10!==e&&13!==e&&!X(e)}const ne={s:z,S:q(z),i:Q,I:q(Q),c:J,C:q(J),d:W,D:K,w:Z,W:ee},re=N("*"),oe=N("\\"),ie=N("{"),ae=N("}"),se=N("["),ue=N("]"),ce=N("^"),le=N("$"),pe=N(","),he=N("-"),de=N("("),fe=N(")"),me=N("."),ge=N("|"),ye=N("+"),ve=N("?"),we=N("-["),xe=j("0");function be(e){return[...e].map((e=>e.codePointAt(0)))}var Ae=Object.freeze({__proto__:null,compile:function(e,t={language:"xsd"}){const r=function(e){function t(e){return new Set(e.split("").map((e=>j(e))))}function n(e,t){const n=e.codePointAt(t);return void 0===n?E(t,["any character"]):b(t+String.fromCodePoint(n).length,n)}const r="xpath"===e.language?M(oe,I([T(N("n"),(()=>10)),T(N("r"),(()=>13)),T(N("t"),(()=>9)),T(I([oe,ge,me,he,ce,ve,re,ye,ie,ae,le,de,fe,se,ue]),(e=>j(e)))])):M(oe,I([T(N("n"),(()=>10)),T(N("r"),(()=>13)),T(N("t"),(()=>9)),T(I([oe,ge,me,he,ce,ve,re,ye,ie,ae,de,fe,se,ue]),(e=>j(e)))]));function o(e,r){const o=t(r);return O(N(e),C(B(n,(e=>o.has(e)),r.split(""))),((e,t)=>function(e){const t=Y.get(e);if(null==t)throw new Error(e+" is not a valid unicode category");return t}(null===t?e:e+String.fromCodePoint(t))))}const i=I([o("L","ultmo"),o("M","nce"),o("N","dlo"),o("P","cdseifo"),o("Z","slp"),o("S","mcko"),o("C","cfon")]),a=[m(j("a"),j("z")),m(j("A"),j("Z")),m(j("0"),j("9")),f(45)].reduce(v),s=I([i,T(M(N("Is"),function(e){return(t,n)=>{const r=e(t,n);return r.success?b(r.offset,t.slice(n,r.offset)):r}}(k(B(n,a,["block identifier"])))),(t=>function(e,t){const n=$.get(e);if(void 0===n){if(t)return g;throw new Error(`The unicode block identifier "${e}" is not known.`)}return n}(t,"xpath"!==e.language)))]),u=F(N("\\p{"),s,ae,!0),c=T(F(N("\\P{"),s,ae,!0),q),l=M(oe,T(I("sSiIcCdDwW".split("").map((e=>N(e)))),(e=>ne[e]))),p=T(me,(()=>te)),h=I([l,u,c]),d=t("\\[]"),y=I([r,B(n,(e=>!d.has(e)),["unescaped character"])]),w=I([T(he,(()=>null)),y]),x=O(w,M(he,w),m);function A(e,t){return[e].concat(t||[])}const R=T(function(e){return(t,n)=>{const r=e(t,n);return r.success?b(n,r.value):r}}(I([ue,we])),(()=>null)),H=j("-"),_=I([T(U(U(he,G(se,["not ["])),R),(()=>H)),M(G(he,["not -"]),y)]),X=I([O(T(_,f),I([function(e,t){return X(e,t)},R]),A),O(I([x,h]),I([Q,R]),A)]),z=I([O(T(y,f),I([X,R]),A),O(I([x,h]),I([Q,R]),A)]);function Q(e,t){return z(e,t)}const J=T(z,(e=>e.reduce(v))),W=T(M(ce,J),q),K=O(I([M(G(ce,["not ^"]),J),W]),C(M(he,(function(e,t){return Z(e,t)}))),V),Z=F(se,K,ue,!0),ee="xpath"===e.language?I([T(r,f),h,Z,p,T(ce,(()=>e=>-1===e)),T(le,(()=>e=>-2===e))]):I([T(r,f),h,Z,p]),be="xpath"===e.language?t(".\\?*+{}()|^$[]"):t(".\\?*+{}()|[]"),Ae=B(n,(e=>!be.has(e)),["NormalChar"]),Ee=T(M(oe,O(T(B(n,m(j("1"),j("9")),["digit"]),(e=>e-xe)),S(T(B(n,m(xe,j("9")),["digit"]),(e=>e-xe))),((e,t)=>{t.reduce(((e,t)=>10*e+t),e)}))),(e=>{throw new Error("Backreferences in XPath patterns are not yet implemented.")})),Ne="xpath"===e.language?I([T(Ae,(e=>({kind:"predicate",value:f(e)}))),T(ee,(e=>({kind:"predicate",value:e}))),T(F(de,M(C(N("?:")),Oe),fe,!0),(e=>({kind:"regexp",value:e}))),Ee]):I([T(Ae,(e=>({kind:"predicate",value:f(e)}))),T(ee,(e=>({kind:"predicate",value:e}))),T(F(de,Oe,fe,!0),(e=>({kind:"regexp",value:e})))]),Te=T(k(T(B(n,m(xe,j("9")),["digit"]),(e=>e-xe))),(e=>e.reduce(((e,t)=>10*e+t)))),Be=I([O(Te,M(pe,Te),((e,t)=>{if(t<e)throw new Error("quantifier range is in the wrong order");return{min:e,max:t}})),O(Te,pe,(e=>({min:e,max:null}))),T(Te,(e=>({min:e,max:e})))]),Ie="xpath"===e.language?O(I([T(ve,(()=>({min:0,max:1}))),T(re,(()=>({min:0,max:null}))),T(ye,(()=>({min:1,max:null}))),F(ie,Be,ae,!0)]),C(ve),((e,t)=>e)):I([T(ve,(()=>({min:0,max:1}))),T(re,(()=>({min:0,max:null}))),T(ye,(()=>({min:1,max:null}))),F(ie,Be,ae,!0)]),Ce=S(O(Ne,T(C(Ie),(e=>null===e?{min:1,max:1}:e)),((e,t)=>[e,t]))),Se=O(Ce,S(M(ge,L(Ce))),((e,t)=>[e].concat(t)));function Oe(e,t){return Se(e,t)}const ke=function(e){return O(e,P,D)}(Se);return function(e){let t;try{t=ke(e,0)}catch(t){throw new Error(`Error parsing pattern "${e}": ${t instanceof Error?t.message:t}`)}return t.success?t.value:function(e,t,n){const r=n.map((e=>`"${e}"`));throw new Error(`Error parsing pattern "${e}" at offset ${t}: expected ${r.length>1?"one of "+r.join(", "):r[0]} but found "${e.slice(t,t+1)}"`)}(e,t.offset,t.expected)}}(t)(e),o=function(e){const t=new n;return e(t),new d(t.program)}((e=>{x(e,r,"xpath"===t.language),e.accept()}));return function(e){const n="xpath"===t.language?[-1,...be(e),-2]:be(e);return o.execute(n).success}}});function Ee(e,t){return{success:!0,offset:e,value:t}}function Ne(e){return Ee(e,void 0)}function Te(e,t,n=!1){return{success:!1,offset:e,expected:t,fatal:n}}function Be(e){return e>65535?2:1}function Ie(e,t){return(n,r)=>{const o=n.codePointAt(r);return void 0!==o&&e(o)?Ne(r+Be(o)):Te(r,t)}}function Ce(e,t){return(n,r)=>{const o=e(n,r);return o.success?Ee(o.offset,t(o.value)):o}}function Se(e){return(t,n)=>{let r=[],o=n;for(;;){const n=e(t,o);if(!n.success){if(n.fatal)return n;break}if(r.push(n.value),n.offset===o)break;o=n.offset}return Ee(o,r)}}function Oe(e){return(t,n)=>{let r=n;for(;;){const n=e(t,r);if(!n.success){if(n.fatal)return n;break}if(n.offset===r)break;r=n.offset}return Ne(r)}}function ke(e,t,n){return(r,o)=>{const i=e(r,o);if(!i.success)return i;const a=t(r,i.offset);return a.success?Ee(a.offset,n(i.value,a.value)):a}}function De(e,t){return e}function Re(e,t){return t}function Me(e,t){return ke(e,t,Re)}function Ue(e,t){return ke(e,t,De)}function Fe(e,t){return(n,r)=>e(n,r).success?Te(r,t):Ne(r)}function Ge(e){return(t,n)=>{const r=e(t,n);return r.success?r:Te(r.offset,r.expected,!0)}}const Le=(e,t)=>e.length===t?Ne(t):Te(t,["end of input"]);function Pe(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return[t,n.value]}var He=Object.freeze({__proto__:null,codepoint:Ie,codepoints:function(e,t){return(n,r)=>{const o=r;for(;;){const t=n.codePointAt(r);if(void 0===t)break;if(!e(t))break;r+=t>65535?2:1}return void 0!==t&&r===o?Te(r,t):Ne(r)}},collect:Pe,complete:function(e){return ke(e,Le,De)},consume:function(e){return Ce(e,(()=>{}))},cut:Ge,delimited:function(e,t,n,r=!1){return Me(e,r?Ge(Ue(t,n)):Ue(t,n))},dispatch:function(e,t,n=0,r=[]){return(o,i)=>{const a=o.codePointAt(i+n);if(void 0===a)return Te(i,r);const s=e[a];return void 0===s?void 0===t?Te(i,r):t(o,i):s(o,i)}},end:Le,error:Te,except:function(e,t,n){return Me(Fe(t,n),e)},filter:function(e,t,n,r){return(o,i)=>{const a=e(o,i);return a.success?t(a.value)?a:Te(i,n,r):a}},filterUndefined:function(e){return Ce(e,(e=>e.filter((e=>void 0!==e))))},first:De,followed:Ue,map:Ce,not:Fe,ok:Ne,okWithValue:Ee,optional:function(e){return(t,n)=>{const r=e(t,n);return r.success||r.fatal?r:Ee(n,null)}},or:function(e,t){return(n,r)=>{let o=null;for(const i of e){const e=i(n,r);if(e.success)return e;if(null===o||e.offset>o.offset?o=e:e.offset===o.offset&&void 0===t&&(o.expected=o.expected.concat(e.expected)),e.fatal)return e}return t=t||(null==o?void 0:o.expected)||[],o&&(o.expected=t),o||Te(r,t)}},peek:function(e){return(t,n)=>{const r=e(t,n);return r.success?Ee(n,r.value):r}},plus:function(e){return ke(e,Se(e),((e,t)=>[e].concat(t)))},plusConsumed:function(e){return ke(e,Oe(e),Re)},preceded:Me,range:function(e,t,n){return Ie((n=>e<=n&&n<=t),n||[`${String.fromCodePoint(e)}-${String.fromCodePoint(t)}`])},recognize:function(e){return(t,n)=>{const r=e(t,n);return r.success?Ee(r.offset,t.slice(n,r.offset)):r}},second:Re,sequence:function(...e){return(t,n)=>{const r=[];for(const o of e){const e=o(t,n);if(!e.success)return e;n=e.offset,r.push(e.value)}return Ee(n,r)}},sequenceConsumed:function(...e){return(t,n)=>{for(const r of e){const e=r(t,n);if(!e.success)return e;n=e.offset}return Ne(n)}},skipChars:function(e){return(t,n)=>{let r=e;for(;r>0;){const e=t.codePointAt(n);if(void 0===e)return Te(n,["any character"]);n+=Be(e),r-=1}return Ne(n)}},star:Se,starConsumed:Oe,start:(e,t)=>0===t?Ne(t):Te(t,["start of input"]),streaming:function(e){return function*(t,n){const r=e(t,n);return r.success&&(yield r.value),r}},streamingComplete:function(e){return function*(t,n){const r=yield*e(t,n);return r.success?Le(t,r.offset):r}},streamingFilterUndefined:function(e){return function*(t,n){const r=e(t,n);let o=r.next();for(;!o.done;){const e=o.value;void 0!==e&&(yield e),o=r.next()}return o.value}},streamingOptional:function(e){return function*(t,n){const[r,o]=Pe(e(t,n));return o.success?(yield*r,o):o.fatal?o:Ne(n)}},streamingStar:function(e){return function*(t,n){for(;;){const[r,o]=Pe(e(t,n));if(!o.success)return o.fatal?o:Ne(n);if(yield*r,n===o.offset)return Ne(n);n=o.offset}}},streamingThen:function(e,t){return function*(n,r){const o=yield*e(n,r);return o.success?yield*t(n,o.offset):o}},then:ke,token:function(e){return(t,n)=>{const r=n+e.length;return t.slice(n,r)===e?Ee(r,e):Te(n,[e])}}});const _e=function(e,t){const n={};var r;function o(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var i="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var a=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function s(e,t){if(t)e:{var n=a;e=e.split(".");for(var r=0;r<e.length-1;r++){var o=e[r];if(!(o in n))break e;n=n[o]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&i(n,e,{configurable:!0,writable:!0,value:t})}}function u(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function c(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:o(e)}}function l(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function p(e){return e instanceof Array?e:l(c(e))}s("Symbol",(function(e){function t(e,t){this.h=e,i(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.h};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(o){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(o||"")+"_"+r++,o)}})),s("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var r=a[t[n]];"function"==typeof r&&"function"!=typeof r.prototype[e]&&i(r.prototype,e,{configurable:!0,writable:!0,value:function(){return u(o(this))}})}return e})),s("Symbol.asyncIterator",(function(e){return e||Symbol("Symbol.asyncIterator")}));var h,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)h=Object.setPrototypeOf;else{var f;e:{var m={};try{m.__proto__={a:!0},f=m.a;break e}catch(e){}f=!1}h=f?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var g=h;function y(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,g)g(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.Pc=t.prototype}function v(){this.j=!1,this.s=null,this.u=void 0,this.h=1,this.ha=0,this.A=null}function w(e){if(e.j)throw new TypeError("Generator is already running");e.j=!0}function x(e,t){e.A={Ac:t,Cc:!0},e.h=e.ha}function b(e){this.h=new v,this.s=e}function A(e,t,n,r){try{var o=t.call(e.h.s,n);if(!(o instanceof Object))throw new TypeError("Iterator result "+o+" is not an object");if(!o.done)return e.h.j=!1,o;var i=o.value}catch(t){return e.h.s=null,x(e.h,t),E(e)}return e.h.s=null,r.call(e.h,i),E(e)}function E(e){for(;e.h.h;)try{var t=e.s(e.h);if(t)return e.h.j=!1,{value:t.value,done:!1}}catch(t){e.h.u=void 0,x(e.h,t)}if(e.h.j=!1,e.h.A){if(t=e.h.A,e.h.A=null,t.Cc)throw t.Ac;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function N(e){this.next=function(t){return w(e.h),e.h.s?t=A(e,e.h.s.next,t,e.h.O):(e.h.O(t),t=E(e)),t},this.throw=function(t){return w(e.h),e.h.s?t=A(e,e.h.s.throw,t,e.h.O):(x(e.h,t),t=E(e)),t},this.return=function(t){return function(e,t){w(e.h);var n=e.h.s;return n?A(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.h.return):(e.h.return(t),E(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}v.prototype.O=function(e){this.u=e},v.prototype.return=function(e){this.A={return:e},this.h=this.ha},s("Promise",(function(e){function t(e){this.s=0,this.A=void 0,this.h=[],this.ha=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.h=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.s=function(e){if(null==this.h){this.h=[];var t=this;this.A((function(){t.u()}))}this.h.push(e)};var o=a.setTimeout;n.prototype.A=function(e){o(e,0)},n.prototype.u=function(){for(;this.h&&this.h.length;){var e=this.h;this.h=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.h=null},n.prototype.j=function(e){this.A((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.pa),reject:e(this.u)}},t.prototype.pa=function(e){if(e===this)this.u(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.xa(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.ka(e):this.O(e)}},t.prototype.ka=function(e){var t=void 0;try{t=e.then}catch(e){return void this.u(e)}"function"==typeof t?this.ob(t,e):this.O(e)},t.prototype.u=function(e){this.B(2,e)},t.prototype.O=function(e){this.B(1,e)},t.prototype.B=function(e,t){if(0!=this.s)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.s);this.s=e,this.A=t,2===this.s&&this.$a(),this.J()},t.prototype.$a=function(){var e=this;o((function(){if(e.T()){var t=a.console;void 0!==t&&t.error(e.A)}}),1)},t.prototype.T=function(){if(this.ha)return!1;var e=a.CustomEvent,t=a.Event,n=a.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=a.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.A,n(e))},t.prototype.J=function(){if(null!=this.h){for(var e=0;e<this.h.length;++e)i.s(this.h[e]);this.h=null}};var i=new n;return t.prototype.xa=function(e){var t=this.j();e.pb(t.resolve,t.reject)},t.prototype.ob=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{o(e(t))}catch(e){i(e)}}:t}var o,i,a=new t((function(e,t){o=e,i=t}));return this.pb(r(e,o),r(n,i)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.pb=function(e,t){function n(){switch(r.s){case 1:e(r.A);break;case 2:t(r.A);break;default:throw Error("Unexpected state: "+r.s)}}var r=this;null==this.h?i.s(n):this.h.push(n),this.ha=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var o=c(e),i=o.next();!i.done;i=o.next())r(i.value).pb(t,n)}))},t.all=function(e){var n=c(e),o=n.next();return o.done?r([]):new t((function(e,t){function i(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(o.value).pb(i(a.length-1),t),o=n.next()}while(!o.done)}))},t}));var B="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var o in r)T(r,o)&&(e[o]=r[o])}return e};function I(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}function C(e,t){return e=void 0!==e?String(e):" ",0<t&&e?e.repeat(Math.ceil(t/e.length)).substring(0,t):""}function S(e,t,n){e instanceof String&&(e=String(e));for(var r=e.length,o=0;o<r;o++){var i=e[o];if(t.call(n,i,o,e))return{Hb:o,Ob:i}}return{Hb:-1,Ob:void 0}}function O(e){return e||Array.prototype.fill}function k(e,t){e instanceof String&&(e+="");var n=0,r=!1,o={next:function(){if(!r&&n<e.length){var o=n++;return{value:t(o,e[o]),done:!1}}return r=!0,{done:!0,value:void 0}}};return o[Symbol.iterator]=function(){return o},o}function D(e,t){if(!("0"!==e&&"-0"!==e||"0"!==t&&"-0"!==t))return 0;var n=/(?:\+|(-))?(\d+)?(?:\.(\d+))?/;e=n.exec(e+"");var r=n.exec(t+""),o=!e[1],i=!r[1];return t=(e[2]||"").replace(/^0*/,""),n=(r[2]||"").replace(/^0*/,""),e=e[3]||"",r=r[3]||"",o&&!i?1:!o&&i?-1:(o=o&&i,t.length>n.length?o?1:-1:t.length<n.length?o?-1:1:t>n?o?1:-1:t<n?o?-1:1:(t=Math.max(e.length,r.length),(n=e.padEnd(t,"0"))>(t=r.padEnd(t,"0"))?o?1:-1:n<t?o?-1:1:0))}function R(e,t){return!(-1<(e=e.toString()).indexOf(".")&&0===t)&&(!(e=/^[-+]?0*([1-9]\d*)?(?:\.((?:\d*[1-9])*)0*)?$/.exec(e))[2]||e[2].length<=t)}function M(e,t){switch(t){case"required":return/(Z)|([+-])([01]\d):([0-5]\d)$/.test(e.toString());case"prohibited":return!/(Z)|([+-])([01]\d):([0-5]\d)$/.test(e.toString());case"optional":return!0}}function U(e){switch(e){case 1:case 0:case 6:case 3:case 18:case 22:case 21:case 20:case 23:case 44:return{};case 4:return{na:R,ua:function(e,t){return 1>D(e,t)},Nc:function(e,t){return 0>D(e,t)},va:function(e,t){return-1<D(e,t)},Oc:function(e,t){return 0<D(e,t)}};case 9:case 8:case 7:case 11:case 12:case 13:case 15:case 14:return{za:M};default:return null}}s("Object.assign",(function(e){return e||B})),s("String.prototype.repeat",(function(e){return e||function(e){var t=I(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}})),s("String.prototype.padEnd",(function(e){return e||function(e,t){var n=I(this,null,"padStart");return n+C(t,e-n.length)}})),s("WeakMap",(function(e){function t(e){if(this.h=(u+=Math.random()+1).toString(),e){e=c(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function o(e){if(!T(e,s)){var t=new n;i(e,s,{value:t})}}function a(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&o(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var s="$jscomp_hidden_"+Math.random();a("freeze"),a("preventExtensions"),a("seal");var u=0;return t.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(o(e),!T(e,s))throw Error("WeakMap key fail: "+e);return e[s][this.h]=t,this},t.prototype.get=function(e){return r(e)&&T(e,s)?e[s][this.h]:void 0},t.prototype.has=function(e){return r(e)&&T(e,s)&&T(e[s],this.h)},t.prototype.delete=function(e){return!!(r(e)&&T(e,s)&&T(e[s],this.h))&&delete e[s][this.h]},t})),s("Map",(function(e){function t(){var e={};return e.Da=e.next=e.head=e}function n(e,t){var n=e.h;return u((function(){if(n){for(;n.head!=e.h;)n=n.Da;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?i.has(t)?n=i.get(t):(n=""+ ++a,i.set(t,n)):n="p_"+t;var r=e.s[n];if(r&&T(e.s,n))for(e=0;e<r.length;e++){var o=r[e];if(t!=t&&o.key!=o.key||t===o.key)return{id:n,list:r,index:e,ja:o}}return{id:n,list:r,index:-1,ja:void 0}}function o(e){if(this.s={},this.h=t(),this.size=0,e){e=c(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(c([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),o=r.next();return!o.done&&o.value[0]==t&&"s"==o.value[1]&&!((o=r.next()).done||4!=o.value[0].x||"t"!=o.value[1]||!r.next().done)}catch(e){return!1}}())return e;var i=new WeakMap;o.prototype.set=function(e,t){var n=r(this,e=0===e?0:e);return n.list||(n.list=this.s[n.id]=[]),n.ja?n.ja.value=t:(n.ja={next:this.h,Da:this.h.Da,head:this.h,key:e,value:t},n.list.push(n.ja),this.h.Da.next=n.ja,this.h.Da=n.ja,this.size++),this},o.prototype.delete=function(e){return!(!(e=r(this,e)).ja||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.s[e.id],e.ja.Da.next=e.ja.next,e.ja.next.Da=e.ja.Da,e.ja.head=null,this.size--,!0)},o.prototype.clear=function(){this.s={},this.h=this.h.Da=t(),this.size=0},o.prototype.has=function(e){return!!r(this,e).ja},o.prototype.get=function(e){return(e=r(this,e).ja)&&e.value},o.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},o.prototype.keys=function(){return n(this,(function(e){return e.key}))},o.prototype.values=function(){return n(this,(function(e){return e.value}))},o.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},o.prototype[Symbol.iterator]=o.prototype.entries;var a=0;return o})),s("Array.prototype.find",(function(e){return e||function(e,t){return S(this,e,t).Ob}})),s("String.prototype.startsWith",(function(e){return e||function(e,t){var n=I(this,e,"startsWith"),r=n.length,o=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var i=0;i<o&&t<r;)if(n[t++]!=e[i++])return!1;return i>=o}})),s("Array.prototype.fill",(function(e){return e||function(e,t,n){var r=this.length||0;for(0>t&&(t=Math.max(0,r+t)),(null==n||n>r)&&(n=r),0>(n=Number(n))&&(n=Math.max(0,r+n)),t=Number(t||0);t<n;t++)this[t]=e;return this}})),s("Int8Array.prototype.fill",O),s("Uint8Array.prototype.fill",O),s("Uint8ClampedArray.prototype.fill",O),s("Int16Array.prototype.fill",O),s("Uint16Array.prototype.fill",O),s("Int32Array.prototype.fill",O),s("Uint32Array.prototype.fill",O),s("Float32Array.prototype.fill",O),s("Float64Array.prototype.fill",O),s("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var r=[],o="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof o){e=o.call(e);for(var i=0;!(o=e.next()).done;)r.push(t.call(n,o.value,i++))}else for(o=e.length,i=0;i<o;i++)r.push(t.call(n,e[i],i));return r}})),s("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),s("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var o=n[t];if(o===e||Object.is(o,e))return!0}return!1}})),s("String.prototype.includes",(function(e){return e||function(e,t){return-1!==I(this,e,"includes").indexOf(e,t||0)}})),s("Number.MAX_SAFE_INTEGER",(function(){return 9007199254740991})),s("Number.MIN_SAFE_INTEGER",(function(){return-9007199254740991})),s("Math.trunc",(function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}})),s("Number.isFinite",(function(e){return e||function(e){return"number"==typeof e&&(!isNaN(e)&&1/0!==e&&-1/0!==e)}})),s("String.prototype.padStart",(function(e){return e||function(e,t){var n=I(this,null,"padStart");return C(t,e-n.length)+n}})),s("Array.prototype.keys",(function(e){return e||function(){return k(this,(function(e){return e}))}})),s("Number.isInteger",(function(e){return e||function(e){return!!Number.isFinite(e)&&e===Math.floor(e)}})),s("Number.isSafeInteger",(function(e){return e||function(e){return Number.isInteger(e)&&Math.abs(e)<=Number.MAX_SAFE_INTEGER}})),s("Array.prototype.findIndex",(function(e){return e||function(e,t){return S(this,e,t).Hb}})),s("String.prototype.endsWith",(function(e){return e||function(e,t){var n=I(this,e,"endsWith");void 0===t&&(t=n.length),t=Math.max(0,Math.min(0|t,n.length));for(var r=e.length;0<r&&0<t;)if(n[--t]!=e[--r])return!1;return 0>=r}})),s("String.fromCodePoint",(function(e){return e||function(e){for(var t="",n=0;n<arguments.length;n++){var r=Number(arguments[n]);if(0>r||1114111<r||r!==Math.floor(r))throw new RangeError("invalid_code_point "+r);65535>=r?t+=String.fromCharCode(r):(r-=65536,t+=String.fromCharCode(r>>>10&1023|55296),t+=String.fromCharCode(1023&r|56320))}return t}})),s("String.prototype.codePointAt",(function(e){return e||function(e){var t=I(this,null,"codePointAt"),n=t.length;if(0<=(e=Number(e)||0)&&e<n){e|=0;var r=t.charCodeAt(e);return 55296>r||56319<r||e+1===n||(56320>(e=t.charCodeAt(e+1))||57343<e)?r:1024*(r-55296)+e+9216}}})),s("Set",(function(e){function t(e){if(this.h=new Map,e){e=c(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.h.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(c([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),o=r.next();return!o.done&&o.value[0]==t&&o.value[1]==t&&(!(o=r.next()).done&&o.value[0]!=t&&4==o.value[0].x&&o.value[1]==o.value[0]&&r.next().done)}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.h.set(e,e),this.size=this.h.size,this},t.prototype.delete=function(e){return e=this.h.delete(e),this.size=this.h.size,e},t.prototype.clear=function(){this.h.clear(),this.size=0},t.prototype.has=function(e){return this.h.has(e)},t.prototype.entries=function(){return this.h.entries()},t.prototype.values=function(){return this.h.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.h.forEach((function(r){return e.call(t,r,r,n)}))},t)})),s("Math.log10",(function(e){return e||function(e){return Math.log(e)/Math.LN10}})),s("Object.values",(function(e){return e||function(e){var t,n=[];for(t in e)T(e,t)&&n.push(e[t]);return n}})),s("Number.isNaN",(function(e){return e||function(e){return"number"==typeof e&&isNaN(e)}})),s("Array.prototype.values",(function(e){return e||function(){return k(this,(function(e,t){return t}))}})),s("Object.getOwnPropertySymbols",(function(e){return e||function(){return[]}}));var F={},G={};function L(e){return/^([+-]?(\d*(\.\d*)?([eE][+-]?\d*)?|INF)|NaN)$/.test(e)}function P(e){return/^[_:A-Za-z][-._:A-Za-z0-9]*$/.test(e)}function H(e){return P(e)&&/^[_A-Za-z]([-._A-Za-z0-9])*$/.test(e)}function _(e){return 1===(e=e.split(":")).length?H(e[0]):2===e.length&&(H(e[0])&&H(e[1]))}function j(e){return!/[\u0009\u000A\u000D]/.test(e)}function X(e){return H(e)}var q=new Map([[45,function(){return!0}],[46,function(){return!0}],[1,function(){return!0}],[0,function(e){return/^(0|1|true|false)$/.test(e)}],[6,function(e){return L(e)}],[3,L],[4,function(e){return/^[+-]?\d*(\.\d*)?$/.test(e)}],[18,function(e){return/^(-)?P(\d+Y)?(\d+M)?(\d+D)?(T(\d+H)?(\d+M)?(\d+(\.\d*)?S)?)?$/.test(e)}],[9,function(e){return/^-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])T(([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\.[0-9]+)?|(24:00:00(\.0+)?))(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[8,function(e){return/^(([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\.[0-9]+)?|(24:00:00(\.0+)?))(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[7,function(e){return/^-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[11,function(e){return/^-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[12,function(e){return/^-?([1-9][0-9]{3,}|0[0-9]{3})(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[13,function(e){return/^--(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[15,function(e){return/^---(0[1-9]|[12][0-9]|3[01])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[14,function(e){return/^--(0[1-9]|1[0-2])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[22,function(e){return/^([0-9A-Fa-f]{2})*$/.test(e)}],[21,function(e){return new RegExp(/^((([A-Za-z0-9+/] ?){4})*((([A-Za-z0-9+/] ?){3}[A-Za-z0-9+/])|(([A-Za-z0-9+/] ?){2}[AEIMQUYcgkosw048] ?=)|(([A-Za-z0-9+/] ?)[AQgw] ?= ?=)))?$/).test(e)}],[20,function(){return!0}],[44,_],[48,j],[52,function(e){return j(e)&&!/^ | {2,}| $/.test(e)}],[51,function(e){return/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/.test(e)}],[50,function(e){return/^[-._:A-Za-z0-9]+$/.test(e)}],[25,P],[23,_],[24,H],[42,X],[41,X],[26,function(e){return H(e)}],[5,function(e){return/^[+-]?\d+$/.test(e)}],[16,function(e){return/^-?P[0-9]+(Y([0-9]+M)?|M)$/.test(e)}],[17,function(e){return/^-?P([0-9]+D)?(T([0-9]+H)?([0-9]+M)?([0-9]+(\.[0-9]+)?S)?)?$/.test(e)}]]),V=Object.create(null);function $(e,t){if(!V[t])throw Error("Unknown type");return{type:t,value:e}}[{D:0,name:59},{D:0,name:46,parent:59,K:{whiteSpace:"preserve"}},{D:0,name:19,parent:46},{D:0,name:1,parent:46},{D:0,name:0,parent:46,K:{whiteSpace:"collapse"}},{D:0,name:4,parent:46,K:{whiteSpace:"collapse"}},{D:0,name:6,parent:46,K:{whiteSpace:"collapse"}},{D:0,name:3,parent:46,K:{whiteSpace:"collapse"}},{D:0,name:18,parent:46,K:{whiteSpace:"collapse"}},{D:0,name:9,parent:46,K:{za:"optional",whiteSpace:"collapse"}},{D:0,name:8,parent:46,K:{za:"optional",whiteSpace:"collapse"}},{D:0,name:7,parent:46,K:{za:"optional",whiteSpace:"collapse"}},{D:0,name:11,parent:46,K:{za:"optional",whiteSpace:"collapse"}},{D:0,name:12,parent:46,K:{za:"optional",whiteSpace:"collapse"}},{D:0,name:13,parent:46,K:{za:"optional",whiteSpace:"collapse"}},{D:0,name:15,parent:46,K:{za:"optional",whiteSpace:"collapse"}},{D:0,name:14,parent:46,K:{za:"optional",whiteSpace:"collapse"}},{D:0,name:22,parent:46,K:{whiteSpace:"collapse"}},{D:0,name:21,parent:46,K:{whiteSpace:"collapse"}},{D:0,name:20,parent:46,K:{whiteSpace:"collapse"}},{D:0,name:23,parent:46,K:{whiteSpace:"collapse"}},{D:0,name:44,parent:46,K:{whiteSpace:"collapse"}},{D:1,name:10,U:9,K:{whiteSpace:"collapse",za:"required"}},{D:1,name:48,U:1,K:{whiteSpace:"replace"}},{D:1,name:52,U:48,K:{whiteSpace:"collapse"}},{D:1,name:51,U:52,K:{whiteSpace:"collapse"}},{D:1,name:50,U:52,K:{whiteSpace:"collapse"}},{D:2,name:49,type:50,K:{minLength:1,whiteSpace:"collapse"}},{D:1,name:25,U:52,K:{whiteSpace:"collapse"}},{D:1,name:24,U:25,K:{whiteSpace:"collapse"}},{D:1,name:42,U:24,K:{whiteSpace:"collapse"}},{D:1,name:41,U:24,K:{whiteSpace:"collapse"}},{D:2,name:43,type:41,K:{minLength:1,whiteSpace:"collapse"}},{D:1,name:26,U:24,K:{whiteSpace:"collapse"}},{D:2,name:40,type:26,K:{minLength:1,whiteSpace:"collapse"}},{D:0,name:5,parent:4,K:{na:0,whiteSpace:"collapse"}},{D:1,name:27,U:5,K:{na:0,ua:"0",whiteSpace:"collapse"}},{D:1,name:28,U:27,K:{na:0,ua:"-1",whiteSpace:"collapse"}},{D:1,name:31,U:5,K:{na:0,ua:"9223372036854775807",va:"-9223372036854775808",whiteSpace:"collapse"}},{D:1,name:32,U:31,K:{na:0,ua:"2147483647",va:"-2147483648",whiteSpace:"collapse"}},{D:1,name:33,U:32,K:{na:0,ua:"32767",va:"-32768",whiteSpace:"collapse"}},{D:1,name:34,U:33,K:{na:0,ua:"127",va:"-128",whiteSpace:"collapse"}},{D:1,name:30,U:5,K:{na:0,va:"0",whiteSpace:"collapse"}},{D:1,name:36,U:30,K:{na:0,ua:"18446744073709551615",va:"0",whiteSpace:"collapse"}},{D:1,name:35,U:36,K:{na:0,ua:"4294967295",va:"0",whiteSpace:"collapse"}},{D:1,name:38,U:35,K:{na:0,ua:"65535",va:"0",whiteSpace:"collapse"}},{D:1,name:37,U:38,K:{na:0,ua:"255",va:"0",whiteSpace:"collapse"}},{D:1,name:29,U:30,K:{na:0,va:"1",whiteSpace:"collapse"}},{D:1,name:16,U:18,K:{whiteSpace:"collapse"}},{D:1,name:17,U:18,K:{whiteSpace:"collapse"}},{D:1,name:60,U:59},{D:3,name:39,Ca:[]},{D:1,name:61,U:60},{D:1,name:62,U:60},{D:0,name:53,parent:59},{D:1,name:54,U:53},{D:1,name:58,U:53},{D:1,name:47,U:53},{D:1,name:56,U:53},{D:1,name:57,U:53},{D:1,name:55,U:53},{D:3,name:2,Ca:[4,5,6,3]},{D:3,name:63,Ca:[]}].forEach((function(e){var t=e.name,n=e.K||{};switch(e.D){case 0:e=e.parent?V[e.parent]:null;var r=q.get(t)||null;V[t]={D:0,type:t,Ka:n,parent:e,hb:r,Na:U(t),Ca:[]};break;case 1:e=V[e.U],r=q.get(t)||null,V[t]={D:1,type:t,Ka:n,parent:e,hb:r,Na:e.Na,Ca:[]};break;case 2:V[t]={D:2,type:t,Ka:n,parent:V[e.type],hb:null,Na:F,Ca:[]};break;case 3:e=e.Ca.map((function(e){return V[e]})),V[t]={D:3,type:t,Ka:n,parent:null,hb:null,Na:G,Ca:e}}}));var Y=$(!0,0),z=$(!1,0);function Q(e){return Error("FORG0006: "+(void 0===e?"A wrong argument type was specified in a function call.":e))}function J(e,t){this.done=e,this.value=t}var W=new J(!0,void 0);function K(e){return new J(!1,e)}function Z(e,t){if(3===t.D)return!!t.Ca.find((function(t){return Z(e,t)}));for(;e;){if(e.type===t.type)return!0;if(3===e.D)return!!e.Ca.find((function(e){return ee(e.type,t.type)}));e=e.parent}return!1}function ee(e,t){return e===t||Z(V[e],V[t])}function te(e){this.s=ge,this.h=e;var t=-1;this.value={next:function(){return++t>=e.length?W:K(e[t])}}}function ne(){this.value={next:function(){return W}}}function re(e,t){this.type=e,this.value=t}(r=te.prototype).qb=function(){return this},r.filter=function(e){var t=this,n=-1;return this.s.create({next:function(){for(n++;n<t.h.length&&!e(t.h[n],n,t);)n++;return n>=t.h.length?W:K(t.h[n])}})},r.first=function(){return this.h[0]},r.N=function(){return this.h},r.getEffectiveBooleanValue=function(){if(ee(this.h[0].type,53))return!0;throw Q("Cannot determine the effective boolean value of a sequence with a length higher than one.")},r.Pa=function(){return this.h.length},r.G=function(){return!1},r.ta=function(){return!1},r.map=function(e){var t=this,n=-1;return this.s.create({next:function(){return++n>=t.h.length?W:K(e(t.h[n],n,t))}},this.h.length)},r.L=function(e){return e(this.h)},r.$=function(e){return e.multiple?e.multiple(this):e.default(this)},(r=ne.prototype).qb=function(){return this},r.filter=function(){return this},r.first=function(){return null},r.N=function(){return[]},r.getEffectiveBooleanValue=function(){return!1},r.Pa=function(){return 0},r.G=function(){return!0},r.ta=function(){return!1},r.map=function(){return this},r.L=function(e){return e([])},r.$=function(e){return e.empty?e.empty(this):e.default(this)};var oe={},ie=(oe[0]="xs:boolean",oe[1]="xs:string",oe[2]="xs:numeric",oe[3]="xs:double",oe[4]="xs:decimal",oe[5]="xs:integer",oe[6]="xs:float",oe[7]="xs:date",oe[8]="xs:time",oe[9]="xs:dateTime",oe[10]="xs:dateTimeStamp",oe[11]="xs:gYearMonth",oe[12]="xs:gYear",oe[13]="xs:gMonthDay",oe[14]="xs:gMonth",oe[15]="xs:gDay",oe[16]="xs:yearMonthDuration",oe[17]="xs:dayTimeDuration",oe[18]="xs:duration",oe[19]="xs:untypedAtomic",oe[20]="xs:anyURI",oe[21]="xs:base64Binary",oe[22]="xs:hexBinary",oe[23]="xs:QName",oe[24]="xs:NCName",oe[25]="xs:Name",oe[26]="xs:ENTITY",oe[27]="xs:nonPositiveInteger",oe[28]="xs:negativeInteger",oe[29]="xs:positiveInteger",oe[30]="xs:nonNegativeInteger",oe[31]="xs:long",oe[32]="xs:int",oe[33]="xs:short",oe[34]="xs:byte",oe[35]="xs:unsignedInt",oe[36]="xs:unsignedLong",oe[37]="xs:unsignedByte",oe[38]="xs:unsignedShort",oe[39]="xs:error",oe[40]="xs:ENTITIES",oe[41]="xs:IDREF",oe[42]="xs:ID",oe[43]="xs:IDREFS",oe[44]="xs:NOTATION",oe[45]="xs:anySimpleType",oe[46]="xs:anyAtomicType",oe[47]="attribute()",oe[48]="xs:normalizedString",oe[49]="xs:NMTOKENS",oe[50]="xs:NMTOKEN",oe[51]="xs:language",oe[52]="xs:token",oe[53]="node()",oe[54]="element()",oe[55]="document-node()",oe[56]="text()",oe[57]="processing-instruction()",oe[58]="comment()",oe[59]="item()",oe[60]="function(*)",oe[61]="map(*)",oe[62]="array(*)",oe[63]="none",oe),ae={"xs:boolean":0,"xs:string":1,"xs:numeric":2,"xs:double":3,"xs:decimal":4,"xs:integer":5,"xs:float":6,"xs:date":7,"xs:time":8,"xs:dateTime":9,"xs:dateTimeStamp":10,"xs:gYearMonth":11,"xs:gYear":12,"xs:gMonthDay":13,"xs:gMonth":14,"xs:gDay":15,"xs:yearMonthDuration":16,"xs:dayTimeDuration":17,"xs:duration":18,"xs:untypedAtomic":19,"xs:anyURI":20,"xs:base64Binary":21,"xs:hexBinary":22,"xs:QName":23,"xs:NCName":24,"xs:Name":25,"xs:ENTITY":26,"xs:nonPositiveInteger":27,"xs:negativeInteger":28,"xs:positiveInteger":29,"xs:nonNegativeInteger":30,"xs:long":31,"xs:int":32,"xs:short":33,"xs:byte":34,"xs:unsignedInt":35,"xs:unsignedLong":36,"xs:unsignedByte":37,"xs:unsignedShort":38,"xs:error":39,"xs:ENTITIES":40,"xs:IDREF":41,"xs:ID":42,"xs:IDREFS":43,"xs:NOTATION":44,"xs:anySimpleType":45,"xs:anyAtomicType":46,"attribute()":47,"xs:normalizedString":48,"xs:NMTOKENS":49,"xs:NMTOKEN":50,"xs:language":51,"xs:token":52,"node()":53,"element()":54,"document-node()":55,"text()":56,"processing-instruction()":57,"comment()":58,"item()":59,"function(*)":60,"map(*)":61,"array(*)":62};function se(e){return 2===e.g?ie[e.type]+"*":1===e.g?ie[e.type]+"+":0===e.g?ie[e.type]+"?":ie[e.type]}function ue(e){if("none"===e)throw Error('XPST0051: The type "none" could not be found');if(!e.startsWith("xs:")&&0<=e.indexOf(":"))throw Error("XPST0081: Invalid prefix for input "+e);var t=ae[e];if(void 0===t)throw Error('XPST0051: The type "'+e+'" could not be found');return t}function ce(e){switch(e[e.length-1]){case"*":return{type:ue(e.substr(0,e.length-1)),g:2};case"?":return{type:ue(e.substr(0,e.length-1)),g:0};case"+":return{type:ue(e.substr(0,e.length-1)),g:1};default:return{type:ue(e),g:3}}}function le(e){var t=e.value;if(ee(e.type,53))return!0;if(ee(e.type,0))return t;if(ee(e.type,1)||ee(e.type,20)||ee(e.type,19))return 0!==t.length;if(ee(e.type,2))return!isNaN(t)&&0!==t;throw Q("Cannot determine the effective boolean value of a value with the type "+ie[e.type])}function pe(e,t){var n=this;this.j=ge,this.value={next:function(t){return null!==n.s&&n.h>=n.s?W:void 0!==n.A[n.h]?K(n.A[n.h++]):(t=e.next(t)).done?(n.s=n.h,t):((n.u||2>n.h)&&(n.A[n.h]=t.value),n.h++,t)}},this.u=!1,this.A=[],this.h=0,this.s=void 0===t?null:t}function he(e,t){e.h=void 0===t?0:t}function de(e){this.A=ge,this.h=e;var t=!1;this.value={next:function(){return t?W:(t=!0,K(e))}},this.s=null}(r=pe.prototype).qb=function(){return this.j.create(this.N())},r.filter=function(e){var t=this,n=-1,r=this.value;return this.j.create({next:function(o){for(n++,o=r.next(o);!o.done&&!e(o.value,n,t);)n++,o=r.next(0);return o}})},r.first=function(){if(void 0!==this.A[0])return this.A[0];var e=this.value.next(0);return he(this),e.done?null:e.value},r.N=function(){if(this.h>this.A.length&&this.s!==this.A.length)throw Error("Implementation error: Sequence Iterator has progressed.");var e=this.value;this.u=!0;for(var t=e.next(0);!t.done;)t=e.next(0);return this.A},r.getEffectiveBooleanValue=function(){var e=this.value,t=this.h;he(this);var n=e.next(0);if(n.done)return he(this,t),!1;if(ee((n=n.value).type,53))return he(this,t),!0;if(!e.next(0).done)throw Q("Cannot determine the effective boolean value of a sequence with a length higher than one.");return he(this,t),le(n)},r.Pa=function(e){if(null!==this.s)return this.s;if(void 0!==e&&e)return-1;e=this.h;var t=this.N().length;return he(this,e),t},r.G=function(){return 0===this.s||null===this.first()},r.ta=function(){if(null!==this.s)return 1===this.s;var e=this.value,t=this.h;return he(this),e.next(0).done?(he(this,t),!1):(e=e.next(0),he(this,t),e.done)},r.map=function(e){var t=this,n=0,r=this.value;return this.j.create({next:function(o){return(o=r.next(o)).done?W:K(e(o.value,n++,t))}},this.s)},r.L=function(e,t){var n,r=this.value,o=[],i=!0;return function(){for(var a=r.next(i?0:t);!a.done;a=r.next(t))i=!1,o.push(a.value);n=e(o).value}(),this.j.create({next:function(){return n.next(0)}})},r.$=function(e){function t(e){r=e.value,-1!==(e=e.Pa(!0))&&(n.s=e)}var n=this,r=null;return this.j.create({next:function(o){return r?r.next(o):n.G()?(t(e.empty?e.empty(n):e.default(n)),r.next(o)):n.ta()?(t(e.o?e.o(n):e.default(n)),r.next(o)):(t(e.multiple?e.multiple(n):e.default(n)),r.next(o))}})},(r=de.prototype).qb=function(){return this},r.filter=function(e){return e(this.h,0,this)?this:this.A.create()},r.first=function(){return this.h},r.N=function(){return[this.h]},r.getEffectiveBooleanValue=function(){return null===this.s&&(this.s=le(this.h)),this.s},r.Pa=function(){return 1},r.G=function(){return!1},r.ta=function(){return!0},r.map=function(e){return this.A.create(e(this.h,0,this))},r.L=function(e){return e([this.h])},r.$=function(e){return e.o?e.o(this):e.default(this)};var fe=new ne;function me(e,t){if(null===(e=void 0===e?null:e))return fe;if(Array.isArray(e))switch(e.length){case 0:return fe;case 1:return new de(e[0]);default:return new te(e)}return e.next?new pe(e,void 0===t?null:t):new de(e)}var ge={create:me,o:function(e){return new de(e)},empty:function(){return me()},ca:function(){return me(Y)},X:function(){return me(z)}};function ye(e){var t=[],n=e.value;return function(){var e=0;return ge.create({next:function(){if(void 0!==t[e])return t[e++];var r=n.next(0);return r.done?r:t[e++]=r}})}}function ve(e,t,n){this.namespaceURI=t||null,this.prefix=e||"",this.localName=n}function we(e){var t=e.l,n=e.arity,r=void 0!==e.Ra&&e.Ra,o=void 0!==e.I&&e.I,i=e.localName,a=e.namespaceURI,s=e.i;for(e=e.value,re.call(this,60,null),this.value=e,this.I=o,o=-1,e=0;e<t.length;e++)4===t[e]&&(o=e);-1<o&&(e=Array(n-(t.length-1)).fill(t[o-1]),t=t.slice(0,o).concat(e)),this.s=t,this.A=n,this.ha=r,this.j=i,this.u=a,this.O=s}function xe(e,t){var n=[];return 2!==e&&1!==e||n.push("type-1-or-type-2"),n.push("type-"+e),t&&n.push("name-"+t),n}function be(e){var t=e.node.nodeType;if(2===t||1===t)var n=e.node.localName;return xe(t,n)}function Ae(e){var t=e.nodeType;if(2===t||1===t)var n=e.localName;return xe(t,n)}function Ee(){}function Ne(){}ve.prototype.ya=function(){return this.prefix?this.prefix+":"+this.localName:this.localName},y(we,re),we.prototype.Ra=function(){return this.ha},Ee.prototype.getAllAttributes=function(e,t){return t=void 0===t?null:t,1!==e.nodeType?[]:(e=Array.from(e.attributes),null===t?e:e.filter((function(e){return Ae(e).includes(t)})))},Ee.prototype.getAttribute=function(e,t){return 1!==e.nodeType?null:e.getAttribute(t)},Ee.prototype.getChildNodes=function(e,t){return t=void 0===t?null:t,e=Array.from(e.childNodes),null===t?e:e.filter((function(e){return Ae(e).includes(t)}))},Ee.prototype.getData=function(e){return 2===e.nodeType?e.value:e.data},Ee.prototype.getFirstChild=function(e,t){for(t=void 0===t?null:t,e=e.firstChild;e;e=e.nextSibling)if(null===t||Ae(e).includes(t))return e;return null},Ee.prototype.getLastChild=function(e,t){for(t=void 0===t?null:t,e=e.lastChild;e;e=e.previousSibling)if(null===t||Ae(e).includes(t))return e;return null},Ee.prototype.getNextSibling=function(e,t){for(t=void 0===t?null:t,e=e.nextSibling;e;e=e.nextSibling)if(null===t||Ae(e).includes(t))return e;return null},Ee.prototype.getParentNode=function(e,t){return t=void 0===t?null:t,(e=2===e.nodeType?e.ownerElement:e.parentNode)&&(null===t||Ae(e).includes(t))?e:null},Ee.prototype.getPreviousSibling=function(e,t){for(t=void 0===t?null:t,e=e.previousSibling;e;e=e.previousSibling)if(null===t||Ae(e).includes(t))return e;return null},(r=Ne.prototype).insertBefore=function(e,t,n){return e.insertBefore(t,n)},r.removeAttributeNS=function(e,t,n){return e.removeAttributeNS(t,n)},r.removeChild=function(e,t){return e.removeChild(t)},r.setAttributeNS=function(e,t,n,r){e.setAttributeNS(t,n,r)},r.setData=function(e,t){e.data=t};var Te=new Ne;function Be(e){this.h=e}function Ie(e){return void 0!==e.Sa}function Ce(e,t,n){var r=null;return t&&(Ie(t.node)?r={F:t.F,offset:n,parent:t.node}:t.F&&(r=t.F)),{node:e,F:r}}function Se(e){this.h=e,this.s=[]}function Oe(e,t,n){return e.getAllAttributes(t.node,void 0===n?null:n).map((function(e){return Ce(e,t,e.nodeName)}))}function ke(e,t,n){return Ie(t=t.node)?(e=t.attributes.find((function(e){return n===e.name})))?e.value:null:(e=e.h.getAttribute(t,n))?e:null}function De(e,t,n){return e.getChildNodes(t.node,void 0===n?null:n).map((function(e,n){return Ce(e,t,n)}))}function Re(e,t){return e.getData(t.node)}function Me(e,t,n){var r=t.node;return Ie(r)?e=r.childNodes[0]:((n=e.h.getFirstChild(r,void 0===n?null:n))&&10===n.nodeType&&(n=e.h.getNextSibling(n)),e=n),e?Ce(e,t,0):null}function Ue(e,t,n){n=void 0===n?null:n;var r=t.node;return Ie(r)?(e=r.childNodes.length-1,r=r.childNodes[e]):((r=e.h.getLastChild(r,n))&&10===r.nodeType&&(r=e.h.getPreviousSibling(r)),e=e.getChildNodes(t.node,n).length-1),r?Ce(r,t,e):null}function Fe(e,t,n){n=void 0===n?null:n;var r=t.node,o=t.F;if(Ie(r)){if(o)var i=o.offset+1,a=o.parent.childNodes[i]}else{if(!o){for(a=r;a&&(!(a=e.h.getNextSibling(a,n))||10===a.nodeType););return a?{node:a,F:null}:null}i=o.offset+1;var s=Ge(e,t,null);a=e.getChildNodes(s.node,n)[i]}return a?Ce(a,s||Ge(e,t,n),i):null}function Ge(e,t,n){n=void 0===n?null:n;var r=t.node,o=t.F;if(o)"number"==typeof o.offset&&r===o.parent.childNodes[o.offset]||"string"==typeof o.offset&&r===o.parent.attributes.find((function(e){return o.offset===e.nodeName}))?(e=o.parent,t=o.F):(e=e.getParentNode(r,n),t=o);else{if(Ie(r))return null;e=e.getParentNode(r,n),t=null}return e?{node:e,F:t}:null}function Le(e,t,n){n=void 0===n?null:n;var r=t.node,o=t.F;if(Ie(r)){if(o)var i=o.offset-1,a=o.parent.childNodes[i]}else{if(!o){for(a=r;a&&(!(a=e.h.getPreviousSibling(a,n))||10===a.nodeType););return a?{node:a,F:null}:null}i=o.offset-1;var s=Ge(e,t,null);a=e.getChildNodes(s.node,n)[i]}return a?Ce(a,s||Ge(e,t,n),i):null}function Pe(e,t,n,r,o){return o.L((function(e){var t=c(e).next().value;return r.L((function(e){e=c(e).next().value;var n=t.value;if(0>=n||n>e.R.length)throw Error("FOAY0001: array position out of bounds.");return e.R[n-1]()}))}))}function He(e){we.call(this,{value:function(e,n,r,o){return Pe(0,0,0,ge.o(t),o)},localName:"get",namespaceURI:"http://www.w3.org/2005/xpath-functions/array",l:[{type:5,g:3}],arity:1,i:{type:59,g:2}});var t=this;this.type=62,this.R=e}function _e(e){switch(e.node.nodeType){case 2:return 47;case 1:return 54;case 3:case 4:return 56;case 7:return 57;case 8:return 58;case 9:return 55;default:return 53}}function je(e){return{type:_e(e),value:e}}function Xe(e,t){return e=e.map((function(e){return e.first()})),t(e)}function qe(e,t){var n=ee(e.type,1)||ee(e.type,20)||ee(e.type,19),r=ee(t.type,1)||ee(t.type,20)||ee(t.type,19);return n&&r?e.value===t.value:(n=ee(e.type,4)||ee(e.type,3)||ee(e.type,6),r=ee(t.type,4)||ee(t.type,3)||ee(t.type,6),n&&r?!(!isNaN(e.value)||!isNaN(t.value))||e.value===t.value:(n=ee(e.type,0)||ee(e.type,22)||ee(e.type,18)||ee(e.type,23)||ee(e.type,44),r=ee(t.type,0)||ee(t.type,22)||ee(t.type,18)||ee(t.type,23)||ee(t.type,44),!(!n||!r)&&e.value===t.value))}function Ve(e,t,n,r,o){return Xe([r,o],(function(e){var t=(e=c(e)).next().value,n=e.next().value;return(e=t.h.find((function(e){return qe(e.key,n)})))?e.value():ge.empty()}))}function $e(e){we.call(this,{l:[{type:59,g:3}],arity:1,localName:"get",namespaceURI:"http://www.w3.org/2005/xpath-functions/map",value:function(e,n,r,o){return Ve(0,0,0,ge.o(t),o)},i:{type:59,g:2}});var t=this;this.type=61,this.h=e}function Ye(){}function ze(e,t){return e.cb()===t.cb()&&e.eb()===t.eb()}function Qe(e){if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error("FODT0002: Number of seconds given to construct DayTimeDuration overflows MAX_SAFE_INTEGER or MIN_SAFE_INTEGER");this.ea=e}function Je(e){var t=Math.abs(e.ab()),n=Math.abs(e.getHours()),r=Math.abs(e.getMinutes());return n=(n?n+"H":"")+(r?r+"M":"")+((e=Math.abs(e.getSeconds()))?e+"S":""),(t=t?t+"D":"")&&n?t+"T"+n:t||(n?"T"+n:"T0S")}function We(e,t,n,r,o,i){return e=86400*e+3600*t+60*n+r+o,new Qe(i||0===e?e:-e)}function Ke(e){return(e=/^(-)?P(\d+Y)?(\d+M)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+(\.\d*)?S)?)?$/.exec(e))?We(e[4]?parseInt(e[4],10):0,e[5]?parseInt(e[5],10):0,e[6]?parseInt(e[6],10):0,e[7]?parseInt(e[7],10):0,e[8]?parseFloat(e[8]):0,!e[1]):null}function Ze(e){return"Z"===(e=/^(Z)|([+-])([01]\d):([0-5]\d)$/.exec(e))[1]?We(0,0,0,0,0,!0):We(0,e[3]?parseInt(e[3],10):0,e[4]?parseInt(e[4],10):0,0,0,"+"===e[2])}function et(e,t){if(isNaN(t))throw Error("FOCA0005: Cannot multiply xs:dayTimeDuration by NaN");if((e=e.ea*t)>Number.MAX_SAFE_INTEGER||!Number.isFinite(e))throw Error("FODT0002: Value overflow while multiplying xs:dayTimeDuration");return new Qe(e<Number.MIN_SAFE_INTEGER||Object.is(-0,e)?0:e)}function tt(e){return e?parseInt(e,10):null}function nt(e){var t=(e+="").startsWith("-");return t&&(e=e.substring(1)),(t?"-":"")+e.padStart(4,"0")}function rt(e){return(e+"").padStart(2,"0")}function ot(e){return 1===(e+="").split(".")[0].length&&(e=e.padStart(e.length+1,"0")),e}function it(e){return 0===e.getHours()&&0===e.getMinutes()?"Z":(e.qa()?"+":"-")+rt(Math.abs(e.getHours()))+":"+rt(Math.abs(e.getMinutes()))}function at(e,t,n,r,o,i,a,s,u){this.A=e,this.h=t,this.s=n+(24===r?1:0),this.u=24===r?0:r,this.O=o,this.j=i,this.ra=a,this.Z=s,this.type=void 0===u?9:u}function st(e){var t=/^(?:(-?\d{4,}))?(?:--?(\d\d))?(?:-{1,3}(\d\d))?(T)?(?:(\d\d):(\d\d):(\d\d))?(\.\d+)?(Z|(?:[+-]\d\d:\d\d))?$/.exec(e);e=t[1]?parseInt(t[1],10):null;var n=tt(t[2]),r=tt(t[3]),o=t[4],i=tt(t[5]),a=tt(t[6]),s=tt(t[7]),u=t[8]?parseFloat(t[8]):0;if(t=t[9]?Ze(t[9]):null,e&&(-271821>e||273860<e))throw Error("FODT0001: Datetime year is out of bounds");return o?new at(e,n,r,i,a,s,u,t,9):null!==i&&null!==a&&null!==s?new at(1972,12,31,i,a,s,u,t,8):null!==e&&null!==n&&null!==r?new at(e,n,r,0,0,0,0,t,7):null!==e&&null!==n?new at(e,n,1,0,0,0,0,t,11):null!==n&&null!==r?new at(1972,n,r,0,0,0,0,t,13):null!==e?new at(e,1,1,0,0,0,0,t,12):null!==n?new at(1972,n,1,0,0,0,0,t,14):new at(1972,12,r,0,0,0,0,t,15)}function ut(e,t){switch(t){case 15:return new at(1972,12,e.s,0,0,0,0,e.Z,15);case 14:return new at(1972,e.h,1,0,0,0,0,e.Z,14);case 12:return new at(e.A,1,1,0,0,0,0,e.Z,12);case 13:return new at(1972,e.h,e.s,0,0,0,0,e.Z,13);case 11:return new at(e.A,e.h,1,0,0,0,0,e.Z,11);case 8:return new at(1972,12,31,e.u,e.O,e.j,e.ra,e.Z,8);case 7:return new at(e.A,e.h,e.s,0,0,0,0,e.Z,7);default:return new at(e.A,e.h,e.s,e.u,e.O,e.j,e.ra,e.Z,9)}}function ct(e,t){return t=e.Z||t||Ze("Z"),new Date(Date.UTC(e.A,e.h-1,e.s,e.u-t.getHours(),e.O-t.getMinutes(),e.j,1e3*e.ra))}function lt(e,t,n){var r=ct(e,n).getTime();return r===(n=ct(t,n).getTime())?e.ra===t.ra?0:e.ra>t.ra?1:-1:r>n?1:-1}function pt(e,t,n){return 0===lt(e,t,n)}function ht(e,t,n){return new Qe(e=(ct(e,n).getTime()-ct(t,n).getTime())/1e3)}function dt(e){throw Error("Not implemented: adding durations to "+ie[e.type])}function ft(e){throw Error("Not implemented: subtracting durations from "+ie[e.type])}function mt(e,t){if(null===e)return null;switch(typeof e){case"boolean":return e?Y:z;case"number":return $(e,3);case"string":return $(e,1);case"object":if("nodeType"in e)return je({node:e,F:null});if(Array.isArray(e))return new He(e.map((function(e){return void 0===e?function(){return ge.empty()}:ye(e=null===(e=mt(e))?ge.empty():ge.o(e))})));if(e instanceof Date){var n=st(e.toISOString());return $(n,n.type)}return new $e(Object.keys(e).filter((function(t){return void 0!==e[t]})).map((function(t){var n=mt(e[t]);return n=null===n?ge.empty():ge.o(n),{key:$(t,1),value:ye(n)}})))}throw Error("Value "+String(e)+' of type "'+typeof e+'" is not adaptable to an XPath value.')}function gt(e,t){if("number"!=typeof e&&("string"!=typeof e||!q.get(t)(e)))throw Error("Cannot convert JavaScript value '"+e+"' to the XPath type "+ie[t]+" since it is not valid.")}function yt(e,t,n){if(null===t)return null;switch(e){case 0:return t?Y:z;case 1:return $(t+"",1);case 3:case 2:return gt(t,3),$(+t,3);case 4:return gt(t,e),$(+t,4);case 5:return gt(t,e),$(0|t,5);case 6:return gt(t,e),$(+t,6);case 7:case 8:case 9:case 11:case 12:case 13:case 14:case 15:if(!(t instanceof Date))throw Error("The JavaScript value "+t+" with type "+typeof t+" is not a valid type to be converted to an XPath "+ie[e]+".");return $(ut(st(t.toISOString()),e),e);case 53:case 47:case 55:case 54:case 56:case 57:case 58:if("object"!=typeof t||!("nodeType"in t))throw Error("The JavaScript value "+t+" with type "+typeof t+" is not a valid type to be converted to an XPath "+ie[e]+".");return je({node:t,F:null});case 59:case 61:return mt(t);default:throw Error('Values of the type "'+ie[e]+'" can not be adapted from JavaScript to equivalent XPath values.')}}function vt(e,t,n){if(0===n.g)return null===(t=yt(n.type,t))?[]:[t];if(2===n.g||1===n.g){if(!Array.isArray(t))throw Error("The JavaScript value "+t+" should be an array if it is to be converted to "+se(n)+".");return t.map((function(e){return yt(n.type,e)})).filter((function(e){return null!==e}))}var r=yt(n.type,t);if(null===r)throw Error("The JavaScript value "+t+" should be a single entry if it is to be converted to "+se(n)+".");return[r]}function wt(e,t,n){return n=void 0===n?{type:59,g:0}:n,ge.create(vt(0,t,n))}function xt(e,t){this.h=t=void 0===t?{xb:null,Cb:null,rb:!1}:t,this.La=e.La,this.Ia=e.Ia,this.M=e.M,this.Ga=e.Ga||Object.create(null)}function bt(e,t){var n=0,r=t.value;return{next:function(o){return(o=r.next(o)).done?W:K(Nt(e,n++,o.value,t))}}}function At(e){return e.h.rb||(e.h.rb=!0,e.h.xb=st((new Date).toISOString()),e.h.Cb=Ke("PT0S")),e.h.xb}function Et(e){return e.h.rb||(e.h.rb=!0,e.h.xb=st((new Date).toISOString()),e.h.Cb=Ke("PT0S")),e.h.Cb}function Nt(e,t,n,r){return new xt({M:n,La:t,Ia:r||e.Ia,Ga:e.Ga},e.h)}function Tt(e,t){return new xt({M:e.M,La:e.La,Ia:e.Ia,Ga:Object.assign(Object.create(null),e.Ga,t)},e.h)}function Bt(e,t,n,r,o,i,a,s){var u=new Map;this.debug=e,this.Ja=t,this.h=n,this.s=r,this.j=o,this.u=i,this.ha=u,this.O=a,this.A=s}function It(e){var t=0,n=null,r=!0;return ge.create({next:function(o){for(;t<e.length;){n||(n=e[t].value,r=!0);var i=n.next(r?0:o);if(r=!1,!i.done)return i;t++,n=null}return W}})}function Ct(e,t,n){return Error("FORG0001: Cannot cast "+e+" to "+ie[t]+(n?", "+n:""))}function St(e){return Error("XPTY0004: "+e)}function Ot(e){return Error("FOTY0013: Atomization is not supported for "+ie[e]+".")}function kt(e){return Error("XPST0081: The prefix "+e+" could not be resolved.")}function Dt(e,t){if(ee(e.type,46)||ee(e.type,19)||ee(e.type,0)||ee(e.type,4)||ee(e.type,3)||ee(e.type,6)||ee(e.type,5)||ee(e.type,2)||ee(e.type,23)||ee(e.type,1))return ge.create(e);var n=t.h;if(ee(e.type,53)){var r=e.value;if(2===r.node.nodeType||3===r.node.nodeType)return ge.create($(Re(n,r),19));if(8===r.node.nodeType||7===r.node.nodeType)return ge.create($(Re(n,r),1));var o=[];return function e(t){if(8!==r.node.nodeType&&7!==r.node.nodeType){var i=t.nodeType;3===i||4===i?o.push(n.getData(t)):1!==i&&9!==i||n.getChildNodes(t).forEach((function(t){e(t)}))}}(r.node),ge.create($(o.join(""),19))}if(ee(e.type,60)&&!ee(e.type,62))throw Ot(e.type);if(ee(e.type,62))return It(e.R.map((function(e){return Rt(e(),t)})));throw Error("Atomizing "+e.type+" is not implemented.")}function Rt(e,t){var n=!1,r=e.value,o=null;return ge.create({next:function(){for(;!n;){if(!o){var e=r.next(0);if(e.done){n=!0;break}o=Dt(e.value,t).value}if(!(e=o.next(0)).done)return e;o=null}return W}})}function Mt(e){for(e=V[e];e&&0!==e.D;)e=e.parent;return e?e.type:null}function Ut(e,t){var n=(t=V[t]).Ka;if(!n||!n.whiteSpace)return t.parent?Ut(e,t.parent.type):e;switch(t.Ka.whiteSpace){case"replace":return e.replace(/[\u0009\u000A\u000D]/g," ");case"collapse":return e.replace(/[\u0009\u000A\u000D]/g," ").replace(/ {2,}/g," ").replace(/^ | $/g,"")}return e}function Ft(e,t){for(t=V[t];t&&null===t.hb;){if(2===t.D||3===t.D)return!0;t=t.parent}return!t||t.hb(e)}function Gt(e,t){for(;e;){if(e.Na&&e.Na[t])return e.Na[t];e=e.parent}return function(){return!0}}function Lt(e,t){return e(2)?function(e){return{v:!0,value:e}}:e(0)?function(e){return{v:!0,value:e?1:0}}:e(1)||e(19)?function(e){switch(e){case"NaN":return{v:!0,value:NaN};case"INF":case"+INF":return{v:!0,value:1/0};case"-INF":return{v:!0,value:-1/0};case"0":case"+0":return{v:!0,value:0};case"-0":return{v:!0,value:-0}}var n=parseFloat(e);return isNaN(n)?{v:!1,error:Ct(e,t)}:{v:!0,value:n}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to "+t+" or any of its derived types.")}}}function Pt(e){if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error("FODT0002: Number of months given to construct YearMonthDuration overflows MAX_SAFE_INTEGER or MIN_SAFE_INTEGER");this.ga=e}function Ht(e){var t=Math.abs(e.fb());return(t?t+"Y":"")+((e=Math.abs(e.bb()))?e+"M":"")||"0M"}function _t(e){var t=/^(-)?P(\d+Y)?(\d+M)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+(\.\d*)?S)?)?$/.exec(e);if(t){if(e=!t[1],(t=12*(t[2]?parseInt(t[2],10):0)+(t[3]?parseInt(t[3],10):0))>Number.MAX_SAFE_INTEGER||!Number.isFinite(t))throw Error("FODT0002: Value overflow while constructing xs:yearMonthDuration");e=new Pt(e||0===t?t:-t)}else e=null;return e}function jt(e,t){if(isNaN(t))throw Error("FOCA0005: Cannot multiply xs:yearMonthDuration by NaN");if((e=Math.round(e.ga*t))>Number.MAX_SAFE_INTEGER||!Number.isFinite(e))throw Error("FODT0002: Value overflow while constructing xs:yearMonthDuration");return new Pt(e<Number.MIN_SAFE_INTEGER||0===e?0:e)}function Xt(e,t){this.Ua=e,this.Ha=t}(r=Be.prototype).insertBefore=function(e,t,n){return this.h.insertBefore(e,t,n)},r.removeAttributeNS=function(e,t,n){return this.h.removeAttributeNS(e,t,n)},r.removeChild=function(e,t){return this.h.removeChild(e,t)},r.setAttributeNS=function(e,t,n,r){this.h.setAttributeNS(e,t,n,r)},r.setData=function(e,t){this.h.setData(e,t)},Se.prototype.getAllAttributes=function(e,t){return Ie(e)?e.attributes:this.h.getAllAttributes(e,void 0===t?null:t)},Se.prototype.getChildNodes=function(e,t){return t=Ie(e)?e.childNodes:this.h.getChildNodes(e,void 0===t?null:t),9===e.nodeType?t.filter((function(e){return 10!==e.nodeType})):t},Se.prototype.getData=function(e){return Ie(e)?2===e.nodeType?e.value:e.data:this.h.getData(e)||""},Se.prototype.getParentNode=function(e,t){return this.h.getParentNode(e,void 0===t?null:t)},y(He,we),y($e,we),(r=Ye.prototype).ab=function(){return 0},r.getHours=function(){return 0},r.getMinutes=function(){return 0},r.bb=function(){return 0},r.cb=function(){return 0},r.eb=function(){return 0},r.getSeconds=function(){return 0},r.fb=function(){return 0},r.qa=function(){return!0},y(Qe,Ye),(r=Qe.prototype).ab=function(){return Math.trunc(this.ea/86400)},r.getHours=function(){return Math.trunc(this.ea%86400/3600)},r.getMinutes=function(){return Math.trunc(this.ea%3600/60)},r.eb=function(){return this.ea},r.getSeconds=function(){var e=this.ea%60;return Object.is(-0,e)?0:e},r.qa=function(){return!Object.is(-0,this.ea)&&0<=this.ea},r.toString=function(){return(this.qa()?"P":"-P")+Je(this)},(r=at.prototype).getDay=function(){return this.s},r.getHours=function(){return this.u},r.getMinutes=function(){return this.O},r.getMonth=function(){return this.h},r.getSeconds=function(){return this.j},r.getYear=function(){return this.A},r.toString=function(){switch(this.type){case 9:return nt(this.A)+"-"+rt(this.h)+"-"+rt(this.s)+"T"+rt(this.u)+":"+rt(this.O)+":"+ot(this.j+this.ra)+(this.Z?it(this.Z):"");case 7:return nt(this.A)+"-"+rt(this.h)+"-"+rt(this.s)+(this.Z?it(this.Z):"");case 8:return rt(this.u)+":"+rt(this.O)+":"+ot(this.j+this.ra)+(this.Z?it(this.Z):"");case 15:return"---"+rt(this.s)+(this.Z?it(this.Z):"");case 14:return"--"+rt(this.h)+(this.Z?it(this.Z):"");case 13:return"--"+rt(this.h)+"-"+rt(this.s)+(this.Z?it(this.Z):"");case 12:return nt(this.A)+(this.Z?it(this.Z):"");case 11:return nt(this.A)+"-"+rt(this.h)+(this.Z?it(this.Z):"")}throw Error("Unexpected subType")},y(Pt,Ye),(r=Pt.prototype).bb=function(){var e=this.ga%12;return 0===e?0:e},r.cb=function(){return this.ga},r.fb=function(){return Math.trunc(this.ga/12)},r.qa=function(){return!Object.is(-0,this.ga)&&0<=this.ga},r.toString=function(){return(this.qa()?"P":"-P")+Ht(this)},y(Xt,Ye),(r=Xt.prototype).ab=function(){return this.Ha.ab()},r.getHours=function(){return this.Ha.getHours()},r.getMinutes=function(){return this.Ha.getMinutes()},r.bb=function(){return this.Ua.bb()},r.cb=function(){return this.Ua.cb()},r.eb=function(){return this.Ha.eb()},r.getSeconds=function(){return this.Ha.getSeconds()},r.fb=function(){return this.Ua.fb()},r.qa=function(){return this.Ua.qa()&&this.Ha.qa()},r.toString=function(){var e=this.qa()?"P":"-P",t=Ht(this.Ua),n=Je(this.Ha);return"0M"===t?e+n:"T0S"===n?e+t:e+t+n};var qt=[3,6,4,5];function Vt(e){if(e(1)||e(19))return function(e){return{v:!0,value:e+""}};if(e(20))return function(e){return{v:!0,value:e}};if(e(23))return function(e){return{v:!0,value:e.prefix?e.prefix+":"+e.localName:e.localName}};if(e(44))return function(e){return{v:!0,value:e.toString()}};if(e(2)){if(e(5)||e(4))return function(e){return{v:!0,value:(e+"").replace("e","E")}};if(e(6)||e(3))return function(e){return isNaN(e)?{v:!0,value:"NaN"}:isFinite(e)?Object.is(e,-0)?{v:!0,value:"-0"}:{v:!0,value:(e+"").replace("e","E").replace("E+","E")}:{v:!0,value:(0>e?"-":"")+"INF"}}}return e(9)||e(7)||e(8)||e(15)||e(14)||e(13)||e(12)||e(11)||e(16)||e(17)||e(18)?function(e){return{v:!0,value:e.toString()}}:e(22)?function(e){return{v:!0,value:e.toUpperCase()}}:function(e){return{v:!0,value:e+""}}}var $t=[2,5,17,16];function Yt(e,t){function n(t){return ee(e,t)}if(39===t)return function(){return{v:!1,error:Error("FORG0001: Casting to xs:error is always invalid.")}};switch(t){case 19:return function(e){var t=Vt(e);return function(e){return(e=t(e)).v?{v:!0,value:$(e.value,19)}:e}}(n);case 1:return function(e){var t=Vt(e);return function(e){return(e=t(e)).v?{v:!0,value:$(e.value,1)}:e}}(n);case 6:return function(e){var t=Lt(e,6);return function(e){return(e=t(e)).v?{v:!0,value:$(e.value,6)}:e}}(n);case 3:return function(e){var t=Lt(e,3);return function(e){return(e=t(e)).v?{v:!0,value:$(e.value,3)}:e}}(n);case 4:return function(e){return e(5)?function(e){return{v:!0,value:$(e,4)}}:e(6)||e(3)?function(e){return isNaN(e)||!isFinite(e)?{v:!1,error:Error("FOCA0002: Can not cast "+e+" to xs:decimal")}:Math.abs(e)>Number.MAX_VALUE?{v:!1,error:Error("FOAR0002: Can not cast "+e+" to xs:decimal, it is out of bounds for JavaScript numbers")}:{v:!0,value:$(e,4)}}:e(0)?function(e){return{v:!0,value:$(e?1:0,4)}}:e(1)||e(19)?function(e){var t=parseFloat(e);return!isNaN(t)||isFinite(t)?{v:!0,value:$(t,4)}:{v:!1,error:Error("FORG0001: Can not cast "+e+" to xs:decimal")}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:decimal or any of its derived types.")}}}(n);case 5:return function(e){return e(0)?function(e){return{v:!0,value:$(e?1:0,5)}}:e(2)?function(e){var t=Math.trunc(e);return!isFinite(t)||isNaN(t)?{v:!1,error:Error("FOCA0002: can not cast "+e+" to xs:integer")}:Number.isSafeInteger(t)?{v:!0,value:$(t,5)}:{v:!1,error:Error("FOAR0002: can not cast "+e+" to xs:integer, it is out of bounds for JavaScript numbers.")}}:e(1)||e(19)?function(e){var t=parseInt(e,10);return isNaN(t)?{v:!1,error:Ct(e,5)}:Number.isSafeInteger(t)?{v:!0,value:$(t,5)}:{v:!1,error:Error("FOCA0003: can not cast "+e+" to xs:integer, it is out of bounds for JavaScript numbers.")}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:integer or any of its derived types.")}}}(n);case 2:return function(e){var t=Yt;return function(n){for(var r=c(qt),o=r.next();!o.done;o=r.next())if((o=t(e,o.value)(n)).v)return o;return{v:!1,error:Error('XPTY0004: Casting not supported from "'+n+'" given type to xs:numeric or any of its derived types.')}}}(e);case 18:return function(e){return e(16)?function(e){return{v:!0,value:$(new Xt(e,new Qe(e.qa()?0:-0)),18)}}:e(17)?function(e){return{v:!0,value:$(e=new Xt(new Pt(e.qa()?0:-0),e),18)}}:e(18)?function(e){return{v:!0,value:$(e,18)}}:e(19)||e(1)?function(e){return{v:!0,value:$(new Xt(_t(e),Ke(e)),18)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:duration or any of its derived types.")}}}(n);case 16:return function(e){return e(18)&&!e(17)?function(e){return{v:!0,value:$(e.Ua,16)}}:e(17)?function(){return{v:!0,value:$(_t("P0M"),16)}}:e(19)||e(1)?function(e){var t=_t(e);return t?{v:!0,value:$(t,16)}:{v:!1,error:Ct(e,16)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:yearMonthDuration or any of its derived types.")}}}(n);case 17:return function(e){return e(18)&&!e(16)?function(e){return{v:!0,value:$(e.Ha,17)}}:e(16)?function(){return{v:!0,value:$(Ke("PT0.0S"),17)}}:e(19)||e(1)?function(e){var t=Ke(e);return t?{v:!0,value:$(t,17)}:{v:!1,error:Error("FORG0001: Can not cast "+e+" to xs:dayTimeDuration")}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:dayTimeDuration or any of its derived types.")}}}(n);case 9:return function(e){return e(7)?function(e){return{v:!0,value:$(ut(e,9),9)}}:e(19)||e(1)?function(e){return{v:!0,value:$(st(e),9)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:dateTime or any of its derived types.")}}}(n);case 8:return function(e){return e(9)?function(e){return{v:!0,value:$(ut(e,8),8)}}:e(19)||e(1)?function(e){return{v:!0,value:$(st(e),8)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:time or any of its derived types.")}}}(n);case 7:return function(e){return e(9)?function(e){return{v:!0,value:$(ut(e,7),7)}}:e(19)||e(1)?function(e){return{v:!0,value:$(st(e),7)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:date or any of its derived types.")}}}(n);case 11:return function(e){return e(7)||e(9)?function(e){return{v:!0,value:$(ut(e,11),11)}}:e(19)||e(1)?function(e){return{v:!0,value:$(st(e),11)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gYearMonth or any of its derived types.")}}}(n);case 12:return function(e){return e(7)||e(9)?function(e){return{v:!0,value:$(ut(e,12),12)}}:e(19)||e(1)?function(e){return{v:!0,value:$(st(e),12)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gYear or any of its derived types.")}}}(n);case 13:return function(e){return e(7)||e(9)?function(e){return{v:!0,value:$(ut(e,13),13)}}:e(19)||e(1)?function(e){return{v:!0,value:$(st(e),13)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gMonthDay or any of its derived types.")}}}(n);case 15:return function(e){return e(7)||e(9)?function(e){return{v:!0,value:$(ut(e,15),15)}}:e(19)||e(1)?function(e){return{v:!0,value:$(st(e),15)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gDay or any of its derived types.")}}}(n);case 14:return function(e){return e(7)||e(9)?function(e){return{v:!0,value:$(ut(e,14),14)}}:e(19)||e(1)?function(e){return{v:!0,value:$(st(e),14)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gMonth or any of its derived types.")}}}(n);case 0:return function(e){return e(2)?function(e){return{v:!0,value:0===e||isNaN(e)?z:Y}}:e(1)||e(19)?function(e){switch(e){case"true":case"1":return{v:!0,value:Y};case"false":case"0":return{v:!0,value:z};default:return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:boolean or any of its derived types.")}}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:boolean or any of its derived types.")}}}(n);case 21:return function(e){return e(22)?function(e){for(var t="",n=0;n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return{v:!0,value:$(btoa(t),21)}}:e(1)||e(19)?function(e){return{v:!0,value:$(e,21)}}:function(){return{error:Error("XPTY0004: Casting not supported from given type to xs:base64Binary or any of its derived types."),v:!1}}}(n);case 22:return function(e){return e(21)?function(e){for(var t="",n=0,r=(e=atob(e)).length;n<r;n++)t+=Number(e.charCodeAt(n)).toString(16);return{v:!0,value:$(t.toUpperCase(),22)}}:e(1)||e(19)?function(e){return{v:!0,value:$(e,22)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:hexBinary or any of its derived types.")}}}(n);case 20:return function(e){return e(1)||e(19)?function(e){return{v:!0,value:$(e,20)}}:function(){return{v:!1,error:Error("XPTY0004: Casting not supported from given type to xs:anyURI or any of its derived types.")}}}(n);case 23:throw Error("Casting to xs:QName is not implemented.")}return function(){return{v:!1,error:Error("XPTY0004: Casting not supported from "+e+" to "+t+".")}}}var zt=Object.create(null);function Qt(e,t){if(19===e&&1===t)return function(e){return{v:!0,value:$(e,1)}};if(44===t)return function(){return{v:!1,error:Error("XPST0080: Casting to xs:NOTATION is not permitted.")}};if(39===t)return function(){return{v:!1,error:Error("FORG0001: Casting to xs:error is not permitted.")}};if(45===e||45===t)return function(){return{v:!1,error:Error("XPST0080: Casting from or to xs:anySimpleType is not permitted.")}};if(46===e||46===t)return function(){return{v:!1,error:Error("XPST0080: Casting from or to xs:anyAtomicType is not permitted.")}};if(ee(e,60)&&1===t)return function(){return{v:!1,error:Error("FOTY0014: Casting from function item to xs:string is not permitted.")}};if(e===t)return function(e){return{v:!0,value:{type:t,value:e}}};var n=$t.includes(e)?e:Mt(e),r=$t.includes(t)?t:Mt(t);if(null===r||null===n)return function(){return{v:!1,error:Error("XPST0081: Can not cast: type "+(r?ie[e]:ie[t])+" is unknown.")}};var o=[];return 1!==n&&19!==n||o.push((function(e){var n=Ut(e,t);return Ft(n,t)?{v:!0,value:n}:{v:!1,error:Ct(e,t,"pattern validation failed.")}})),n!==r&&(o.push(Yt(n,r)),o.push((function(e){return{v:!0,value:e.value}}))),19!==r&&1!==r||o.push((function(e){return Ft(e,t)?{v:!0,value:e}:{v:!1,error:Ct(e,t,"pattern validation failed.")}})),o.push((function(e){return function(e,t){for(var n=V[t];n;){if(n.Ka&&!Object.keys(n.Ka).every((function(t){if("whiteSpace"===t)return!0;var r=Gt(n,t);return!r||r(e,n.Ka[t])})))return!1;n=n.parent}return!0}(e,t)?{v:!0,value:e}:{v:!1,error:Ct(e,t,"pattern validation failed.")}})),o.push((function(e){return{v:!0,value:{type:t,value:e}}})),function(e){e={v:!0,value:e};for(var t=0,n=o.length;t<n&&!1!==(e=o[t](e.value)).v;++t);return e}}function Jt(e,t){var n=e.type+1e4*t,r=zt[n];return r||(r=zt[n]=Qt(e.type,t)),r.call(void 0,e.value,t)}function Wt(e,t){if(!0===(e=Jt(e,t)).v)return e.value;throw e.error}function Kt(e){var t=!1;return{next:function(){return t?W:(t=!0,K(e))}}}function Zt(e,t){return e===t||!(!e||!t||e.offset!==t.offset||e.parent!==t.parent)&&Zt(e.F,t.F)}function en(e,t){return!!(e===t||e.node===t.node&&Zt(e.F,t.F))}function tn(e,t){for(var n=[];t;t=Ge(e,t,null))n.unshift(t);return n}function nn(e,t){for(var n=[];t;t=e.getParentNode(t,null))n.unshift(t);return n}function rn(e,t,n,r){if(n.F||r.F||Ie(n.node)||Ie(r.node)){if(en(n,r))return 0;n=tn(t,n),r=tn(t,r);var o=n[0],i=r[0];if(!en(o,i))return t=e.findIndex((function(e){return en(e,o)})),n=e.findIndex((function(e){return en(e,i)})),-1===t&&(t=e.push(o)),-1===n&&(n=e.push(i)),t-n;e=1;for(var a=Math.min(n.length,r.length);e<a&&en(n[e],r[e]);++e);return n[e]?r[e]?function(e,t,n){var r=Ge(e,t,null);e=De(e,r,null),r=0;for(var o=e.length;r<o;++r){var i=e[r];if(en(i,t))return-1;if(en(i,n))return 1}}(t,n[e],r[e]):1:-1}if((n=n.node)===(r=r.node))return 0;if(n=nn(t,n),r=nn(t,r),n[0]!==r[0]){var s={node:n[0],F:null},u={node:r[0],F:null};return t=e.findIndex((function(e){return en(e,s)})),n=e.findIndex((function(e){return en(e,u)})),-1===t&&(t=e.push(s)),-1===n&&(n=e.push(u)),t-n}for(a=1,e=Math.min(n.length,r.length);a<e&&n[a]===r[a];++a);if(e=n[a],n=r[a],!e)return-1;if(!n)return 1;for(t=t.getChildNodes(r[a-1],null),r=0,a=t.length;r<a;++r){var c=t[r];if(c===e)return-1;if(c===n)return 1}}function on(e,t,n,r){var o=ee(n.type,47),i=ee(r.type,47);if(o&&!i){if(en(n=Ge(t,n.value),r=r.value))return 1}else if(i&&!o){if(en(n=n.value,r=Ge(t,r.value)))return-1}else if(o&&i){if(en(Ge(t,r.value),Ge(t,n.value)))return n.value.node.localName>r.value.node.localName?1:-1;n=Ge(t,n.value),r=Ge(t,r.value)}else n=n.value,r=r.value;return rn(e,t,n,r)}function an(e,t,n){return on(e.s,e,t,n)}function sn(e,t){return cn(t,(function(t,n){return on(e.s,e,t,n)})).filter((function(e,t,n){return 0===t||!en(e.value,n[t-1].value)}))}function un(e,t){return e<t?-1:0}function cn(e,t){if(t=void 0===t?un:t,1>=e.length)return e;var n=Math.floor(e.length/2),r=cn(e.slice(0,n),t);for(e=cn(e.slice(n),t),n=[];r.length&&e.length;)0>t(r[0],e[0])?n.push(r.shift()):n.push(e.shift());return n.concat(r.concat(e))}var ln=e;function pn(e,t,n,r,o){if(ee(e.type,t.type))return e;if(ee(t.type,46)&&ee(e.type,53)&&(e=Dt(e,n).first()),ee(e.type,t.type)||46===t.type)return e;if(ee(e.type,19)){if(!(n=Wt(e,t.type)))throw Error("XPTY0004 Unable to convert "+(o?"return":"argument")+" of type "+ie[e.type]+" to type "+se(t)+" while calling "+r);return n}if(n=function(e,t){if(ee(e.type,2)){if(ee(e.type,6))return 3===t?$(e.value,3):null;if(ee(e.type,4)){if(6===t)return $(e.value,6);if(3===t)return $(e.value,3)}return null}return ee(e.type,20)&&1===t?$(e.value,1):null}(e,t.type),!n)throw Error("XPTY0004 Unable to cast "+(o?"return":"argument")+" of type "+ie[e.type]+" to type "+se(t)+" while calling "+r);return n}function hn(e){switch(e){case 2:return"*";case 1:return"+";case 0:return"?";case 3:return""}}function dn(e,t,n,r,o){return 0===e.g?t.$({default:function(){return t.map((function(t){return pn(t,e,n,r,o)}))},multiple:function(){throw Error("XPTY0004: Multiplicity of "+(o?"function return value":"function argument")+" of type "+ie[e.type]+hn(e.g)+" for "+r+' is incorrect. Expected "?", but got "+".')}}):1===e.g?t.$({empty:function(){throw Error("XPTY0004: Multiplicity of "+(o?"function return value":"function argument")+" of type "+ie[e.type]+hn(e.g)+" for "+r+' is incorrect. Expected "+", but got "empty-sequence()"')},default:function(){return t.map((function(t){return pn(t,e,n,r,o)}))}}):2===e.g?t.map((function(t){return pn(t,e,n,r,o)})):t.$({o:function(){return t.map((function(t){return pn(t,e,n,r,o)}))},default:function(){throw Error("XPTY0004: Multiplicity of "+(o?"function return value":"function argument")+" of type "+ie[e.type]+hn(e.g)+" for "+r+" is incorrect. Expected exactly one")}})}function fn(e,t){return ee(e,5)?$(t,5):ee(e,6)?$(t,6):ee(e,3)?$(t,3):$(t,4)}var mn=[{oa:"M",ma:1e3},{oa:"CM",ma:900},{oa:"D",ma:500},{oa:"CD",ma:400},{oa:"C",ma:100},{oa:"XC",ma:90},{oa:"L",ma:50},{oa:"XL",ma:40},{oa:"X",ma:10},{oa:"IX",ma:9},{oa:"V",ma:5},{oa:"IV",ma:4},{oa:"I",ma:1}];function gn(e,t){var n=parseInt(e,10);if(e=0>n,!(n=Math.abs(n)))return"-";var r=mn.reduce((function(e,t){var r=Math.floor(n/t.ma);return n-=r*t.ma,e+t.oa.repeat(r)}),"");return t&&(r=r.toLowerCase()),e&&(r="-"+r),r}var yn="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");function vn(e,t){var n=0>(e=parseInt(e,10));if(!(e=Math.abs(e)))return"-";for(var r,o="";0<e;)r=(e-1)%yn.length,o=yn[r]+o,e=(e-r)/yn.length|0;return t&&(o=o.toLowerCase()),n&&(o="-"+o),o}function wn(e,t,n,r,o,i){var a=!1;return ge.create({next:function(){if(a)return W;var t,n=o.first();if(!n)return a=!0,W;if((ee(n.type,6)||ee(n.type,3))&&(0===n.value||isNaN(n.value)||1/0===n.value||-1/0===n.value))return a=!0,K(n);if(t=i?i.first().value:0,a=!0,function(e){if(Math.floor(e)===e||isNaN(e))return 0;var t=(e=/\d+(?:\.(\d*))?(?:[Ee](-)?(\d+))*/.exec(""+e))[1]?e[1].length:0;return e[3]?e[2]?t+parseInt(e[3],10):0>(e=t-parseInt(e[3],10))?0:e:t}(n.value)<t)return K(n);var r=[5,4,3,6].find((function(e){return ee(n.type,e)}));switch(t=function(e,t,n){return t&&0==e*n%1%.5?0==Math.floor(e*n)%2?Math.floor(e*n)/n:Math.ceil(e*n)/n:Math.round(e*n)/n}(Wt(n,4).value,e,Math.pow(10,t)),r){case 4:return K($(t,4));case 3:return K($(t,3));case 6:return K($(t,6));case 5:return K($(t,5))}}})}function xn(e,t,n,r){return Rt(r,t).$({empty:function(){return ge.o($(NaN,3))},o:function(){var e=Jt(r.first(),3);return e.v?ge.o(e.value):ge.o($(NaN,3))},multiple:function(){throw Error("fn:number may only be called with zero or one values")}})}function bn(e,t,n,r){if(r.G()||r.ta())return r;for(t=(e=r.N()).length-1;1<t;t--)r=e[n=Math.floor(Math.random()*(t+1))],e[n]=e[t],e[t]=r;return ge.create(e)}var An=[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"abs",l:[{type:2,g:0}],i:{type:2,g:0},m:function(e,t,n,r){return r.map((function(e){return fn(e.type,Math.abs(e.value))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"format-integer",l:[{type:5,g:0},{type:1,g:3}],i:{type:1,g:3},m:function(e,t,n,r,o){if(e=r.first(),o=o.first(),r.G())return ge.o($("",1));switch(o.value){case"I":return r=gn(e.value),ge.o($(r,1));case"i":return r=gn(e.value,!0),ge.o($(r,1));case"A":return ge.o($(vn(e.value),1));case"a":return ge.o($(vn(e.value,!0),1));default:throw Error("Picture: "+o.value+' is not implemented yet. The supported picture strings are "A", "a", "I", and "i"')}}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"ceiling",l:[{type:2,g:0}],i:{type:2,g:0},m:function(e,t,n,r){return r.map((function(e){return fn(e.type,Math.ceil(e.value))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"floor",l:[{type:2,g:0}],i:{type:2,g:0},m:function(e,t,n,r){return r.map((function(e){return fn(e.type,Math.floor(e.value))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"round",l:[{type:2,g:0}],i:{type:2,g:0},m:wn.bind(null,!1)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"round",l:[{type:2,g:0},{type:5,g:3}],i:{type:2,g:0},m:wn.bind(null,!1)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"round-half-to-even",l:[{type:2,g:0}],i:{type:2,g:0},m:wn.bind(null,!0)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"round-half-to-even",l:[{type:2,g:0},{type:5,g:3}],i:{type:2,g:0},m:wn.bind(null,!0)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"number",l:[{type:46,g:0}],i:{type:3,g:3},m:xn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"number",l:[],i:{type:3,g:3},m:function(e,t,n){var r=e.M&&dn({type:46,g:0},ge.o(e.M),t,"fn:number",!1);if(!r)throw Error("XPDY0002: fn:number needs an atomizable context item.");return xn(0,t,0,r)}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"random-number-generator",l:[],i:{type:61,g:3},m:function e(){return ge.o(new $e([{key:$("number",1),value:function(){return ge.o($(Math.random(),3))}},{key:$("next",1),value:function(){return ge.o(new we({value:e,Ra:!0,localName:"",namespaceURI:"",l:[],arity:0,i:{type:61,g:3}}))}},{key:$("permute",1),value:function(){return ge.o(new we({value:bn,Ra:!0,localName:"",namespaceURI:"",l:[{type:59,g:2}],arity:1,i:{type:59,g:2}}))}}]))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"random-number-generator",l:[{type:46,g:0}],i:{type:61,g:3},m:function(){throw Error("Not implemented: Specifying a seed is not supported")}}];function En(){throw Error("FOCH0002: No collations are supported")}function Nn(e,t,n,r){if(null===t.M)throw Error("XPDY0002: The function which was called depends on dynamic context, which is absent.");return e(t,n,r,ge.o(t.M))}function Tn(e,t,n,r){return r.$({empty:function(){return ge.o($("",1))},default:function(){return r.map((function(e){if(ee(e.type,53)){var n=Dt(e,t).first();return ee(e.type,47)?Wt(n,1):n}return Wt(e,1)}))}})}function Bn(e,t,n,r,o){return Xe([o],(function(e){var n=c(e).next().value;return Rt(r,t).L((function(e){return e=e.map((function(e){return Wt(e,1).value})).join(n.value),ge.o($(e,1))}))}))}function In(e,t,n,r){return r.G()?ge.o($(0,5)):(e=r.first().value,ge.o($(Array.from(e).length,5)))}function Cn(e,t,n,r,o,i){var a=wn(!1,0,0,0,o,null),s=null!==i?wn(!1,0,0,0,i,null):null,u=!1,c=null,l=null,p=null;return ge.create({next:function(){return u?W:c||null!==(c=r.first())?(l||(l=a.first()),!p&&i&&(p=null,p=s.first()),u=!0,K($(Array.from(c.value).slice(Math.max(l.value-1,0),i?l.value+p.value-1:void 0).join(""),1))):(u=!0,K($("",1)))}})}function Sn(e,t,n,r,o){return r.G()||0===r.first().value.length?ge.empty():(e=r.first().value,o=Rn(o=o.first().value),ge.create(e.split(o).map((function(e){return $(e,1)}))))}function On(e,t,n,r){return r.G()?ge.o($("",1)):(e=r.first().value.trim(),ge.o($(e.replace(/\s+/g," "),1)))}var kn=new Map,Dn=new Map;function Rn(e){if(Dn.has(e))return Dn.get(e);try{var t=new RegExp(e,"g")}catch(e){throw Error("FORX0002: "+e)}if(t.test(""))throw Error("FORX0003: the pattern "+e+" matches the zero length string");return Dn.set(e,t),t}var Mn=[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"compare",l:[{type:1,g:0},{type:1,g:0}],i:{type:5,g:0},m:function(e,t,n,r,o){return r.G()||o.G()?ge.empty():(e=r.first().value)>(o=o.first().value)?ge.o($(1,5)):e<o?ge.o($(-1,5)):ge.o($(0,5))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"compare",l:[{type:1,g:0},{type:1,g:0},{type:1,g:3}],i:{type:5,g:0},m:En},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"concat",l:[{type:46,g:0},{type:46,g:0},4],i:{type:1,g:3},m:function(e,t,n,r){for(var o=[],i=3;i<arguments.length;++i)o[i-3]=arguments[i];return o=o.map((function(e){return Rt(e,t).L((function(e){return ge.o($(e.map((function(e){return null===e?"":Wt(e,1).value})).join(""),1))}))})),Xe(o,(function(e){return ge.o($(e.map((function(e){return e.value})).join(""),1))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"contains",l:[{type:1,g:0},{type:1,g:0},{type:1,g:0}],i:{type:0,g:3},m:En},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"contains",l:[{type:1,g:0},{type:1,g:0}],i:{type:0,g:3},m:function(e,t,n,r,o){return e=r.G()?"":r.first().value,0===(o=o.G()?"":o.first().value).length?ge.ca():0===e.length?ge.X():e.includes(o)?ge.ca():ge.X()}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"ends-with",l:[{type:1,g:0},{type:1,g:0}],i:{type:0,g:3},m:function(e,t,n,r,o){return 0===(e=o.G()?"":o.first().value).length?ge.ca():0===(r=r.G()?"":r.first().value).length?ge.X():r.endsWith(e)?ge.ca():ge.X()}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"ends-with",l:[{type:1,g:0},{type:1,g:0},{type:1,g:3}],i:{type:0,g:3},m:En},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"normalize-space",l:[{type:1,g:0}],i:{type:1,g:3},m:On},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"normalize-space",l:[],i:{type:1,g:3},m:Nn.bind(null,(function(e,t,n,r){return On(e,0,0,Tn(0,t,0,r))}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"starts-with",l:[{type:1,g:0},{type:1,g:0}],i:{type:0,g:3},m:function(e,t,n,r,o){return 0===(e=o.G()?"":o.first().value).length?ge.ca():0===(r=r.G()?"":r.first().value).length?ge.X():r.startsWith(e)?ge.ca():ge.X()}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"starts-with",l:[{type:1,g:0},{type:1,g:0},{type:1,g:3}],i:{type:0,g:3},m:En},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string",l:[{type:59,g:0}],i:{type:1,g:3},m:Tn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string",l:[],i:{type:1,g:3},m:Nn.bind(null,Tn)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"substring-before",l:[{type:1,g:0},{type:1,g:0}],i:{type:1,g:3},m:function(e,t,n,r,o){return e=r.G()?"":r.first().value,""===(o=o.G()?"":o.first().value)||-1===(o=e.indexOf(o))?ge.o($("",1)):ge.o($(e.substring(0,o),1))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"substring-after",l:[{type:1,g:0},{type:1,g:0}],i:{type:1,g:3},m:function(e,t,n,r,o){return e=r.G()?"":r.first().value,""===(o=o.G()?"":o.first().value)?ge.o($(e,1)):-1===(t=e.indexOf(o))?ge.o($("",1)):ge.o($(e.substring(t+o.length),1))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"substring",l:[{type:1,g:0},{type:3,g:3}],i:{type:1,g:3},m:Cn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"substring",l:[{type:1,g:0},{type:3,g:3},{type:3,g:3}],i:{type:1,g:3},m:Cn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"upper-case",l:[{type:1,g:0}],i:{type:1,g:3},m:function(e,t,n,r){return r.G()?ge.o($("",1)):r.map((function(e){return $(e.value.toUpperCase(),1)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"lower-case",l:[{type:1,g:0}],i:{type:1,g:3},m:function(e,t,n,r){return r.G()?ge.o($("",1)):r.map((function(e){return $(e.value.toLowerCase(),1)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string-join",l:[{type:46,g:2},{type:1,g:3}],i:{type:1,g:3},m:Bn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string-join",l:[{type:46,g:2}],i:{type:1,g:3},m:function(e,t,n,r){return Bn(0,t,0,r,ge.o($("",1)))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string-length",l:[{type:1,g:0}],i:{type:5,g:3},m:In},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string-length",l:[],i:{type:5,g:3},m:Nn.bind(null,(function(e,t,n,r){return In(e,0,0,Tn(0,t,0,r))}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"tokenize",l:[{type:1,g:0},{type:1,g:3},{type:1,g:3}],i:{type:1,g:2},m:function(){throw Error("Not implemented: Using flags in tokenize is not supported")}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"tokenize",l:[{type:1,g:0},{type:1,g:3}],i:{type:1,g:2},m:Sn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"tokenize",l:[{type:1,g:0}],i:{type:1,g:2},m:function(e,t,n,r){return Sn(e,0,0,On(e,0,0,r),ge.o($(" ",1)))}},{l:[{type:1,g:0},{type:1,g:3},{type:1,g:3}],m:function(e,t,n,r,o,i){return Xe([r,o,i],(function(e){var t=c(e),n=t.next().value;e=t.next().value,t=t.next().value,n=Array.from(n?n.value:"");var r=Array.from(e.value),o=Array.from(t.value);return e=n.map((function(e){return r.includes(e)?(e=r.indexOf(e))<=o.length?o[e]:void 0:e})),ge.o($(e.join(""),1))}))},localName:"translate",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{l:[{type:5,g:2}],m:function(e,t,n,r){return r.L((function(e){return e=e.map((function(e){if(9===(e=e.value)||10===e||13===e||32<=e&&55295>=e||57344<=e&&65533>=e||65536<=e&&1114111>=e)return String.fromCodePoint(e);throw Error("FOCH0001")})).join(""),ge.o($(e,1))}))},localName:"codepoints-to-string",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{l:[{type:1,g:0}],m:function(e,t,n,r){return Xe([r],(function(e){return 0===(e=(e=c(e).next().value)?e.value.split(""):[]).length?ge.empty():ge.create(e.map((function(e){return $(e.codePointAt(0),5)})))}))},localName:"string-to-codepoints",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:2}},{l:[{type:1,g:0}],m:function(e,t,n,r){return Xe([r],(function(e){return null===(e=c(e).next().value)||0===e.value.length?ge.create($("",1)):ge.create($(encodeURIComponent(e.value).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})),1))}))},localName:"encode-for-uri",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{l:[{type:1,g:0}],m:function(e,t,n,r){return Xe([r],(function(e){return null===(e=c(e).next().value)||0===e.value.length?ge.create($("",1)):ge.create($(e.value.replace(/([\u00A0-\uD7FF\uE000-\uFDCF\uFDF0-\uFFEF "<>{}|\\^`/\n\u007f\u0080-\u009f]|[\uD800-\uDBFF][\uDC00-\uDFFF])/g,(function(e){return encodeURI(e)})),1))}))},localName:"iri-to-uri",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{l:[{type:1,g:0},{type:1,g:0}],m:function(e,t,n,r,o){return Xe([r,o],(function(e){var t=c(e);if(e=t.next().value,t=t.next().value,null===e||null===t)return ge.empty();if(e=e.value,t=t.value,e.length!==t.length)return ge.X();e=e.split(""),t=t.split("");for(var n=0;n<e.length;n++)if(e[n].codePointAt(0)!==t[n].codePointAt(0))return ge.X();return ge.ca()}))},localName:"codepoint-equal",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:0}},{l:[{type:1,g:0},{type:1,g:3}],m:function(e,t,n,r,o){return Xe([r,o],(function(e){var t=c(e);e=t.next().value,t=t.next().value,e=e?e.value:"",t=t.value;var n=kn.get(t);if(!n){try{n=ln.compile(t,{language:"xpath"})}catch(e){throw Error("FORX0002: "+e)}kn.set(t,n)}return n(e)?ge.ca():ge.X()}))},localName:"matches",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{l:[{type:1,g:0},{type:1,g:3},{type:1,g:3}],m:function(e,t,n,r,o,i){return Xe([r,o,i],(function(e){var t=c(e);e=t.next().value;var n=t.next().value;if(t=t.next().value,e=e?e.value:"",n=n.value,(t=t.value).includes("$0"))throw Error("Using $0 in fn:replace to replace substrings with full matches is not supported.");return t=t.split(/((?:\$\$)|(?:\\\$)|(?:\\\\))/).map((function(e){switch(e){case"\\$":return"$$";case"\\\\":return"\\";case"$$":throw Error('FORX0004: invalid replacement: "$$"');default:return e}})).join(""),n=Rn(n),e=e.replace(n,t),ge.o($(e,1))}))},localName:"replace",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{l:[{type:1,g:0},{type:1,g:3},{type:1,g:3},{type:1,g:3}],localName:"replace",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3},m:function(){throw Error("Not implemented: Using flags in replace is not supported")}}];function Un(e,t,n,r){if(null===t.M)throw Error("XPDY0002: The function which was called depends on dynamic context, which is absent.");return e(t,n,r,ge.o(t.M))}function Fn(e,t,n,r){return Xe([r],(function(e){if(null===(e=c(e).next().value))return ge.empty();switch((e=e.value).node.nodeType){case 1:case 2:return ge.o($(new ve(e.node.prefix,e.node.namespaceURI,e.node.localName),23));case 7:return ge.o($(new ve("","",e.node.target),23));default:return ge.empty()}}))}function Gn(e,t,n,r){return r.$({default:function(){return Tn(0,t,0,Fn(0,0,0,r))},empty:function(){return ge.empty()}})}function Ln(e,t,n,r){return Rt(r,t)}function Pn(e,t,n,r){return Xe([r],(function(e){return null!==(e=(e=c(e).next().value)?e.value:null)&&Me(t.h,e,null)?ge.ca():ge.X()}))}function Hn(e,t,n,r){return Xe([r],(function(e){function n(e){for(var t=0,n=e;null!==n;)(e.node.nodeType!==n.node.nodeType?0:1===n.node.nodeType?n.node.localName===e.node.localName&&n.node.namespaceURI===e.node.namespaceURI:7===n.node.nodeType?n.node.target===e.node.target:1)&&t++,n=Le(o,n,null);return t}var r=c(e).next().value;if(null===r)return ge.empty();var o=t.h;for(e="",r=r.value;null!==Ge(t.h,r,null);r=Ge(t.h,r,null))switch(r.node.nodeType){case 1:var i=r;e="/Q{"+(i.node.namespaceURI||"")+"}"+i.node.localName+"["+n(i)+"]"+e;break;case 2:e="/@"+((i=r).node.namespaceURI?"Q{"+i.node.namespaceURI+"}":"")+i.node.localName+e;break;case 3:e="/text()["+n(r)+"]"+e;break;case 7:e="/processing-instruction("+(i=r).node.target+")["+n(i)+"]"+e;break;case 8:e="/comment()["+n(r)+"]"+e}return 9===r.node.nodeType?ge.create($(e||"/",1)):ge.create($("Q{http://www.w3.org/2005/xpath-functions}root()"+e,1))}))}function _n(e,t,n,r){return r.map((function(e){return $(e.value.node.namespaceURI||"",20)}))}function jn(e,t,n,r){return r.$({default:function(){return r.map((function(e){return 7===e.value.node.nodeType?$(e.value.node.target,1):$(e.value.node.localName||"",1)}))},empty:function(){return ge.o($("",1))}})}function Xn(e,t,n){if(2===t.node.nodeType)return en(t,n);for(;n;){if(en(t,n))return!0;if(9===n.node.nodeType)break;n=Ge(e,n,null)}return!1}function qn(e,t,n,r){return r.map((function(e){if(!ee(e.type,53))throw Error("XPTY0004 Argument passed to fn:root() should be of the type node()");for(e=e.value;e;){var n=e;e=Ge(t.h,n,null)}return je(n)}))}var Vn=[{l:[{type:53,g:0}],m:Gn,localName:"name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:0}},{l:[],m:Un.bind(null,Gn),localName:"name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{l:[{type:53,g:3}],m:_n,localName:"namespace-uri",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:20,g:3}},{l:[],m:Un.bind(null,_n),localName:"namespace-uri",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:20,g:3}},{l:[{type:53,g:2}],m:function(e,t,n,r){return r.L((function(e){return e.length?(e=sn(t.h,e).reduceRight((function(e,n,r,o){return r===o.length-1?(e.push(n),e):(Xn(t.h,n.value,e[0].value)||e.unshift(n),e)}),[]),ge.create(e)):ge.empty()}))},localName:"innermost",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:53,g:2}},{l:[{type:53,g:2}],m:function(e,t,n,r){return r.L((function(e){return e.length?(e=sn(t.h,e).reduce((function(e,n,r){return 0===r?(e.push(n),e):(Xn(t.h,e[e.length-1].value,n.value)||e.push(n),e)}),[]),ge.create(e)):ge.empty()}),1)},localName:"outermost",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:53,g:2}},{l:[{type:53,g:0}],m:Pn,localName:"has-children",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{l:[],m:Un.bind(null,Pn),localName:"has-children",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{l:[{type:53,g:0}],m:Hn,localName:"path",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:0}},{l:[],m:Un.bind(null,Hn),localName:"path",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:0}},{l:[{type:53,g:0}],m:Fn,localName:"node-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:23,g:0}},{l:[],m:Un.bind(null,Fn),localName:"node-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:23,g:0}},{l:[{type:53,g:0}],m:jn,localName:"local-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{l:[],m:Un.bind(null,jn),localName:"local-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{l:[{type:53,g:0}],m:qn,localName:"root",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:53,g:0}},{l:[],m:Un.bind(null,qn),localName:"root",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:53,g:0}},{l:[],m:Un.bind(null,Ln),localName:"data",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:2}},{l:[{type:59,g:2}],m:Ln,localName:"data",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:2}}];function $n(e,t){var n=0,r=e.length,o=!1,i=null;return{next:function(){if(!o){for(;n<r;){i||(i=t(e[n],n,e));var a=i.next(0);if(i=null,!a.value)return K(!1);n++}return o=!0,K(!0)}return W}}}function Yn(e){return 1===(e=e.node.nodeType)||3===e}function zn(e,t){if((ee(e.type,4)||ee(e.type,6))&&(ee(t.type,4)||ee(t.type,6))){var n=Wt(e,6),r=Wt(t,6);return n.value===r.value||isNaN(e.value)&&isNaN(t.value)}return(ee(e.type,4)||ee(e.type,6)||ee(e.type,3))&&(ee(t.type,4)||ee(t.type,6)||ee(t.type,3))?(n=Wt(e,3),r=Wt(t,3),n.value===r.value||isNaN(e.value)&&isNaN(t.value)):ee(e.type,23)&&ee(t.type,23)?e.value.namespaceURI===t.value.namespaceURI&&e.value.localName===t.value.localName:(ee(e.type,9)||ee(e.type,7)||ee(e.type,8)||ee(e.type,11)||ee(e.type,12)||ee(e.type,13)||ee(e.type,14)||ee(e.type,15))&&(ee(t.type,9)||ee(t.type,7)||ee(t.type,8)||ee(t.type,11)||ee(t.type,12)||ee(t.type,13)||ee(t.type,14)||ee(t.type,15))?pt(e.value,t.value):(ee(e.type,16)||ee(e.type,17)||ee(e.type,18))&&(ee(t.type,16)||ee(t.type,17)||ee(t.type,17))?ze(e.value,t.value):e.value===t.value}function Qn(e,t,n){return n=c([t,n].map((function(t){return{type:1,value:t.reduce((function(t,n){return t+Dt(n,e).first().value}),"")}}))),K(zn(t=n.next().value,n=n.next().value))}function Jn(e,t,n,r){for(;e.value&&ee(e.value.type,56);){t.push(e.value);var o=Fe(r,e.value.value);if(e=n.next(0),o&&3!==o.node.nodeType)break}return e}function Wn(e,t,n,r,o){var i,a=t.h,s=r.value,u=o.value,c=null,l=null,p=null,h=[],d=[];return{next:function(){for(;!i;)if(c||(c=s.next(0)),c=Jn(c,h,s,a),l||(l=u.next(0)),l=Jn(l,d,u,a),h.length||d.length){var r=Qn(t,h,d);if(h.length=0,d.length=0,!1===r.value)return i=!0,r}else{if(c.done||l.done)return i=!0,K(c.done===l.done);if(p||(p=Zn(e,t,n,c.value,l.value)),r=p.next(0),p=null,!1===r.value)return i=!0,r;l=c=null}return W}}}function Kn(e,t,n,r,o){return r=De(t.h,r.value),o=De(t.h,o.value),r=r.filter((function(e){return Yn(e)})),o=o.filter((function(e){return Yn(e)})),r=ge.create(r.map((function(e){return je(e)}))),o=ge.create(o.map((function(e){return je(e)}))),Wn(e,t,n,r,o)}function Zn(e,t,n,r,o){if(ee(r.type,46)&&ee(o.type,46))return Kt(zn(r,o));if(ee(r.type,61)&&ee(o.type,61))return function(e,t,n,r,o){return r.h.length!==o.h.length?Kt(!1):$n(r.h,(function(r){var i=o.h.find((function(e){return zn(e.key,r.key)}));return i?Wn(e,t,n,r.value(),i.value()):Kt(!1)}))}(e,t,n,r,o);if(ee(r.type,62)&&ee(o.type,62))return function(e,t,n,r,o){return r.R.length!==o.R.length?Kt(!1):$n(r.R,(function(r,i){return i=o.R[i],Wn(e,t,n,r(),i())}))}(e,t,n,r,o);if(ee(r.type,53)&&ee(o.type,53)){if(ee(r.type,55)&&ee(o.type,55))return Kn(e,t,n,r,o);if(ee(r.type,54)&&ee(o.type,54))return function(e,t,n,r,o){var i=Wn(e,t,n,Fn(0,0,0,ge.o(r)),Fn(0,0,0,ge.o(o))),a=Kn(e,t,n,r,o);r=Oe(t.h,r.value).filter((function(e){return"http://www.w3.org/2000/xmlns/"!==e.node.namespaceURI})).sort((function(e,t){return e.node.nodeName>t.node.nodeName?1:-1})).map((function(e){return je(e)})),o=Oe(t.h,o.value).filter((function(e){return"http://www.w3.org/2000/xmlns/"!==e.node.namespaceURI})).sort((function(e,t){return e.node.nodeName>t.node.nodeName?1:-1})).map((function(e){return je(e)}));var s=Wn(e,t,n,ge.create(r),ge.create(o)),u=!1;return{next:function(){if(u)return W;var e=i.next(0);return!e.done&&!1===e.value||!(e=s.next(0)).done&&!1===e.value?(u=!0,e):(e=a.next(0),u=!0,e)}}}(e,t,n,r,o);if(ee(r.type,47)&&ee(o.type,47)||ee(r.type,57)&&ee(o.type,57)||ee(r.type,58)&&ee(o.type,58))return function(e,t,n,r,o){var i=Wn(e,t,n,Fn(0,0,0,ge.o(r)),Fn(0,0,0,ge.o(o))),a=!1;return{next:function(){if(a)return W;var e=i.next(0);return e.done||!1!==e.value?K(zn(Dt(r,t).first(),Dt(o,t).first())):(a=!0,e)}}}(e,t,n,r,o)}return Kt(!1)}function er(e){return Error("XUST0001: "+(void 0===e?"Can not execute an updating expression in a non-updating context.":e))}function tr(e){return Error("XUTY0004: The attribute "+e.name+'="'+e.value+'" follows a node that is not an attribute node.')}function nr(){return Error("XUTY0005: The target of a insert expression with into must be a single element or document node.")}function rr(){return Error("XUTY0006: The target of a insert expression with before or after must be a single element, text, comment, or processing instruction node.")}function or(){return Error("XUTY0008: The target of a replace expression must be a single element, attribute, text, comment, or processing instruction node.")}function ir(){return Error("XUTY0012: The target of a rename expression must be a single element, attribute, or processing instruction node.")}function ar(e){return Error("XUDY0017: The target "+e.outerHTML+" is used in more than one replace value of expression.")}function sr(e){return Error("XUDY0021: Applying the updates will result in the XDM instance violating constraint: '"+e+"'")}function ur(e){return Error("XUDY0023: The namespace binding "+e+" is conflicting.")}function cr(e){return Error("XUDY0024: The namespace binding "+e+" is conflicting.")}function lr(){return Error("XUDY0027: The target for an insert, replace, or rename expression expression should not be empty.")}function pr(e,t,n,r,o){n=void 0===n?{C:!1,Y:!1,S:"unsorted",subtree:!1}:n,this.s=e,this.O=n.S||"unsorted",this.subtree=!!n.subtree,this.Y=!!n.Y,this.C=!!n.C,this.ha=t,this.I=!1,this.$a=null,this.dc=void 0!==r&&r,this.type=o}function hr(e,t,n){return t&&null!==t.M&&e.C?(null===e.$a&&(e.$a=ye(e.h(null,n).qb())),e=e.$a()):e=e.h(t,n),e}function dr(e,t){this.H=e,this.fa=t}function fr(e){e&&"object"==typeof e&&"nodeType"in e&&("function"==typeof(e=e.ownerDocument||e).createElementNS&&"function"==typeof e.createProcessingInstruction&&"function"==typeof e.createTextNode&&"function"==typeof e.createComment&&(this.h=e)),this.h||(this.h=null)}function mr(e,t,n){t.forEach((function(t){n.insertBefore(e.node,t.node,null)}))}function gr(e,t,n,r){var o=Ge(n,e),i=e.node.nodeType;if(2===i){if(t.some((function(e){return 2!==e.node.nodeType})))throw Error('Constraint "If $target is an attribute node, $replacement must consist of zero or more attribute nodes." failed.');var a=o?o.node:null;r.removeAttributeNS(a,e.node.namespaceURI,e.node.nodeName),t.forEach((function(e){var t=e.node.nodeName;if(ke(n,o,t))throw sr("An attribute "+t+" already exists.");r.setAttributeNS(a,e.node.namespaceURI,t,Re(n,e))}))}if(1===i||3===i||8===i||7===i){var s=(i=Fe(n,e))?i.node:null;r.removeChild(o.node,e.node),t.forEach((function(e){r.insertBefore(o.node,e.node,s)}))}}function yr(e,t,n,r){if(function(e,t){function n(e){return new ve(e.node.prefix,e.node.namespaceURI,e.node.localName)}function r(t,n){var r=new Set;e.filter((function(e){return e.type===t})).map((function(e){return e.target})).forEach((function(e){e=e?e.node:null,r.has(e)&&n(e),r.add(e)}))}r("rename",(function(e){throw Error("XUDY0015: The target "+e.outerHTML+" is used in more than one rename expression.")})),r("replaceNode",(function(e){throw Error("XUDY0016: The target "+e.outerHTML+" is used in more than one replace expression.")})),r("replaceValue",(function(e){throw ar(e)})),r("replaceElementContent",(function(e){throw ar(e)}));var o=new Map;e.filter((function(e){return"replaceNode"===e.type&&2===e.target.node.nodeType})).forEach((function(e){var r=Ge(t,e.target);r=r?r.node:null;var i=o.get(r);i?i.push.apply(i,p(e.s.map(n))):o.set(r,e.s.map(n))})),e.filter((function(e){return"rename"===e.type&&2===e.target.node.nodeType})).forEach((function(e){var n=Ge(t,e.target);if(n){n=n.node;var r=o.get(n);r?r.push(e.s):o.set(n,[e.s])}})),o.forEach((function(e){var t={};e.forEach((function(e){if(t[e.prefix]||(t[e.prefix]=e.namespaceURI),t[e.prefix]!==e.namespaceURI)throw cr(e.namespaceURI)}))}))}(e,t),e.filter((function(e){return-1!==["insertInto","insertAttributes","replaceValue","rename"].indexOf(e.type)})).forEach((function(e){switch(e.type){case"insertInto":mr(e.target,e.content,r);break;case"insertAttributes":!function(e,t,n,r){t.forEach((function(t){var o=t.node.nodeName;if(ke(n,e,o))throw sr("An attribute "+o+" already exists.");r.setAttributeNS(e.node,t.node.namespaceURI,o,Re(n,t))}))}(e.target,e.content,t,r);break;case"rename":!function(e,t,n,r,o){switch(r||(r=new fr(e?e.node:null)),e.node.nodeType){case 1:var i=n.getAllAttributes(e.node),a=n.getChildNodes(e.node),s=r.createElementNS(t.namespaceURI,t.ya()),u={node:s,F:null};i.forEach((function(e){o.setAttributeNS(s,e.namespaceURI,e.nodeName,e.value)})),a.forEach((function(e){o.insertBefore(s,e,null)}));break;case 2:(t=r.createAttributeNS(t.namespaceURI,t.ya())).value=Re(n,e),u={node:t,F:null};break;case 7:u={node:r.createProcessingInstruction(t.ya(),Re(n,e)),F:null}}if(!Ge(n,e))throw Error("Not supported: renaming detached nodes.");gr(e,[u],n,o)}(e.target,e.s,t,n,r);break;case"replaceValue":var o=e.target;if(e=e.s,2===o.node.nodeType){var i=Ge(t,o);i?r.setAttributeNS(i.node,o.node.namespaceURI,o.node.nodeName,e):o.node.value=e}else r.setData(o.node,e)}})),e.filter((function(e){return-1!==["insertBefore","insertAfter","insertIntoAsFirst","insertIntoAsLast"].indexOf(e.type)})).forEach((function(e){switch(e.type){case"insertAfter":!function(e,t,n,r){var o=Ge(n,e).node,i=(e=Fe(n,e))?e.node:null;t.forEach((function(e){r.insertBefore(o,e.node,i)}))}(e.target,e.content,t,r);break;case"insertBefore":!function(e,t,n,r){var o=Ge(n,e).node;t.forEach((function(t){r.insertBefore(o,t.node,e.node)}))}(e.target,e.content,t,r);break;case"insertIntoAsFirst":!function(e,t,n,r){var o=(n=Me(n,e))?n.node:null;t.forEach((function(t){r.insertBefore(e.node,t.node,o)}))}(e.target,e.content,t,r);break;case"insertIntoAsLast":mr(e.target,e.content,r)}})),e.filter((function(e){return"replaceNode"===e.type})).forEach((function(e){gr(e.target,e.s,t,r)})),e.filter((function(e){return"replaceElementContent"===e.type})).forEach((function(e){!function(e,t,n,r){n.getChildNodes(e.node).forEach((function(t){return r.removeChild(e.node,t)})),t&&r.insertBefore(e.node,t.node,null)}(e.target,e.text,t,r)})),e.filter((function(e){return"delete"===e.type})).forEach((function(e){e=e.target;var n=Ge(t,e);(n=n?n.node:null)&&(2===e.node.nodeType?r.removeAttributeNS(n,e.node.namespaceURI,e.node.nodeName):r.removeChild(n,e.node))})),e.some((function(e){return"put"===e.type})))throw Error('Not implemented: the execution for pendingUpdate "put" is not yet implemented.')}function vr(e,t){for(var n=[],r=1;r<arguments.length;++r)n[r-1]=arguments[r];return e.concat.apply(e,p(n.filter(Boolean)))}function wr(e,t,n,r){pr.call(this,e,t,n,!0,r),this.I=!0}function xr(e){return e.I?function(t,n){return e.u(t,n)}:function(t,n){var r=e.h(t,n);return{next:function(){return K({fa:[],H:r.N()})}}}}function br(e,t){return t((e=e.next(0)).value.fa),ge.create(e.value.H)}function Ar(e,t,n,r){wr.call(this,e,t,n,r),this.I=this.ha.some((function(e){return e.I}))}pr.prototype.A=function(){return null},pr.prototype.P=function(e){if(this.ha.forEach((function(t){return t.P(e)})),!this.dc&&this.ha.some((function(e){return e.I})))throw er()},(r=fr.prototype).createAttributeNS=function(e,t){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createAttributeNS(e,t)},r.createCDATASection=function(e){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createCDATASection(e)},r.createComment=function(e){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createComment(e)},r.createDocument=function(){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.implementation.createDocument(null,null,null)},r.createElementNS=function(e,t){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createElementNS(e,t)},r.createProcessingInstruction=function(e,t){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createProcessingInstruction(e,t)},r.createTextNode=function(e){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createTextNode(e)},y(wr,pr),wr.prototype.h=function(){throw er()},y(Ar,wr),Ar.prototype.h=function(e,t){return this.B(e,t,this.ha.map((function(e){return function(n){return e.h(n,t)}})))},Ar.prototype.u=function(e,t){var n=[],r=this.B(e,t,this.ha.map((function(e){return e.I?function(r){return br(r=e.u(r,t),(function(e){return n=vr(n,e)}))}:function(n){return e.h(n,t)}}))),o=!1;return{next:function(){if(o)return W;var e=r.N();return o=!0,K(new dr(e,n))}}},Ar.prototype.P=function(e){wr.prototype.P.call(this,e),function(e){e.ha.some((function(e){return e.I}))&&(e.I=!0)}(this)};var Er=["external","attribute","nodeName","nodeType","universal"],Nr=Er.length;function Tr(e){if(this.h=Er.map((function(t){return e[t]||0})),Object.keys(e).some((function(e){return!Er.includes(e)})))throw Error("Invalid specificity kind passed")}function Br(e,t){for(var n=0;n<Nr;++n){if(t.h[n]<e.h[n])return 1;if(t.h[n]>e.h[n])return-1}return 0}function Ir(){return St("Expected base expression of a function call to evaluate to a sequence of single function item")}function Cr(e,t,n,r){for(var o=[],i=0;i<t.length;++i)if(null===t[i])o.push(null);else{var a=dn(e[i],t[i],n,r,!1);o.push(a)}return o}function Sr(e,t){if(!ee(e.type,60))throw St("Expected base expression to evaluate to a function item");if(e.A!==t)throw Ir();return e}function Or(e,t,n,r,o,i,a){var s=0;return o=o.map((function(e){return e?null:i[s++](n)})),0<=(o=Cr(e.s,o,r,e.j)).indexOf(null)?function(e,t){var n=e.value,r=t.map((function(e){return null===e?null:ye(e)}));return t=t.reduce((function(t,n,r){return null===n&&t.push(e.s[r]),t}),[]),t=new we({l:t,arity:t.length,Ra:!0,I:e.I,localName:"boundFunction",namespaceURI:e.u,i:e.O,value:function(e,t,o){var i=Array.from(arguments).slice(3),a=r.map((function(e){return null===e?i.shift():e()}));return n.apply(void 0,[e,t,o].concat(a))}}),ge.o(t)}(e,o):(t=t.apply(void 0,[n,r,a].concat(p(o))),dn(e.O,t,r,e.j,!0))}function kr(e,t,n){var r={};Ar.call(this,new Tr((r.external=1,r)),[e].concat(t.filter((function(e){return!!e}))),{S:"unsorted",Y:!1,subtree:!1,C:!1},n),this.ka=t.length,this.T=t.map((function(e){return null===e})),this.J=null,this.pa=e,this.xa=t}function Dr(e,t,n,r,o,i){return Xe([r,o,i],(function(e){var t=c(e);e=t.next().value;var n=t.next().value;if(t=t.next().value,n=n.value,t=t.value,n>e.R.length||0>=n)throw Error("FOAY0001: subarray start out of bounds.");if(0>t)throw Error("FOAY0002: subarray length out of bounds.");if(n+t>e.R.length+1)throw Error("FOAY0001: subarray start + length out of bounds.");return ge.o(new He(e.R.slice(n-1,t+n-1)))}))}function Rr(e,t,n,r,o){return Xe([r],(function(e){var t=c(e).next().value;return o.L((function(e){e=e.map((function(e){return e.value})).sort((function(e,t){return t-e})).filter((function(e,t,n){return n[t-1]!==e}));for(var n=t.R.concat(),r=0,o=e.length;r<o;++r){var i=e[r];if(i>t.R.length||0>=i)throw Error("FOAY0001: subarray position out of bounds.");n.splice(i-1,1)}return ge.o(new He(n))}))}))}function Mr(e){return ee(e,1)||ee(e,20)||ee(e,19)}function Ur(e,t,n,r,o){return 0===r.length?0!==o.length:0!==o.length&&Zn(e,t,n,r[0],o[0]).next(0).value?Ur(e,t,n,r.slice(1),o.slice(1)):r[0].value!=r[0].value||(Mr(r[0].type)&&0!==o.length&&Mr(o[0].type)||0!==o.length)&&r[0].value<o[0].value}function Fr(e,t,n,r){return r.sort((function(r,o){return Wn(e,t,n,ge.create(r),ge.create(o)).next(0).value?0:Ur(e,t,n,r,o)?-1:1})),ge.o(new He(r.map((function(e){return function(){return ge.create(e)}}))))}function Gr(e,t){return ee(t.type,62)?t.R.reduce((function(e,t){return t().L((function(t){return t.reduce(Gr,e)}))}),e):It([e,ge.o(t)])}Tr.prototype.add=function(e){var t=this,n=Er.reduce((function(n,r,o){return n[r]=t.h[o]+e.h[o],n}),Object.create(null));return new Tr(n)},y(kr,Ar),kr.prototype.u=function(e,t){var n=this;if(!this.j||!this.j.I)return Ar.prototype.u.call(this,e,t);var r=[],o=Or(this.j,(function(e,t,o,i){for(var a=[],s=3;s<arguments.length;++s)a[s-3]=arguments[s];return br(n.j.value.apply(n.j,[e,t,o].concat(p(a))),(function(e){r=vr(r,e)}))}),e,t,this.T,this.xa.map((function(n){return function(){return n.I?br(n.u(e,t),(function(e){r=vr(r,e)})):hr(n,e,t)}})),this.J),i=!1;return{next:function(){if(i)return W;var e=o.N();return i=!0,K({fa:r,H:e})}}},kr.prototype.B=function(e,t,n){var r=this,o=(n=c(n)).next().value,i=l(n);if(this.j)return Or(this.j,(function(e,t,n,o){for(var i=[],a=3;a<arguments.length;++a)i[a-3]=arguments[a];return r.j.value.apply(r.j,[e,t,n].concat(p(i)))}),e,t,this.T,i,this.J);var a=o(e);return a.$({default:function(){throw Ir()},o:function(){return a.L((function(n){if((n=Sr(n=c(n).next().value,r.ka)).I)throw Error("XUDY0038: The function returned by the PrimaryExpr of a dynamic function invocation can not be an updating function");return Or(n,n.value,e,t,r.T,i,r.J)}))}})},kr.prototype.P=function(e){if(this.J=To(e),Ar.prototype.P.call(this,e),this.pa.C){if(!(e=hr(this.pa,null,null)).ta())throw Ir();this.j=Sr(e.first(),this.ka),this.j.I&&(this.I=!0)}};var Lr=[{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"size",l:[{type:62,g:3}],i:{type:5,g:3},m:function(e,t,n,r){return Xe([r],(function(e){return e=c(e).next().value,ge.o($(e.R.length,5))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"get",l:[{type:62,g:3},{type:5,g:3}],i:{type:59,g:2},m:Pe},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"put",l:[{type:62,g:3},{type:5,g:3},{type:59,g:2}],i:{type:62,g:3},m:function(e,t,n,r,o,i){return Xe([o,r],(function(e){var t=c(e);if(e=t.next().value,t=t.next().value,0>=(e=e.value)||e>t.R.length)throw Error("FOAY0001: array position out of bounds.");return(t=t.R.concat()).splice(e-1,1,ye(i)),ge.o(new He(t))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"append",l:[{type:62,g:3},{type:59,g:2}],i:{type:62,g:3},m:function(e,t,n,r,o){return Xe([r],(function(e){return e=c(e).next().value.R.concat([ye(o)]),ge.o(new He(e))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"subarray",l:[{type:62,g:3},{type:5,g:3},{type:5,g:3}],i:{type:62,g:3},m:Dr},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"subarray",l:[{type:62,g:3},{type:5,g:3}],i:{type:62,g:3},m:function(e,t,n,r,o){var i=ge.o($(r.first().value.length-o.first().value+1,5));return Dr(0,0,0,r,o,i)}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"remove",l:[{type:62,g:3},{type:5,g:2}],i:{type:62,g:3},m:Rr},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"insert-before",l:[{type:62,g:3},{type:5,g:3},{type:59,g:2}],i:{type:62,g:3},m:function(e,t,n,r,o,i){return Xe([r,o],(function(e){var t=c(e);if(e=t.next().value,(t=t.next().value.value)>e.R.length+1||0>=t)throw Error("FOAY0001: subarray position out of bounds.");return(e=e.R.concat()).splice(t-1,0,ye(i)),ge.o(new He(e))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"head",l:[{type:62,g:3}],i:{type:59,g:2},m:function(e,t,n,r){return Pe(0,0,0,r,ge.o($(1,5)))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"tail",l:[{type:62,g:3}],i:{type:59,g:2},m:function(e,t,n,r){return Rr(0,0,0,r,ge.o($(1,5)))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"reverse",l:[{type:62,g:3}],i:{type:62,g:3},m:function(e,t,n,r){return Xe([r],(function(e){return e=c(e).next().value,ge.o(new He(e.R.concat().reverse()))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"join",l:[{type:62,g:2}],i:{type:62,g:3},m:function(e,t,n,r){return r.L((function(e){return e=e.reduce((function(e,t){return e.concat(t.R)}),[]),ge.o(new He(e))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"for-each",l:[{type:62,g:3},{type:60,g:3}],i:{type:62,g:3},m:function(e,t,n,r,o){return Xe([r,o],(function(r){var o=(r=c(r)).next().value,i=r.next().value;if(1!==i.A)throw St("The callback passed into array:for-each has a wrong arity.");return r=o.R.map((function(r){return ye(i.value.call(void 0,e,t,n,Cr(i.s,[r()],t,"array:for-each")[0]))})),ge.o(new He(r))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"filter",l:[{type:62,g:3},{type:60,g:3}],i:{type:62,g:3},m:function(e,t,n,r,o){return Xe([r,o],(function(r){var o=(r=c(r)).next().value,i=r.next().value;if(1!==i.A)throw St("The callback passed into array:filter has a wrong arity.");var a=o.R.map((function(r){return r=Cr(i.s,[r()],t,"array:filter")[0],(0,i.value)(e,t,n,r)})),s=[],u=!1;return ge.create({next:function(){if(u)return W;for(var e=0,t=o.R.length;e<t;++e){var n=a[e].getEffectiveBooleanValue();s[e]=n}return e=o.R.filter((function(e,t){return s[t]})),u=!0,K(new He(e))}})}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"fold-left",l:[{type:62,g:3},{type:59,g:2},{type:60,g:3}],i:{type:59,g:2},m:function(e,t,n,r,o,i){return Xe([r,i],(function(r){var i=(r=c(r)).next().value,a=r.next().value;if(2!==a.A)throw St("The callback passed into array:fold-left has a wrong arity.");return i.R.reduce((function(r,o){return o=Cr(a.s,[o()],t,"array:fold-left")[0],a.value.call(void 0,e,t,n,r,o)}),o)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"fold-right",l:[{type:62,g:3},{type:59,g:2},{type:60,g:3}],i:{type:59,g:2},m:function(e,t,n,r,o,i){return Xe([r,i],(function(r){var i=(r=c(r)).next().value,a=r.next().value;if(2!==a.A)throw St("The callback passed into array:fold-right has a wrong arity.");return i.R.reduceRight((function(r,o){return o=Cr(a.s,[o()],t,"array:fold-right")[0],a.value.call(void 0,e,t,n,r,o)}),o)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"for-each-pair",l:[{type:62,g:3},{type:62,g:3},{type:60,g:3}],i:{type:62,g:3},m:function(e,t,n,r,o,i){return Xe([r,o,i],(function(r){var o=c(r);r=o.next().value;var i=o.next().value;if(2!==(o=o.next().value).A)throw St("The callback passed into array:for-each-pair has a wrong arity.");for(var a=[],s=0,u=Math.min(r.R.length,i.R.length);s<u;++s){var l=c(Cr(o.s,[r.R[s](),i.R[s]()],t,"array:for-each-pair")),p=l.next().value;l=l.next().value,a[s]=ye(o.value.call(void 0,e,t,n,p,l))}return ge.o(new He(a))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"sort",l:[{type:62,g:3}],i:{type:62,g:3},m:function(e,t,n,r){return Xe([r],(function(r){return r=c(r).next().value.R.map((function(e){return e().N()})),Fr(e,t,n,r)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"flatten",l:[{type:59,g:2}],i:{type:59,g:2},m:function(e,t,n,r){return r.L((function(e){return e.reduce(Gr,ge.empty())}))}}];function Pr(e,t,n,r,o){return o.G()?o:ge.o(Wt(o.first(),e))}var Hr=[{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"untypedAtomic",l:[{type:46,g:0}],i:{type:19,g:0},m:Pr.bind(null,19)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"error",l:[{type:46,g:0}],i:{type:39,g:0},m:Pr.bind(null,39)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"string",l:[{type:46,g:0}],i:{type:1,g:0},m:Pr.bind(null,1)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"boolean",l:[{type:46,g:0}],i:{type:0,g:0},m:Pr.bind(null,0)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"decimal",l:[{type:46,g:0}],i:{type:4,g:0},m:Pr.bind(null,4)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"float",l:[{type:46,g:0}],i:{type:6,g:0},m:Pr.bind(null,6)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"double",l:[{type:46,g:0}],i:{type:3,g:0},m:Pr.bind(null,3)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"duration",l:[{type:46,g:0}],i:{type:18,g:0},m:Pr.bind(null,18)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"dateTime",l:[{type:46,g:0}],i:{type:9,g:0},m:Pr.bind(null,9)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"dateTimeStamp",l:[{type:46,g:0}],i:{type:10,g:0},m:Pr.bind(null,10)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"time",l:[{type:46,g:0}],i:{type:8,g:0},m:Pr.bind(null,8)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"date",l:[{type:46,g:0}],i:{type:7,g:0},m:Pr.bind(null,7)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gYearMonth",l:[{type:46,g:0}],i:{type:11,g:0},m:Pr.bind(null,11)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gYear",l:[{type:46,g:0}],i:{type:12,g:0},m:Pr.bind(null,12)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gMonthDay",l:[{type:46,g:0}],i:{type:13,g:0},m:Pr.bind(null,13)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gDay",l:[{type:46,g:0}],i:{type:15,g:0},m:Pr.bind(null,15)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gMonth",l:[{type:46,g:0}],i:{type:14,g:0},m:Pr.bind(null,14)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"hexBinary",l:[{type:46,g:0}],i:{type:22,g:0},m:Pr.bind(null,22)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"base64Binary",l:[{type:46,g:0}],i:{type:21,g:0},m:Pr.bind(null,21)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"QName",l:[{type:46,g:0}],i:{type:23,g:0},m:function(e,t,n,r){if(r.G())return r;if(ee((e=r.first()).type,2))throw Error("XPTY0004: The provided QName is not a string-like value.");if(!Ft(e=Ut(e=Wt(e,1).value,23),23))throw Error("FORG0001: The provided QName is invalid.");if(!e.includes(":"))return n=n.ba(""),ge.o($(new ve("",n,e),23));if(t=(r=c(e.split(":"))).next().value,r=r.next().value,!(n=n.ba(t)))throw Error("FONS0004: The value "+e+" can not be cast to a QName. Did you mean to use fn:QName?");return ge.o($(new ve(t,n,r),23))}},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"anyURI",l:[{type:46,g:0}],i:{type:20,g:0},m:Pr.bind(null,20)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"normalizedString",l:[{type:46,g:0}],i:{type:48,g:0},m:Pr.bind(null,48)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"token",l:[{type:46,g:0}],i:{type:52,g:0},m:Pr.bind(null,52)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"language",l:[{type:46,g:0}],i:{type:51,g:0},m:Pr.bind(null,51)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"NMTOKEN",l:[{type:46,g:0}],i:{type:50,g:0},m:Pr.bind(null,50)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"NMTOKENS",l:[{type:46,g:0}],i:{type:49,g:2},m:Pr.bind(null,49)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"Name",l:[{type:46,g:0}],i:{type:25,g:0},m:Pr.bind(null,25)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"NCName",l:[{type:46,g:0}],i:{type:24,g:0},m:Pr.bind(null,24)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"ID",l:[{type:46,g:0}],i:{type:42,g:0},m:Pr.bind(null,42)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"IDREF",l:[{type:46,g:0}],i:{type:41,g:0},m:Pr.bind(null,41)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"IDREFS",l:[{type:46,g:0}],i:{type:43,g:2},m:Pr.bind(null,43)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"ENTITY",l:[{type:46,g:0}],i:{type:26,g:0},m:Pr.bind(null,26)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"ENTITIES",l:[{type:46,g:0}],i:{type:40,g:2},m:Pr.bind(null,40)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"integer",l:[{type:46,g:0}],i:{type:5,g:0},m:Pr.bind(null,5)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"nonPositiveInteger",l:[{type:46,g:0}],i:{type:27,g:0},m:Pr.bind(null,27)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"negativeInteger",l:[{type:46,g:0}],i:{type:28,g:0},m:Pr.bind(null,28)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"long",l:[{type:46,g:0}],i:{type:31,g:0},m:Pr.bind(null,31)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"int",l:[{type:46,g:0}],i:{type:32,g:0},m:Pr.bind(null,32)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"short",l:[{type:46,g:0}],i:{type:33,g:0},m:Pr.bind(null,33)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"byte",l:[{type:46,g:0}],i:{type:34,g:0},m:Pr.bind(null,34)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"nonNegativeInteger",l:[{type:46,g:0}],i:{type:30,g:0},m:Pr.bind(null,30)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"unsignedLong",l:[{type:46,g:0}],i:{type:36,g:0},m:Pr.bind(null,36)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"unsignedInt",l:[{type:46,g:0}],i:{type:35,g:0},m:Pr.bind(null,35)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"unsignedShort",l:[{type:46,g:0}],i:{type:38,g:0},m:Pr.bind(null,38)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"unsignedByte",l:[{type:46,g:0}],i:{type:37,g:0},m:Pr.bind(null,37)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"positiveInteger",l:[{type:46,g:0}],i:{type:29,g:0},m:Pr.bind(null,29)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"yearMonthDuration",l:[{type:46,g:0}],i:{type:16,g:0},m:Pr.bind(null,16)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"dayTimeDuration",l:[{type:46,g:0}],i:{type:17,g:0},m:Pr.bind(null,17)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"dateTimeStamp",l:[{type:46,g:0}],i:{type:10,g:0},m:Pr.bind(null,10)}];function _r(e,t,n,r){return r.G()?r:ge.o($(r.first().value.getYear(),5))}function jr(e,t,n,r){return r.G()?r:ge.o($(r.first().value.getMonth(),5))}function Xr(e,t,n,r){return r.G()?r:ge.o($(r.first().value.getDay(),5))}function qr(e,t,n,r){return r.G()?r:ge.o($(r.first().value.getHours(),5))}function Vr(e,t,n,r){return r.G()?r:ge.o($(r.first().value.getMinutes(),5))}function $r(e,t,n,r){return r.G()||(t=(e=ge).o,r=r.first().value,r=t.call(e,$(r.j+r.ra,4))),r}function Yr(e,t,n,r){return r.G()?r:(e=r.first().value.Z)?ge.o($(e,17)):ge.empty()}var zr=[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"dateTime",l:[{type:7,g:0},{type:8,g:0}],i:{type:9,g:0},m:function(e,t,n,r,o){if(r.G())return r;if(o.G())return o;if(e=r.first().value,o=o.first().value,t=e.Z,n=o.Z,t||n){if(!t||n)if(!t&&n)t=n;else if(!ze(t,n))throw Error("FORG0008: fn:dateTime: got a date and time value with different timezones.")}else t=null;return ge.o($(new at(e.getYear(),e.getMonth(),e.getDay(),o.getHours(),o.getMinutes(),o.getSeconds(),o.ra,t),9))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"year-from-dateTime",l:[{type:9,g:0}],i:{type:5,g:0},m:_r},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"month-from-dateTime",l:[{type:9,g:0}],i:{type:5,g:0},m:jr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"day-from-dateTime",l:[{type:9,g:0}],i:{type:5,g:0},m:Xr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"hours-from-dateTime",l:[{type:9,g:0}],i:{type:5,g:0},m:qr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"minutes-from-dateTime",l:[{type:9,g:0}],i:{type:5,g:0},m:Vr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"seconds-from-dateTime",l:[{type:9,g:0}],i:{type:4,g:0},m:$r},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"timezone-from-dateTime",l:[{type:9,g:0}],i:{type:17,g:0},m:Yr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"year-from-date",l:[{type:7,g:0}],i:{type:5,g:0},m:_r},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"month-from-date",l:[{type:7,g:0}],i:{type:5,g:0},m:jr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"day-from-date",l:[{type:7,g:0}],i:{type:5,g:0},m:Xr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"timezone-from-date",l:[{type:7,g:0}],i:{type:17,g:0},m:Yr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"hours-from-time",l:[{type:8,g:0}],i:{type:5,g:0},m:qr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"minutes-from-time",l:[{type:8,g:0}],i:{type:5,g:0},m:Vr},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"seconds-from-time",l:[{type:8,g:0}],i:{type:4,g:0},m:$r},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"timezone-from-time",l:[{type:8,g:0}],i:{type:17,g:0},m:Yr}];function Qr(e,t){var n=t.h,r=t.s,o=t.j;switch(e.node.nodeType){case 1:var i=r.createElementNS(e.node.namespaceURI,e.node.nodeName);for(n.getAllAttributes(e.node).forEach((function(e){return o.setAttributeNS(i,e.namespaceURI,e.nodeName,e.value)})),e=(r=c(De(n,e))).next();!e.done;e=r.next())e=Qr(e.value,t),o.insertBefore(i,e.node,null);return{node:i,F:null};case 2:return(t=r.createAttributeNS(e.node.namespaceURI,e.node.nodeName)).value=Re(n,e),{node:t,F:null};case 4:return{node:r.createCDATASection(Re(n,e)),F:null};case 8:return{node:r.createComment(Re(n,e)),F:null};case 9:for(r=r.createDocument(),e=(n=c(De(n,e))).next();!e.done;e=n.next())e=Qr(e.value,t),o.insertBefore(r,e.node,null);return{node:r,F:null};case 7:return{node:r.createProcessingInstruction(e.node.target,Re(n,e)),F:null};case 3:return{node:r.createTextNode(Re(n,e)),F:null}}}function Jr(e,t){var n=t.j,r=t.s,o=t.h;if(!Ie(e.node))return Qr(e,t).node;switch(e.node.nodeType){case 2:return(r=r.createAttributeNS(e.node.namespaceURI,e.node.nodeName)).value=Re(o,e),r;case 8:return r.createComment(Re(o,e));case 1:var i=e.node.prefix,a=e.node.localName,s=r.createElementNS(e.node.namespaceURI,i?i+":"+a:a);return De(o,e).forEach((function(e){e=Jr(e,t),n.insertBefore(s,e,null)})),Oe(o,e).forEach((function(e){n.setAttributeNS(s,e.node.namespaceURI,e.node.nodeName,Re(o,e))})),s.normalize(),s;case 7:return r.createProcessingInstruction(e.node.target,Re(o,e));case 3:return r.createTextNode(Re(o,e))}}function Wr(e,t,n){var r=e.node;if(!(Ie(r)||n||e.F))return r;r=t.ha;var o=[];return n?Jr(e,t):(e=function(e,t,n){var r=e;for(e=Ge(n,r);null!==e;){if(2===r.node.nodeType)t.push(r.node.nodeName);else{var o=De(n,e);t.push(o.findIndex((function(e){return en(e,r)})))}e=Ge(n,r=e)}return r}(e,o,t.h),(n=r.get(e.node))||(n={node:Jr(e,t),F:null},r.set(e.node,n)),function(e,t,n){for(var r={};0<t.length;)r.Za=t.pop(),e="string"==typeof r.Za?Oe(n,e).find(function(e){return function(t){return t.node.nodeName===e.Za}}(r)):De(n,e)[r.Za],r={Za:r.Za};return e.node}(n,o,t.h))}function Kr(e,t,n,r,o){return r.L((function(e){for(var n="",r=0;r<e.length;r++){var i=e[r],a=t.A&&ee(i.type,53)?t.A.serializeToString(Wr(i.value,t,!1)):Rt(ge.o(i),t).map((function(e){return Wt(e,1)})).first().value;n+="{type: "+ie[i.type]+", value: "+a+"}\n"}return void 0!==o&&(n+=o.first().value),t.O.trace(n),ge.create(e)}))}var Zr=[{l:[{type:59,g:2}],m:Kr,localName:"trace",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2},{type:1,g:3}],m:Kr,localName:"trace",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}}];function eo(e,t,n,r,o){throw e=void 0===r||r.G()?new ve("err","http://www.w3.org/2005/xqt-errors","FOER0000"):r.first().value,t="",void 0===o||o.G()||(t=": "+o.first().value),Error(""+e.localName+t)}var to=[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"error",l:[],i:{type:63,g:3},m:eo},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"error",l:[{type:23,g:0}],i:{type:63,g:3},m:eo},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"error",l:[{type:23,g:0},{type:1,g:3}],i:{type:63,g:3},m:eo},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"error",l:[{type:23,g:0},{type:1,g:3},{type:59,g:2}],i:{type:63,g:3},m:function(){throw Error("Not implemented: Using an error object in error is not supported")}}];function no(e){return"string"==typeof e?e:(e=(new Ee).getChildNodes(e).find((function(e){return 8===e.nodeType})))?e.data:"some expression"}function ro(e,t){e=Error.call(this,e),this.message=e.message,"stack"in e&&(this.stack=e.stack),this.position={end:{la:t.end.la,line:t.end.line,offset:t.end.offset},start:{la:t.start.la,line:t.start.line,offset:t.start.offset}}}function oo(e,t){if(t instanceof Error)throw t;"string"!=typeof e&&(e=no(e));var n=Di(t);e=e.replace("\r","").split("\n");var r=Math.floor(Math.log10(Math.min(n.end.line+2,e.length)))+1;throw e=e.reduce((function(e,t,o){var i=o+1;if(2<n.start.line-i||2<i-n.end.line)return e;if(o=Array(r).fill(" ",0,Math.floor(Math.log10(i))+1-r).join("")+i+": ",e.push(o+t),i>=n.start.line&&i<=n.end.line){var a=i<n.end.line?t.length+o.length:n.end.la-1+o.length;i=i>n.start.line?o.length:n.start.la-1+o.length,e.push(Array(o.length+t.length).fill(" ",0,i).fill("^",i,a).join(""))}return e}),[]),t=Ri(t).join("\n"),new ro(e.join("\n")+"\n\n"+t,n)}y(ro,Error);var io=Object.create(null);function ao(e,t){for(var n=[],r=0;r<e.length+1;++r)n[r]=[];return function r(o,i){if(0===o)return i;if(0===i)return o;if(void 0!==n[o][i])return n[o][i];var a=0;return e[o-1]!==t[i-1]&&(a=1),a=Math.min(r(o-1,i)+1,r(o,i-1)+1,r(o-1,i-1)+a),n[o][i]=a}(e.length,t.length)}function so(e){var t=io[e]?io[e]:Object.keys(io).map((function(t){return{name:t,yb:ao(e,t.slice(t.lastIndexOf(":")+1))}})).sort((function(e,t){return e.yb-t.yb})).slice(0,5).filter((function(t){return t.yb<e.length/2})).reduce((function(e,t){return e.concat(io[t.name])}),[]).slice(0,5);return t.length?t.map((function(e){return'"Q{'+e.namespaceURI+"}"+e.localName+" ("+e.l.map((function(e){return 4===e?"...":se(e)})).join(", ")+')"'})).reduce((function(e,t,n,r){return 0===n?e+t:e+(n!==r.length-1?", ":" or ")+t}),"Did you mean ")+"?":"No similar functions found."}function uo(e,t,n,r,o){io[e+":"+t]||(io[e+":"+t]=[]),io[e+":"+t].push({l:n,arity:n.length,m:o,I:!1,localName:t,namespaceURI:e,i:r})}var co={},lo=(co.xml="http://www.w3.org/XML/1998/namespace",co.xs="http://www.w3.org/2001/XMLSchema",co.fn="http://www.w3.org/2005/xpath-functions",co.map="http://www.w3.org/2005/xpath-functions/map",co.array="http://www.w3.org/2005/xpath-functions/array",co.math="http://www.w3.org/2005/xpath-functions/math",co.fontoxpath="http://fontoxml.com/fontoxpath",co.local="http://www.w3.org/2005/xquery-local-functions",co);function po(e,t,n,r){this.Ea=[Object.create(null)],this.Fa=Object.create(null),this.O=e,this.ha=Object.keys(t).reduce((function(e,n){return void 0===t[n]||(e[n]="Q{}"+n+"[0]"),e}),Object.create(null)),this.s=Object.create(null),this.h=Object.create(null),this.A=n,this.u=r,this.j=[]}function ho(e){return Error("XPTY0004: "+e)}function fo(e,t){return e=2===e.node.nodeType?e.node.nodeName+'="'+Re(t,e)+'"':e.node.outerHTML,Error("XQTY0024: The node "+e+" follows a node that is not an attribute node or a namespace node.")}function mo(e){return Error('XQDY0044: The node name "'+e.ya()+'" is invalid for a computed attribute constructor.')}function go(){return Error("XQST0045: Functions and variables may not be declared in one of the reserved namespace URIs.")}function yo(){return Error("XQST0060: Functions declared in a module or as an external function must reside in a namespace.")}function vo(){return Error("XQST0066: A Prolog may contain at most one default function namespace declaration.")}function wo(){return Error("XQST0070: The prefixes xml and xmlns may not be used in a namespace declaration or be bound to another namespaceURI.")}function xo(e){return Error('XQDY0074: The value "'+e+'" of a name expressions cannot be converted to an expanded QName.')}function bo(e){return Error('XPST0081: The prefix "'+e+'" could not be resolved')}function Ao(e,t){return"Q{"+(e||"")+"}"+t}function Eo(e,t){for(var n=e.length-1;0<=n;--n)if(t in e[n])return e[n][t]}function No(e){this.s=e,this.O=this.h=0,this.j=[Object.create(null)],this.u=Object.create(null),this.A=null,this.Fa=e&&e.Fa,this.Ea=e&&e.Ea}function To(e){for(var t=new No(e.s),n=0;n<e.h+1;++n)t.j=[Object.assign(Object.create(null),t.j[0],e.j[n])],t.Ea=[Object.assign(Object.create(null),t.Ea[0],e.Ea[n])],t.u=Object.assign(Object.create(null),e.u),t.Fa=e.Fa,t.A=e.A;return t}function Bo(e){e.O++,e.h++,e.j[e.h]=Object.create(null),e.Ea[e.h]=Object.create(null)}function Io(e,t,n,r,o){if(r=Ao(t,n)+"~"+r,e.u[r])throw Error('XQST0049: The function or variable "Q{'+t+"}"+n+'" is declared more than once.');e.u[r]=o}function Co(e,t,n){e.j[e.h][t]=n}function So(e,t,n){return t=Ao(t||"",n),e.Ea[e.h][t]=t+"["+e.O+"]"}function Oo(e,t,n,r){e.Fa[Ao(t||"",n)+"["+e.O+"]"]=r}function ko(e){e.j.length=e.h,e.Ea.length=e.h,e.h--}function Do(e,t){"*"===t||Array.isArray(t)||(t=[t]);for(var n=1;n<e.length;++n)if(Array.isArray(e[n])){var r=e[n];if("*"===t||t.includes(r[0]))return r}return null}function Ro(e){return 2>e.length?"":"object"==typeof e[1]?e[2]||"":e[1]||""}function Mo(e,t){return Array.isArray(e)?"object"!=typeof(e=e[1])||Array.isArray(e)?null:t in e?e[t]:null:null}function Uo(e,t){return t.reduce(Do,e)}function Fo(e,t){for(var n=[],r=1;r<e.length;++r)if(Array.isArray(e[r])){var o=e[r];"*"!==t&&o[0]!==t||n.push(o)}return n}function Go(e){return{localName:Ro(e),namespaceURI:Mo(e,"URI"),prefix:Mo(e,"prefix")}}function Lo(e){var t=Do(e,"typeDeclaration");if(!t||Do(t,"voidSequenceType"))return{type:59,g:2};e={type:function e(n){switch(n[0]){case"documentTest":return 55;case"elementTest":return 54;case"attributeTest":return 47;case"piTest":return 57;case"commentTest":return 58;case"textTest":return 56;case"anyKindTest":return 53;case"anyItemType":return 59;case"anyFunctionTest":case"functionTest":case"typedFunctionTest":return 60;case"anyMapTest":case"typedMapTest":return 61;case"anyArrayTest":case"typedArrayTest":return 62;case"atomicType":return ue([Mo(n,"prefix"),Ro(n)].join(":"));case"parenthesizedItemType":return e(Do(n,"*"));default:throw Error('Type declaration "'+Do(t,"*")[0]+'" is not supported.')}}(Do(t,"*")),g:3};var n=null,r=Do(t,"occurrenceIndicator");switch(r&&(n=Ro(r)),n){case"*":return e.g=2,e;case"?":return e.g=0,e;case"+":return e.g=1,e;case"":case null:return e}}function Po(e,t,n){if("object"!=typeof e[1]||Array.isArray(e[1])){var r={};r[t]=n,e.splice(1,0,r)}else e[1][t]=n}function Ho(e,t,n){return(e<<20)+(t<<12)+(n.charCodeAt(0)<<8)+n.charCodeAt(1)}po.prototype.Ba=function(e,t,n){return function(e,t,n){var r=io[e+":"+t];return r&&(r=r.find((function(e){return e.l.some((function(e){return 4===e}))?e.l.length-1<=n:e.l.length===n})))?{l:r.l,arity:n,m:r.m,I:r.I,localName:t,namespaceURI:e,i:r.i}:null}(e,t,n)},po.prototype.sb=function(e,t){return e?null:(e=this.ha[t],this.s[t]||(this.s[t]={name:t}),e)},po.prototype.Ta=function(e,t){var n=this.u(e,t);if(n)this.j.push({Dc:e,arity:t,Jb:n});else if(""===e.prefix){if(this.A)return{namespaceURI:this.A,localName:e.localName}}else if(t=this.ba(e.prefix,!0))return{namespaceURI:t,localName:e.localName};return n},po.prototype.ba=function(e,t){return void 0===t||t?lo[e]?lo[e]:(t=this.O(e),this.h[e]||(this.h[e]={namespaceURI:t,prefix:e}),void 0!==t||e?t:null):null},No.prototype.Ba=function(e,t,n,r){r=void 0!==r&&r;var o=this.u[Ao(e,t)+"~"+n];return!o||r&&o.Db?null===this.s?null:this.s.Ba(e,t,n,r):o},No.prototype.sb=function(e,t){var n=Eo(this.Ea,Ao(e,t));return n||(null===this.s?null:this.s.sb(e,t))},No.prototype.Ta=function(e,t){var n=e.prefix,r=e.localName;return""===n&&this.A?{localName:r,namespaceURI:this.A}:n&&(n=this.ba(n,!1))?{localName:r,namespaceURI:n}:null===this.s?null:this.s.Ta(e,t)},No.prototype.ba=function(e,t){var n=Eo(this.j,e||"");return void 0===n?null===this.s?void 0:this.s.ba(e||"",void 0===t||t):n};var _o={},jo=(_o[Ho(2,2,"idivOp")]=5,_o[Ho(16,16,"addOp")]=16,_o[Ho(16,16,"subtractOp")]=16,_o[Ho(16,16,"divOp")]=4,_o[Ho(16,2,"multiplyOp")]=16,_o[Ho(16,2,"divOp")]=16,_o[Ho(2,16,"multiplyOp")]=16,_o[Ho(17,17,"addOp")]=17,_o[Ho(17,17,"subtractOp")]=17,_o[Ho(17,17,"divOp")]=4,_o[Ho(17,2,"multiplyOp")]=17,_o[Ho(17,2,"divOp")]=17,_o[Ho(2,17,"multiplyOp")]=17,_o[Ho(9,9,"subtractOp")]=17,_o[Ho(7,7,"subtractOp")]=17,_o[Ho(8,8,"subtractOp")]=17,_o[Ho(9,16,"addOp")]=9,_o[Ho(9,16,"subtractOp")]=9,_o[Ho(9,17,"addOp")]=9,_o[Ho(9,17,"subtractOp")]=9,_o[Ho(7,16,"addOp")]=7,_o[Ho(7,16,"subtractOp")]=7,_o[Ho(7,17,"addOp")]=7,_o[Ho(7,17,"subtractOp")]=7,_o[Ho(8,17,"addOp")]=8,_o[Ho(8,17,"subtractOp")]=8,_o[Ho(9,16,"addOp")]=9,_o[Ho(9,16,"subtractOp")]=9,_o[Ho(9,17,"addOp")]=9,_o[Ho(9,17,"subtractOp")]=9,_o[Ho(7,17,"addOp")]=7,_o[Ho(7,17,"subtractOp")]=7,_o[Ho(7,16,"addOp")]=7,_o[Ho(7,16,"subtractOp")]=7,_o[Ho(8,17,"addOp")]=8,_o[Ho(8,17,"subtractOp")]=8,_o),Xo={},qo=(Xo[Ho(2,2,"addOp")]=function(e,t){return e+t},Xo[Ho(2,2,"subtractOp")]=function(e,t){return e-t},Xo[Ho(2,2,"multiplyOp")]=function(e,t){return e*t},Xo[Ho(2,2,"divOp")]=function(e,t){return e/t},Xo[Ho(2,2,"modOp")]=function(e,t){return e%t},Xo[Ho(2,2,"idivOp")]=function(e,t){return Math.trunc(e/t)},Xo[Ho(16,16,"addOp")]=function(e,t){return new Pt(e.ga+t.ga)},Xo[Ho(16,16,"subtractOp")]=function(e,t){return new Pt(e.ga-t.ga)},Xo[Ho(16,16,"divOp")]=function(e,t){return e.ga/t.ga},Xo[Ho(16,2,"multiplyOp")]=jt,Xo[Ho(16,2,"divOp")]=function(e,t){if(isNaN(t))throw Error("FOCA0005: Cannot divide xs:yearMonthDuration by NaN");if((e=Math.round(e.ga/t))>Number.MAX_SAFE_INTEGER||!Number.isFinite(e))throw Error("FODT0002: Value overflow while dividing xs:yearMonthDuration");return new Pt(e<Number.MIN_SAFE_INTEGER||0===e?0:e)},Xo[Ho(2,16,"multiplyOp")]=function(e,t){return jt(t,e)},Xo[Ho(17,17,"addOp")]=function(e,t){return new Qe(e.ea+t.ea)},Xo[Ho(17,17,"subtractOp")]=function(e,t){return new Qe(e.ea-t.ea)},Xo[Ho(17,17,"divOp")]=function(e,t){if(0===t.ea)throw Error("FOAR0001: Division by 0");return e.ea/t.ea},Xo[Ho(17,2,"multiplyOp")]=et,Xo[Ho(17,2,"divOp")]=function(e,t){if(isNaN(t))throw Error("FOCA0005: Cannot divide xs:dayTimeDuration by NaN");if((e=e.ea/t)>Number.MAX_SAFE_INTEGER||!Number.isFinite(e))throw Error("FODT0002: Value overflow while dividing xs:dayTimeDuration");return new Qe(e<Number.MIN_SAFE_INTEGER||Object.is(-0,e)?0:e)},Xo[Ho(2,17,"multiplyOp")]=function(e,t){return et(t,e)},Xo[Ho(9,9,"subtractOp")]=ht,Xo[Ho(7,7,"subtractOp")]=ht,Xo[Ho(8,8,"subtractOp")]=ht,Xo[Ho(9,16,"addOp")]=dt,Xo[Ho(9,16,"subtractOp")]=ft,Xo[Ho(9,17,"addOp")]=dt,Xo[Ho(9,17,"subtractOp")]=ft,Xo[Ho(7,16,"addOp")]=dt,Xo[Ho(7,16,"subtractOp")]=ft,Xo[Ho(7,17,"addOp")]=dt,Xo[Ho(7,17,"subtractOp")]=ft,Xo[Ho(8,17,"addOp")]=dt,Xo[Ho(8,17,"subtractOp")]=ft,Xo[Ho(9,16,"addOp")]=dt,Xo[Ho(9,16,"subtractOp")]=ft,Xo[Ho(9,17,"addOp")]=dt,Xo[Ho(9,17,"subtractOp")]=ft,Xo[Ho(7,17,"addOp")]=dt,Xo[Ho(7,17,"subtractOp")]=ft,Xo[Ho(7,16,"addOp")]=dt,Xo[Ho(7,16,"subtractOp")]=ft,Xo[Ho(8,17,"addOp")]=dt,Xo[Ho(8,17,"subtractOp")]=ft,Xo);function Vo(e,t){return ee(e,5)&&ee(t,5)?5:ee(e,4)&&ee(t,4)?4:ee(e,6)&&ee(t,6)?6:3}var $o=[2,16,17,9,7,8];function Yo(e,t,n){function r(e,t){return{V:o?o(e):e,W:i?i(t):t}}var o=null,i=null;ee(t,19)&&(o=function(e){return Wt(e,3)},t=3),ee(n,19)&&(i=function(e){return Wt(e,3)},n=3);var a=$o.filter((function(e){return ee(t,e)})),s=$o.filter((function(e){return ee(n,e)}));if(a.includes(2)&&s.includes(2)){var u=qo[Ho(2,2,e)],l=jo[Ho(2,2,e)];return l||(l=Vo(t,n)),"divOp"===e&&5===l&&(l=4),"idivOp"===e?zo(r,u)[0]:function(e,t){return e=r(e,t),$(u(e.V.value,e.W.value),l)}}for(var p=(a=c(a)).next();!p.done;p=a.next()){p=p.value;for(var h={},d=c(s),f=d.next();!f.done;h={kb:h.kb,nb:h.nb},f=d.next())if(f=f.value,h.kb=qo[Ho(p,f,e)],h.nb=jo[Ho(p,f,e)],h.kb&&void 0!==h.nb)return function(e){return function(t,n){return t=r(t,n),$(e.kb(t.V.value,t.W.value),e.nb)}}(h)}}function zo(e,t){return[function(n,r){if(n=(r=e(n,r)).V,0===(r=r.W).value)throw Error("FOAR0001: Divisor of idiv operator cannot be (-)0");if(Number.isNaN(n.value)||Number.isNaN(r.value)||!Number.isFinite(n.value))throw Error("FOAR0002: One of the operands of idiv is NaN or the first operand is (-)INF");return Number.isFinite(n.value)&&!Number.isFinite(r.value)?$(0,5):$(t(n.value,r.value),5)},5]}var Qo=Object.create(null);function Jo(e,t,n,r,o){pr.call(this,t.s.add(n.s),[t,n],{C:!1},!1,r),this.B=t,this.J=n,this.j=e,this.u=o}function Wo(e,t,n){var r=Go(Uo(e,["forClauseItem","typedVariableBinding","varName"]));(e=Uo(e,["forClauseItem","forExpr","sequenceExpr"]))&&(e=Fo(e,"*").map((function(e){return n(e,t)})),e.includes(void 0)||e.includes(null)||1===(e=Ko(e)).length&&li(t,r.localName,e[0]))}function Ko(e){return e.filter((function(e,t,n){return n.findIndex((function(t){return t.type===e.type&&t.g===e.g}))===t}))}function Zo(e,t,n){var r=Fo(e,"*"),o=Do(e,"atomicType");if(!o)return{type:59,g:2};if(ue(Mo(o,"prefix")+":"+o[2])===t.type)if(1===r.length){if(3===t.g)return n}else if(e=Do(e,"occurrenceIndicator")[1],t.g===function(e){switch(e){case"*":return 2;case"?":return 0;case"+":return 1;default:return 3}}(e))return n}function ei(e,t){ti(e,t)}function ti(e,t){var n=ui.get(e[0]);if(n)return n(e,t);for(n=1;n<e.length;n++)e[n]&&ti(e[n],t)}function ni(e,t){var n=ti(Do(e,"firstOperand")[1],t),r=ti(Do(e,"secondOperand")[1],t),o=e[0];if(n&&r){if(!(t=function(e,t,n){var r=[2,53,59,46,47];if(r.includes(t)||r.includes(n))return 2;var o=null,i=null;ee(t,19)&&(o=function(e){return Wt(e,3)},t=3),ee(n,19)&&(i=function(e){return Wt(e,3)},n=3);var a=$o.filter((function(e){return ee(t,e)}));if(r=$o.filter((function(e){return ee(n,e)})),a.includes(2)&&r.includes(2))return void 0===(r=jo[Ho(2,2,e)])&&(r=Vo(t,n)),"divOp"===e&&5===r&&(r=4),"idivOp"===e?zo((function(e,t){return{V:o?o(e):e,W:i?i(t):t}}),(function(e,t){return Math.trunc(e/t)}))[1]:r;for(var s=(a=c(a)).next();!s.done;s=a.next()){s=s.value;for(var u=c(r),l=u.next();!l.done;l=u.next())if(void 0!==(l=jo[Ho(s,l.value,e)]))return l}}(o,n.type,r.type)))throw Error("XPTY0004: "+o+" not available for types "+se(n)+" and "+se(r));n={type:t,g:n.g},2!==t&&59!==t&&Po(e,"type",n),e=n}else e={type:2,g:3};return e}function ri(e,t){ti(Do(e,"firstOperand")[1],t),ti(Do(e,"secondOperand")[1],t);e:{switch(e[0]){case"orOp":case"andOp":Po(e,"type",t={type:0,g:3}),e=t;break e}e=void 0}return e}function oi(e,t){ti(Do(e,"firstOperand")[1],t),ti(Do(e,"secondOperand")[1],t);e:{switch(e[0]){case"unionOp":case"intersectOp":case"exceptOp":Po(e,"type",t={type:53,g:2}),e=t;break e}e=void 0}return e}function ii(e,t){return ti(Do(e,"firstOperand")[1],t),ti(Do(e,"secondOperand")[1],t),Po(e,"type",t={type:0,g:3}),t}function ai(e,t){return ti(Do(e,"firstOperand")[1],t),ti(Do(e,"secondOperand")[1],t),Po(e,"type",t={type:0,g:3}),t}function si(e,t){return ti(Do(e,"firstOperand")[1],t),ti(Do(e,"secondOperand")[1],t),Po(e,"type",t={type:0,g:3}),t}y(Jo,pr),Jo.prototype.h=function(e,t){var n=this;return Rt(hr(this.B,e,t),t).L((function(r){return 0===r.length?ge.empty():Rt(hr(n.J,e,t),t).L((function(e){if(0===e.length)return ge.empty();if(1<r.length||1<e.length)throw Error('XPTY0004: the operands of the "'+n.j+'" operator should be empty or singleton.');var t=r[0];if(e=e[0],n.u&&n.type)return ge.o(n.u(t,e));var o=t.type,i=e.type,a=n.j,s=o+"~"+i+"~"+a,u=Qo[s];if(u||(u=Qo[s]=Yo(a,o,i)),!(o=u))throw Error("XPTY0004: "+n.j+" not available for types "+ie[t.type]+" and "+ie[e.type]);return ge.o(o(t,e))}))}))};var ui=new Map([["unaryMinusOp",function(e,t){return(t=ti(Do(e,"operand")[1],t))?ee(t.type,2)?(Po(e,"type",t={type:t.type,g:t.g}),e=t):(Po(e,"type",t={type:3,g:3}),e=t):(Po(e,"type",t={type:2,g:2}),e=t),e}],["unaryPlusOp",function(e,t){return(t=ti(Do(e,"operand")[1],t))?ee(t.type,2)?(Po(e,"type",t={type:t.type,g:t.g}),e=t):(Po(e,"type",t={type:3,g:3}),e=t):(Po(e,"type",t={type:2,g:2}),e=t),e}],["addOp",ni],["subtractOp",ni],["divOp",ni],["idivOp",ni],["modOp",ni],["multiplyOp",ni],["andOp",ri],["orOp",ri],["sequenceExpr",function(e,t){var n=Fo(e,"*"),r=n.map((function(e){return ti(e,t)}));return function(e,t,n){return t=0===t?{type:53,g:2}:1===t?n[0]:n.includes(void 0)||n.includes(null)||1<(t=Ko(n)).length?{type:59,g:2}:{type:t[0].type,g:2},t&&59!==t.type&&Po(e,"type",t),t}(e,n.length,r)}],["unionOp",oi],["intersectOp",oi],["exceptOp",oi],["stringConcatenateOp",function(e,t){return ti(Do(e,"firstOperand")[1],t),ti(Do(e,"secondOperand")[1],t),Po(e,"type",t={type:1,g:3}),t}],["rangeSequenceExpr",function(e,t){return ti(Do(e,"startExpr")[1],t),ti(Do(e,"endExpr")[1],t),Po(e,"type",t={type:5,g:1}),t}],["equalOp",ii],["notEqualOp",ii],["lessThanOrEqualOp",ii],["lessThanOp",ii],["greaterThanOrEqualOp",ii],["greaterThanOp",ii],["eqOp",ai],["neOp",ai],["ltOp",ai],["leOp",ai],["gtOp",ai],["geOp",ai],["isOp",si],["nodeBeforeOp",si],["nodeAfterOp",si],["pathExpr",function(e,t){var n=Do(e,"rootExpr");return n&&n[1]&&ti(n[1],t),Fo(e,"stepExpr").map((function(e){return ti(e,t)})),function(e,t){var n=Fo(e,"stepExpr");if(!n)return{type:59,g:2};for(var r=(n=c(n)).next();!r.done;r=n.next()){var o=r.value;r=t;var i=null;if(o){for(var a=Fo(o,"*"),s="",u=(a=c(a)).next();!u.done;u=a.next())switch(u=u.value,u[0]){case"filterExpr":i=Mo(Uo(u,["*"]),"type");break;case"xpathAxis":e:{switch(s=u[1]){case"attribute":i={type:47,g:2};break e;case"child":case"decendant":case"self":case"descendant-or-self":case"following-sibling":case"following":case"namespace":case"parent":case"ancestor":case"preceding-sibling":case"preceding":case"ancestor-or-self":i={type:53,g:2};break e}i=void 0}break;case"nameTest":var l=Go(u);if(null!==l.namespaceURI)break;if("attribute"===s&&!l.prefix)break;void 0!==(l=r.ba(l.prefix||""))&&Po(u,"URI",l);break;case"lookup":i={type:59,g:2}}i&&59!==i.type&&Po(o,"type",i)}o=Mo(o,"type")}return o&&59!==o.type&&Po(e,"type",o),o}(e,t)}],["contextItemExpr",function(){return{type:59,g:2}}],["ifThenElseExpr",function(e,t){ti(Do(Do(e,"ifClause"),"*"),t);var n=ti(Do(Do(e,"thenClause"),"*"),t);return t=ti(Do(Do(e,"elseClause"),"*"),t),n&&t&&n.type===t.type&&n.g===t.g?(59!==n.type&&Po(e,"type",n),e=n):e={type:59,g:2},e}],["instanceOfExpr",function(e,t){return ti(Do(e,"argExpr"),t),ti(Do(e,"sequenceType"),t),Po(e,"type",t={type:0,g:3}),t}],["integerConstantExpr",function(e){var t={type:5,g:3};return Po(e,"type",t),t}],["doubleConstantExpr",function(e){var t={type:3,g:3};return Po(e,"type",t),t}],["decimalConstantExpr",function(e){var t={type:4,g:3};return Po(e,"type",t),t}],["stringConstantExpr",function(e){var t={type:1,g:3};return Po(e,"type",t),t}],["functionCallExpr",function(e,t){return Fo(Do(e,"arguments"),"*").map((function(e){return ti(e,t)})),function(e,t){if(!t||!t.ia)return{type:59,g:2};var n=Do(e,"functionName"),r=Go(n),o=r.localName,i=r.prefix,a=r.namespaceURI;if(r=Fo(Do(e,"arguments"),"*"),null===a){if(!(i=t.ia.Ta({localName:o,prefix:i},r.length)))return{type:59,g:2};o=i.localName,Po(n,"URI",a=i.namespaceURI),n[2]=o}return(t=t.ia.Ba(a,o,r.length))&&63!==t.i.type?(59!==t.i.type&&Po(e,"type",t.i),t.i):{type:59,g:2}}(e,t)}],["arrowExpr",function(e,t){return ti(Do(e,"argExpr")[1],t),function(e,t){if(!t||!t.ia)return{type:59,g:2};var n=Do(e,"EQName");if(!n)return{type:59,g:2};var r=Go(n);n=r.localName;var o=r.prefix;return r=Fo(Do(e,"arguments"),"*"),(n=t.ia.Ta({localName:n,prefix:o},r.length))&&(t=t.ia.Ba(n.namespaceURI,n.localName,r.length+1))?(59!==t.i.type&&Po(e,"type",t.i),t.i):{type:59,g:2}}(e,t)}],["dynamicFunctionInvocationExpr",function(e,t){return ti(Uo(e,["functionItem","*"]),t),(e=Do(e,"arguments"))&&ti(e,t),{type:59,g:2}}],["namedFunctionRef",function(e,t){return function(e,t){if(!t||!t.ia)return{type:59,g:2};var n=Do(e,"functionName"),r=Go(n),o=r.localName,i=r.namespaceURI,a=r.prefix;if(r=Number(Uo(e,["integerConstantExpr","value"])[1]),!i){if(!(i=t.ia.Ta({localName:o,prefix:a},r)))return{type:59,g:2};o=i.localName,Po(n,"URI",i=i.namespaceURI)}return(t=t.ia.Ba(i,o,r)||null)?(59!==t.i.type&&63!==t.i.type&&Po(e,"type",t.i),t.i):{type:59,g:2}}(e,t)}],["inlineFunctionExpr",function(e,t){return ti(Do(e,"functionBody")[1],t),Po(e,"type",t={type:60,g:3}),t}],["castExpr",function(e){var t=Uo(e,["singleType","atomicType"]);return 59!==(t={type:ue(Mo(t,"prefix")+":"+t[2]),g:3}).type&&Po(e,"type",t),t}],["castableExpr",function(e){var t={type:0,g:3};return Po(e,"type",t),t}],["simpleMapExpr",function(e,t){for(var n,r=Fo(e,"pathExpr"),o=0;o<r.length;o++)n=ti(r[o],t);return null!=n?(59!==(t={type:n.type,g:2}).type&&Po(e,"type",t),e=t):e={type:59,g:2},e}],["mapConstructor",function(e,t){return Fo(e,"mapConstructorEntry").map((function(e){return{key:ti(Uo(e,["mapKeyExpr","*"]),t),value:ti(Uo(e,["mapValueExpr","*"]),t)}})),function(e){var t={type:61,g:3};return Po(e,"type",t),t}(e)}],["arrayConstructor",function(e,t){return Fo(Do(e,"*"),"arrayElem").map((function(e){return ti(e,t)})),function(e){var t={type:62,g:3};return Po(e,"type",t),t}(e)}],["unaryLookup",function(e){return Do(e,"NCName"),{type:59,g:2}}],["typeswitchExpr",function(e,t){var n=ti(Do(e,"argExpr")[1],t),r=Fo(e,"typeswitchExprCaseClause").map((function(e){return ti(Uo(e,["resultExpr"])[1],t)}));return function(e,t,n,r){if(!t||n.includes(void 0))return{type:59,g:2};for(var o=Fo(e,"typeswitchExprCaseClause"),i=0;i<n.length;i++){var a=Do(o[i],"*");switch(a[0]){case"sequenceType":if(a=Zo(a,t,n[i]))return 59!==a.type&&Po(e,"type",a),a;continue;case"sequenceTypeUnion":for(r=Fo(a,"*"),o=0;2>o;o++)if(a=Zo(r[o],t,n[i]))return 59!==a.type&&Po(e,"type",a),a;default:return{type:59,g:2}}}return 59!==r.type&&Po(e,"type",r),r}(e,n,r,ti(Uo(e,["typeswitchExprDefaultClause","resultExpr"])[1],t))}],["quantifiedExpr",function(e,t){return Fo(e,"*").map((function(e){return ti(e,t)})),function(e){var t={type:0,g:3};return Po(e,"type",t),t}(e)}],["x:stackTrace",function(e,t){return ti((e=Fo(e,"*"))[0],t)}],["queryBody",function(e,t){return ti(e[1],t)}],["flworExpr",function(e,t){return function(e,t){for(var n=ti,r=!1,o=1;o<e.length;o++)switch(e[o][0]){case"letClause":pi(t);var i=e[o],a=t,s=n,u=Uo(i,["letClauseItem","typedVariableBinding","varName"]);u=Go(u),s=s((i=Uo(i,["letClauseItem","letExpr"]))[1],a),li(a,u.localName,s);break;case"forClause":r=!0,pi(t),Wo(e[o],t,n);break;case"whereClause":pi(t),n(a=e[o],t),Po(a,"type",{type:0,g:3});break;case"orderByClause":pi(t);break;case"returnClause":return a=n,Po(n=Uo(o=e[o],["*"]),"type",t=a(n,t)),Po(o,"type",t),(n=t)?(r&&(n={type:n.type,g:2}),59!==n.type&&Po(e,"type",n),n):{type:59,g:2};default:return(n=n(e[o],t))?(r&&(n={type:n.type,g:2}),59!==n.type&&Po(e,"type",n),n):{type:59,g:2}}if(!(0<t.h))throw Error("Variable scope out of bound");t.h--,t.s.pop(),t.A.pop()}(e,t)}],["varRef",function(e,t){var n,r=Go(Do(e,"name"));e:{for(n=t.h;0<=n;n--){var o=t.s[n][r.localName];if(o){n=o;break e}}n=void 0}return n&&59!==n.type&&Po(e,"type",n),null===r.namespaceURI&&(void 0!==(t=t.ba(r.prefix))&&Po(e,"URI",t)),n}]]);function ci(e){this.h=0,this.ia=e,this.s=[{}],this.A=[{}]}function li(e,t,n){if(e.s[e.h][t])throw Error("Another variable of in the scope "+e.h+" with the same name "+t+" already exists");e.s[e.h][t]=n}function pi(e){e.h++,e.s.push({}),e.A.push({})}function hi(e,t){var n={};pr.call(this,new Tr((n.external=1,n)),e,{C:e.every((function(e){return e.C}))},!1,t),this.j=e}function di(e,t){var n={};pr.call(this,new Tr((n.external=1,n)),e,{C:e.every((function(e){return e.C}))},!1,t),this.j=e}function fi(e){if(null===e)throw Error("XPDY0002: context is absent, it needs to be present to use axes.");if(!ee(e.type,53))throw Error("XPTY0020: Axes can only be applied to nodes.");return e.value}function mi(e,t){t=t||{Qa:!1},pr.call(this,e.s,[e],{S:"reverse-sorted",Y:!1,subtree:!1,C:!1}),this.j=e,this.u=!!t.Qa}ci.prototype.ba=function(e){for(var t=this.h;0<=t;t--){var n=this.A[t][e];if(void 0!==n)return n}return this.ia?this.ia.ba(e):void 0},y(hi,pr),hi.prototype.h=function(e,t){return 0===this.j.length?ge.o(new He([])):hr(this.j[0],e,t).L((function(e){return ge.o(new He(e.map((function(e){return ye(ge.o(e))}))))}))},y(di,pr),di.prototype.h=function(e,t){return ge.o(new He(this.j.map((function(n){return ye(hr(n,e,t))}))))},y(mi,pr),mi.prototype.h=function(e,t){var n=this;t=t.h,e=fi(e.M);var r=this.j.A();return r=r&&(r.startsWith("name-")||"type-1"===r)?"type-1":null,ge.create(function(e,t,n){var r=t;return{next:function(){if(!r)return W;var t=r;return r=Ge(e,t,n),K(je(t))}}}(t,this.u?e:Ge(t,e,r),r)).filter((function(e){return n.j.j(e)}))};var gi=new Map([["type-1-or-type-2",["name","type-1","type-2"]],["type-1",["name"]],["type-2",["name"]]]);function yi(e,t){if(null===e)return t;if(null===t||e===t)return e;var n=e.startsWith("name-")?"name":e,r=t.startsWith("name-")?"name":t,o=gi.get(n);return void 0!==o&&o.includes(r)?t:void 0!==(t=gi.get(r))&&t.includes(n)?e:"empty"}function vi(e,t){var n={};pr.call(this,new Tr((n.attribute=1,n)),[e],{S:"unsorted",subtree:!0,Y:!0,C:!1}),this.j=e,this.u=yi(this.j.A(),t)}function wi(e,t){pr.call(this,e.s,[e],{S:"sorted",subtree:!0,Y:!0,C:!1}),this.u=e,this.j=yi(t,e.A())}function xi(e,t,n){var r=t.node.nodeType;if(1!==r&&9!==r)return{next:function(){return W}};var o=Me(e,t,n);return{next:function(){if(!o)return W;var t=o;return o=Fe(e,o,n),K(t)}}}function bi(e,t){t=t||{Qa:!1},pr.call(this,e.s,[e],{C:!1,Y:!1,S:"sorted",subtree:!0}),this.j=e,this.u=!!t.Qa,this.B=(e=this.j.A())&&(e.startsWith("name-")||"type-1"===e)||"type-1-or-type-2"===e?"type-1":null}function Ai(e,t,n){var r=e.node.nodeType;if(1!==r&&9!==r)return e;for(r=Ue(t,e,n);null!==r;){if(1!==r.node.nodeType)return r;r=Ue(t,e=r,n)}return e}function Ei(e,t,n,r){if(void 0!==n&&n){var o=t,i=!1;return{next:function(){if(i)return W;if(en(o,t))return en(o=Ai(t,e,r),t)?(i=!0,W):K(je(o));var n=o.node.nodeType,a=9===n||2===n?null:Le(e,o,r);return null!==a?K(je(o=Ai(a,e,r))):en(o=9===n?null:Ge(e,o,r),t)?(i=!0,W):K(je(o))}}}var a=[xi(e,t,r)];return{next:function(){if(!a.length)return W;for(var t=a[0].next(0);t.done;){if(a.shift(),!a.length)return W;t=a[0].next(0)}return a.unshift(xi(e,t.value,r)),K(je(t.value))}}}function Ni(e){pr.call(this,e.s,[e],{S:"sorted",Y:!0,subtree:!1,C:!1}),this.j=e,this.u=(e=this.j.A())&&(e.startsWith("name-")||"type-1"===e)?"type-1":null}function Ti(e,t){pr.call(this,e.s,[e],{S:"sorted",Y:!0,subtree:!1,C:!1}),this.j=e,this.u=yi(this.j.A(),t)}function Bi(e,t){pr.call(this,e.s,[e],{S:"reverse-sorted",Y:!0,subtree:!0,C:!1}),this.j=e,this.u=yi(t,this.j.A())}function Ii(e){pr.call(this,e.s,[e],{C:!1,Y:!0,S:"reverse-sorted",subtree:!1}),this.j=e,this.u=(e=this.j.A())&&(e.startsWith("name-")||"type-1"===e)?"type-1":null}function Ci(e,t){pr.call(this,e.s,[e],{C:!1,Y:!0,S:"reverse-sorted",subtree:!1}),this.j=e,this.u=yi(this.j.A(),t)}function Si(e,t){pr.call(this,e.s,[e],{S:"sorted",subtree:!0,Y:!0,C:!1}),this.j=e,this.u=yi(this.j.A(),t)}function Oi(e,t,n,r){var o=e.s.add(t.s).add(n.s);Ar.call(this,o,[e,t,n],{C:e.C&&t.C&&n.C,Y:t.Y===n.Y&&t.Y,S:t.O===n.O?t.O:"unsorted",subtree:t.subtree===n.subtree&&t.subtree},r),this.j=e}function ki(e,t,n){this.location=e,this.s=t,this.h=n}function Di(e){return e.h instanceof Error?e.location:Di(e.h)}function Ri(e){var t=e.h instanceof ro?["Inner error:",e.h.message]:e.h instanceof Error?[e.h.toString()]:Ri(e.h);return t.push("  at <"+e.s+">:"+e.location.start.line+":"+e.location.start.la+" - "+e.location.end.line+":"+e.location.end.la),t}function Mi(e,t,n){Ar.call(this,n.s,[n],{C:n.C,Y:n.Y,S:n.O,subtree:n.subtree}),this.j=t,this.J={end:{la:e.end.la,line:e.end.line,offset:e.end.offset},start:{la:e.start.la,line:e.start.line,offset:e.start.offset}}}function Ui(e,t,n,r){pr.call(this,e,t,n,!0),this.j=r,this.I=this.j.I}function Fi(e,t,n,r){var o=[],i=e.J(t,n,r,(function(n){if(e.j instanceof Ui)return br(Fi(e.j,t,n,r),(function(e){return o=e}));var i=null;return ge.create({next:function(){for(;;){if(!i){var t=n.next(0);if(t.done)return W;t=e.j.u(t.value,r),i=br(t,(function(e){return o=vr(o,e)})).value}if(!(t=i.next(0)).done)return t;i=null}}})})),a=!1;return{next:function(){if(a)return W;var e=i.N();return a=!0,K(new dr(e,o))}}}function Gi(e,t,n,r){return e.J(t,n,r,(function(n){if(e.j instanceof Ui)return Gi(e.j,t,n,r);var o=null;return ge.create({next:function(){for(;;){if(!o){var t=n.next(0);if(t.done)return W;o=hr(e.j,t.value,r).value}if(!(t=o.next(0)).done)return t;o=null}}})}))}function Li(e,t,n,r){Ui.call(this,t.s.add(r.s),[t,r],{C:!1},r),this.T=e.prefix,this.ka=e.namespaceURI,this.bc=e.localName,this.ob=null,this.B=n,this.xa=null,this.pa=t}function Pi(e,t,n){var r={};pr.call(this,new Tr((r.external=1,r)),[n],{C:!1,S:"unsorted"}),this.T=e.map((function(e){return e.name})),this.B=e.map((function(e){return e.type})),this.u=null,this.J=t,this.j=n}function Hi(e,t,n){if(Ui.call(this,t.s.add(n.s),[t,n],{C:!1,Y:n.Y,S:n.O,subtree:n.subtree},n),e.prefix||e.namespaceURI)throw Error("Not implemented: let expressions with namespace usage.");this.B=e.prefix,this.T=e.namespaceURI,this.xa=e.localName,this.ka=t,this.pa=null}function _i(e,t){switch(pr.call(this,new Tr({}),[],{C:!0,S:"sorted"},!1,t),t.type){case 5:var n=$(parseInt(e,10),t.type);break;case 1:n=$(e,t.type);break;case 4:case 3:n=$(parseFloat(e),t.type);break;default:throw new TypeError("Type "+t+" not expected in a literal")}this.j=function(){return ge.o(n)}}function ji(e,t){var n={};pr.call(this,new Tr((n.external=1,n)),e.reduce((function(e,t){return e.concat(t.key,t.value)}),[]),{C:!1},!1,t),this.j=e}function Xi(e,t,n){var r={};pr.call(this,new Tr((r.external=1,r)),[],{C:!0},!1,n),this.u=t,this.B=e,this.j=null}y(vi,pr),vi.prototype.h=function(e,t){var n=this;return t=t.h,1!==(e=fi(e.M)).node.nodeType?ge.empty():(e=Oe(t,e,this.u).filter((function(e){return"http://www.w3.org/2000/xmlns/"!==e.node.namespaceURI})).map((function(e){return je(e)})).filter((function(e){return n.j.j(e)})),ge.create(e))},vi.prototype.A=function(){return"type-1"},y(wi,pr),wi.prototype.h=function(e,t){var n=this,r=t.h,o=fi(e.M);if(1!==(e=o.node.nodeType)&&9!==e)return ge.empty();var i=null,a=!1;return ge.create({next:function(){for(;!a;){if(!i){if(!(i=Me(r,o,n.j))){a=!0;continue}return K(je(i))}if(i=Fe(r,i,n.j))return K(je(i));a=!0}return W}}).filter((function(e){return n.u.j(e)}))},y(bi,pr),bi.prototype.h=function(e,t){var n=this;return e=function(e,t,n){var r=[Kt(t)];return{next:function(t){if(0<r.length&&0!=(1&t)&&r.shift(),!r.length)return W;for(t=r[0].next(0);t.done;){if(r.shift(),!r.length)return W;t=r[0].next(0)}return r.unshift(xi(e,t.value,n)),K(je(t.value))}}}(t=t.h,e=fi(e.M),this.B),this.u||e.next(0),ge.create(e).filter((function(e){return n.j.j(e)}))},y(Ni,pr),Ni.prototype.h=function(e,t){var n=this;return t=t.h,e=fi(e.M),ge.create(function(e,t,n){for(var r=[];t&&9!==t.node.nodeType;t=Ge(e,t,null)){var o=Fe(e,t,n);o&&r.push(o)}var i=null;return{next:function(){for(;i||r.length;){if(!i){i=Ei(e,r[0],!1,n);var t=K(je(r[0])),o=Fe(e,r[0],n);return o?r[0]=o:r.shift(),t}if(!(t=i.next(0)).done)return t;i=null}return W}}}(t,e,this.u)).filter((function(e){return n.j.j(e)}))},y(Ti,pr),Ti.prototype.h=function(e,t){var n=this;return t=t.h,e=fi(e.M),ge.create(function(e,t,n){return{next:function(){return(t=t&&Fe(e,t,n))?K(je(t)):W}}}(t,e,this.u)).filter((function(e){return n.j.j(e)}))},y(Bi,pr),Bi.prototype.h=function(e,t){return(e=Ge(t=t.h,e=fi(e.M),this.u))?(e=je(e),this.j.j(e)?ge.o(e):ge.empty()):ge.empty()},y(Ii,pr),Ii.prototype.h=function(e,t){var n=this;return t=t.h,e=fi(e.M),ge.create(function(e,t,n){for(var r=[];t&&9!==t.node.nodeType;t=Ge(e,t,null)){var o=Le(e,t,n);null!==o&&r.push(o)}var i=null;return{next:function(){for(;i||r.length;){i||(i=Ei(e,r[0],!0,n));var t=i.next(0);if(t.done){i=null,t=Le(e,r[0],n);var o=K(je(r[0]));return null===t?r.shift():r[0]=t,o}return t}return W}}}(t,e,this.u)).filter((function(e){return n.j.j(e)}))},y(Ci,pr),Ci.prototype.h=function(e,t){var n=this;return t=t.h,e=fi(e.M),ge.create(function(e,t,n){return{next:function(){return(t=t&&Le(e,t,n))?K(je(t)):W}}}(t,e,this.u)).filter((function(e){return n.j.j(e)}))},y(Si,pr),Si.prototype.h=function(e){return fi(e.M),this.j.j(e.M)?ge.o(e.M):ge.empty()},Si.prototype.A=function(){return this.u},y(Oi,Ar),Oi.prototype.B=function(e,t,n){var r=null,o=n[0](e);return ge.create({next:function(t){return r||(r=(o.getEffectiveBooleanValue()?n[1](e):n[2](e)).value),r.next(t)}})},Oi.prototype.P=function(e){if(Ar.prototype.P.call(this,e),this.j.I)throw er()},y(Mi,Ar),Mi.prototype.B=function(e,t,n){var r=this;t=c(n).next().value;try{var o=t(e)}catch(e){throw new ki(this.J,this.j,e)}return ge.create({next:function(e){try{return o.value.next(e)}catch(e){throw new ki(r.J,r.j,e)}}})},Mi.prototype.P=function(e){try{Ar.prototype.P.call(this,e)}catch(e){throw new ki(this.J,this.j,e)}},y(Ui,pr),Ui.prototype.h=function(e,t){var n=this;return this.J(e,Kt(e),t,(function(r){if(n.j instanceof Ui)return Gi(n.j,e,r,t);var o=null;return ge.create({next:function(e){for(;;){if(!o){var i=r.next(0);if(i.done)return W;o=hr(n.j,i.value,t).value}if(!(i=o.next(e)).done)return i;o=null}}})}))},Ui.prototype.u=function(e,t){return Fi(this,e,Kt(e),t)},Ui.prototype.P=function(e){pr.prototype.P.call(this,e),this.I=this.j.I;for(var t=(e=c(this.ha)).next();!t.done;t=e.next())if((t=t.value)!==this.j&&t.I)throw er()},y(Li,Ui),Li.prototype.J=function(e,t,n,r){var o=this,i=null,a=null,s=0;return r({next:function(){for(var e={};;){if(!i){var r=t.next(0);if(r.done)return W;a=r.value,s=0,i=hr(o.pa,a,n).value}if(e.jb=i.next(0),!e.jb.done)return s++,(r={})[o.ob]=function(e){return function(){return ge.o(e.jb.value)}}(e),e=r,o.xa&&(e[o.xa]=function(){return ge.o(new re(5,s))}),K(Tt(a,e));i=null,e={jb:e.jb}}}})},Li.prototype.P=function(e){if(this.T&&(this.ka=e.ba(this.T),!this.ka&&this.T))throw Error("XPST0081: Could not resolve namespace for prefix "+this.T+" in a for expression");if(this.pa.P(e),Bo(e),this.ob=So(e,this.ka,this.bc),this.B){if(this.B.prefix&&(this.B.namespaceURI=e.ba(this.B.prefix),!this.B.namespaceURI&&this.B.prefix))throw Error("XPST0081: Could not resolve namespace for prefix "+this.T+" in the positionalVariableBinding in a for expression");this.xa=So(e,this.B.namespaceURI,this.B.localName)}if(this.j.P(e),ko(e),this.pa.I)throw er();this.j.I&&(this.I=!0)},y(Pi,pr),Pi.prototype.h=function(e,t){var n=this,r=new we({l:this.B,arity:this.B.length,Ra:!0,I:this.j.I,localName:"dynamic-function",namespaceURI:"",i:this.J,value:function(r,o,i,a){for(var s=[],u=3;u<arguments.length;++u)s[u-3]=arguments[u];return u=Tt(Nt(e,-1,null,ge.empty()),n.u.reduce((function(e,t,n){return e[t]=ye(s[n]),e}),Object.create(null))),hr(n.j,u,t)}});return ge.o(r)},Pi.prototype.P=function(e){if(Bo(e),this.u=this.T.map((function(t){return So(e,t.namespaceURI,t.localName)})),this.j.P(e),ko(e),this.j.I)throw Error("Not implemented: inline functions can not yet be updating.")},y(Hi,Ui),Hi.prototype.J=function(e,t,n,r){var o=this;return r({next:function(){var e=t.next(0);if(e.done)return W;var r={};return K(e=Tt(e=e.value,(r[o.pa]=ye(hr(o.ka,e,n)),r)))}})},Hi.prototype.P=function(e){if(this.B&&(this.T=e.ba(this.B),!this.T&&this.B))throw Error("XPST0081: Could not resolve namespace for prefix "+this.B+" using in a for expression");if(this.ka.P(e),Bo(e),this.pa=So(e,this.T,this.xa),this.j.P(e),ko(e),this.I=this.j.I,this.ka.I)throw er()},y(_i,pr),_i.prototype.h=function(){return this.j()},y(ji,pr),ji.prototype.h=function(e,t){var n=this,r=this.j.map((function(n){return Rt(hr(n.key,e,t),t).$({default:function(){throw Error("XPTY0004: A key of a map should be a single atomizable value.")},o:function(e){return e}})}));return Xe(r,(function(r){return ge.o(new $e(r.map((function(r,o){return{key:r,value:ye(hr(n.j[o].value,e,t))}}))))}))},y(Xi,pr),Xi.prototype.h=function(){var e=new we({l:this.j.l,I:this.j.I,arity:this.u,localName:this.j.localName,namespaceURI:this.j.namespaceURI,i:this.j.i,value:this.j.m});return ge.o(e)},Xi.prototype.P=function(e){var t=this.B.namespaceURI,n=this.B.localName,r=this.B.prefix;if(null===t){var o=e.Ta({localName:n,prefix:r},this.u);if(!o)throw Error("XPST0017: The function "+(r?r+":":"")+n+" with arity "+this.u+" could not be resolved. "+so(n));t=o.namespaceURI,n=o.localName}if(this.j=e.Ba(t,n,this.u)||null,!this.j)throw e=this.B,Error("XPST0017: Function "+(e.namespaceURI?"Q{"+e.namespaceURI+"}":e.prefix?e.prefix+":":"")+e.localName+" with arity of "+this.u+" not registered. "+so(n));pr.prototype.P.call(this,e)};var qi={},Vi=(qi[5]=5,qi[27]=5,qi[28]=5,qi[31]=5,qi[32]=5,qi[33]=5,qi[34]=5,qi[30]=5,qi[36]=5,qi[35]=5,qi[38]=5,qi[37]=5,qi[29]=5,qi[4]=4,qi[6]=6,qi[3]=3,qi);function $i(e,t,n){pr.call(this,t.s,[t],{C:!1},!1,n),this.u=t,this.j=e}function Yi(e,t){pr.call(this,e.reduce((function(e,t){return e.add(t.s)}),new Tr({})),e,{C:e.every((function(e){return e.C}))},!1,t),this.j=e,this.u=e.reduce((function(e,t){return yi(e,t.A())}),null)}function zi(e,t){var n,r=e.reduce((function(e,t){return 0<Br(e,t.s)?e:t.s}),new Tr({}));for(pr.call(this,r,e,{C:e.every((function(e){return e.C}))},!1,t),t=0;t<e.length&&(void 0===n&&(n=e[t].A()),null!==n);++t)if(n!==e[t].A()){n=null;break}this.u=n,this.j=e}function Qi(e,t){var n;return ge.create({next:function(r){for(;;){if(!n){var o=e.value.next(r);if(o.done)return W;n=Dt(o.value,t)}if(!(o=n.value.next(r)).done)return o;n=null}}})}function Ji(e,t,n){function r(e,t){return{V:a?a(e):e,W:s?s(t):t}}function o(e){return ee(t,e)&&ee(n,e)}function i(e){return 0<e.filter((function(e){return ee(t,e)})).length&&0<e.filter((function(e){return ee(n,e)})).length}var a=null,s=null;if(ee(t,19)&&ee(n,19)?t=n=1:ee(t,19)?(a=function(e){return Wt(e,n)},t=n):ee(n,19)&&(s=function(e){return Wt(e,t)},n=t),ee(t,23)&&ee(n,23))return function(e,t){if("eqOp"===e)return function(e,n){return e=(n=t(e,n)).V,n=n.W,e.value.namespaceURI===n.value.namespaceURI&&e.value.localName===n.value.localName};if("neOp"===e)return function(e,n){return e=(n=t(e,n)).V,n=n.W,e.value.namespaceURI!==n.value.namespaceURI||e.value.localName!==n.value.localName};throw Error('XPTY0004: Only the "eq" and "ne" comparison is defined for xs:QName')}(e,r);if(o(0)||i([1,47,61])||i([2,47,61])||o(20)||o(22)||o(21)||i([1,20])){var u=function(e,t){switch(e){case"eqOp":return function(e,n){return(e=t(e,n)).V.value===e.W.value};case"neOp":return function(e,n){return(e=t(e,n)).V.value!==e.W.value};case"ltOp":return function(e,n){return(e=t(e,n)).V.value<e.W.value};case"leOp":return function(e,n){return(e=t(e,n)).V.value<=e.W.value};case"gtOp":return function(e,n){return(e=t(e,n)).V.value>e.W.value};case"geOp":return function(e,n){return(e=t(e,n)).V.value>=e.W.value}}}(e,r);if(void 0!==u)return u}if(o(16)&&(u=function(e,t){switch(e){case"ltOp":return function(e,n){return(e=t(e,n)).V.value.ga<e.W.value.ga};case"leOp":return function(e,n){return e=(n=t(e,n)).V,n=n.W,ze(e.value,n.value)||e.value.ga<n.value.ga};case"gtOp":return function(e,n){return(e=t(e,n)).V.value.ga>e.W.value.ga};case"geOp":return function(e,n){return e=(n=t(e,n)).V,n=n.W,ze(e.value,n.value)||e.value.ga>n.value.ga}}}(e,r),void 0!==u)||o(17)&&(u=function(e,t){switch(e){case"eqOp":return function(e,n){return ze((e=t(e,n)).V.value,e.W.value)};case"ltOp":return function(e,n){return(e=t(e,n)).V.value.ea<e.W.value.ea};case"leOp":return function(e,n){return e=(n=t(e,n)).V,n=n.W,ze(e.value,n.value)||e.value.ea<n.value.ea};case"gtOp":return function(e,n){return(e=t(e,n)).V.value.ea>e.W.value.ea};case"geOp":return function(e,n){return e=(n=t(e,n)).V,n=n.W,ze(e.value,n.value)||e.value.ea>n.value.ea}}}(e,r),void 0!==u)||o(18)&&(u=function(e,t){switch(e){case"eqOp":return function(e,n){return ze((e=t(e,n)).V.value,e.W.value)};case"neOp":return function(e,n){return!ze((e=t(e,n)).V.value,e.W.value)}}}(e,r),void 0!==u))return u;if((o(9)||o(7)||o(8))&&(u=function(e,t){switch(e){case"eqOp":return function(e,n,r){return pt((e=t(e,n)).V.value,e.W.value,Et(r))};case"neOp":return function(e,n,r){return!pt((e=t(e,n)).V.value,e.W.value,Et(r))};case"ltOp":return function(e,n,r){return e=t(e,n),r=Et(r),0>lt(e.V.value,e.W.value,r)};case"leOp":return function(e,n,r){var o;return e=(n=t(e,n)).V,n=n.W,(o=pt(e.value,n.value,Et(r)))||(r=Et(r),o=0>lt(e.value,n.value,r)),o};case"gtOp":return function(e,n,r){return e=t(e,n),r=Et(r),0<lt(e.V.value,e.W.value,r)};case"geOp":return function(e,n,r){var o;return e=(n=t(e,n)).V,n=n.W,(o=pt(e.value,n.value,Et(r)))||(r=Et(r),o=0<lt(e.value,n.value,r)),o}}}(e,r),void 0!==u))return u;if((o(11)||o(12)||o(13)||o(14)||o(15))&&(u=function(e,t){switch(e){case"eqOp":return function(e,n,r){return pt((e=t(e,n)).V.value,e.W.value,Et(r))};case"neOp":return function(e,n,r){return!pt((e=t(e,n)).V.value,e.W.value,Et(r))}}}(e,r),void 0!==u))return u;throw Error("XPTY0004: "+e+" not available for "+ie[t]+" and "+ie[n])}y($i,pr),$i.prototype.h=function(e,t){var n=this;return Rt(hr(this.u,e,t),t).L((function(e){if(0===e.length)return ge.empty();var t=e[0];if(n.type)return e="+"===n.j?+t.value:-t.value,0===t.type&&(e=Number.NaN),ge.o($(e,n.type.type));if(1<e.length)throw Error("XPTY0004: The operand to a unary operator must be a sequence with a length less than one");return ee(t.type,19)?(t=Wt(t,3).value,ge.o($("+"===n.j?t:-t,3))):ee(t.type,2)?"+"===n.j?ge.o(t):ge.o($(-1*t.value,Vi[t.type])):ge.o($(Number.NaN,3))}))},y(Yi,pr),Yi.prototype.h=function(e,t){var n=this,r=0,o=null,i=!1,a=null;if(null!==e){var s=e.M;null!==s&&ee(s.type,53)&&(a=be(s.value))}return ge.create({next:function(){if(!i){for(;r<n.j.length;){if(!o){var s=n.j[r];if(null!==a&&null!==s.A()&&!a.includes(s.A()))return r++,i=!0,K(z);o=hr(s,e,t)}if(!1===o.getEffectiveBooleanValue())return i=!0,K(z);o=null,r++}return i=!0,K(Y)}return W}})},Yi.prototype.A=function(){return this.u},y(zi,pr),zi.prototype.h=function(e,t){var n=this,r=0,o=null,i=!1,a=null;if(null!==e){var s=e.M;null!==s&&ee(s.type,53)&&(a=be(s.value))}return ge.create({next:function(){if(!i){for(;r<n.j.length;){if(!o){var s=n.j[r];if(null!==a&&null!==s.A()&&!a.includes(s.A())){r++;continue}o=hr(s,e,t)}if(!0===o.getEffectiveBooleanValue())return i=!0,K(Y);o=null,r++}return i=!0,K(z)}return W}})},zi.prototype.A=function(){return this.u};var Wi=Object.create(null);function Ki(e,t,n){var r=t+"~"+n+"~"+e,o=Wi[r];return o||(o=Wi[r]=Ji(e,t,n)),o}function Zi(e,t,n){pr.call(this,t.s.add(n.s),[t,n],{C:!1}),this.j=t,this.B=n,this.u=e}y(Zi,pr),Zi.prototype.h=function(e,t){var n=this,r=hr(this.j,e,t),o=hr(this.B,e,t),i=Qi(r,t),a=Qi(o,t);return i.$({empty:function(){return ge.empty()},o:function(){return a.$({empty:function(){return ge.empty()},o:function(){var t=i.first(),r=a.first();return Ki(n.u,t.type,r.type)(t,r,e)?ge.ca():ge.X()},multiple:function(){throw Error("XPTY0004: Sequences to compare are not singleton.")}})},multiple:function(){throw Error("XPTY0004: Sequences to compare are not singleton.")}})};var ea={},ta=(ea.equalOp="eqOp",ea.notEqualOp="neOp",ea.lessThanOrEqualOp="leOp",ea.lessThanOp="ltOp",ea.greaterThanOrEqualOp="geOp",ea.greaterThanOp="gtOp",ea);function na(e,t,n){pr.call(this,t.s.add(n.s),[t,n],{C:!1}),this.j=t,this.B=n,this.u=e}function ra(e,t,n,r){if(!ee(n,53)||!ee(r,53))throw Error("XPTY0004: Sequences to compare are not nodes");switch(e){case"isOp":return function(e,t){return e!==t||47!==e&&53!==e&&54!==e&&55!==e&&56!==e&&57!==e&&58!==e?function(){return!1}:function(e,t){return en(e.first().value,t.first().value)}}(n,r);case"nodeBeforeOp":return t?function(e,n){return 0>an(t,e.first(),n.first())}:void 0;case"nodeAfterOp":return t?function(e,n){return 0<an(t,e.first(),n.first())}:void 0;default:throw Error("Unexpected operator")}}function oa(e,t,n){pr.call(this,t.s.add(n.s),[t,n],{C:!1}),this.j=t,this.B=n,this.u=e}function ia(e,t,n,r){return n.L((function(n){if(n.some((function(e){return!ee(e.type,53)})))throw Error("XPTY0004: Sequences given to "+e+" should only contain nodes.");return"sorted"===r?ge.create(n):"reverse-sorted"===r?ge.create(n.reverse()):ge.create(sn(t,n))}))}function aa(e,t,n,r){pr.call(this,0<Br(t.s,n.s)?t.s:n.s,[t,n],{C:t.C&&n.C},!1,r),this.j=e,this.u=t,this.B=n}function sa(e,t){Ar.call(this,e.reduce((function(e,t){return e.add(t.s)}),new Tr({})),e,{S:"unsorted",C:e.every((function(e){return e.C}))},t)}function ua(e,t,n){pr.call(this,new Tr({}).add(e.s),[e,t],{C:e.C&&t.C},!1,n),this.j=e,this.u=t}function ca(e,t,n){if(pr.call(this,e.s,[e],{C:!1}),this.j=ue(t.prefix?t.prefix+":"+t.localName:t.localName),46===this.j||45===this.j||44===this.j)throw Error("XPST0080: Casting to xs:anyAtomicType, xs:anySimpleType or xs:NOTATION is not permitted.");if(t.namespaceURI)throw Error("Not implemented: castable as expressions with a namespace URI.");this.B=e,this.u=n}function la(e,t,n){if(pr.call(this,e.s,[e],{C:!1}),this.j=ue(t.prefix?t.prefix+":"+t.localName:t.localName),46===this.j||45===this.j||44===this.j)throw Error("XPST0080: Casting to xs:anyAtomicType, xs:anySimpleType or xs:NOTATION is not permitted.");if(t.namespaceURI)throw Error("Not implemented: casting expressions with a namespace URI.");this.B=e,this.u=n}function pa(e,t){var n=e.value,r=null,o=!1;return ge.create({next:function(){for(;!o;){if(!r){var e=n.next(0);if(e.done)return o=!0,K(Y);r=t(e.value)}if(e=r.getEffectiveBooleanValue(),r=null,!1===e)return o=!0,K(z)}return W}})}function ha(e,t,n,r){pr.call(this,e.s,[e],{C:!1},!1,r),this.B=e,this.u=t,this.j=n}function da(e,t){return!(null===e||null===t||!ee(e.type,53)||!ee(t.type,53))&&en(e.value,t.value)}function fa(e){var t=e.next(0);if(t.done)return ge.empty();var n=null,r=null;return ge.create({next:function(o){if(t.done)return W;n||(n=t.value.value);do{var i=n.next(o);if(i.done){if((t=e.next(0)).done)return i;n=t.value.value}}while(i.done||da(i.value,r));return r=i.value,i}})}function ma(e,t){var n=[];!function(){for(var e=t.next(0),r={};!e.done;)r.lb=e.value.value,e={current:r.lb.next(0),next:function(e){return function(t){return e.lb.next(t)}}(r)},e.current.done||n.push(e),e=t.next(0),r={lb:r.lb}}();var r=null,o=!1,i={};return ge.create((i[Symbol.iterator]=function(){return this},i.next=function(){o||(o=!0,n.every((function(e){return ee(e.current.value.type,53)}))&&n.sort((function(t,n){return an(e,t.current.value,n.current.value)})));do{if(!n.length)return W;var t=n.shift(),i=t.current;if(t.current=t.next(0),!ee(i.value.type,53))return i;if(!t.current.done){for(var a=0,s=n.length-1,u=0;a<=s;){u=Math.floor((a+s)/2);var c=an(e,t.current.value,n[u].current.value);if(0===c){a=u;break}0<c?a=u+1:s=u-1}n.splice(a,0,t)}}while(da(i.value,r));return r=i.value,i},i))}function ga(e,t){var n=e.reduce((function(e,t){return 0<Br(e,t.s)?e:t.s}),new Tr({}));pr.call(this,n,e,{C:e.every((function(e){return e.C}))},!1,t),this.j=e}function ya(e){return e.every((function(e){return null===e||ee(e.type,5)||ee(e.type,4)}))||null!==e.map((function(e){return e?Mt(e.type):null})).reduce((function(e,t){return null===t||t===e?e:null}))?e:e.every((function(e){return null===e||ee(e.type,1)||ee(e.type,20)}))?e.map((function(e){return e?Wt(e,1):null})):e.every((function(e){return null===e||ee(e.type,4)||ee(e.type,6)}))?e.map((function(e){return e?Wt(e,6):e})):e.every((function(e){return null===e||ee(e.type,4)||ee(e.type,6)||ee(e.type,3)}))?e.map((function(e){return e?Wt(e,3):e})):null}function va(e,t){var n=new Tr({});Ui.call(this,n,[t].concat(p(e.map((function(e){return e.da})))),{C:!1,Y:!1,S:"unsorted",subtree:!1},t),this.B=e}function wa(e){pr.call(this,e?e.s:new Tr({}),e?[e]:[],{S:"sorted",subtree:!1,Y:!1,C:!1}),this.j=e}function xa(e){pr.call(this,new Tr({}),[],{S:"sorted"},!1,e)}function ba(e,t){var n=e.every((function(e){return e.Y})),r=e.every((function(e){return e.subtree}));pr.call(this,e.reduce((function(e,t){return e.add(t.s)}),new Tr({})),e,{C:!1,Y:n,S:t?"sorted":"unsorted",subtree:r}),this.j=e,this.u=t}function Aa(e,t){pr.call(this,e.s.add(t.s),[e,t],{C:e.C&&t.C,Y:e.Y,S:e.O,subtree:e.subtree}),this.u=e,this.j=t}function Ea(e,t,n){if(n=[n],ee(e.type,62))if("*"===t)n.push.apply(n,p(e.R.map((function(e){return e()}))));else{if(!ee(t.type,5))throw ho("The key specifier is not an integer.");var r=t.value;if(e.R.length<r||0>=r)throw Error("FOAY0001: Array index out of bounds");n.push(e.R[r-1]())}else{if(!ee(e.type,61))throw ho("The provided context item is not a map or an array.");"*"===t?n.push.apply(n,p(e.h.map((function(e){return e.value()})))):(e=e.h.find((function(e){return qe(e.key,t)})))&&n.push(e.value())}return It(n)}function Na(e,t,n,r,o){return"*"===t?Ea(e,t,n):(t=ye(t=hr(t,r,o))().L((function(t){return t.reduce((function(t,n){return Ea(e,n,t)}),new ne)})),It([n,t]))}function Ta(e,t){pr.call(this,e.s,[e].concat("*"===t?[]:[t]),{C:e.C,S:e.O,subtree:e.subtree}),this.j=e,this.u=t}function Ba(e,t){var n={};pr.call(this,new Tr((n.external=1,n)),"*"===e?[]:[e],{C:!1},!1,t),this.j=e}function Ia(e,t,n,r){var o=t.map((function(e){return e.gb}));t=t.map((function(e){return e.name}));var i=o.reduce((function(e,t){return e.add(t.s)}),n.s);pr.call(this,i,o.concat(n),{C:!1},!1,r),this.u=e,this.B=t,this.J=o,this.T=n,this.j=null}function Ca(e){pr.call(this,e,[],{C:!1})}function Sa(e){var t={};Ca.call(this,new Tr((t.nodeType=1,t))),this.u=e}function Oa(e,t){t=void 0===t?{kind:null}:t;var n=e.prefix,r=e.namespaceURI,o={};"*"!==(e=e.localName)&&(o.nodeName=1),o.nodeType=1,Ca.call(this,new Tr(o)),this.u=e,this.J=r,this.B=n,this.T=t.kind}function ka(e){var t={};Ca.call(this,new Tr((t.nodeName=1,t))),this.u=e}function Da(e){Ca.call(this,new Tr({})),this.u=e}function Ra(e,t,n){pr.call(this,new Tr({}),[],{C:!1,S:"unsorted"}),this.B=n,this.u=t,this.J=e,this.j=null}function Ma(e,t){var n=new Tr({});Ui.call(this,n,[e,t],{C:!1,Y:!1,S:"unsorted",subtree:!1},t),this.B=e}function Ua(e){this.type=e}function Fa(e){this.type="delete",this.target=e}function Ga(e,t,n){this.type=n,this.target=e,this.content=t}function La(e,t){Ga.call(this,e,t,"insertAfter")}function Pa(e,t){this.type="insertAttributes",this.target=e,this.content=t}function Ha(e,t){Ga.call(this,e,t,"insertBefore")}function _a(e,t){Ga.call(this,e,t,"insertIntoAsFirst")}function ja(e,t){Ga.call(this,e,t,"insertIntoAsLast")}function Xa(e,t){Ga.call(this,e,t,"insertInto")}function qa(e,t){this.type="rename",this.target=e,this.s=t.ya?t:new ve(t.prefix,t.namespaceURI,t.localName)}function Va(e,t){this.type="replaceElementContent",this.target=e,this.text=t}function $a(e,t){this.type="replaceNode",this.target=e,this.s=t}function Ya(e,t){this.type="replaceValue",this.target=e,this.s=t}function za(e,t){return new $a(e,t)}function Qa(e){wr.call(this,new Tr({}),[e],{C:!1,S:"unsorted"}),this.j=e}function Ja(e,t,n,r,o,i){var a=t.h;return e.reduce((function e(t,n){return ee(n.type,62)?(n.R.forEach((function(n){return n().N().forEach((function(n){return e(t,n)}))})),t):(t.push(n),t)}),[]).forEach((function(e,s,u){if(ee(e.type,47)){if(o)throw i(e.value,a);n.push(e.value.node)}else if(ee(e.type,46)||ee(e.type,53)&&3===e.value.node.nodeType){var c=ee(e.type,46)?Wt(Dt(e,t).first(),1).value:Re(a,e.value);0!==s&&ee(u[s-1].type,46)&&ee(e.type,46)?(r.push({data:" "+c,Sa:!0,nodeType:3}),o=!0):c&&(r.push({data:""+c,Sa:!0,nodeType:3}),o=!0)}else if(ee(e.type,55)){var l=[];De(a,e.value).forEach((function(e){return l.push(je(e))})),o=Ja(l,t,n,r,o,i)}else{if(!ee(e.type,53)){if(ee(e.type,60))throw Ot(e.type);throw Error("Atomizing "+e.type+" is not implemented.")}r.push(e.value.node),o=!0}})),o}function Wa(e,t,n){var r=[],o=[],i=!1;return e.forEach((function(e){i=Ja(e,t,r,o,i,n)})),{attributes:r,Va:o}}function Ka(e,t,n,r,o){var i=[];switch(e){case 4:r.length&&i.push(new Pa(t,r)),o.length&&i.push(new _a(t,o));break;case 5:r.length&&i.push(new Pa(t,r)),o.length&&i.push(new ja(t,o));break;case 3:r.length&&i.push(new Pa(t,r)),o.length&&i.push(new Xa(t,o));break;case 2:r.length&&i.push(new Pa(n,r)),o.length&&i.push(new Ha(t,o));break;case 1:r.length&&i.push(new Pa(n,r)),o.length&&i.push(new La(t,o))}return i}function Za(e,t,n){wr.call(this,new Tr({}),[e,n],{C:!1,S:"unsorted"}),this.J=e,this.j=t,this.B=n}function es(){return St("Casting not supported from given type to a single xs:string or xs:untypedAtomic or any of its derived types.")}y(na,pr),na.prototype.h=function(e,t){var n=this,r=hr(this.j,e,t),o=hr(this.B,e,t);return r.$({empty:function(){return ge.X()},default:function(){return o.$({empty:function(){return ge.X()},default:function(){var i=Qi(r,t),a=Qi(o,t);return function(e,t,n,r){return e=ta[e],n.L((function(n){return t.filter((function(t){for(var o=0,i=n.length;o<i;++o){var a=n[o],s=void 0,u=void 0,l=t.type,p=a.type;if((ee(l,19)||ee(p,19))&&(ee(l,2)?s=3:ee(p,2)?u=3:ee(l,17)?s=17:ee(p,17)?u=17:ee(l,16)?s=16:ee(p,16)?u=16:ee(l,19)?u=p:ee(p,19)&&(s=l)),s=(u=c([u,s])).next().value,u=u.next().value,s?t=Wt(t,s):u&&(a=Wt(a,u)),Ki(e,t.type,a.type)(t,a,r))return!0}return!1})).$({default:function(){return ge.ca()},empty:function(){return ge.X()}})}))}(n.u,i,a,e)}})}})},y(oa,pr),oa.prototype.h=function(e,t){var n=this,r=hr(this.j,e,t),o=hr(this.B,e,t);return r.$({empty:function(){return ge.empty()},multiple:function(){throw Error("XPTY0004: Sequences to compare are not singleton")},o:function(){return o.$({empty:function(){return ge.empty()},multiple:function(){throw Error("XPTY0004: Sequences to compare are not singleton")},o:function(){var i=r.first(),a=o.first();return ra(n.u,t.h,i.type,a.type)(r,o,e)?ge.ca():ge.X()}})}})},y(aa,pr),aa.prototype.h=function(e,t){var n=this,r=ia(this.j,t.h,hr(this.u,e,t),this.u.O);e=ia(this.j,t.h,hr(this.B,e,t),this.B.O);var o=r.value,i=e.value,a=null,s=null,u=!1,c=!1;return ge.create({next:function(){if(u)return W;for(;!c;){if(!a){var e=o.next(0);if(e.done)return u=!0,W;a=e.value}if(!s){if((e=i.next(0)).done){c=!0;break}s=e.value}if(en(a.value,s.value)){if(e=K(a),s=a=null,"intersectOp"===n.j)return e}else if(0>an(t.h,a,s)){if(e=K(a),a=null,"exceptOp"===n.j)return e}else s=null}return"exceptOp"===n.j?null!==a?(e=K(a),a=null,e):o.next(0):(u=!0,W)}})},y(sa,Ar),sa.prototype.B=function(e,t,n){return n.length?It(n.map((function(t){return t(e)}))):ge.empty()},y(ua,pr),ua.prototype.h=function(e,t){var n=this,r=bt(e,hr(this.j,e,t)),o=null,i=null,a=!1;return ge.create({next:function(e){for(;!a;){if(!o&&(o=r.next(e)).done)return a=!0,W;i||(i=hr(n.u,o.value,t));var s=i.value.next(e);if(!s.done)return s;o=i=null}}})},y(ca,pr),ca.prototype.h=function(e,t){var n=this,r=Rt(hr(this.B,e,t),t);return r.$({empty:function(){return n.u?ge.ca():ge.X()},o:function(){return r.map((function(e){return Jt(e,n.j).v?Y:z}))},multiple:function(){return ge.X()}})},y(la,pr),la.prototype.h=function(e,t){var n=this,r=Rt(hr(this.B,e,t),t);return r.$({empty:function(){if(!n.u)throw Error("XPTY0004: Sequence to cast is empty while target type is singleton.");return ge.empty()},o:function(){return r.map((function(e){return Wt(e,n.j)}))},multiple:function(){throw Error("XPTY0004: Sequence to cast is not singleton or empty.")}})},y(ha,pr),ha.prototype.h=function(e,t){var n=this,r=hr(this.B,e,t);return r.$({empty:function(){return"?"===n.j||"*"===n.j?ge.ca():ge.X()},multiple:function(){return"+"===n.j||"*"===n.j?pa(r,(function(r){var o=ge.o(r);return r=Nt(e,0,r,o),hr(n.u,r,t)})):ge.X()},o:function(){return pa(r,(function(r){var o=ge.o(r);return r=Nt(e,0,r,o),hr(n.u,r,t)}))}})},y(ga,pr),ga.prototype.h=function(e,t){var n=this;if(this.j.every((function(e){return"sorted"===e.O}))){var r=0;return ma(t.h,{next:function(){return r>=n.j.length?W:K(hr(n.j[r++],e,t))}}).map((function(e){if(!ee(e.type,53))throw Error("XPTY0004: The sequences to union are not of type node()*");return e}))}return It(this.j.map((function(n){return hr(n,e,t)}))).L((function(e){if(e.some((function(e){return!ee(e.type,53)})))throw Error("XPTY0004: The sequences to union are not of type node()*");return e=sn(t.h,e),ge.create(e)}))},y(va,Ui),va.prototype.J=function(e,t,n,r){if(this.B[1])throw Error("More than one order spec is not supported for the order by clause.");var o,i,a=[],s=!1,u=null,l=this.B[0];return ge.create({next:function(){if(!s){for(var p=t.next(0);!p.done;)a.push(p.value),p=t.next(0);if((p=a.map((function(e){return l.da.h(e,n)})).map((function(e){return Rt(e,n)}))).find((function(e){return!e.G()&&!e.ta()})))throw ho("Order by only accepts empty or singleton sequences");if(function(e){return(e=e.find((function(e){return!!e})))?Mt(e.type):null}(o=(o=p.map((function(e){return e.first()}))).map((function(e){return null===e?e:ee(19,e.type)?Wt(e,1):e})))&&!(o=ya(o)))throw ho("Could not cast values");p=o.length,i=o.map((function(e,t){return t}));for(var h=0;h<p;h++)if(h+1!==p)for(var d=h;0<=d;d--){var f=d,m=d+1;if(m!==p){var g=o[i[f]],y=o[i[m]];if(null!==y||null!==g){if(l.Bc){if(null===g)continue;if(null===y&&null!==g){g=c([i[m],i[f]]),i[f]=g.next().value,i[m]=g.next().value;continue}if(isNaN(y.value)&&null!==g&&!isNaN(g.value)){g=c([i[m],i[f]]),i[f]=g.next().value,i[m]=g.next().value;continue}}else{if(null===y)continue;if(null===g&&null!==y){g=c([i[m],i[f]]),i[f]=g.next().value,i[m]=g.next().value;continue}if(isNaN(g.value)&&null!==y&&!isNaN(y.value)){g=c([i[m],i[f]]),i[f]=g.next().value,i[m]=g.next().value;continue}}Ki("gtOp",g.type,y.type)(g,y,e)&&(g=c([i[m],i[f]]),i[f]=g.next().value,i[m]=g.next().value)}}}var v=l.Ib?0:o.length-1;u=r({next:function(){return l.Ib?v>=o.length?W:K(a[i[v++]]):0>v?W:K(a[i[v--]])}}).value,s=!0}return u.next(0)}})},y(wa,pr),wa.prototype.h=function(e,t){if(null===e.M)throw Error("XPDY0002: context is absent, it needs to be present to use paths.");for(var n=t.h,r=e.M.value;9!==r.node.nodeType;)if(null===(r=Ge(n,r)))throw Error("XPDY0050: the root node of the context node is not a document node.");return n=ge.o(je(r)),this.j?hr(this.j,Nt(e,0,n.first(),n),t):n},y(xa,pr),xa.prototype.h=function(e){if(null===e.M)throw Error('XPDY0002: context is absent, it needs to be present to use the "." operator');return ge.o(e.M)},y(ba,pr),ba.prototype.h=function(e,t){var n=this,r=!0;return this.j.reduce((function(o,i,a){var s=null===o?Kt(e):bt(e,o);if(o={next:function(e){if((e=s.next(e)).done)return W;if(null!==e.value.M&&!ee(e.value.M.type,53)&&0<a)throw Error("XPTY0019: The result of E1 in a path expression E1/E2 should not evaluate to a sequence of nodes.");return K(hr(i,e.value,t))}},n.u)switch(i.O){case"reverse-sorted":var u=o;o={next:function(e){return(e=u.next(e)).done?e:K(e.value.L((function(e){return ge.create(e.reverse())})))}};case"sorted":if(i.subtree&&r){var c=fa(o);break}c=ma(t.h,o);break;case"unsorted":return fa(o).L((function(e){return ge.create(function(e,t){var n=!1,r=!1;if(t.forEach((function(e){ee(e.type,53)?n=!0:r=!0})),r&&n)throw Error("XPTY0018: The path operator should either return nodes or non-nodes. Mixed sequences are not allowed.");return n?sn(e,t):t}(t.h,e))}))}else c=fa(o);return r=r&&i.Y,c}),null)},ba.prototype.A=function(){return this.j[0].A()},y(Aa,pr),Aa.prototype.h=function(e,t){var n=this,r=hr(this.u,e,t);if(this.j.C){var o=hr(this.j,e,t);if(o.G())return o;var i=o.first();if(ee(i.type,2)){var a=i.value;if(!Number.isInteger(a))return ge.empty();var s=r.value,u=!1;return ge.create({next:function(){if(!u){for(var e=s.next(0);!e.done;e=s.next(0))if(1==a--)return u=!0,e;u=!0}return W}})}return o.getEffectiveBooleanValue()?r:ge.empty()}var c=r.value,l=null,p=0,h=null;return ge.create({next:function(o){for(var i=!1;(!l||!l.done)&&(l||(l=c.next(i?0:o),i=!0),!l.done);){h||(h=hr(n.j,Nt(e,p,l.value,r),t));var a=h.first();a=null!==a&&(ee(a.type,2)?a.value===p+1:h.getEffectiveBooleanValue()),h=null;var s=l.value;if(l=null,p++,a)return K(s)}return l}})},Aa.prototype.A=function(){return this.u.A()},y(Ta,pr),Ta.prototype.h=function(e,t){var n=this;return hr(this.j,e,t).L((function(r){return r.reduce((function(r,o){return Na(o,n.u,r,e,t)}),new ne)}))},Ta.prototype.A=function(){return this.j.A()},y(Ba,pr),Ba.prototype.h=function(e,t){return Na(e.M,this.j,new ne,e,t)},y(Ia,pr),Ia.prototype.h=function(e,t){var n=this,r=e,o=this.j.map((function(o,i){var a=hr(n.J[i],r,t).N();return r=Tt(e,((i={})[o]=function(){return ge.create(a)},i)),a}));if(o.some((function(e){return 0===e.length})))return"every"===this.u?ge.ca():ge.X();var i=Array(o.length).fill(0);i[0]=-1;for(var a=!0;a;){a=!1;for(var s=0,u=i.length;s<u;++s){var c=o[s];if(!(++i[s]>c.length-1)){for(a=Object.create(null),s={},u=0;u<i.length;s={wb:s.wb},u++)s.wb=o[u][i[u]],a[this.j[u]]=function(e){return function(){return ge.o(e.wb)}}(s);if(a=Tt(e,a),(a=hr(this.T,a,t)).getEffectiveBooleanValue()&&"some"===this.u)return ge.ca();if(!a.getEffectiveBooleanValue()&&"every"===this.u)return ge.X();a=!0;break}i[s]=0}}return"every"===this.u?ge.ca():ge.X()},Ia.prototype.P=function(e){this.j=[];for(var t=0,n=this.B.length;t<n;++t){this.J[t].P(e),Bo(e);var r=this.B[t],o=r.prefix?e.ba(r.prefix):null;r=So(e,o,r.localName),this.j[t]=r}for(this.T.P(e),t=0,n=this.B.length;t<n;++t)ko(e)},y(Ca,pr),Ca.prototype.h=function(e){return this.j(e.M)?ge.ca():ge.X()},y(Sa,Ca),Sa.prototype.j=function(e){return!!ee(e.type,53)&&(e=e.value.node.nodeType,3===this.u&&4===e||this.u===e)},Sa.prototype.A=function(){return"type-"+this.u},y(Oa,Ca),Oa.prototype.j=function(e){var t=ee(e.type,54),n=ee(e.type,47);return!(!t&&!n)&&(e=e.value,!(null!==this.T&&(1===this.T&&!t||2===this.T&&!n))&&(null===this.B&&""!==this.J&&"*"===this.u||("*"===this.B?"*"===this.u||this.u===e.node.localName:("*"===this.u||this.u===e.node.localName)&&(e.node.namespaceURI||null)===((""===this.B?t?this.J:null:this.J)||null))))},Oa.prototype.A=function(){return"*"===this.u?null===this.T?"type-1-or-type-2":"type-"+this.T:"name-"+this.u},Oa.prototype.P=function(e){if(null===this.J&&"*"!==this.B&&(this.J=e.ba(this.B||"")||null,!this.J&&this.B))throw Error("XPST0081: The prefix "+this.B+" could not be resolved.")},y(ka,Ca),ka.prototype.j=function(e){return ee(e.type,57)&&e.value.node.target===this.u},ka.prototype.A=function(){return"type-7"},y(Da,Ca),Da.prototype.j=function(e){return ee(e.type,ue(this.u.prefix?this.u.prefix+":"+this.u.localName:this.u.localName))},y(Ra,pr),Ra.prototype.h=function(e,t){if(!e.Ga[this.j]){if(this.T)return this.T(e,t);throw Error("XQDY0054: The variable "+this.B+" is declared but not in scope.")}return e.Ga[this.j]()},Ra.prototype.P=function(e){if(null===this.u&&this.J&&(this.u=e.ba(this.J)),this.j=e.sb(this.u||"",this.B),!this.j)throw Error("XPST0008, The variable "+this.B+" is not in scope.");(e=e.Fa[this.j])&&(this.T=e)},y(Ma,Ui),Ma.prototype.J=function(e,t,n,r){var o=this,i=null,a=null;return r({next:function(){for(;;){if(!a){var e=t.next(0);if(e.done)return W;i=e.value,a=hr(o.B,i,n)}e=a.getEffectiveBooleanValue();var r=i;if(a=i=null,e)return K(r)}}})},y(Fa,Ua),Fa.prototype.h=function(e){var t={};return t.type=this.type,t.target=Wr(this.target,e,!1),t},y(Ga,Ua),Ga.prototype.h=function(e){var t={};return t.type=this.type,t.target=Wr(this.target,e,!1),t.content=this.content.map((function(t){return Wr(t,e,!0)})),t},y(La,Ga),y(Pa,Ua),Pa.prototype.h=function(e){var t={};return t.type=this.type,t.target=Wr(this.target,e,!1),t.content=this.content.map((function(t){return Wr(t,e,!0)})),t},y(Ha,Ga),y(_a,Ga),y(ja,Ga),y(Xa,Ga),y(qa,Ua),qa.prototype.h=function(e){var t={},n={};return n.type=this.type,n.target=Wr(this.target,e,!1),n.newName=(t.prefix=this.s.prefix,t.namespaceURI=this.s.namespaceURI,t.localName=this.s.localName,t),n},y(Va,Ua),Va.prototype.h=function(e){var t={};return t.type=this.type,t.target=Wr(this.target,e,!1),t.text=this.text?Wr(this.text,e,!0):null,t},y($a,Ua),$a.prototype.h=function(e){var t={};return t.type=this.type,t.target=Wr(this.target,e,!1),t.replacement=this.s.map((function(t){return Wr(t,e,!0)})),t},y(Ya,Ua),Ya.prototype.h=function(e){var t={};return t.type=this.type,t.target=Wr(this.target,e,!1),t["string-value"]=this.s,t},y(Qa,wr),Qa.prototype.u=function(e,t){var n,r,o=xr(this.j)(e,t),i=t.h;return{next:function(){if(!n){var e=o.next(0);if(e.value.H.some((function(e){return!ee(e.type,53)})))throw Error("XUTY0007: The target of a delete expression must be a sequence of zero or more nodes.");n=e.value.H,r=e.value.fa}return n=n.filter((function(e){return Ge(i,e.value)})),K({fa:vr(n.map((function(e){return new Fa(e.value)})),r),H:[]})}}},y(Za,wr),Za.prototype.u=function(e,t){var n,r,o,i,a,s,u=this,c=xr(this.J)(e,t),l=xr(this.B)(e,t),p=t.h;return{next:function(){if(!n){var e=c.next(0),h=Wa([e.value.H],t,tr);n=h.attributes.map((function(e){return{node:e,F:null}})),r=h.Va.map((function(e){return{node:e,F:null}})),o=e.value.fa}if(!i){if(0===(e=l.next(0)).value.H.length)throw lr();if(3<=u.j){if(1!==e.value.H.length)throw nr();if(!ee(e.value.H[0].type,54)&&!ee(e.value.H[0].type,55))throw nr()}else{if(1!==e.value.H.length)throw rr();if(!(ee(e.value.H[0].type,54)||ee(e.value.H[0].type,56)||ee(e.value.H[0].type,58)||ee(e.value.H[0].type,57)))throw rr();if(null===(s=Ge(p,e.value.H[0].value,null)))throw Error("XUDY0029: The target "+e.value.H[0].value.outerHTML+" for inserting a node before or after must have a parent.")}i=e.value.H[0],a=e.value.fa}if(n.length){if(3<=u.j){if(!ee(i.type,54))throw Error("XUTY0022: An insert expression specifies the insertion of an attribute node into a document node.")}else if(1!==s.node.nodeType)throw Error("XUDY0030: An insert expression specifies the insertion of an attribute node before or after a child of a document node.");n.reduce((function(e,t){var n=t.node.prefix||"",r=t.node.prefix||"",o=t.node.namespaceURI,a=r?i.value.node.lookupNamespaceURI(r):null;if(a&&a!==o)throw ur(o);if((r=e[r])&&o!==r)throw cr(o);return e[n]=t.node.namespaceURI,e}),{})}return K({H:[],fa:vr(Ka(u.j,i.value,s||null,n,r),o,a)})}}};var ts=/([A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])/,ns=new RegExp(ts.source+new RegExp("("+ts.source+"|[-.0-9-])").source+"*","g");function rs(e){return!!(e=e.match(ns))&&1===e.length}function os(e,t){return Rt(t,e).$({o:function(e){if(ee((e=e.first()).type,1)||ee(e.type,19)){if(!rs(e.value))throw Error('XQDY0041: The value "'+e.value+'" of a name expressions cannot be converted to a NCName.');return ge.o(e)}throw es()},default:function(){throw es()}}).value}function is(e,t,n){return Rt(n,t).$({o:function(t){if(ee((t=t.first()).type,23))return ge.o(t);if(ee(t.type,1)||ee(t.type,19)){if(1===(t=t.value.split(":")).length)t=t[0];else{var n=t[0],r=e.ba(n);t=t[1]}if(!rs(t)||n&&!rs(n))throw xo(n?n+":"+t:t);if(n&&!r)throw xo(n+":"+t);return ge.o({type:23,value:new ve(n,r,t)})}throw es()},default:function(){throw es()}}).value}function as(e,t){wr.call(this,new Tr({}),[e,t],{C:!1,S:"unsorted"}),this.B=e,this.J=t,this.j=void 0}function ss(e,t,n){wr.call(this,new Tr({}),[t,n],{C:!1,S:"unsorted"}),this.J=e,this.j=t,this.B=n}function us(e){switch(e.type){case"delete":return new Fa({node:e.target,F:null});case"insertAfter":return new La({node:e.target,F:null},e.content.map((function(e){return{node:e,F:null}})));case"insertBefore":return new Ha({node:e.target,F:null},e.content.map((function(e){return{node:e,F:null}})));case"insertInto":return new Xa({node:e.target,F:null},e.content.map((function(e){return{node:e,F:null}})));case"insertIntoAsFirst":return new _a({node:e.target,F:null},e.content.map((function(e){return{node:e,F:null}})));case"insertIntoAsLast":return new ja({node:e.target,F:null},e.content.map((function(e){return{node:e,F:null}})));case"insertAttributes":return new Pa({node:e.target,F:null},e.content.map((function(e){return{node:e,F:null}})));case"rename":return new qa({node:e.target,F:null},e.newName);case"replaceNode":return new $a({node:e.target,F:null},e.replacement.map((function(e){return{node:e,F:null}})));case"replaceValue":return new Ya({node:e.target,F:null},e["string-value"]);case"replaceElementContent":return new Va({node:e.target,F:null},e.text?{node:e.text,F:null}:null);default:throw Error('Unexpected type "'+e.type+'" when parsing a transferable pending update.')}}function cs(e,t,n){if(t.find((function(t){return en(t,e)})))return!0;var r=Ge(n,e);return!!r&&cs(r,t,n)}function ls(e,t,n){wr.call(this,new Tr({}),e.reduce((function(e,t){return e.push(t.gb),e}),[t,n]),{C:!1,S:"unsorted"}),this.j=e,this.J=t,this.B=n,this.I=null}function ps(e,t){return{node:{nodeType:2,Sa:!0,nodeName:e.ya(),namespaceURI:e.namespaceURI,prefix:e.prefix,localName:e.localName,name:e.ya(),value:t},F:null}}function hs(e,t){var n=t.vb||[];n=n.concat(e.Ma||[]),pr.call(this,new Tr({}),n,{C:!1,S:"unsorted"}),e.Ma?this.u=e.Ma:this.name=new ve(e.prefix,e.namespaceURI,e.localName),this.j=t,this.B=void 0}function ds(e){pr.call(this,e?e.s:new Tr({}),e?[e]:[],{C:!1,S:"unsorted"}),this.j=e}function fs(e,t,n,r){pr.call(this,new Tr({}),r.concat(t).concat(e.Ma||[]),{C:!1,S:"unsorted"}),e.Ma?this.u=e.Ma:this.j=new ve(e.prefix,e.namespaceURI,e.localName),this.T=n.reduce((function(e,t){if(t.prefix in e)throw Error("XQST0071: The namespace declaration with the prefix "+t.prefix+" has already been declared on the constructed element.");return e[t.prefix||""]=t.uri,e}),{}),this.J=t,this.ka=r,this.B=void 0}function ms(e){if(/^xml$/i.test(e))throw Error('XQDY0064: The target of a created PI may not be "'+e+'"')}function gs(e,t){return{node:{data:t,Sa:!0,nodeName:e,nodeType:7,target:e},F:null}}function ys(e,t){var n=e.Eb?[e.Eb].concat(t):[t];pr.call(this,n.reduce((function(e,t){return e.add(t.s)}),new Tr({})),n,{C:!1,S:"unsorted"}),this.j=e,this.u=t}function vs(e){pr.call(this,e?e.s:new Tr({}),e?[e]:[],{C:!1,S:"unsorted"}),this.j=e}function ws(e,t,n,r){var o,i=new Tr({});Ar.call(this,i,(o=[e].concat(p(t.map((function(e){return e.zc}))),[n])).concat.apply(o,p(t.map((function(e){return e.Nb.map((function(e){return e.Mb}))})))),{C:!1,Y:!1,S:"unsorted",subtree:!1},r),this.J=e,this.j=t.length,this.T=t.map((function(e){return e.Nb}))}y(as,wr),as.prototype.u=function(e,t){var n=this,r=xr(this.B)(e,t),o=xr(this.J)(e,t);return{next:function(){var e=r.next(0),i=e.value.H;if(0===i.length)throw lr();if(1!==i.length)throw ir();if(!ee(i[0].type,54)&&!ee(i[0].type,47)&&!ee(i[0].type,57))throw ir();i=i[0];var a=o.next(0);e:{var s=n.j,u=ge.create(a.value.H);switch(i.type){case 54:if(s=is(s,t,u).next(0).value.value,(u=i.value.node.lookupNamespaceURI(s.prefix))&&u!==s.namespaceURI)throw ur(s.namespaceURI);break e;case 47:if((s=is(s,t,u).next(0).value.value).namespaceURI&&(u=i.value.node.lookupNamespaceURI(s.prefix))&&u!==s.namespaceURI)throw ur(s.namespaceURI);break e;case 57:s=new ve("",null,s=os(t,u).next(0).value.value);break e}s=void 0}return K({H:[],fa:vr([new qa(i.value,s)],e.value.fa,a.value.fa)})}}},as.prototype.P=function(e){this.j=To(e),wr.prototype.P.call(this,e)},y(ss,wr),ss.prototype.u=function(e,t){var n=xr(this.j)(e,t);return e=xr(this.B)(e,t),this.J?function(e,t,n){var r,o,i,a,s=!1;return{next:function(){if(s)return W;if(!i){var u=n.next(0),c=Rt(ge.create(u.value.H),e).map((function(e){return Wt(e,1)})).N().map((function(e){return e.value})).join(" ");i=0===c.length?null:{node:e.s.createTextNode(c),F:null},a=u.value.fa}if(!r){if(0===(u=t.next(0)).value.H.length)throw lr();if(1!==u.value.H.length)throw or();if(!(ee(u.value.H[0].type,54)||ee(u.value.H[0].type,47)||ee(u.value.H[0].type,56)||ee(u.value.H[0].type,58)||ee(u.value.H[0].type,57)))throw or();r=u.value.H[0],o=u.value.fa}if(ee(r.type,54))return s=!0,K({H:[],fa:vr([new Va(r.value,i)],a,o)});if(ee(r.type,47)||ee(r.type,56)||ee(r.type,58)||ee(r.type,57)){if(u=i?Re(e.h,i):"",ee(r.type,58)&&(u.includes("--")||u.endsWith("-")))throw Error('XQDY0072: The content "'+u+'" for a comment node contains two adjacent hyphens or ends with a hyphen.');if(ee(r.type,57)&&u.includes("?>"))throw Error('XQDY0026: The content "'+u+'" for a processing instruction node contains "?>".');return s=!0,K({H:[],fa:vr([new Ya(r.value,u)],a,o)})}}}}(t,n,e):function(e,t,n){var r,o,i;return{next:function(){if(!r){var a=n.next(0),s=Wa([a.value.H],e,cr);r={attributes:s.attributes.map((function(e){return{node:e,F:null}})),Va:s.Va.map((function(e){return{node:e,F:null}}))},o=a.value.fa}if(0===(s=t.next(0)).value.H.length)throw lr();if(1!==s.value.H.length)throw or();if(!(ee(s.value.H[0].type,54)||ee(s.value.H[0].type,47)||ee(s.value.H[0].type,56)||ee(s.value.H[0].type,58)||ee(s.value.H[0].type,57)))throw or();if(null===(i=Ge(e.h,s.value.H[0].value,null)))throw Error("XUDY0009: The target "+s.value.H[0].value.outerHTML+" for replacing a node must have a parent.");if(a=s.value.H[0],s=s.value.fa,ee(a.type,47)){if(r.Va.length)throw Error("XUTY0011: When replacing an attribute the new value must be zero or more attribute nodes.");r.attributes.reduce((function(e,t){var n=t.node.prefix||"";t=t.node.namespaceURI;var r=i.node.lookupNamespaceURI(n);if(r&&r!==t)throw ur(t);if((r=e[n])&&t!==r)throw cr(t);return e[n]=t,e}),{})}else if(r.attributes.length)throw Error("XUTY0010: When replacing an an element, text, comment, or processing instruction node the new value must be a single node.");return K({H:[],fa:vr([za(a.value,[].concat(r.attributes,r.Va))],o,s)})}}}(t,n,e)},y(ls,wr),ls.prototype.h=function(e,t){return br(e=this.u(e,t),(function(){}))},ls.prototype.u=function(e,t){var n,r,o,i=this,a=t.h,s=t.s,u=t.j,c=[],l=[],h=[];return{next:function(){if(l.length!==i.j.length)for(var d={},f=l.length;f<i.j.length;d={ib:d.ib},f++){var m=i.j[f],g=c[f];if(g||(c[f]=g=xr(m.gb)(e,t)),1!==(g=g.next(0)).value.H.length||!ee(g.value.H[0].type,53))throw Error("XUTY0013: The source expression of a copy modify expression must return a single node.");d.ib=je(Qr(g.value.H[0].value,t)),l.push(d.ib.value),h.push(g.value.fa),e=Tt(e,((g={})[m.Gc]=function(e){return function(){return ge.o(e.ib)}}(d),g))}return o||(n||(n=xr(i.J)(e,t)),o=n.next(0).value.fa),o.forEach((function(e){if(e.target&&!cs(e.target,l,a))throw Error("XUDY0014: The target "+e.target.node.outerHTML+" must be a node created by the copy clause.");if("put"===e.type)throw Error("XUDY0037: The modify expression of a copy modify expression can not contain a fn:put.")})),d=o.map((function(e){return us(e=e.h(t))})),yr(d,a,s,u),r||(r=xr(i.B)(e,t)),K({H:(d=r.next(0)).value.H,fa:vr.apply(null,[d.value.fa].concat(p(h)))})}}},ls.prototype.P=function(e){Bo(e),this.j.forEach((function(t){return t.Gc=So(e,t.Pb.namespaceURI,t.Pb.localName)})),wr.prototype.P.call(this,e),ko(e),this.I=this.j.some((function(e){return e.gb.I}))||this.B.I},y(hs,pr),hs.prototype.h=function(e,t){var n,r,o,i=this,a=!1;return ge.create({next:function(){if(a)return W;if(!r){if(i.u){if(!n){var s=i.u.h(e,t);n=is(i.B,t,s)}r=n.next(0).value.value}else r=i.name;if(r){if("xmlns"===r.prefix)throw mo(r);if(""===r.prefix&&"xmlns"===r.localName)throw mo(r);if("http://www.w3.org/2000/xmlns/"===r.namespaceURI)throw mo(r);if("xml"===r.prefix&&"http://www.w3.org/XML/1998/namespace"!==r.namespaceURI)throw mo(r);if(""!==r.prefix&&"xml"!==r.prefix&&"http://www.w3.org/XML/1998/namespace"===r.namespaceURI)throw mo(r)}}return i.j.vb?(s=i.j.vb,o||(o=It(s.map((function(n){return Rt(n.h(e,t),t).L((function(e){return ge.o($(e.map((function(e){return e.value})).join(" "),1))}))}))).L((function(e){return ge.o(je(ps(r,e.map((function(e){return e.value})).join(""))))})).value),o.next(0)):(a=!0,K(je(ps(r,i.j.value))))}})},hs.prototype.P=function(e){if(this.B=To(e),this.name&&this.name.prefix&&!this.name.namespaceURI){var t=e.ba(this.name.prefix);if(void 0===t&&this.name.prefix)throw kt(this.name.prefix);this.name.namespaceURI=t||null}pr.prototype.P.call(this,e)},y(ds,pr),ds.prototype.h=function(e,t){var n={data:"",Sa:!0,nodeType:8},r={node:n,F:null};return this.j?Rt(e=hr(this.j,e,t),t).L((function(e){if(e=e.map((function(e){return Wt(e,1).value})).join(" "),-1!==e.indexOf("--\x3e"))throw Error('XQDY0072: The contents of the data of a comment may not include "--\x3e"');return n.data=e,ge.o(je(r))})):ge.o(je(r))},y(fs,pr),fs.prototype.h=function(e,t){var n,r,o,i,a,s=this,u=!1,c=!1,l=!1;return ge.create({next:function(){if(l)return W;if(u||(n||(n=It(s.J.map((function(n){return hr(n,e,t)})))),r=n.N(),u=!0),!c){o||(o=s.ka.map((function(n){return hr(n,e,t)})));for(var p=[],h=0;h<o.length;h++){var d=o[h].N();p.push(d)}i=p,c=!0}if(s.u&&(a||(p=s.u.h(e,t),a=is(s.B,t,p)),p=a.next(0),s.j=p.value.value),"xmlns"===s.j.prefix||"http://www.w3.org/2000/xmlns/"===s.j.namespaceURI||"xml"===s.j.prefix&&"http://www.w3.org/XML/1998/namespace"!==s.j.namespaceURI||s.j.prefix&&"xml"!==s.j.prefix&&"http://www.w3.org/XML/1998/namespace"===s.j.namespaceURI)throw Error('XQDY0096: The node name "'+s.j.ya()+'" is invalid for a computed element constructor.');var f={nodeType:1,Sa:!0,attributes:[],childNodes:[],nodeName:s.j.ya(),namespaceURI:s.j.namespaceURI,prefix:s.j.prefix,localName:s.j.localName};for(p={node:f,F:null},r.forEach((function(e){f.attributes.push(e.value.node)})),(h=Wa(i,t,fo)).attributes.forEach((function(e){if(f.attributes.find((function(t){return t.namespaceURI===e.namespaceURI&&t.localName===e.localName})))throw Error("XQDY0025: The attribute "+e.name+" does not have an unique name in the constructed element.");f.attributes.push(e)})),h.Va.forEach((function(e){f.childNodes.push(e)})),h=0;h<f.childNodes.length;h++)if(Ie(d=f.childNodes[h])&&3===d.nodeType){var m=f.childNodes[h-1];m&&Ie(m)&&3===m.nodeType&&(m.data+=d.data,f.childNodes.splice(h,1),h--)}return l=!0,K(je(p))}})},fs.prototype.P=function(e){var t=this;if(Bo(e),Object.keys(this.T).forEach((function(n){return Co(e,n,t.T[n])})),this.ha.forEach((function(t){return t.P(e)})),this.J.reduce((function(t,n){if(n.name){if(n="Q{"+(null===n.name.namespaceURI?e.ba(n.name.prefix):n.name.namespaceURI)+"}"+n.name.localName,t.includes(n))throw Error("XQST0040: The attribute "+n+" does not have an unique name in the constructed element.");t.push(n)}return t}),[]),this.j&&null===this.j.namespaceURI){var n=e.ba(this.j.prefix);if(void 0===n&&this.j.prefix)throw kt(this.j.prefix);this.j.namespaceURI=n}this.B=To(e),ko(e)},y(ys,pr),ys.prototype.h=function(e,t){var n=this;return Rt(hr(this.u,e,t),t).L((function(r){var o=r.map((function(e){return Wt(e,1).value})).join(" ");if(-1!==o.indexOf("?>"))throw Error('XQDY0026: The contents of the data of a processing instruction may not include "?>"');if(null!==n.j.Lb)return ms(r=n.j.Lb),ge.o(je(gs(r,o)));r=hr(n.j.Eb,e,t);var i=os(t,r);return ge.create({next:function(){var e=i.next(0);return e.done?e:(ms(e=e.value.value),K(je(gs(e,o))))}})}))},y(vs,pr),vs.prototype.h=function(e,t){return this.j?Rt(e=hr(this.j,e,t),t).L((function(e){return 0===e.length?ge.empty():(e={node:{data:e.map((function(e){return Wt(e,1).value})).join(" "),Sa:!0,nodeType:3},F:null},ge.o(je(e)))})):ge.empty()},y(ws,Ar),ws.prototype.B=function(e,t,n){var r=this;return n[0](e).L((function(o){for(var i=0;i<r.j;i++)if(r.T[i].some((function(n){switch(n.Ec){case"?":if(1<o.length)return!1;break;case"*":break;case"+":if(1>o.length)return!1;break;default:if(1!==o.length)return!1}var r=ge.create(o);return o.every((function(o,i){return o=Nt(e,i,o,r),hr(n.Mb,o,t).getEffectiveBooleanValue()}))})))return n[i+1](e);return n[r.j+1](e)}))},ws.prototype.P=function(e){if(Ar.prototype.P.call(this,e),this.J.I)throw er()};var xs={aa:!1,sa:!1},bs={aa:!0,sa:!1},As={aa:!0,sa:!0};function Es(e){return e.aa?e.sa?As:bs:xs}function Ns(e,t){switch(e[0]){case"andOp":var n=Mo(e,"type");return new Yi(Bs("andOp",e,Es(t)),n);case"orOp":return n=Mo(e,"type"),new zi(Bs("orOp",e,Es(t)),n);case"unaryPlusOp":return n=Do(Do(e,"operand"),"*"),e=Mo(e,"type"),new $i("+",Ns(n,t),e);case"unaryMinusOp":return n=Do(Do(e,"operand"),"*"),e=Mo(e,"type"),new $i("-",Ns(n,t),e);case"addOp":case"subtractOp":case"multiplyOp":case"divOp":case"idivOp":case"modOp":var r=e[0],o=Ns(Uo(e,["firstOperand","*"]),Es(t));t=Ns(Uo(e,["secondOperand","*"]),Es(t));var i=Mo(e,"type"),a=Mo(Uo(e,["firstOperand","*"]),"type"),s=Mo(Uo(e,["secondOperand","*"]),"type");return a&&s&&Mo(e,"type")&&(n=Yo(r,a.type,s.type)),new Jo(r,o,t,i,n);case"sequenceExpr":return function(e,t){var n=Fo(e,"*").map((function(e){return Ns(e,t)}));return 1===n.length?n[0]:(n=Mo(e,"type"),new sa(Fo(e,"*").map((function(e){return Ns(e,t)})),n))}(e,t);case"unionOp":return n=Mo(e,"type"),new ga([Ns(Uo(e,["firstOperand","*"]),Es(t)),Ns(Uo(e,["secondOperand","*"]),Es(t))],n);case"exceptOp":case"intersectOp":return n=Mo(e,"type"),new aa(e[0],Ns(Uo(e,["firstOperand","*"]),Es(t)),Ns(Uo(e,["secondOperand","*"]),Es(t)),n);case"stringConcatenateOp":return function(e,t){var n=Mo(e,"type");return new kr(new Xi({localName:"concat",namespaceURI:"http://www.w3.org/2005/xpath-functions",prefix:""},(e=[Uo(e,["firstOperand","*"]),Uo(e,["secondOperand","*"])]).length,n),e.map((function(e){return Ns(e,Es(t))})),n)}(e,t);case"rangeSequenceExpr":return function(e,t){var n=Mo(e,"type");return new kr(new Xi({localName:"to",namespaceURI:"http://fontoxpath/operators",prefix:""},(e=[Do(Do(e,"startExpr"),"*"),Do(Do(e,"endExpr"),"*")]).length,n),e.map((function(e){return Ns(e,Es(t))})),n)}(e,t);case"equalOp":case"notEqualOp":case"lessThanOrEqualOp":case"lessThanOp":case"greaterThanOrEqualOp":case"greaterThanOp":return Cs("generalCompare",e,t);case"eqOp":case"neOp":case"ltOp":case"leOp":case"gtOp":case"geOp":return Cs("valueCompare",e,t);case"isOp":case"nodeBeforeOp":case"nodeAfterOp":return Cs("nodeCompare",e,t);case"pathExpr":return function(e,t){var n=Mo(e,"type"),r=Fo(e,"stepExpr"),o=!1,i=r.map((function(e){for(var r=Do(e,"xpathAxis"),i=Fo(e,"*"),a=[],s=null,u=(i=c(i)).next();!u.done;u=i.next())switch(u=u.value,u[0]){case"lookup":a.push(["lookup",Is(u,t)]);break;case"predicate":case"predicates":for(var l=(u=c(Fo(u,"*"))).next();!l.done;l=u.next())s=yi(s,(l=Ns(l.value,Es(t))).A()),a.push(["predicate",l])}if(r)switch(o=!0,e=Do(e,"attributeTest anyElementTest piTest documentTest elementTest commentTest namespaceTest anyKindTest textTest anyFunctionTest typedFunctionTest schemaAttributeTest atomicType anyItemType parenthesizedItemType typedMapTest typedArrayTest nameTest Wildcard".split(" ")),e=Ts(e),Ro(r)){case"ancestor":var p=new mi(e,{Qa:!1});break;case"ancestor-or-self":p=new mi(e,{Qa:!0});break;case"attribute":p=new vi(e,s);break;case"child":p=new wi(e,s);break;case"descendant":p=new bi(e,{Qa:!1});break;case"descendant-or-self":p=new bi(e,{Qa:!0});break;case"parent":p=new Bi(e,s);break;case"following-sibling":p=new Ti(e,s);break;case"preceding-sibling":p=new Ci(e,s);break;case"following":p=new Ni(e);break;case"preceding":p=new Ii(e);break;case"self":p=new Si(e,s)}else p=Ns(p=Uo(e,["filterExpr","*"]),Es(t));for(r=(a=c(a)).next();!r.done;r=a.next())switch(r=r.value,r[0]){case"lookup":p=new Ta(p,r[1]);break;case"predicate":p=new Aa(p,r[1])}return p.type=n,p}));return e=Do(e,"rootExpr"),!(r=o||null!==e||1<r.length)&&1===i.length||!e&&1===i.length&&"sorted"===i[0].O?i[0]:e&&0===i.length?new wa(null):(i=new ba(i,r),e?new wa(i):i)}(e,t);case"contextItemExpr":return new xa(Mo(e,"type"));case"functionCallExpr":return function(e,t){var n=Do(e,"functionName"),r=Fo(Do(e,"arguments"),"*");return e=Mo(e,"type"),new kr(new Xi(Go(n),r.length,e),r.map((function(e){return"argumentPlaceholder"===e[0]?null:Ns(e,t)})),e)}(e,t);case"inlineFunctionExpr":return function(e,t){var n=Fo(Do(e,"paramList"),"*"),r=Uo(e,["functionBody","*"]),o=Mo(e,"type");return new Pi(n.map((function(e){return{name:Go(Do(e,"varName")),type:Lo(e)}})),Lo(e),r?Ns(r,t):new sa([],o))}(e,t);case"arrowExpr":return function(e,t){var n=Mo(e,"type"),r=Uo(e,["argExpr","*"]);e=Fo(e,"*").slice(1),r=[Ns(r,t)];for(var o=0;o<e.length;o++)if("arguments"!==e[o][0]){if("arguments"===e[o+1][0]){var i=Fo(e[o+1],"*");r=r.concat(i.map((function(e){return"argumentPlaceholder"===e[0]?null:Ns(e,t)})))}r=[new kr(i="EQName"===e[o][0]?new Xi(Go(e[o]),r.length,n):Ns(e[o],Es(t)),r,n)]}return r[0]}(e,t);case"dynamicFunctionInvocationExpr":return function(e,t){var n=Uo(e,["functionItem","*"]),r=Mo(e,"type");e=Do(e,"arguments");var o=[];return e&&(o=Fo(e,"*").map((function(e){return"argumentPlaceholder"===e[0]?null:Ns(e,t)}))),new kr(Ns(n,t),o,r)}(e,t);case"namedFunctionRef":return t=Do(e,"functionName"),n=Mo(e,"type"),e=Ro(Uo(e,["integerConstantExpr","value"])),new Xi(Go(t),parseInt(e,10),n);case"integerConstantExpr":return new _i(Ro(Do(e,"value")),{type:5,g:3});case"stringConstantExpr":return new _i(Ro(Do(e,"value")),{type:1,g:3});case"decimalConstantExpr":return new _i(Ro(Do(e,"value")),{type:4,g:3});case"doubleConstantExpr":return new _i(Ro(Do(e,"value")),{type:3,g:3});case"varRef":return new Ra((e=Go(Do(e,"name"))).prefix,e.namespaceURI,e.localName);case"flworExpr":return function(e,t){var n=Fo(e,"*");if(e=Do(n[n.length-1],"*"),1<(n=n.slice(0,-1)).length&&!t.aa)throw Error("XPST0003: Use of XQuery FLWOR expressions in XPath is no allowed");return n.reduceRight((function(e,n){switch(n[0]){case"forClause":for(var r=(n=Fo(n,"*")).length-1;0<=r;--r){var o=n[r],i=Uo(o,["forExpr","*"]),a=Do(o,"positionalVariableBinding");e=new Li(Go(Uo(o,["typedVariableBinding","varName"])),Ns(i,Es(t)),a?Go(a):null,e)}return e;case"letClause":for(r=(n=Fo(n,"*")).length-1;0<=r;--r)i=Uo(o=n[r],["letExpr","*"]),e=new Hi(Go(Uo(o,["typedVariableBinding","varName"])),Ns(i,Es(t)),e);return e;case"whereClause":for(r=(n=Fo(n,"*")).length-1;0<=r;--r)e=new Ma(Ns(n[r],t),e);return e;case"windowClause":case"groupByClause":case"countClause":throw Error("Not implemented: "+n[0]+" is not implemented yet.");case"orderByClause":return function(e,t,n){return new va((e=Fo(e,"*")).filter((function(e){return"stable"!==e[0]})).map((function(e){var n=Do(e,"orderModifier"),r=n?Do(n,"orderingKind"):null;return n=n?Do(n,"emptyOrderingMode"):null,r=!r||"ascending"===Ro(r),n=!n||"empty least"===Ro(n),{da:Ns(Uo(e,["orderByExpr","*"]),t),Ib:r,Bc:n}})),n)}(n,t,e);default:throw Error("Not implemented: "+n[0]+" is not supported in a flwor expression")}}),Ns(e,t))}(e,t);case"quantifiedExpr":return function(e,t){var n=Mo(e,"type"),r=Ro(Do(e,"quantifier")),o=Uo(e,["predicateExpr","*"]);return e=Fo(e,"quantifiedExprInClause").map((function(e){return{name:Go(Uo(e,["typedVariableBinding","varName"])),gb:Ns(e=Uo(e,["sourceExpr","*"]),Es(t))}})),new Ia(r,e,Ns(o,Es(t)),n)}(e,t);case"ifThenElseExpr":return n=Mo(e,"type"),new Oi(Ns(Do(Do(e,"ifClause"),"*"),Es(t)),Ns(Do(Do(e,"thenClause"),"*"),t),Ns(Do(Do(e,"elseClause"),"*"),t),n);case"instanceOfExpr":return n=Ns(Uo(e,["argExpr","*"]),t),r=Uo(e,["sequenceType","*"]),o=Uo(e,["sequenceType","occurrenceIndicator"]),e=Mo(e,"type"),new ha(n,Ns(r,Es(t)),o?Ro(o):"",e);case"castExpr":return t=Ns(Do(Do(e,"argExpr"),"*"),Es(t)),n=Do(e,"singleType"),new la(t,e=Go(Do(n,"atomicType")),n=null!==Do(n,"optional"));case"castableExpr":return t=Ns(Do(Do(e,"argExpr"),"*"),Es(t)),n=Do(e,"singleType"),new ca(t,e=Go(Do(n,"atomicType")),n=null!==Do(n,"optional"));case"simpleMapExpr":return function(e,t){var n=Mo(e,"type");return Fo(e,"*").reduce((function(e,r){return null===e?Ns(r,Es(t)):new ua(e,Ns(r,Es(t)),n)}),null)}(e,t);case"mapConstructor":return function(e,t){var n=Mo(e,"type");return new ji(Fo(e,"mapConstructorEntry").map((function(e){return{key:Ns(Uo(e,["mapKeyExpr","*"]),Es(t)),value:Ns(Uo(e,["mapValueExpr","*"]),Es(t))}})),n)}(e,t);case"arrayConstructor":return function(e,t){var n=Mo(e,"type"),r=Fo(e=Do(e,"*"),"arrayElem").map((function(e){return Ns(Do(e,"*"),Es(t))}));switch(e[0]){case"curlyArray":return new hi(r,n);case"squareArray":return new di(r,n);default:throw Error("Unrecognized arrayType: "+e[0])}}(e,t);case"unaryLookup":return n=Mo(e,"type"),new Ba(Is(e,t),n);case"typeswitchExpr":return function(e,t){if(!t.aa)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");var n=Mo(e,"type"),r=Ns(Do(Do(e,"argExpr"),"*"),t),o=Fo(e,"typeswitchExprCaseClause").map((function(e){var n=0===Fo(e,"sequenceTypeUnion").length?[Do(e,"sequenceType")]:Fo(Do(e,"sequenceTypeUnion"),"sequenceType");return{zc:Ns(Uo(e,["resultExpr","*"]),t),Nb:n.map((function(e){var n=Do(e,"occurrenceIndicator");return{Ec:n?Ro(n):"",Mb:Ns(Do(e,"*"),t)}}))}}));return e=Ns(Uo(e,["typeswitchExprDefaultClause","resultExpr","*"]),t),new ws(r,o,e,n)}(e,t);case"elementConstructor":return function(e,t){if(!t.aa)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");var n=Go(Do(e,"tagName")),r=Do(e,"attributeList"),o=r?Fo(r,"attributeConstructor").map((function(e){return Ns(e,Es(t))})):[];return r=r?Fo(r,"namespaceDeclaration").map((function(e){var t=Do(e,"prefix");return{prefix:t?Ro(t):"",uri:Ro(Do(e,"uri"))}})):[],e=(e=Do(e,"elementContent"))?Fo(e,"*").map((function(e){return Ns(e,Es(t))})):[],new fs(n,o,r,e)}(e,t);case"attributeConstructor":return function(e,t){if(!t.aa)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");var n=Go(Do(e,"attributeName")),r=Do(e,"attributeValue");return r=r?Ro(r):null,e=(e=Do(e,"attributeValueExpr"))?Fo(e,"*").map((function(e){return Ns(e,Es(t))})):null,new hs(n,{value:r,vb:e})}(e,t);case"computedAttributeConstructor":return(n=Do(e,"tagName"))?n=Go(n):(n=Do(e,"tagNameExpr"),n={Ma:Ns(Do(n,"*"),Es(t))}),new hs(n,{vb:[e=Ns(Do(Do(e,"valueExpr"),"*"),Es(t))]});case"computedCommentConstructor":if(!t.aa)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");return new ds(e=(e=Do(e,"argExpr"))?Ns(Do(e,"*"),Es(t)):null);case"computedTextConstructor":if(!t.aa)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");return new vs(e=(e=Do(e,"argExpr"))?Ns(Do(e,"*"),Es(t)):null);case"computedElementConstructor":return function(e,t){var n=Do(e,"tagName");return n?n=Go(n):(n=Do(e,"tagNameExpr"),n={Ma:Ns(Do(n,"*"),Es(t))}),e=(e=Do(e,"contentExpr"))?Fo(e,"*").map((function(e){return Ns(e,Es(t))})):[],new fs(n,[],[],e)}(e,t);case"computedPIConstructor":if(!t.aa)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");return n=Do(e,"piTargetExpr"),r=Do(e,"piTarget"),o=Do(e,"piValueExpr"),e=Mo(e,"type"),new ys({Eb:n?Ns(Do(n,"*"),Es(t)):null,Lb:r?Ro(r):null},o?Ns(Do(o,"*"),Es(t)):new sa([],e));case"CDataSection":return new _i(Ro(e),{type:1,g:3});case"deleteExpr":return new Qa(e=Ns(Uo(e,["targetExpr","*"]),t));case"insertExpr":switch(n=Ns(Uo(e,["sourceExpr","*"]),t),(o=Fo(e,"*")[1])[0]){case"insertAfter":r=1;break;case"insertBefore":r=2;break;case"insertInto":r=(r=Do(o,"*"))?"insertAsFirst"===r[0]?4:5:3}return new Za(n,r,e=Ns(Uo(e,["targetExpr","*"]),t));case"renameExpr":return new as(n=Ns(Uo(e,["targetExpr","*"]),t),e=Ns(Uo(e,["newNameExpr","*"]),t));case"replaceExpr":return new ss(n=!!Do(e,"replaceValue"),r=Ns(Uo(e,["targetExpr","*"]),t),e=Ns(Uo(e,["replacementExpr","*"]),t));case"transformExpr":return function(e,t){var n=Fo(Do(e,"transformCopies"),"transformCopy").map((function(e){var n=Go(Do(Do(e,"varRef"),"name"));return{gb:Ns(Do(Do(e,"copySource"),"*"),t),Pb:new ve(n.prefix,n.namespaceURI,n.localName)}})),r=Ns(Do(Do(e,"modifyExpr"),"*"),t);return e=Ns(Do(Do(e,"returnExpr"),"*"),t),new ls(n,r,e)}(e,t);case"x:stackTrace":for(n=e[1],e=e[2];"x:stackTrace"===e[0];)e=e[2];return new Mi(n,e[0],Ns(e,t));default:return Ts(e)}}function Ts(e){switch(e[0]){case"nameTest":return new Oa(Go(e));case"piTest":return(e=Do(e,"piTarget"))?new ka(Ro(e)):new Sa(7);case"commentTest":return new Sa(8);case"textTest":return new Sa(3);case"documentTest":return new Sa(9);case"attributeTest":var t=(e=Do(e,"attributeName"))&&Do(e,"star");return!e||t?new Sa(2):new Oa(Go(Do(e,"QName")),{kind:2});case"elementTest":return t=(e=Do(e,"elementName"))&&Do(e,"star"),!e||t?new Sa(1):new Oa(Go(Do(e,"QName")),{kind:1});case"anyKindTest":return new Da({prefix:"",namespaceURI:null,localName:"node()"});case"anyMapTest":return new Da({prefix:"",namespaceURI:null,localName:"map(*)"});case"anyArrayTest":return new Da({prefix:"",namespaceURI:null,localName:"array(*)"});case"Wildcard":return Do(e,"star")?(t=Do(e,"uri"))?e=new Oa({localName:"*",namespaceURI:Ro(t),prefix:""}):(t=Do(e,"NCName"),e="star"===Do(e,"*")[0]?new Oa({localName:Ro(t),namespaceURI:null,prefix:"*"}):new Oa({localName:"*",namespaceURI:null,prefix:Ro(t)})):e=new Oa({localName:"*",namespaceURI:null,prefix:"*"}),e;case"atomicType":return new Da(Go(e));case"anyItemType":return new Da({prefix:"",namespaceURI:null,localName:"item()"});default:throw Error("No selector counterpart for: "+e[0]+".")}}function Bs(e,t,n){var r=[];return function t(o){var i=Do(Do(o,"firstOperand"),"*");o=Do(Do(o,"secondOperand"),"*"),i[0]===e?t(i):r.push(Ns(i,n)),o[0]===e?t(o):r.push(Ns(o,n))}(t),r}function Is(e,t){switch((e=Do(e,"*"))[0]){case"NCName":return new _i(Ro(e),{type:1,g:3});case"star":return"*";default:return Ns(e,Es(t))}}function Cs(e,t,n){var r=Uo(t,["firstOperand","*"]),o=Uo(t,["secondOperand","*"]);switch(r=Ns(r,Es(n)),n=Ns(o,Es(n)),e){case"valueCompare":return new Zi(t[0],r,n);case"nodeCompare":return new oa(t[0],r,n);case"generalCompare":return new na(t[0],r,n)}}function Ss(e,t){return Ns(e,t)}var Os=new Map;function ks(e,t,n,r,o,i){this.j=e,this.u=t,this.h=n,this.A=r,this.s=o,this.O=i}function Ds(e,t,n,r,o,i,a){var s=Os.get(e);s||(s=Object.create(null),Os.set(e,s)),(t=s[e=t+(i?"_DEBUG":"")])||(t=s[e]=[]),t.push(new ks(Object.values(n.h),Object.values(n.s),o,Object.keys(r).map((function(e){return{namespaceURI:r[e],prefix:e}})),a,n.j))}function Rs(e){var t=new Ee;if("http://www.w3.org/2005/XQueryX"!==e.namespaceURI&&"http://www.w3.org/2005/XQueryX"!==e.namespaceURI&&"http://fontoxml.com/fontoxpath"!==e.namespaceURI&&"http://www.w3.org/2007/xquery-update-10"!==e.namespaceURI)throw St("The XML structure passed as an XQueryX program was not valid XQueryX");var n=["stackTrace"===e.localName?"x:stackTrace":e.localName],r=t.getAllAttributes(e);for(r&&0<r.length&&n.push(Array.from(r).reduce((function(t,n){return"start"===n.localName||"end"===n.localName&&"stackTrace"===e.localName?t[n.localName]=JSON.parse(n.value):"type"===n.localName?t[n.localName]=ce(n.value):t[n.localName]=n.value,t}),{})),r=(t=c(t=t.getChildNodes(e))).next();!r.done;r=t.next())switch(r=r.value,r.nodeType){case 1:n.push(Rs(r));break;case 3:n.push(r.data)}return n}var Ms=Object.create(null);function Us(e,t){var n=Ms[e];n||(n=Ms[e]={Oa:[],Wa:[]}),n.Oa=n.Oa.concat(t.Oa),n.Wa=n.Wa.concat(t.Wa)}function Fs(e,t){var n=Ms[t];if(!n)throw Error("XQST0051: No modules found with the namespace uri "+t);n.Oa.forEach((function(n){return Io(e,t,n.localName,n.arity,n.Gb)})),n.Wa.forEach((function(n){So(e,t,n.localName),Oo(e,t,n.localName,(function(e,t){return hr(n.da,e,t)}))}))}function Gs(e){return e.replace(/(\x0D\x0A)|(\x0D(?!\x0A))/g,String.fromCharCode(10))}var Ls=t;function Ps(e,t){return function(n,r){return t.has(r)?t.get(r):(n=e(n,r),t.set(r,n),n)}}function Hs(e,t){return Ls.delimited(t,e,t)}function _s(e,t){return e.reverse().reduce((function(e,t){return Ls.preceded(t,e)}),t)}function js(e,t,n,r){return Ls.then(Ls.then(e,t,(function(e,t){return[e,t]})),n,(function(e,t){var n=c(e);return e=n.next().value,n=n.next().value,r(e,n,t)}))}function Xs(e,t,n,r,o){return Ls.then(Ls.then(Ls.then(e,t,(function(e,t){return[e,t]})),n,(function(e,t){var n=c(e);return[e=n.next().value,n=n.next().value,t]})),r,(function(e,t){var n=c(e);e=n.next().value;var r=n.next().value;return n=n.next().value,o(e,r,n,t)}))}function qs(e){return Ls.map(e,(function(e){return[e]}))}function Vs(e,t){return Ls.map(Ls.or(e),(function(){return t}))}function $s(e){return function(t,n){return(t=e.exec(t.substring(n)))&&0===t.index?Ls.okWithValue(n+t[0].length,t[0]):Ls.error(n,[e.source],!1)}}var Ys=Ls.or([Ls.token(" "),Ls.token("\t"),Ls.token("\r"),Ls.token("\n")]),zs=Ls.token("(:"),Qs=Ls.token(":)"),Js=Ls.token("(#"),Ws=Ls.token("#)"),Ks=Ls.token("("),Zs=Ls.token(")"),eu=Ls.token("["),tu=Ls.token("]"),nu=Ls.token("{"),ru=Ls.token("}"),ou=Ls.token("{{"),iu=Ls.token("}}"),au=Ls.token("'"),su=Ls.token("''"),uu=Ls.token('"'),cu=Ls.token('""'),lu=Ls.token("<![CDATA["),pu=Ls.token("]]>"),hu=Ls.token("/>"),du=Ls.token("</"),fu=Ls.token("\x3c!--"),mu=Ls.token("--\x3e"),gu=Ls.token("<?"),yu=Ls.token("?>"),vu=Ls.token("&#x"),wu=Ls.token("&#"),xu=Ls.token(":*"),bu=Ls.token("*:"),Au=Ls.token(":="),Eu=Ls.token("&"),Nu=Ls.token(":"),Tu=Ls.token(";"),Bu=Ls.token("*"),Iu=Ls.token("@"),Cu=Ls.token("$"),Su=Ls.token("#"),Ou=Ls.token("%"),ku=Ls.token("?"),Du=Ls.token("!"),Ru=Ls.token("|"),Mu=Ls.token("||"),Uu=Ls.token("="),Fu=Ls.token("!="),Gu=Ls.token("<"),Lu=Ls.token("<<"),Pu=Ls.token("<="),Hu=Ls.token(">"),_u=Ls.token(">>"),ju=Ls.token(">="),Xu=Ls.token(","),qu=Ls.token("."),Vu=Ls.token(".."),$u=Ls.token("+"),Yu=Ls.token("-"),zu=Ls.token("/"),Qu=Ls.token("//"),Ju=Ls.token("=>"),Wu=Ls.token("e"),Ku=Ls.token("E"),Zu=Ls.token("l"),ec=Ls.token("L"),tc=Ls.token("m"),nc=Ls.token("M"),rc=Ls.token("Q"),oc=Ls.token("x"),ic=Ls.token("X"),ac=Ls.token("as"),sc=Ls.token("cast"),uc=Ls.token("castable"),cc=Ls.token("treat"),lc=Ls.token("instance"),pc=Ls.token("of"),hc=Ls.token("node"),dc=Ls.token("nodes"),fc=Ls.token("delete"),mc=Ls.token("value"),gc=Ls.token("function"),yc=Ls.token("map"),vc=Ls.token("element"),wc=Ls.token("attribute"),xc=Ls.token("schema-element"),bc=Ls.token("intersect"),Ac=Ls.token("except"),Ec=Ls.token("union"),Nc=Ls.token("to"),Tc=Ls.token("is"),Bc=Ls.token("or"),Ic=Ls.token("and"),Cc=Ls.token("div"),Sc=Ls.token("idiv"),Oc=Ls.token("mod"),kc=Ls.token("eq"),Dc=Ls.token("ne"),Rc=Ls.token("lt"),Mc=Ls.token("le"),Uc=Ls.token("gt"),Fc=Ls.token("ge"),Gc=Ls.token("amp"),Lc=Ls.token("quot"),Pc=Ls.token("apos"),Hc=Ls.token("if"),_c=Ls.token("then"),jc=Ls.token("else"),Xc=Ls.token("allowing"),qc=Ls.token("empty"),Vc=Ls.token("at"),$c=Ls.token("in"),Yc=Ls.token("for"),zc=Ls.token("let"),Qc=Ls.token("where"),Jc=Ls.token("collation"),Wc=Ls.token("group"),Kc=Ls.token("by"),Zc=Ls.token("order"),el=Ls.token("stable"),tl=Ls.token("return"),nl=Ls.token("array"),rl=Ls.token("document"),ol=Ls.token("namespace"),il=Ls.token("text"),al=Ls.token("comment"),sl=Ls.token("processing-instruction"),ul=Ls.token("lax"),cl=Ls.token("strict"),ll=Ls.token("validate"),pl=Ls.token("type"),hl=Ls.token("declare"),dl=Ls.token("default"),fl=Ls.token("boundary-space"),ml=Ls.token("strip"),gl=Ls.token("preserve"),yl=Ls.token("no-preserve"),vl=Ls.token("inherit"),wl=Ls.token("no-inherit"),xl=Ls.token("greatest"),bl=Ls.token("least"),Al=Ls.token("copy-namespaces"),El=Ls.token("decimal-format"),Nl=Ls.token("case"),Tl=Ls.token("typeswitch"),Bl=Ls.token("some"),Il=Ls.token("every"),Cl=Ls.token("satisfies"),Sl=Ls.token("replace"),Ol=Ls.token("with"),kl=Ls.token("copy"),Dl=Ls.token("modify"),Rl=Ls.token("first"),Ml=Ls.token("last"),Ul=Ls.token("before"),Fl=Ls.token("after"),Gl=Ls.token("into"),Ll=Ls.token("insert"),Pl=Ls.token("rename"),Hl=Ls.token("switch"),_l=Ls.token("variable"),jl=Ls.token("external"),Xl=Ls.token("updating"),ql=Ls.token("import"),Vl=Ls.token("schema"),$l=Ls.token("module"),Yl=Ls.token("base-uri"),zl=Ls.token("construction"),Ql=Ls.token("ordering"),Jl=Ls.token("ordered"),Wl=Ls.token("unordered"),Kl=Ls.token("option"),Zl=Ls.token("context"),ep=Ls.token("item"),tp=Ls.token("xquery"),np=Ls.token("version"),rp=Ls.token("encoding"),op=Ls.token("document-node"),ip=Ls.token("namespace-node"),ap=Ls.token("schema-attribute"),sp=Ls.token("ascending"),up=Ls.token("descending"),cp=Ls.token("empty-sequence"),lp=Ls.token("child::"),pp=Ls.token("descendant::"),hp=Ls.token("attribute::"),dp=Ls.token("self::"),fp=Ls.token("descendant-or-self::"),mp=Ls.token("following-sibling::"),gp=Ls.token("following::"),yp=Ls.token("parent::"),vp=Ls.token("ancestor::"),wp=Ls.token("preceding-sibling::"),xp=Ls.token("preceding::"),bp=Ls.token("ancestor-or-self::"),Ap=Ls.token("decimal-separator"),Ep=Ls.token("grouping-separator"),Np=Ls.token("infinity"),Tp=Ls.token("minus-sign"),Bp=Ls.token("NaN"),Ip=Ls.token("per-mille"),Cp=Ls.token("zero-digit"),Sp=Ls.token("digit"),Op=Ls.token("pattern-separator"),kp=Ls.token("exponent-separator"),Dp=Ls.token("schema-attribute("),Rp=Ls.token("document-node("),Mp=Ls.token("processing-instruction("),Up=Ls.token("processing-instruction()"),Fp=Ls.token("comment()"),Gp=Ls.token("text()"),Lp=Ls.token("namespace-node()"),Pp=Ls.token("node()"),Hp=Ls.token("item()"),_p=Ls.token("empty-sequence()"),jp=new Map,Xp=new Map,qp=Ls.or([$s(/[\t\n\r -\uD7FF\uE000\uFFFD]/),$s(/[\uD800-\uDBFF][\uDC00-\uDFFF]/)]),Vp=Ls.preceded(Ls.peek(Ls.not(Ls.or([zs,Qs]),['comment contents cannot contain "(:" or ":)"'])),qp),$p=Ls.map(Ls.delimited(zs,Ls.star(Ls.or([Vp,function(e,t){return $p(e,t)}])),Qs),(function(e){return e.join("")})),Yp=Ls.or([Ys,$p]),zp=Ls.map(Ls.plus(Ys),(function(e){return e.join("")})),Qp=Ps(Ls.map(Ls.star(Yp),(function(e){return e.join("")})),jp),Jp=Ps(Ls.map(Ls.plus(Yp),(function(e){return e.join("")})),Xp),Wp=Ls.or([$s(/[A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/),Ls.then($s(/[\uD800-\uDB7F]/),$s(/[\uDC00-\uDFFF]/),(function(e,t){return e+t}))]),Kp=Ls.or([Wp,$s(/[\-\.0-9\xB7\u0300-\u036F\u203F\u2040]/)]),Zp=Ls.then(Wp,Ls.star(Kp),(function(e,t){return e+t.join("")})),eh=Ls.map(Zp,(function(e){return["prefix",e]})),th=Ls.or([Wp,Nu]),nh=Ls.or([Kp,Nu]),rh=Ls.then(th,Ls.star(nh),(function(e,t){return e+t.join("")})),oh=Ls.map(Zp,(function(e){var t={};return[(t.prefix="",t.URI=null,t),e]})),ih=Ls.then(Zp,Ls.preceded(Nu,Zp),(function(e,t){var n={};return[(n.prefix=e,n.URI=null,n),t]})),ah=Ls.or([ih,oh]),sh=Ls.followed(_s([rc,Qp,nu],Ls.map(Ls.star($s(/[^{}]/)),(function(e){return e.join("").replace(/\s+/g," ").trim()}))),ru),uh=Ls.then(sh,Zp,(function(e,t){return[e,t]})),ch=Ls.or([Ls.map(uh,(function(e){var t={};return[(t.prefix=null,t.URI=e[0],t),e[1]]})),ah]),lh=Ls.or([Ls.map(ch,(function(e){return["QName"].concat(p(e))})),Ls.map(Bu,(function(){return["star"]}))]),ph=Ls.map(Ls.preceded(Cu,ch),(function(e){return["varRef",["name"].concat(p(e))]})),hh=Ls.peek(Ls.or([Ks,uu,au,Yp])),dh=Ls.map(Ls.or([lp,pp,hp,dp,fp,mp,gp]),(function(e){return e.substring(0,e.length-2)})),fh=Ls.map(Ls.or([yp,vp,wp,xp,bp]),(function(e){return e.substring(0,e.length-2)})),mh=js(Eu,Ls.or([Rc,Uc,Gc,Lc,Pc]),Tu,(function(e,t,n){return e+t+n})),gh=Ls.or([js(vu,$s(/[0-9a-fA-F]+/),Tu,(function(e,t,n){return e+t+n})),js(wu,$s(/[0-9]+/),Tu,(function(e,t,n){return e+t+n}))]),yh=Vs([cu],'"'),vh=Vs([su],"'"),wh=qs(Vs([Fp],"commentTest")),xh=qs(Vs([Gp],"textTest")),bh=qs(Vs([Lp],"namespaceTest")),Ah=qs(Vs([Pp],"anyKindTest")),Eh=$s(/[0-9]+/),Nh=Ls.then(Ls.or([Ls.then(qu,Eh,(function(e,t){return e+t})),Ls.then(Eh,Ls.optional(Ls.preceded(qu,$s(/[0-9]*/))),(function(e,t){return e+(null!==t?"."+t:"")}))]),js(Ls.or([Wu,Ku]),Ls.optional(Ls.or([$u,Yu])),Eh,(function(e,t,n){return e+(t||"")+n})),(function(e,t){return["doubleConstantExpr",["value",e+t]]})),Th=Ls.or([Ls.map(Ls.preceded(qu,Eh),(function(e){return["decimalConstantExpr",["value","."+e]]})),Ls.then(Ls.followed(Eh,qu),Ls.optional(Eh),(function(e,t){return["decimalConstantExpr",["value",e+"."+(null!==t?t:"")]]}))]),Bh=Ls.map(Eh,(function(e){return["integerConstantExpr",["value",e]]})),Ih=Ls.followed(Ls.or([Nh,Th,Bh]),Ls.peek(Ls.not($s(/[a-zA-Z]/),["no alphabetical characters after numeric literal"]))),Ch=Ls.map(Ls.followed(qu,Ls.peek(Ls.not(qu,["context item should not be followed by another ."]))),(function(){return["contextItemExpr"]})),Sh=Ls.or([nl,wc,al,op,vc,cp,gc,Hc,ep,yc,ip,hc,sl,ap,xc,Hl,il,Tl]),Oh=qs(Vs([ku],"argumentPlaceholder")),kh=Ls.or([ku,Bu,$u]),Dh=Ls.preceded(Ls.peek(Ls.not($s(/[{}<&]/),["elementContentChar cannot be {, }, <, or &"])),qp),Rh=Ls.map(Ls.delimited(lu,Ls.star(Ls.preceded(Ls.peek(Ls.not(pu,['CDataSection content may not contain "]]>"'])),qp)),pu),(function(e){return["CDataSection",e.join("")]})),Mh=Ls.preceded(Ls.peek(Ls.not($s(/["{}<&]/),['quotAttrValueContentChar cannot be ", {, }, <, or &'])),qp),Uh=Ls.preceded(Ls.peek(Ls.not($s(/['{}<&]/),["aposAttrValueContentChar cannot be ', {, }, <, or &"])),qp),Fh=Ls.map(Ls.star(Ls.or([Ls.preceded(Ls.peek(Ls.not(Yu,[])),qp),Ls.map(_s([Yu,Ls.peek(Ls.not(Yu,[]))],qp),(function(e){return"-"+e}))])),(function(e){return e.join("")})),Gh=Ls.map(Ls.delimited(fu,Fh,mu),(function(e){return["computedCommentConstructor",["argExpr",["stringConstantExpr",["value",e]]]]})),Lh=Ls.preceded(Ls.peek(Ls.not(js(Ls.or([ic,oc]),Ls.or([nc,tc]),Ls.or([ec,Zu]),(function(){return[]})),[])),rh),Ph=Ls.map(Ls.star(Ls.preceded(Ls.peek(Ls.not(yu,[])),qp)),(function(e){return e.join("")})),Hh=Ls.then(Ls.preceded(gu,Lh),Ls.followed(Ls.optional(Ls.preceded(zp,Ph)),yu),(function(e,t){return["computedPIConstructor",["piTarget",e],["piValueExpr",["stringConstantExpr",["value",t]]]]})),_h=Ls.map(Qu,(function(){return["stepExpr",["xpathAxis","descendant-or-self"],["anyKindTest"]]})),jh=Ls.or([ul,cl]),Xh=Ls.map(Ls.star(Ls.followed(qp,Ls.peek(Ls.not(Ws,["Pragma contents should not contain '#)'"])))),(function(e){return e.join("")})),qh=Ls.map(Ls.followed(Ls.or([kc,Dc,Rc,Mc,Uc,Fc]),hh),(function(e){return e+"Op"})),Vh=Ls.or([Ls.followed(Vs([Tc],"isOp"),hh),Vs([Lu],"nodeBeforeOp"),Vs([_u],"nodeAfterOp")]),$h=Ls.or([Vs([Uu],"equalOp"),Vs([Fu],"notEqualOp"),Vs([Pu],"lessThanOrEqualOp"),Vs([Gu],"lessThanOp"),Vs([ju],"greaterThanOrEqualOp"),Vs([Hu],"greaterThanOp")]),Yh=Ls.map(Xl,(function(){return["annotation",["annotationName","updating"]]})),zh=Ls.or([gl,yl]),Qh=Ls.or([vl,wl]),Jh=Ls.or([Ap,Ep,Np,Tp,Bp,Ou,Ip,Cp,Sp,Op,kp]),Wh=Ls.map(_s([hl,Jp,fl,Jp],Ls.or([gl,ml])),(function(e){return["boundarySpaceDecl",e]})),Kh=Ls.map(_s([hl,Jp,zl,Jp],Ls.or([gl,ml])),(function(e){return["constructionDecl",e]})),Zh=Ls.map(_s([hl,Jp,Ql,Jp],Ls.or([Jl,Wl])),(function(e){return["orderingModeDecl",e]})),ed=Ls.map(_s([hl,Jp,dl,Jp,Zc,Jp,qc,Jp],Ls.or([xl,bl])),(function(e){return["emptyOrderDecl",e]})),td=Ls.then(_s([hl,Jp,Al,Jp],zh),_s([Qp,Xu,Qp],Qh),(function(e,t){return["copyNamespacesDecl",["preserveMode",e],["inheritMode",t]]}));function nd(e){switch(e[0]){case"constantExpr":case"varRef":case"contextItemExpr":case"functionCallExpr":case"sequenceExpr":case"elementConstructor":case"computedElementConstructor":case"computedAttributeConstructor":case"computedDocumentConstructor":case"computedTextConstructor":case"computedCommentConstructor":case"computedNamespaceConstructor":case"computedPIConstructor":case"orderedExpr":case"unorderedExpr":case"namedFunctionRef":case"inlineFunctionExpr":case"dynamicFunctionInvocationExpr":case"mapConstructor":case"arrayConstructor":case"stringConstructor":case"unaryLookup":return e}return["sequenceExpr",e]}function rd(e){if(!(1<=e&&55295>=e||57344<=e&&65533>=e||65536<=e&&1114111>=e))throw Error("XQST0090: The character reference "+e+" ("+e.toString(16)+") does not reference a valid codePoint.")}function od(e){return e.replace(/(&[^;]+);/g,(function(e){if(/^&#x/.test(e))return rd(e=parseInt(e.slice(3,-1),16)),String.fromCodePoint(e);if(/^&#/.test(e))return rd(e=parseInt(e.slice(2,-1),10)),String.fromCodePoint(e);switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&quot;":return String.fromCharCode(34);case"&apos;":return String.fromCharCode(39)}throw Error('XPST0003: Unknown character reference: "'+e+'"')}))}function id(e,t,n){if(!e.length)return[];for(var r=[e[0]],o=1;o<e.length;++o){var i=r[r.length-1];"string"==typeof i&&"string"==typeof e[o]?r[r.length-1]=i+e[o]:r.push(e[o])}if("string"==typeof r[0]&&0===r.length)return[];if(r=r.reduce((function(e,t,o){if("string"!=typeof t)e.push(t);else if(n&&/^\s*$/.test(t)){var i=r[o+1];(i&&"CDataSection"===i[0]||(o=r[o-1])&&"CDataSection"===o[0])&&e.push(od(t))}else e.push(od(t));return e}),[]),!r.length)return r;if(1<r.length||t)for(e=0;e<r.length;e++)"string"==typeof r[e]&&(r[e]=["stringConstantExpr",["value",r[e]]]);return r}function ad(e){return e[0].prefix?e[0].prefix+":"+e[1]:e[1]}var sd=Ls.then(ch,Ls.optional(ku),(function(e,t){return null!==t?["singleType",["atomicType"].concat(p(e)),["optional"]]:["singleType",["atomicType"].concat(p(e))]})),ud=Ls.map(ch,(function(e){return["atomicType"].concat(p(e))})),cd=new Map;function ld(e){function t(e,t){return t.reduce((function(e,t){return[t[0],["firstOperand",e],["secondOperand",t[1]]]}),e)}function n(e,t,n){return Ls.then(e,Ls.star(Ls.then(Hs(t,Qp),e,(function(e,t){return[e,t]}))),n)}function r(e,t,n,r){return n=void 0===n?"firstOperand":n,r=void 0===r?"secondOperand":r,Ls.then(e,Ls.optional(Ls.then(Hs(t,Qp),e,(function(e,t){return[e,t]}))),(function(e,t){return null===t?e:[t[0],[n,e],[r,t[1]]]}))}function o(t){return e.ub?function(e,n){if(!(e=t(e,n)).success)return e;var r=l.has(n)?l.get(n):{offset:n,line:-1,la:-1},o=l.has(e.offset)?l.get(e.offset):{offset:e.offset,line:-1,la:-1};return l.set(n,r),l.set(e.offset,o),Ls.okWithValue(e.offset,["x:stackTrace",{start:r,end:o},e.value])}:t}function i(e,t){return W(e,t)}function a(e,t){return Pe(e,t)}function s(e,t){return o(Ls.or([It,Rt,jt,Ot,st,Pt,Mt,Ht,Ut,Gt,at]))(e,t)}function u(e,t){return n(s,Xu,(function(e,t){return 0===t.length?e:["sequenceExpr",e].concat(p(t.map((function(e){return e[1]}))))}))(e,t)}var l=new Map,h=Ls.preceded(eu,Ls.followed(Hs(u,Qp),tu)),d=Ls.map(e.Xa?Ls.or([Hs(Ls.star(Ls.or([mh,gh,yh,$s(/[^"&]/)])),uu),Hs(Ls.star(Ls.or([mh,gh,vh,$s(/[^'&]/)])),au)]):Ls.or([Hs(Ls.star(Ls.or([yh,$s(/[^"]/)])),uu),Hs(Ls.star(Ls.or([vh,$s(/[^']/)])),au)]),(function(e){return e.join("")})),f=Ls.or([Ls.map(_s([vc,Qp],Ls.delimited(Ls.followed(Ks,Qp),Ls.then(lh,_s([Qp,Xu,Qp],ch),(function(e,t){return[["elementName",e],["typeName"].concat(p(t))]})),Ls.preceded(Qp,Zs))),(function(e){var t=c(e);return["elementTest",e=t.next().value,t=t.next().value]})),Ls.map(_s([vc,Qp],Ls.delimited(Ks,lh,Zs)),(function(e){return["elementTest",["elementName",e]]})),Ls.map(_s([vc,Qp],Ls.delimited(Ks,Qp,Zs)),(function(){return["elementTest"]}))]),m=Ls.or([Ls.map(ch,(function(e){return["QName"].concat(p(e))})),Ls.map(Bu,(function(){return["star"]}))]),g=Ls.or([Ls.map(_s([wc,Qp],Ls.delimited(Ls.followed(Ks,Qp),Ls.then(m,_s([Qp,Xu,Qp],ch),(function(e,t){return[["attributeName",e],["typeName"].concat(p(t))]})),Ls.preceded(Qp,Zs))),(function(e){var t=c(e);return["attributeTest",e=t.next().value,t=t.next().value]})),Ls.map(_s([wc,Qp],Ls.delimited(Ks,m,Zs)),(function(e){return["attributeTest",["attributeName",e]]})),Ls.map(_s([wc,Qp],Ls.delimited(Ks,Qp,Zs)),(function(){return["attributeTest"]}))]),y=Ls.map(_s([xc,Qp,Ks],Ls.followed(ch,Zs)),(function(e){return["schemaElementTest"].concat(p(e))})),v=Ls.map(Ls.delimited(Dp,Hs(ch,Qp),Zs),(function(e){return["schemaAttributeTest"].concat(p(e))})),w=Ls.map(Ls.preceded(Rp,Ls.followed(Hs(Ls.optional(Ls.or([f,y])),Qp),Zs)),(function(e){return["documentTest"].concat(p(e?[e]:[]))})),x=Ls.or([Ls.map(Ls.preceded(Mp,Ls.followed(Hs(Ls.or([Zp,d]),Qp),Zs)),(function(e){return["piTest",["piTarget",e]]})),qs(Vs([Up],"piTest"))]),b=Ls.or([w,f,g,y,v,x,wh,xh,bh,Ah]),A=Ls.or([Ls.map(Ls.preceded(bu,Zp),(function(e){return["Wildcard",["star"],["NCName",e]]})),qs(Vs([Bu],"Wildcard")),Ls.map(Ls.followed(sh,Bu),(function(e){return["Wildcard",["uri",e],["star"]]})),Ls.map(Ls.followed(Zp,xu),(function(e){return["Wildcard",["NCName",e],["star"]]}))]),E=Ls.or([A,Ls.map(ch,(function(e){return["nameTest"].concat(p(e))}))]),N=Ls.or([b,E]),T=Ls.then(Ls.optional(Iu),N,(function(e,t){return null!==e||"attributeTest"===t[0]||"schemaAttributeTest"===t[0]?["stepExpr",["xpathAxis","attribute"],t]:["stepExpr",["xpathAxis","child"],t]})),B=Ls.or([Ls.then(dh,N,(function(e,t){return["stepExpr",["xpathAxis",e],t]})),T]),I=Ls.map(Vu,(function(){return["stepExpr",["xpathAxis","parent"],["anyKindTest"]]})),C=Ls.or([Ls.then(fh,N,(function(e,t){return["stepExpr",["xpathAxis",e],t]})),I]),S=Ls.map(Ls.star(Ls.preceded(Qp,h)),(function(e){return 0<e.length?["predicates"].concat(p(e)):void 0})),O=Ls.then(Ls.or([C,B]),S,(function(e,t){return void 0===t?e:e.concat([t])})),k=Ls.or([Ih,Ls.map(d,(function(t){return["stringConstantExpr",["value",e.Xa?od(t):t]]}))]),D=Ls.or([Ls.delimited(Ks,Hs(u,Qp),Zs),Ls.map(Ls.delimited(Ks,Qp,Zs),(function(){return["sequenceExpr"]}))]),R=Ls.or([s,Oh]),M=Ls.map(Ls.delimited(Ks,Hs(Ls.optional(Ls.then(R,Ls.star(Ls.preceded(Hs(Xu,Qp),R)),(function(e,t){return[e].concat(p(t))}))),Qp),Zs),(function(e){return null!==e?e:[]})),U=Ls.preceded(Ls.not(js(Sh,Qp,Ks,(function(){})),["cannot use reseved keyword for function names"]),Ls.then(ch,Ls.preceded(Qp,M),(function(e,t){return["functionCallExpr",["functionName"].concat(p(e)),null!==t?["arguments"].concat(p(t)):["arguments"]]}))),F=Ls.then(ch,Ls.preceded(Su,Bh),(function(e,t){return["namedFunctionRef",["functionName"].concat(p(e)),t]})),G=Ls.delimited(nu,Hs(Ls.optional(u),Qp),ru),L=Ls.map(G,(function(e){return e||["sequenceExpr"]})),P=Ls.or([Ls.map(_p,(function(){return[["voidSequenceType"]]})),Ls.then(i,Ls.optional(Ls.preceded(Qp,kh)),(function(e,t){return[e].concat(p(null!==t?[["occurrenceIndicator",t]]:[]))}))]),H=Ls.then(_s([Ou,Qp],ch),Ls.optional(Ls.followed(Ls.then(_s([Ks,Qp],k),Ls.star(_s([Xu,Qp],k)),(function(e,t){return e.concat(t)})),Zs)),(function(e,t){return["annotation",["annotationName"].concat(p(e))].concat(p(t?["arguments",t]:[]))})),_=Ls.map(_s([gc,Qp,Ks,Qp,Bu,Qp],Zs),(function(){return["anyFunctionTest"]})),j=Ls.then(_s([gc,Qp,Ks,Qp],Ls.optional(n(P,Xu,(function(e,t){return e.concat.apply(e,t.map((function(e){return e[1]})))})))),_s([Qp,Zs,Jp,ac,Jp],P),(function(e,t){return["typedFunctionTest",["paramTypeList",["sequenceType"].concat(p(e||[]))],["sequenceType"].concat(p(t))]})),X=Ls.then(Ls.star(H),Ls.or([_,j]),(function(e,t){return[t[0]].concat(p(e),p(t.slice(1)))})),q=Ls.map(_s([yc,Qp,Ks,Qp,Bu,Qp],Zs),(function(){return["anyMapTest"]})),V=Ls.then(_s([yc,Qp,Ks,Qp],ud),_s([Qp,Xu],Ls.followed(Hs(P,Qp),Zs)),(function(e,t){return["typedMapTest",e,["sequenceType"].concat(p(t))]})),$=Ls.or([q,V]),Y=Ls.map(_s([nl,Qp,Ks,Qp,Bu,Qp],Zs),(function(){return["anyArrayTest"]})),z=Ls.map(_s([nl,Qp,Ks],Ls.followed(Hs(P,Qp),Zs)),(function(e){return["typedArrayTest",["sequenceType"].concat(p(e))]})),Q=Ls.or([Y,z]),J=Ls.map(Ls.delimited(Ks,Hs(i,Qp),Zs),(function(e){return["parenthesizedItemType",e]})),W=Ls.or([b,qs(Vs([Hp],"anyItemType")),X,$,Q,ud,J]),K=Ls.map(_s([ac,Jp],P),(function(e){return["typeDeclaration"].concat(p(e))})),Z=Ls.then(Ls.preceded(Cu,ch),Ls.optional(Ls.preceded(Jp,K)),(function(e,t){return["param",["varName"].concat(p(e))].concat(p(t?[t]:[]))})),ee=n(Z,Xu,(function(e,t){return[e].concat(p(t.map((function(e){return e[1]}))))})),te=Xs(Ls.star(H),_s([Qp,gc,Qp,Ks,Qp],Ls.optional(ee)),_s([Qp,Zs,Qp],Ls.optional(Ls.map(_s([ac,Qp],Ls.followed(P,Qp)),(function(e){return["typeDeclaration"].concat(p(e))})))),L,(function(e,t,n,r){return["inlineFunctionExpr"].concat(p(e),[["paramList"].concat(p(t||[]))],p(n?[n]:[]),[["functionBody",r]])})),ne=Ls.or([F,te]),re=Ls.map(s,(function(e){return["mapKeyExpr",e]})),oe=Ls.map(s,(function(e){return["mapValueExpr",e]})),ie=Ls.then(re,Ls.preceded(Hs(Nu,Qp),oe),(function(e,t){return["mapConstructorEntry",e,t]})),ae=Ls.preceded(yc,Ls.delimited(Hs(nu,Qp),Ls.map(Ls.optional(n(ie,Hs(Xu,Qp),(function(e,t){return[e].concat(p(t.map((function(e){return e[1]}))))}))),(function(e){return e?["mapConstructor"].concat(p(e)):["mapConstructor"]})),Ls.preceded(Qp,ru))),se=Ls.map(Ls.delimited(eu,Hs(Ls.optional(n(s,Xu,(function(e,t){return[e].concat(p(t.map((function(e){return e[1]})))).map((function(e){return["arrayElem",e]}))}))),Qp),tu),(function(e){return["squareArray"].concat(p(null!==e?e:[]))})),ue=Ls.map(Ls.preceded(nl,Ls.preceded(Qp,G)),(function(e){return["curlyArray"].concat(p(null!==e?[["arrayElem",e]]:[]))})),ce=Ls.map(Ls.or([se,ue]),(function(e){return["arrayConstructor",e]})),le=Ls.or([Zp,Bh,D,Bu]),pe=Ls.map(Ls.preceded(ku,Ls.preceded(Qp,le)),(function(e){return"*"===e?["unaryLookup",["star"]]:"string"==typeof e?["unaryLookup",["NCName",e]]:["unaryLookup",e]})),he=Ls.or([mh,gh,Vs([ou],"{"),Vs([iu],"}"),Ls.map(G,(function(e){return e||["sequenceExpr"]}))]),de=Ls.or([Rh,function(e,t){return xe(e,t)},he,Dh]),fe=Ls.or([Ls.map(Mh,(function(e){return e.replace(/[\x20\x0D\x0A\x09]/g," ")})),he]),me=Ls.or([Ls.map(Uh,(function(e){return e.replace(/[\x20\x0D\x0A\x09]/g," ")})),he]),ge=Ls.map(Ls.or([Hs(Ls.star(Ls.or([yh,fe])),uu),Hs(Ls.star(Ls.or([vh,me])),au)]),(function(e){return id(e,!1,!1)})),ye=Ls.then(ah,Ls.preceded(Hs(Uu,Ls.optional(zp)),ge),(function(e,t){if(""===e[0].prefix&&"xmlns"===e[1]){if(t.length&&"string"!=typeof t[0])throw Error("XQST0022: A namespace declaration may not contain enclosed expressions");return["namespaceDeclaration",t.length?["uri",t[0]]:["uri"]]}if("xmlns"===e[0].prefix){if(t.length&&"string"!=typeof t[0])throw Error("XQST0022: The namespace declaration for 'xmlns:"+e[1]+"' may not contain enclosed expressions");return["namespaceDeclaration",["prefix",e[1]],t.length?["uri",t[0]]:["uri"]]}return["attributeConstructor",["attributeName"].concat(e),0===t.length?["attributeValue"]:1===t.length&&"string"==typeof t[0]?["attributeValue",t[0]]:["attributeValueExpr"].concat(t)]})),ve=Ls.map(Ls.star(Ls.preceded(zp,Ls.optional(ye))),(function(e){return e.filter(Boolean)})),we=js(Ls.preceded(Gu,ah),ve,Ls.or([Ls.map(hu,(function(){return null})),Ls.then(Ls.preceded(Hu,Ls.star(de)),_s([Qp,du],Ls.followed(ah,Ls.then(Ls.optional(zp),Hu,(function(){return null})))),(function(e,t){return[id(e,!0,!0),t]}))]),(function(e,t,n){var r=n;if(n&&n.length){r=ad(e);var o=ad(n[1]);if(r!==o)throw Error('XQST0118: The start and the end tag of an element constructor must be equal. "'+r+'" does not match "'+o+'"');r=n[0]}return["elementConstructor",["tagName"].concat(p(e))].concat(p(t.length?[["attributeList"].concat(p(t))]:[]),p(r&&r.length?[["elementContent"].concat(p(r))]:[]))})),xe=Ls.or([we,Gh,Hh]),be=Ls.map(_s([rl,Qp],G),(function(e){return["computedDocumentConstructor"].concat(p(e?[["argExpr",e]]:[]))})),Ae=Ls.map(G,(function(e){return e?[["contentExpr",e]]:[]})),Ee=Ls.then(_s([vc,Qp],Ls.or([Ls.map(ch,(function(e){return["tagName"].concat(p(e))})),Ls.map(Ls.delimited(nu,Hs(u,Qp),ru),(function(e){return["tagNameExpr",e]}))])),Ls.preceded(Qp,Ae),(function(e,t){return["computedElementConstructor",e].concat(p(t))})),Ne=Ls.then(Ls.preceded(wc,Ls.or([Ls.map(_s([hh,Qp],ch),(function(e){return["tagName"].concat(p(e))})),Ls.map(Ls.preceded(Qp,Ls.delimited(nu,Hs(u,Qp),ru)),(function(e){return["tagNameExpr",e]}))])),Ls.preceded(Qp,G),(function(e,t){return["computedAttributeConstructor",e,["valueExpr",t||["sequenceExpr"]]]})),Te=Ls.map(G,(function(e){return e?[["prefixExpr",e]]:[]})),Be=Ls.map(G,(function(e){return e?[["URIExpr",e]]:[]})),Ie=Ls.then(_s([ol,Qp],Ls.or([eh,Te])),Ls.preceded(Qp,Be),(function(e,t){return["computedNamespaceConstructor"].concat(p(e),p(t))})),Ce=Ls.map(_s([il,Qp],G),(function(e){return["computedTextConstructor"].concat(p(e?[["argExpr",e]]:[]))})),Se=Ls.map(_s([al,Qp],G),(function(e){return["computedCommentConstructor"].concat(p(e?[["argExpr",e]]:[]))})),Oe=_s([sl,Qp],Ls.then(Ls.or([Ls.map(Zp,(function(e){return["piTarget",e]})),Ls.map(Ls.delimited(nu,Hs(u,Qp),ru),(function(e){return["piTargetExpr",e]}))]),Ls.preceded(Qp,G),(function(e,t){return["computedPIConstructor",e].concat(p(t?[["piValueExpr",t]]:[]))}))),ke=Ls.or([be,Ee,Ne,Ie,Ce,Se,Oe]),De=Ls.or([xe,ke]),Re=Ls.or([k,ph,D,Ch,U,De,ne,ae,ce,pe]),Me=Ls.map(_s([ku,Qp],le),(function(e){return"*"===e?["lookup",["star"]]:"string"==typeof e?["lookup",["NCName",e]]:["lookup",e]})),Ue=Ls.then(Ls.map(Re,(function(e){return nd(e)})),Ls.star(Ls.or([Ls.map(Ls.preceded(Qp,h),(function(e){return["predicate",e]})),Ls.map(Ls.preceded(Qp,M),(function(e){return["argumentList",e]})),Ls.preceded(Qp,Me)])),(function(e,t){function n(){s&&1===i.length?a.push(["predicate",i[0]]):0!==i.length&&a.push(["predicates"].concat(p(i))),i.length=0}function r(e){n(),0!==a.length?("sequenceExpr"===o[0][0]&&2<o[0].length&&(o=[["sequenceExpr"].concat(p(o))]),o=[["filterExpr"].concat(p(o))].concat(p(a)),a.length=0):e&&(o=[["filterExpr"].concat(p(o))])}var o=[e],i=[],a=[],s=!1;for(t=(e=c(t)).next();!t.done;t=e.next())switch(t=t.value,t[0]){case"predicate":i.push(t[1]);break;case"lookup":s=!0,n(),a.push(t);break;case"argumentList":r(!1),1<o.length&&(o=[["sequenceExpr",["pathExpr",["stepExpr"].concat(p(o))]]]),o=[["dynamicFunctionInvocationExpr",["functionItem"].concat(p(o))].concat(p(t[1].length?[["arguments"].concat(p(t[1]))]:[]))];break;default:throw Error("unreachable")}return r(!0),o})),Fe=Ls.or([Ls.map(Ue,(function(e){return["stepExpr"].concat(p(e))})),O]),Ge=Ls.followed(Re,Ls.peek(Ls.not(Ls.preceded(Qp,Ls.or([h,M,Me])),["primary expression not followed by predicate, argumentList, or lookup"]))),Le=Ls.or([js(Fe,Ls.preceded(Qp,_h),Ls.preceded(Qp,a),(function(e,t,n){return["pathExpr",e,t].concat(p(n))})),Ls.then(Fe,Ls.preceded(Hs(zu,Qp),a),(function(e,t){return["pathExpr",e].concat(p(t))})),Ge,Ls.map(Fe,(function(e){return["pathExpr",e]}))]),Pe=Ls.or([js(Fe,Ls.preceded(Qp,_h),Ls.preceded(Qp,a),(function(e,t,n){return[e,t].concat(p(n))})),Ls.then(Fe,Ls.preceded(Hs(zu,Qp),a),(function(e,t){return[e].concat(p(t))})),Ls.map(Fe,(function(e){return[e]}))]),He=Ls.or([Ls.map(_s([zu,Qp],Pe),(function(e){return["pathExpr",["rootExpr"]].concat(p(e))})),Ls.then(_h,Ls.preceded(Qp,Pe),(function(e,t){return["pathExpr",["rootExpr"],e].concat(p(t))})),Ls.map(Ls.followed(zu,Ls.not(Ls.preceded(Qp,e.Xa?$s(/[*<a-zA-Z]/):$s(/[*a-zA-Z]/)),["Single rootExpr cannot be by followed by something that can be interpreted as a relative path"])),(function(){return["pathExpr",["rootExpr"]]}))]),_e=Ps(Ls.or([Le,He]),cd),je=Ls.preceded(ll,Ls.then(Ls.optional(Ls.or([Ls.map(Ls.preceded(Qp,jh),(function(e){return["validationMode",e]})),Ls.map(_s([Qp,pl,Qp],ch),(function(e){return["type"].concat(p(e))}))])),Ls.delimited(Ls.preceded(Qp,nu),Hs(u,Qp),ru),(function(e,t){return["validateExpr"].concat(p(e?[e]:[]),[["argExpr",t]])}))),Xe=Ls.delimited(Js,Ls.then(Ls.preceded(Qp,ch),Ls.optional(Ls.preceded(Jp,Xh)),(function(e,t){return t?["pragma",["pragmaName",e],["pragmaContents",t]]:["pragma",["pragmaName",e]]})),Ls.preceded(Qp,Ws)),qe=Ls.map(Ls.followed(Ls.plus(Xe),Ls.preceded(Qp,Ls.delimited(nu,Hs(Ls.optional(u),Qp),ru))),(function(e){return["extensionExpr"].concat(p(e))})),Ve=o(n(_e,Du,(function(e,t){return 0===t.length?e:["simpleMapExpr","pathExpr"===e[0]?e:["pathExpr",["stepExpr",["filterExpr",nd(e)]]]].concat(t.map((function(e){return"pathExpr"===(e=e[1])[0]?e:["pathExpr",["stepExpr",["filterExpr",nd(e)]]]})))}))),$e=Ls.or([je,qe,Ve]),Ye=Ls.or([Ls.then(Ls.or([Vs([Yu],"unaryMinusOp"),Vs([$u],"unaryPlusOp")]),Ls.preceded(Qp,(function(e,t){return Ye(e,t)})),(function(e,t){return[e,["operand",t]]})),$e]),ze=Ls.or([Ls.map(ch,(function(e){return["EQName"].concat(p(e))})),ph,D]),Qe=Ls.then(Ye,Ls.star(_s([Qp,Ju,Qp],Ls.then(ze,Ls.preceded(Qp,M),(function(e,t){return[e,t]})))),(function(e,t){return t.reduce((function(e,t){return["arrowExpr",["argExpr",e],t[0],["arguments"].concat(p(t[1]))]}),e)})),Je=Ls.then(Qe,Ls.optional(_s([Qp,sc,Jp,ac,hh,Qp],sd)),(function(e,t){return null!==t?["castExpr",["argExpr",e],t]:e})),We=Ls.then(Je,Ls.optional(_s([Qp,uc,Jp,ac,hh,Qp],sd)),(function(e,t){return null!==t?["castableExpr",["argExpr",e],t]:e})),Ke=Ls.then(We,Ls.optional(_s([Qp,cc,Jp,ac,hh,Qp],P)),(function(e,t){return null!==t?["treatExpr",["argExpr",e],["sequenceType"].concat(p(t))]:e})),Ze=Ls.then(Ke,Ls.optional(_s([Qp,lc,Jp,pc,hh,Qp],P)),(function(e,t){return null!==t?["instanceOfExpr",["argExpr",e],["sequenceType"].concat(p(t))]:e})),et=n(Ze,Ls.followed(Ls.or([Vs([bc],"intersectOp"),Vs([Ac],"exceptOp")]),hh),t),tt=n(et,Ls.or([Vs([Ru],"unionOp"),Ls.followed(Vs([Ec],"unionOp"),hh)]),t),nt=n(tt,Ls.or([Vs([Bu],"multiplyOp"),Ls.followed(Vs([Cc],"divOp"),hh),Ls.followed(Vs([Sc],"idivOp"),hh),Ls.followed(Vs([Oc],"modOp"),hh)]),t),rt=n(nt,Ls.or([Vs([Yu],"subtractOp"),Vs([$u],"addOp")]),t),ot=n(r(rt,Ls.followed(Vs([Nc],"rangeSequenceExpr"),hh),"startExpr","endExpr"),Vs([Mu],"stringConcatenateOp"),t),it=n(r(ot,Ls.or([qh,Vh,$h])),Ls.followed(Vs([Ic],"andOp"),hh),t),at=n(it,Ls.followed(Vs([Bc],"orOp"),hh),t),st=Ls.then(Ls.then(_s([Hc,Qp,Ks,Qp],u),_s([Qp,Zs,Qp,_c,hh,Qp],s),(function(e,t){return[e,t]})),_s([Qp,jc,hh,Qp],s),(function(e,t){return["ifThenElseExpr",["ifClause",e[0]],["thenClause",e[1]],["elseClause",t]]})),ut=Ls.delimited(Xc,Jp,qc),ct=Ls.map(_s([Vc,Jp,Cu],ch),(function(e){return["positionalVariableBinding"].concat(p(e))})),lt=function(e,t,n,r,o,i){return Ls.then(Ls.then(Ls.then(Ls.then(e,t,(function(e,t){return[e,t]})),n,(function(e,t){var n=c(e);return[e=n.next().value,n=n.next().value,t]})),r,(function(e,t){var n=c(e);return[e=n.next().value,n.next().value,n=n.next().value,t]})),o,(function(e,t){var n=c(e);e=n.next().value;var r=n.next().value,o=n.next().value;return n=n.next().value,i(e,r,o,n,t)}))}(Ls.preceded(Cu,ch),Ls.preceded(Qp,Ls.optional(K)),Ls.preceded(Qp,Ls.optional(ut)),Ls.preceded(Qp,Ls.optional(ct)),Ls.preceded(Hs($c,Qp),s),(function(e,t,n,r,o){return["forClauseItem",["typedVariableBinding",["varName"].concat(p(e),p(t?[t]:[]))]].concat(p(n?[["allowingEmpty"]]:[]),p(r?[r]:[]),[["forExpr",o]])})),pt=_s([Yc,Jp],n(lt,Xu,(function(e,t){return["forClause",e].concat(p(t.map((function(e){return e[1]}))))}))),ht=js(Ls.preceded(Cu,ch),Ls.preceded(Qp,Ls.optional(K)),Ls.preceded(Hs(Au,Qp),s),(function(e,t,n){return["letClauseItem",["typedVariableBinding",["varName"].concat(p(e))].concat(p(t?[t]:[])),["letExpr",n]]})),dt=Ls.map(_s([zc,Qp],n(ht,Xu,(function(e,t){return[e].concat(p(t.map((function(e){return e[1]}))))}))),(function(e){return["letClause"].concat(p(e))})),ft=Ls.or([pt,dt]),mt=Ls.map(_s([Qc,hh,Qp],s),(function(e){return["whereClause",e]})),gt=Ls.map(Ls.preceded(Cu,ch),(function(e){return["varName"].concat(p(e))})),yt=Ls.then(Ls.preceded(Qp,Ls.optional(K)),Ls.preceded(Hs(Au,Qp),s),(function(e,t){return["groupVarInitialize"].concat(p(e?[["typeDeclaration"].concat(p(e))]:[]),[["varValue",t]])})),vt=js(gt,Ls.optional(yt),Ls.optional(Ls.map(Ls.preceded(Hs(Jc,Qp),d),(function(e){return["collation",e]}))),(function(e,t,n){return["groupingSpec",e].concat(p(t?[t]:[]),p(n?[n]:[]))})),wt=n(vt,Xu,(function(e,t){return[e].concat(p(t.map((function(e){return e[1]}))))})),xt=Ls.map(_s([Wc,Jp,Kc,Qp],wt),(function(e){return["groupByClause"].concat(p(e))})),bt=js(Ls.optional(Ls.or([sp,up])),Ls.optional(_s([Qp,qc,Qp],Ls.or([xl,bl].map((function(e){return Ls.map(e,(function(e){return"empty "+e}))}))))),Ls.preceded(Qp,Ls.optional(_s([Jc,Qp],d))),(function(e,t,n){return e||t||n?["orderModifier"].concat(p(e?[["orderingKind",e]]:[]),p(t?[["emptyOrderingMode",t]]:[]),p(n?[["collation",n]]:[])):null})),At=Ls.then(s,Ls.preceded(Qp,bt),(function(e,t){return["orderBySpec",["orderByExpr",e]].concat(p(t?[t]:[]))})),Et=n(At,Xu,(function(e,t){return[e].concat(p(t.map((function(e){return e[1]}))))})),Nt=Ls.then(Ls.or([Ls.map(_s([Zc,Jp],Kc),(function(){return!1})),Ls.map(_s([el,Jp,Zc,Jp],Kc),(function(){return!0}))]),Ls.preceded(Qp,Et),(function(e,t){return["orderByClause"].concat(p(e?[["stable"]]:[]),p(t))})),Tt=Ls.or([ft,mt,xt,Nt]),Bt=Ls.map(_s([tl,Qp],s),(function(e){return["returnClause",e]})),It=js(ft,Ls.star(Ls.preceded(Qp,Tt)),Ls.preceded(Qp,Bt),(function(e,t,n){return["flworExpr",e].concat(p(t),[n])})),Ct=n(P,Ru,(function(e,t){return 0===t.length?["sequenceType"].concat(p(e)):["sequenceTypeUnion",["sequenceType"].concat(p(e))].concat(p(t.map((function(e){return["sequenceType"].concat(p(e[1]))}))))})),St=js(_s([Nl,Qp],Ls.optional(Ls.preceded(Cu,Ls.followed(Ls.followed(ch,Jp),ac)))),Ls.preceded(Qp,Ct),_s([Jp,tl,Jp],s),(function(e,t,n){return["typeswitchExprCaseClause"].concat(e?[["variableBinding"].concat(p(e))]:[],[t],[["resultExpr",n]])})),Ot=Xs(Ls.preceded(Tl,Hs(Ls.delimited(Ks,Hs(u,Qp),Zs),Qp)),Ls.plus(Ls.followed(St,Qp)),_s([dl,Jp],Ls.optional(Ls.preceded(Cu,Ls.followed(ch,Jp)))),_s([tl,Jp],s),(function(e,t,n,r){return["typeswitchExpr",["argExpr",e]].concat(p(t),[["typeswitchExprDefaultClause"].concat(p(n||[]),[["resultExpr",r]])])})),kt=js(Ls.preceded(Cu,ch),Ls.optional(Ls.preceded(Jp,K)),Ls.preceded(Hs($c,Jp),s),(function(e,t,n){return["quantifiedExprInClause",["typedVariableBinding",["varName"].concat(p(e))].concat(p(t?[t]:[])),["sourceExpr",n]]})),Dt=n(kt,Xu,(function(e,t){return[e].concat(p(t.map((function(e){return e[1]}))))})),Rt=js(Ls.or([Bl,Il]),Ls.preceded(Jp,Dt),Ls.preceded(Hs(Cl,Qp),s),(function(e,t,n){return["quantifiedExpr",["quantifier",e]].concat(p(t),[["predicateExpr",n]])})),Mt=Ls.map(_s([fc,Jp,Ls.or([dc,hc]),Jp],s),(function(e){return["deleteExpr",["targetExpr",e]]})),Ut=js(_s([Sl,Jp],Ls.optional(_s([mc,Jp,pc],Jp))),_s([hc,Jp],s),Ls.preceded(Hs(Ol,Jp),s),(function(e,t,n){return e?["replaceExpr",["replaceValue"],["targetExpr",t],["replacementExpr",n]]:["replaceExpr",["targetExpr",t],["replacementExpr",n]]})),Ft=Ls.then(ph,Ls.preceded(Hs(Au,Qp),s),(function(e,t){return["transformCopy",e,["copySource",t]]})),Gt=js(_s([kl,Jp],n(Ft,Xu,(function(e,t){return[e].concat(p(t.map((function(e){return e[1]}))))}))),_s([Qp,Dl,Jp],s),Ls.preceded(Hs(tl,Jp),s),(function(e,t,n){return["transformExpr",["transformCopies"].concat(p(e)),["modifyExpr",t],["returnExpr",n]]})),Lt=Ls.or([Ls.followed(Ls.map(Ls.optional(Ls.followed(_s([ac,Jp],Ls.or([Ls.map(Rl,(function(){return["insertAsFirst"]})),Ls.map(Ml,(function(){return["insertAsLast"]}))])),Jp)),(function(e){return e?["insertInto",e]:["insertInto"]})),Gl),Ls.map(Fl,(function(){return["insertAfter"]})),Ls.map(Ul,(function(){return["insertBefore"]}))]),Pt=js(_s([Ll,Jp,Ls.or([dc,hc]),Jp],s),Ls.preceded(Jp,Lt),Ls.preceded(Jp,s),(function(e,t,n){return["insertExpr",["sourceExpr",e],t,["targetExpr",n]]})),Ht=Ls.then(_s([Pl,Jp,hc,Qp],s),_s([Jp,ac,Jp],s),(function(e,t){return["renameExpr",["targetExpr",e],["newNameExpr",t]]})),_t=Ls.then(Ls.plus(Ls.map(_s([Nl,Jp],s),(function(e){return["switchCaseExpr",e]}))),_s([Jp,tl,Jp],s),(function(e,t){return["switchExprCaseClause"].concat(p(e),[["resultExpr",t]])})),jt=js(_s([Hl,Qp,Ks],u),_s([Qp,Zs,Qp],Ls.plus(Ls.followed(_t,Qp))),_s([dl,Jp,tl,Jp],s),(function(e,t,n){return["switchExpr",["argExpr",e]].concat(p(t),[["switchExprDefaultClause",["resultExpr",n]]])})),Xt=Ls.map(u,(function(e){return["queryBody",e]})),qt=_s([hl,Jp,ol,Jp],Ls.then(Zp,Ls.preceded(Hs(Uu,Qp),d),(function(e,t){return["namespaceDecl",["prefix",e],["uri",t]]}))),Vt=Ls.then(_s([_l,Jp,Cu,Qp],Ls.then(ch,Ls.optional(Ls.preceded(Qp,K)),(function(e,t){return[e,t]}))),Ls.or([Ls.map(_s([Qp,Au,Qp],s),(function(e){return["varValue",e]})),Ls.map(_s([Jp,jl],Ls.optional(_s([Qp,Au,Qp],s))),(function(e){return["external"].concat(p(e?[["varValue",e]]:[]))}))]),(function(e,t){var n=c(e);return e=n.next().value,n=n.next().value,["varDecl",["varName"].concat(p(e))].concat(p(null!==n?[n]:[]),[t])})),$t=Xs(_s([gc,Jp,Ls.peek(Ls.not(Sh,["Cannot use reserved function name"]))],ch),_s([Qp,Ks,Qp],Ls.optional(ee)),_s([Qp,Zs],Ls.optional(_s([Jp,ac,Jp],P))),Ls.preceded(Qp,Ls.or([Ls.map(L,(function(e){return["functionBody",e]})),Ls.map(jl,(function(){return["externalDefinition"]}))])),(function(e,t,n,r){return["functionDecl",["functionName"].concat(p(e)),["paramList"].concat(p(t||[]))].concat(p(n?[["typeDeclaration"].concat(p(n))]:[]),[r])})),Yt=_s([hl,Jp],Ls.then(Ls.star(Ls.followed(Ls.or([H,Yh]),Jp)),Ls.or([Vt,$t]),(function(e,t){return[t[0]].concat(p(e),p(t.slice(1)))}))),zt=Ls.then(_s([hl,Jp,dl,Jp],Ls.or([vc,gc])),_s([Jp,ol,Jp],d),(function(e,t){return["defaultNamespaceDecl",["defaultNamespaceCategory",e],["uri",t]]})),Qt=Ls.or([Ls.map(Ls.followed(_s([ol,Jp],Zp),Ls.preceded(Qp,Uu)),(function(e){return["namespacePrefix",e]})),Ls.map(_s([dl,Jp,vc,Jp],ol),(function(){return["defaultElementNamespace"]}))]),Jt=_s([ql,Jp,Vl],js(Ls.optional(Ls.preceded(Jp,Qt)),Ls.preceded(Qp,d),Ls.optional(Ls.then(_s([Jp,Vc,Jp],d),Ls.star(_s([Qp,Xu,Qp],d)),(function(e,t){return[e].concat(p(t))}))),(function(e,t,n){return["schemaImport"].concat(p(e?[e]:[]),[["targetNamespace",t]],p(n?[n]:[]))}))),Wt=_s([ql,Jp,$l],js(Ls.optional(Ls.followed(_s([Jp,ol,Jp],Zp),Ls.preceded(Qp,Uu))),Ls.preceded(Qp,d),Ls.optional(Ls.then(_s([Jp,Vc,Jp],d),Ls.star(_s([Qp,Xu,Qp],d)),(function(e,t){return[e].concat(p(t))}))),(function(e,t){return["moduleImport",["namespacePrefix",e],["targetNamespace",t]]}))),Kt=Ls.or([Jt,Wt]),Zt=Ls.map(_s([hl,Jp,dl,Jp,Jc,Jp],d),(function(e){return["defaultCollationDecl",e]})),en=Ls.map(_s([hl,Jp,Yl,Jp],d),(function(e){return["baseUriDecl",e]})),tn=Ls.then(_s([hl,Jp],Ls.or([Ls.map(_s([El,Jp],ch),(function(e){return["decimalFormatName"].concat(p(e))})),Ls.map(_s([dl,Jp],El),(function(){return null}))])),Ls.star(Ls.then(Ls.preceded(Jp,Jh),Ls.preceded(Hs(Uu,Jp),d),(function(e,t){return["decimalFormatParam",["decimalFormatParamName",e],["decimalFormatParamValue",t]]}))),(function(e,t){return["decimalFormatDecl"].concat(p(e?[e]:[]),p(t))})),nn=Ls.or([Wh,Zt,en,Kh,Zh,ed,td,tn]),rn=Ls.then(_s([hl,Jp,Kl,Jp],ch),Ls.preceded(Jp,d),(function(e,t){return["optionDecl",["optionName",e],["optionContents",t]]})),on=Ls.then(_s([hl,Jp,Zl,Jp,ep],Ls.optional(_s([Jp,ac],W))),Ls.or([Ls.map(Ls.preceded(Hs(Au,Qp),s),(function(e){return["varValue",e]})),Ls.map(_s([Jp,jl],Ls.optional(Ls.preceded(Hs(Au,Qp),s))),(function(){return["external"]}))]),(function(e,t){return["contextItemDecl"].concat(p(e?[["contextItemType",e]]:[]),[t])})),an=Ls.then(Ls.star(Ls.followed(Ls.or([zt,nn,qt,Kt]),Hs(Tu,Qp))),Ls.star(Ls.followed(Ls.or([on,Yt,rn]),Hs(Tu,Qp))),(function(e,t){return 0===e.length&&0===t.length?null:["prolog"].concat(p(e),p(t))})),sn=_s([$l,Jp,ol,Jp],Ls.then(Ls.followed(Zp,Hs(Uu,Qp)),Ls.followed(d,Hs(Tu,Qp)),(function(e,t){return["moduleDecl",["prefix",e],["uri",t]]}))),un=Ls.then(sn,Ls.preceded(Qp,an),(function(e,t){return["libraryModule",e].concat(p(t?[t]:[]))})),cn=Ls.then(an,Ls.preceded(Qp,Xt),(function(e,t){return["mainModule"].concat(p(e?[e]:[]),[t])})),ln=Ls.map(_s([tp,Qp],Ls.followed(Ls.or([Ls.then(Ls.preceded(rp,Jp),d,(function(e){return["encoding",e]})),Ls.then(_s([np,Jp],d),Ls.optional(_s([Jp,rp,Jp],d)),(function(e,t){return[["version",e]].concat(p(t?[["encoding",t]]:[]))}))]),Ls.preceded(Qp,Tu))),(function(e){return["versionDecl"].concat(p(e))})),pn=Ls.then(Ls.optional(Hs(ln,Qp)),Ls.or([un,cn]),(function(e,t){return["module"].concat(p(e?[e]:[]),[t])})),hn=Ls.complete(Hs(pn,Qp));return function(e,t){l.clear(),t=hn(e,t);for(var n=1,r=1,o=0;o<e.length+1;o++){if(l.has(o)){var i=l.get(o);i.line=r,i.la=n}"\r"===(i=e[o])||"\n"===i?(r++,n=1):n++}return t}}var pd=ld({ub:!1,Xa:!1}),hd=ld({ub:!0,Xa:!1}),dd=ld({ub:!1,Xa:!0}),fd=ld({ub:!0,Xa:!0});function md(e,t){var n=!!t.aa;if(t=!!t.debug,jp.clear(),Xp.clear(),cd.clear(),!0===(n=n?t?fd(e,0):dd(e,0):t?hd(e,0):pd(e,0)).success)return n.value;throw Error("XPST0003: Failed to parse '"+e+"' expected: "+n.expected+"\n"+e.slice(0,n.offset)+"[Error is around here]"+e.slice(n.offset))}var gd="http://www.w3.org/XML/1998/namespace http://www.w3.org/2001/XMLSchema http://www.w3.org/2001/XMLSchema-instance http://www.w3.org/2005/xpath-functions http://www.w3.org/2005/xpath-functions/math http://www.w3.org/2012/xquery http://www.w3.org/2005/xpath-functions/array http://www.w3.org/2005/xpath-functions/map".split(" ");function yd(e,t,n){n=void 0===n||n;var r=[],o=[];Fo(e,"*").forEach((function(e){switch(e[0]){case"moduleImport":case"namespaceDecl":case"defaultNamespaceDecl":case"functionDecl":case"varDecl":break;default:throw Error("Not implemented: only module imports, namespace declarations, and function declarations are implemented in XQuery modules")}}));var i=new Set;Fo(e,"moduleImport").forEach((function(e){var n=Ro(Do(e,"namespacePrefix"));if(e=Ro(Do(e,"targetNamespace")),i.has(e))throw Error('XQST0047: The namespace "'+e+'" is imported more than once.');i.add(e),Co(t,n,e),Fs(t,e)})),Fo(e,"namespaceDecl").forEach((function(e){var n=Ro(Do(e,"prefix"));if(e=Ro(Do(e,"uri")),"xml"===n||"xmlns"===n)throw wo();if("http://www.w3.org/XML/1998/namespace"===e||"http://www.w3.org/2000/xmlns/"===e)throw wo();Co(t,n,e)}));for(var a=null,s=null,u=c(Fo(e,"defaultNamespaceDecl")),l=u.next();!l.done;l=u.next()){var h=l.value;if(l=Ro(Do(h,"defaultNamespaceCategory")),!(h=Ro(Do(h,"uri"))))throw yo();if("http://www.w3.org/XML/1998/namespace"===h||"http://www.w3.org/2000/xmlns/"===h)throw wo();if("function"===l){if(a)throw vo();a=h}else if("element"===l){if(s)throw vo();s=h}}a&&(t.A=a),s&&Co(t,"",s),Fo(e,"functionDecl").forEach((function(e){!function(e,t,n,r,o){var i=Do(e,"functionName"),a=Mo(i,"prefix")||"",s=Mo(i,"URI"),u=Ro(i);if(null===s&&!(s=""===a?null===t.A?"http://www.w3.org/2005/xpath-functions":t.A:t.ba(a))&&a)throw bo(a);if(gd.includes(s))throw go();if(a=Fo(e,"annotation").map((function(e){return Do(e,"annotationName")})),i=a.every((function(e){return!Mo(e,"URI")&&"private"!==Ro(e)})),a=a.some((function(e){return!Mo(e,"URI")&&"updating"===Ro(e)})),!s)throw yo();var c=Lo(e),l=Fo(Do(e,"paramList"),"param"),h=l.map((function(e){return Do(e,"varName")})),d=l.map((function(e){return Lo(e)}));if(e=Do(e,"functionBody")){if(t.Ba(s,u,d.length))throw Error("XQST0049: The function Q{"+s+"}"+u+"#"+d.length+" has already been declared.");if(!o)return;var f=Ss(e[1],{sa:!1,aa:!0}),m=new No(t),g=h.map((function(e){var n=Mo(e,"URI"),r=Mo(e,"prefix");return e=Ro(e),r&&null===n&&(n=t.ba(r||"")),So(m,n,e)}));o=a?{l:d,arity:h.length,m:function(e,t,n,r){for(var o=[],i=3;i<arguments.length;++i)o[i-3]=arguments[i];return i=Tt(Nt(e,-1,null,ge.empty()),g.reduce((function(e,t,n){return e[t]=ye(o[n]),e}),Object.create(null))),f.u(i,t)},Db:!1,I:!0,localName:u,namespaceURI:s,i:c}:{l:d,arity:h.length,m:function(e,t,n,r){for(var o=[],i=3;i<arguments.length;++i)o[i-3]=arguments[i];return i=Tt(Nt(e,-1,null,ge.empty()),g.reduce((function(e,t,n){return e[t]=ye(o[n]),e}),Object.create(null))),hr(f,i,t)},Db:!1,I:!1,localName:u,namespaceURI:s,i:c},n.push({da:f,Kb:m}),i&&r.push({arity:h.length,da:f,Gb:o,localName:u,namespaceURI:s})}else{if(a)throw Error("Updating external function declarations are not supported");o={l:d,arity:h.length,m:function(e,t,n,r){for(var o=[],i=3;i<arguments.length;++i)o[i-3]=arguments[i];if(!(i=n.Ba(s,u,h.length,!0)))throw Error("XPST0017: Function Q{"+s+"}"+u+" with arity of "+h.length+" not registered. "+so(u));if(i.i.type!==c.type||i.l.some((function(e,t){return e.type!==d[t].type})))throw Error("External function declaration types do not match actual function");return i.m.apply(i,[e,t,n].concat(p(o)))},Db:!0,I:!1,localName:u,namespaceURI:s,i:c}}Io(t,s,u,h.length,o)}(e,t,r,o,n)}));var d=[];return Fo(e,"varDecl").forEach((function(e){var o=Go(Do(e,"varName")),i=o.namespaceURI;if(null===i&&(!(i=t.ba(o.prefix))&&o.prefix))throw bo(o.prefix);if(gd.includes(i))throw go();var a,s,u=Do(e,"external");if(e=Do(e,"varValue"),null!==u?null!==(u=Do(u,"varValue"))&&(a=Do(u,"*")):null!==e&&(a=Do(e,"*")),d.some((function(e){return e.namespaceURI===i&&e.localName===o.localName})))throw Error("XQST0049: The variable "+(i?"Q{"+i+"}":"")+o.localName+" has already been declared.");if(So(t,i||"",o.localName),n&&(a&&(s=Ss(a,{sa:!1,aa:!0})),a&&!function(e,t,n){return(e=e.Fa[Ao(t,n)])?e:null}(t,i||"",o.localName))){var c=null;Oo(t,i,o.localName,(function(e,t){return c?c():(c=ye(hr(s,e,t)))()})),r.push({da:s,Kb:t}),d.push({da:s,localName:o.localName,namespaceURI:i})}})),r.forEach((function(e){e.da.P(e.Kb)})),o.forEach((function(e){if(!e.Gb.I&&e.da.I)throw er("The function Q{"+e.namespaceURI+"}"+e.localName+" is updating but the %updating annotation is missing.")})),{Oa:o,Wa:d}}function vd(e,t,n,r,o,i,a){var s=t.aa?"XQuery":"XPath";return n=t.Ja?null:function(e,t,n,r,o,i,a,s){return(e=Os.get(e))&&(t=e[t+(i?"_DEBUG":"")])&&(t=t.find((function(e){return e.s===a&&e.j.every((function(e){return n(e.prefix)===e.namespaceURI}))&&e.u.every((function(e){return void 0!==r[e.name]}))&&e.A.every((function(e){return o[e.prefix]===e.namespaceURI}))&&e.O.every((function(e){var t=s(e.Dc,e.arity);return t&&t.namespaceURI===e.Jb.namespaceURI&&t.localName===e.Jb.localName}))})))?{da:t.h,Hc:!1}:null}(e,s,n,r,o,t.debug,i,a),null!==n?{state:n.Hc?1:2,da:n.da}:{state:0,yc:"string"==typeof e?md(e,t):Rs(e)}}function wd(e,t,n,r,o,i,a){var s=new po(n,r,i,a),u=new No(s);switch(Object.keys(o).forEach((function(e){var t=o[e];Fs(u,t),Co(u,e,t)})),"string"==typeof e&&(e=Gs(e)),(n=vd(e,t,n,r,o,i,a)).state){case 2:return{ia:u,da:n.da};case 1:return n.da.P(u),Ds(e,t.aa?"XQuery":"XPath",s,o,n.da,t.debug,i),{ia:u,da:n.da};case 0:return n=function(e,t,n){var r=Do(e,"mainModule");if(!r)throw Error("Can not execute a library module.");var o=Do(r,"prolog");if(o){if(!t.aa)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");yd(o,n)}return ti(e,new ci(n)),Ns(e=Uo(r,["queryBody","*"]),t)}(n.yc,t,u),n.P(u),t.Ja||Ds(e,t.aa?"XQuery":"XPath",s,o,n,t.debug,i),{ia:u,da:n}}}function xd(e,t,n){if(1!==t.node.nodeType&&9!==t.node.nodeType)return[];var r=De(e,t).reduce((function(t,r){for(var o=(r=c(xd(e,r,n))).next();!o.done;o=r.next())t.push(o.value);return t}),[]);return n(t)&&r.unshift(t),r}function bd(e,t,n,r,o){if(!(e=o.first()))throw Error("XPDY0002: The context is absent, it needs to be present to use id function.");if(!ee(e.type,53))throw St("The context item is not a node, it needs to be node to use id function.");var i=t.h,a=r.N().reduce((function(e,t){return t.value.split(/\s+/).forEach((function(t){e[t]=!0})),e}),Object.create(null));for(t=e.value;9!==t.node.nodeType;)if(null===(t=Ge(i,t)))throw Error("FODC0001: the root node of the target node is not a document node.");return t=xd(i,t,(function(e){return 1===e.node.nodeType&&(!(!(e=ke(i,e,"id"))||!a[e])&&(a[e]=!1,!0))})),ge.create(t.map((function(e){return je(e)})))}function Ad(e,t,n,r,o){if(!(e=o.first()))throw Error("XPDY0002: The context is absent, it needs to be present to use idref function.");if(!ee(e.type,53))throw St("The context item is not a node, it needs to be node to use idref function.");var i=t.h,a=r.N().reduce((function(e,t){return e[t.value]=!0,e}),Object.create(null));for(t=e.value;9!==t.node.nodeType;)if(null===(t=Ge(i,t)))throw Error("FODC0001: the root node of the context node is not a document node.");return t=xd(i,t,(function(e){return 1===e.node.nodeType&&(!!(e=ke(i,e,"idref"))&&e.split(/\s+/).some((function(e){return a[e]})))})),ge.create(t.map((function(e){return je(e)})))}function Ed(e){switch(typeof e){case"object":return Array.isArray(e)?ge.o(new He(e.map((function(e){return ye(Ed(e))})))):null===e?ge.empty():ge.o(new $e(Object.keys(e).map((function(t){return{key:$(t,1),value:ye(Ed(e[t]))}}))));case"number":return ge.o($(e,3));case"string":return ge.o($(e,1));case"boolean":return e?ge.ca():ge.X();default:throw Error("Unexpected type in JSON parse")}}function Nd(e,t,n,r,o){var i=(e=Ve(0,0,0,o,ge.o($("duplicates",1)))).G()?"use-first":e.first().value;return r.L((function(e){return ge.o(new $e(e.reduce((function(e,t){return t.h.forEach((function(t){var n=e.findIndex((function(e){return qe(e.key,t.key)}));if(0<=n)switch(i){case"reject":throw Error("FOJS0003: Duplicate encountered when merging maps.");case"use-last":return void e.splice(n,1,t);case"combine":return void e.splice(n,1,{key:t.key,value:ye(ge.create(e[n].value().N().concat(t.value().N())))});default:return}e.push(t)})),e}),[])))}))}function Td(e,t,n){var r=1,o=e.value;e=e.Pa(!0);var i=null,a=Math.max(t-1,0);return-1!==e&&(i=Math.max(0,(null===n?e:Math.max(0,Math.min(e,n+(t-1))))-a)),ge.create({next:function(e){for(;r<t;)o.next(e),r++;return null!==n&&r>=t+n?W:(e=o.next(e),r++,e)}},i)}function Bd(e){return e.map((function(e){return ee(e.type,19)?Wt(e,3):e}))}function Id(e){if((e=Bd(e)).some((function(e){return Number.isNaN(e.value)})))return[$(NaN,3)];if(!(e=ya(e)))throw Error("FORG0006: Incompatible types to be converted to a common type");return e}function Cd(e,t,n,r,o,i){return Xe([o,i],(function(e){var t=c(e);if(e=t.next().value,t=t.next().value,1/0===e.value)return ge.empty();if(-1/0===e.value)return t&&1/0===t.value?ge.empty():r;if(t){if(isNaN(t.value))return ge.empty();1/0===t.value&&(t=null)}return isNaN(e.value)?ge.empty():Td(r,Math.round(e.value),t?Math.round(t.value):null)}))}function Sd(e,t,n,r,o){if(r.G())return o;if(!(e=ya(e=Bd(r.N()))))throw Error("FORG0006: Incompatible types to be converted to a common type");if(!e.every((function(e){return ee(e.type,2)})))throw Error("FORG0006: items passed to fn:sum are not all numeric.");return t=e.reduce((function(e,t){return e+t.value}),0),e.every((function(e){return ee(e.type,5)}))?ge.o($(t,5)):e.every((function(e){return ee(e.type,3)}))?ge.o($(t,3)):e.every((function(e){return ee(e.type,4)}))?ge.o($(t,4)):ge.o($(t,6))}var Od=[].concat(Lr,[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"boolean",l:[{type:59,g:2}],i:{type:0,g:3},m:function(e,t,n,r){return r.getEffectiveBooleanValue()?ge.ca():ge.X()}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"true",l:[],i:{type:0,g:3},m:function(){return ge.ca()}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"not",l:[{type:59,g:2}],i:{type:0,g:3},m:function(e,t,n,r){return!1===r.getEffectiveBooleanValue()?ge.ca():ge.X()}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"false",l:[],i:{type:0,g:3},m:function(){return ge.X()}}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"last",l:[],i:{type:5,g:3},m:function(e){if(null===e.M)throw Error("XPDY0002: The fn:last() function depends on dynamic context, which is absent.");var t=!1;return ge.create({next:function(){if(t)return W;var n=e.Ia.Pa();return t=!0,K($(n,5))}},1)}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"position",l:[],i:{type:5,g:3},m:function(e){if(null===e.M)throw Error("XPDY0002: The fn:position() function depends on dynamic context, which is absent.");return ge.o($(e.La+1,5))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"current-dateTime",l:[],i:{type:10,g:3},m:function(e){return ge.o($(At(e),10))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"current-date",l:[],i:{type:7,g:3},m:function(e){return ge.o($(ut(At(e),7),7))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"current-time",l:[],i:{type:8,g:3},m:function(e){return ge.o($(ut(At(e),8),8))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"implicit-timezone",l:[],i:{type:17,g:3},m:function(e){return ge.o($(Et(e),17))}}],Hr,zr,Zr,[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"years-from-duration",l:[{type:18,g:0}],i:{type:5,g:0},m:function(e,t,n,r){return r.G()?r:ge.o($(r.first().value.fb(),5))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"months-from-duration",l:[{type:18,g:0}],i:{type:5,g:0},m:function(e,t,n,r){return r.G()?r:ge.o($(r.first().value.bb(),5))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"days-from-duration",l:[{type:18,g:0}],i:{type:5,g:0},m:function(e,t,n,r){return r.G()?r:ge.o($(r.first().value.ab(),5))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"hours-from-duration",l:[{type:18,g:0}],i:{type:5,g:0},m:function(e,t,n,r){return r.G()?r:ge.o($(r.first().value.getHours(),5))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"minutes-from-duration",l:[{type:18,g:0}],i:{type:5,g:0},m:function(e,t,n,r){return r.G()?r:ge.o($(r.first().value.getMinutes(),5))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"seconds-from-duration",l:[{type:18,g:0}],i:{type:4,g:0},m:function(e,t,n,r){return r.G()?r:ge.o($(r.first().value.getSeconds(),4))}}],to,[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"id",l:[{type:1,g:2},{type:53,g:3}],i:{type:54,g:2},m:bd},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"id",l:[{type:1,g:2}],i:{type:54,g:2},m:function(e,t,n,r){return bd(e,t,0,r,ge.o(e.M))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"idref",l:[{type:1,g:2},{type:53,g:3}],i:{type:53,g:2},m:Ad},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"idref",l:[{type:1,g:2}],i:{type:53,g:2},m:function(e,t,n,r){return Ad(e,t,0,r,ge.o(e.M))}}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"parse-json",l:[{type:1,g:3}],i:{type:59,g:0},m:function(e,t,n,r){try{var o=JSON.parse(r.first().value)}catch(e){throw Error("FOJS0001: parsed JSON string contains illegal JSON.")}return Ed(o)}}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"contains",l:[{type:61,g:3},{type:46,g:3}],i:{type:0,g:3},m:function(e,t,n,r,o){return Xe([r,o],(function(e){var t=(e=c(e)).next().value,n=e.next().value;return t.h.some((function(e){return qe(e.key,n)}))?ge.ca():ge.X()}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"entry",l:[{type:46,g:3},{type:59,g:2}],i:{type:61,g:3},m:function(e,t,n,r,o){return r.map((function(e){return new $e([{key:e,value:ye(o)}])}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"for-each",l:[{type:61,g:3},{type:59,g:2}],i:{type:59,g:2},m:function(e,t,n,r,o){return Xe([r,o],(function(r){var o=(r=c(r)).next().value,i=r.next().value;return It(o.h.map((function(r){return i.value.call(void 0,e,t,n,ge.o(r.key),r.value())})))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"get",l:[{type:61,g:3},{type:46,g:3}],i:{type:59,g:2},m:Ve},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"keys",l:[{type:61,g:3}],i:{type:46,g:2},m:function(e,t,n,r){return Xe([r],(function(e){return e=c(e).next().value,ge.create(e.h.map((function(e){return e.key})))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"merge",l:[{type:61,g:2},{type:61,g:3}],i:{type:61,g:3},m:Nd},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"merge",l:[{type:61,g:2}],i:{type:61,g:3},m:function(e,t,n,r){return Nd(e,0,0,r,ge.o(new $e([{key:$("duplicates",1),value:function(){return ge.o($("use-first",1))}}])))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"put",l:[{type:61,g:3},{type:46,g:3},{type:59,g:2}],i:{type:61,g:3},m:function(e,t,n,r,o,i){return Xe([r,o],(function(e){var t=(e=c(e)).next().value,n=e.next().value;return e=t.h.concat(),t=e.findIndex((function(e){return qe(e.key,n)})),0<=t?e.splice(t,1,{key:n,value:ye(i)}):e.push({key:n,value:ye(i)}),ge.o(new $e(e))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"remove",l:[{type:61,g:3},{type:46,g:2}],i:{type:61,g:3},m:function(e,t,n,r,o){return Xe([r],(function(e){var t=c(e).next().value.h.concat();return o.L((function(e){return e.forEach((function(e){var n=t.findIndex((function(t){return qe(t.key,e)}));0<=n&&t.splice(n,1)})),ge.o(new $e(t))}))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"size",l:[{type:61,g:3}],i:{type:5,g:3},m:function(e,t,n,r){return r.map((function(e){return $(e.h.length,5)}))}}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"pi",l:[],i:{type:3,g:3},m:function(){return ge.o($(Math.PI,3))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"exp",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.pow(Math.E,e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"exp10",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.pow(10,e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"log",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.log(e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"log10",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.log10(e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"pow",l:[{type:3,g:0},{type:2,g:3}],i:{type:3,g:0},m:function(e,t,n,r,o){return o.L((function(e){var t=c(e).next().value;return r.map((function(e){return 1!==Math.abs(e.value)||Number.isFinite(t.value)?$(Math.pow(e.value,t.value),3):$(1,3)}))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"sqrt",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.sqrt(e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"sin",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.sin(e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"cos",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.cos(e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"tan",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.tan(e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"asin",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.asin(e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"acos",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.acos(e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"atan",l:[{type:3,g:0}],i:{type:3,g:0},m:function(e,t,n,r){return r.map((function(e){return $(Math.atan(e.value),3)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"atan2",l:[{type:3,g:0},{type:3,g:3}],i:{type:3,g:0},m:function(e,t,n,r,o){return o.L((function(e){var t=c(e).next().value;return r.map((function(e){return $(Math.atan2(e.value,t.value),3)}))}))}}],Vn,An,[{namespaceURI:"http://fontoxpath/operators",localName:"to",l:[{type:5,g:0},{type:5,g:0}],i:{type:5,g:2},m:function(e,t,n,r,o){if(e=r.first(),o=o.first(),null===e||null===o)return ge.empty();var i=e.value;return o=o.value,i>o?ge.empty():ge.create({next:function(){return K($(i++,5))}},o-i+1)}}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"QName",l:[{type:1,g:0},{type:1,g:3}],i:{type:23,g:3},m:function(e,t,n,r,o){return Xe([r,o],(function(e){var t=c(e);if(e=t.next().value,!Ft(t=t.next().value.value,23))throw Error("FOCA0002: The provided QName is invalid.");if(null===(e=e&&e.value||null)&&t.includes(":"))throw Error("FOCA0002: The URI of a QName may not be empty if a prefix is provided.");if(r.G())return ge.o($(new ve("",null,t),23));if(!t.includes(":"))return ge.o($(new ve("",e,t),23));var n=c(t.split(":"));return t=n.next().value,n=n.next().value,ge.o($(new ve(t,e,n),23))}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"prefix-from-QName",l:[{type:23,g:0}],i:{type:24,g:0},m:function(e,t,n,r){return Xe([r],(function(e){return null===(e=c(e).next().value)?ge.empty():(e=e.value).prefix?ge.o($(e.prefix,24)):ge.empty()}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"local-name-from-QName",l:[{type:23,g:0}],i:{type:24,g:0},m:function(e,t,n,r){return r.map((function(e){return $(e.value.localName,24)}))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"namespace-uri-from-QName",l:[{type:23,g:0}],i:{type:20,g:0},m:function(e,t,n,r){return r.map((function(e){return $(e.value.namespaceURI||"",20)}))}}],[{l:[{type:59,g:2}],m:function(e,t,n,r){return r.$({empty:function(){return ge.ca()},multiple:function(){return ge.X()},o:function(){return ge.X()}})},localName:"empty",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{l:[{type:59,g:2}],m:function(e,t,n,r){return r.$({empty:function(){return ge.X()},multiple:function(){return ge.ca()},o:function(){return ge.ca()}})},localName:"exists",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{l:[{type:59,g:2}],m:function(e,t,n,r){return Td(r,1,1)},localName:"head",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:0}},{l:[{type:59,g:2}],m:function(e,t,n,r){return Td(r,2,null)},localName:"tail",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2},{type:5,g:3},{type:59,g:2}],m:function(e,t,n,r,o,i){return r.G()?i:i.G()?r:(e=r.N(),0>(o=o.first().value-1)?o=0:o>e.length&&(o=e.length),t=e.slice(o),ge.create(e.slice(0,o).concat(i.N(),t)))},localName:"insert-before",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2},{type:5,g:3}],m:function(e,t,n,r,o){return e=o.first().value,!(r=r.N()).length||1>e||e>r.length||r.splice(e-1,1),ge.create(r)},localName:"remove",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2}],m:function(e,t,n,r){return r.L((function(e){return ge.create(e.reverse())}))},localName:"reverse",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2},{type:3,g:3}],m:function(e,t,n,r,o){return Cd(0,0,0,r,o,ge.empty())},localName:"subsequence",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2},{type:3,g:3},{type:3,g:3}],m:Cd,localName:"subsequence",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2}],m:function(e,t,n,r){return r},localName:"unordered",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:46,g:2}],m:function(e,t,n,r){var o=Rt(r,t).N();return ge.create(o).filter((function(e,t){return o.slice(0,t).every((function(t){return!zn(e,t)}))}))},localName:"distinct-values",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:2}},{l:[{type:46,g:2},{type:1,g:3}],m:function(){throw Error("FOCH0002: No collations are supported")},localName:"distinct-values",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:2}},{l:[{type:46,g:2},{type:46,g:3}],m:function(e,t,n,r,o){return o.L((function(n){var o=c(n).next().value;return Rt(r,t).map((function(t,n){return Ki("eqOp",t.type,o.type)(t,o,e)?$(n+1,5):$(-1,5)})).filter((function(e){return-1!==e.value}))}))},localName:"index-of",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:2}},{l:[{type:46,g:2},{type:46,g:3},{type:1,g:3}],m:function(){throw Error("FOCH0002: No collations are supported")},localName:"index-of",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:2}},{l:[{type:59,g:2},{type:59,g:2}],m:function(e,t,n,r,o){var i=!1,a=Wn(e,t,n,r,o);return ge.create({next:function(){if(i)return W;var e=a.next(0);return e.done?e:(i=!0,K($(e.value,0)))}})},localName:"deep-equal",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{l:[{type:59,g:2},{type:59,g:2},{type:1,g:3}],m:function(){throw Error("FOCH0002: No collations are supported")},localName:"deep-equal",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{l:[{type:59,g:2}],m:function(e,t,n,r){var o=!1;return ge.create({next:function(){if(o)return W;var e=r.Pa();return o=!0,K($(e,5))}})},localName:"count",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:3}},{l:[{type:46,g:2}],m:function(e,t,n,r){if(r.G())return r;if(!(e=ya(e=Bd(r.N()))))throw Error("FORG0006: Incompatible types to be converted to a common type");if(!e.every((function(e){return ee(e.type,2)})))throw Error("FORG0006: items passed to fn:avg are not all numeric.");return t=e.reduce((function(e,t){return e+t.value}),0)/e.length,e.every((function(e){return ee(e.type,5)||ee(e.type,3)}))?ge.o($(t,3)):e.every((function(e){return ee(e.type,4)}))?ge.o($(t,4)):ge.o($(t,6))},localName:"avg",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{l:[{type:46,g:2}],m:function(e,t,n,r){return r.G()?r:(e=Id(r.N()),ge.o(e.reduce((function(e,t){return e.value<t.value?t:e}))))},localName:"max",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{l:[{type:46,g:2},{type:1,g:3}],m:function(){throw Error("FOCH0002: No collations are supported")},localName:"max",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{l:[{type:46,g:2}],m:function(e,t,n,r){return r.G()?r:(e=Id(r.N()),ge.o(e.reduce((function(e,t){return e.value>t.value?t:e}))))},localName:"min",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{l:[{type:46,g:2},{type:1,g:3}],m:function(){throw Error("FOCH0002: No collations are supported")},localName:"min",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{l:[{type:46,g:2}],m:function(e,t,n,r){return Sd(e,t,0,r,ge.o($(0,5)))},localName:"sum",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:3}},{l:[{type:46,g:2},{type:46,g:0}],m:Sd,localName:"sum",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{l:[{type:59,g:2}],m:function(e,t,n,r){if(!r.G()&&!r.ta())throw Error("FORG0003: The argument passed to fn:zero-or-one contained more than one item.");return r},localName:"zero-or-one",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:0}},{l:[{type:59,g:2}],m:function(e,t,n,r){if(r.G())throw Error("FORG0004: The argument passed to fn:one-or-more was empty.");return r},localName:"one-or-more",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:1}},{l:[{type:59,g:2}],m:function(e,t,n,r){if(!r.ta())throw Error("FORG0005: The argument passed to fn:exactly-one is empty or contained more than one item.");return r},localName:"exactly-one",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:3}},{l:[{type:59,g:2},{type:60,g:3}],m:function(e,t,n,r,o){if(r.G())return r;var i=o.first(),a=i.s;if(1!==a.length)throw Error("XPTY0004: signature of function passed to fn:filter is incompatible.");return r.filter((function(r){if(r=dn(a[0],ge.o(r),t,"fn:filter",!1),!(r=i.value.call(void 0,e,t,n,r)).ta()||!ee(r.first().type,0))throw Error("XPTY0004: signature of function passed to fn:filter is incompatible.");return r.first().value}))},localName:"filter",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2},{type:60,g:3}],m:function(e,t,n,r,o){if(r.G())return r;var i=o.first(),a=i.s;if(1!==a.length)throw Error("XPTY0004: signature of function passed to fn:for-each is incompatible.");var s,u=r.value;return ge.create({next:function(r){for(;;){if(!s){var o=u.next(0);if(o.done)return o;o=dn(a[0],ge.o(o.value),t,"fn:for-each",!1),s=i.value.call(void 0,e,t,n,o).value}if(!(o=s.next(r)).done)return o;s=null}}})},localName:"for-each",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2},{type:59,g:2},{type:60,g:3}],m:function(e,t,n,r,o,i){if(r.G())return r;var a=i.first(),s=a.s;if(2!==s.length)throw Error("XPTY0004: signature of function passed to fn:fold-left is incompatible.");return r.L((function(r){return r.reduce((function(r,o){return r=dn(s[0],r,t,"fn:fold-left",!1),o=dn(s[1],ge.o(o),t,"fn:fold-left",!1),a.value.call(void 0,e,t,n,r,o)}),o)}))},localName:"fold-left",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2},{type:59,g:2},{type:60,g:3}],m:function(e,t,n,r,o,i){if(r.G())return r;var a=i.first(),s=a.s;if(2!==s.length)throw Error("XPTY0004: signature of function passed to fn:fold-right is incompatible.");return r.L((function(r){return r.reduceRight((function(r,o){return r=dn(s[0],r,t,"fn:fold-right",!1),o=dn(s[1],ge.o(o),t,"fn:fold-right",!1),a.value.call(void 0,e,t,n,o,r)}),o)}))},localName:"fold-right",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{l:[{type:59,g:2}],m:function(e,t,n,r){if(!t.A)throw Error("serialize() called but no xmlSerializer set in execution parameters.");if(!(e=r.N()).every((function(e){return ee(e.type,53)})))throw Error("Expected argument to fn:serialize to resolve to a sequence of Nodes.");return ge.o($(e.map((function(e){return t.A.serializeToString(Wr(e.value,t,!1))})).join(""),1))},localName:"serialize",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}}],Mn,[{l:[{type:59,g:3},{type:61,g:3}],m:function(e,t,n,r,o){var i,a;return ge.create({next:function(){if(!i){var e=function(e,t,n,r){e=e.first();var o=t.first().h.reduce((function(e,t){return e[t.key.value]=ye(t.value()),e}),Object.create(null));t=o["."]?o["."]():ge.empty(),delete o["."];try{if(ee(e.type,1))var i=e.value;else{if(!ee(e.type,54))throw St("Unable to convert selector argument of type "+ie[e.type]+" to either an "+ie[1]+" or an "+ie[54]+" representing an XQueryX program while calling 'fontoxpath:evaluate'");i=e.value.node}var a=wd(i,{sa:!1,aa:!0,debug:r.debug,Ja:r.Ja},(function(e){return n.ba(e)}),Object.keys(o).reduce((function(e,t){return e[t]=t,e}),{}),{},"http://www.w3.org/2005/xpath-functions",(function(e,t){return n.Ta(e,t)})),s=a.da,u=a.ia,c=!t.G(),l=new xt({M:c?t.first():null,La:c?0:-1,Ia:t,Ga:Object.keys(o).reduce((function(e,t){return e[u.sb(null,t)]=o[t],e}),Object.create(null))});return{Ic:s.h(l,r).value,Fc:e}}catch(t){oo(e.value,t)}}(r,o,n,t);i=e.Ic,a=e.Fc}try{return i.next(0)}catch(e){oo(a.value,e)}}})},localName:"evaluate",namespaceURI:"http://fontoxml.com/fontoxpath",i:{type:59,g:2}},{l:[],m:function(){return ge.o($("3.27.1",1))},localName:"version",namespaceURI:"http://fontoxml.com/fontoxpath",i:{type:1,g:3}}],[{l:[{type:23,g:3},{type:5,g:3}],m:function(e,t,n,r,o){return Xe([r,o],(function(e){var t=c(e);e=t.next().value,t=t.next().value;var r=n.Ba(e.value.namespaceURI,e.value.localName,t.value);return null===r?ge.empty():(e=new we({l:r.l,arity:t.value,localName:e.value.localName,namespaceURI:e.value.namespaceURI,i:r.i,value:r.m}),ge.o(e))}))},localName:"function-lookup",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{g:0,type:60}},{l:[{type:60,g:3}],m:function(e,t,n,r){return Xe([r],(function(e){return(e=c(e).next().value).Ra()?ge.empty():ge.o($(new ve("",e.u,e.j),23))}))},localName:"function-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:23,g:0}},{l:[{type:60,g:3}],m:function(e,t,n,r){return Xe([r],(function(e){return e=c(e).next().value,ge.o($(e.A,5))}))},localName:"function-arity",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:3}}]);function kd(e){this.h=e}(r=kd.prototype).createAttributeNS=function(e,t){return this.h.createAttributeNS(e,t)},r.createCDATASection=function(e){return this.h.createCDATASection(e)},r.createComment=function(e){return this.h.createComment(e)},r.createDocument=function(){return this.h.createDocument()},r.createElementNS=function(e,t){return this.h.createElementNS(e,t)},r.createProcessingInstruction=function(e,t){return this.h.createProcessingInstruction(e,t)},r.createTextNode=function(e){return this.h.createTextNode(e)};var Dd=Symbol("IS_XPATH_VALUE_SYMBOL");function Rd(e){return e&&"object"==typeof e&&"lookupNamespaceURI"in e?function(t){return e.lookupNamespaceURI(t||null)}:function(){return null}}function Md(e){return function(t){var n=t.localName;return t.prefix?null:{namespaceURI:e,localName:n}}}function Ud(e,t,n,r,o,i){var a,s,u,l,p,h,d;null==r&&(r=r||{}),o?(a=o.logger||{trace:console.log.bind(console)},s=o.documentWriter,u=o.moduleImports,l=o.namespaceResolver,p=o.functionNameResolver,h=o.nodesFactory,d=o.xmlSerializer):(a={trace:console.log.bind(console)},u={},l=null,h=null,s=null,d=null,p=void 0);var f=new Se(null===n?new Ee:n);n=u||Object.create(null),u=void 0===o.defaultFunctionNamespaceURI?"http://www.w3.org/2005/xpath-functions":o.defaultFunctionNamespaceURI;var m=wd(e,i,l||Rd(t),r,n,u,p||Md(u));for(e=t?wt(0,t):ge.empty(),t=!h&&i.aa?new fr(t):new kd(h),s=s?new Be(s):Te,h=Object.keys(r).reduce((function(e,t){var n=r[t];return e["Q{}"+t+"[0]"]=n&&"object"==typeof n&&Dd in n?function(){return ge.create(n.Fb)}:function(){return wt(0,r[t])},e}),Object.create(null)),l={},n=(p=c(Object.keys(m.ia.Fa))).next();!n.done;l={Ya:l.Ya},n=p.next())l.Ya=n.value,h[l.Ya]||(h[l.Ya]=function(e){return function(){return(0,m.ia.Fa[e.Ya])(g,y)}}(l));var g=new xt({M:e.first(),La:0,Ia:e,Ga:h}),y=new Bt(i.debug,i.Ja,f,t,s,o.currentContext,a,d);return{zb:g,Bb:y,da:m.da}}function Fd(e,t){var n={},r=0,o=!1,i=null;return{next:function(){if(o)return W;for(var a={};r<e.h.length;){e:{var s=e.h[r].key.value;if(!i){a.mb=e.h[r];var u=a.mb.value().$({default:function(e){return e},multiple:function(e){return function(){throw Error("Serialization error: The value of an entry in a map is expected to be a single item or an empty sequence. Use arrays when putting multiple values in a map. The value of the key "+e.mb.key.value+" holds multiple items")}}(a)}).first();if(null===u){n[s]=null,r++;break e}i=Ld(u,t)}u=i.next(0),i=null,n[s]=u.value,r++}a={mb:a.mb}}return o=!0,K(n)}}}function Gd(e,t){var n=[],r=0,o=!1,i=null;return{next:function(){if(o)return W;for(;r<e.R.length;){if(!i){var a=e.R[r]().$({default:function(e){return e},multiple:function(){throw Error("Serialization error: The value of an entry in an array is expected to be a single item or an empty sequence. Use nested arrays when putting multiple values in an array.")}}).first();if(null===a){n[r++]=null;continue}i=Ld(a,t)}a=i.next(0),i=null,n[r++]=a.value}return o=!0,K(n)}}}function Ld(e,t){if(ee(e.type,61))return Fd(e,t);if(ee(e.type,62))return Gd(e,t);if(ee(e.type,23)){var n=e.value;return{next:function(){return K("Q{"+(n.namespaceURI||"")+"}"+n.localName)}}}switch(e.type){case 7:case 8:case 9:case 11:case 12:case 13:case 14:case 15:var r=e.value;return{next:function(){return K(ct(r))}};case 47:case 53:case 54:case 55:case 56:case 57:case 58:var o=e.value;return{next:function(){return K(Wr(o,t,!1))}};default:return{next:function(){return K(e.value)}}}}Od.forEach((function(e){uo(e.namespaceURI,e.localName,e.l,e.i,e.m)}));var Pd={ANY:0,NUMBER:1,STRING:2,BOOLEAN:3,NODES:7,FIRST_NODE:9,STRINGS:10,MAP:11,ARRAY:12,NUMBERS:13,ALL_RESULTS:14,ASYNC_ITERATOR:99};function Hd(e,t,n,r){switch(n){case 3:return t.getEffectiveBooleanValue();case 2:return(t=Rt(t,r).N()).length?t.map((function(e){return Wt(e,1).value})).join(" "):"";case 10:return(t=Rt(t,r).N()).length?t.map((function(e){return e.value+""})):[];case 1:return null!==(t=t.first())&&ee(t.type,2)?t.value:NaN;case 9:if(null===(t=t.first()))return null;if(!ee(t.type,53))throw Error("Expected XPath "+no(e)+" to resolve to Node. Got "+ie[t.type]);return Wr(t.value,r,!1);case 7:if(!(t=t.N()).every((function(e){return ee(e.type,53)})))throw Error("Expected XPath "+no(e)+" to resolve to a sequence of Nodes.");return t.map((function(e){return Wr(e.value,r,!1)}));case 11:if(1!==(t=t.N()).length)throw Error("Expected XPath "+no(e)+" to resolve to a single map.");if(!ee((t=t[0]).type,61))throw Error("Expected XPath "+no(e)+" to resolve to a map");return Fd(t,r).next(0).value;case 12:if(1!==(t=t.N()).length)throw Error("Expected XPath "+no(e)+" to resolve to a single array.");if(!ee((t=t[0]).type,62))throw Error("Expected XPath "+no(e)+" to resolve to an array");return Gd(t,r).next(0).value;case 13:return t.N().map((function(t){if(!ee(t.type,2))throw Error("Expected XPath "+no(e)+" to resolve to numbers");return t.value}));case 99:var o=t.value,i=null,a=!1,s=function(){for(;!a;){if(!i){var e=o.next(0);if(e.done){a=!0;break}i=Ld(e.value,r)}return e=i.next(0),i=null,e}return Promise.resolve({done:!0,value:null})};return"asyncIterator"in Symbol?((t={})[Symbol.asyncIterator]=function(){return this},t.next=function(){return new Promise((function(e){return e(s())})).catch((function(t){oo(e,t)}))}):t={next:function(){return new Promise((function(e){return e(s())}))}},t;case 14:return t.N().map((function(e){return Ld(e,r).next(0).value}));default:return(t=t.N()).every((function(e){return ee(e.type,53)&&!ee(e.type,47)}))?(t=t.map((function(e){return Wr(e.value,r,!1)})),1===t.length?t[0]:t):1===t.length?ee((t=t[0]).type,62)?Gd(t,r).next(0).value:ee(t.type,61)?Fd(t,r).next(0).value:Dt(t,r).first().value:Rt(ge.create(t),r).N().map((function(e){return e.value}))}}Pd[Pd.ANY]="ANY",Pd[Pd.NUMBER]="NUMBER",Pd[Pd.STRING]="STRING",Pd[Pd.BOOLEAN]="BOOLEAN",Pd[Pd.NODES]="NODES",Pd[Pd.FIRST_NODE]="FIRST_NODE",Pd[Pd.STRINGS]="STRINGS",Pd[Pd.MAP]="MAP",Pd[Pd.ARRAY]="ARRAY",Pd[Pd.NUMBERS]="NUMBERS",Pd[Pd.ALL_RESULTS]="ALL_RESULTS",Pd[Pd.ASYNC_ITERATOR]="ASYNC_ITERATOR";var _d=!1,jd=null,Xd={getPerformanceSummary:function(){var e=jd.getEntriesByType("measure").filter((function(e){return e.name.startsWith("XPath: ")}));return Array.from(e.reduce((function(e,t){var n=t.name.substring(7);return e.has(n)?((n=e.get(n)).times+=1,n.totalDuration+=t.duration):e.set(n,{xpath:n,times:1,totalDuration:t.duration,average:0}),e}),new Map).values()).map((function(e){return e.average=e.totalDuration/e.times,e})).sort((function(e,t){return t.totalDuration-e.totalDuration}))},setPerformanceImplementation:function(e){jd=e},startProfiling:function(){if(null===jd)throw Error("Performance API object must be set using `profiler.setPerformanceImplementation` before starting to profile");jd.clearMarks(),jd.clearMeasures(),_d=!0},stopProfiling:function(){_d=!1}},qd=0;function Vd(e,t,n,r,o,i){if(o=o||0,!e||"string"!=typeof e&&!("nodeType"in e))throw new TypeError("Failed to execute 'evaluateXPath': xpathExpression must be a string or an element depicting an XQueryX DOM tree.");i=i||{};try{var a=Ud(e,t,n||null,r||{},i,{sa:"XQueryUpdate3.1"===i.language,aa:"XQuery3.1"===i.language||"XQueryUpdate3.1"===i.language,debug:!!i.debug,Ja:!!i.disableCache}),s=a.zb,u=a.Bb,c=a.da}catch(t){oo(e,t)}if(c.I)throw Error("XUST0001: Updating expressions should be evaluated as updating expressions");if(3===o&&t&&"object"==typeof t&&"nodeType"in t&&(n=c.A(),t=Ae(t),null!==n&&!t.includes(n)))return!1;try{t=e,_d&&("string"!=typeof t&&(t=no(t)),jd.mark(t+(0===qd?"":"@"+qd)),qd++);var l=Hd(e,hr(c,s,u),o,u);return o=e,_d&&("string"!=typeof o&&(o=no(o)),s=o+(0===--qd?"":"@"+qd),jd.measure("XPath: "+o,s),jd.clearMarks(s)),l}catch(t){oo(e,t)}}Object.assign(Vd,{Jc:14,ANY_TYPE:0,Rb:12,Sb:99,BOOLEAN_TYPE:3,Wb:9,jc:11,mc:7,qc:13,NUMBER_TYPE:1,tc:10,STRING_TYPE:2,Kc:"XPath3.1",Lc:"XQuery3.1",xc:"XQueryUpdate3.1"});var $d={};function Yd(e,t,n,r,o){return Vd(e,t,n,r,Vd.Sb,o)}function zd(e,t,n,r){var o={};return o.pendingUpdateList=e.fa.map((function(e){return e.h(r)})),o.xdmValue=Hd(t,ge.create(e.H),n,r),o}function Qd(e,t,n){switch(t.type){case 0:return[e,{type:0}];case 1:return[e,{type:1}];case 3:return[""+Qd(e+"("+(n||"contextItem")+")",t.i,n)[0],t.i];case 4:return[e,{type:4}];case 5:throw Error("Trying to get value of generated code with type None");default:throw Error("Unreachable! Trying to get compiled value of unsupported GeneratedCodeType.")}}function Jd(e,t,n){return{code:e,Aa:t,isAstAccepted:!0,wa:n}}function Wd(e){return{isAstAccepted:!1,reason:e}}function Kd(e,t,n,r){switch(r=void 0===r?"contextItem":r,n.type){case 0:case 1:return Jd("!!"+e,{type:0},[t]);case 3:return(e=Kd(e+"("+r+")","",n.i,r)).isAstAccepted?Jd("!!"+e.code,e.Aa,[t]):e;case 4:return Jd("(() => {\n\t\t\t\t\tconst result = "+e+".next();\n\t\t\t\t\treturn result.done ? false : !!result.value;\n\t\t\t\t})()",{type:0});case 5:throw Error("Trying to get value of generated code with type None");default:throw Error("Unreachable! Trying to get compiled value of unsupported GeneratedCodeType.")}}Object.assign(Vd,($d.ALL_RESULTS_TYPE=14,$d.ANY_TYPE=0,$d.ARRAY_TYPE=12,$d.ASYNC_ITERATOR_TYPE=99,$d.BOOLEAN_TYPE=3,$d.FIRST_NODE_TYPE=9,$d.MAP_TYPE=11,$d.NODES_TYPE=7,$d.NUMBERS_TYPE=13,$d.NUMBER_TYPE=1,$d.STRINGS_TYPE=10,$d.STRING_TYPE=2,$d.XPATH_3_1_LANGUAGE="XPath3.1",$d.XQUERY_3_1_LANGUAGE="XQuery3.1",$d.XQUERY_UPDATE_3_1_LANGUAGE="XQueryUpdate3.1",$d));var Zd={DONE_TOKEN:W,getEffectiveBooleanValue:le,isSubtypeOf:ee,ready:K},ef={sc:"pathExpr",Qb:"andOp",rc:"orOp",uc:"stringConstantExpr",Ub:"equalOp",pc:"notEqualOp",fc:"lessThanOrEqualOp",ec:"lessThanOp",$b:"greaterThanOrEqualOp",Zb:"greaterThanOp",Vb:"eqOp",lc:"neOp",ic:"ltOp",hc:"leOp",ac:"gtOp",Yb:"geOp",cc:"isOp",oc:"nodeBeforeOp",nc:"nodeAfterOp",Xb:"functionCallExpr"},tf=Object.values(ef);function nf(e,t,n,r,o){return e=Do(e,n),(e=Do(e,tf))?(t+=n,n=c(r.Ab(e,t,r)),r=n.next().value,n=n.next().value,r.isAstAccepted?0===o?[Kd(t,r.code,r.Aa),null]:[Jd(t,r.Aa,[r.code]),n]:[r,null]):[Wd("Unsupported: a base expression used with an operand."),null]}function rf(e,t,n){return 4===t&&(e+=".next().value"),47===n&&(e="(function () { const attr = "+e+"; return attr ? domFacade.getData(attr) : null})()"),e}function of(e,t,n,r,o){var i=Mo(Do(e,"firstOperand")[1],"type");if(e=Mo(Do(e,"secondOperand")[1],"type"),!i||!e)return Wd("Left or right type of compare are not found, annotation failed.");var a=[47,1];if(!a.includes(i.type)||!a.includes(e.type))return Wd("Unsupported types in compare: ["+ie[i.type]+", "+ie[e.type]+"]");if(!n.isAstAccepted)return n;if(!r.isAstAccepted)return r;if(!i||!e)return Wd("Operands in compare weren't annotated");if(!(a=new Map([["eqOp","==="],["neOp","!=="]])).has(t))return Wd(t+" not yet implemented");t=a.get(t),a=Qd(n.code,n.Aa);var s=Qd(r.code,r.Aa);return Jd("function "+o+"(contextItem) {\n\t\t\t\t"+n.wa.join("\n")+"\n\t\t\t \t"+r.wa.join("\n")+"\n\t \t     \treturn "+rf(a[0],a[1].type,i.type)+" "+t+" "+rf(s[0],s[1].type,e.type)+";\n\t\t}",{type:3,i:{type:0}})}var af={},sf=(af.equalOp="eqOp",af.notEqualOp="neOp",af.lessThanOrEqualOp="leOp",af.lessThanOp="ltOp",af.greaterThanOrEqualOp="geOp",af.greaterThanOp="gtOp",af),uf={"local-name":function(e,t,n){return pf(e,t,n,cf,"local-name()")},name:function(e,t,n){return pf(e,t,n,lf,"name()")}};function cf(e){return"("+e+".localName || "+e+".target || '')"}function lf(e){return"((("+e+".prefix || '').length !== 0 ? "+e+".prefix + ':' : '')\n\t\t+ ("+e+".localName || "+e+".target || ''))"}function pf(e,t,n,r,o){if(1===(e=Do(e,"arguments")).length)t="function "+t+"(contextItem) {\n\t\t\tif (contextItem === undefined || contextItem === null) {\n\tthrow new Error('XPDY0002: The function which was called depends on dynamic context, which is absent.');\n}\n\t\t\treturn "+r("contextItem")+";\n\t\t}";else{if(2!==e.length)return Wd("Incorrect arg count for "+o+" function");if(o=e[1],e=(n=c(n.Ab(o,"arg",n))).next().value,n.next(),n=e.isAstAccepted?Jd("arg",e.Aa,[e.code]):e,"contextItemExpr"===o[0])t="function "+t+"(contextItem) {\n\t\t\t\tif (contextItem === undefined || contextItem === null) {\n\tthrow new Error('XPDY0002: The function which was called depends on dynamic context, which is absent.');\n}\n\t\t\t\treturn "+r("contextItem")+";\n\t\t\t}";else{if(!n.isAstAccepted)return n;t="function "+t+"(contextItem) {\n\t\t\t\t"+n.wa+"\n\t\t\t\tconst value = "+Qd(n.code,n.Aa)[0]+';\n\t\t\t\tconst childElement = value.next().value;\n\t\t\t\treturn (value.done ? "" : '+r("childElement")+");\n\t\t\t}"}}return Jd(t,{type:3,i:{type:0}})}function hf(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function df(e,t,n,r){var o=c(nf(e,t,"firstOperand",n,0)),i=o.next().value;return o=o.next().value,i.isAstAccepted?(e=(n=c(nf(e,t,"secondOperand",n,0))).next().value,n=n.next().value,e.isAstAccepted?[Jd("\n\tfunction "+t+"(contextItem) {\n\t\t"+i.wa.join("\n")+"\n\t\t"+e.wa.join("\n")+"\n\t\treturn "+i.code+" "+r+" "+e.code+";\n\t}\n\t",{type:3,i:{type:0}}),"&&"===r?yi(o,n):o||n]:[e,null]):[i,null]}function ff(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];return t.filter((function(e){return""!==e})).join(" && ")}function mf(e,t,n,r,o,i){var a=1!==n?"i"+n+" = 0;":"";return Jd("\n\t"+i+"\n\twhile ("+ff(o+n,"i"+n+" < "+o+n+".length")+") {\n\t\tconst contextItem"+n+" = "+o+n+"[i"+n+"];\n\t\tif (!("+(e=ff("contextItem"+n,e,t))+")) {\n\t\t\ti"+n+"++;\n\t\t\tcontinue;\n\t\t}\n\t\t"+r+"\n\t}\n\t"+a+"\n\t",{type:2},["let i"+n+" = 0;"])}function gf(e,t,n,r,o){return Jd("\n\t\t"+o+"\n\t\tif ("+(e=ff("i"+n+" === 0","contextItem"+n,e,t))+") {\n\t\t\t"+r+"\n\t\t}\n\t\t",{type:2},["let i"+n+" = 0;"])}var yf={vc:"textTest",Tb:"elementTest",kc:"nameTest",wc:"Wildcard"},vf=Object.values(yf);function wf(e,t,n){if(null===t.namespaceURI&&"*"!==t.prefix){if(!(n=n.ba(t.prefix||"")||null)&&t.prefix)throw Error("XPST0081: The prefix "+t.prefix+" could not be resolved.");t.namespaceURI=n}n=t.prefix;var r=t.namespaceURI;t=t.localName;var o=e+".nodeType\n\t\t&& ("+e+".nodeType === /*ELEMENT_NODE*/ 1\n\t\t|| "+e+".nodeType === /*ATTRIBUTE_NODE*/ 2)";return"*"===n?"*"===t?[Jd(o,{type:0}),null]:[Jd(o+" && "+e+".localName === "+hf(t),{type:0}),"name-"+t]:[Jd((o="*"!==t?o+" && "+e+".localName === "+hf(t)+" && ":"")+"("+e+".namespaceURI || null) === (("+(n=""===n?e+".nodeType\n&& "+e+".nodeType === /*ELEMENT_NODE*/ 1 ? "+hf(r)+" : null":hf(r))+") || null)",{type:0}),"name-"+t]}function xf(e,t,n){var r=e[0];switch(r){case yf.Tb:return r=(e=Do(e,"elementName"))&&Do(e,"star"),null===e||r?t=[Jd(t+".nodeType === /*ELEMENT_NODE*/ 1",{type:0}),null]:t=wf(t,e=Go(Do(e,"QName")),n),t;case yf.vc:return[Jd(t+".nodeType === /*TEXT_NODE*/ 3",{type:0}),null];case yf.kc:return wf(t,Go(e),n);case yf.wc:return Do(e,"star")?null!==(r=Do(e,"uri"))?t=wf(t,{localName:"*",namespaceURI:Ro(r),prefix:""},n):(r=Do(e,"NCName"),t="star"===Do(e,"*")[0]?wf(t,{localName:Ro(r),namespaceURI:null,prefix:"*"},n):wf(t,{localName:"*",namespaceURI:null,prefix:Ro(r)},n)):t=wf(t,{localName:"*",namespaceURI:null,prefix:"*"},n),t;default:return[Wd("Unsupported: the test '"+r+"'."),null]}}function bf(e,t,n){var r=e[0];switch(r){case ef.sc:r="",Do(e,"rootExpr")&&(r="\n\t\tlet documentNode = contextItem;\n\t\twhile (documentNode.nodeType !== /*DOCUMENT_NODE*/9) {\n\t\t\tdocumentNode = domFacade.getParentNode(documentNode);\n\t\t\tif (documentNode === null) {\n\t\t\t\tthrow new Error('XPDY0050: the root node of the context node is not a document node.');\n\t\t\t}\n\t\t}\n\t\tcontextItem = documentNode;\n\t\t");var o=c(function(e,t){if(0===e.length)return[Jd("\n\t\t\tif (!hasReturned) {\n\t\t\t\thasReturned = true;\n\t\t\t\treturn ready(contextItem);\n\t\t\t}\n\t\t\t",{type:2},["let hasReturned = false;"]),null];for(var n="",r=[],o=null,i=e.length-1;0<=i;i--){var a=e[i],s=i+1,u=Do(a,"predicates");e:{var l=t,h="",d=[];if(u){u=Fo(u,"*");for(var f=null,m=0;m<u.length;m++){var g="step"+s+"_predicate"+m,y=c(l.Ab(u[m],g,l)),v=y.next().value;if(y=y.next().value,!v.isAstAccepted){l=[v,null];break e}if(f=yi(f,y),!(g=Kd(g,"",v.Aa,"contextItem"+s)).isAstAccepted){l=[g,null];break e}h=0===m?h+g.code:h+" && "+g.code,d.push(v.code)}l=[Jd(h,{type:0},d),f]}else l=[Jd("",{type:5},d),null]}if(l=(h=c(l)).next().value,d=h.next().value,!l.isAstAccepted)return[l,null];if(!(h=Do(a,"xpathAxis")))return[Wd("Unsupported: filter expressions."),null];if(!(u=Do(a,vf)))return[Wd("Unsupported: the test in the '"+a+"' step."),null];if(n=i===e.length-1?"i"+s+"++;\n\t\t\t\t\t   return ready(contextItem"+s+");":n+"\n\t\t\t\t\t   i"+s+"++;",u=(f=c(xf(u,"contextItem"+s,t))).next().value,f=f.next().value,!u.isAstAccepted)return[u,null];d=yi(f,d);e:switch(u=u.code,f=l.code,h=Ro(h),h){case"attribute":s=[mf(u,f,s,n,"attributeNodes","\n\tlet attributeNodes"+s+";\n\tif (contextItem && contextItem"+(s-1)+".nodeType === /*ELEMENT_NODE*/ 1) {\n\t\tattributeNodes"+s+" =  domFacade.getAllAttributes(contextItem"+(s-1)+" "+(d?', "'+d+'"':"")+");\n\t}\n\t"),"type-1"];break e;case"child":s=[mf(u,f,s,n,"childNodes","const childNodes"+s+" = domFacade.getChildNodes(contextItem"+(s-1)+" "+(d?', "'+d+'"':"")+");"),null];break e;case"parent":s=[gf(u,f,s,n,"\n\tconst contextItem"+s+" = domFacade.getParentNode(contextItem"+(s-1)+" "+(d?', "'+d+'"':"")+");\n\t"),null];break e;case"self":s=[gf(u,f,s,n,"const contextItem"+s+" = contextItem"+(s-1)+";"),d];break e;default:s=[Wd("Unsupported: the "+h+" axis"),null]}if(s=(n=c(s)).next().value,n=n.next().value,!s.isAstAccepted)return[s,null];if(0===i&&(o=n),r.push.apply(r,[].concat(p(s.wa),p(l.wa))),n=s.code,0<Fo(a,"lookup").length)return[Wd("Unsupported: lookups."),null]}return[Jd("const contextItem0 = contextItem;"+n,{type:2},r),o]}(Fo(e,"stepExpr"),n));return e=o.next().value,o=o.next().value,e.isAstAccepted?[Jd("\n\tfunction "+t+"(contextItem) {\n\t\t"+r+"\n\t\t"+e.wa.join("\n")+"\n\t\tconst next = () => {\n\t\t\t"+e.code+"\n\t\t\treturn DONE_TOKEN;\n\t\t};\n\t\treturn {\n\t\t\tnext,\n\t\t\t[Symbol.iterator]() { return this; }\n\t\t};\n\t}\n\t",{type:3,i:{type:4}}),o]:[e,null];case ef.Qb:return df(e,t,n,"&&");case ef.rc:return df(e,t,n,"||");case ef.uc:return[Jd("const "+t+" = "+(e=hf(e=Do(e,"value")[1]||""))+";",{type:1}),null];case ef.Ub:case ef.pc:case ef.fc:case ef.ec:case ef.$b:case ef.Zb:case ef.Vb:case ef.lc:case ef.ic:case ef.hc:case ef.ac:case ef.Yb:case ef.cc:case ef.oc:case ef.nc:e:{var i=c(nf(e,t,"firstOperand",n));if(o=i.next().value,i.next(),o.isAstAccepted)if(n=(i=c(nf(e,t,"secondOperand",n))).next().value,i.next(),n.isAstAccepted)switch(r){case"eqOp":case"neOp":case"ltOp":case"leOp":case"gtOp":case"geOp":case"isOp":t=of(e,r,o,n,t);break e;case"equalOp":case"notEqualOp":case"lessThanOrEqualOp":case"lessThanOp":case"greaterThanOrEqualOp":case"greaterThanOp":i=Mo(e,"type");var a=Mo(e,"type");t=i&&a?3===i.g&&3===a.g?of(e,sf[r],o,n,t):Wd("generalCompare with sequences is still in development"):Wd("types of compare are not known");break e;default:t=Wd("Unsupported compare type")}else t=n;else t=o}return[t,null];case ef.Xb:return r=Ro(Do(e,"functionName")),[void 0!==uf[r]?uf[r](e,t,n):Wd("Unsupported function: "+r),null];default:return[Wd("Unsupported: the base expression '"+r+"'."),null]}}function Af(e,t,n){var r=Do(e,"mainModule");if(!r)return Wd("Unsupported: Can not execute a library module.");if(Do(r,"prolog"))return Wd("Unsupported: XQuery.");r=Uo(r,["queryBody","*"]),n.Ab=bf;var o=c(bf(r,"compiledXPathExpression",n));return n=o.next().value,o.next(),!1===n.isAstAccepted?n:(o=n.wa?n.wa.join("\n"):"",r=Mo(r,"type"),t=function(e,t,n){switch(e){case 9:if(e=(n=c(Qd("compiledXPathExpression",t))).next().value,4!==n.next().value.type)throw Error("Trying access generated code as an iterator while this is not the case.");return Jd("\n\tconst firstResult = "+e+".next();\n\tif (!firstResult.done) {\n\t\treturn firstResult.value\n\t}\n\treturn null;\n\t",{type:2});case 7:return e=(n=c(Qd("compiledXPathExpression",t))).next().value,4!==n.next().value.type?Wd("Return type was not an iterator"):Jd("\n\tconst nodes = [];\n\tfor (const node of "+e+") {\n\t\tnodes.push(node);\n\t}\n\treturn nodes;\n\t",{type:2});case 3:return(n=Kd("compiledXPathExpression","",t)).isAstAccepted?Jd("return "+n.code+";",{type:2}):n;case 2:return n=void 0===n?Wd("Full AST wasn't annotated so we cannot correctly emit a string return"):ee(n,1)||ee(n,47)?Jd("return "+rf(e=(t=c(Qd("compiledXPathExpression",t))).next().value,(t=t.next().value).type,n)+" || '';",{type:2}):Wd("Not implemented: returning anything but strings and attributes from codegen");default:return Wd("Unsupported: the return type '"+e+"'.")}}(t,n.Aa,r?r.type:void 0),!1===t.isAstAccepted?t:(t=o+n.code+t.code,n="\n\treturn (contextItem, domFacade, runtimeLib) => {\n\t\tconst {\n\t\t\tDONE_TOKEN,\n\t\t\tValueType,\n\t\t\tXPDY0002,\n\t\t\tdeterminePredicateTruthValue,\n\t\t\tisSubtypeOf,\n\t\t\tready,\n\t\t\tatomize,\n\t\t} = runtimeLib;",Ef(e)&&(n+='\n\t\tif (!contextItem) {\n\t\t\tthrow XPDY0002("Context is needed to evaluate the given path expression.");\n\t\t}\n\n\t\tif (!contextItem.nodeType) {\n\t\t\tthrow new Error("Context item must be subtype of node().");\n\t\t}\n\t\t'),{code:n+(t+"}\n//# sourceURL=generated.js"),isAstAccepted:!0}))}function Ef(e){var t=Fo(e,"*");if("pathExpr"===e[0])return!0;for(t=(e=c(t)).next();!t.done;t=e.next())if(Ef(t.value))return!0;return!1}var Nf={},Tf=(Nf["http://www.w3.org/2005/XQueryX"]="xqx",Nf["http://www.w3.org/2007/xquery-update-10"]="xquf",Nf["http://fontoxml.com/fontoxpath"]="x",Nf);function Bf(e,t,n,r,o){if("string"==typeof n)return 0===n.length?null:t.createTextNode(n);if(!Array.isArray(n))throw new TypeError("JsonML element should be an array or string");r=function(e,t){switch(e){case"copySource":case"insertAfter":case"insertAsFirst":case"insertAsLast":case"insertBefore":case"insertInto":case"modifyExpr":case"newNameExpr":case"replacementExpr":case"replaceValue":case"returnExpr":case"sourceExpr":case"targetExpr":case"transformCopies":case"transformCopy":return{localName:e,tb:t||"http://www.w3.org/2005/XQueryX"};case"deleteExpr":case"insertExpr":case"renameExpr":case"replaceExpr":case"transformExpr":return{localName:e,tb:"http://www.w3.org/2007/xquery-update-10"};case"x:stackTrace":return{localName:"stackTrace",tb:"http://fontoxml.com/fontoxpath"};default:return{localName:e,tb:"http://www.w3.org/2005/XQueryX"}}}(n[0],r);var i=r.localName;r=r.tb;var a=t.createElementNS(r,Tf[r]+":"+i),s=n[1],u=1;if("object"==typeof s&&!Array.isArray(s)){if(null!==s)for(var l=(u=c(Object.keys(s))).next();!l.done;l=u.next()){var p=s[l=l.value];null!==p&&("type"===l?void 0!==p&&e.setAttributeNS(a,r,"fontoxpath:"+l,se(p)):("start"!==l&&"end"!==l||"stackTrace"!==i||(p=JSON.stringify(p)),o&&"prefix"===l&&""===p||e.setAttributeNS(a,r,Tf[r]+":"+l,p)))}u=2}for(i=u,s=n.length;i<s;++i)null!==(u=Bf(e,t,n[i],r,o))&&e.insertBefore(a,u,null);return a}function If(e,t,n){var r=e.stack;r&&(r.includes(e.message)&&(r=r.substr(r.indexOf(e.message)+e.message.length).trim()),(r=r.split("\n")).splice(10),r=r.map((function(e){return e.startsWith("    ")||e.startsWith("\t")?e:"    "+e})),r=r.join("\n")),e=Error.call(this,"Custom XPath function Q{"+n+"}"+t+" raised:\n"+e.message+"\n"+r),this.message=e.message,"stack"in e&&(this.stack=e.stack)}function Cf(e,t,n){return 0===t.g?e.G()?null:Ld(e.first(),n).next(0).value:2===t.g||1===t.g?e.N().map((function(e){if(ee(e.type,47))throw Error("Cannot pass attribute nodes to custom functions");return Ld(e,n).next(0).value})):Ld(e.first(),n).next(0).value}y(If,Error);var Sf=new Map;function Of(e){var t;e:{if(t=Os.get(e))for(var n=c(Object.keys(t)),r=n.next();!r.done;r=n.next())if(t[r=r.value]&&t[r].length){t=t[r][0].h;break e}t=null}if(t)return t;if(Sf.has(e))return Sf.get(e);if(null===(t=Uo(t="string"==typeof e?md(e,{aa:!1}):Rs(e),["mainModule","queryBody","*"])))throw Error("Library modules do not have a specificity");return t=Ss(t,{sa:!1,aa:!1}),Sf.set(e,t),t}var kf=new Ee;return void 0!==n&&(n.compareSpecificity=function(e,t){return Br(Of(e).s,Of(t).s)},n.compileXPathToJavaScript=function(e,t,n){n=n||{},t=t||0,"string"==typeof e?e=md(e=Gs(e),{aa:"XQuery3.1"===n.language||"XQueryUpdate3.1"===n.language,debug:!1}):e=Rs(e);var r=Do(e,"mainModule");return r?Do(r,"prolog")?Wd("Unsupported: XQuery Prologs are not supported."):(ti(e,n=new ci(new No(new po((r={ba:n.namespaceResolver||Rd(null)}).ba,{},void 0===n.defaultFunctionNamespaceURI?"http://www.w3.org/2005/xpath-functions":n.defaultFunctionNamespaceURI,n.functionNameResolver||Md("http://www.w3.org/2005/xpath-functions"))))),Af(e,t,r)):Wd("Unsupported: XQuery Library modules are not supported.")},n.domFacade=kf,n.evaluateXPath=Vd,n.evaluateXPathToArray=function(e,t,n,r,o){return Vd(e,t,n,r,Vd.Rb,o)},n.evaluateXPathToAsyncIterator=Yd,n.evaluateXPathToBoolean=function(e,t,n,r,o){return Vd(e,t,n,r,Vd.BOOLEAN_TYPE,o)},n.evaluateXPathToFirstNode=function(e,t,n,r,o){return Vd(e,t,n,r,Vd.Wb,o)},n.evaluateXPathToMap=function(e,t,n,r,o){return Vd(e,t,n,r,Vd.jc,o)},n.evaluateXPathToNodes=function(e,t,n,r,o){return Vd(e,t,n,r,Vd.mc,o)},n.evaluateXPathToNumber=function(e,t,n,r,o){return Vd(e,t,n,r,Vd.NUMBER_TYPE,o)},n.evaluateXPathToNumbers=function(e,t,n,r,o){return Vd(e,t,n,r,Vd.qc,o)},n.evaluateXPathToString=function(e,t,n,r,o){return Vd(e,t,n,r,Vd.STRING_TYPE,o)},n.evaluateXPathToStrings=function(e,t,n,r,o){return Vd(e,t,n,r,Vd.tc,o)},n.evaluateUpdatingExpression=function(e,t,n,r,o){var i,a,s,u,c,l,p,h,d,f;return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(r,o){!function e(i){i.done?r(i.value):Promise.resolve(i.value).then(t,n).then(e,o)}(e.next())}))}(new N(new b((function(m){switch(m.h){case 1:o=o||{};try{u=Ud(e,t,n||null,r||{},o||{},{sa:!0,aa:!0,debug:!!o.debug,Ja:!!o.disableCache}),i=u.zb,a=u.Bb,s=u.da}catch(t){oo(e,t)}if(s.I){m.h=2;break}c=[];var g=(l=Yd(e,t,n,r,Object.assign(Object.assign({},o),{language:"XQueryUpdate3.1"}))).next();return m.h=3,{value:g};case 3:p=m.u;case 4:if(p.done){m.h=6;break}return c.push(p.value),g=l.next(),m.h=7,{value:g};case 7:p=m.u,m.h=4;break;case 6:return h={},m.return(Promise.resolve((h.pendingUpdateList=[],h.xdmValue=c,h)));case 2:try{f=s.u(i,a),d=f.next(0)}catch(t){oo(e,t)}return m.return(zd(d.value,e,o.returnType,a))}}))))},n.evaluateUpdatingExpressionSync=function(e,t,n,r,o){o=o||{};try{var i=Ud(e,t,n||null,r||{},o||{},{sa:!0,aa:!0,debug:!!o.debug,Ja:!!o.disableCache}),a=i.zb,s=i.Bb,u=i.da}catch(t){oo(e,t)}if(!u.I)return a={},(s={}).pendingUpdateList=[],s.xdmValue=Vd(e,t,n,r,o.i,Object.assign(Object.assign({},o),(a.language=Vd.xc,a))),s;try{var c=u.u(a,s).next(0)}catch(t){oo(e,t)}return zd(c.value,e,o.returnType,s)},n.executeJavaScriptCompiledXPath=function(e,t,n){return n=n||new Ee,e()(t,n,Zd)},n.executePendingUpdateList=function(e,t,n,r){t=new Se(t||new Ee),r=r?new Be(r):Te,n=n?n=new kd(n):null,yr(e=e.map(us),t,n,r)},n.getBucketForSelector=function(e){return Of(e).A()},n.getBucketsForNode=Ae,n.precompileXPath=function(e){return Promise.resolve(e)},n.registerXQueryModule=function(e,t){if(ei(t=md(e,{aa:!0,debug:(t=void 0===t?{debug:!1}:t).debug}),new ci(void 0)),!(t=Do(t,"libraryModule")))throw Error("XQuery module must be declared in a library module.");var n=Do(t,"moduleDecl"),r=Do(n,"uri"),o=Ro(r);if(r=Ro(n=Do(n,"prefix")),Co(n=new No(new po((function(){return null}),Object.create(null),"http://www.w3.org/2005/xpath-functions",Md("http://www.w3.org/2005/xpath-functions"))),r,o),null!==(t=Do(t,"prolog"))){try{var i=yd(t,n)}catch(t){oo(e,t)}i.Oa.forEach((function(e){if(o!==e.namespaceURI)throw Error("XQST0048: Functions and variables declared in a module must reside in the module target namespace.")})),Us(o,i)}else Us(o,{Oa:[],Wa:[]});return o},n.registerCustomXPathFunction=function(e,t,n,r){e=function(e){if("object"==typeof e)return e;if(2!==(e=e.split(":")).length)throw Error("Do not register custom functions in the default function namespace");var t=c(e);e=t.next().value,t=t.next().value;var n=lo[e];if(!n){if(n="generated_namespace_uri_"+e,lo[e])throw Error("Prefix already registered: Do not register the same prefix twice.");lo[e]=n}return{localName:t,namespaceURI:n}}(e);var o=e.namespaceURI,i=e.localName;if(!o)throw yo();var a=t.map((function(e){return ce(e)})),s=ce(n);uo(o,i,a,s,(function(e,t,n){var u=Array.from(arguments);u.splice(0,3),u=u.map((function(e,n){return Cf(e,a[n],t)}));var c={};c.currentContext=t.u,c.domFacade=t.h.h;try{var l=r.apply(void 0,[c].concat(p(u)))}catch(e){throw new If(e,i,o)}return l&&"object"==typeof l&&Object.getOwnPropertySymbols(l).includes(Dd)?ge.create(l.Fb):wt(t.h,l,s)}))},n.parseScript=function(e,t,n,r){r=void 0===r?Te:r;var o=md(e=Gs(e),{aa:"XQuery3.1"===t.language||"XQueryUpdate3.1"===t.language,debug:t.debug}),i=new po(t.namespaceResolver||function(){return null},{},void 0===t.defaultFunctionNamespaceURI?"http://www.w3.org/2005/xpath-functions":t.defaultFunctionNamespaceURI,t.functionNameResolver||function(){return null});i=new No(i);var a=Do(o,["mainModule","libraryModule"]),s=Do(a,"moduleDecl");return s&&Co(i,Ro(Do(s,"prefix")),s=Ro(Do(s,"uri"))),(a=Do(a,"prolog"))&&yd(a,i,!1),!1!==t.annotateAst&&ei(o,new ci(i)),i=new Ee,t=Bf(r,n,o,null,!1===t.Mc),r.insertBefore(t,n.createComment(e),i.getFirstChild(t)),t},n.profiler=Xd,n.createTypedValueFactory=function(e){return function(t,n){return t=vt(new Se(null===n?new Ee:n),t,ce(e)),(n={})[Dd]=!0,n.Fb=t,n}},n.Language={XPATH_3_1_LANGUAGE:"XPath3.1",XQUERY_3_1_LANGUAGE:"XQuery3.1",XQUERY_UPDATE_3_1_LANGUAGE:"XQueryUpdate3.1"},n.ReturnType=Pd),n}.call("undefined"==typeof window?void 0:window,Ae,He);_e.compareSpecificity,_e.compileXPathToJavaScript,_e.createTypedValueFactory,_e.domFacade,_e.evaluateUpdatingExpression,_e.evaluateUpdatingExpressionSync;const je=_e.evaluateXPath;_e.evaluateXPathToArray,_e.evaluateXPathToAsyncIterator;const Xe=_e.evaluateXPathToBoolean,qe=_e.evaluateXPathToFirstNode;_e.evaluateXPathToMap;const Ve=_e.evaluateXPathToNodes,$e=_e.evaluateXPathToNumber;_e.evaluateXPathToNumbers;const Ye=_e.evaluateXPathToString,ze=_e.evaluateXPathToStrings;_e.executeJavaScriptCompiledXPath,_e.executePendingUpdateList,_e.getBucketForSelector;const Qe=_e.getBucketsForNode;_e.Language;const Je=_e.parseScript;_e.precompileXPath,_e.profiler;const We=_e.registerCustomXPathFunction,Ke=_e.registerXQueryModule;_e.ReturnType;class Ze{constructor(e){this._onNodeTouched=e}getAllAttributes(e){return Array.from(e.attributes)}getAttribute(e,t){return e.getAttribute(t)}getChildNodes(e,t){const n=Array.from(e.childNodes).filter((e=>!t||Qe(e).includes(t)));return n.forEach((e=>this._onNodeTouched(e))),n}getData(e){return e.nodeType===Node.ATTRIBUTE_NODE?(this._onNodeTouched(e),e.value):(this._onNodeTouched(e.parentNode),e.data)}getFirstChild(e,t){for(const n of e.childNodes)if(!t||Qe(n).includes(t))return this._onNodeTouched(n),n;return null}getLastChild(e,t){const n=e.getChildNodes().filter((e=>!t||Qe(e).includes(t))),r=n[n.length-1];return r||null}getNextSibling(e,t){for(let n=e.nextSibling;n;n=n.nextSibling)if(Qe(n).includes(t))return this._onNodeTouched(n),n;return null}getParentNode(e){return e.parentNode}getPreviousSibling(e,t){for(let{previousSibling:n}=e;n;n=n.previousSibling)if(Qe(n).includes(t))return n;return null}}class et{static contains(e,t){for(;t;){if(t===e)return!0;t=t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.host:t.parentNode}return!1}static getClosest(e,t){for(;t&&!t.matches||!t.matches(e);)if(t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE)if(t.nodeType!==Node.ATTRIBUTE_NODE){if(t.nodeType===Node.TEXT_NODE&&(t=t.parentNode),t.matches("fx-fore"))return null;if(!(t=t.parentNode))return null}else t=t.ownerElement;else t=t.host;return t}static getParentBindingElement(e){return!e.parentNode||e.parentNode.nodeType===Node.DOCUMENT_NODE&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?null:e.parentNode.closest("[ref]")}static isAbsolutePath(e){return null!=e&&(e.startsWith("/")||e.startsWith("instance("))}static isSelfReference(e){return"."===e||"./text()"===e||"text()"===e||""===e||null===e}static getInstanceId(e){if(!e)return"default";if(e.startsWith("instance()"))return"default";if(e.startsWith("instance(")){const t=e.substring(e.indexOf("(")+1);return t.substring(1,t.indexOf(")")-1)}return null}static resolveInstance(e){const t=et.getInstanceId(e.getAttribute("ref"));if(null!==t)return t;const n=et.getParentBindingElement(e);return n?this.resolveInstance(n):"default"}static getPath(e){const t=Ye("path()",e);return et.shortenPath(t)}static shortenPath(e){const t=e.replaceAll(/(Q{(.*?)\})/g,""),n=t.substring(1,t.length);return n.substring(n.indexOf("/"),t.length)}static getBasePath(e){return e.split(":")[0]}}function tt(e,t,n,r){const o={};return function(i){if(o[i])return;const a={},s=[],u=[];for(u.push({node:i,processed:!1});u.length>0;){const i=u[u.length-1],{processed:c}=i,{node:l}=i;if(c)u.pop(),s.pop(),a[l]=!1,o[l]=!0,t&&0!==e[l].length||n.push(l);else{if(o[l]){u.pop();continue}if(a[l]){if(r){u.pop();continue}throw s.push(l),window.dispatchEvent(new CustomEvent("compute-exception",{composed:!1,bubbles:!0,detail:{path:s,message:"cyclic graph"}})),new Error(`Cyclic at ${s}`)}a[l]=!0,s.push(l);const t=e[l];for(let e=t.length-1;e>=0;e-=1)u.push({node:t[e],processed:!1});i.processed=!0}}}}function nt(e){this.nodes={},this.outgoingEdges={},this.incomingEdges={},this.circular=e&&!!e.circular}function rt(e){const t=(new DOMParser).parseFromString(e,"application/xml"),n=(new DOMParser).parseFromString(['<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">','  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>','  <xsl:strip-space elements="*"/>','  <xsl:template match="text()">','    <xsl:value-of select="normalize-space(.)"/>',"  </xsl:template>",'  <xsl:template match="node()|@*">',"    <xsl:copy>",'        <xsl:apply-templates select="node()|@*"/>',"    </xsl:copy>","  </xsl:template>","</xsl:stylesheet>"].join("\n"),"application/xml"),r=new XSLTProcessor;r.importStylesheet(n);const o=r.transformToDocument(t);return(new XMLSerializer).serializeToString(o)}nt.prototype={size(){return Object.keys(this.nodes).length},addNode(e,t){this.hasNode(e)||(this.nodes[e]=2===arguments.length?t:e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])},removeNode(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach((t=>{Object.keys(t).forEach((n=>{const r=t[n].indexOf(e);r>=0&&t[n].splice(r,1)}),this)})))},hasNode(e){return Object.prototype.hasOwnProperty.call(this.nodes,e)},getNodeData(e){if(this.hasNode(e))return this.nodes[e];throw new Error(`Node does not exist: ${e}`)},setNodeData(e,t){if(!this.hasNode(e))throw new Error(`Node does not exist: ${e}`);this.nodes[e]=t},addDependency(e,t){if(!this.hasNode(e))throw new Error(`Node does not exist: ${e}`);if(!this.hasNode(t))throw new Error(`Node does not exist: ${t}`);return-1===this.outgoingEdges[e].indexOf(t)&&this.outgoingEdges[e].push(t),-1===this.incomingEdges[t].indexOf(e)&&this.incomingEdges[t].push(e),!0},removeDependency(e,t){let n;this.hasNode(e)&&(n=this.outgoingEdges[e].indexOf(t),n>=0&&this.outgoingEdges[e].splice(n,1)),this.hasNode(t)&&(n=this.incomingEdges[t].indexOf(e),n>=0&&this.incomingEdges[t].splice(n,1))},clone(){const e=this,t=new nt;return Object.keys(e.nodes).forEach((n=>{t.nodes[n]=e.nodes[n],t.outgoingEdges[n]=e.outgoingEdges[n].slice(0),t.incomingEdges[n]=e.incomingEdges[n].slice(0)})),t},directDependenciesOf(e){if(this.hasNode(e))return this.outgoingEdges[e].slice(0);throw new Error(`Node does not exist: ${e}`)},directDependantsOf(e){if(this.hasNode(e))return this.incomingEdges[e].slice(0);throw new Error(`Node does not exist: ${e}`)},dependenciesOf(e,t){if(this.hasNode(e)){const n=[];tt(this.outgoingEdges,t,n,this.circular)(e);const r=n.indexOf(e);return r>=0&&n.splice(r,1),n}throw new Error(`Node does not exist: ${e}`)},dependantsOf(e,t){if(this.hasNode(e)){const n=[];tt(this.incomingEdges,t,n,this.circular)(e);const r=n.indexOf(e);return r>=0&&n.splice(r,1),n}throw new Error(`Node does not exist: ${e}`)},entryNodes(){const e=this;return Object.keys(this.nodes).filter((t=>0===e.incomingEdges[t].length))},overallOrder(e){const t=this,n=[],r=Object.keys(this.nodes);if(0===r.length)return n;if(!this.circular){const e=tt(this.outgoingEdges,!1,[],this.circular);r.forEach((t=>{e(t)}))}const o=tt(this.outgoingEdges,e,n,this.circular);return r.filter((e=>0===t.incomingEdges[e].length)).forEach((e=>{o(e)})),this.circular&&r.filter((e=>-1===n.indexOf(e))).forEach((e=>o(e))),n}},nt.prototype.directDependentsOf=nt.prototype.directDependantsOf,nt.prototype.dependentsOf=nt.prototype.dependantsOf;const ot="http://www.w3.org/2002/xforms",it=new Map,at=[];function st(e,t,n){return it.has(e)?it.get(e).set(t,n):it.set(e,new Map)}const ut=e=>{if(!e)return"http://www.w3.org/1999/xhtml"};function ct(e,t,n=null){t.nodeType===Node.TEXT_NODE&&(t=t.parentNode),t.nodeType===Node.ATTRIBUTE_NODE&&(t=t.ownerElement),t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(t=t.parentNode.host);const r=("fx-fore"===t.localName?t:t.closest("fx-fore")).querySelectorAll(`[id='${e}']`);if(1===r.length){const e=r[0];return n&&e.localName!==n?null:e}const o=Ve("outermost(ancestor-or-self::fx-fore[1]/(descendant::fx-fore|descendant::*[@id = $id]))[not(self::fx-fore)]",t,null,{id:e},{namespaceResolver:ut});if(0===o.length)return null;if(1===o.length&&Xe("(ancestor::fx-fore | ancestor::fx-repeat)[last()]/self::fx-fore",o[0],null,null,{namespaceResolver:ut})){const e=o[0];return n&&e.localName!==n?null:e}for(const e of Ve("ancestor::fx-repeatitem => reverse()",t,null,null,{namespaceResolver:ut})){const t=o.filter((t=>et.contains(e,t)));switch(t.length){case 0:break;case 1:{const e=t[0];return n&&e.localName!==n?null:e}default:{const e=t.find((e=>Ve("every $ancestor of ancestor::fx-repeatitem satisfies $ancestor is $ancestor/../child::fx-repeatitem[../@repeat-index]",e,null,{})));return e?n&&e.localName!==n?null:e:null}}}return null}const lt=(new DOMParser).parseFromString("<xml />","text/xml"),pt=new Map;function ht(e,t){const n=function(e,t){return it.has(e)&&it.get(e).get(t)||null}(e,t);if(n)return n;let r=function(e){if(!e.includes("instance"))return[];if(pt.has(e))return pt.get(e);const t=Je(e,{},lt),n=ze('descendant::xqx:functionCallExpr\n\t\t\t\t[xqx:functionName = "instance"]\n\t\t\t\t/xqx:arguments\n\t\t\t\t/xqx:stringConstantExpr\n\t\t\t\t/xqx:value',t,null,{},{namespaceResolver:e=>"xqx"===e?"http://www.w3.org/2005/XQueryX":void 0});return pt.set(e,n),n}(e);if(0===r.length){const n=t.parentNode&&t.parentNode.nodeType===t.ELEMENT&&t.parentNode.closest("[ref]");if(n){const r=ht(n.getAttribute("ref"),n);return st(e,t,r),r}r=["default"]}if(1===r.length){let n;if("default"===r[0]){const e=qe("ancestor-or-self::fx-fore[1]",t,null,null,{namespaceResolver:ut});n=e&&e.querySelector("fx-instance")}else n=ct(r[0],t,"fx-instance");if(n&&n.hasAttribute("xpath-default-namespace")){const r=n.getAttribute("xpath-default-namespace"),o=e=>{if(!e)return r};return st(e,t,o),o}}r.length;const o=Ye("ancestor-or-self::*/@xpath-default-namespace[last()]",t)||"",i=function(e){return""===e?o:Ye('ancestor-or-self::*/@*[name() = "xmlns:" || $prefix][last()]',t,null,{prefix:e})};return st(e,t,i),i}function dt(e,t,n){return(t&&t.ownerDocument||t)===window.document?ut:ht(e,n)}function ft({prefix:e,localName:t},n){switch(t){case"context":case"base64encode":case"boolean-from-string":case"current":case"depends":case"event":case"fore-attr":case"index":case"instance":case"log":case"parse":case"logtree":return{namespaceURI:ot,localName:t};default:return""===e&&at.includes(t)?{namespaceURI:"http://www.w3.org/2005/xquery-local-functions",localName:t}:"fn"===e||""===e?{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:t}:"local"===e?{namespaceURI:"http://www.w3.org/2005/xquery-local-functions",localName:t}:null}}function mt(e){let t=e;for(;t&&!("inScopeVariables"in t);)t=t.parentNode;if(!t)return{};const n={};if(t.inScopeVariables)for(const e of t.inScopeVariables.keys()){const r=t.inScopeVariables.get(e);r&&(r.nodeType?n[e]=r.value:n[e]=r)}return n}function gt(e,t,n,r={},o={}){const i=dt(e,t,n),a=mt(n);return je(e,t,null,{...a,...r},je.ALL_RESULTS_TYPE,{currentContext:{formElement:n,variables:r},moduleImports:{xf:ot},functionNameResolver:ft,namespaceResolver:i,language:o.language||gt.XPATH_3_1})}function yt(e,t,n){const r=dt(e,t,n),o=mt(n);return qe(e,t,null,o,{defaultFunctionNamespaceURI:ot,moduleImports:{xf:ot},currentContext:{formElement:n},functionNameResolver:ft,namespaceResolver:r})}function vt(e,t,n){const r=dt(e,t,n),o=mt(n);return Ve(e,t,null,o,{currentContext:{formElement:n},functionNameResolver:ft,moduleImports:{xf:ot},namespaceResolver:r})}function wt(e,t,n){const r=dt(e,t,n),o=mt(n);return Xe(e,t,null,o,{currentContext:{formElement:n},functionNameResolver:ft,moduleImports:{xf:ot},namespaceResolver:r})}function xt(e,t,n,r=null,o=n){const i=dt(e,t,n),a=mt(n);return Ye(e,t,r,a,{currentContext:{formElement:n},functionNameResolver:ft,moduleImports:{xf:ot},namespaceResolver:i})}function bt(e,t,n,r=null,o=n){const i=dt(e,t,n),a=mt(n);return $e(e,t,r,a,{currentContext:{formElement:n},functionNameResolver:ft,moduleImports:{xf:ot},namespaceResolver:i})}const At=(e,t)=>{const n=e.currentContext.formElement;if(t){const e=ct(t,n);if(e){if("FX-REPEAT"===e.nodeName){const{nodeset:t}=e;for(let r=n;r;r=r.parentNode)if(r.parentNode===e){return t[Array.from(r.parentNode.children).indexOf(r)]}}return e.nodeset}}const r=et.getParentBindingElement(n);return r?r.nodeset:n.getInScopeContext()};function Et(e,t){if(t&&t.nodeType===Node.ELEMENT_NODE&&t.children){const n=document.createElement("details");n.setAttribute("data-path",t.nodeName);const r=document.createElement("summary");let o,i=` <${t.nodeName}`;Array.from(t.attributes).forEach((e=>{i+=` ${e.nodeName}="${e.nodeValue}"`})),t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&""!==t.firstChild.data.trim()?(o=t.firstChild.nodeValue,i+=`>${o}</${t.nodeName}>`):i+=">",r.textContent=i,n.appendChild(r),0!==t.childElementCount?n.setAttribute("open","open"):r.setAttribute("style","list-style:none;"),e.appendChild(n),Array.from(t.children).forEach((e=>{Et(n,e)}))}}We({namespaceURI:ot,localName:"context"},[],"item()?",At),We({namespaceURI:ot,localName:"context"},["xs:string"],"item()?",At),We({namespaceURI:ot,localName:"current"},["xs:string"],"item()?",((e,t)=>(e.currentContext.formElement,null))),We({namespaceURI:ot,localName:"element"},["xs:string"],"item()?",((e,t)=>{e.currentContext.formElement;return document.createElement(t)})),We({namespaceURI:ot,localName:"log"},["xs:string?"],"xs:string?",((e,t)=>{const{formElement:n}=e.currentContext,r=ct(t,n,"fx-instance");if(r&&"json"!==r.getAttribute("type")){return rt((new XMLSerializer).serializeToString(r.getDefaultContext()))}return null})),We({namespaceURI:ot,localName:"fore-attr"},["xs:string?"],"xs:string?",((e,t)=>{const{formElement:n}=e.currentContext;let r=n;n.nodeType===Node.TEXT_NODE&&(r=n.parentNode);const o=r.closest("fx-fore");return o.hasAttribute(t)?o.getAttribute(t):null})),We({namespaceURI:ot,localName:"parse"},["xs:string?"],"element()?",((e,t)=>(new DOMParser).parseFromString(t,"application/xml").firstElementChild)),We({namespaceURI:ot,localName:"logtree"},["xs:string?"],"element()?",((e,t)=>{const{formElement:n}=e.currentContext,r=ct(t,n,"fx-instance");if(r){const t=document.createElement("div");t.setAttribute("class","logtree");const n=e.currentContext.formElement,o=n.querySelector(".logtree");o&&o.parentNode.removeChild(o);const i=Et(t,r.getDefaultContext());i&&n.appendChild(i)}return null}));const Nt=(e,t)=>{const n=qe("ancestor-or-self::fx-fore[1]",e.currentContext.formElement,null,null,{namespaceResolver:ut}),r=t?n.querySelector(`#${t}`):n.querySelector("fx-instance");return r?r.getDefaultContext():null};function Tt(e,t){const n=t.split(".");return 1==n.length?e[n[0]]:Tt(e[n[0]],n.slice(1).join("."))}function Bt(e){return e.closest("fx-fore")}function It(e,t){const n=et.getClosest("[ref]",e),r=et.getClosest("fx-fore",e),o=function(e){return Bt(e).getModel()}(e);if(null!==n){return r===n.closest("fx-fore")?n.nodeset:o.getDefaultInstance().getDefaultContext()}if(et.isAbsolutePath(t)){const e=et.getInstanceId(t);return e?o.getInstance(e).getDefaultContext():o.getDefaultInstance().getDefaultContext()}return o.getDefaultInstance().getDefaultContext()}function Ct(e,t){const n=function(e){return e&&e.nodeType&&e.nodeType===Node.ATTRIBUTE_NODE?e.ownerElement:e.nodeType===Node.ELEMENT_NODE?e:e.parentNode}(e);if("FX-FORE"===n.nodeName)return n.getModel().getDefaultInstance().getDefaultContext();const r=et.getClosest("[ref]",n.parentNode);if(r&&("FX-GROUP"===r.nodeName||"FX-CONTROL"===r.nodeName))return r.nodeset;const o=et.getClosest("fx-repeatitem",n);if(o)return"context"===e.nodeName?yt(e.nodeValue,o.nodeset,Bt(n)):o.nodeset;const i=n.closest(".fx-repeatitem");if(i){const e=i.parentNode,t=Array.from(e.children).indexOf(i);return et.getClosest("fx-repeat-attributes",n).nodeset[t]}if(n.hasAttribute("context")){const e=It(n.parentNode,t);return yt(n.getAttribute("context"),e,Bt(n))}if(e.nodeType===Node.ATTRIBUTE_NODE&&"context"===e.nodeName){const r=It(e.ownerElement.parentNode,t);return yt(e.ownerElement.getAttribute("context"),r,Bt(n))}if(e.nodeType===Node.ATTRIBUTE_NODE&&"ref"===e.nodeName){if(e.ownerElement.hasAttribute("context")){const r=It(e.ownerElement.parentNode,t);return yt(e.ownerElement.getAttribute("context"),r,Bt(n))}return It(n.parentNode,t)}return It(n,t)}We({namespaceURI:ot,localName:"index"},["xs:string?"],"xs:integer?",((e,t)=>{const{formElement:n}=e.currentContext;if(null===t)return 1;const r=ct(t,n,"fx-repeat");return r?r.getAttribute("index"):Number(1)})),We({namespaceURI:ot,localName:"instance"},[],"item()?",(e=>Nt(e,null))),We({namespaceURI:ot,localName:"instance"},["xs:string?"],"item()?",Nt),We({namespaceURI:ot,localName:"depends"},["node()*"],"item()?",((e,t)=>t[0])),We({namespaceURI:ot,localName:"event"},["xs:string?"],"item()?",((e,t)=>{if(!t)return null;for(let n=e.currentContext.formElement;n;n=n.parentNode)if(n.currentEvent)return n.currentEvent.detail&&"object"==typeof n.currentEvent.detail&&t in n.currentEvent.detail?n.currentEvent.detail[t]:t.includes(".")?Tt(n.currentEvent,t):n.currentEvent[t]||null;return null})),Ke(`\n    module namespace xf="${ot}";\n\n    declare %public function xf:boolean-from-string($str as xs:string) as xs:boolean {\n        lower-case($str) = "true" or $str = "1"\n    };\n`),We({namespaceURI:ot,localName:"base64encode"},["xs:string?"],"xs:string?",((e,t)=>btoa(t)));class St{static getDomNodeIndexString(e){const t=[];let n=e;for(;n&&n.parentNode;){const e=n.parentNode;if(e.childNodes&&e.childNodes.length>0){const r=[...e.childNodes].indexOf(n);t.unshift(r)}n=e}return t.join(".")}static getFore(e){return e.nodeType===Node.TEXT_NODE?e.parentNode.closest("fx-fore"):e.closest("fx-fore")}static get ACTION_ELEMENTS(){return["FX-ACTION","FX-DELETE","FX-DISPATCH","FX-HIDE","FX-INSERT","FX-LOAD","FX-MESSAGE","FX-REBUILD","FX-RECALCULATE","FX-REFRESH","FX-RENEW","FX-RELOAD","FX-REPLACE","FX-RESET","FX-RETAIN","FX-RETURN","FX-REVALIDATE","FX-SEND","FX-SETFOCUS","FX-SETINDEX","FX-SETVALUE","FX-SHOW","FX-TOGGLE","FX-UPDATE"]}static createUUID(){const e=[],t="0123456789abcdef";for(let n=0;n<36;n+=1)e[n]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";return e.join("")}static get XFORMS_NAMESPACE_URI(){return"http://www.w3.org/2002/xforms"}static isActionElement(e){return St.ACTION_ELEMENTS.includes(e)}static get UI_ELEMENTS(){return["FX-ALERT","FX-CONTROL","FX-DIALOG","FX-FILENAME","FX-MEDIATYPE","FX-GROUP","FX-HINT","FX-ITEMS","FX-OUTPUT","FX-RANGE","FX-REPEAT","FX-REPEATITEM","FX-REPEAT-ATTRIBUTES","FX-SWITCH","FX-SECRET","FX-SELECT","FX-SUBMIT","FX-TEXTAREA","FX-TRIGGER","FX-UPLOAD","FX-VAR"]}static get MODEL_ELEMENTS(){return["FX-BIND","FX-FUNCTION","FX-MODEL","FX-INSTANCE","FX-SUBMISSION"]}static isUiElement(e){return St.UI_ELEMENTS.includes(e),St.UI_ELEMENTS.includes(e)}static async refreshChildren(e,t){return new Promise((n=>{const{children:r}=e;r&&Array.from(r).forEach((e=>{"FX-FORE"===e.nodeName.toUpperCase()&&n("done"),St.isUiElement(e.nodeName)&&"function"==typeof e.refresh?e.refresh(t):"FX-MODEL"!==e.nodeName.toUpperCase()&&St.refreshChildren(e,t)})),n("done")}))}static copyDom(e){const t=(new DOMParser).parseFromString("<fx-fore></fx-fore>","text/html").querySelector("fx-fore");return this.convertFromSimple(e,t),t.removeAttribute("convert"),t}static convertFromSimple(e,t){const n=e.childNodes;n&&Array.from(n).forEach((e=>{const n=`FX-${e.nodeName.toUpperCase()}`;if(St.MODEL_ELEMENTS.includes(n)||St.UI_ELEMENTS.includes(n)||St.ACTION_ELEMENTS.includes(n)){const r=t.ownerDocument.createElement(n);t.appendChild(r),St.copyAttributes(e,r),St.convertFromSimple(e,r)}else{if(e.nodeType===Node.TEXT_NODE){const n=t.ownerDocument.createTextNode(e.textContent);t.appendChild(n)}if(e.nodeType===Node.ELEMENT_NODE){const n=t.ownerDocument.createElement(e.nodeName);t.appendChild(n),St.copyAttributes(e,t),St.convertFromSimple(e,n)}}}))}static copyAttributes(e,t){return Array.from(e.attributes).forEach((e=>{t.setAttribute(e.nodeName,e.nodeValue)}))}static getContentType(e,t){return"application/x-www-form-urlencoded"===t?"application/x-www-form-urlencoded; charset=UTF-8":"xml"===e.type?"application/xml; charset=UTF-8":"json"===e.type?"application/json":null}static async handleResponse(e){const{status:t}=e;if(t>=400)throw alert(`response status:  ${t} - failed to load data for '${this.src}' - stopping.`),new Error(`failed to load data - status: ${t}`);const n=e.headers.get("content-type").toLowerCase();if(n.startsWith("text/html"))return e.text().then((e=>(new DOMParser).parseFromString(e,"text/html")));if(n.startsWith("text/plain")||n.startsWith("text/markdown"))return e.text();if(n.startsWith("application/json"))return e.json();if(n.startsWith("application/xml")){const t=await e.text();return(new DOMParser).parseFromString(t,"application/xml")}return"done"}static evaluateAttributeTemplateExpression(e,t){const n=e.match(/{[^}]*}/g);return n&&n.forEach((n=>{const r=n.substring(1,n.length-1),o=xt(r,Ct(t,r),t.getOwnerForm()),i=e.replaceAll(n,o);e=i})),e}static fadeInElement(e){let t=()=>(e.getAnimations&&e.getAnimations().map((e=>e.finish())),t=e.animate({opacity:[0,1]},600),t.finished);return t()}static fadeOutElement(e,t){let n=()=>(e.getAnimations&&e.getAnimations().map((e=>e.finish())),n=e.animate({opacity:[1,0]},t),n.finished);return n()}static async dispatch(e,t,n){if(!et.contains(e?.ownerDocument,e))return;const r=new CustomEvent(t,{composed:!1,bubbles:!0,detail:n});r.listenerPromises=[],e.dispatchEvent(r),r.listenerPromises.length&&await Promise.all(r.listenerPromises)}static formatXml(e){for(var t=(e=e.replace(/(>)(<)(\/*)/g,"$1\n$2$3").replace(/ *(.*) +\n/g,"$1\n").replace(/(<.+>)(.+\n)/g,"$1\n$2")).split("\n"),n=0;n<t.length;n++){var r=t[n];Boolean(r.match(/<.+\/>/)),Boolean(r.match(/<\/.+>/)),Boolean(r.match(/<[^!].*>/))}}static async loadForeFromUrl(e,t){await fetch(t,{method:"GET",mode:"cors",credentials:"include",headers:{"Content-Type":"text/html"}}).then((e=>e.headers.get("content-type").toLowerCase().startsWith("text/html")?e.text().then((e=>(new DOMParser).parseFromString(e,"text/html"))):"done")).then((t=>{const n=t.querySelector("fx-fore");n||e.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,detail:{message:"cyclic graph"}}));const r=document.importNode(n,!0);r.addEventListener("model-construct-done",(t=>{const n=r.querySelector("fx-instance");if(e.initialNode){const t=(new DOMParser).parseFromString("<data></data>","application/xml");t.firstElementChild.appendChild(e.initialNode.cloneNode(!0)),n.setInstanceData(t)}return r.getModel().updateModel(),r.refresh(),"done"}),{once:!0});const o=e.querySelector("input");e.hasAttribute("shadow")?(o.parentNode.removeChild(o),e.shadowRoot.appendChild(r)):o.replaceWith(r)}))}}St.READONLY_DEFAULT=!1,St.REQUIRED_DEFAULT=!1,St.RELEVANT_DEFAULT=!0,St.CONSTRAINT_DEFAULT=!0,St.TYPE_DEFAULT="xs:string";class Ot extends HTMLElement{constructor(){super(),this.model=this.parentNode,this.attachShadow({mode:"open"})}connectedCallback(){this.hasAttribute("src")&&(this.src=this.getAttribute("src")),this.hasAttribute("id")?this.id=this.getAttribute("id"):this.id="default",this.hasAttribute("type")?this.type=this.getAttribute("type"):(this.type="xml",this.setAttribute("type",this.type));this.shadowRoot.innerHTML="\n            <style>\n                \n            :host {\n                display: none;\n            }\n            :host * {\n                display:none;\n            }\n            ::slotted(*){\n                display:none;\n            }\n        \n            </style>\n            \n        \n        "}async init(){return await this._initInstance(),this.dispatchEvent(new CustomEvent("instance-loaded",{composed:!0,bubbles:!0,detail:{instance:this}})),this}reset(){this._useInlineData()}evalXPath(e){const t=this.parentElement.parentElement;return yt(e,this.getDefaultContext(),t)}getInstanceData(){return this.instanceData||this.createInstanceData(),this.instanceData}setInstanceData(e){e?this.instanceData=e:this.createInstanceData()}getDefaultContext(){return"xml"===this.type?this.instanceData.firstElementChild:this.instanceData}async _initInstance(){if("#querystring"===this.src){const e=new URLSearchParams(location.search),t=(new DOMParser).parseFromString("<data></data>","application/xml"),n=t.firstElementChild;for(const r of e){const e=t.createElement(r[0]);e.appendChild(t.createTextNode(r[1])),n.appendChild(e)}this.instanceData=t}else this.src?await this._loadData():0!==this.childNodes.length&&this._useInlineData()}createInstanceData(){if("xml"===this.type){const e=(new DOMParser).parseFromString("<data></data>","application/xml");this.instanceData=e}"json"===this.type&&(this.instanceData={})}async _loadData(){const e=`${this.src}`;if(e.startsWith("localStore")){const t=e.substring(e.indexOf(":")+1),n=(new DOMParser).parseFromString("<data></data>","application/xml");if(this.instanceData=n,!t)return;const r=localStorage.getItem(t);if(!r)return void this._useInlineData();const o=(new DOMParser).parseFromString(r,"application/xml");return void n.firstElementChild.replaceWith(o.firstElementChild)}const t=St.getContentType(this,"get");try{const n=await fetch(e,{method:"GET",headers:{"Content-Type":t}}),r=await async function(e){const{status:t}=e;if(t>=400)throw alert(`response status:  ${t} - failed to load data for '${this.src}' - stopping.`),new Error(`failed to load data - status: ${t}`);const n=e.headers.get("content-type").toLowerCase();if(n.startsWith("text/html"))return e.text().then((e=>(new DOMParser).parseFromString(e,"text/html")));if(n.startsWith("text/plain")||n.startsWith("text/markdown"))return e.text();if(n.startsWith("application/json"))return e.json();if(n.startsWith("application/xml")||n.startsWith("text/xml")){const t=await e.text();return(new DOMParser).parseFromString(t,"application/xml")}throw new Error(`unable to handle response content type: ${n}`)}(n);if(r.nodeType)return void(this.instanceData=r);this.instanceData=r}catch(e){throw new Error(`failed loading data ${e}`)}}_getContentType(){return"xml"===this.type?"application/xml":"json"===this.type?"application/json":null}_useInlineData(){if("xml"===this.type){const e=(new DOMParser).parseFromString(this.innerHTML,"application/xml");this.instanceData=e}else"json"===this.type?this.instanceData=JSON.parse(this.textContent):"html"===this.type?this.instanceData=this.firstElementChild.children:"text"===this.type&&(this.instanceData=this.textContent)}}customElements.get("fx-instance")||customElements.define("fx-instance",Ot);class kt{constructor(e,t,n,r,o,i,a,s,u){this.path=e,this.ref=t,this.constraint=i,this.readonly=n,this.relevant=r,this.required=o,this.type=a,this.node=s,this.bind=u,this.changed=!1,this.alerts=[],this.boundControls=[]}get value(){return this.node.nodeType?this.node.nodeType===Node.ATTRIBUTE_NODE?this.node.nodeValue:this.node.textContent:this.node}set value(e){e.nodeType===Node.DOCUMENT_NODE?this.node.replaceWith(e.firstElementChild):e.nodeType===Node.ELEMENT_NODE?this.node.replaceWith(e):this.node.nodeType===Node.ATTRIBUTE_NODE?this.node.nodeValue=e:this.node.textContent=e}addAlert(e){this.alerts.includes(e)||this.alerts.push(e)}cleanAlerts(){this.alerts=[]}}class Dt extends HTMLElement{constructor(){super(),this.instances=[],this.modelItems=[],this.defaultContext={},this.changed=[],this.inited=!1,this.modelConstructed=!1,this.attachShadow({mode:"open"}),this.computes=0}get formElement(){return this.parentElement}connectedCallback(){this.shadowRoot.innerHTML="\n            <slot></slot>\n        ",this.addEventListener("model-construct-done",(()=>{this.modelConstructed=!0}),{once:!0}),this.skipUpdate=!1}static lazyCreateModelItem(e,t,n){let r,o={};if(null==n)return null;o=n.nodeType===n.TEXT_NODE?n.parentNode:n,n.nodeType?r=et.getPath(n):(r=null,o=n);const i=new kt(r,t,St.READONLY_DEFAULT,St.RELEVANT_DEFAULT,St.REQUIRED_DEFAULT,St.CONSTRAINT_DEFAULT,St.TYPE_DEFAULT,o,this);return e.registerModelItem(i),i}async modelConstruct(){St.dispatch(this,"model-construct",{model:this});const e=this.querySelectorAll("fx-instance");if(e.length>0){const t=[];e.forEach((e=>{t.push(e.init())})),await Promise.all(t),this.instances=Array.from(e),await St.dispatch(this,"model-construct-done",{model:this}),this.inited=!0,this.updateModel()}else await this.dispatchEvent(new CustomEvent("model-construct-done",{composed:!1,bubbles:!0,detail:{model:this}}));this.inited=!0}registerModelItem(e){this.modelItems.push(e)}updateModel(){this.rebuild(),this.recalculate(),this.revalidate()}rebuild(){this.mainGraph=new nt(!1),this.modelItems=[];const e=this.querySelectorAll("fx-model > fx-bind");0!==e.length?(e.forEach((e=>{e.init(this)})),St.dispatch(this,"rebuild-done",{maingraph:this.mainGraph})):this.skipUpdate=!0}recalculate(){if(this.mainGraph)if(this.computes=0,this.subgraph=new nt(!1),0!==this.changed.length){this.changed.forEach((e=>{if(this.subgraph.addNode(e.path,e.node),this.mainGraph.hasNode(e.path)){const t=this.mainGraph.dependantsOf(e.path,!1).reverse();0!==t.length&&t.forEach((t=>{const n=this.mainGraph.getNodeData(t);if(this.subgraph.addNode(t,n),t.includes(":")){const r=t.substring(0,t.indexOf(":"));this.subgraph.addNode(r,n);0!==this.mainGraph.dependentsOf(e.path,!1).indexOf(t)&&this.subgraph.addDependency(t,e.path)}}))}}));this.subgraph.overallOrder(!1).forEach((e=>{if(this.mainGraph.hasNode(e)){const t=this.mainGraph.getNodeData(e);this.compute(t,e)}}));const e=[...this.changed];this.formElement.toRefresh=e,this.changed=[],St.dispatch(this,"recalculate-done",{graph:this.subgraph})}else{this.mainGraph.overallOrder(!1).forEach((e=>{const t=this.mainGraph.getNodeData(e);this.compute(t,e)})),St.dispatch(this,"recalculate-done",{graph:this.mainGraph})}}compute(e,t){const n=this.getModelItem(e);if(n&&t.includes(":")){const e=t.split(":")[1];if(e)if("calculate"===e){const t=gt(n.bind[e],n.node,this);n.value=t,n.readonly=!0}else if("constraint"!==e&&"type"!==e){const t=n.bind[e];if(t){const r=wt(t,n.node,this);n[e]=r}}this.computes+=1}}revalidate(){if(0===this.modelItems.length)return!0;let e=!0;return this.modelItems.forEach((t=>{const{bind:n}=t;if(n){if("function"==typeof n.hasAttribute&&n.hasAttribute("constraint")){const r=n.getAttribute("constraint");if(r){const n=wt(r,t.node,this);t.constraint=n,this.formElement.addToRefresh(t),n||(e=!1)}}if("function"==typeof n.hasAttribute&&n.hasAttribute("required")){const r=n.getAttribute("required");if(r){const n=wt(r,t.node,this);t.required=n,this.formElement.addToRefresh(t),t.node.textContent||(e=!1)}}}})),e}addChanged(e){this.inited&&this.changed.push(e)}getModelItem(e){return this.modelItems.find((t=>t.node===e))}getDefaultContext(){return this.instances[0].getDefaultContext()}getDefaultInstance(){return this?.instances[0]}getDefaultInstanceData(){return this.instances[0].instanceData}getInstance(e){const t=Array.from(this.instances).find((t=>t.id===e));return t||this.getDefaultInstance()}evalBinding(e){return this.instances[0].evalXPath(e)}}Dt.dataChanged=!1,customElements.get("fx-model")||customElements.define("fx-model",Dt);const Rt=e=>class extends e{static get properties(){return{context:{type:Object},model:{type:Object},modelItem:{type:Object},nodeset:{type:Object},ref:{type:String},inScopeVariables:{type:Map}}}constructor(){super(),this.context=null,this.model=null,this.modelItem={},this.ref=this.hasAttribute("ref")?this.getAttribute("ref"):"",this.inScopeVariables=new Map}getModel(){if(this.model)return this.model;return this.getOwnerForm().querySelector("fx-model")}getOwnerForm(){let e=this;for(;e&&e.parentNode;){if("FX-FORE"===e.nodeName.toUpperCase())return e;e=e.parentNode instanceof DocumentFragment?e.parentNode.host:e.parentNode}return e}evalInContext(){if(!this.getModel())return;let e;if(this.hasAttribute("context")&&(e=Ct(this.getAttributeNode("context")||this,this.context)),this.hasAttribute("ref")&&(e=Ct(this.getAttributeNode("ref")||this,this.ref)),e||0===this.getModel().instances.length||(e=this.getModel().getDefaultInstance().getDefaultContext()),""===this.ref)this.nodeset=e;else if(Array.isArray(e))this.nodeset=gt(this.ref,e[0],this);else{if(!e)return;const{nodeType:t}=e;t&&!et.isAbsolutePath(this.ref)?this.nodeset=yt(this.ref,e,this):[this.nodeset]=gt(this.ref,e,this)}}evaluateAttributeTemplateExpression(e,t){const n=e.match(/{[^}]*}/g);return n&&n.forEach((n=>{const r=n.substring(1,n.length-1),o=xt(r,Ct(t,r),this),i=e.replaceAll(n,o);e=i})),e}isNotBound(){return!this.hasAttribute("ref")}isBound(){return this.hasAttribute("ref")}getBindingExpr(){if(this.hasAttribute("ref"))return this.getAttribute("ref");const e=et.getClosest("[ref]",this.parentNode);return e?e.getAttribute("ref"):"instance()"}getInstance(){if(this.ref.startsWith("instance(")){const e=et.getInstanceId(this.ref);return this.getModel().getInstance(e)}return this.getModel().getInstance("default")}_getParentBindingElement(e){if(e.parentNode.host){const{host:t}=e.parentNode;if(t.hasAttribute("ref"))return t}else if(e.parentNode){if(e.parentNode.hasAttribute("ref"))return this.parentNode;this._getParentBindingElement(this.parentNode)}return null}getModelItem(){const e=this.getModel().getModelItem(this.nodeset);e&&(this.modelItem=e);const t=et.getClosest("fx-repeatitem",this);let n;if(t){const{index:e}=t;n=Array.isArray(this.nodeset)?this.getModel().getModelItem(this.nodeset[e-1]):this.getModel().getModelItem(this.nodeset)}else n=this.getModel().getModelItem(this.nodeset);return n||Dt.lazyCreateModelItem(this.getModel(),this.ref,this.nodeset)}getValue(){if(this.hasAttribute("value")){const e=this.getAttribute("value");try{return xt(e,Ct(this,e),this.getOwnerForm())}catch(e){St.dispatch(this,"error",{message:e})}}return this.textContent?this.textContent:null}getInScopeContext(){return Ct(this.getAttributeNode("ref")||this,this.ref)}setInScopeVariables(e){this.inScopeVariables=e}};class Mt extends(Rt(HTMLElement)){constructor(){super(),this.nodeset=[],this.model={},this.contextNode={},this.inited=!1}connectedCallback(){this.ref=this.getAttribute("ref"),this.readonly=this.getAttribute("readonly"),this.required=this.getAttribute("required"),this.relevant=this.getAttribute("relevant"),this.type=this.hasAttribute("type")?this.getAttribute("type"):Mt.TYPE_DEFAULT,this.calculate=this.getAttribute("calculate")}init(e){this.model=e,this.instanceId=this._getInstanceId(),this.bindType=this.getModel().getInstance(this.instanceId).type,"xml"===this.bindType&&(this._evalInContext(),this._buildBindGraph(),this._createModelItems()),this._processChildren(e)}_buildBindGraph(){"xml"===this.bindType&&this.nodeset.forEach((e=>{const t=et.getPath(e);this.model.mainGraph.addNode(t,e),this.calculate&&(this.model.mainGraph.addNode(`${t}:calculate`,e),this.model.mainGraph.addDependency(t,`${t}:calculate`));const n=this._getReferencesForProperty(this.calculate,e);if(0!==n.length&&this._addDependencies(n,e,t,"calculate"),!this.calculate){const n=this._getReferencesForProperty(this.readonly,e);0!==n.length?this._addDependencies(n,e,t,"readonly"):this.readonly&&this.model.mainGraph.addNode(`${t}:readonly`,e)}const r=this._getReferencesForProperty(this.required,e);0!==r.length?this._addDependencies(r,e,t,"required"):this.required&&this.model.mainGraph.addNode(`${t}:required`,e);const o=this._getReferencesForProperty(this.relevant,e);0!==o.length?this._addDependencies(o,e,t,"relevant"):this.relevant&&this.model.mainGraph.addNode(`${t}:relevant`,e);const i=this._getReferencesForProperty(this.constraint,e);0!==i.length?this._addDependencies(i,e,t,"constraint"):this.constraint&&this.model.mainGraph.addNode(`${t}:constraint`,e)}))}_addDependencies(e,t,n,r){const o=`${n}:${r}`;0!==e.length?(this.model.mainGraph.hasNode(o)||this.model.mainGraph.addNode(o,t),e.forEach((e=>{const t=et.getPath(e);t.endsWith("text()[1]")||(this.model.mainGraph.hasNode(t)||this.model.mainGraph.addNode(t,e),this.model.mainGraph.addDependency(o,t))}))):this.model.mainGraph.addNode(o,t)}_processChildren(e){const t=this.querySelectorAll(":scope > fx-bind");Array.from(t).forEach((t=>{t.init(e)}))}getAlert(){if(this.hasAttribute("alert"))return this.getAttribute("alert");const e=this.querySelector("fx-alert");return e?e.innerHTML:null}_evalInContext(){const e=Ct(this.getAttributeNode("ref")||this,this.ref);if(this.nodeset=[],""===this.ref||null===this.ref)this.nodeset=e;else if(Array.isArray(e))e.forEach((t=>{if(et.isSelfReference(this.ref))this.nodeset=e;else if(this.ref){vt(this.ref,t,this).forEach((e=>{this.nodeset.push(e)}))}}));else{"xml"===this.getModel().getInstance(this.instanceId).type?this.nodeset=vt(this.ref,e,this):this.nodeset=this.ref}}_createModelItems(){Array.isArray(this.nodeset)?Array.from(this.nodeset).forEach((e=>{this._createModelItem(e)})):this._createModelItem(this.nodeset)}_createModelItem(e){if(et.isSelfReference(this.ref)){const e=et.getClosest("fx-bind[ref]",this.parentElement);return void(e&&(e.required=this.required))}const t=e,n=et.getPath(e),r=new kt(n,this.getBindingExpr(),Mt.READONLY_DEFAULT,Mt.RELEVANT_DEFAULT,Mt.REQUIRED_DEFAULT,Mt.CONSTRAINT_DEFAULT,this.type,t,this),o=this.getAlert();o&&r.addAlert(o),this.getModel().registerModelItem(r)}_getReferencesForProperty(e){return e?this.getReferences(e):[]}getReferences(e){const t=new Set,n=new Ze((e=>t.add(e)));return this.nodeset.forEach((t=>{xt(e,t,this,n)})),Array.from(t.values())}_initBooleanModelItemProperty(e,t){return wt(this[e],t,this)}static shortenPath(e){const t=e.split("/");let n="";for(let e=2;e<t.length;e+=1){const r=t[e];if(-1!==r.indexOf("{}")){n+=`/${r.split("{}")[1]}`}else n+=`/${r}`}return n}_getInstanceId(){const e=this.getBindingExpr();return e.startsWith("instance(")?(this.instanceId=et.getInstanceId(e),this.instanceId):this.instanceId?this.instanceId:"default"}}Mt.READONLY_DEFAULT=!1,Mt.REQUIRED_DEFAULT=!1,Mt.RELEVANT_DEFAULT=!0,Mt.CONSTRAINT_DEFAULT=!0,Mt.TYPE_DEFAULT="xs:string",customElements.get("fx-bind")||customElements.define("fx-bind",Mt)
/*!
 * Toastify js 1.11.2
 * https://github.com/apvarun/toastify-js
 * @license MIT licensed
 *
 * Copyright (C) 2018 Varun A P
 */;class Ut{constructor(e){this.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,style:{background:""}},this.version="1.11.2",this.options={},this.toastElement=null,this._rootElement=document.body,this._init(e)}showToast(){if(this.toastElement=this._buildToast(),"string"==typeof this.options.selector?this._rootElement=document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||this.options.selector instanceof ShadowRoot?this._rootElement=this.options.selector:this._rootElement=document.body,!this._rootElement)throw"Root element is not defined";return this._rootElement.insertBefore(this.toastElement,this._rootElement.firstChild),this._reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout((()=>{this._removeElement(this.toastElement)}),this.options.duration)),this}hideToast(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this._removeElement(this.toastElement)}_init(e){this.options=Object.assign(this.defaults,e),this.options.backgroundColor,this.toastElement=null,this.options.gravity="bottom"===e.gravity?"toastify-bottom":"toastify-top",this.options.stopOnFocus=void 0===e.stopOnFocus||e.stopOnFocus,e.backgroundColor&&(this.options.style.background=e.backgroundColor)}_buildToast(){if(!this.options)throw"Toastify is not initialized";let e=document.createElement("div");e.className=`toastify on ${this.options.className}`,e.className+=` toastify-${this.options.position}`,e.className+=` ${this.options.gravity}`;for(const t in this.options.style)e.style[t]=this.options.style[t];if(this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)e.appendChild(this.options.node);else if(this.options.escapeMarkup?e.innerText=this.options.text:e.innerHTML=this.options.text,""!==this.options.avatar){let t=document.createElement("img");t.src=this.options.avatar,t.className="toastify-avatar","left"==this.options.position?e.appendChild(t):e.insertAdjacentElement("afterbegin",t)}if(!0===this.options.close){let t=document.createElement("span");t.innerHTML="&#10006;",t.className="toast-close",t.addEventListener("click",(e=>{e.stopPropagation(),this._removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}));const n=window.innerWidth>0?window.innerWidth:screen.width;"left"==this.options.position&&n>360?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}if(this.options.stopOnFocus&&this.options.duration>0&&(e.addEventListener("mouseover",(t=>{window.clearTimeout(e.timeOutValue)})),e.addEventListener("mouseleave",(()=>{e.timeOutValue=window.setTimeout((()=>{this._removeElement(e)}),this.options.duration)}))),void 0!==this.options.destination&&e.addEventListener("click",(e=>{e.stopPropagation(),!0===this.options.newWindow?window.open(this.options.destination,"_blank"):window.location=this.options.destination})),"function"==typeof this.options.onClick&&void 0===this.options.destination&&e.addEventListener("click",(e=>{e.stopPropagation(),this.options.onClick()})),"object"==typeof this.options.offset){const t=this._getAxisOffsetAValue("x",this.options),n=this._getAxisOffsetAValue("y",this.options),r="left"==this.options.position?t:`-${t}`,o="toastify-top"==this.options.gravity?n:`-${n}`;e.style.transform=`translate(${r},${o})`}return e}_removeElement(e){e.className=e.className.replace(" on",""),window.setTimeout((()=>{this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),e.parentNode&&e.parentNode.removeChild(e),this.options.callback.call(e),this._reposition()}),400)}_reposition(){let e,t={top:15,bottom:15},n={top:15,bottom:15},r={top:15,bottom:15},o=this._rootElement.querySelectorAll(".toastify");for(let i=0;i<o.length;i++){e=!0===o[i].classList.contains("toastify-top")?"toastify-top":"toastify-bottom";let a=o[i].offsetHeight;e=e.substr(9,e.length-1);let s=15;(window.innerWidth>0?window.innerWidth:screen.width)<=360?(o[i].style[e]=`${r[e]}px`,r[e]+=a+s):!0===o[i].classList.contains("toastify-left")?(o[i].style[e]=`${t[e]}px`,t[e]+=a+s):(o[i].style[e]=`${n[e]}px`,n[e]+=a+s)}}_getAxisOffsetAValue(e,t){return t.offset[e]?isNaN(t.offset[e])?t.offset[e]:`${t.offset[e]}px`:"0px"}}function Ft(e){return new Ut(e)}class Gt extends HTMLElement{static get properties(){return{avatar:{type:String},backgroundColor:{type:String},callback:{type:String},classProp:{type:String},close:{type:Boolean},destination:{type:String},duration:{type:Number},escapeMarkup:{type:Boolean},gravity:{type:String},newWindow:{type:Boolean},oldestFirst:{type:Boolean},position:{type:String},selector:{type:String},stopOnFocus:{type:Boolean},text:{type:String}}}constructor(){super(),this.attachShadow({mode:"open"})}_initVar(e,t){return this.hasAttribute(e)?this.getAttribute(e):t}connectedCallback(){this.avatar=this._initVar("avatar",""),this.backgroundColor=this._initVar("backgroundColor",""),this.callback=this._initVar("callback",{}),this.classProp=this._initVar("data-class",""),this.close="true"===this._initVar("close",!1),this.destination=this._initVar("destination",void 0),this.duration=Number(this._initVar("duration",3e3)),this.escapeMarkup="true"===this._initVar("escapeMarkup",!0),this.gravity=this._initVar("gravity","top"),this.newWindow="true"===this._initVar("newWindow",!1),this.offSet=this._initVar("offSet",{}),this.oldestFirst="true"===this._initVar("oldestFirst",!0),this.position=this._initVar("position","right"),this.stopOnFocus=this._initVar("stopOnFocus",!0),this.text=this._initVar("text","");this.shadowRoot.innerHTML=`\n        <style>\n            \n        :host{\n            display:none;\n        }\n    \n        </style>\n        ${this.renderHTML}\n    `,this.addEventListener("jinn-toast",(e=>{this.showToast(e.detail.text)}))}disconnectedCallback(){this.removeEventListener("jinn-toast",this.showToast)}showToast(e){new Ft({avatar:this.avatar,className:this.classProp,close:this.close,destination:this.destination,duration:this.duration,escapeMarkup:this.escapeMarkup,gravity:this.gravity,newWindow:!1,offset:this.offset,oldestFirst:this.oldestFirst,position:this.position,node:this.shadowRoot,stopOnFocus:this.stopOnFocus,text:e}).showToast()}renderHTML(){return"\n      <slot></slot>\n    "}}customElements.get("jinn-toast")||window.customElements.define("jinn-toast",Gt);class Lt extends(Rt(HTMLElement)){static get properties(){return{...super.properties,index:{type:Number},template:{type:Object},focusOnCreate:{type:String},initDone:{type:Boolean},repeatIndex:{type:Number},repeatSize:{type:Number},nodeset:{type:Array}}}constructor(){super(),this.ref="",this.dataTemplate=[],this.focusOnCreate="",this.initDone=!1,this.repeatIndex=1,this.nodeset=[],this.inited=!1,this.host={},this.index=1,this.repeatSize=0,this.attachShadow({mode:"open",delegatesFocus:!0})}get repeatSize(){return this.querySelectorAll(":scope > .fx-repeatitem").length}set repeatSize(e){super.repeatSize=e}setIndex(e){this.index=e;const t=this.querySelector("[data-ref]").querySelectorAll(":scope > *");this.applyIndex(t[this.index-1])}applyIndex(e){this._removeIndexMarker(),e&&e.setAttribute("repeat-index","")}get index(){return this.getAttribute("index")}set index(e){this.setAttribute("index",e)}_getRepeatedItems(){return this.querySelector("[data-ref]").children}async connectedCallback(){this.ref=this.getAttribute("ref"),this.addEventListener("item-changed",(e=>{const{item:t}=e.detail,n=this._getRepeatedItems(),r=Array.from(n).indexOf(t);this.applyIndex(n[r]),this.index=r+1})),document.addEventListener("index-changed",(e=>{if(e.stopPropagation(),!e.target===this)return;const{index:t}=e.detail;this.index=Number(t),this.applyIndex(this.children[t-1])})),this.mutationObserver=new MutationObserver((e=>{if("childList"===e[0].type){const t=e[0].addedNodes[0];if(t){const e=et.getPath(t);St.dispatch(this,"path-mutated",{path:e,index:this.index})}}})),this.getOwnerForm().registerLazyElement(this);this.shadowRoot.innerHTML="\n            <style>\n                \n      :host{\n      }\n       .fade-out-bottom {\n          -webkit-animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n          animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n      }\n      .fade-out-bottom {\n          -webkit-animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n          animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n      }\n   \n            </style>\n            \n          <slot></slot>\n    \n        "}async init(){return new Promise((e=>{this._evalNodeset(),this._initTemplate(),this.setAttribute("index",this.index),this.inited=!0,e("done")}))}_getRef(){return this.getAttribute("ref")}_evalNodeset(){const e=Ct(this.getAttributeNode("ref")||this,this.ref);this.mutationObserver&&e.nodeName&&this.mutationObserver.observe(e,{childList:!0,subtree:!0});const t=gt(this.ref,e,this);1===t.length&&Array.isArray(t[0])?this.nodeset=t[0]:this.nodeset=t}async refresh(e){this.inited||this.init(),this._evalNodeset();let t=this.querySelectorAll(".fx-repeatitem"),n=t.length,r=1;Array.isArray(this.nodeset)&&(r=this.nodeset.length);const o=r;if(o<n)for(let e=n;e>o;e-=1){const n=t[e-1];n.parentNode.removeChild(n),this.getOwnerForm().unRegisterLazyElement(n),this.getOwnerForm().someInstanceDataStructureChanged=!0}if(o>n)for(let e=n+1;e<=o;e+=1){const t=this._clone();if(!t)return;this.querySelector("[data-ref]").appendChild(t),t.classList.add("fx-repeatitem"),t.setAttribute("index",e),t.addEventListener("click",this._dispatchIndexChange),t.addEventListener("focusin",this._dispatchIndexChange),this.getOwnerForm().someInstanceDataStructureChanged=!0}t=this.querySelectorAll(":scope > .fx-repeatitem"),n=t.length;for(let e=0;e<n;e+=1){const n=t[e];this.getOwnerForm().registerLazyElement(n),n.nodeset!==this.nodeset[e]&&(n.nodeset=this.nodeset[e])}this.getOwnerForm().lazyRefresh&&!e||St.refreshChildren(this,e),this.setIndex(this.index)}_dispatchIndexChange(){this.dispatchEvent(new CustomEvent("item-changed",{composed:!1,bubbles:!0,detail:{item:this,index:this.index}}))}_fadeOut(e){e.style.opacity=1,function t(){(e.style.opacity-=.1)<0?e.style.display="none":requestAnimationFrame(t)}()}_fadeIn(e){e&&(e.style.opacity=0,e.style.display=this.display,function t(){let n=parseFloat(e.style.opacity);(n+=.1)>1||(e.style.opacity=n,requestAnimationFrame(t))}())}async _initTemplate(){this.template=this.querySelector("template"),this.template&&this.shadowRoot.appendChild(this.template)}_initVariables(e){const t=new Map(this.inScopeVariables);e.setInScopeVariables(t),function e(n){for(const r of n.children)"setInScopeVariables"in r&&r.setInScopeVariables(t),e(r)}(e)}_clone(){if(this.template=this.shadowRoot.querySelector("template"),this.template)return this.template.content.firstElementChild.cloneNode(!0)}_removeIndexMarker(){const e=this.querySelector("[data-ref]");Array.from(e.children).forEach((e=>{e.removeAttribute("repeat-index")}))}setInScopeVariables(e){this.inScopeVariables=new Map(e)}}customElements.get("fx-repeat-attributes")||window.customElements.define("fx-repeat-attributes",Lt);class Pt extends HTMLElement{static get properties(){return{lazyRefresh:{type:Boolean},model:{type:Object},ready:{type:Boolean}}}constructor(){super(),this.model={},this.inited=!1,this.addEventListener("message",this._displayMessage),this.addEventListener("error",this._displayError),this.addEventListener("warn",this._displayWarning),this.addEventListener("log",this._logError),window.addEventListener("compute-exception",(e=>{})),this.ready=!1,this.storedTemplateExpressionByNode=new Map,this.outermostHandler=null;this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n            <style>\n                \n            :host {\n                display: block;\n            }\n            :host ::slotted(fx-model){\n                display:none;\n            }\n\n            #modalMessage .dialogActions{\n                text-align:center;\n            }\n            .overlay {\n              position: fixed;\n              top: 0;\n              bottom: 0;\n              left: 0;\n              right: 0;\n              background: rgba(0, 0, 0, 0.7);\n              transition: all 500ms;\n              visibility: hidden;\n              opacity: 0;\n              z-index:10;\n            }\n            .overlay.show {\n              visibility: visible;\n              opacity: 1;\n            }\n\n            .popup {\n              margin: 70px auto;\n              background: #fff;\n              border-radius: 5px;\n              width: 30%;\n              position: relative;\n              transition: all 5s ease-in-out;\n                            padding: 20px;\n\n            }\n            .popup h2 {\n              margin-top: 0;\n              width:100%;\n              background:#eee;\n              position:absolute;\n              top:0;\n              right:0;\n              left:0;\n              height:40px;\n             border-radius: 5px;\n\n            }\n            .popup .close {\n                position: absolute;\n                top: 3px;\n                right: 10px;\n                transition: all 200ms;\n                font-size: 30px;\n                font-weight: bold;\n                text-decoration: none;\n                color: #333;\n            }\n            .popup .close:focus{\n                outline:none;\n            }\n\n            .popup .close:hover {\n                color: #06D85F;\n            }\n            #messageContent{\n                margin-top:40px;\n            }\n            .warning{\n                background:orange;\n            }\n        \n            </style>\n            \n           <noscript>This page uses Web Components and needs JavaScript to be enabled..</noscript>\n\n           <jinn-toast id="message" gravity="bottom" position="left"></jinn-toast>\n           <jinn-toast id="sticky" gravity="bottom" position="left" duration="-1" close="true" data-class="sticky-message"></jinn-toast>\n           <jinn-toast id="error" text="error" duration="-1" data-class="error" close="true" position="left" gravity="bottom" escape-markup="false"></jinn-toast>\n           <jinn-toast id="warn" text="warning" duration="-1" data-class="warning" close="true" position="right" gravity="bottom"></jinn-toast>\n           <slot id="default"></slot>\n           <slot name="messages"></slot>\n           <div id="modalMessage" class="overlay">\n                <div class="popup">\n                   <h2></h2>\n                    <a class="close" href="#"  onclick="event.target.parentNode.parentNode.classList.remove(\'show\')" autofocus>&times;</a>\n                    <div id="messageContent"></div>\n                </div>\n           </div>\n           <slot name="event"></slot>\n        \n        ',this.toRefresh=[],this.initialRun=!0,this.someInstanceDataStructureChanged=!1,this.repeatsFromAttributesCreated=!1}connectedCallback(){if(this.style.visibility="hidden",this.lazyRefresh=this.hasAttribute("refresh-on-view"),this.lazyRefresh){const e={root:null,rootMargin:"0px",threshold:.3};this.intersectionObserver=new IntersectionObserver(this.handleIntersect,e)}if(this.src=this.hasAttribute("src")?this.getAttribute("src"):null,this.src)return void this._loadFromSrc();this._injectDevtools();this.shadowRoot.querySelector("slot#default").addEventListener("slotchange",(async e=>{if(this.inited)return;if(this.hasAttribute("convert"))return void this.replaceWith(St.copyDom(this));let t=e.target.assignedElements().find((e=>"FX-MODEL"===e.nodeName.toUpperCase()));if(!t){const e=document.createElement("fx-model");return this.appendChild(e),void(t=e)}t.inited||(await t.modelConstruct(),this._handleModelConstructDone()),this.model=t,this._createRepeatsFromAttributes(),this.inited=!0})),this.addEventListener("path-mutated",(()=>{this.someInstanceDataStructureChanged=!0}))}_injectDevtools(){if(this.ownerDocument.querySelector("fx-devtools"))return;const e=window.location.search;if(new URLSearchParams(e).has("inspect")){const e=document.createElement("fx-devtools");document.body.appendChild(e)}}addToRefresh(e){this.toRefresh.find((t=>t.path===e.path))||this.toRefresh.push(e)}_loadFromSrc(){fetch(this.src,{method:"GET",mode:"cors",credentials:"include",headers:{"Content-Type":"text/html"}}).then((e=>e.headers.get("content-type").toLowerCase().startsWith("text/html")?e.text().then((e=>(new DOMParser).parseFromString(e,"text/html"))):"done")).then((e=>{const t=e.querySelector("fx-fore");t||St.dispatch(this,"error",{detail:{message:`Fore element not found in '${this.src}'. Maybe wrapped within 'template' element?`}}),t.setAttribute("from-src",this.src);const n=this.attributes;Array.from(n).forEach((e=>{"src"!==e.name&&t.setAttribute(e.name,e.value)})),this.replaceWith(t)})).catch((()=>{St.dispatch(this,"error",{message:`'${this.src}' not found or does not contain Fore element.`})}))}handleIntersect(e,t){e.forEach((e=>{const{target:t}=e;St.getFore(t).initialRun||e.isIntersecting&&(t.classList.add("loaded"),"function"==typeof t.refresh?t.refresh(t,!0):St.refreshChildren(t,!0))})),e[0].target.getOwnerForm().dispatchEvent(new CustomEvent("refresh-done"))}evaluateToNodes(e,t){return vt(e,t,this)}disconnectedCallback(){}async forceRefresh(){St.refreshChildren(this,!0),this._updateTemplateExpressions(),this.someInstanceDataStructureChanged=!1,this._processTemplateExpressions(),St.dispatch(this,"refresh-done",{})}async refresh(e){e||this.initialRun||0===this.toRefresh.length?St.refreshChildren(this,!0):(this.toRefresh.forEach((t=>{const n=t.boundControls;n&&n.forEach((t=>{t.refresh(e)}));const{mainGraph:r}=this.getModel();if(r&&r.hasNode(t.path)){const n=this.getModel().mainGraph.dependentsOf(t.path,!1);0!==n.length&&n.forEach((t=>{const n=et.getBasePath(t);this.getModel().modelItems.find((e=>e.path===n)).boundControls.forEach((t=>{t.refresh(e)}))}))}})),this.toRefresh=[]),(this.initialRun||this.someInstanceDataStructureChanged)&&(this._updateTemplateExpressions(),this.someInstanceDataStructureChanged=!1),this._processTemplateExpressions(),this.style.visibility="visible",St.dispatch(this,"refresh-done",{})}_updateTemplateExpressions(){const e=vt("(descendant-or-self::*!(text(), @*))[contains(., '{')][substring-after(., '{') => contains('}')][not(ancestor-or-self::fx-model)]",this,this);this.storedTemplateExpressions||(this.storedTemplateExpressions=[]),Array.from(e).forEach((e=>{if(this.storedTemplateExpressionByNode.has(e))return;const t=this._getTemplateExpression(e);this.storedTemplateExpressionByNode.set(e,t)})),this._processTemplateExpressions()}_processTemplateExpressions(){for(const e of Array.from(this.storedTemplateExpressionByNode.keys())){if(e.nodeType===Node.ATTRIBUTE_NODE){if(!et.contains(this,e.ownerElement)){this.storedTemplateExpressionByNode.delete(e);continue}}else if(!et.contains(this,e)){this.storedTemplateExpressionByNode.delete(e);continue}this._processTemplateExpression({node:e,expr:this.storedTemplateExpressionByNode.get(e)})}}_processTemplateExpression(e){const{expr:t}=e,{node:n}=e;this.evaluateTemplateExpression(t,n)}evaluateTemplateExpression(e,t){const n=e.replace(/{[^}]*}/g,(e=>{if("{}"===e)return e;const n=e.substring(1,e.length-1),r=Ct(t,n);if(!r)return(t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ATTRIBUTE_NODE)&&t.parentNode,e;const o=et.getInstanceId(n),i=o?this.getModel().getInstance(o):this.getModel().getDefaultInstance();try{return xt(n,r,t,null,i)}catch(t){return e}}));if(t.nodeType===Node.ATTRIBUTE_NODE){t.ownerElement.setAttribute(t.nodeName,n)}else t.nodeType===Node.TEXT_NODE&&(t.textContent=n)}_getTemplateExpression(e){return e.nodeType===Node.ATTRIBUTE_NODE?e.value:e.nodeType===Node.TEXT_NODE?e.textContent.trim():null}_handleModelConstructDone(){if(this.hasAttribute("show-confirmation")){const e=this.getAttribute("show-confirmation");e&&"show-confirmation"!==e&&"true"!==e&&""!==e?window.addEventListener("beforeunload",(t=>{if(wt(e,this.getModel().getDefaultContext(),this))return t.returnValue="are you sure";t.preventDefault()})):window.addEventListener("beforeunload",(e=>{if(Dt.dataChanged)return e.returnValue="are you sure";e.preventDefault()}))}this._initUI()}async _lazyCreateInstance(){const e=this.querySelector("fx-model");if(0===e.instances.length){const t=document.createElement("fx-instance");e.appendChild(t);const n=document.implementation.createDocument(null,"data",null);this._generateInstance(this,n.firstElementChild),t.instanceData=n,e.instances.push(t)}}_generateInstance(e,t){if(e.hasAttribute("ref")&&!St.isActionElement(e.nodeName)){const n=e.getAttribute("ref");if(n.includes("/")){n.split("/").forEach((n=>{t=this._generateNode(t,n,e)}))}else t=this._generateNode(t,n,e)}if(e.hasChildNodes()){const n=e.children;for(let e=0;e<n.length;e+=1)this._generateInstance(n[e],t)}return t}_generateNode(e,t,n){const r=e.ownerDocument.createElement(t);return 0===n.children.length&&(r.textContent=n.textContent),e.appendChild(r),e=r}async _initUI(){if(!this.initialRun)return;this.classList.add("initialRun"),await this._lazyCreateInstance();const e=new Map;!function t(n){for(const r of n.children)"setInScopeVariables"in r&&r.setInScopeVariables(e),t(r)}(this),await this.refresh(!0),this.classList.add("fx-ready"),document.body.classList.add("fx-ready"),this.ready=!0,this.initialRun=!1,St.dispatch(this,"ready",{})}registerLazyElement(e){this.intersectionObserver&&this.intersectionObserver.observe(e)}unRegisterLazyElement(e){this.intersectionObserver&&this.intersectionObserver.unobserve(e)}getModel(){return this.querySelector("fx-model")}_displayMessage(e){const{level:t}=e.detail,n=e.detail.message;this._showMessage(t,n),e.stopPropagation()}_displayError(e){const t=e.detail.message;this.shadowRoot.querySelector("#error").showToast(t)}_displayWarning(e){const t=e.detail.message,n=et.shortenPath(xt("path()",e.target,this));this.shadowRoot.querySelector("#warn").showToast(`WARN: ${n}:${t}`)}_logError(e){e.stopPropagation(),e.preventDefault();const t=document.createElement("div");t.setAttribute("slot","messages"),t.setAttribute("data-level",e.detail.level);const n=document.createElement("div");n.textContent=`"${e.detail.id}"`,t.appendChild(n);const r=document.createElement("div"),o=et.shortenPath(xt("path()",e.target,this));r.textContent=o,t.appendChild(r);const i=document.createElement("div");i.textContent=e.detail.message,t.appendChild(i),this.appendChild(t),t.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"});yt(`/${o}`,document,null).classList.add("fore-error")}_showMessage(e,t){if("modal"===e)this.shadowRoot.getElementById("messageContent").innerText=t,this.shadowRoot.getElementById("modalMessage").classList.add("show");else if("sticky"===e)this.shadowRoot.querySelector("#sticky").showToast(t);else{this.shadowRoot.querySelector("#message").showToast(t)}}_createRepeatsFromAttributes(){if(this.repeatsFromAttributesCreated)return;const e=this.querySelectorAll("[data-ref]");e&&Array.from(e).forEach((e=>{if(e.closest("fx-control"))return;const t=e.parentNode.closest("table");let n;n=t?t.cloneNode(!0):e.cloneNode(!0);const r=new Lt;r.setAttribute("ref",e.getAttribute("data-ref")),r.appendChild(n),t?(t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t)):(e.parentNode.insertBefore(r,e),e.parentNode.removeChild(e)),e.setAttribute("insertPoint","")})),this.repeatsFromAttributesCreated=!0}}Pt.outermostHandler=null,customElements.get("fx-fore")||customElements.define("fx-fore",Pt);class Ht{static selectRelevant(e,t){return"xml"===t?Ht._relevantXmlNodes(e):e.nodeset}static _relevantXmlNodes(e){if("keep"===e.getAttribute("nonrelevant"))return e.nodeset;const t=e.getModel().getModelItem(e.nodeset);if(t&&!t.relevant)return null;const n=e.nodeset.cloneNode(!1);return 0===e.nodeset.children.length&&Ht._isRelevant(e,e.nodeset)?e.nodeset:Ht._filterRelevant(e,e.nodeset,n)}static _filterRelevant(e,t,n){const{childNodes:r}=t;return Array.from(r).forEach((t=>{if(Ht._isRelevant(e,t)){const r=t.cloneNode(!1);n.appendChild(r);const{attributes:o}=t;return o&&Array.from(o).forEach((t=>{Ht._isRelevant(e,t)?r.setAttribute(t.nodeName,t.value):"empty"===e.nonrelevant?r.setAttribute(t.nodeName,""):r.removeAttribute(t.nodeName)})),Ht._filterRelevant(e,t,r)}return null})),n}static _isRelevant(e,t){const n=e.getModel().getModelItem(t);return!(n&&!n.relevant)}}class _t extends(Rt(HTMLElement)){constructor(){super(),this.attachShadow({mode:"open"}),this.parameters=new Map}connectedCallback(){this.methods=["get","put","post","delete","head","urlencoded-post"],this.model=this.parentNode,this.hasAttribute("id"),this.id=this.getAttribute("id"),this.instance=this.hasAttribute("instance")?this.getAttribute("instance"):null,this.into=this.hasAttribute("into")?this.getAttribute("into"):null,this.method=this.hasAttribute("method")?this.getAttribute("method"):"get",this.nonrelevant=this.hasAttribute("nonrelevant")?this.getAttribute("nonrelevant"):"remove",this.replace=this.hasAttribute("replace")?this.getAttribute("replace"):"all",this.serialization=this.hasAttribute("serialization")?this.getAttribute("serialization"):"xml",this.url=this.hasAttribute("url")?this.getAttribute("url"):null,this.targetref=this.hasAttribute("targetref")?this.getAttribute("targetref"):null,this.mediatype=this.hasAttribute("mediatype")?this.getAttribute("mediatype"):"application/xml",this.validate=this.getAttribute("validate")?this.getAttribute("validate"):"true",this.shadowRoot.innerHTML=this.renderHTML()}renderHTML(){return"\n      <slot></slot>\n    "}async submit(){await St.dispatch(this,"submit",{submission:this}),await this._submit()}async _submit(){this.evalInContext();const e=this.getModel();if(e.recalculate(),"true"===this.validate){if(!e.revalidate())return this.getOwnerForm().classList.add("submit-validation-failed"),St.dispatch(this,"submit-error",{}),void this.getModel().parentNode.refresh(!0)}await this._serializeAndSend()}_getProperty(e){return this.parameters.has(e)?this.parameters.get(e):this.getAttribute(e)}async _serializeAndSend(){const e=this._getProperty("url"),t=this.evaluateAttributeTemplateExpression(e,this),n=this.getInstance();n||St.dispatch(this,"warn",{message:`instance not found ${n.getAttribute("id")}`});const r=n.getAttribute("type");let o;if("none"===this.serialization)o=void 0;else{const e=Ht.selectRelevant(this,r);o=this._serialize(r,e)}if("get"===this.method.toLowerCase()&&(o=void 0),t.startsWith("#echo")){const e=this._parse(o,n);return this._handleResponse(e),St.dispatch(this,"submit-done",{}),void this.parameters.clear()}if(t.startsWith("localStore:")){if("get"===this.method||"consume"===this.method){this.replace="instance";const e=t.substring(t.indexOf(":")+1),r=localStorage.getItem(e);if(!r)return St.dispatch(this,"submit-error",{message:`Error reading key ${e} from localstorage`}),void this.parameters.clear();const o=this._parse(r,n);this._handleResponse(o),"consume"===this.method&&localStorage.removeItem(e),St.dispatch(this,"submit-done",{})}if("post"===this.method){const e=t.substring(t.indexOf(":")+1);localStorage.setItem(e,o),this._handleResponse(n.instanceData),St.dispatch(this,"submit-done",{})}if("delete"===this.method){const e=t.substring(t.indexOf(":")+1);localStorage.removeItem(e);const n=(new DOMParser).parseFromString("<data></data>","application/xml");this._handleResponse(n),St.dispatch(this,"submit-done",{})}return}const i=this._getHeaders();if(this.methods.includes(this.method.toLowerCase()))try{const e=await fetch(t,{method:this.method,headers:i,body:o});if(!e.ok||e.status>400)return void St.dispatch(this,"submit-error",{message:`Error while submitting ${this.id}`});const n=e.headers.get("content-type").toLowerCase();if(n.startsWith("text/plain")||n.startsWith("text/html")||n.startsWith("text/markdown")){const r=await e.text();this._handleResponse(r,t,n)}else if(n.startsWith("application/json")){const r=await e.json();this._handleResponse(r,t,n)}else if(n.startsWith("application/xml")){const r=await e.text(),o=(new DOMParser).parseFromString(r,"application/xml");this._handleResponse(o,t,n)}else{const r=await e.blob();this._handleResponse(r,t,n)}St.dispatch(this,"submit-done",{})}catch(e){St.dispatch(this,"submit-error",{error:e.message})}finally{this.parameters.clear()}else St.dispatch(this,"error",{message:`Unknown method ${this.method}`})}_parse(e,t){let n=null;return e&&"xml"===t.getAttribute("type")&&(n=(new DOMParser).parseFromString(e,"application/xml")),e&&"json"===t.getAttribute("type")&&(n=JSON.parse(e)),n}_serialize(e,t){if("application/x-www-form-urlencoded"===this.serialization){const e=new URLSearchParams;return Array.from(t.children).forEach((t=>{e.append(t.nodeName,t.textContent)})),e}if("xml"===e){return(new XMLSerializer).serializeToString(t)}if("json"===e)return JSON.stringify(t);throw new Error("unknown instance type ",e)}_getHeaders(){const e=new Headers,t=this.getInstance(),n=St.getContentType(t,this.serialization);e.append("Content-Type",n),e.has("Accept")&&e.delete("Accept");const r=this.querySelectorAll("fx-header");return Array.from(r).forEach((t=>{const{name:n}=t,r=t.getValue();e.append(n,r)})),e}_getUrlExpr(){return this.storedTemplateExpressions.find((e=>"url"===e.node.nodeName))}_getTargetInstance(){let e;if(e=this.instance?this.model.getInstance(this.instance):this.model.getInstance("default"),!e)throw new Error(`target instance not found: ${e}`);return e}_handleResponse(e,t,n){if("instance"===this.replace){const t=this._getTargetInstance();if(!t)throw new Error(`target instance not found: ${t}`);if(this.targetref){const[n]=gt(this.targetref,t.instanceData.firstElementChild,this),r=e.firstElementChild;n.parentNode.replaceChild(r,n)}else if(this.into){const[n]=gt(this.into,t.instanceData.firstElementChild,this);e.nodeType===Node.DOCUMENT_NODE?n.appendChild(e.firstElementChild):n.innerHTML=e}else{const n=e;t.instanceData=n}this.model.inited&&(this.model.updateModel(),this.getOwnerForm().refresh(!0))}if("all"===this.replace&&(document.open(),document.write(e),document.close(),window.location.href=t),"target"===this.replace&&n.startsWith("text/html")){const t=this._getProperty("target"),n=document.querySelector(t);n?n.innerHTML=e:St.dispatch(this,"submit-error",{message:`targetNode for selector ${t} not found`})}"redirect"===this.replace&&(window.location.href=e)}_handleError(){St.dispatch(this,"submit-error",{})}}customElements.get("fx-submission")||customElements.define("fx-submission",_t);class jt extends(Rt(HTMLElement)){constructor(){if(super(),this.style.display="none",this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML="",!this.hasAttribute("name"))throw new Error('required attribute "name" missing');this.name=this.getAttribute("name")}connectedCallback(){this.shadowRoot.innerHTML=""}}customElements.get("fx-header")||customElements.define("fx-header",jt);class Xt extends(Rt(HTMLElement)){constructor(){super(),this.attachShadow({mode:"open"}),this.name="",this.valueQuery="",this.value=null}connectedCallback(){this.name=this.getAttribute("name"),this.valueQuery=this.getAttribute("value")}refresh(){const e=Ct(this,this.valueQuery),t=gt(this.valueQuery,e,this,this.precedingVariables);[this.value]=t}setInScopeVariables(e){e.has(this.name)?St.dispatch(this,"xforms-binding-error",{}):(e.set(this.name,this),this.inScopeVariables=new Map(e))}}customElements.get("fx-var")||customElements.define("fx-var",Xt);class qt extends(Rt(HTMLElement)){constructor(){super(),this.value="",this.display=this.style.display,this.required=!1,this.readonly=!1,this.widget=null,this.visited=!1,this.force=!1}getWidget(){throw new Error("You have to implement the method getWidget!")}async refresh(e){e&&(this.force=!0);const t=this.value;if(!this.isNotBound()&&(this.oldVal=this.nodeset?this.nodeset:null,this.evalInContext(),this.isBound())){if(!this.nodeset)return void(this.style.display="none");if(this.modelItem=this.getModelItem(),this.modelItem instanceof kt){if(this.hasAttribute("as")&&"node"===this.getAttribute("as")?(this.modelItem.node=this.nodeset,this.value=this.modelItem.node):this.value=this.modelItem.value,this.modelItem.boundControls.includes(this)||this.modelItem.boundControls.push(this),await this.updateWidgetValue(),this.handleModelItemProperties(),this.getOwnerForm().initialRun&&St.dispatch(this,"init",{}),!this.getOwnerForm().ready)return;t!==this.value&&St.dispatch(this,"value-changed",{path:this.modelItem.path,value:this.modelItem.value})}}}refreshFromModelItem(e){}async updateWidgetValue(){throw new Error("You have to implement the method updateWidgetValue!")}handleModelItemProperties(){this.handleRequired(),this.handleReadonly(),this.getOwnerForm().ready&&this.handleValid(),this.handleRelevant()}_getForm(){return this.getModel().parentNode}_dispatchEvent(e){this.getOwnerForm().ready&&St.dispatch(this,e,{})}handleRequired(){if(this.widget=this.getWidget(),!this.modelItem.required)return this.widget.removeAttribute("required"),this.removeAttribute("required"),void(this.isRequired()!==this.modelItem.required&&this._dispatchEvent("optional"));(this.visited||this.force)&&(""===this.modelItem.value?(this.classList.add("isEmpty"),this._toggleValid(!1)):(this.classList.remove("isEmpty"),this._toggleValid(!0))),this.widget.setAttribute("required",""),this.setAttribute("required",""),this.isRequired()!==this.modelItem.required&&this._dispatchEvent("required")}_updateRequired(){this.modelItem.required?((this.visited||this.force)&&(""===this.modelItem.value?(this.classList.add("isEmpty"),this._toggleValid(!1)):(this.classList.remove("isEmpty"),this._toggleValid(!0))),this.widget.setAttribute("required",""),this.setAttribute("required",""),this._dispatchEvent("required")):(this.widget.removeAttribute("required"),this.removeAttribute("required"),this._dispatchEvent("optional"))}_toggleValid(e){e?(this.removeAttribute("invalid"),this.setAttribute("valid","")):(this.removeAttribute("valid"),this.setAttribute("invalid",""))}handleReadonly(){this.isReadonly()!==this.modelItem.readonly&&(this.modelItem.readonly&&(this.widget.setAttribute("readonly",""),this.setAttribute("readonly",""),this._dispatchEvent("readonly")),this.modelItem.readonly||(this.widget.removeAttribute("readonly"),this.removeAttribute("readonly"),this._dispatchEvent("readwrite")))}handleValid(){if(this.isValid()!==this.modelItem.constraint)if(this.modelItem.constraint)this._dispatchEvent("valid"),this.setAttribute("valid",""),this.removeAttribute("invalid");else{if(this.setAttribute("invalid",""),this.removeAttribute("valid"),0!==this.modelItem.alerts.length){if(!this.querySelector("fx-alert")){const{alerts:e}=this.modelItem;e.forEach((e=>{const t=document.createElement("fx-alert");t.innerHTML=e,this.appendChild(t)}))}}this._dispatchEvent("invalid")}}handleRelevant(){const e=this.modelItem.node;if(Array.isArray(e)&&0===e.length)return this._dispatchEvent("nonrelevant"),void(this.style.display="none");this.isEnabled()!==this.modelItem.relevant&&(this.modelItem.relevant?(this._dispatchEvent("relevant"),this.style.display=this.display):(this._dispatchEvent("nonrelevant"),this.style.display="none"))}isRequired(){return this.hasAttribute("required")}isValid(){return!this.hasAttribute("invalid")}isReadonly(){return this.hasAttribute("readonly")}isEnabled(){return"none"!==this.style.display}_fadeOut(e){e.style.opacity=1,function t(){(e.style.opacity-=.1)<0?e.style.display="none":requestAnimationFrame(t)}()}_fadeIn(e,t){e.style.opacity=0,e.style.display=t||"block",function t(){let n=parseFloat(e.style.opacity);(n+=.1)>1||(e.style.opacity=n,requestAnimationFrame(t))}()}}customElements.get("fx-abstract-control")||window.customElements.define("fx-abstract-control",qt);class Vt extends qt{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.shadowRoot.innerHTML="\n        <style>\n            \n      :host {\n        height: auto;\n        font-size: 0.8em;\n        font-weight: 400;\n        color: red;\n      }\n    \n        </style>\n        \n      <slot></slot>\n    \n    "}getWidget(){return this}async updateWidgetValue(){this.innerHTML=this.value}}customElements.get("fx-alert")||customElements.define("fx-alert",Vt);class $t extends qt{constructor(){super(),this.inited=!1,this.attachShadow({mode:"open"})}static get properties(){return{...qt.properties,initial:{type:Boolean}}}connectedCallback(){this.initial=this.hasAttribute("initial")?this.getAttribute("initial"):null,this.url=this.hasAttribute("url")?this.getAttribute("url"):null,this.loaded=!1,this.initialNode=null,this.debounceDelay=this.hasAttribute("debounce")?this.getAttribute("debounce"):null,this.updateEvent=this.hasAttribute("update-event")?this.getAttribute("update-event"):"blur",this.valueProp=this.hasAttribute("value-prop")?this.getAttribute("value-prop"):"value",this.label=this.hasAttribute("label")?this.getAttribute("label"):null;this.shadowRoot.innerHTML=`\n            <style>\n                \n            :host{\n                display:inline-block;\n            }\n        \n            </style>\n            ${this.renderHTML(this.ref)}\n        `,this.widget=this.getWidget();let e=this.widget;if(this.hasAttribute("listen-on")){const t=this.getAttribute("listen-on"),n=this.querySelector(t);n&&(e=n)}this.addEventListener("keyup",(()=>{Dt.dataChanged=!0})),"enter"===this.updateEvent&&(this.widget.addEventListener("keyup",(e=>{13===e.keyCode&&(e.preventDefault(),this.setValue(this.widget[this.valueProp]))})),this.updateEvent="blur"),this.debounceDelay?e.addEventListener(this.updateEvent,function(e,t,n=300){let r;return(...o)=>{clearTimeout(r),r=setTimeout((()=>{t.apply(e,o)}),n)}}(this,(()=>{this.setValue(this.widget[this.valueProp])}),this.debounceDelay)):e.addEventListener(this.updateEvent,(e=>{this.setValue(this.widget[this.valueProp])})),this.addEventListener("return",(e=>{const t=e.detail.nodeset;e.stopPropagation(),this._replaceNode(t)})),this.widget.addEventListener("focus",(()=>{this.classList.contains("visited")||this.classList.add("visited")})),this.template=this.querySelector("template"),this.boundInitialized=!1,this.static=!!this.widget.hasAttribute("static")}_debounce(e,t=300){let n;return(...r)=>{const o=this;clearTimeout(n),n=setTimeout((()=>{e.apply(o,r)}),t)}}setValue(e){const t=this.getModelItem();if(t?.readonly)return;if("node"===this.getAttribute("as")){const e=this.shadowRoot.getElementById("replace"),n=this.getWidget()[this.valueProp];return e.replace(this.nodeset,n),void(t&&n&&n!==t.value&&(t.value=n,Dt.dataChanged=!0,e.actionPerformed()))}const n=this.shadowRoot.getElementById("setvalue");n.setValue(t,e),this.modelItem instanceof kt&&!this.modelItem?.boundControls.includes(this)&&this.modelItem.boundControls.push(this),n.actionPerformed(),this.visited=!0}_replaceNode(e){e.nodeType===Node.ATTRIBUTE_NODE?this.modelItem.node.nodeValue=e.nodeValue:e.nodeType===Node.ELEMENT_NODE?this.modelItem.node.replaceWith(e.cloneNode(!0)):e.nodeType===Node.TEXT_NODE?this.modelItem.node.nodeValue=e.textContent:St.dispatch(this,"warn",{message:"trying to replace a node that is neither an Attribute, Elemment or Text node"}),this.getOwnerForm().refresh()}renderHTML(e){return`\n            ${this.label?`${this.label}`:""}\n            <slot></slot>\n            ${this.hasAttribute("as")&&"node"===this.getAttribute("as")?'<fx-replace id="replace" ref=".">':`<fx-setvalue id="setvalue" ref="${e}"></fx-setvalue>`}\n\n        `}getWidget(){if(this.widget)return this.widget;let e=this.querySelector(".widget");if(e||(e=this.querySelector("input")),!e){const e=document.createElement("input");return e.classList.add("widget"),e.setAttribute("type","text"),this.appendChild(e),e}return e}async updateWidgetValue(){let{widget:e}=this;if(e||(e=this),"checked"!==this.valueProp)if(this.hasAttribute("as")){const t=this.getAttribute("as");if("text"===t){const t=new XMLSerializer,n=St.prettifyXml(t.serializeToString(this.nodeset));e.value=n}if("node"===t&&this.nodeset!==e.value){const t=this.nodeset;if(e.value&&t!==this.widget.value)return void(e.value=this.nodeset.cloneNode(!0));e.value=this.nodeset.cloneNode(!0)}}else{if(this.url&&!this.loaded)return this.initial&&(this.initialNode=yt(this.initial,this.nodeset,this)),await this._loadForeFromUrl(),void(this.loaded=!0);e.value!==this.value&&(e.value=this.value)}else"true"===this.value?e.checked=!0:e.checked=!1}async _loadForeFromUrl(){try{const e=await fetch(this.url,{method:"GET",headers:{"Content-Type":"text/html"}});let t;t=e.headers.get("content-type").toLowerCase().startsWith("text/html")?await e.text().then((e=>(new DOMParser).parseFromString(e,"text/html"))):"done";const n=t.querySelector("fx-fore"),r=document.importNode(n,!0);r.classList.add("widget"),r.addEventListener("model-construct-done",(e=>{const t=r.querySelector("fx-instance");if(this.initialNode){const e=(new DOMParser).parseFromString("<data></data>","application/xml");e.firstElementChild.appendChild(this.initialNode.cloneNode(!0)),t.setInstanceData(e)}r.getModel().updateModel(),r.refresh()}),{once:!0});const o=this.querySelector("input");this.hasAttribute("shadow")?(o.parentNode.removeChild(o),this.shadowRoot.appendChild(r)):this.loaded||o.replaceWith(r),n||this.dispatchEvent(new CustomEvent("error",{detail:{message:`Fore element not found in '${this.src}'. Maybe wrapped within 'template' element?`}})),this.dispatchEvent(new CustomEvent("loaded",{detail:{fore:n}}))}catch(e){this.getOwnerForm().dispatchEvent(new CustomEvent("error",{detail:{message:`${this.url} not found`}}))}}getTemplate(){return this.querySelector("template")}async refresh(e){super.refresh(e);const t=this.getWidget();this._handleBoundWidget(t),this._handleDataAttributeBinding(),St.refreshChildren(this,e)}_handleDataAttributeBinding(){const e=this.querySelector("[data-ref]");e&&(this.boundList=e,e.getAttribute("data-ref"),this._handleBoundWidget(e))}_handleBoundWidget(e){if(this.boundInitialized&&this.static)return;const t=e.hasAttribute("ref")?e.getAttribute("ref"):e.getAttribute("data-ref");if(e&&t){const n=gt(t,Ct(this,t),this);if(Array.isArray(n)&&0===n.length)return;const{children:r}=e;Array.from(r).forEach((e=>{"template"!==e.nodeName.toLowerCase()&&e.parentNode.removeChild(e)}));if(this.template){if("SELECT"===this.widget.nodeName&&this.widget.hasAttribute("selection")&&"open"===this.widget.getAttribute("selection")){const e=this.template.firstElementChild,t=document.createElement("option");this.widget.insertBefore(t,e)}if(n.length){const e=document.createDocumentFragment();Array.from(n).forEach((t=>{const n=this.createEntry();e.appendChild(n),this.updateEntry(n,t)})),this.template.parentNode.appendChild(e)}else{const e=this.createEntry();this.template.parentNode.appendChild(e),this.updateEntry(e,n)}this.boundInitialized=!0}}}updateEntry(e,t){const n=this._getValueAttribute(e);if(!n)return;const r=n.value,o=xt(r.substring(1,r.length-1),t,e);n.value=o,this.value===o&&e.setAttribute("selected","selected");const i=e.textContent,a=i.substring(1,i.length-1);if(!a)return;const s=xt(a,t,this);e.textContent=s}createEntry(){return this.template.content.firstElementChild.cloneNode(!0)}_getValueAttribute(e){let t;return Array.from(e.attributes).forEach((e=>{-1!==e.value.indexOf("{")&&(t=e)})),t}}customElements.get("fx-control")||window.customElements.define("fx-control",$t);class Yt extends(Rt(HTMLElement)){constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.shadowRoot.innerHTML="\n            <style>\n                \n        :host {\n            display: block;\n        }\n    \n            </style>\n            \n      <slot></slot>\n    \n    ",this.getOwnerForm().registerLazyElement(this)}async refresh(e){!e&&this.hasAttribute("refresh-on-view")||this.isBound()&&(this.evalInContext(),this.modelItem=this.getModelItem(),this.modelItem&&!this.modelItem.boundControls.includes(this)&&this.modelItem.boundControls.push(this),this.handleModelItemProperties())}handleModelItemProperties(){this.handleRelevant()}_getForm(){return this.getModel().parentNode}handleRelevant(){if(!this.modelItem)return this.removeAttribute("relevant",""),this.setAttribute("nonrelevant",""),void this.dispatchEvent(new CustomEvent("disabled",{}));this.isEnabled()!==this.modelItem.enabled&&(this.modelItem.relevant?(this.removeAttribute("nonrelevant",""),this.setAttribute("relevant",""),this.dispatchEvent(new CustomEvent("enabled",{}))):(this.removeAttribute("relevant",""),this.setAttribute("nonrelevant",""),this.dispatchEvent(new CustomEvent("disabled",{}))))}isReadonly(){return!!this.hasAttribute("readonly")}isEnabled(){return"none"!==this.style.display}}customElements.get("fx-container")||window.customElements.define("fx-container",Yt);class zt extends Yt{static get properties(){return{...super.properties,collapse:{type:Boolean,reflect:!0}}}constructor(){super(),this.collapse=!1}render(){return"\n      <slot></slot>\n    "}handleModelItemProperties(){this.handleRelevant()}initializeChildren(e){Array.from(e.children).forEach((e=>{if(St.isUiElement(e.nodeName))e.init(this.model);else if(0!==e.children.length){Array.from(e.children).forEach((e=>{this.initializeChildren(e)}))}}))}async refresh(e){super.refresh(e),St.refreshChildren(this,e)}}customElements.get("fx-group")||window.customElements.define("fx-group",zt);class Qt extends qt{static get styles(){return"\n      :host {\n        display: block;\n        height: auto;\n        font-size: 0.8em;\n        font-weight: 400;\n        font-style: italic;\n      }\n    "}static get properties(){return{...super.properties}}render(){return"\n      <slot></slot>\n    "}}customElements.get("fx-hint")||customElements.define("fx-hint",Qt);class Jt extends qt{constructor(){super(),this.attachShadow({mode:"open"}),this.valueAttr=this.hasAttribute("value")?this.getAttribute("value"):null,this.readonly=!0}connectedCallback(){this.shadowRoot.innerHTML='\n            <style>\n                \n          :host {\n            display: inline-block;\n            max-width:100%;\n          }\n          #widget {\n            display: inline-block;\n          }\n          .label{\n            display: inline-block;\n          }\n          #value{\n            max-width:100%;\n          }\n        \n            </style>\n            \n            <slot name="label"></slot>\n            \n            <span id="value">\n                <slot name="default"></slot>\n            </span>\n        \n        ',this.mediatype=this.hasAttribute("mediatype")?this.getAttribute("mediatype"):null}async refresh(){this.ref&&await super.refresh(),this.valueAttr&&(this.value=this.getValue(),await this.updateWidgetValue())}getValue(){try{const e=Ct(this,this.valueAttr);return this.hasAttribute("html")?gt(this.valueAttr,e,this)[0]:function(e,t,n,r=null,o=n){const i=dt(e,t,n);return ze(e,t,r,{},{currentContext:{formElement:n},functionNameResolver:ft,moduleImports:{xf:ot},namespaceResolver:i})}(this.valueAttr,e,this)[0]}catch(e){St.dispatch(this,"error",{message:e})}return null}getWidget(){return this.shadowRoot.getElementById("value")}handleReadonly(){this.setAttribute("readonly","readonly")}async updateWidgetValue(){const e=this.shadowRoot.getElementById("value");if(e.innerHTML="","html"!==this.mediatype){if("image"===this.mediatype){const t=document.createElement("img");return t.setAttribute("src",this.value),this.innerHTML="",void e.appendChild(t)}e.innerHTML=this.value}else if(this.modelItem.node){this.shadowRoot.querySelector("#default");const{node:t}=this.modelItem;if(t.nodeType)return void e.append(t);const n=(new DOMParser).parseFromString(t,"text/html").body.childNodes;return void Array.from(n).forEach((t=>{e.append(t)}))}}isReadonly(){return!0}}customElements.get("fx-output")||customElements.define("fx-output",Jt);class Wt extends(Rt(HTMLElement)){static get properties(){return{inited:{type:Boolean}}}constructor(){super(),this.inited=!1,this.addEventListener("click",this._dispatchIndexChange),this.addEventListener("focusin",this._dispatchIndexChange),this.attachShadow({mode:"open",delegatesFocus:!0})}_handleFocus(){this.parentNode.setIndex(this.index)}_dispatchIndexChange(){this.parentNode&&this.parentNode.dispatchEvent(new CustomEvent("item-changed",{composed:!1,bubbles:!0,detail:{item:this,index:this.index}}))}connectedCallback(){this.display=this.style.display;this.shadowRoot.innerHTML="\n            \n           <slot></slot>\n        \n        ",this.getOwnerForm().registerLazyElement(this)}disconnectedCallback(){this.removeEventListener("click",this._dispatchIndexChange()),this.removeEventListener("focusin",this._handleFocus)}init(){this.inited=!0}refresh(e){this.modelItem=this.getModelItem(),this.modelItem.boundControls.includes(this)||this.modelItem.boundControls.push(this),this.modelItem&&!this.modelItem.relevant?this.classList.add("nonrelevant"):this.classList.remove("nonrelevant"),St.refreshChildren(this,e)}}customElements.get("fx-repeatitem")||window.customElements.define("fx-repeatitem",Wt);class Kt extends(Rt(HTMLElement)){static get properties(){return{...super.properties,index:{type:Number},template:{type:Object},focusOnCreate:{type:String},initDone:{type:Boolean},repeatIndex:{type:Number},nodeset:{type:Array}}}constructor(){super(),this.ref="",this.dataTemplate=[],this.focusOnCreate="",this.initDone=!1,this.repeatIndex=1,this.nodeset=[],this.inited=!1,this.index=1,this.repeatSize=0,this.attachShadow({mode:"open",delegatesFocus:!0})}get repeatSize(){return this.querySelectorAll(":scope > fx-repeatitem").length}set repeatSize(e){this.size=e}setIndex(e){this.index=e;const t=this.querySelectorAll(":scope > fx-repeatitem");this.applyIndex(t[this.index-1])}applyIndex(e){this._removeIndexMarker(),e&&e.setAttribute("repeat-index","")}get index(){return this.getAttribute("index")}set index(e){this.setAttribute("index",e)}_getRef(){return this.getAttribute("ref")}connectedCallback(){this.ref=this.getAttribute("ref"),this.addEventListener("item-changed",(e=>{const{item:t}=e.detail,n=Array.from(this.children).indexOf(t);this.applyIndex(this.children[n]),this.index=n+1})),document.addEventListener("index-changed",(e=>{if(e.stopPropagation(),!e.target===this)return;const{index:t}=e.detail;this.index=Number(t),this.applyIndex(this.children[t-1])})),this.mutationObserver=new MutationObserver((e=>{if("childList"===e[0].type){const t=e[0].addedNodes[0];if(t){const e=et.getPath(t);St.dispatch(this,"path-mutated",{path:e,index:this.index})}}})),this.getOwnerForm().registerLazyElement(this);this.shadowRoot.innerHTML='\n            <style>\n                \n      :host{\n      }\n       .fade-out-bottom {\n          -webkit-animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n          animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n      }\n      .fade-out-bottom {\n          -webkit-animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n          animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n      }\n   \n            </style>\n            \n          <slot name="header"></slot>\n          <slot></slot>\n        \n        '}init(){this._evalNodeset(),this._initTemplate(),this._initRepeatItems(),this.setAttribute("index",this.index),this.inited=!0}_evalNodeset(){const e=Ct(this.getAttributeNode("ref")||this,this.ref);this.mutationObserver&&e.nodeName&&this.mutationObserver.observe(e,{childList:!0,subtree:!0});const t=gt(this.ref,e,this);1===t.length&&Array.isArray(t[0])?this.nodeset=t[0]:this.nodeset=t}async refresh(e){this.inited||this.init(),this._evalNodeset();const t=this.querySelectorAll(":scope > fx-repeatitem"),n=t.length;let r=1;Array.isArray(this.nodeset)&&(r=this.nodeset.length);const o=r;if(o<n)for(let e=n;e>o;e-=1){const n=t[e-1];n.parentNode.removeChild(n),this.getOwnerForm().unRegisterLazyElement(n)}if(o>n)for(let e=n+1;e<=o;e+=1){const t=document.createElement("fx-repeatitem"),n=this._clone();t.appendChild(n),this.appendChild(t),this._initVariables(t),t.nodeset=this.nodeset[e-1],t.index=e,this.getOwnerForm().someInstanceDataStructureChanged=!0}for(let e=0;e<n;e+=1){const n=t[e];this.getOwnerForm().registerLazyElement(n),n.nodeset!==this.nodeset[e]&&(n.nodeset=this.nodeset[e])}this.getOwnerForm().lazyRefresh&&!e||St.refreshChildren(this,e),this.setIndex(this.index)}_fadeOut(e){e.style.opacity=1,function t(){(e.style.opacity-=.1)<0?e.style.display="none":requestAnimationFrame(t)}()}_fadeIn(e){e&&(e.style.opacity=0,e.style.display=this.display,function t(){let n=parseFloat(e.style.opacity);(n+=.1)>1||(e.style.opacity=n,requestAnimationFrame(t))}())}_initTemplate(){this.template=this.querySelector("template"),null===this.template&&this.dispatchEvent(new CustomEvent("no-template-error",{composed:!0,bubbles:!0,detail:{message:`no template found for repeat:${this.id}`}})),this.shadowRoot.appendChild(this.template)}_initRepeatItems(){this.nodeset.forEach(((e,t)=>{const n=document.createElement("fx-repeatitem");n.nodeset=this.nodeset[t],n.index=t+1;const r=this._clone();n.appendChild(r),this.appendChild(n),1===n.index&&this.applyIndex(n),St.dispatch(this,"item-created",{nodeset:n.nodeset,pos:t+1}),this._initVariables(n)}))}_initVariables(e){const t=new Map(this.inScopeVariables);e.setInScopeVariables(t),function e(n){for(const r of n.children)"setInScopeVariables"in r&&r.setInScopeVariables(t),e(r)}(e)}_clone(){this.template=this.shadowRoot.querySelector("template");const e=this.template.content.cloneNode(!0);return document.importNode(e,!0)}_removeIndexMarker(){Array.from(this.children).forEach((e=>{e.removeAttribute("repeat-index")}))}setInScopeVariables(e){this.inScopeVariables=new Map(e)}}customElements.get("fx-repeat")||window.customElements.define("fx-repeat",Kt);class Zt extends Yt{constructor(){super(),this.formerCase={}}connectedCallback(){super.connectedCallback&&super.connectedCallback();this.shadowRoot.innerHTML="\n        <style>\n            \n       :host ::slotted(fx-case.selected-case){\n        display: block !important;\n    }\n    \n        </style>\n        \n       <slot></slot>\n    \n    "}async refresh(e){super.refresh();const t=this.querySelectorAll(":scope > fx-case");let n;if(this.isBound()?Array.from(t).forEach((e=>{e.getAttribute("name")===this.modelItem.value?(St.dispatch(e,"select",{}),e.classList.add("selected-case"),n=e):(e.classList.contains("selected-case")&&St.dispatch(e,"deselect",{}),e.classList.remove("selected-case"))})):(n=this.querySelector(":scope > .selected-case"),n||(n=t[0],St.dispatch(n,"select",{}),n.classList.add("selected-case"))),this.formerCase!==n){const e=n.querySelectorAll(".visited");Array.from(e).forEach((e=>{e.classList.remove("visited")}))}St.refreshChildren(n,e),this.formerCase=n}toggle(e){const t=this.querySelectorAll("fx-case");Array.from(t).forEach((t=>{e===t?(t.classList.add("selected-case"),St.dispatch(t,"select",{}),this.refresh()):(t.classList.contains("selected-case")&&St.dispatch(t,"deselect",{}),t.classList.remove("selected-case"))}))}}customElements.get("fx-switch")||window.customElements.define("fx-switch",Zt);class en extends qt{connectedCallback(){this.attachShadow({mode:"open"}),this.ref=this.hasAttribute("ref")?this.getAttribute("ref"):null,this.debounceDelay=this.hasAttribute("debounce")?this.getAttribute("debounce"):null;this.shadowRoot.innerHTML=`\n                <style>\n                    \n          :host {\n            cursor:pointer;\n          }\n        \n                </style>\n                ${this.renderHTML()}\n        `;const e=this.shadowRoot.querySelector("slot");e.addEventListener("slotchange",(()=>{const t=e.assignedElements({flatten:!0});t[0].setAttribute("tabindex","0"),t[0].setAttribute("role","button");const n=t[0];this.debounceDelay?this.addEventListener("click",function(e,t,n=300){let r;return(...o)=>{r||t.apply(e,o),clearTimeout(r),r=setTimeout((()=>(r=void 0,null)),n)}}(this,(e=>{this.performActions(e)}),this.debounceDelay)):n.addEventListener("click",(e=>this.performActions(e))),this.widget=n,"BUTTON"!==n.nodeName&&n.addEventListener("keypress",(e=>{"Space"!==e.code&&"Enter"!==e.code||this.performActions(e)}))}))}renderHTML(){return"\n            <slot></slot>\n    "}getWidget(){return this.widget}async updateWidgetValue(){return null}handleReadonly(){super.handleReadonly(),this.widget.hasAttribute("readonly")?this.widget.setAttribute("disabled","disabled"):this.widget.removeAttribute("disabled")}async performActions(e){const t=this.closest("fx-repeatitem");t&&t.click(),this.querySelectorAll("fx-var").forEach((e=>e.refresh()));for(let t=0;t<this.children.length;t+=1){const n=this.children[t];if("function"==typeof n.execute){if(e&&(e.preventDefault(),e.stopPropagation(),e.type&&n.event&&e.type!==n.event))return;await n.execute(e)}}}}customElements.get("fx-trigger")||customElements.define("fx-trigger",en);class tn extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.hasAttribute("label")&&(this.label=this.getAttribute("label")),this.hasAttribute("name")&&(this.name=this.getAttribute("name")),this.hasAttribute("selected")&&(this.selected=this.getAttribute("selected"));const e=`\n           ${this.label?`<span>${this.label}</span>`:""}\n           <slot></slot>\n        `;this.shadowRoot.innerHTML=`\n            <style>\n                \n            :host {\n                visibility: none;\n            }\n        \n            </style>\n            ${e}\n    `}}customElements.get("fx-case")||window.customElements.define("fx-case",tn);class nn extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const e=this.closest("fx-fore");this.render("\n          :host {\n            position:absolute;\n            display: block;\n            width:var(--inspector-handle-width);\n            background:var(--inspector-bg);\n            top:0;\n            right:0;\n            bottom:0;\n            height: 100%;\n            background: var(--inspector-bg);\n            color: white;\n            /*max-height: 33%;*/\n            overflow: scroll;\n            transition:width 0.3s ease;\n            z-index:100;\n          }\n          :host([open]){\n            width: 30%;\n          }\n          details{\n            margin:1rem;\n          }\n          .main{\n            padding-left:var(--inspector-handle-width);\n            color:var(--inspector-color);\n            overflow:scroll;\n            height:100%;\n          }\n          pre{\n            background:var(--inspector-pre-bg);\n            color:var(--inspector-color);\n            overflow:scroll;\n            padding:0.2rem;\n          }\n          .handle{\n            display:block;\n            height:100%;\n            width:var(--inspector-handle-width);\n            background:var(--inspector-handle-bg);\n            opacity:0.7;\n            position:absolute;\n            left:0;\n            color:white;\n            cursor:pointer;\n          }\n          .handle:hover{\n            opacity:1;\n          }\n          .handle::before{\n            content: 'Data Inspector';\n            white-space: nowrap;\n            transform: rotate(-90deg);\n            display: inline-block;\n            position: absolute;\n            left: -85px;\n            width: 200px;\n            top: 40px;\n          }\n          summary{\n            cursor:pointer;\n          }\n        "),e.addEventListener("refresh-done",(()=>{this.update()}))}update(){const e=this.shadowRoot.querySelectorAll("pre"),t=this.closest("fx-fore");Array.from(e).forEach((e=>{const n=t.getModel().getInstance(e.getAttribute("id"));"xml"===n.getAttribute("type")&&(e.innerText=this.serializeDOM(n.instanceData)),"json"===n.getAttribute("type")&&(e.innerText=JSON.stringify(n.instanceData,void 0,2))}))}render(e){const t=this.closest("fx-fore"),n=Array.from(t.querySelectorAll("fx-instance"));this.shadowRoot.innerHTML=`\n            <style>\n                ${e}\n            </style>\n            <div class="main">\n            <slot></slot>\n            <span class="handle"></span>\n                ${n.map((e=>`\n                  <details>\n                      <summary>${e.id}</summary>\n                      <pre id="${e.id}"></pre>\n                  </details>\n                `))}\n            </div>\n        `;this.shadowRoot.querySelector(".handle").addEventListener("click",(e=>{this.hasAttribute("open")?this.removeAttribute("open"):this.setAttribute("open","open")}))}serializeDOM(e){if(!e)return;return rt((new XMLSerializer).serializeToString(e))}}customElements.get("fx-inspector")||customElements.define("fx-inspector",nn);class rn extends HTMLElement{static get properties(){return{id:String}}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.shadowRoot.innerHTML=this.render("\n          :host {\n            display:none;\n            height: 100vh;\n            width:100vw;\n            position:fixed;\n            left:0;\n            top:0;\n            right:0;\n            bottom:0;\n            transition:opacity 0.4s linear;\n          }\n\n        "),this.id=this.getAttribute("id");const e=this.querySelector(".close-dialog");e&&e.addEventListener("click",(()=>{this.classList.remove("show")})),this.focus()}render(e){return`\n      <style>\n          ${e}\n      </style>\n      <slot></slot>\n    `}open(){window.addEventListener("keyup",(e=>{"Escape"===e.key&&this.hide()}),{once:!0}),this.classList.add("show")}async hide(){await St.fadeOutElement(this,400),this.classList.remove("show")}}customElements.get("fx-dialog")||customElements.define("fx-dialog",rn);class on extends $t{static get properties(){return{...super.properties,valueAttr:{type:String}}}constructor(){super(),this.valueAttr=this.hasAttribute("value")?this.getAttribute("value"):null}connectedCallback(){super.connectedCallback(),this.addEventListener("click",(e=>{const t=this.querySelectorAll("[value]");let n;"LABEL"===e.target.nodeName&&(n=ct(e.target.getAttribute("for"),this),n.checked=!n.checked);let r="";Array.from(t).forEach((e=>{e.checked&&(r+=` ${e.getAttribute("value")}`)})),this.setAttribute("value",r.trim());const o=et.getClosest("[ref]",this.parentNode);if(!o)return;const i=o.getModelItem(),a=this.shadowRoot.getElementById("setvalue");a.setValue(i,r.trim()),a.actionPerformed()}))}getWidget(){return this}async updateWidgetValue(){const e=et.getClosest("[ref]",this.parentNode);e&&(this.value=e.value),this.setAttribute("value",this.value)}updateEntry(e,t){const n=e.querySelector("label");n.textContent=t.textContent;const r=St.createUUID();n.setAttribute("for",r);const o=e.querySelector("[value]"),i=o.value,a=xt(i.substring(1,i.length-1),t,e),s=` ${a} `,u=` ${this.getAttribute("value")} `;o.value=a,o.setAttribute("id",r),-1!==u.indexOf(s)&&(o.checked=!0)}}customElements.get("fx-items")||customElements.define("fx-items",on);class an extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.eventName="",this.shortName="",this.shortInfo="",this.shortPath="",this.xpath=""}connectedCallback(){this.eventName=this.getAttribute("event-name"),this.shortName=this.getAttribute("short-name"),this.shortInfo=this.hasAttribute("short-info")?this.getAttribute("short-info"):"",this.xpath=this.getAttribute("xpath");const e=`\n       <details class="info send">\n              <summary>\n                <span class="log-name"><a href="#" title="${("/"+this.xpath.substring(this.xpath.indexOf("/fx-fore"),this.xpath.length)).replaceAll("fx-","")}" data-path="${this.xpath}">${this.shortName}</a></span>\n                <span class="short-info">${this.shortInfo}</span>\n                <span class="event-name">${this.eventName}</span>                    \n              </summary>\n            <slot></slot>\n        </details>\n    `;this.shadowRoot.innerHTML=`\n        <style>\n            \n      :host {\n        height: auto;\n        font-size: 0.8em;\n        font-weight: 400;\n\n      }\n\n      a,a:link,a:visited{\n        color:black;\n      }\n      a{\n        position:relative;\n      }\n      a[alt]:hover::after {\n        content:attr(alt);\n        position:absolute; \n        left:0;\n        top:1em;\n        border.thin solid;\n        padding:0.5em;\n        background:white;\n        z-index:1;\n        min-width:5em;\n        border:thin solid;\n        white-space:nowrap;\n        overflow-wrap:break-word;\n      }\n\n     .info{\n        padding:0 0.5em;\n        margin:0.1rem 0;\n        background:white;\n        position:relative;\n        border:1px solid #ddd;\n        border-radius:1em;       \n        box-shadow: 1px 1px 5px 0px rgba(79, 136, 183, 0.8);\n      }\n      :host(.action) .info{\n        border-radius:0;\n        border-color:steelblue;\n      }\n\n      .info label{\n        grid-area:left;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .info a{\n        grid-area:right;\n        justify-self:end;\n      }\n      .info:hover{\n        outline:3px solid lightblue;       \n        transition:height 0.4s;\n      }\n\n       summary{\n        padding:1em;\n        display:flex;\n        flex-wrap:wrap;\n        padding:0.5em 0;\n        cursor:pointer;\n        gap:0.25em;\n      }\n/*\n      .log-name{\n        font-size:1.2em;\n      }\n      .log-name, .short-info{\n        width:10em;\n      }\n*/\n      .event-name{\n        width:12em;\n        text-align:right;\n        }\n      .short-info{\n        flex:3;\n        overflow:hidden;\n        white-space:nowrap;\n        text-overflow:ellipsis;\n      }\n    \n        </style>\n        ${e}\n    `}}customElements.get("fx-log-item")||customElements.define("fx-log-item",an);class sn extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.listenTo=[],this.listeners=[]}connectedCallback(){localStorage.getItem("fx-log-settings")?this.listenTo=JSON.parse(localStorage.getItem("fx-log-settings")):this.listenTo=sn.defaultSettings();this.shadowRoot.innerHTML='\n        <style>\n            \n      :host {\n        display:block;\n        position:relative;\n        width:100%;\n        border:thin solid #efefef;\n        font-family: Verdana, Sans;\n\n        margin:0;\n        border:thin solid #ddd;\n      }\n      .boxes{\n        column-width:14rem;\n        overflow:auto;\n        margin-bottom:5em;\n        padding:1em;\n      }\n      .boxes > span{\n        display:inline-block;\n        width:14rem;\n      }\n      \n      .buttons{\n        position:absolute;\n        top:0;\n        right:0;\n      }\n      .buttons button{\n        padding:0;\n      }\n      button{\n        float:right;\n      }\n      button{\n        border:none;\n        background:transparent;\n        width:2.25rem;\n        height:2.25rem;\n        cursor:pointer;\n      }\n      button#reset{\n        padding:0;\n        height:1rem;\n      }\n      header{\n        padding:0.5rem;\n        margin:0;\n        border-bottom:2px solid #ddd;\n      }\n      #settings{\n        padding:1em;\n      }\n      \n    \n        </style>\n        \n        <section id="settings">\n            <header>log settings <button id="reset">reset</button></header>\n            <div class="boxes"></div>\n        </section>\n    \n    ',window.document.querySelector("fx-fore");const e=this.shadowRoot.querySelector(".boxes");this.listenTo.forEach((t=>{const n=document.createElement("span");e.append(n);const r=document.createElement("label");r.setAttribute("title",t.description),r.setAttribute("for",t.name),r.innerText=t.name;const o=document.createElement("input");o.setAttribute("type","checkbox"),o.setAttribute("name",t.name),o.setAttribute("id",t.name),t.show&&o.setAttribute("checked",""),n.append(o),n.append(r),o.addEventListener("click",(e=>{if(!e.target.checked){document.querySelector("fx-fore").removeEventListener(t.name,this._log)}const n=this.listenTo.find((e=>e.name===t.name));e.target.checked?n.show=!0:n.show=!1,localStorage.setItem("fx-log-settings",JSON.stringify(this.listenTo))}))}));this.shadowRoot.querySelector("#reset").addEventListener("click",(e=>{localStorage.removeItem("fx-log-settings"),window.location.reload()}))}static defaultSettings(){return[{name:"action-performed",show:!1,description:"fires after an action has been performed"},{name:"click",show:!1,description:""},{name:"deleted",show:!1,description:"fires after a delete action has been executed"},{name:"deselect",show:!1,description:"fires when fx-case is deselected"},{name:"dialog-hidden",show:!1,description:"fires after fx-dialog has been hidden"},{name:"dialog-shown",show:!1,description:"fired when a dialog has been shown"},{name:"error",show:!1,description:"fires after an error occurred"},{name:"execute-action",show:!0,description:"fires when an action executes"},{name:"init",show:!1,description:"fires when a control initializes"},{name:"index-changed",show:!1,description:"fires when the repeat index changes"},{name:"insert",show:!1,description:"fires when an fx-insert is executed"},{name:"instance-loaded",show:!1,description:"fires after an fx-instance has been loaded"},{name:"invalid",show:!1,description:"fires after a control became invalid"},{name:"item-changed",show:!1,description:"fires when a repeat item was changed"},{name:"item-created",show:!1,description:"fires when a repeat item was created"},{name:"loaded",show:!1,description:"fires after a fx-load has loaded"},{name:"model-construct",show:!1,description:"fires when a model gets constructed"},{name:"model-construct-done",show:!1,description:"fires after model initialization"},{name:"nonrelevant",show:!1,description:"fires after an fx-control became nonrelevant"},{name:"optional",show:!1,description:"fires after an fx-control became optional"},{name:"outermost-action-end",show:!1,description:"fires when an outermost action block is finished"},{name:"outermost-action-start",show:!1,description:"fires when an outermost action block is started"},{name:"path-mutated",show:!1,description:"fires when a path in a repeat has been mutated"},{name:"readonly",show:!1,description:"fires after an fx-control became readonly"},{name:"readwrite",show:!1,description:"fires after an fx-control became readwrite"},{name:"ready",show:!1,description:"fires after a fx-fore page has been completely initialized"},{name:"rebuild-done",show:!1,description:"fires after a rebuild has taken place"},{name:"recalculate-done",show:!1,description:"fires after a recalculate has taken place"},{name:"refresh-done",show:!1,description:"fires after a refresh has been done"},{name:"relevant",show:!1,description:"fires after a fx-control has become relevant"},{name:"reload",show:!1,description:"fires when a fx-reload action executes"},{name:"required",show:!1,description:"fires after an fx-control has become required"},{name:"return",show:!1,description:"fires after a fx-return returned"},{name:"select",show:!1,description:"fires when an fx-case has been selected"},{name:"submit",show:!1,description:"fires before a submission takes place"},{name:"submit-done",show:!1,description:"fires after a submission has successfully been executed"},{name:"submit-error",show:!1,description:"fires when a submission returned an error"},{name:"valid",show:!1,description:"fires after a fx-control has become valid"},{name:"value-changed",show:!1,description:"fires after a fx-control has changed its value"}]}_log(e,t){const n=e.target.nodeName;if("FX-ACTION-LOG"===n)return;const r=document.createElement("div");r.classList.add("log-row");const o=this._logDetails(e);if(e.detail&&0===Object.keys(e.detail).length&&Object.getPrototypeOf(e.detail)===Object.prototype&&r.classList.add("no-detail"),r.innerHTML=o,this.outermost){if("outermost-action-start"===e.type)return;this.outermostAppender||(this.outermostAppender=document.createElement("ul"),t.append(this.outermostAppender));const n=document.createElement("li");n.append(r),this.outermostAppender.append(n)}else t.append(r);this.parentPath&&"FX-ACTION"!==n&&r.classList.add("nested");const i=e.target;r.addEventListener("click",(e=>{this._highlight(i)}));const a=r.querySelector(".event-target");a&&a.addEventListener("click",(e=>{document.querySelectorAll(".fx-action-log-debug").forEach((e=>{e.classList.remove("fx-action-log-debug")})),i.dispatchEvent(new CustomEvent("log-action",{composed:!1,bubbles:!0,cancelable:!0,detail:{target:i}})),i.classList.add("fx-action-log-debug"),i.setAttribute("data-name",i.nodeName),this._highlight(i)}))}_logDetails(e){const t=e.type,n=et.getPath(e.target),r=n.substring(n.indexOf("/fx-fore"),n.length),o=`/${r}`,i=r.replaceAll("fx-","");switch(this.parentPath&&!o.startsWith(this.parentPath)&&(this.parentPath=null),t){case"deleted":const{deletedNodes:n}=e.detail,r=new XMLSerializer;let a="";return n.forEach((e=>{a+=r.serializeToString(e)})),`\n                <fx-log-item event-name="${t}"\n                             xpath="${o}"\n                             short-info="${e.detail.ref}"\n                             short-name="${e.target.nodeName.toLowerCase()}">\n                    <section class="details">\n                        <header>Details</header>\n                        <section>\n                            <span class="key">Deleted Nodes</span>\n                            <textarea class="value" rows="5">${a.trim()}</textarea>\n                        </section>\n                    </section>\n                </fx-log-item>\n                `;case"outermost-action-start":return"start";case"outermost-action-end":return"";case"execute-action":const s=e.detail.action;return this._renderAction(s,o,i,e);default:return`\n                <fx-log-item event-name="${t}"\n                             xpath="${o}"\n                             short-name="${e.target.nodeName.toLowerCase()}">\n                             \n                    <section class="details">\n                      ${this._listEventDetails(e)}\n                    </section>\n                </fx-log-item>\n            `}}_renderAction(e,t,n,r){switch(e.nodeName.split("-")[1],e.nodeName){case"FX-ACTION":return this.parentPath=t,`\n                <fx-log-item event-name="${r.detail.event}"\n                             xpath="${t}"\n                             short-name="ACTION" class="action">\n                    <section class="details">\n                      <header>Attributes</header>\n                      <section>\n                      ${Array.from(e.attributes).map((e=>`\n                        <span class="key">${e.nodeName}</span>\n                        <span class="value">${e.nodeValue}</span>\n                      `)).join("")}                 \n                      </section>\n                    </section>\n                </fx-log-item>  \n            `;case"FX-MESSAGE":const n=r.detail.action.messageTextContent;return`\n                    <fx-log-item event-name="${r.detail.event}"\n                                 xpath="${t}"\n                                 short-name="MESSAGE"\n                                 short-info="${n}" class="action">\n                        <section class="details">\n                            <span>${n}</span>\n                        </section>\n                    </fx-log-item>\n                `;case"FX-SEND":const o=document.querySelector(`#${r.detail.action.getAttribute("submission")}`);return`\n                <fx-log-item short-name="SEND"\n                             short-info="${o.id}"\n                             event-name="${r.detail.event}"\n                             xpath="${t}" class="action">\n                        <section class="details">\n                          <header>Submission</header>\n                          <section class="attributes">\n                          ${Array.from(o.attributes).map((e=>`\n                            <span class="key">${e.nodeName}</span>\n                            <span class="value">${e.nodeValue}</span>\n                          `)).join("")}                 \n                          </section>  \n                        </section>\n               </fx-log-item>\n                `;case"FX-SETVALUE":return`\n                <fx-log-item short-name="SETVALUE"\n                             short-info="${et.getPath(r.target.nodeset)}"\n                             event-name="${"FX-CONTROL"===r.target.nodeName?r.target.updateEvent:r.detail.event}"\n                             xpath="${t}" class="action">\n                      <section class="details">\n                          <span class="key">value</span>\n                          <span class="value">${r.detail.value}</span>\n                      </section>\n                </fx-log-item>\n                `;default:return`\n                    <fx-log-item event-name="${r.detail.event}" \n                                short-name="${r.target.nodeName}"\n                                xpath="${t}"\n                                class="action">\n                          <section class="details">\n                          </section>\n                    </fx-log-item>\n                    `}}_listEventDetails(e){return e.detail&&0===Object.keys(e.detail).length&&Object.getPrototypeOf(e.detail)===Object.prototype?"":`${Object.keys(e.detail).map((e=>`<span>${e}</span>`))}`}_listAttributes(e){return""}_highlight(e){const t=e.style.backgroundColor,n=e.style.transition;e.style.transition="background 1s",e.style.backgroundColor="#FFA500",setTimeout((()=>{e.style.backgroundColor=t,setTimeout((()=>{e.style.transition=n}),400)}),400),window.document.dispatchEvent(new CustomEvent("log-active-element",{detail:{target:e}}))}}customElements.get("fx-log-settings")||customElements.define("fx-log-settings",sn);class un extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.listenTo=[],this.listeners=[]}connectedCallback(){localStorage.getItem("fx-action-log-filters")?this.listenTo=JSON.parse(localStorage.getItem("fx-action-log-filters")):this.listenTo=sn.defaultSettings(),localStorage.getItem("fx-log-settings")?this.listenTo=JSON.parse(localStorage.getItem("fx-log-settings")):this.listenTo=sn.defaultSettings();this.shadowRoot.innerHTML='\n        <style>\n            \n      :host {\n        display:block;\n        position:relative;\n        width:100%;\n        border:thin solid #efefef;\n        background:transparent;\n        font-family: Verdana, Sans;\n        margin:0;\n        padding:0.25rem;\n      }\n      a,a:link,a:visited{\n        color:black;\n      }\n      a{\n        position:relative;\n      }\n      a[alt]:hover::after {\n        content:attr(alt);\n        position:absolute; \n        left:0;\n        bottom:-0.5em;\n        border:thin solid;\n        padding:0.5em;\n        background:white;\n        z-index:1;\n        min-width:5em;\n        border:thin solid;\n        max-width:90%;\n      }\n     .details{\n        padding:0.25em 0;\n      }\n\n      .key{\n        width:20%;\n        display:inline-block;\n        min-width:5rem;\n        border-bottom:1px solid #ddd;\n        background:#efefef;\n        vertical-align:top;\n      }\n      .value{\n        display:inline-block;\n        width:60%;\n        \n      }\n      \n      .buttons{\n        position:absolute;\n        top:0;\n        right:0;\n      }\n      .buttons button{\n        padding:0;\n      }\n      button{\n        float:right;\n      }\n      button{\n        border:none;\n        background:transparent;\n        width:2.25rem;\n        height:2.25rem;\n        cursor:pointer;\n      }\n      button#reset{\n        padding:0;\n        height:1rem;\n      }\n     .info{\n        padding:0 0.5em;\n        margin:0.1rem 0;\n        background:white;\n        position:relative;\n        display:grid;\n        grid-template-areas: "left right"\n                    "bottom .";\n        grid-template-columns: 75% 25%;\n      }\n      .info a{\n        grid-area:right;\n        justify-self:end;\n      }\n      .details > section{\n        display:flex;\n        flex-wrap:wrap;\n        padding:0.5em 0;\n      }\n      fx-log-item{\n      }\n      header{\n        padding:0.5rem;\n        margin:0;\n        border-bottom:2px solid #ddd;\n      }\n      \n      .info:hover{\n        outline:3px solid lightblue;       \n        transition:height 0.4s;\n      }\n\n      ol{\n        background: #efefef;\n        padding: 0.5em 0 0 2em;\n        border-left:3px solid red;\n      }\n     \n      .event-name{\n        display:inline-block;\n      }\n      #log{\n        margin-bottom:10em;\n        margin-right:2em;\n      }\n      .log-row{\n        margin:0;\n        padding:0;\n        position:relative;\n        font-size:0.8em;\n        border-left:4px solid transparent;\n        padding-left:5px;\n        width:calc(100% - 2em);\n        margin-bottom:0.25em;\n      }\n      .log-row summary{\n        display:flex;\n        flex-wrap:wrap;\n        padding:0.5em 0;\n        cursor:pointer;\n      }\n      .log-row summary > span {\n        width:calc(90% div 3);\n      }\n\n      .log-name{\n        position:relative;\n      }\n      .short-info{\n        flex:3;\n        overflow:hidden;\n        white-space:nowrap;\n        text-overflow:ellipsis;\n      }\n      .log-row.no-detail summary{\n        position:relative;\n      }\n      .log-row.no-detail summary{\n        list-style:none;\n        padding-left:1rem;\n      }\n      .log-row.no-detail summary::-webkit-details-marker {\n        display: none;\n      }\n      .log-row.nested{\n        margin-left:1em;\n      }\n      .nested .event-name{\n        display:none;\n      }\n      \n      .setvalue .value{\n        background:lightyellow;\n      }\n       summary{\n        padding:1em;\n        border-bottom:2px solid #ddd;\n      }\n      .outer-details{\n        height:100%;\n        overflow:auto;\n        margin-top:2rem;\n        background:rgba(250, 250, 250, 0.9);\n      }\n      \n      .outer-details > header{\n        position:absolute;\n        top:-1px;\n        width:calc(100% - 2rem);\n        border-bottom:2px solid #ddd;\n        font-size:1rem;\n        height:1rem;\n     }\n      .outer-details > summary{\n        font-size:1em;\n      }\n      ul{\n        list-style:none;\n        padding:0;\n        margin:0.1em 0;\n        border-left:3px solid steelblue;\n        padding:0.1em 0;\n      }\n      ul .log-row{\n        padding-left:3px;\n        width:calc(100% - 1em);\n      }\n    \n        </style>\n        \n      <section open class="outer-details">\n        <header>Log \n            <span class="buttons">\n                <button id="del"" title="empty log - Ctrl+d">\n                    <svg viewBox="0 0 24 24" style="width:24px;height:24px;" preserveAspectRatio="xMidYMid meet" focusable="true"><g><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"></path></g></svg></a>\n                </button>\n            </span>\n        </header>\n        <div id="log"></div>\n      </section>\n    \n    ',window.document.querySelector("fx-fore");const e=this.shadowRoot.querySelector("#log");this.listenTo.forEach((t=>{t.show&&document.addEventListener(t.name,(t=>{this._log(t,e)}))})),document.addEventListener("outermost-action-start",(e=>{this.outermost=!0}),{capture:!0}),document.addEventListener("outermost-action-end",(e=>{this.outermost=!1,this.outermostAppender=null}),{capture:!0});this.shadowRoot.querySelector("#del").addEventListener("click",(e=>{this.shadowRoot.querySelector("#log").innerHTML=""})),document.addEventListener("keydown",(e=>{e.ctrlKey&&"d"===e.key&&(this.shadowRoot.querySelector("#log").innerHTML="")}))}_defaultSettings(){this.listenTo=[{name:"action-performed",show:!1,description:"fires after an action has been performed"},{name:"click",show:!1,description:""},{name:"deleted",show:!1,description:"fires after a delete action has been executed"},{name:"deselect",show:!1,description:"fires when fx-case is deselected"},{name:"dialog-hidden",show:!1,description:"fires after fx-dialog has been hidden"},{name:"dialog-shown",show:!1,description:"fired when a dialog has been shown"},{name:"error",show:!1,description:"fires after an error occurred"},{name:"execute-action",show:!0,description:"fires when an action executes"},{name:"init",show:!1,description:"fires when a control initializes"},{name:"index-changed",show:!1,description:"fires when the repeat index changes"},{name:"insert",show:!1,description:"fires when an fx-insert is executed"},{name:"instance-loaded",show:!1,description:"fires after an fx-instance has been loaded"},{name:"invalid",show:!1,description:"fires after a control became invalid"},{name:"item-changed",show:!1,description:"fires when a repeat item was changed"},{name:"item-created",show:!1,description:"fires when a repeat item was created"},{name:"loaded",show:!1,description:"fires after a fx-load has loaded"},{name:"model-construct",show:!1,description:"fires when a model gets constructed"},{name:"model-construct-done",show:!1,description:"fires after model initialization"},{name:"nonrelevant",show:!1,description:"fires after an fx-control became nonrelevant"},{name:"optional",show:!1,description:"fires after an fx-control became optional"},{name:"outermost-action-end",show:!1,description:"fires when an outermost action block is finished"},{name:"outermost-action-start",show:!1,description:"fires when an outermost action block is started"},{name:"path-mutated",show:!1,description:"fires when a path in a repeat has been mutated"},{name:"readonly",show:!1,description:"fires after an fx-control became readonly"},{name:"readwrite",show:!1,description:"fires after an fx-control became readwrite"},{name:"ready",show:!1,description:"fires after a fx-fore page has been completely initialized"},{name:"rebuild-done",show:!1,description:"fires after a rebuild has taken place"},{name:"recalculate-done",show:!1,description:"fires after a recalculate has taken place"},{name:"refresh-done",show:!1,description:"fires after a refresh has been done"},{name:"relevant",show:!1,description:"fires after a fx-control has become relevant"},{name:"reload",show:!1,description:"fires when a fx-reload action executes"},{name:"required",show:!1,description:"fires after an fx-control has become required"},{name:"return",show:!1,description:"fired by embedded Fore controls to return their bound value"},{name:"select",show:!1,description:"fires when an fx-case has been selected"},{name:"submit",show:!1,description:"fires before a submission takes place"},{name:"submit-done",show:!1,description:"fires after a submission has successfully been executed"},{name:"submit-error",show:!1,description:"fires when a submission returned an error"},{name:"valid",show:!1,description:"fires after a fx-control has become valid"},{name:"value-changed",show:!1,description:"fires after a fx-control has changed its value"}]}_log(e,t){const n=e.target.nodeName;if("FX-ACTION-LOG"===n)return;const r=document.createElement("div");r.classList.add("log-row");const o=this._logDetails(e);if(e.detail&&0===Object.keys(e.detail).length&&Object.getPrototypeOf(e.detail)===Object.prototype&&r.classList.add("no-detail"),r.innerHTML=o,this.outermost){if("outermost-action-start"===e.type)return;this.outermostAppender||(this.outermostAppender=document.createElement("ul"),t.append(this.outermostAppender));const n=document.createElement("li");n.append(r),this.outermostAppender.append(n)}else t.append(r);this.parentPath&&"FX-ACTION"!==n&&r.classList.add("nested");const i=e.target;r.addEventListener("click",(e=>{this._highlight(i)}));const a=r.querySelector(".event-target");a&&a.addEventListener("click",(e=>{document.querySelectorAll(".fx-action-log-debug").forEach((e=>{e.classList.remove("fx-action-log-debug")})),i.dispatchEvent(new CustomEvent("log-action",{composed:!1,bubbles:!0,cancelable:!0,detail:{target:i}})),i.classList.add("fx-action-log-debug"),i.setAttribute("data-name",i.nodeName),this._highlight(i)}))}_logDetails(e){const t=e.type,n=et.getPath(e.target),r=n.substring(n.indexOf("/fx-fore"),n.length),o=`/${r}`,i=r.replaceAll("fx-","");switch(this.parentPath&&!o.startsWith(this.parentPath)&&(this.parentPath=null),t){case"deleted":const{deletedNodes:n}=e.detail,r=new XMLSerializer;let a="";return n.forEach((e=>{a+=r.serializeToString(e)})),`\n                <fx-log-item event-name="${t}"\n                             xpath="${o}"\n                             short-info="${e.detail.ref}"\n                             short-name="${e.target.nodeName.toLowerCase()}">\n                    <section class="details">\n                        <header>Details</header>\n                        <section>\n                            <span class="key">Deleted Nodes</span>\n                            <textarea class="value" rows="5">${a.trim()}</textarea>\n                        </section>\n                    </section>\n                </fx-log-item>\n                `;case"outermost-action-start":return"start";case"outermost-action-end":return"";case"execute-action":const s=e.detail.action;return this._renderAction(s,o,i,e);default:return`\n                <fx-log-item event-name="${t}"\n                             xpath="${o}"\n                             short-name="${e.target.nodeName.toLowerCase()}">\n                             \n                    <section class="details">\n                      ${this._listEventDetails(e)}\n                    </section>\n                </fx-log-item>\n            `}}_renderAction(e,t,n,r){let o;switch(e.nodeName.split("-")[1],e.nodeName){case"FX-ACTION":return this.parentPath=t,o=r.target.currentEvent?r.target.currentEvent.type:r.detail.event?r.detail.event:"",`\n                <fx-log-item event-name="${o}"\n                             xpath="${t}"\n                             short-name="ACTION"\n                              data-path="${r.detail.path}" \n                              class="action">\n                    <section class="details">\n                      <header>Attributes</header>\n                      <section>\n                      ${Array.from(e.attributes).map((e=>`\n                        <span class="key">${e.nodeName}</span>\n                        <span class="value">${e.nodeValue}</span>\n                      `)).join("")}                 \n                      </section>\n                    </section>\n                </fx-log-item>  \n            `;case"FX-MESSAGE":const n=r.detail.action.messageTextContent;return`\n                    <fx-log-item event-name="${r.detail.event}"\n                                 xpath="${t}"\n                                 short-name="MESSAGE"\n                                 short-info="${n}" class="action">\n                        <section class="details">\n                            <span>${n}</span>\n                        </section>\n                    </fx-log-item>\n                `;case"FX-SEND":const i=document.querySelector(`#${r.detail.action.getAttribute("submission")}`),a=r.detail.event?r.detail.event:"";return`\n                <fx-log-item short-name="SEND"\n                             short-info="${i.getAttribute("id")}"\n                             event-name="${a}"\n                             xpath="${t}" class="action"\n                             data-path="${r.detail.path}" >\n                        <section class="details">\n                          <header>Submission</header>\n                          <section class="attributes">\n                          ${Array.from(i.attributes).map((e=>`\n                            <span class="key">${e.nodeName}</span>\n                            <span class="value">${e.nodeValue}</span>\n                          `)).join("")}                 \n                          </section>  \n                        </section>\n               </fx-log-item>\n                `;case"FX-SETVALUE":return`\n                <fx-log-item short-name="SETVALUE"\n                             short-info="${et.getPath(r.target.nodeset)}"\n                             event-name="${"FX-CONTROL"===r.target.nodeName?r.target.updateEvent:r.detail.event?r.detail.event:""}"\n                             xpath="${t}"\n                             data-path="${r.detail.path}" class="action">\n                      <section class="details">\n                          <span class="key">value</span>\n                          <span class="value">${r.detail.value}</span>\n                      </section>\n                </fx-log-item>\n                `;default:return o=r.target.currentEvent?r.target.currentEvent.type:r.detail.event?r.detail.event:"",`\n                    <fx-log-item event-name="${o}" \n                                short-name="${r.target.nodeName}"\n                                xpath="${t}"\n                                data-path="${r.detail.path}" \n                                class="action">\n                          <section class="details">\n                          </section>\n                    </fx-log-item>\n                    `}}_listEventDetails(e){return e.detail&&0===Object.keys(e.detail).length&&Object.getPrototypeOf(e.detail)===Object.prototype?"":`${Object.keys(e.detail).map((e=>`<span>${e}</span>`))}`}_listAttributes(e){return""}_highlight(e){const t=e.style.backgroundColor,n=e.style.transition;e.style.transition="background 1s",e.style.backgroundColor="#FFA500",setTimeout((()=>{e.style.backgroundColor=t,setTimeout((()=>{e.style.transition=n}),400)}),400),window.document.dispatchEvent(new CustomEvent("log-active-element",{detail:{target:e}}))}}function cn(e,t){e.classList.add(t)}function ln(e,t){e.classList.remove(t)}function pn(e,t){if("object"!=typeof e)throw new Error(`containsOnlyText: Expected argument node of type object, ${typeof e} given.`);let n=!1,r=null;if(t=t||!1)for(let t=0,o=e.childNodes.length;t<o&&(r=e.childNodes[t],n=r.nodeType===Node.TEXT_NODE||r.nodeType===Node.COMMENT_NODE||r.nodeType===Node.CDATA_SECTION_NODE,n);t+=1);else n=e.nodeType===Node.TEXT_NODE||e.nodeType===Node.COMMENT_NODE||e.nodeType===Node.CDATA_SECTION_NODE;return n}function hn(e,t){const n=document.createElement(e);t=t||{};for(const e of Object.keys(t))n.setAttribute(e,t[e]);return n}function dn(e,t){const n=hn("span",{class:"adi-opt"});return n.innerHTML=`<label><input type="checkbox" data-opt="${e}">${t}</label>`,n}customElements.get("fx-action-log")||customElements.define("fx-action-log",un);class fn{constructor(e,t){this.sourceNodeByInspectorNodeLookup=new Map,this.uiView=null,this.menuView=null,this.domView=null,this.attrView=null,this.optsView=null,this.activeElement=null,this.vertResizing=!1,this.horizResizing=!1,this.pathScrolling=null,this.elemLookup=!1,this.styleBackup="",this.xPos=0,this.delegatedEvents=[],this.options={align:"right",split:50,minSplit:30,visible:!0,saving:!1,transparent:!0,omitEmptyText:!0,makeVisible:!0,foldText:!0,nodeTypes:[Node.ELEMENT_NODE,Node.TEXT_NODE,Node.COMMENT_NODE,Node.DOCUMENT_NODE]},"#document"===t?(this.instanceId="#document",this.document=window.document,this.isInstanceViewer=!1):(this.instanceId=t.id,!t||t.localName,this.document=t.getInstanceData(),this.isInstanceViewer=!0,this.options.foldText=!1),this.drawUI(e),this.registerEvents(),this.drawDOM(this.document,this.domView.querySelector(".adi-tree-view"),!0),document.addEventListener("execute-action",(e=>this.processExecuteAction))}getSelected(){if(!this.activeElement)return null;let e=document;return e=this.sourceNodeByInspectorNodeLookup.get(this.activeElement),e}loadOptions(){let e={};e=JSON.parse(window.localStorage.getItem("ADI.options"))||{};for(const t of Object.keys(e))this.options[t]=e[t]}saveOptions(){this.options.saving&&window.localStorage.setItem("ADI.options",JSON.stringify(this.options))}hasRequiredNodes(e){if("object"!=typeof e)throw new Error(`hasRequiredNodes: Expected argument node of type object, ${typeof e} given.`);if(e.hasChildNodes())for(let t=0,n=e.childNodes.length;t<n;t+=1){const n=e.childNodes[t];if(this.options.nodeTypes.includes(n.nodeType))return!0}return!1}newTreeNode(e){if("object"!=typeof e)throw new Error(`newTreeNode: Expected argument node of type object, ${typeof e} given.`);const t=this.hasRequiredNodes(e);let n=!1,r=e.nodeName.startsWith("FX-")?`adi-node ${e.nodeName.toLowerCase()}`:"";e.nodeName.startsWith("FX-")&&(r=`adi-node ${e.nodeName.toLowerCase()}`,r+=St.isActionElement(e.nodeName)?" action":"");const o=hn("li",{class:r});if(e===this.uiView)return null;if(t&&o.appendChild(hn("span",{class:"adi-trigger"})),this.options.omitEmptyText&&e.nodeType===Node.TEXT_NODE&&(n=function(e){if("object"!=typeof e)throw new Error(`isEmptyTextNode: Expected argument node of type object, ${typeof e} given.`);return/^\s*$/.test(e.textContent)}(e)),!n){const n=hn("span");this.sourceNodeByInspectorNodeLookup.set(n,e),this.sourceNodeByInspectorNodeLookup.set(e,n);let r=null;if(pn(e))e.nodeType===Node.COMMENT_NODE?(cn(n,"adi-comment-node"),"string"==typeof n.innerText&&(n.innerText=`\x3c!-- ${e.textContent} --\x3e`)):(cn(n,"adi-text-node"),n.textContent=e.textContent);else if(cn(n,"adi-normal-node"),e.nodeType!==Node.DOCUMENT_NODE){if("FX-BIND"===e.nodeName)n.textContent=`<${e.nodeName.toLowerCase()} ref="${e.getAttribute("ref")}">`;else if("FX-INSERT"===e.nodeName)n.textContent=`<${e.nodeName.toLowerCase()} ref="${e.getAttribute("ref")}">`;else if("FX-INSTANCE"===e.nodeName)n.textContent=`<${e.nodeName.toLowerCase()} id="${e.id}">`;else if("FX-CONTROL"===e.nodeName)n.textContent=`<${e.nodeName.toLowerCase()} ref="${e.getAttribute("ref")}">`;else if("FX-SEND"===e.nodeName)n.textContent=`<${e.nodeName.toLowerCase()} submission="${e.getAttribute("submission")}">`;else if("FX-SETVALUE"===e.nodeName)n.textContent=`<${e.nodeName.toLowerCase()} ref="${e.getAttribute("ref")}">`;else if("FX-SUBMISSION"===e.nodeName)n.textContent=`<${e.nodeName.toLowerCase()} id="${e.getAttribute("id")}">`;else{const t=Array.from(e.attributes).filter((e=>{return!!this.isInstanceViewer||("id"===(t=e.name)||"ref"===t||"event"===t);var t})).map((e=>`${e.name}="${e.value}"`)).join(" ");n.textContent=`<${e.nodeName.toLowerCase()}${t?` ${t}`:""}>`}t&&(r=hn("span"),cn(r,"adi-end-node"),r.textContent=`</${e.nodeName.toLowerCase()}>`)}else n.textContent=e.nodeName.toLowerCase();return o.appendChild(n),e.nodeName.startsWith("FX-")&&(n.classList.add("fore-node"),n.classList.add(e.nodeName.toLowerCase())),r&&(o.appendChild(r),e.nodeName.startsWith("FX-")&&r.classList.add("fore-node")),o}return null}drawDOM(e,t,n){if("object"!=typeof e)throw new Error(`drawDOM: Expected argument root of type object, ${typeof e} given.`);let r=null,o=!0;const i=t.nodeName.startsWith("FX-")?`adi-node ${node.nodeName.toLowerCase()}`:"";n&&-1!==this.options.nodeTypes.indexOf(e.nodeType)&&(t.innerHTML="",r=this.newTreeNode(e),this.hasRequiredNodes(e)&&(r.appendChild(hn("ul",{"data-open":!0,class:i})),cn(r.querySelector(".adi-trigger"),"opened")),t.appendChild(r),t=t.querySelector("ul"));for(let n=0,a=e.childNodes.length;n<a;n+=1){const a=e.childNodes[n],s=this.hasRequiredNodes(a);if(-1!==this.options.nodeTypes.indexOf(a.nodeType)&&(r=this.newTreeNode(a),r)){if(s&&(o=!this.options.foldText||!pn(a,!0),"HEAD"===a.nodeName&&(o=!1),"SELECT"===a.nodeName&&(o=!1),"FX-INSTANCE"===a.nodeName&&(o=!1),a.nodeType===Node.DOCUMENT_NODE?r.appendChild(hn("ul",{"data-open":o,class:i})):r.insertBefore(hn("ul",{"data-open":o,class:i}),r.lastChild),cn(r.querySelector(".adi-trigger"),o?"opened":"closed")),t.appendChild(r),this.getSelected()===a){const e=r.querySelector("span.adi-normal-node");e?.classList?.add("adi-active-node"),this.activeElement=e,r.scrollIntoView({block:"nearest",behavior:"instant"})}s&&this.drawDOM(a,r.querySelector("ul"),!1)}}}toggleOptions(){-1!==this.optsView.className.indexOf("adi-hidden")?ln(this.optsView,"adi-hidden"):(cn(this.optsView,"adi-hidden"),this.attrView.querySelector(".adi-content").innerHTML="",this.refreshUI(),this.drawDOM(document,this.domView.querySelector(".adi-tree-view"),!0),this.options.saving?this.saveOptions():window.localStorage.removeItem("ADI.options"))}drawUI(e){this.uiView=hn("div",{id:"adi-wrapper",class:this.options.transparent?"transparent":""}),this.domView=hn("div",{id:"adi-dom-view"});const t=hn("div",{class:"adi-content",id:"detailsView"}),n=hn("ul",{class:"adi-tree-view"}),r=hn("div",{class:"adi-path-wrap"}),o=hn("span",{class:"adi-path-left"}),i=hn("span",{class:"adi-path-right"});this.menuView=hn("div",{id:"adi-panel"});const a=hn("div",{class:"adi-menu-wrap"}),s=hn("a",{class:"adi-menu-config",title:"Settings"}),u=hn("a",{class:"adi-menu-lookup",title:"Lookup tool"});if(this.optsView=function(){const e=hn("div",{id:"adi-opts-view",class:"adi-hidden"}),t=hn("span",{class:"adi-opt-heading"}),n=hn("span",{class:"adi-opt-heading"}),r=hn("span",{class:"adi-opt-close"});return t.textContent="General options",n.textContent="Observed nodes",e.appendChild(t),e.appendChild(dn("saving","Enable saving of settings")),e.appendChild(dn("makeVisible","Scroll to the active element in DOM View")),e.appendChild(dn("omitEmptyText","Hide empty text nodes")),e.appendChild(dn("foldText","Fold the text nodes")),e.appendChild(dn("transparent","Enable transparent background")),e.appendChild(n),e.appendChild(dn("nodeTypes-3","Text node")),e.appendChild(dn("nodeTypes-8","Comment node")),e.appendChild(r),e}(),t.appendChild(n),this.domView.appendChild(this.menuView),this.domView.appendChild(t),r.appendChild(o),r.appendChild(i),a.appendChild(u),a.appendChild(s),this.menuView.appendChild(r),this.menuView.appendChild(a),this.uiView.appendChild(this.optsView),this.uiView.appendChild(this.domView),!this.isInstanceViewer){this.attrView=hn("div",{id:"adi-attr-view"});const e=hn("div",{class:"adi-content"});this.attrView.appendChild(e),this.uiView.appendChild(this.attrView)}e.appendChild(this.uiView),this.refreshUI(!0)}refreshUI(e){null!==this.uiView&&(e&&this.loadOptions(),e&&(this.optsView.querySelector('[data-opt="transparent"]').checked=this.options.transparent,this.optsView.querySelector('[data-opt="saving"]').checked=this.options.saving,this.optsView.querySelector('[data-opt="omitEmptyText"]').checked=this.options.omitEmptyText,this.optsView.querySelector('[data-opt="makeVisible"]').checked=this.options.makeVisible,this.optsView.querySelector('[data-opt="foldText"]').checked=this.options.foldText,this.optsView.querySelector('[data-opt="nodeTypes-3"]').checked=-1!==this.options.nodeTypes.indexOf(3),this.optsView.querySelector('[data-opt="nodeTypes-8"]').checked=-1!==this.options.nodeTypes.indexOf(8)),this.uiView.className=this.options.transparent?"transparent":"",this.domView.querySelector(".adi-content").style.height=`${this.domView.clientHeight}px`,this.isInstanceViewer||(this.attrView.querySelector(".adi-content").style.height=this.attrView.clientHeight-this.menuView.clientHeight+"px"),cn(this.uiView,this.options.align))}toggleVisibilityUI(){null!==this.uiView&&(this.uiView.style.display=this.options.visible?"none":"block",this.options.visible=!this.options.visible,this.saveOptions())}drawAttrs(e){if(this.isInstanceViewer)return;const t=this.attrView.querySelector(".adi-content");t.innerHTML="";const n=document.createElement("header");n.innerText="Attributes",t.appendChild(n),[...e.attributes].forEach((e=>{"style"!==e.name&&t.appendChild(function(e,t){const n=hn("span",{class:"adi-attr"});switch(e.toLowerCase()){case"defaultaction":n.innerHTML=`<label>${e}: <select data-attr="${e}" value="${t}"><option>perform</option><option>cancel</option></label>`;break;case"delay":n.innerHTML=`<label>${e}: <input type="number" data-attr="${e}" value="${t}" readonly="readonly"></label>`;break;default:n.innerHTML=`<label>${e}: <input type="text" data-attr="${e}" value="${t}" readonly="readonly"></label>`}return n}(e.name,e.value))}))}changeAttribute(e){const t=e?e.target:window.event.srcElement,n=t.getAttribute("data-attr"),r=t.value,o=this.getSelected();""===r?o.removeAttribute(n):o.setAttribute(n,r)}changeOption(e){const t=e?e.target:window.event.srcElement,n=t.getAttribute("data-opt"),r=t.checked;if(-1!==n.indexOf("nodeTypes")){const e=parseInt(n.match(/\d+/)[0],10);r?this.options.nodeTypes.push(e):this.options.nodeTypes.splice(this.options.nodeTypes.indexOf(e),1)}else this.options[n]=r}processKey(e){if(272===((e=e||window.event).keyCode||e.which))this.toggleVisibilityUI()}verticalResize(e){if(!this.vertResizing)return;e=e||window.event,document.documentElement.style.cursor="e-resize";const t=this.options.width+this.xPos-e.clientX;t>=this.options.minWidth&&(this.options.width=t,this.xPos=e.clientX,this.refreshUI(),this.saveOptions())}horizontalResize(e){if(!this.horizResizing)return;e=e||window.event,document.documentElement.style.cursor="n-resize";const t=Math.floor(e.clientY/this.uiView.clientHeight*100);t>=this.options.minSplit&&t<=100-this.options.minSplit&&(this.options.split=t,this.refreshUI(),this.saveOptions())}processExecuteAction(e){this.refreshUI()}handleActive(e){let t=e?e.detail?.target||e.target:window.event.srcElement;const n=this.domView.querySelector(".adi-active-node");if(n&&ln(n,"adi-active-node"),!t||t.nodeType===Node.DOCUMENT_NODE)return;if(t&&t.classList&&t.classList.contains("adi-end-node")&&(t=t.parentNode.querySelector(".adi-normal-node")),this.activeElement=t,cn(t,"adi-active-node"),this.options.makeVisible){this.domView.querySelector(".adi-content").scrollIntoView({block:"center",behavior:"instant"})}const r=this.getSelected();if(this.drawAttrs(r),r&&"function"==typeof r.getModelItem&&r.getModelItem()?.node){let e=r.modelItem.node;e?.nodeType===Node.ATTRIBUTE_NODE&&(e=e.ownerElement)}window.document.dispatchEvent(new CustomEvent("log-active-element",{detail:{target:r}}))}highlightElement(e){let t=e?e.target:window.event.srcElement;t.classList.contains("adi-end-node")&&(t=t.parentNode.querySelector(".adi-normal-node"));const n=this.sourceNodeByInspectorNodeLookup.get(t);n&&n.ownerDocument===window.document&&n&&("mouseover"===e.type?(this.styleBackup=n.getAttribute("style")||"",n.setAttribute("style",`outline: 2px solid blue; ${this.styleBackup}`)):""===this.styleBackup?n.removeAttribute("style"):n.setAttribute("style",this.styleBackup))}handleLookup(e){const t=e?e.detail?.target||e.target:window.event.srcElement;if(!this.document.contains(t))return;if(t.nodeType===Node.DOCUMENT_NODE)return;if(-1!==t.className.indexOf("adi-menu-lookup"))return this.elemLookup?(ln(t,"adi-active"),this.elemLookup=!1,this.removeEvent(document.body,"mouseover",this.handleLookup,!0),this.removeEvent(document.body,"mouseout",this.handleLookup,!0),void this.removeEvent(document.body,"click",this.handleLookup,!0)):(cn(t,"adi-active"),this.elemLookup=!0,this.addEventDelegate(document.body,"mouseover",this.handleLookup,!1,"*",!0,"adi-wrapper"),this.addEventDelegate(document.body,"mouseout",this.handleLookup,!1,"*",!0,"adi-wrapper"),void this.addEventDelegate(document.body,"click",this.handleLookup,!1,"*",!0,"adi-wrapper"));if("mouseover"===e.type)return this.styleBackup=t.getAttribute("style")||"",void t.setAttribute("style",`outline: 1px dashed red; ${this.styleBackup}`);if("mouseout"===e.type)return void t.setAttribute("style",this.styleBackup);this.elemLookup=!1,ln(this.menuView.querySelector(".adi-menu-lookup"),"adi-active"),t.setAttribute("style",this.styleBackup),this.removeEvent(document.body,"mouseover",this.handleLookup,!0),this.removeEvent(document.body,"mouseout",this.handleLookup,!0),this.removeEvent(document.body,"click",this.handleLookup,!0),function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1}(e);const n=this.sourceNodeByInspectorNodeLookup.get(t);if(!n)return;if(n&&n.click(),!n.parentNode)return;let r,o=n.parentNode;for(o.querySelector("ul")&&o.querySelector("ul").setAttribute("data-open","true");o!==this.domView.querySelector(".adi-content");)-1!==o.className.indexOf("adi-node")&&(r=o.querySelector(".adi-trigger"),r&&(ln(r,"closed"),cn(r,"opened")),o=o.parentNode,o.setAttribute("data-open","true")),o=o.parentNode;this.options.makeVisible&&n.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"}),t.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"})}addEventDelegate(e,t,n,r,o,i,a){const s=e=>{const t=e?e.target:window.event.srcElement,r=o.substr(1);let i=!1;if(a){let e=t;for(;e!==document;){if(e.id===a)return;e=e.parentNode}}i=0===o.indexOf("#")?t.id===r:0===o.indexOf(".")?-1!==t.className.indexOf(r):"*"===o||t.nodeName.toLowerCase()===o,i&&n(e)};i&&this.delegatedEvents.push({handle:s,elem:e,fn:n,evt:t}),e.addEventListener(t,s,r)}removeEvent(e,t,n,r){if("object"!=typeof e)throw new Error(`addEvent: Expected argument elem of type object, ${typeof e} given.`);let o=null;if(r)for(let r=0,i=this.delegatedEvents.length;r<i;r+=1)if(o=this.delegatedEvents[r],o.elem===e&&o.evt===t&&o.fn===n){n=o.handle,this.delegatedEvents.splice(r,1);break}}registerEvents(){const e=()=>{if("#document"!==this.instanceId){const e=window.document.querySelector(`#${this.instanceId}`);this.document=e.getInstanceData()}this.drawDOM(this.document,this.domView.querySelector(".adi-tree-view"),!0)};document.addEventListener("instance-loaded",e),document.addEventListener("value-changed",e),document.addEventListener("ready",e),document.addEventListener("mouseup",(()=>{document.documentElement.style.cursor="default",this.vertResizing=!1,this.horizResizing=!1}),!1),document.addEventListener("mousemove",(e=>this.verticalResize(e)),!1),document.addEventListener("mousemove",(e=>this.horizontalResize(e)),!1),window.addEventListener("resize",(e=>this.refreshUI(e)),!1),document.addEventListener("keypress",(e=>this.processKey(e)),!1),document.addEventListener("log-active-element",(e=>this.handleLookup(e)),!1);this.addEventDelegate(this.domView,"click",(e=>{const t=e?e.target:window.event.srcElement,n=t.parentNode.querySelector("ul");"true"===n.getAttribute("data-open")?(ln(t,"opened"),cn(t,"closed"),n.setAttribute("data-open","false")):(ln(t,"closed"),cn(t,"opened"),n.setAttribute("data-open","true"))}),!1,".adi-trigger"),this.addEventDelegate(this.domView,"click",(e=>this.handleActive(e)),!1,".adi-normal-node"),this.addEventDelegate(this.domView,"click",(e=>this.handleActive(e)),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseover",(e=>{cn((e?e.target:window.event.srcElement).parentNode.querySelector(".adi-normal-node"),"hover")}),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseout",(e=>{ln((e?e.target:window.event.srcElement).parentNode.querySelector(".adi-normal-node"),"hover")}),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseover",(e=>this.highlightElement(e)),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseover",(e=>this.highlightElement(e)),!1,".adi-normal-node"),this.addEventDelegate(this.domView,"mouseout",(e=>this.highlightElement(e)),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseout",(e=>this.highlightElement(e)),!1,".adi-normal-node"),this.menuView.querySelector(".adi-menu-lookup").addEventListener("click",(e=>this.handleLookup(e)),!1),document.addEventListener("handle-active",(e=>{if(e.detail.selected===this.getSelected())return;const{selected:t}=e.detail,n=this.sourceNodeByInspectorNodeLookup.get(t);if(this.options.makeVisible){const e=this.domView.querySelector(".adi-content");(n.offsetTop>=e.clientHeight||n.offsetTop<=e.scrollTop)&&(e.scrollTop=n.offsetTop-Math.floor(e.clientHeight/2))}this.drawAttrs(this.getSelected())})),document.addEventListener("execute-action",(e=>this.processExecuteAction(event)),{capture:!0}),this.addEventDelegate(this.optsView,"change",(e=>this.changeOption(e)),!1,"input"),this.addEventDelegate(this.optsView,"click",(e=>this.toggleOptions(e)),!1,".adi-opt-close"),this.menuView.querySelector(".adi-menu-config").addEventListener("click",(e=>this.toggleOptions(e)),!1),this.isInstanceViewer||this.addEventDelegate(this.attrView,"change",this.changeAttribute,!1,"input")}}class mn extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.instanceName=null,this.instance=null}connectedCallback(){this.render(),this.instance?this.shadowRoot.querySelector("#focus-button").style="display: none":this.setupFocusButton()}setInstance(e){this.instance=e}disconnectedCallback(){this.adiInstance=null}setupFocusButton(){let e="",t=null;const n=()=>{""===e?t.removeAttribute("style"):t.setAttribute("style",e),t=null},r=r=>{const{target:o}=r;if("mouseover"===r.type)return e=o.getAttribute("style")||"",o.setAttribute("style",`outline: 2px solid blue; ${e}`),void(t=o);t&&n()},o=this.shadowRoot.querySelector("#focus-button");let i=!1;const a=window.document.head.appendChild(document.createElement("style")),s=()=>{i=!1,window.document.body.removeEventListener("click",u),o.classList.remove("selected-btn"),a.innerHTML="",document.body.style.cursor="auto",window.document.body.removeEventListener("mouseover",r),window.document.body.removeEventListener("mouseout",r),t&&n()},u=e=>{s(),e.preventDefault(),e.stopPropagation(),e.target!==o&&window.document.dispatchEvent(new CustomEvent("log-active-element",{detail:{target:e.target}}))},c=()=>{i=!0,o.classList.add("selected-btn"),document.body.style.cursor="crosshair",window.document.body.removeEventListener("click",u),a.innerHTML='fx-fore::before { color:blue; content: "Sub fore!" } fx-fore {border: solid 1px blue}',window.document.body.addEventListener("click",u),window.document.body.addEventListener("mouseover",r),window.document.body.addEventListener("mouseout",r)};window.document.addEventListener("keyup",(e=>{i&&"Escape"===e.code?s():!i&&"KeyI"===e.code&&e.ctrlKey&&c()})),o.addEventListener("click",(e=>{i?s():c(),e.preventDefault(),e.stopPropagation()}))}render(){this.shadowRoot.innerHTML="\n          <style>\n              \n      @import '../../resources/fore.css';\n      \n        :host {\n          display:block;\n          background:transparent;\n        }\n        body {\n            -webkit-animation: bugfix infinite 1s;\n            font-size:1rem;\n        }\n        \n        @-webkit-keyframes bugfix {\n            from {\n                padding: 0\n            }\n            to {\n                padding: 0\n            }\n        }\n        .adi-content {\n            position: relative;\n            overflow: auto;\n            box-sizing: border-box;\n            -moz-box-sizing: border-box;\n            height: 100% !important;\n            padding:0;\n            font-size:0.8em;\n        }\n        .adi-content header{\n            padding:0.5rem;\n            // background:rgba(255, 255, 255, 0.2);\n            border-bottom:2px solid #ddd;\n            border-collapse:collapse;\n        }\n        .adi-content > * {\n            padding:0 0.25em;\n        }\n        \n        #adi-wrapper {\n            top: 0;\n            font-family: \"Segoe UI\", Arial;\n            font-size: 1.1rem;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n            position:relative;\n            height:calc(100% - 8rem);\n            display:flex;\n        }\n        \n        #adi-wrapper.left {\n            left: 0\n        }\n        \n        #adi-wrapper.right {\n            right: 0\n        }\n        \n        #adi-wrapper.transparent {\n            background: rgba(250, 250, 250, 0.9)\n        }\n        \n        #adi-panel {\n            position:fixed;\n            top:0;\n            /*bottom: 0;*/\n            right: 0;\n            height: 24px;\n            background: #d4d4d4;\n            border-top: 1px solid #bbc5c9\n        }\n        \n        #adi-panel .adi-path-wrap {\n            position:absolute;\n            bottom: 0;\n            left: 0;\n            width: 80%;\n            height: 24px;\n            padding: 0 13px 0 18px;\n            line-height: 24px;\n            overflow: hidden;\n            box-sizing: border-box;\n            -moz-box-sizing: border-box\n        }\n        \n        #adi-panel .adi-path-wrap.adi-overflowing .adi-path-left, \n        #adi-panel .adi-path-wrap.adi-overflowing .adi-path-right {\n            display: block\n        }\n        \n        #adi-panel .adi-path {\n            height: 24px;\n            overflow: hidden;\n            white-space: nowrap\n        }\n        \n        #adi-panel .adi-path-left, #adi-panel .adi-path-right {\n            display: none;\n            position: absolute;\n            top: 0;\n            width: 8px;\n            height: 24px;\n            background-repeat: no-repeat;\n            background-position: center center;\n            opacity: .7\n        }\n        \n        #adi-panel .adi-path-left:hover, #adi-panel .adi-path-right:hover {\n            opacity: 1\n        }\n        \n        #adi-panel .adi-path-left {\n            left: 7px;\n            background-image: url('img/left_shift.png')\n        }\n        \n        #adi-panel .adi-path-right {\n            position:absolute;\n            right: 2px;\n            background-image: url('/resources/scripts/dom-inspector/img/right_shift.png')\n        }\n        \n        #adi-panel .adi-menu-wrap {\n            bottom: 0;\n            right: 24px;\n            width: 50px;\n            height: 24px\n        }\n        \n        #adi-panel .adi-menu-lookup, #adi-panel .adi-menu-config {\n            display: block;\n            float: left;\n            width: 24px;\n            height: 24px;\n            border-left: 1px solid #bbc5c9;\n            background-position: center center;\n            background-repeat: no-repeat;\n            opacity: .7;\n            border-radius: 0\n        }\n        \n        #adi-panel .adi-menu-lookup:hover, #adi-panel .adi-menu-config:hover {\n            background-color: #c5d9d8;\n            opacity: 1\n        }\n        \n        #adi-panel .adi-menu-lookup.adi-active, #adi-panel .adi-menu-config.adi-active {\n            background-color: #fafafa;\n            opacity: 1\n        }\n        \n        #adi-panel .adi-menu-lookup {\n            background-image: url('/resources/scripts/dom-inspector/img/lookup.png')\n        }\n        \n        #adi-panel .adi-menu-config {\n            background-image: url('/resources/scripts/dom-inspector/img/config.png')\n        }\n        \n        \n        \n        #adi-vert-split {\n            position: fixed;\n            top: 0;\n            width: 4px;\n            height: 100%;\n            cursor: e-resize;\n            border-width: 0 1px 0 0;\n            background: #bbc5c9;\n            border-color: #768285;\n            border-style: solid;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n        }\n        \n        #adi-vert-split:hover {\n            background: #c5d9d8;\n        }\n        \n        \n        #adi-dom-view {\n            border-right:2px solid #ddd;\n            overflow:auto;\n            flex-grow:3;\n        }\n        \n        #adi-dom-view ul {\n            margin: 0;\n            padding: 0;\n            list-style: none\n        }\n        \n        #adi-dom-view ul[data-open=true] {\n            display: block\n        }\n        \n        #adi-dom-view ul[data-open=false] {\n            display: none\n        }\n        \n        #adi-dom-view ul ul {\n            margin: 4px 0\n        }\n        \n        #adi-dom-view ul li {\n            padding-left: 1em;\n            padding-bottom: 0.125em;\n            margin: 0;\n            padding-top: 0.125em;        \n        }\n        \n        \n        \n        \n        \n        \n        \n        #adi-dom-view .adi-normal-node, \n        #adi-dom-view .adi-end-node {\n            margin-right: 5px;\n            padding: 0 6px 0px;\n            background: #d2e8ff;\n            border-radius: 8px;\n            cursor: default;\n            font-size:0.8rem;\n        }\n        #adi-dom-view .adi-text-node:after, #adi-dom-view .adi-comment-node:after {\n            content: '\"'\n        }\n        \n        #adi-dom-view .adi-text-node:before, #adi-dom-view .adi-comment-node:before {\n            content: '\"'\n        }\n        \n        #adi-dom-view .adi-comment-node {\n            color: #999;\n            font-style: italic\n        }\n        \n        #adi-dom-view .adi-text-node, #adi-dom-view .adi-comment-node {\n            display: block;\n            padding: 3px 8px;\n            color: #444;\n            background: #fff;\n            border-radius: 8px\n        }\n        \n        #adi-dom-view .adi-normal-node:hover, \n        #adi-dom-view .adi-normal-node.hover, \n        #adi-dom-view .adi-end-node:hover, \n        #adi-dom-view .adi-end-node.hover {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n       #adi-dom-view .adi-normal-node:hover ~ span,\n       #adi-dom-view .adi-normal-node.hover ~ span,\n       #adi-dom-view .adi-end-node:hover ~ span,\n       #adi-dom-view .adi-end-node.hover ~ span {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n        #adi-dom-view .adi-normal-node.adi-active-node, \n        #adi-dom-view .adi-end-node.adi-active-node {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n        #adi-dom-view .adi-normal-node.adi-active-node ~ span,\n        #adi-dom-view .adi-end-node.adi-active-node ~ span {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n        \n        \n        \n        \n        \n        #adi-dom-view .adi-trigger {\n            display: inline-block;\n            width: 10px;\n            height: 10px;\n            margin: 0 5px 0 -13px;\n            opacity: .7\n        }\n        \n        #adi-dom-view .adi-trigger.closed {\n            // background: url('/resources/scripts/dom-inspector/img/node_closed.png') no-repeat;\n        }   \n        #adi-dom-view .adi-trigger.closed::before {\n            content:'\\25B8';\n        }\n        \n        #adi-dom-view .adi-trigger.opened {\n            // background: url('/resources/scripts/dom-inspector/img/node_opened.png') no-repeat\n        }\n        #adi-dom-view .adi-trigger.opened::before{\n            content:'\\25BE';\n        }\n        \n        #adi-dom-view .adi-trigger:hover {\n            opacity: 1\n        }\n        \n        #adi-opts-view {\n            position: relative;\n            height: 100%;\n            padding: 0 15px;\n            background: #fff\n        }\n        \n        #adi-opts-view.adi-hidden {\n            display: none\n        }\n        \n        #adi-opts-view .adi-opt-heading, #adi-opts-view .adi-opt {\n            display: block;\n            padding: 5px 0\n        }\n        \n        #adi-opts-view .adi-opt-heading {\n            padding: 20px 0 10px;\n            font-size: 1rem;\n        }\n        \n        #adi-opts-view .adi-opt-heading:first-child {\n            padding-top: 10px\n        }\n        \n        #adi-opts-view .adi-opt input {\n            margin-right: 6px\n        }\n        \n        #adi-opts-view .adi-opt-close {\n            position: absolute;\n            top: 5px;\n            right: 28px;\n            width: 16px;\n            height: 16px;\n            background: url('/resources/scripts/dom-inspector/img/options_close.png') no-repeat;\n            opacity: .7;\n        }\n        \n        #adi-opts-view .adi-opt-close:hover {\n            opacity: 1;\n        }\n        \n        #adi-attr-view {\n            top: 0.5rem;\n            border: 1px solid #ddd;\n            overflow: auto;\n            padding: 0.25em;\n            height: calc(90% - 1em);\n            min-width: 10rem;\n            position: absolute;\n            z-index: 10;\n            right: 0.5rem;\n            background:rgba(255,255,255,0.85);\n        }\n        #adi-attr-view > .adi-content{\n            height:calc(100% - 5em);\n            overflow:auto;\n        }\n        \n        #adi-attr-view .adi-attr {\n            display: block;\n            padding: 0.25em;\n        }\n        \n        #adi-attr-view hr {\n            height: 1px;\n            border: none\n        }\n        \n        #adi-attr-view input[type=text] {\n            width: calc(100% - 0.5em);\n            margin-top: 3px;\n            padding: 2px;\n        }\n        \n        #adi-horiz-split {\n            height: 4px;\n            cursor: n-resize;\n            border-width: 0 0 1px 0;\n            background: #bbc5c9;\n            border-color: #768285;\n            border-style: solid;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n        }\n        \n        #adi-horiz-split:hover {\n            background: #c5d9d8;\n        }\n        \n        #adi-dom-view .fore-node{\n            background: var(--paper-blue-700);\n            font-size:1.1em;\n             color:white;\n        }\n        #adi-dom-view .adi-normal-node.fore-node:hover {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        #adi-dom-view .adi-end-node.fore-node{\n            background: var(--paper-blue-700);\n            font-size:1em;\n            color:white;\n       }\n\n        #adi-dom-view .adi-node .adi-active-node.fore-node,\n        #adi-dom-view .adi-node.action .adi-active-node.fore-node,\n        #adi-dom-view .adi-node.action .adi-active-node.fore-node ~ .adi-end-node\n         {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n        #adi-dom-view .adi-node.fx-fore{\n            background:var(--paper-blue-grey-50); \n        }\n        #adi-dom-view .adi-node.fx-model{\n            background:var(--paper-blue-grey-100); \n            padding:0.25em 0;\n        }       \n               \n        #adi-dom-view .adi-node.action .fore-node {\n            background:var(--paper-blue-grey-100);\n            color:black;\n            font-family:monospace;\n        }\n                    \n        .toggleView{\n            /*width:20px;*/\n            /*height: 20px;*/\n        }\n        input, select{\n            display: block;\n        }\n        header{\n            background:rgba(255, 255, 255, 0.2);\n        }\n\n        .selected-btn { color: orange }\n      \n          </style>\n          \n        <slot name=\"header\"></slot>\n        <button id=\"focus-button\">Focus</button>\n        <slot></slot>\n      \n      ",!this.hasAttribute("instance")||this.getAttribute("instance"),this.adiInstance=new fn(this.shadowRoot,this.hasAttribute("instance")?this.instance:"#document")}verticalResize(e){if(!this.vertResizing)return;e=e||window.event,document.documentElement.style.cursor="e-resize";const t=this.options.width+this.xPos-e.clientX;t>=this.options.minWidth&&(this.options.width=t,this.xPos=e.clientX,this.refreshUI(),this.saveOptions())}}customElements.get("fx-dom-inspector")||customElements.define("fx-dom-inspector",mn);class gn extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.instanceElement=null,this.foreSelector=null}connectedCallback(){this.container=this.querySelector(".json-path-picker-container"),this.foreSelector=this.hasAttribute("fore")?this.getAttribute("fore"):"fx-fore",this.render()}render(){const e=this.hasAttribute("instance")?this.getAttribute("instance"):"default";if(!document.querySelector(this.foreSelector))throw new Error(`this '${this.foreSelector}' does not match a fx-fore element`);this.shadowRoot.innerHTML=`\n          <style>\n              \n        @import '../../resources/fore.css';\n      \n        :host {\n          display:block;\n          font-size:0.8em;\n          background:rgba(250, 250, 250, 0.9);\n        }\n        .container{\n            margin-left:1em;\n        }\n        .header{\n            margin-left:0;\n        }\n\n        ::slot[name='header']{\n            margin-left:-1em;\n        }\n        /* Syntax highlighting for JSON objects */\n        ul.json-dict, ol.json-array {\n          list-style-type: none;\n          margin: 0 0 0 1px;\n          border-left: 1px dotted #ccc;\n          padding-left: 2em;\n        }\n        .json-string {\n          // color: #0B7500;\n        }\n        .json-literal {\n          color: #1A01CC;\n          font-weight: bold;\n        }\n        \n        /* Toggle button */\n        a.json-toggle {\n          position: relative;\n          color: inherit;\n          text-decoration: none;\n        }\n        a.json-toggle:focus {\n          outline: none;\n        }\n        a.json-toggle:before {\n          content: "\\25BC"; /* down arrow */\n          position: absolute;\n          display: inline-block;\n          width: 1em;\n          left: -1.2em;\n          font-size:0.8em;\n        }\n        a.json-toggle.collapsed:before {\n          content: "\\25B6"; /* left arrow */\n        }\n        \n        /* Collapsable placeholder links */\n        a.json-placeholder {\n          color: #aaa;\n          padding: 0 1em;\n          text-decoration: none;\n        }\n        a.json-placeholder:hover {\n          text-decoration: underline;\n        }\n        \n        /* Copy path icon */\n        .pick-path {\n          color: lightgray;\n          cursor: pointer;\n          margin-left: 3px;\n        }\n        \n        .pick-path:hover {\n          color: darkgray;\n        }\n        \n      \n          </style>\n          <slot name="header">\n            <header class="header">${e}</header>\n          </slot>\n          <slot></slot>\n          \n          <div class="container"></div>\n      \n      `;const t=document.querySelector(`#${e}`);if(!t||"FX-INSTANCE"!==t.nodeName||"json"!==t.getAttribute("type"))throw new Error(`this '${e}' does not match an fx-instance element or is not of type JSON`);const n=this.shadowRoot.querySelector(".container"),r=t.instanceData;let o=this.json2html(r,{outputWithQuotes:!0});this.isCollapsable(r)&&(o="<a href='#' class=\"json-toggle\"></a>".concat(o)),n.innerHTML=o;this.shadowRoot.querySelectorAll(".json-toggle").forEach((e=>{e.addEventListener("click",this._handleToggleEvent.bind(this))}))}disconnectedCallback(){}_isHidden(e){var t=e.offsetWidth,n=e.offsetHeight;return 0===t&&0===n||"none"===window.getComputedStyle(e).display}_handleToggleEvent(e){const t=e.target;t.classList.toggle("collapsed");for(var n=this._siblings(t,"ul.json-dict, ol.json-array",(function(e){e.style.display=""===e.style.display||"block"===e.style.display?"none":"block"})),r=0;r<n.length;r+=1)if(this._isHidden(n[r])){for(var o=n[r].children,i=0,a=0;a<o.length;a+=1)"LI"===o[a].tagName&&(i+=1);var s=i+(i>1?" items":" item");n[r].insertAdjacentHTML("afterend",'<a href class="json-placeholder">'.concat(s,"</a>"))}else this._siblings(n[r],".json-placeholder",(function(e){return e.parentNode.removeChild(e)}));e.stopPropagation(),e.preventDefault()}_siblings(e,t,n){for(var r=[],o=0;o<e.parentNode.children.length;o+=1){var i=e.parentNode.children[o];i!==e&&"string"==typeof t&&i.matches(t)&&r.push(i)}if(n&&"function"==typeof n)for(var a=0;a<r.length;a+=1)n(r[a]);return r}json2html(e,t){let n="";if("string"==typeof e){const t=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");this.isUrl(t)?n+='<a href="'.concat(t,'" class="json-string">').concat(t,"</a>"):n+='<span class="json-string">"'.concat(t,'"</span>')}else if("number"==typeof e)n+='<span class="json-literal">'.concat(e,"</span>");else if("boolean"==typeof e)n+='<span class="json-literal">'.concat(e,"</span>");else if(null===e)n+='<span class="json-literal">null</span>';else if(e instanceof Array)if(e.length>0){n+='[<ol class="json-array">';for(var r=0;r<e.length;r+=1)n+='<li data-key-type="array" data-key="'.concat(r,'">'),this.isCollapsable(e[r])&&(n+='<a href="#" class="json-toggle"></a>'),n+=this.json2html(e[r],t),r<e.length-1&&(n+=","),n+="</li>";n+="</ol>]"}else n+="[]";else if("object"===this._typeof(e)){let r=Object.keys(e).length;if(r>0){for(var o in n+='{<ul class="json-dict">',e)if(e.hasOwnProperty(o)){n+='<li data-key-type="object" data-key="'.concat(o,'">');const i=t.outputWithQuotes?'<span class="json-string">"'.concat(o,'"</span>'):o;this.isCollapsable(e[o])?n+="<a href='#' class=\"json-toggle\">".concat(i,"</a>"):n+=i,n+=": ".concat(this.json2html(e[o],t)),r-=1,r>0&&(n+=","),n+="</li>"}n+="</ul>}"}else n+="{}"}return n}isUrl(e){return/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#:.?+=&%@!\-/]))?/.test(e)}_typeof(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?this._typeof=function(e){return typeof e}:this._typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},this._typeof(e)}isCollapsable(e){return e instanceof Object&&Object.keys(e).length>0}static get observedAttributes(){return["data"]}attributeChangedCallback(e,t,n){"data"===e&&(this.jsonTextarea.value=n,this.updateTree(n))}updateTree(e){try{this.data=JSON.parse(e),this.treeView.innerHTML="",this.treeView.appendChild(this.createTreeView(this.data,""))}catch(e){alert("Invalid JSON")}}createTreeView(e,t){let n=document.createElement("ul");if(n.classList.add("jp-ul"),Array.isArray(e))e.forEach(((e,r)=>{let o=document.createElement("li");o.classList.add("jp-li");let i=t+"["+r+"]";o.appendChild(this.createItemView(i,e)),n.appendChild(o)}));else if("object"==typeof e&&null!==e)Object.keys(e).forEach((r=>{let o=document.createElement("li");o.classList.add("jp-li");let i=t+"."+r;o.appendChild(this.createItemView(i,e[r])),n.appendChild(o)}));else{let r=document.createElement("li");r.classList.add("jp-li"),r.appendChild(this.createItemView(t,e)),n.appendChild(r)}return n}}customElements.get("fx-json-instance")||customElements.define("fx-json-instance",gn);class yn extends HTMLElement{static get properties(){return{fore:{type:Object,description:"The fx-fore element the devtools are attached to"},instances:{type:Array,description:"Instances of selected Fore element"},selector:{type:String,description:"optional selector to attach to a certain fx-fore element with given id"}}}constructor(){super(),this.attachShadow({mode:"open"}),Object.keys(this.constructor.properties).forEach((e=>{const t=this.constructor.properties[e],n=t.attribute||e,r=this.getAttribute(n)||t.default,o=t.type(r);this[e]=o})),this.isResizing=!1,this.lastY=0,this.defaultHeight="40vh",this.buttonByInstanceId=new Map;const e=e=>{this.fore=e,this.instances=[...this.fore.getModel().instances];const t=this.shadowRoot.querySelector(".instances header");t.textContent="Data ",this.instances.forEach((e=>{const n=document.createElement("button");n.setAttribute("type","button"),n.textContent=e.id,t.appendChild(n),this.buttonByInstanceId.set(e.id,n),n.addEventListener("click",(()=>this.selectInstance(e.id)))})),this.instances.length&&this.selectInstance(this.instances[0].id)},t=document.querySelector("fx-fore");t&&(t.inited?e(t):t.addEventListener("model-construct-done",(()=>e(t)))),window.document.addEventListener("log-active-element",(t=>{const n=t?t.detail?.target||t.target:window.event.srcElement,r=n.nodeType===Node.DOCUMENT_NODE?null:n.closest("fx-fore");r&&e(r);const o=this.instances.find((e=>"xml"===e.type&&e.instanceData.contains(n)));o&&this.selectInstance(o.id)}))}_getInstanceForTarget(e){this.instances.forEach((t=>"xml"===t.type&&t.instanceData.contains(e)||"json"===t.type?t:void 0))}selectInstance(e){const t=this.buttonByInstanceId.get(e);if(!t)return;if(t.classList.contains("selected-btn"))return;const n=this.shadowRoot.querySelector(".selected-btn");n&&n.classList.remove("selected-btn"),t.classList.add("selected-btn");const r=this.shadowRoot.querySelector(".instance-panel");r.innerHTML="",this.instances=[...this.fore.querySelectorAll("fx-instance")];const o=Array.from(this.instances).find((t=>t.id===e)),i=this._renderInstancePanel(o);r.append(i)}connectedCallback(){this.render()}_startResize(e){this.isResizing=!0,this.lastY=e.clientY}_resizePanel(e){if(!this.isResizing)return;const t=e.clientY-this.lastY;this.style.height=this.offsetHeight-t+"px",this.lastHeight=this.style.height,this.lastY=e.clientY}_stopResize(e){e.preventDefault(),e.stopPropagation(),this.isResizing=!1,document.body.style.height="inherit",document.body.style.width="inherit";const t=document.body.scrollHeight+this.offsetHeight;document.body.style.height=`${t}px`}render(){const e=`\n        <section class="wrapper">\n            <slot></slot>\n            <details class="fx-devtools" open>\n                <div class="resizer"></div>\n                <summary>Fore Glass \n                    <div>\n                        <svg preserveAspectRatio="xMidYMid meet" focusable="true" style="width: 24px;height: 24px; margin-bottom:-1px;" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n                            <g role="button" id="find-in-page"><path d="M20 19.59V8l-6-6H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c.45 0 .85-.15 1.19-.4l-4.43-4.43c-.8.52-1.74.83-2.76.83-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5c0 1.02-.31 1.96-.83 2.75L20 19.59zM9 13c0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3-3 1.34-3 3z"></path></g>\n                        </svg>\n                        <button class="optionsBtn" id="optionsTrigger">&#9881;</button>                    \n                    </div>\n                </summary>\n                <section class="panels">\n                    <section class="log">\n                        <fx-action-log selector="${this.selector}"></fx-action-log>\n                    </section>\n                    <section class="dom">\n                        <fx-dom-inspector>\n                            <header slot="header">Document</header>\n                        </fx-dom-inspector>\n                    </section>\n                    <section class="instances">\n                        <header></header>\n                        <div class="instance-panel">\n                        </div>\n                    </section>\n                    <section id="options">\n                        <fx-log-settings></fx-log-settings>\n                    </section>\n                </section>\n            </details>\n        </section>\n      `;this.shadowRoot.innerHTML=`\n          <style>\n              \n      @import '../../resources/fore.css';\n      \n        :host {\n          display:block;\n          position:fixed;\n          bottom:0;\n          left:0;\n          width:100vw;\n          height:var(--fx-devtools-height);\n          font-style:inherit;\n          font-family: 'Verdana' , 'Sans';\n          font-size:1em;\n          max-width:100vw;\n          height:3em;\n        }\n        :host(.open){\n            height:40vh;\n        }\n        \n        fx-action-log{\n            height:100%;\n        }\n        fx-dom-inspector{\n            max-height:100%;\n            height:100%;\n            position:relative;\n        }\n        body {\n        }\n        details{\n            height:100%;\n            background:#ebf6ff;\n        }\n        .dom{\n            width:45%;\n            border-left:1px solid #999;\n            position:relative\n        }\n        .dom fx-minimap{\n            position:absolute;\n            right:0;\n            top:0;\n            width:5rem;\n            height:6rem;\n        }\n        header{\n            padding:0.5rem;\n            border-bottom:2px solid #ddd;\n            font-size:1rem;\n        }\n        header button{\n            margin:0 0.5em;\n            border:thin solid #999;\n            padding:0 0.5em;\n            cursor:pointer;\n        }\n        header button:hover{\n            background:white;\n        }\n        \n        header button.selected-btn{\n            background:steelblue;\n            color:white;\n        }\n        .instances{\n            width:35%;\n            border-left:1px solid #999;\n        }\n        .instance-panel{\n            height:100%;\n            overflow:auto;\n        }\n        .panels{\n            display:grid;\n            grid-template-columns:20% 50% 30%;\n            height:100%;\n            width:100%;\n            max-height:100%;\n            border-top:thin solid #ddd;\n        }\n        .panels > section {\n            min-height:20rem;\n/*\n            background:#efefef;\n*/\n            position:relative;\n            display:inline-block;\n            height:100%;\n            width:auto;\n        }\n        #options{\n            display:none;\n        }\n        #options.open{\n            position:absolute;\n            z-index:10;\n            left:0;\n            top:3em;\n            height:100%;\n            display:block;\n            padding:0;\n            background:rgba(255,255,255,0.95);\n            width:100%;\n        }\n        .optionsBtn{\n            font-size:2rem;\n        }\n        details[open] .optionsBtn{\n            display:inline;\n        }\n        .resizer{\n            width:100vw;\n            height:6px;\n            background:rgba(215,220,235,0.3);\n            cursor: ns-resize;\n            position:absolute;\n            top:0;\n            \n        }\n        summary{\n            height:3rem;\n            padding:0 1em;\n            border-bottom:2px solid #ddd;\n            display:flex;\n            justify-content:space-between;\n            align-items:center;\n            color:rgba(0,0,0,0.7);\n            background: rgba(235, 255, 255, 0.2);\n            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);\n            backdrop-filter: blur(5px);\n            -webkit-backdrop-filter: blur(5px);\n            border: 1px solid rgba(255, 255, 255, 0.3);\n            \n            color:white;\n            font-weight:300;\n                      background: rgb(119,119,119);\n          background: linear-gradient(90deg, rgba(0,85,159,0.75) 0%, rgba(56,154,252,0.5) 50%, rgba(255,255,255,0.1) 100%);\n\n        }\n        summary button{\n            padding:0;\n            border:0;\n            background:transparent;\n        }\n        .wrapper{\n            height:100%;\n        }\n        .vertDevider{\n            background:#ddd;\n            width:4px;\n            height:100%;\n            cursor: ew-resize;\n        }\n      \n          </style>\n          ${e}\n      `,this.resizer=this.shadowRoot.querySelector(".resizer"),this.resizer.addEventListener("mousedown",this._startResize.bind(this)),document.addEventListener("mousemove",this._resizePanel.bind(this)),document.addEventListener("mouseup",this._stopResize.bind(this));const t=this.shadowRoot.querySelector("#optionsTrigger");t.addEventListener("click",(()=>{const e=this.shadowRoot.querySelector("#options");e.classList.toggle("open"),e.classList.contains("open")?t.style.background="lightsteelblue":t.style.background="transparent"}));this.shadowRoot.querySelector(".fx-devtools").addEventListener("click",(e=>{"DIV"===e.target.nodeName&&e.target.classList.contains("resizer")||(e.target.parentNode.open?(this.removeAttribute("open"),this.lastHeight=this.style.height,this.style.height="3em"):(this.setAttribute("open",""),this.style.height=this.lastHeight?this.lastHeight:"40vh"))})),this.classList.add("open")}_handleOpen(e){document.body.style.height=""}_renderInstancePanel(e){if("xml"===e.type){const t=document.createElement("fx-dom-inspector");return t.setInstance(e),t.setAttribute("instance",e.id),t}if("json"===e.type){const t=document.createElement("fx-json-instance");t.setAttribute("instance",e.id);const n=document.createElement("span");return n.setAttribute("slot","header"),t.append(n),t}}}customElements.get("fx-devtools")||customElements.define("fx-devtools",yn);class vn extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.src=""}connectedCallback(){this.src=this.getAttribute("src");const e=`\n          <fx-fore src="${this.src}">\n          </fx-fore>\n          <slot id="default"></slot>\n        `;this.shadowRoot.innerHTML=`\n            <style>\n                \n          :host {\n            display:block;\n          }\n        \n            </style>\n            ${e}\n        `;this.shadowRoot.querySelector("#default").addEventListener("slotchange",(async e=>{const t=e.target.assignedElements().filter((e=>"LINK"===e.nodeName.toUpperCase()));if(!t)return;const n=[...document.styleSheets].map((e=>{if(t.find((t=>t.href===e.href)))try{return[...e.cssRules].map((e=>e.cssText)).join("")}catch(e){}})).filter(Boolean).join("\n"),r=new CSSStyleSheet;r.replaceSync(n),this.shadowRoot.adoptedStyleSheets=[r]}));const t=this.querySelector("fx-action");if(t){const e=t.cloneNode(!0);this.removeChild(t);this.shadowRoot.querySelector("fx-fore").appendChild(e)}}}customElements.get("fore-component")||customElements.define("fore-component",vn);class wn extends HTMLElement{constructor(){super(),this.canvas=document.createElement("canvas"),this.options=this.getAttribute("options")?JSON.parse(this.getAttribute("options")):{},this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.canvas),this.WIN=window,this.DOC=this.WIN.document,this.DOC_EL=this.DOC.documentElement,this.BODY=this.DOC.querySelector("body")}connectedCallback(){this.ctx=this.canvas.getContext("2d"),this.black=e=>`rgba(0,0,0,${e/100})`,this.viewport=this.querySelector(this.getAttribute("selector")),this.settings=Object.assign({viewport:this.viewport,styles:{"header,footer,section,article":this.black(8),"h1,a":this.black(10),"h2,h3,h4":this.black(8)},back:this.black(2),view:this.black(5),drag:this.black(10),interval:null},this.options);const e=(e,t,n,r)=>n.split(/\s+/).forEach((n=>e[t](n,r)));this.on=(t,n,r)=>e(t,"addEventListener",n,r),this.off=(t,n,r)=>e(t,"removeEventListener",n,r),this.Rect=(e,t,n,r)=>({x:e,y:t,w:n,h:r}),this.rect_rel_to=(e,t={x:0,y:0})=>this.Rect(e.x-t.x,e.y-t.y,e.w,e.h),this.rect_of_doc=()=>this.Rect(0,0,document.documentElement.scrollWidth,document.documentElement.scrollHeight),this.rect_of_win=()=>this.Rect(window.pageXOffset,window.pageYOffset,document.documentElement.clientWidth,document.documentElement.clientHeight),this.el_get_offset=e=>{const t=e.getBoundingClientRect();return{x:t.left+window.pageXOffset,y:t.top+window.pageYOffset}},this.rect_of_el=e=>{const{x:t,y:n}=this.el_get_offset(e);return this.Rect(t,n,e.offsetWidth,e.offsetHeight)},this.rect_of_viewport=e=>{const{x:t,y:n}=this.el_get_offset(e);return this.Rect(t+e.clientLeft,n+e.clientTop,e.clientWidth,e.clientHeight)},this.rect_of_content=e=>{const{x:t,y:n}=this.el_get_offset(e);return this.Rect(t+e.clientLeft-e.scrollLeft,n+e.clientTop-e.scrollTop,e.scrollWidth,e.scrollHeight)},this.calc_scale=(()=>{const e=this.canvas.clientWidth,t=this.canvas.clientHeight;return(n,r)=>Math.min(e/n,t/r)})(),this.resize_canvas=(e,t)=>{this.canvas.width=e,this.canvas.height=t,this.canvas.style.width=`${e}px`,this.canvas.style.height=`${t}px`},this.viewport=this.settings.viewport,this.find=e=>Array.from((this.viewport||document).querySelectorAll(e)),this.drag=!1,this.root_rect=null,this.view_rect=null,this.scale=null,this.drag_rx=null,this.drag_ry=null}draw_rect(e,t){t&&(this.ctx.beginPath(),this.ctx.rect(e.x,e.y,e.w,e.h),this.ctx.fillStyle=t,this.ctx.fill())}find(e){return Array.from((this.viewport||this.DOC).querySelectorAll(e))}apply_styles(e){Object.keys(e).forEach((t=>{const n=e[t];this.find(t).forEach((e=>{this.draw_rect(this.rect_rel_to(this.rect_of_el(e),this.root_rect),n)}))}))}draw(){this.root_rect=this.viewport?this.rect_of_content(this.viewport):this.rect_of_doc(),this.view_rect=this.viewport?this.rect_of_viewport(this.viewport):this.rect_of_win(),this.scale=this.calc_scale(this.root_rect.w,this.root_rect.h),this.resize_canvas(this.root_rect.w*this.scale,this.root_rect.h*this.scale),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.scale(this.scale,this.scale),this.draw_rect(this.rect_rel_to(this.root_rect,this.root_rect),this.settings.back),this.apply_styles(this.settings.styles),this.draw_rect(this.rect_rel_to(this.view_rect,this.root_rect),this.drag?this.settings.drag:this.settings.view)}on_drag(e){e.preventDefault();const t=this.rect_of_viewport(this.canvas),n=(e.pageX-t.x)/this.scale-this.view_rect.w*this.drag_rx,r=(e.pageY-t.y)/this.scale-this.view_rect.h*this.drag_ry;this.viewport?(this.viewport.scrollLeft=n,this.viewport.scrollTop=r):this.WIN.scrollTo(n,r),this.draw()}on_drag_end(e){this.drag=!1,this.canvas.style.cursor="pointer",this.BODY.style.cursor="auto",this.off(this.WIN,"mousemove",this.on_drag),this.off(this.WIN,"mouseup",this.on_drag_end),this.on_drag(e)}on_drag_start(e){this.drag=!0;const t=this.rect_of_viewport(this.canvas),n=this.rect_rel_to(this.view_rect,this.root_rect);this.drag_rx=((e.pageX-t.x)/this.scale-n.x)/n.w,this.drag_ry=((e.pageY-t.y)/this.scale-n.y)/n.h,(this.drag_rx<0||this.drag_rx>1||this.drag_ry<0||this.drag_ry>1)&&(this.drag_rx=.5,this.drag_ry=.5),this.canvas.style.cursor="crosshair",this.BODY.style.cursor="crosshair",this.on(this.WIN,"mousemove",this.on_drag),this.on(this.WIN,"mouseup",this.on_drag_end),this.on_drag(e)}init(){this.canvas.style.cursor="pointer",this.on(this.canvas,"mousedown",this.on_drag_start),this.on(this.viewport||this.WIN,"load resize scroll",this.draw()),this.settings.interval>0&&setInterval((()=>this.draw()),this.settings.interval),this.draw()}}async function xn(e){return new Promise((t=>setTimeout((()=>t()),e)))}customElements.get("fx-minimap")||customElements.define("fx-minimap",wn);class bn extends(Rt(HTMLElement)){static get properties(){return{...super.properties,defaultAction:{type:String},delay:{type:Number},detail:{type:Object},event:{type:Object},handler:{type:Object},ifExpr:{type:String},needsUpdate:{type:Boolean},observer:{type:Object},phase:{type:String},propagate:{type:String},target:{type:String},whileExpr:{type:String}}}constructor(){super(),this.detail={},this.needsUpdate=!1}connectedCallback(){this.style.display="none",this.propagate=this.hasAttribute("propagate")?this.getAttribute("propagate"):"continue",this.repeatContext=void 0,this.hasAttribute("event")&&(this.event=this.getAttribute("event")),this.hasAttribute("defaultAction")?this.defaultAction=this.getAttribute("defaultAction"):this.defaultAction="perform",this.hasAttribute("phase")?this.phase=this.getAttribute("phase"):this.phase="default",this.ifExpr=this.hasAttribute("if")?this.getAttribute("if"):null,this.whileExpr=this.hasAttribute("while")?this.getAttribute("while"):null,this.delay=this.hasAttribute("delay")?Number(this.getAttribute("delay")):0,this._addUpdateListener()}_addUpdateListener(){if(this.target=this.getAttribute("target"),this.target)if("#window"===this.target)window.addEventListener(this.event,(e=>this.execute(e)),{capture:"capture"===this.phase});else if("#document"===this.target)document.addEventListener(this.event,(e=>this.execute(e)),{capture:"capture"===this.phase});else{if(this.targetElement=ct(this.target,this),!this.targetElement)return;this?.targetElement.addEventListener(this.event,(e=>this.execute(e)),{capture:"capture"===this.phase})}else this.targetElement=this.parentNode,this.targetElement.addEventListener(this.event,(e=>this.execute(e)),{capture:"capture"===this.phase})}async execute(e){"stop"===this.propagate&&e.stopPropagation(),"cancel"===this.defaultAction&&e.preventDefault();let t=()=>{};e&&e.listenerPromises&&e.listenerPromises.push(new Promise((e=>{t=e}))),null===Pt.outermostHandler&&(Pt.outermostHandler=this,this.dispatchEvent(new CustomEvent("outermost-action-start",{composed:!0,bubbles:!0,cancelable:!0,detail:{cause:e?.type}}))),e&&(this.currentEvent=e),this.needsUpdate=!1;try{this.evalInContext()}catch(e){}if(this.targetElement&&this.targetElement.nodeset&&(this.nodeset=this.targetElement.nodeset),!this.ifExpr||wt(this.ifExpr,Ct(this),this)){if(this.whileExpr){const e=async()=>{await xn(this.delay||0),et.contains(this.getOwnerForm(),this)&&wt(this.whileExpr,Ct(this),this)&&(this.perform(),this.delay?e():await e())};return await e(),void this._finalizePerform(t)}if(this.delay&&(await xn(this.delay),!et.contains(this.getOwnerForm(),this)))return this.actionPerformed(),void t();await this.perform(),this._finalizePerform(t)}else this._finalizePerform(t)}_finalizePerform(e){this.currentEvent=null,this.actionPerformed(),Pt.outermostHandler===this&&(Pt.outermostHandler=null,this.dispatchEvent(new CustomEvent("outermost-action-end",{composed:!0,bubbles:!0,cancelable:!0}))),e()}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}})),(this.isBound()||"FX-ACTION"===this.nodeName)&&this.evalInContext()}actionPerformed(){const e=this.getModel();e&&e.inited&&(Pt.outermostHandler&&!et.contains(Pt.outermostHandler.ownerDocument,Pt.outermostHandler)&&(Pt.outermostHandler=null),!this.needsUpdate||Pt.outermostHandler!==this&&Pt.outermostHandler?this.needsUpdate&&(Pt.outermostHandler.needsUpdate=!0):(e.recalculate(),e.revalidate(),e.parentNode.refresh(!0),this.dispatchActionPerformed()))}dispatchActionPerformed(){St.dispatch(this,"action-performed",{})}}bn.dataChanged=!1,customElements.get("abstract-action")||window.customElements.define("abstract-action",bn);class An extends bn{static get properties(){return{...bn.properties,ref:{type:String},repeat:{type:String},clear:{type:String}}}constructor(){super(),this.repeat=""}connectedCallback(){super.connectedCallback(),this.ref=this.getAttribute("ref"),this.repeat=this.getAttribute("repeat")}async perform(){super.perform(),this._dataFromTemplate(),this.needsUpdate=!0}actionPerformed(){super.actionPerformed(),this._dispatch()}_dataFromTemplate(){const e=this.getInScopeContext(),t=this.getOwnerForm().querySelector(`#${this.repeat}`),n=t.shadowRoot.querySelector("template"),r=e.ownerDocument.createElement(t.ref),o=this._generateInstance(n.content,r);e.appendChild(o)}_dispatch(){const e=ct(this.repeat,this);St.dispatch(e,"index-changed",{index:e.nodeset.length})}_clear(e){let t=e.firstChild;const n=e.attributes;for(let e=0;e<n.length;e+=1)n[e].value="";for(;t;)1===t.nodeType&&t.hasAttributes()&&(t.textContent=""),this._clear(t),t=t.nextSibling}_generateInstance(e,t){if(1===e.nodeType&&e.hasAttribute("ref")){const n=e.getAttribute("ref");let r;"."===n||(n.startsWith("@")?t.setAttribute(n.substring(1),""):(r=document.createElement(n),t.appendChild(r),0===e.children.length&&(r.textContent=e.textContent)))}if(e.hasChildNodes()){const n=e.children;for(let e=0;e<n.length;e+=1)this._generateInstance(n[e],t)}return t}getInstanceId(){return this.ref.startsWith("instance(")?"not implemented":"default"}}customElements.get("fx-append")||window.customElements.define("fx-append",An);class En extends bn{static get properties(){return{...super.properties,ref:{type:String}}}async perform(){const e=Ct(this.getAttributeNode("ref")||this,this.ref);this.nodeset=vt(this.ref,e,this);const t=et.resolveInstance(this),n=this.getModel().getInstance(t),r=St.getDomNodeIndexString(this.nodeset),o=this.nodeset;let i;if(this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event,path:r}})),Array.isArray(o)){if(0===o.length)return;i=o[0].parentNode,o.forEach((e=>{this._deleteNode(i,e)}))}else i=o.parentNode,this._deleteNode(i,o);await St.dispatch(n,"deleted",{ref:r,deletedNodes:o}),this.needsUpdate=!0}_deleteNode(e,t){if(e.nodeType===Node.DOCUMENT_NODE)return;if(t.nodeType===Node.DOCUMENT_NODE)return;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return;if(null===t.parentNode)return;this.getModelItem().readonly||e.removeChild(t)}actionPerformed(){this.getModel().rebuild(),super.actionPerformed()}}customElements.get("fx-delete")||window.customElements.define("fx-delete",En);class Nn extends bn{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.control=this.hasAttribute("control")?this.getAttribute("control"):null}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}}));const e="#"+this.control;let t=document.querySelector(e);if(!t)return;const n=t.closest("fx-repeatitem");if(n)return t=n.querySelector(e),void this._focus(t);const r=t.closest("fx-repeatitem, .fx-repeatitem");if(r){t=r.parentNode.querySelector("[repeat-index] "+e)}this._focus(t),this.hasAttribute("select")&&this._select(t)}_focus(e){e&&"function"==typeof e.getWidget&&e.getWidget().focus(),e&&e.nodeType===Node.ELEMENT_NODE&&e.click()}_select(e){e&&e.getWidget().select()}}customElements.get("fx-setfocus")||window.customElements.define("fx-setfocus",Nn);class Tn extends bn{static get properties(){return{...super.properties,at:{type:Number},position:{type:Number},origin:{type:Object},keepValues:{type:Boolean}}}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){super.connectedCallback&&super.connectedCallback();this.shadowRoot.innerHTML="\n        <style>\n            \n        :host{\n            display:none;\n        }\n    \n        </style>\n        <slot></slot>\n    ",this.at=Number(this.hasAttribute("at")?this.getAttribute("at"):0),this.position=this.hasAttribute("position")?this.getAttribute("position"):"after",this.origin=this.hasAttribute("origin")?this.getAttribute("origin"):null,this.keepValues=!!this.hasAttribute("keep-values")}_getOriginSequence(e,t){let n;if(this.origin){let t;try{t=yt(this.origin,e,this),Array.isArray(t)&&0===t.length&&(n=null),n=t}catch(e){}}else t&&(n=t,n&&!this.keepValues&&this._clear(n));return n}_cloneOriginSequence(e,t){let n;if(this.origin){let t;try{t=yt(this.origin,e,this),Array.isArray(t)&&0===t.length&&(n=null),n=t.cloneNode(!0)}catch(e){}}else t&&(n=this._cloneTargetSequence(t),n&&!this.keepValues&&this._clear(n));return n}_getInsertIndex(e,t){return 0===t.length?null:this.hasAttribute("at")?bt(this.getAttribute("at"),e,this):t.length}async perform(){let e,t;this.hasAttribute("context")&&(e=Ct(this.getAttributeNode("context"),this.getAttribute("context")),t=vt(this.getAttribute("context"),e,this.getOwnerForm())),this.hasAttribute("ref")&&(e||(e=Ct(this.getAttributeNode("ref"),this.ref)),t=vt(this.ref,e,this));const n=this._cloneOriginSequence(e,t);if(!n)return;let r,o;if(0===t.length)r=e,e.appendChild(n),o=1;else{if(this.hasAttribute("at")?(o=bt(this.getAttribute("at"),e,this),r=t[o-1]):(o=t.length,r=t[t.length-1]),!r){o=1,r=t;o=bt("count(preceding::*)",t,this.getOwnerForm())+1}this.position&&"before"===this.position&&r.parentNode.insertBefore(n,r),this.position&&"after"===this.position&&(o+=1,this.hasAttribute("context")&&this.hasAttribute("ref")?e.append(n):this.hasAttribute("context")?(o=1,r.prepend(n)):r.insertAdjacentElement("afterend",n))}const i=this.getModel().getInstance(et.resolveInstance(this)),a=St.getDomNodeIndexString(n);this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event,path:a}})),St.dispatch(i,"insert",{"inserted-nodes":n,"insert-location-node":r,position:this.position}),document.dispatchEvent(new CustomEvent("index-changed",{composed:!0,bubbles:!0,detail:{insertedNodes:n,index:o}})),this.needsUpdate=!0}_cloneTargetSequence(e){return Array.isArray(e)&&0!==e.length?e[e.length-1].cloneNode(!0):!Array.isArray(e)&&e?e.cloneNode(!0):null}actionPerformed(){this.getModel().rebuild(),super.actionPerformed()}_clear(e){const t=e.attributes;for(let e=0;e<t.length;e+=1)t[e].value="";e.textContent&&(e.textContent="");let n=e.firstChild;for(;n;)1===n.nodeType&&n.hasAttributes()&&(n.textContent=""),this._clear(n),n=n.nextSibling}}customElements.get("fx-insert")||window.customElements.define("fx-insert",Tn);class Bn extends bn{constructor(){super(),this.attachShadow({mode:"open"})}static get properties(){return{...bn.properties,modelItem:void 0,messageTextContent:{type:String,get value(){return"here!"}}}}connectedCallback(){super.connectedCallback(),this.event=this.hasAttribute("event")?this.getAttribute("event"):"",this.level=this.hasAttribute("level")?this.getAttribute("level"):"ephemeral",this.message="",this.messageTextContent=this.textContent;this.shadowRoot.innerHTML=`\n        <style>\n            \n        :host{\n            display:none;\n        }\n    \n        </style>\n        ${this.renderHTML()}\n    `}renderHTML(){return"\n        <slot></slot>\n    "}async perform(){super.perform(),this.hasAttribute("value")?this.message=this._getValue():(this.getOwnerForm().evaluateTemplateExpression(this.messageTextContent,this.firstChild),this.message=this.textContent),this.dispatchEvent(new CustomEvent("message",{composed:!1,bubbles:!0,detail:{level:this.level,message:this.message}}))}_getValue(){if(this.hasAttribute("value")){const e=this.getAttribute("value");try{return xt(e,Ct(this,e),this)}catch(e){St.dispatch(this,"error",{message:e})}}return this.textContent?this.textContent:null}}customElements.get("fx-message")||window.customElements.define("fx-message",Bn);class In extends bn{static get properties(){return{...super.properties,ref:{type:String},valueAttr:{type:String}}}constructor(){super(),this.ref="",this.valueAttr=""}connectedCallback(){if(super.connectedCallback&&super.connectedCallback(),!this.hasAttribute("ref"))throw new Error('fx-setvalue must specify a "ref" attribute');this.ref=this.getAttribute("ref"),this.valueAttr=this.getAttribute("value")}async perform(){super.perform();let{value:e}=this;null!==this.valueAttr?[e]=gt(this.valueAttr,this.nodeset,this,this.detail):e=""!==this.textContent?this.textContent:"",e.nodeType===Node.ATTRIBUTE_NODE&&(e=e.nodeValue);const t=this.getModelItem();this.setValue(t,e)}dispatchExecute(){}setValue(e,t){const n=e;if(n&&n.value!==t){const r=St.getDomNodeIndexString(e.node),o=this.event,i=this;this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:i,event:o,value:t,path:r}})),t.nodeType?(t.nodeType===Node.ELEMENT_NODE&&(n.value=t.textContent),t.nodeType===Node.ATTRIBUTE_NODE&&(n.value=t.getValue())):n.value=t,this.getModel().changed.push(e),this.needsUpdate=!0}}}customElements.get("fx-setvalue")||window.customElements.define("fx-setvalue",In);class Cn extends bn{constructor(){super(),this.value="",this.url=null,this.target=null}connectedCallback(){super.connectedCallback(),this.submission=this.getAttribute("submission"),this.url=this.hasAttribute("url")?this.getAttribute("url"):null,this.target=this.hasAttribute("target")?this.getAttribute("target"):null}async perform(){super.perform(),this.getOwnerForm().classList.remove("submit-validation-failed");const e=this.getModel().querySelector(`#${this.submission}`);if(null!==e){if(this.url){const t=this.evaluateAttributeTemplateExpression(this.url,this);e.parameters.set("url",t)}if(this.target){const t=this.evaluateAttributeTemplateExpression(this.target,this);e.parameters.set("target",t)}await e.submit()}else this.dispatchEvent(new CustomEvent("log",{composed:!1,bubbles:!0,cancelable:!0,detail:{id:this.id,message:`fx-submission element with id: '${this.submission}' not found`,level:"Error"}}))}}customElements.get("fx-send")||window.customElements.define("fx-send",Cn);class Sn extends bn{connectedCallback(){super.connectedCallback(),this.hasAttribute("case")&&(this.case=this.getAttribute("case"))}async perform(){if(super.perform(),this.case){const e=this.getOwnerForm().querySelector(`#${this.case}`);if(!e)return void St.dispatch(this,"error",{message:`fx-case id not found: ${this.case}`});e.parentNode.toggle(e)}}}customElements.get("fx-toggle")||window.customElements.define("fx-toggle",Sn);class On extends bn{static get properties(){return{...super.properties,name:{type:String},targetid:{type:String},details:{type:String}}}constructor(){super(),this.name=null,this.targetid=null,this.details=null,this.attachShadow({mode:"open"})}connectedCallback(){if(super.connectedCallback(),this.name=this.getAttribute("name"),!this.name)throw new Error("no event specified for dispatch",this);this.targetid=this.hasAttribute("targetid")?this.getAttribute("targetid"):null}async perform(){super.perform();const e=this.querySelectorAll("fx-property"),t={};if(Array.from(e).forEach((e=>{const n=e.getAttribute("name"),r=e.getAttribute("value"),o=e.getAttribute("expr");if(o){if(r)throw new Error('if "expr" is given there must not be a "value" attribute');const[e]=gt(o,this.getInScopeContext(),this);let i=null;if(e.nodeName){i=(new XMLSerializer).serializeToString(e)}t[n]=i||e}r&&(t[n]=r)})),this.targetid){let e=ct(this.targetid,this.parentNode,null);if(e||(e=document.getElementById(this.targetid)),!e)throw new Error(`targetid ${this.targetid} does not exist in document`);e.dispatchEvent(new CustomEvent(this.name,{composed:!0,bubbles:!0,detail:t}))}else document.dispatchEvent(new CustomEvent(this.name,{composed:!0,bubbles:!0,detail:t}))}}customElements.get("fx-dispatch")||window.customElements.define("fx-dispatch",On);class kn extends bn{async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}})),this.getModel().updateModel()}}customElements.get("fx-update")||window.customElements.define("fx-update",kn);class Dn extends bn{async perform(){if(this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}})),this.hasAttribute("self")){const e=et.getClosest("fx-control",this);if(e)return void e.refresh()}if(this.hasAttribute("force"))this.getOwnerForm().forceRefresh();else if(this.hasAttribute("control")){const e=ct(this.getAttribute("control"),this);e&&St.isUiElement(e.nodeName)&&"function"==typeof e.refresh&&e.refresh()}else this.getOwnerForm().refresh()}}customElements.get("fx-refresh")||window.customElements.define("fx-refresh",Dn);class Rn extends bn{static get properties(){return{...super.properties,with:{type:String},replaceNode:Object}}constructor(){super(),this.with=""}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.with=this.getAttribute("with")}async perform(){super.perform();const e=yt(this.with,this.nodeset,this);e&&this.replace(this.nodeset,e)}actionPerformed(){this.getModel().rebuild(),super.actionPerformed()}replace(e,t){if(e&&t&&e.nodeName&&t.nodeName){if(e.nodeType===Node.ATTRIBUTE_NODE){const{ownerElement:n}=e;n.setAttribute(t.nodeName,t.textContent),n.removeAttribute(e.nodeName)}else if(e.nodeType===Node.ELEMENT_NODE){const n=t.cloneNode(!0);e.replaceWith(n)}this.needsUpdate=!0}}}customElements.get("fx-replace")||window.customElements.define("fx-replace",Rn);class Mn extends bn{connectedCallback(){super.connectedCallback&&super.connectedCallback()}async perform(){super.perform();const e=new CustomEvent("return",{composed:!0,bubbles:!0,detail:{nodeset:this.nodeset}});this.getOwnerForm().dispatchEvent(e)}}customElements.get("fx-return")||window.customElements.define("fx-return",Mn);class Un extends bn{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.src=this.hasAttribute("src")?this.getAttribute("src"):null;this.shadowRoot.innerHTML="\n        <style>\n            \n        :host{\n            display:none;\n        }\n    \n        </style>\n        <slot></slot>\n    "}async perform(){super.perform();const{children:e}=this;if(this.src){this.innerHTML="";const e=document.createElement("script");e.src=this.src,this.appendChild(e)}else{for(const t of e){if("fx-var"===t.localName)continue;const e=t;e.detail=this.detail,await e.execute()}this.dispatchActionPerformed(),this.needsUpdate=!0}}}customElements.get("fx-action")||window.customElements.define("fx-action",Un);class Fn extends Un{static get properties(){return{...Un.properties,message:{type:String}}}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.message=this.hasAttribute("message")?this.getAttribute("message"):null}async perform(){window.confirm(this.message)&&super.perform()}}customElements.get("fx-confirm")||window.customElements.define("fx-confirm",Fn);class Gn extends Un{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.dialog=this.getAttribute("dialog"),this.dialog||St.dispatch(this,"error",{message:"dialog does not exist"})}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}}));const e=ct(this.dialog,this);e.open(),St.dispatch(e,"dialog-shown",{})}}customElements.get("fx-show")||window.customElements.define("fx-show",Gn);class Ln extends bn{static get properties(){return{...super.properties,dialog:{type:String}}}connectedCallback(){super.connectedCallback(),this.dialog=this.getAttribute("dialog"),this.dialog||St.dispatch(this,"error",{message:"dialog does not exist"})}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}}));const e=ct(this.dialog,this);e.hide(),St.dispatch(e,"dialog-hidden",{})}}customElements.get("fx-hide")||window.customElements.define("fx-hide",Ln);class Pn extends bn{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.addEventListener("reload",(()=>{window.location.reload()}),{once:!0})}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}})),St.dispatch(this,"reload",{})}}customElements.get("fx-reload")||window.customElements.define("fx-reload",Pn);class Hn extends bn{static get properties(){return{...super.properties,instance:{type:String}}}connectedCallback(){super.connectedCallback(),this.instance=this.getAttribute("instance"),this.instance||St.dispatch(this,"error",{message:"instance does not exist"})}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}}));this.getModel().getInstance(this.instance).reset(),this.needsUpdate=!0}}customElements.get("fx-reset")||window.customElements.define("fx-reset",Hn);class _n extends bn{static get properties(){return{...super.properties,attachTo:{type:String},url:{type:String}}}constructor(){super(),this.attachShadow({mode:"open"}),this.url=""}connectedCallback(){super.connectedCallback(),this.attachTo=this.hasAttribute("attach-to")?this.getAttribute("attach-to"):"_self",this.awaitEvent=this.hasAttribute("await")?this.getAttribute("await"):"",this.url=this.hasAttribute("url")?this.getAttribute("url"):"";this.shadowRoot.innerHTML=`\n            <style>\n                \n            :host{\n                display:none;\n            }\n        \n            </style>\n            ${this.renderHTML()}`}disconnectedCallback(){this.targetElement.removeEventListener(this.event,(e=>this.execute(e)))}renderHTML(){return"\n        <slot></slot>\n    "}async perform(){await super.perform();const e=this.querySelector("template");if(e){const t=e.content.cloneNode(!0),n=document.importNode(t,!0);if(this.attachTo.startsWith("#")){const e=ct(this.attachTo.substring(1),this);for(;e.firstChild;)e.removeChild(e.firstChild);if(this.awaitEvent){let t;const r=new Promise((e=>{t=e})),o=()=>{t(),e.removeEventListener(this.awaitEvent,o)};return e.appendChild(n),e.addEventListener(this.awaitEvent,o),await r,this.needsUpdate=!0,void St.dispatch(this,"loaded",{attachPoint:this.attachTo,content:n})}e.appendChild(n),this.needsUpdate=!0}St.dispatch(this,"loaded",{})}else if(this.url){this.url=this.evaluateAttributeTemplateExpression(this.url,this),"_blank"===this.attachTo&&window.open(this.url),"_self"===this.attachTo&&(window.location.href=this.url);try{const e=await fetch(this.url,{method:"GET",mode:"cors",credentials:"same-origin",headers:{"Content-Type":"text/html"}}),t=await e.text();this.attachTo||(this.innerHtml=t),this._attachToElement(t),St.dispatch(this,"loaded",{url:this.url})}catch(e){throw new Error(`failed loading data ${e}`)}}else this.dispatchEvent(new CustomEvent("log",{composed:!1,bubbles:!0,cancelable:!0,detail:{id:this.id,message:"neiter template element nor Url was specified.",level:"Error"}}))}_attachToElement(e){if(this.attachTo.startsWith("#")){const t=ct(this.attachTo.substring(1),this);t.innerHTML="",t.innerHTML=e}}_evaluateUrlExpression(){const e=this.getAttribute("url");if(!e)throw new Error("url not specified");return e.replace(/{[^}]*}/g,(e=>{if("{}"===e)return e;const t=e.substring(1,e.length-1),n=Ct(this,t);if(!n)return e;const r=et.getInstanceId(t),o=r?this.getModel().getInstance(r):this.getModel().getDefaultInstance();try{return xt(t,n,this,null,o)}catch(t){return e}}))}}customElements.get("fx-load")||window.customElements.define("fx-load",_n);class jn extends(Rt(HTMLElement)){constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.style.display="none",this.signature=this.hasAttribute("signature")?this.getAttribute("signature"):null,this.signature,this.type=this.hasAttribute("type")?this.getAttribute("type"):null,this.shadowRoot.innerHTML="<slot></slot>",this.override=this.hasAttribute("override")?this.getAttribute("override"):"true",this.functionBody=this.innerText;const e=this.getAttribute("type")||"text/xpath",t=this.signature.match(/(?:(?<prefix>[^:]*):)?(?<localName>[^(]+)\((?<params>(?:\(\)|[^)])*)\)(?: as (?<returnType>.*))?/);if(!t)throw new Error(`Function signature ${this.signature} could not be parsed`);const{prefix:n,localName:r,params:o,returnType:i}=t.groups,a="local"!==n&&n?`${n}:${r}`:{namespaceURI:"http://www.w3.org/2005/xquery-local-functions",localName:r};n||at.push(r);const s=o?o.split(",").map((e=>{const t=e.match(/(?<variableName>\$[^\s]+)(?:\sas\s(?<varType>.+))/);if(!t)throw new Error(`Param ${e} could not be parsed`);const{variableName:n,varType:r}=t.groups;return{variableName:n,variableType:r||"item()*"}})):[];switch(e){case"text/javascript":{const e=new Function("_domFacade",...s.map((e=>e.variableName)),"form",this.functionBody);We(a,s.map((e=>e.variableType)),i||"item()*",((...t)=>e.apply(this.getInScopeContext(),[...t,this.getOwnerForm()])));break}case"text/xquf":case"text/xquery":case"text/xpath":{const t="text/xpath"===e?"XPath3.1":"text/xquery"===e?"XQuery3.1":"XQueryUpdate3.1",n=(e,...n)=>gt(this.functionBody,this.getInScopeContext(),this.getOwnerForm(),s.reduce(((e,t,r)=>(e[t.variableName.replace("$","")]=n[r],e)),{}),{language:t});We(a,s.map((e=>e.variableType)),i||"item()*",n);break}default:throw new Error(`Unexpected mimetype ${e} for function`)}}}customElements.get("fx-function")||customElements.define("fx-function",jn);
//# sourceMappingURL=fore.js.map
