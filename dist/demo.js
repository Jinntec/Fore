/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
const e=!(window.ShadyDOM&&window.ShadyDOM.inUse);let t,n;function i(n){t=(!n||!n.shimcssproperties)&&(e||Boolean(!navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)&&window.CSS&&CSS.supports&&CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.cssBuild&&(n=window.ShadyCSS.cssBuild);const r=Boolean(window.ShadyCSS&&window.ShadyCSS.disableRuntime);window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?t=window.ShadyCSS.nativeCss:window.ShadyCSS?(i(window.ShadyCSS),window.ShadyCSS=void 0):i(window.WebComponents&&window.WebComponents.flags);const s=t;
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/class o{constructor(){this.start=0,this.end=0,this.previous=null,this.parent=null,this.rules=null,this.parsedCssText="",this.cssText="",this.atRule=!1,this.type=0,this.keyframesName="",this.selector="",this.parsedSelector=""}}function a(e){return l(function(e){let t=new o;t.start=0,t.end=e.length;let n=t;for(let i=0,r=e.length;i<r;i++)if(e[i]===u){n.rules||(n.rules=[]);let e=n,t=e.rules[e.rules.length-1]||null;n=new o,n.start=i+1,n.parent=e,n.previous=t,e.rules.push(n)}else e[i]===d&&(n.end=i+1,n=n.parent||t);return t}(e=e.replace(p.comments,"").replace(p.port,"")),e)}function l(e,t){let n=t.substring(e.start,e.end-1);if(e.parsedCssText=e.cssText=n.trim(),e.parent){let i=e.previous?e.previous.end:e.parent.start;n=t.substring(i,e.start-1),n=function(e){return e.replace(/\\([0-9a-f]{1,6})\s/gi,(function(){let e=arguments[1],t=6-e.length;for(;t--;)e="0"+e;return"\\"+e}))}(n),n=n.replace(p.multipleSpaces," "),n=n.substring(n.lastIndexOf(";")+1);let r=e.parsedSelector=e.selector=n.trim();e.atRule=0===r.indexOf(g),e.atRule?0===r.indexOf(m)?e.type=c.MEDIA_RULE:r.match(p.keyframesRule)&&(e.type=c.KEYFRAMES_RULE,e.keyframesName=e.selector.split(p.multipleSpaces).pop()):0===r.indexOf(f)?e.type=c.MIXIN_RULE:e.type=c.STYLE_RULE}let i=e.rules;if(i)for(let e,n=0,r=i.length;n<r&&(e=i[n]);n++)l(e,t);return e}function h(e,t,n=""){let i="";if(e.cssText||e.rules){let n=e.rules;if(n&&!function(e){let t=e[0];return Boolean(t)&&Boolean(t.selector)&&0===t.selector.indexOf(f)}(n))for(let e,r=0,s=n.length;r<s&&(e=n[r]);r++)i=h(e,t,i);else i=t?e.cssText:function(e){return function(e){return e.replace(p.mixinApply,"").replace(p.varApply,"")}(e=function(e){return e.replace(p.customProp,"").replace(p.mixinProp,"")}(e))}(e.cssText),i=i.trim(),i&&(i="  "+i+"\n")}return i&&(e.selector&&(n+=e.selector+" "+u+"\n"),n+=i,e.selector&&(n+=d+"\n\n")),n}const c={STYLE_RULE:1,KEYFRAMES_RULE:7,MEDIA_RULE:4,MIXIN_RULE:1e3},u="{",d="}",p={comments:/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,port:/@import[^;]*;/gim,customProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mixinProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,mixinApply:/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,varApply:/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,keyframesRule:/^@[^\s]*keyframes/,multipleSpaces:/\s+/g},f="--",m="@media",g="@",O=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,y=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,v=/@media\s(.*)/,b=new Set;function w(e){const t=e.textContent;if(!b.has(t)){b.add(t);const e=document.createElement("style");e.setAttribute("shady-unscoped",""),e.textContent=t,document.head.appendChild(e)}}function x(e){return e.hasAttribute("shady-unscoped")}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function S(e,t){return e?("string"==typeof e&&(e=a(e)),t&&A(e,t),h(e,s)):""}function k(e){return!e.__cssRules&&e.textContent&&(e.__cssRules=a(e.textContent)),e.__cssRules||null}function A(e,t,n,i){if(!e)return;let r=!1,s=e.type;if(i&&s===c.MEDIA_RULE){let t=e.selector.match(v);t&&(window.matchMedia(t[1]).matches||(r=!0))}s===c.STYLE_RULE?t(e):n&&s===c.KEYFRAMES_RULE?n(e):s===c.MIXIN_RULE&&(r=!0);let o=e.rules;if(o&&!r)for(let e,r=0,s=o.length;r<s&&(e=o[r]);r++)A(e,t,n,i)}function C(e,t){let n=e.indexOf("var(");if(-1===n)return t(e,"","","");let i=function(e,t){let n=0;for(let i=t,r=e.length;i<r;i++)if("("===e[i])n++;else if(")"===e[i]&&0==--n)return i;return-1}(e,n+3),r=e.substring(n+4,i),s=e.substring(0,n),o=C(e.substring(i+1),t),a=r.indexOf(",");return-1===a?t(s,r.trim(),"",o):t(s,r.substring(0,a).trim(),r.substring(a+1).trim(),o)}window.ShadyDOM&&window.ShadyDOM.wrap;function _(e){if(void 0!==n)return n;if(void 0===e.__cssBuild){const t=e.getAttribute("css-build");if(t)e.__cssBuild=t;else{const t=function(e){const t="template"===e.localName?e.content.firstChild:e.firstChild;if(t instanceof Comment){const e=t.textContent.trim().split(":");if("css-build"===e[0])return e[1]}return""}(e);""!==t&&function(e){const t="template"===e.localName?e.content.firstChild:e.firstChild;t.parentNode.removeChild(t)}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/(e),e.__cssBuild=t}}return e.__cssBuild||""}function E(e){return""!==_(e)}function T(e,t){for(let n in t)null===n?e.style.removeProperty(n):e.style.setProperty(n,t[n])}function P(e,t){const n=window.getComputedStyle(e).getPropertyValue(t);return n?n.trim():""}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
const $=/;\s*/m,N=/^\s*(initial)|(inherit)\s*$/,I=/\s*!important/;class Q{constructor(){this._map={}}set(e,t){e=e.trim(),this._map[e]={properties:t,dependants:{}}}get(e){return e=e.trim(),this._map[e]||null}}let R=null;class M{constructor(){this._currentElement=null,this._measureElement=null,this._map=new Q}detectMixin(e){return function(e){const t=y.test(e)||O.test(e);return y.lastIndex=0,O.lastIndex=0,t}(e)}gatherStyles(t){const n=function(t){const n=[],i=t.querySelectorAll("style");for(let t=0;t<i.length;t++){const r=i[t];x(r)?e||(w(r),r.parentNode.removeChild(r)):(n.push(r.textContent),r.parentNode.removeChild(r))}return n.join("").trim()}(t.content);if(n){const e=document.createElement("style");return e.textContent=n,t.content.insertBefore(e,t.content.firstChild),e}return null}transformTemplate(e,t){void 0===e._gatheredStyle&&(e._gatheredStyle=this.gatherStyles(e));const n=e._gatheredStyle;return n?this.transformStyle(n,t):null}transformStyle(e,t=""){let n=k(e);return this.transformRules(n,t),e.textContent=S(n),n}transformCustomStyle(e){let t=k(e);return A(t,(e=>{":root"===e.selector&&(e.selector="html"),this.transformRule(e)})),e.textContent=S(t),t}transformRules(e,t){this._currentElement=t,A(e,(e=>{this.transformRule(e)})),this._currentElement=null}transformRule(e){e.cssText=this.transformCssText(e.parsedCssText,e),":root"===e.selector&&(e.selector=":host > *")}transformCssText(e,t){return e=e.replace(O,((e,n,i,r)=>this._produceCssProperties(e,n,i,r,t))),this._consumeCssProperties(e,t)}_getInitialValueForProperty(e){return this._measureElement||(this._measureElement=document.createElement("meta"),this._measureElement.setAttribute("apply-shim-measure",""),this._measureElement.style.all="initial",document.head.appendChild(this._measureElement)),window.getComputedStyle(this._measureElement).getPropertyValue(e)}_fallbacksFromPreviousRules(e){let t=e;for(;t.parent;)t=t.parent;const n={};let i=!1;return A(t,(t=>{i=i||t===e,i||t.selector===e.selector&&Object.assign(n,this._cssTextToMap(t.parsedCssText))})),n}_consumeCssProperties(e,t){let n=null;for(;n=y.exec(e);){let i=n[0],r=n[1],s=n.index,o=s+i.indexOf("@apply"),a=s+i.length,l=e.slice(0,o),h=e.slice(a),c=t?this._fallbacksFromPreviousRules(t):{};Object.assign(c,this._cssTextToMap(l));let u=this._atApplyToCssProperties(r,c);e=`${l}${u}${h}`,y.lastIndex=s+u.length}return e}_atApplyToCssProperties(e,t){e=e.replace($,"");let n=[],i=this._map.get(e);if(i||(this._map.set(e,{}),i=this._map.get(e)),i){let r,s,o;this._currentElement&&(i.dependants[this._currentElement]=!0);const a=i.properties;for(r in a)o=t&&t[r],s=[r,": var(",e,"_-_",r],o&&s.push(",",o.replace(I,"")),s.push(")"),I.test(a[r])&&s.push(" !important"),n.push(s.join(""))}return n.join("; ")}_replaceInitialOrInherit(e,t){let n=N.exec(t);return n&&(t=n[1]?this._getInitialValueForProperty(e):"apply-shim-inherit"),t}_cssTextToMap(e,t=!1){let n,i,r=e.split(";"),s={};for(let e,o,a=0;a<r.length;a++)e=r[a],e&&(o=e.split(":"),o.length>1&&(n=o[0].trim(),i=o.slice(1).join(":"),t&&(i=this._replaceInitialOrInherit(n,i)),s[n]=i));return s}_invalidateMixinEntry(e){if(R)for(let t in e.dependants)t!==this._currentElement&&R(t)}_produceCssProperties(e,t,n,i,r){if(n&&C(n,((e,t)=>{t&&this._map.get(t)&&(i=`@apply ${t};`)})),!i)return e;let s=this._consumeCssProperties(""+i,r),o=e.slice(0,e.indexOf("--")),a=this._cssTextToMap(s,!0),l=a,h=this._map.get(t),c=h&&h.properties;c?l=Object.assign(Object.create(c),a):this._map.set(t,l);let u,d,p=[],f=!1;for(u in l)d=a[u],void 0===d&&(d="initial"),c&&!(u in c)&&(f=!0),p.push(`${t}_-_${u}: ${d}`);return f&&this._invalidateMixinEntry(h),h&&(h.properties=l),n&&(o=`${e};${o}`),`${o}${p.join("; ")};`}}M.prototype.detectMixin=M.prototype.detectMixin,M.prototype.transformStyle=M.prototype.transformStyle,M.prototype.transformCustomStyle=M.prototype.transformCustomStyle,M.prototype.transformRules=M.prototype.transformRules,M.prototype.transformRule=M.prototype.transformRule,M.prototype.transformTemplate=M.prototype.transformTemplate,M.prototype._separator="_-_",Object.defineProperty(M.prototype,"invalidCallback",{get:()=>R,set(e){R=e}});
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
const B={},D="_applyShimCurrentVersion",X="_applyShimNextVersion",F="_applyShimValidatingVersion",L=Promise.resolve();
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function U(e){let t=B[e];t&&function(e){e[D]=e[D]||0,e[F]=e[F]||0,e[X]=(e[X]||0)+1}(t)}function V(e){return e[D]===e[X]}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
let z,Z=null,j=window.HTMLImports&&window.HTMLImports.whenReady||null;function q(e){requestAnimationFrame((function(){j?j(e):(Z||(Z=new Promise((e=>{z=e})),"complete"===document.readyState?z():document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&z()}))),Z.then((function(){e&&e()})))}))}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const G="__shadyCSSCachedStyle";let W=null,H=null;class Y{constructor(){this.customStyles=[],this.enqueued=!1,q((()=>{window.ShadyCSS.flushCustomStyles&&window.ShadyCSS.flushCustomStyles()}))}enqueueDocumentValidation(){!this.enqueued&&H&&(this.enqueued=!0,q(H))}addCustomStyle(e){e.__seenByShadyCSS||(e.__seenByShadyCSS=!0,this.customStyles.push(e),this.enqueueDocumentValidation())}getStyleForCustomStyle(e){if(e[G])return e[G];let t;return t=e.getStyle?e.getStyle():e,t}processStyles(){const e=this.customStyles;for(let t=0;t<e.length;t++){const n=e[t];if(n[G])continue;const i=this.getStyleForCustomStyle(n);if(i){const e=i.__appliedElement||i;W&&W(e),n[G]=e}}return e}}Y.prototype.addCustomStyle=Y.prototype.addCustomStyle,Y.prototype.getStyleForCustomStyle=Y.prototype.getStyleForCustomStyle,Y.prototype.processStyles=Y.prototype.processStyles,Object.defineProperties(Y.prototype,{transformCallback:{get:()=>W,set(e){W=e}},validateCallback:{get:()=>H,set(e){let t=!1;H||(t=!0),H=e,t&&this.enqueueDocumentValidation()}}});
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
const J=new M;class K{constructor(){this.customStyleInterface=null,J.invalidCallback=U}ensure(){this.customStyleInterface||window.ShadyCSS.CustomStyleInterface&&(this.customStyleInterface=window.ShadyCSS.CustomStyleInterface,this.customStyleInterface.transformCallback=e=>{J.transformCustomStyle(e)},this.customStyleInterface.validateCallback=()=>{requestAnimationFrame((()=>{this.customStyleInterface.enqueued&&this.flushCustomStyles()}))})}prepareTemplate(e,t){if(this.ensure(),E(e))return;B[t]=e;let n=J.transformTemplate(e,t);e._styleAst=n}flushCustomStyles(){if(this.ensure(),!this.customStyleInterface)return;let e=this.customStyleInterface.processStyles();if(this.customStyleInterface.enqueued){for(let t=0;t<e.length;t++){let n=e[t],i=this.customStyleInterface.getStyleForCustomStyle(n);i&&J.transformCustomStyle(i)}this.customStyleInterface.enqueued=!1}}styleSubtree(e,t){if(this.ensure(),t&&T(e,t),e.shadowRoot){this.styleElement(e);let t=e.shadowRoot.children||e.shadowRoot.childNodes;for(let e=0;e<t.length;e++)this.styleSubtree(t[e])}else{let t=e.children||e.childNodes;for(let e=0;e<t.length;e++)this.styleSubtree(t[e])}}styleElement(e){this.ensure();let{is:t}=function(e){let t=e.localName,n="",i="";return t?t.indexOf("-")>-1?n=t:(i=t,n=e.getAttribute&&e.getAttribute("is")||""):(n=e.is,i=e.extends),{is:n,typeExtension:i}}(e),n=B[t];if((!n||!E(n))&&n&&!V(n)){(function(e){return!V(e)&&e[F]===e[X]})(n)||(this.prepareTemplate(n,t),function(e){e[F]=e[X],e._validating||(e._validating=!0,L.then((function(){e[D]=e[X],e._validating=!1})))}(n));let i=e.shadowRoot;if(i){let e=i.querySelector("style");e&&(e.__cssRules=n._styleAst,e.textContent=S(n._styleAst))}}}styleDocument(e){this.ensure(),this.styleSubtree(document.body,e)}}if(!window.ShadyCSS||!window.ShadyCSS.ScopingShim){const t=new K;let i=window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface;window.ShadyCSS={prepareTemplate(e,n,i){t.flushCustomStyles(),t.prepareTemplate(e,n)},prepareTemplateStyles(e,t,n){window.ShadyCSS.prepareTemplate(e,t,n)},prepareTemplateDom(e,t){},styleSubtree(e,n){t.flushCustomStyles(),t.styleSubtree(e,n)},styleElement(e){t.flushCustomStyles(),t.styleElement(e)},styleDocument(e){t.flushCustomStyles(),t.styleDocument(e)},getComputedStyleValue:(e,t)=>P(e,t),flushCustomStyles(){t.flushCustomStyles()},nativeCss:s,nativeShadow:e,cssBuild:n,disableRuntime:r},i&&(window.ShadyCSS.CustomStyleInterface=i)}window.ShadyCSS.ApplyShim=J,
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
window.JSCompiler_renameProperty=function(e,t){return e};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
let ee,te,ne=/(url\()([^)]*)(\))/g,ie=/(^\/[^\/])|(^#)|(^[\w-\d]*:)/;function re(e,t){if(e&&ie.test(e))return e;if("//"===e)return e;if(void 0===ee){ee=!1;try{const e=new URL("b","http://a");e.pathname="c%20d",ee="http://a/c%20d"===e.href}catch(e){}}if(t||(t=document.baseURI||window.location.href),ee)try{return new URL(e,t).href}catch(t){return e}return te||(te=document.implementation.createHTMLDocument("temp"),te.base=te.createElement("base"),te.head.appendChild(te.base),te.anchor=te.createElement("a"),te.body.appendChild(te.anchor)),te.base.href=t,te.anchor.href=e,te.anchor.href||e}function se(e,t){return e.replace(ne,(function(e,n,i,r){return n+"'"+re(i.replace(/["']/g,""),t)+"'"+r}))}function oe(e){return e.substring(0,e.lastIndexOf("/")+1)}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const ae=!window.ShadyDOM||!window.ShadyDOM.inUse;Boolean(!window.ShadyCSS||window.ShadyCSS.nativeCss);const le=ae&&"adoptedStyleSheets"in Document.prototype&&"replaceSync"in CSSStyleSheet.prototype&&(()=>{try{const e=new CSSStyleSheet;e.replaceSync("");const t=document.createElement("div");return t.attachShadow({mode:"open"}),t.shadowRoot.adoptedStyleSheets=[e],t.shadowRoot.adoptedStyleSheets[0]===e}catch(e){return!1}})();let he=window.Polymer&&window.Polymer.rootPath||oe(document.baseURI||window.location.href),ce=window.Polymer&&window.Polymer.sanitizeDOMValue||void 0,ue=window.Polymer&&window.Polymer.setPassiveTouchGestures||!1,de=window.Polymer&&window.Polymer.strictTemplatePolicy||!1,pe=window.Polymer&&window.Polymer.allowTemplateFromDomModule||!1,fe=window.Polymer&&window.Polymer.legacyOptimizations||!1,me=window.Polymer&&window.Polymer.legacyWarnings||!1,ge=window.Polymer&&window.Polymer.syncInitialRender||!1,Oe=window.Polymer&&window.Polymer.legacyUndefined||!1,ye=window.Polymer&&window.Polymer.orderedComputed||!1,ve=window.Polymer&&window.Polymer.removeNestedTemplates||!1,be=window.Polymer&&window.Polymer.fastDomIf||!1,we=window.Polymer&&window.Polymer.suppressTemplateNotifications||!1,xe=window.Polymer&&window.Polymer.legacyNoObservedAttributes||!1,Se=window.Polymer&&window.Polymer.useAdoptedStyleSheetsWithBuiltCSS||!1,ke=0;const Ae=function(e){let t=e.__mixinApplications;t||(t=new WeakMap,e.__mixinApplications=t);let n=ke++;return function(i){let r=i.__mixinSet;if(r&&r[n])return i;let s=t,o=s.get(i);if(!o){o=e(i),s.set(i,o);let t=Object.create(o.__mixinSet||r||null);t[n]=!0,o.__mixinSet=t}return o}};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let Ce={},_e={};function Ee(e,t){Ce[e]=_e[e.toLowerCase()]=t}function Te(e){return Ce[e]||_e[e.toLowerCase()]}class Pe extends HTMLElement{static get observedAttributes(){return["id"]}static import(e,t){if(e){let n=Te(e);return n&&t?n.querySelector(t):n}return null}attributeChangedCallback(e,t,n,i){t!==n&&this.register()}get assetpath(){if(!this.__assetpath){const e=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument,t=re(this.getAttribute("assetpath")||"",e.baseURI);this.__assetpath=oe(t)}return this.__assetpath}register(e){if(e=e||this.id){if(de&&void 0!==Te(e))throw Ee(e,null),new Error(`strictTemplatePolicy: dom-module ${e} re-registered`);this.id=e,Ee(e,this),this.querySelector("style")}}}Pe.prototype.modules=Ce,customElements.define("dom-module",Pe);function $e(e){return Pe.import(e)}function Ne(e){const t=se((e.body?e.body:e).textContent,e.baseURI),n=document.createElement("style");return n.textContent=t,n}function Ie(e){const t=e.trim().split(/\s+/),n=[];for(let e=0;e<t.length;e++)n.push(...Qe(t[e]));return n}function Qe(e){const t=$e(e);if(!t)return[];if(void 0===t._styles){const e=[];e.push(...Me(t));const n=t.querySelector("template");n&&e.push(...Re(n,t.assetpath)),t._styles=e}return t._styles}function Re(e,t){if(!e._styles){const n=[],i=e.content.querySelectorAll("style");for(let e=0;e<i.length;e++){let r=i[e],s=r.getAttribute("include");s&&n.push(...Ie(s).filter((function(e,t,n){return n.indexOf(e)===t}))),t&&(r.textContent=se(r.textContent,t)),n.push(r)}e._styles=n}return e._styles}function Me(e){const t=[],n=e.querySelectorAll("link[rel=import][type~=css]");for(let e=0;e<n.length;e++){let i=n[e];if(i.import){const e=i.import,n=i.hasAttribute("shady-unscoped");if(n&&!e._unscopedStyle){const t=Ne(e);t.setAttribute("shady-unscoped",""),e._unscopedStyle=t}else e._style||(e._style=Ne(e));t.push(n?e._unscopedStyle:e._style)}}return t}function Be(e){let t=$e(e);if(t&&void 0===t._cssText){let e=function(e){let t="",n=Me(e);for(let e=0;e<n.length;e++)t+=n[e].textContent;return t}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/(t),n=t.querySelector("template");n&&(e+=function(e,t){let n="";const i=Re(e,t);for(let e=0;e<i.length;e++){let t=i[e];t.parentNode&&t.parentNode.removeChild(t),n+=t.textContent}return n}(n,t.assetpath)),t._cssText=e||null}return t&&t._cssText||""}const De=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:window.ShadyDOM?e=>ShadyDOM.patch(e):e=>e
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/;function Xe(e){return e.indexOf(".")>=0}function Fe(e){let t=e.indexOf(".");return-1===t?e:e.slice(0,t)}function Le(e,t){return 0===e.indexOf(t+".")}function Ue(e,t){return 0===t.indexOf(e+".")}function Ve(e,t,n){return t+n.slice(e.length)}function ze(e){if(Array.isArray(e)){let t=[];for(let n=0;n<e.length;n++){let i=e[n].toString().split(".");for(let e=0;e<i.length;e++)t.push(i[e])}return t.join(".")}return e}function Ze(e){return Array.isArray(e)?ze(e).split("."):e.toString().split(".")}function je(e,t,n){let i=e,r=Ze(t);for(let e=0;e<r.length;e++){if(!i)return;i=i[r[e]]}return n&&(n.path=r.join(".")),i}function qe(e,t,n){let i=e,r=Ze(t),s=r[r.length-1];if(r.length>1){for(let e=0;e<r.length-1;e++){if(i=i[r[e]],!i)return}i[s]=n}else i[t]=n;return r.join(".")}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const Ge={},We=/-[a-z]/g,He=/([A-Z])/g;function Ye(e){return Ge[e]||(Ge[e]=e.indexOf("-")<0?e:e.replace(We,(e=>e[1].toUpperCase())))}function Je(e){return Ge[e]||(Ge[e]=e.replace(He,"-$1").toLowerCase())}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let Ke=0,et=0,tt=[],nt=0,it=!1,rt=document.createTextNode("");new window.MutationObserver((function(){it=!1;const e=tt.length;for(let t=0;t<e;t++){let e=tt[t];if(e)try{e()}catch(e){setTimeout((()=>{throw e}))}}tt.splice(0,e),et+=e})).observe(rt,{characterData:!0});const st={after:e=>({run:t=>window.setTimeout(t,e),cancel(e){window.clearTimeout(e)}}),run:(e,t)=>window.setTimeout(e,t),cancel(e){window.clearTimeout(e)}},ot={run:e=>(it||(it=!0,rt.textContent=nt++),tt.push(e),Ke++),cancel(e){const t=e-et;if(t>=0){if(!tt[t])throw new Error("invalid async handle: "+e);tt[t]=null}}},at=ot,lt=Ae((e=>class extends e{static createProperties(e){const t=this.prototype;for(let n in e)n in t||t._createPropertyAccessor(n)}static attributeNameForProperty(e){return e.toLowerCase()}static typeForProperty(e){}_createPropertyAccessor(e,t){this._addPropertyToAttributeMap(e),this.hasOwnProperty(JSCompiler_renameProperty("__dataHasAccessor",this))||(this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)),this.__dataHasAccessor[e]||(this.__dataHasAccessor[e]=!0,this._definePropertyAccessor(e,t))}_addPropertyToAttributeMap(e){this.hasOwnProperty(JSCompiler_renameProperty("__dataAttributes",this))||(this.__dataAttributes=Object.assign({},this.__dataAttributes));let t=this.__dataAttributes[e];return t||(t=this.constructor.attributeNameForProperty(e),this.__dataAttributes[t]=e),t}_definePropertyAccessor(e,t){Object.defineProperty(this,e,{get(){return this.__data[e]},set:t?function(){}:function(t){this._setPendingProperty(e,t,!0)&&this._invalidateProperties()}})}constructor(){super(),this.__dataEnabled=!1,this.__dataReady=!1,this.__dataInvalid=!1,this.__data={},this.__dataPending=null,this.__dataOld=null,this.__dataInstanceProps=null,this.__dataCounter=0,this.__serializing=!1,this._initializeProperties()}ready(){this.__dataReady=!0,this._flushProperties()}_initializeProperties(){for(let e in this.__dataHasAccessor)this.hasOwnProperty(e)&&(this.__dataInstanceProps=this.__dataInstanceProps||{},this.__dataInstanceProps[e]=this[e],delete this[e])}_initializeInstanceProperties(e){Object.assign(this,e)}_setProperty(e,t){this._setPendingProperty(e,t)&&this._invalidateProperties()}_getProperty(e){return this.__data[e]}_setPendingProperty(e,t,n){let i=this.__data[e],r=this._shouldPropertyChange(e,t,i);return r&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),this.__dataOld&&!(e in this.__dataOld)&&(this.__dataOld[e]=i),this.__data[e]=t,this.__dataPending[e]=t),r}_isPropertyPending(e){return!(!this.__dataPending||!this.__dataPending.hasOwnProperty(e))}_invalidateProperties(){!this.__dataInvalid&&this.__dataReady&&(this.__dataInvalid=!0,at.run((()=>{this.__dataInvalid&&(this.__dataInvalid=!1,this._flushProperties())})))}_enableProperties(){this.__dataEnabled||(this.__dataEnabled=!0,this.__dataInstanceProps&&(this._initializeInstanceProperties(this.__dataInstanceProps),this.__dataInstanceProps=null),this.ready())}_flushProperties(){this.__dataCounter++;const e=this.__data,t=this.__dataPending,n=this.__dataOld;this._shouldPropertiesChange(e,t,n)&&(this.__dataPending=null,this.__dataOld=null,this._propertiesChanged(e,t,n)),this.__dataCounter--}_shouldPropertiesChange(e,t,n){return Boolean(t)}_propertiesChanged(e,t,n){}_shouldPropertyChange(e,t,n){return n!==t&&(n==n||t==t)}attributeChangedCallback(e,t,n,i){t!==n&&this._attributeToProperty(e,n),super.attributeChangedCallback&&super.attributeChangedCallback(e,t,n,i)}_attributeToProperty(e,t,n){if(!this.__serializing){const i=this.__dataAttributes,r=i&&i[e]||e;this[r]=this._deserializeValue(t,n||this.constructor.typeForProperty(r))}}_propertyToAttribute(e,t,n){this.__serializing=!0,n=arguments.length<3?this[e]:n,this._valueToNodeAttribute(this,n,t||this.constructor.attributeNameForProperty(e)),this.__serializing=!1}_valueToNodeAttribute(e,t,n){const i=this._serializeValue(t);"class"!==n&&"name"!==n&&"slot"!==n||(e=De(e)),void 0===i?e.removeAttribute(n):e.setAttribute(n,i)}_serializeValue(e){return"boolean"==typeof e?e?"":void 0:null!=e?e.toString():void 0}_deserializeValue(e,t){switch(t){case Boolean:return null!==e;case Number:return Number(e);default:return e}}})),ht={};let ct=HTMLElement.prototype;for(;ct;){let e=Object.getOwnPropertyNames(ct);for(let t=0;t<e.length;t++)ht[e[t]]=!0;ct=Object.getPrototypeOf(ct)}const ut=Ae((e=>{const t=lt(e);return class extends t{static createPropertiesForAttributes(){let e=this.observedAttributes;for(let t=0;t<e.length;t++)this.prototype._createPropertyAccessor(Ye(e[t]))}static attributeNameForProperty(e){return Je(e)}_initializeProperties(){this.__dataProto&&(this._initializeProtoProperties(this.__dataProto),this.__dataProto=null),super._initializeProperties()}_initializeProtoProperties(e){for(let t in e)this._setProperty(t,e[t])}_ensureAttribute(e,t){const n=this;n.hasAttribute(e)||this._valueToNodeAttribute(n,t,e)}_serializeValue(e){if("object"==typeof e){if(e instanceof Date)return e.toString();if(e)try{return JSON.stringify(e)}catch(e){return""}}return super._serializeValue(e)}_deserializeValue(e,t){let n;switch(t){case Object:try{n=JSON.parse(e)}catch(t){n=e}break;case Array:try{n=JSON.parse(e)}catch(e){n=null}break;case Date:n=isNaN(e)?String(e):Number(e),n=new Date(n);break;default:n=super._deserializeValue(e,t)}return n}_definePropertyAccessor(e,t){!function(e,t){if(!ht[t]){let n=e[t];void 0!==n&&(e.__data?e._setPendingProperty(t,n):(e.__dataProto?e.hasOwnProperty(JSCompiler_renameProperty("__dataProto",e))||(e.__dataProto=Object.create(e.__dataProto)):e.__dataProto={},e.__dataProto[t]=n))}}(this,e),super._definePropertyAccessor(e,t)}_hasAccessor(e){return this.__dataHasAccessor&&this.__dataHasAccessor[e]}_isPropertyPending(e){return Boolean(this.__dataPending&&e in this.__dataPending)}}})),dt={"dom-if":!0,"dom-repeat":!0};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let pt=!1,ft=!1;function mt(e){(function(){if(!pt){pt=!0;const e=document.createElement("textarea");e.placeholder="a",ft=e.placeholder===e.textContent}return ft})()&&"textarea"===e.localName&&e.placeholder&&e.placeholder===e.textContent&&(e.textContent=null)}function gt(e){let t=e.getAttribute("is");if(t&&dt[t]){let n=e;for(n.removeAttribute("is"),e=n.ownerDocument.createElement(t),n.parentNode.replaceChild(e,n),e.appendChild(n);n.attributes.length;)e.setAttribute(n.attributes[0].name,n.attributes[0].value),n.removeAttribute(n.attributes[0].name)}return e}function Ot(e,t){let n=t.parentInfo&&Ot(e,t.parentInfo);if(!n)return e;for(let e=n.firstChild,i=0;e;e=e.nextSibling)if(t.parentIndex===i++)return e}function yt(e,t,n,i){i.id&&(t[i.id]=n)}function vt(e,t,n){if(n.events&&n.events.length)for(let i,r=0,s=n.events;r<s.length&&(i=s[r]);r++)e._addMethodEventListenerToNode(t,i.name,i.value,e)}function bt(e,t,n,i){n.templateInfo&&(t._templateInfo=n.templateInfo,t._parentTemplateInfo=i)}const wt=Ae((e=>class extends e{static _parseTemplate(e,t){if(!e._templateInfo){let n=e._templateInfo={};n.nodeInfoList=[],n.nestedTemplate=Boolean(t),n.stripWhiteSpace=t&&t.stripWhiteSpace||e.hasAttribute("strip-whitespace"),this._parseTemplateContent(e,n,{parent:null})}return e._templateInfo}static _parseTemplateContent(e,t,n){return this._parseTemplateNode(e.content,t,n)}static _parseTemplateNode(e,t,n){let i=!1,r=e;return"template"!=r.localName||r.hasAttribute("preserve-content")?"slot"===r.localName&&(t.hasInsertionPoint=!0):i=this._parseTemplateNestedTemplate(r,t,n)||i,mt(r),r.firstChild&&this._parseTemplateChildNodes(r,t,n),r.hasAttributes&&r.hasAttributes()&&(i=this._parseTemplateNodeAttributes(r,t,n)||i),i||n.noted}static _parseTemplateChildNodes(e,t,n){if("script"!==e.localName&&"style"!==e.localName)for(let i,r=e.firstChild,s=0;r;r=i){if("template"==r.localName&&(r=gt(r)),i=r.nextSibling,r.nodeType===Node.TEXT_NODE){let n=i;for(;n&&n.nodeType===Node.TEXT_NODE;)r.textContent+=n.textContent,i=n.nextSibling,e.removeChild(n),n=i;if(t.stripWhiteSpace&&!r.textContent.trim()){e.removeChild(r);continue}}let o={parentIndex:s,parentInfo:n};this._parseTemplateNode(r,t,o)&&(o.infoIndex=t.nodeInfoList.push(o)-1),r.parentNode&&s++}}static _parseTemplateNestedTemplate(e,t,n){let i=e,r=this._parseTemplate(i,t);return(r.content=i.content.ownerDocument.createDocumentFragment()).appendChild(i.content),n.templateInfo=r,!0}static _parseTemplateNodeAttributes(e,t,n){let i=!1,r=Array.from(e.attributes);for(let s,o=r.length-1;s=r[o];o--)i=this._parseTemplateNodeAttribute(e,t,n,s.name,s.value)||i;return i}static _parseTemplateNodeAttribute(e,t,n,i,r){return"on-"===i.slice(0,3)?(e.removeAttribute(i),n.events=n.events||[],n.events.push({name:i.slice(3),value:r}),!0):"id"===i&&(n.id=r,!0)}static _contentForTemplate(e){let t=e._templateInfo;return t&&t.content||e.content}_stampTemplate(e,t){e&&!e.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e);let n=(t=t||this.constructor._parseTemplate(e)).nodeInfoList,i=t.content||e.content,r=document.importNode(i,!0);r.__noInsertionPoint=!t.hasInsertionPoint;let s=r.nodeList=new Array(n.length);r.$={};for(let e,i=0,o=n.length;i<o&&(e=n[i]);i++){let n=s[i]=Ot(r,e);yt(0,r.$,n,e),bt(0,n,e,t),vt(this,n,e)}return r}_addMethodEventListenerToNode(e,t,n,i){let r=function(e,t,n){return e=e._methodHost||e,function(t){e[n]&&e[n](t,t.detail)}}(i=i||e,0,n);return this._addEventListenerToNode(e,t,r),r}_addEventListenerToNode(e,t,n){e.addEventListener(t,n)}_removeEventListenerFromNode(e,t,n){e.removeEventListener(t,n)}}));
/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */let xt=0;const St=[],kt={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"},At=/[A-Z]/;function Ct(e,t,n){let i=e[t];if(i){if(!e.hasOwnProperty(t)&&(i=e[t]=Object.create(e[t]),n))for(let e in i){let t=i[e],n=i[e]=Array(t.length);for(let e=0;e<t.length;e++)n[e]=t[e]}}else i=e[t]={};return i}function _t(e,t,n,i,r,s){if(t){let o=!1;const a=xt++;for(let l in n){let h=t[r?Fe(l):l];if(h)for(let t,c=0,u=h.length;c<u&&(t=h[c]);c++)t.info&&t.info.lastRun===a||r&&!Tt(l,t.trigger)||(t.info&&(t.info.lastRun=a),t.fn(e,l,n,i,t.info,r,s),o=!0)}return o}return!1}function Et(e,t,n,i,r,s,o,a){let l=!1,h=t[o?Fe(i):i];if(h)for(let t,c=0,u=h.length;c<u&&(t=h[c]);c++)t.info&&t.info.lastRun===n||o&&!Tt(i,t.trigger)||(t.info&&(t.info.lastRun=n),t.fn(e,i,r,s,t.info,o,a),l=!0);return l}function Tt(e,t){if(t){let n=t.name;return n==e||!(!t.structured||!Le(n,e))||!(!t.wildcard||!Ue(n,e))}return!0}function Pt(e,t,n,i,r){let s="string"==typeof r.method?e[r.method]:r.method,o=r.property;s?s.call(e,e.__data[o],i[o]):r.dynamicFn}function $t(e,t,n){let i=Fe(t);if(i!==t){return Nt(e,Je(i)+"-changed",n[t],t),!0}return!1}function Nt(e,t,n,i){let r={value:n,queueProperty:!0};i&&(r.path=i),De(e).dispatchEvent(new CustomEvent(t,{detail:r}))}function It(e,t,n,i,r,s){let o=(s?Fe(t):t)!=t?t:null,a=o?je(e,o):e.__data[t];o&&void 0===a&&(a=n[t]),Nt(e,r.eventName,a,o)}function Qt(e,t,n,i,r){let s=e.__data[t];ce&&(s=ce(s,r.attrName,"attribute",e)),e._propertyToAttribute(t,r.attrName,s)}function Rt(e,t,n,i){let r=e[kt.COMPUTE];if(r)if(ye){xt++;const s=function(e){let t=e.constructor.__orderedComputedDeps;if(!t){t=new Map;const n=e[kt.COMPUTE];let i,{counts:r,ready:s,total:o}=function(e){const t=e.__computeInfo,n={},i=e[kt.COMPUTE],r=[];let s=0;for(let e in t){const i=t[e];s+=n[e]=i.args.filter((e=>!e.literal)).length+(i.dynamicFn?1:0)}for(let e in i)t[e]||r.push(e);return{counts:n,ready:r,total:s}}(e);for(;i=s.shift();){t.set(i,t.size);const e=n[i];e&&e.forEach((e=>{const t=e.info.methodInfo;--o,0==--r[t]&&s.push(t)}))}e.constructor.__orderedComputedDeps=t}return t}(e),o=[];for(let e in t)Bt(e,r,o,s,i);let a;for(;a=o.shift();)Dt(e,"",t,n,a)&&Bt(a.methodInfo,r,o,s,i);Object.assign(n,e.__dataOld),Object.assign(t,e.__dataPending),e.__dataPending=null}else{let s=t;for(;_t(e,r,s,n,i);)Object.assign(n,e.__dataOld),Object.assign(t,e.__dataPending),s=e.__dataPending,e.__dataPending=null}}const Mt=(e,t,n)=>{let i=0,r=t.length-1,s=-1;for(;i<=r;){const o=i+r>>1,a=n.get(t[o].methodInfo)-n.get(e.methodInfo);if(a<0)i=o+1;else{if(!(a>0)){s=o;break}r=o-1}}s<0&&(s=r+1),t.splice(s,0,e)},Bt=(e,t,n,i,r)=>{const s=t[r?Fe(e):e];if(s)for(let t=0;t<s.length;t++){const o=s[t];o.info.lastRun===xt||r&&!Tt(e,o.trigger)||(o.info.lastRun=xt,Mt(o.info,n,i))}};function Dt(e,t,n,i,r){let s=Zt(e,t,n,i,r);if(s===St)return!1;let o=r.methodInfo;return e.__dataHasAccessor&&e.__dataHasAccessor[o]?e._setPendingProperty(o,s,!0):(e[o]=s,!1)}function Xt(e,t,n,i,r,s,o){n.bindings=n.bindings||[];let a={kind:i,target:r,parts:s,literal:o,isCompound:1!==s.length};if(n.bindings.push(a),function(e){return Boolean(e.target)&&"attribute"!=e.kind&&"text"!=e.kind&&!e.isCompound&&"{"===e.parts[0].mode}(a)){let{event:e,negate:t}=a.parts[0];a.listenerEvent=e||Je(r)+"-changed",a.listenerNegate=t}let l=t.nodeInfoList.length;for(let n=0;n<a.parts.length;n++){let i=a.parts[n];i.compoundIndex=n,Ft(e,t,a,i,l)}}function Ft(e,t,n,i,r){if(!i.literal)if("attribute"===n.kind&&"-"===n.target[0]);else{let s=i.dependencies,o={index:r,binding:n,part:i,evaluator:e};for(let n=0;n<s.length;n++){let i=s[n];"string"==typeof i&&(i=Ht(i),i.wildcard=!0),e._addTemplatePropertyEffect(t,i.rootProperty,{fn:Lt,info:o,trigger:i})}}}function Lt(e,t,n,i,r,s,o){let a=o[r.index],l=r.binding,h=r.part;if(s&&h.source&&t.length>h.source.length&&"property"==l.kind&&!l.isCompound&&a.__isPropertyEffectsClient&&a.__dataHasAccessor&&a.__dataHasAccessor[l.target]){let i=n[t];t=Ve(h.source,l.target,t),a._setPendingPropertyOrPath(t,i,!1,!0)&&e._enqueueClient(a)}else{let o=r.evaluator._evaluateBinding(e,h,t,n,i,s);o!==St&&function(e,t,n,i,r){r=function(e,t,n,i){if(n.isCompound){let r=e.__dataCompoundStorage[n.target];r[i.compoundIndex]=t,t=r.join("")}"attribute"!==n.kind&&("textContent"!==n.target&&("value"!==n.target||"input"!==e.localName&&"textarea"!==e.localName)||(t=null==t?"":t));return t}(t,r,n,i),ce&&(r=ce(r,n.target,n.kind,t));if("attribute"==n.kind)e._valueToNodeAttribute(t,r,n.target);else{let i=n.target;t.__isPropertyEffectsClient&&t.__dataHasAccessor&&t.__dataHasAccessor[i]?t[kt.READ_ONLY]&&t[kt.READ_ONLY][i]||t._setPendingProperty(i,r)&&e._enqueueClient(t):e._setUnmanagedPropertyToNode(t,i,r)}}(e,a,l,h,o)}}function Ut(e,t){if(t.isCompound){let n=e.__dataCompoundStorage||(e.__dataCompoundStorage={}),i=t.parts,r=new Array(i.length);for(let e=0;e<i.length;e++)r[e]=i[e].literal;let s=t.target;n[s]=r,t.literal&&"property"==t.kind&&("className"===s&&(e=De(e)),e[s]=t.literal)}}function Vt(e,t,n){if(n.listenerEvent){let i=n.parts[0];e.addEventListener(n.listenerEvent,(function(e){!function(e,t,n,i,r){let s,o=e.detail,a=o&&o.path;a?(i=Ve(n,i,a),s=o&&o.value):s=e.currentTarget[n],s=r?!s:s,t[kt.READ_ONLY]&&t[kt.READ_ONLY][i]||!t._setPendingPropertyOrPath(i,s,!0,Boolean(a))||o&&o.queueProperty||t._invalidateProperties()}(e,t,n.target,i.source,i.negate)}))}}function zt(e,t,n,i,r,s){s=t.static||s&&("object"!=typeof s||s[t.methodName]);let o={methodName:t.methodName,args:t.args,methodInfo:r,dynamicFn:s};for(let r,s=0;s<t.args.length&&(r=t.args[s]);s++)r.literal||e._addPropertyEffect(r.rootProperty,n,{fn:i,info:o,trigger:r});return s&&e._addPropertyEffect(t.methodName,n,{fn:i,info:o}),o}function Zt(e,t,n,i,r){let s=e._methodHost||e,o=s[r.methodName];if(o){let i=e._marshalArgs(r.args,t,n);return i===St?St:o.apply(s,i)}r.dynamicFn}const jt=[],qt=new RegExp("(\\[\\[|{{)\\s*(?:(!)\\s*)?((?:[a-zA-Z_$][\\w.:$\\-*]*)\\s*(?:\\(\\s*(?:(?:(?:((?:[a-zA-Z_$][\\w.:$\\-*]*)|(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|(?:(?:'(?:[^'\\\\]|\\\\.)*')|(?:\"(?:[^\"\\\\]|\\\\.)*\")))\\s*)(?:,\\s*(?:((?:[a-zA-Z_$][\\w.:$\\-*]*)|(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|(?:(?:'(?:[^'\\\\]|\\\\.)*')|(?:\"(?:[^\"\\\\]|\\\\.)*\")))\\s*))*)?)\\)\\s*)?)(?:]]|}})","g");function Gt(e){let t="";for(let n=0;n<e.length;n++){t+=e[n].literal||""}return t}function Wt(e){let t=e.match(/([^\s]+?)\(([\s\S]*)\)/);if(t){let e={methodName:t[1],static:!0,args:jt};if(t[2].trim()){return function(e,t){return t.args=e.map((function(e){let n=Ht(e);return n.literal||(t.static=!1),n}),this),t}(t[2].replace(/\\,/g,"&comma;").split(","),e)}return e}return null}function Ht(e){let t=e.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),n={name:t,value:"",literal:!1},i=t[0];switch("-"===i&&(i=t[1]),i>="0"&&i<="9"&&(i="#"),i){case"'":case'"':n.value=t.slice(1,-1),n.literal=!0;break;case"#":n.value=Number(t),n.literal=!0}return n.literal||(n.rootProperty=Fe(t),n.structured=Xe(t),n.structured&&(n.wildcard=".*"==t.slice(-2),n.wildcard&&(n.name=t.slice(0,-2)))),n}function Yt(e,t,n){let i=je(e,n);return void 0===i&&(i=t[n]),i}function Jt(e,t,n,i){const r={indexSplices:i};Oe&&!e._overrideLegacyUndefined&&(t.splices=r),e.notifyPath(n+".splices",r),e.notifyPath(n+".length",t.length),Oe&&!e._overrideLegacyUndefined&&(r.indexSplices=[])}function Kt(e,t,n,i,r,s){Jt(e,t,n,[{index:i,addedCount:r,removed:s,object:t,type:"splice"}])}const en=Ae((e=>{const t=wt(ut(e));return class extends t{constructor(){super(),this.__isPropertyEffectsClient=!0,this.__dataClientsReady,this.__dataPendingClients,this.__dataToNotify,this.__dataLinkedPaths,this.__dataHasPaths,this.__dataCompoundStorage,this.__dataHost,this.__dataTemp,this.__dataClientsInitialized,this.__data,this.__dataPending,this.__dataOld,this.__computeEffects,this.__computeInfo,this.__reflectEffects,this.__notifyEffects,this.__propagateEffects,this.__observeEffects,this.__readOnly,this.__templateInfo,this._overrideLegacyUndefined}get PROPERTY_EFFECT_TYPES(){return kt}_initializeProperties(){super._initializeProperties(),this._registerHost(),this.__dataClientsReady=!1,this.__dataPendingClients=null,this.__dataToNotify=null,this.__dataLinkedPaths=null,this.__dataHasPaths=!1,this.__dataCompoundStorage=this.__dataCompoundStorage||null,this.__dataHost=this.__dataHost||null,this.__dataTemp={},this.__dataClientsInitialized=!1}_registerHost(){if(tn.length){let e=tn[tn.length-1];e._enqueueClient(this),this.__dataHost=e}}_initializeProtoProperties(e){this.__data=Object.create(e),this.__dataPending=Object.create(e),this.__dataOld={}}_initializeInstanceProperties(e){let t=this[kt.READ_ONLY];for(let n in e)t&&t[n]||(this.__dataPending=this.__dataPending||{},this.__dataOld=this.__dataOld||{},this.__data[n]=this.__dataPending[n]=e[n])}_addPropertyEffect(e,t,n){this._createPropertyAccessor(e,t==kt.READ_ONLY);let i=Ct(this,t,!0)[e];i||(i=this[t][e]=[]),i.push(n)}_removePropertyEffect(e,t,n){let i=Ct(this,t,!0)[e],r=i.indexOf(n);r>=0&&i.splice(r,1)}_hasPropertyEffect(e,t){let n=this[t];return Boolean(n&&n[e])}_hasReadOnlyEffect(e){return this._hasPropertyEffect(e,kt.READ_ONLY)}_hasNotifyEffect(e){return this._hasPropertyEffect(e,kt.NOTIFY)}_hasReflectEffect(e){return this._hasPropertyEffect(e,kt.REFLECT)}_hasComputedEffect(e){return this._hasPropertyEffect(e,kt.COMPUTE)}_setPendingPropertyOrPath(e,t,n,i){if(i||Fe(Array.isArray(e)?e[0]:e)!==e){if(!i){let n=je(this,e);if(!(e=qe(this,e,t))||!super._shouldPropertyChange(e,t,n))return!1}if(this.__dataHasPaths=!0,this._setPendingProperty(e,t,n))return function(e,t,n){let i=e.__dataLinkedPaths;if(i){let r;for(let s in i){let o=i[s];Ue(s,t)?(r=Ve(s,o,t),e._setPendingPropertyOrPath(r,n,!0,!0)):Ue(o,t)&&(r=Ve(o,s,t),e._setPendingPropertyOrPath(r,n,!0,!0))}}}(this,e,t),!0}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[e])return this._setPendingProperty(e,t,n);this[e]=t}return!1}_setUnmanagedPropertyToNode(e,t,n){n===e[t]&&"object"!=typeof n||("className"===t&&(e=De(e)),e[t]=n)}_setPendingProperty(e,t,n){let i=this.__dataHasPaths&&Xe(e),r=i?this.__dataTemp:this.__data;return!!this._shouldPropertyChange(e,t,r[e])&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),e in this.__dataOld||(this.__dataOld[e]=this.__data[e]),i?this.__dataTemp[e]=t:this.__data[e]=t,this.__dataPending[e]=t,(i||this[kt.NOTIFY]&&this[kt.NOTIFY][e])&&(this.__dataToNotify=this.__dataToNotify||{},this.__dataToNotify[e]=n),!0)}_setProperty(e,t){this._setPendingProperty(e,t,!0)&&this._invalidateProperties()}_invalidateProperties(){this.__dataReady&&this._flushProperties()}_enqueueClient(e){this.__dataPendingClients=this.__dataPendingClients||[],e!==this&&this.__dataPendingClients.push(e)}_flushClients(){this.__dataClientsReady?this.__enableOrFlushClients():(this.__dataClientsReady=!0,this._readyClients(),this.__dataReady=!0)}__enableOrFlushClients(){let e=this.__dataPendingClients;if(e){this.__dataPendingClients=null;for(let t=0;t<e.length;t++){let n=e[t];n.__dataEnabled?n.__dataPending&&n._flushProperties():n._enableProperties()}}}_readyClients(){this.__enableOrFlushClients()}setProperties(e,t){for(let n in e)!t&&this[kt.READ_ONLY]&&this[kt.READ_ONLY][n]||this._setPendingPropertyOrPath(n,e[n],!0);this._invalidateProperties()}ready(){this._flushProperties(),this.__dataClientsReady||this._flushClients(),this.__dataPending&&this._flushProperties()}_propertiesChanged(e,t,n){let i,r=this.__dataHasPaths;this.__dataHasPaths=!1,Rt(this,t,n,r),i=this.__dataToNotify,this.__dataToNotify=null,this._propagatePropertyChanges(t,n,r),this._flushClients(),_t(this,this[kt.REFLECT],t,n,r),_t(this,this[kt.OBSERVE],t,n,r),i&&function(e,t,n,i,r){let s,o,a=e[kt.NOTIFY],l=xt++;for(let o in t)t[o]&&(a&&Et(e,a,l,o,n,i,r)||r&&$t(e,o,n))&&(s=!0);s&&(o=e.__dataHost)&&o._invalidateProperties&&o._invalidateProperties()}(this,i,t,n,r),1==this.__dataCounter&&(this.__dataTemp={})}_propagatePropertyChanges(e,t,n){this[kt.PROPAGATE]&&_t(this,this[kt.PROPAGATE],e,t,n),this.__templateInfo&&this._runEffectsForTemplate(this.__templateInfo,e,t,n)}_runEffectsForTemplate(e,t,n,i){const r=(t,i)=>{_t(this,e.propertyEffects,t,n,i,e.nodeList);for(let r=e.firstChild;r;r=r.nextSibling)this._runEffectsForTemplate(r,t,n,i)};e.runEffects?e.runEffects(r,t,i):r(t,i)}linkPaths(e,t){e=ze(e),t=ze(t),this.__dataLinkedPaths=this.__dataLinkedPaths||{},this.__dataLinkedPaths[e]=t}unlinkPaths(e){e=ze(e),this.__dataLinkedPaths&&delete this.__dataLinkedPaths[e]}notifySplices(e,t){let n={path:""};Jt(this,je(this,e,n),n.path,t)}get(e,t){return je(t||this,e)}set(e,t,n){n?qe(n,e,t):this[kt.READ_ONLY]&&this[kt.READ_ONLY][e]||this._setPendingPropertyOrPath(e,t,!0)&&this._invalidateProperties()}push(e,...t){let n={path:""},i=je(this,e,n),r=i.length,s=i.push(...t);return t.length&&Kt(this,i,n.path,r,t.length,[]),s}pop(e){let t={path:""},n=je(this,e,t),i=Boolean(n.length),r=n.pop();return i&&Kt(this,n,t.path,n.length,0,[r]),r}splice(e,t,n,...i){let r,s={path:""},o=je(this,e,s);return t<0?t=o.length-Math.floor(-t):t&&(t=Math.floor(t)),r=2===arguments.length?o.splice(t):o.splice(t,n,...i),(i.length||r.length)&&Kt(this,o,s.path,t,i.length,r),r}shift(e){let t={path:""},n=je(this,e,t),i=Boolean(n.length),r=n.shift();return i&&Kt(this,n,t.path,0,0,[r]),r}unshift(e,...t){let n={path:""},i=je(this,e,n),r=i.unshift(...t);return t.length&&Kt(this,i,n.path,0,t.length,[]),r}notifyPath(e,t){let n;if(1==arguments.length){let i={path:""};t=je(this,e,i),n=i.path}else n=Array.isArray(e)?ze(e):e;this._setPendingPropertyOrPath(n,t,!0,!0)&&this._invalidateProperties()}_createReadOnlyProperty(e,t){var n;this._addPropertyEffect(e,kt.READ_ONLY),t&&(this["_set"+(n=e,n[0].toUpperCase()+n.substring(1))]=function(t){this._setProperty(e,t)})}_createPropertyObserver(e,t,n){let i={property:e,method:t,dynamicFn:Boolean(n)};this._addPropertyEffect(e,kt.OBSERVE,{fn:Pt,info:i,trigger:{name:e}}),n&&this._addPropertyEffect(t,kt.OBSERVE,{fn:Pt,info:i,trigger:{name:t}})}_createMethodObserver(e,t){let n=Wt(e);if(!n)throw new Error("Malformed observer expression '"+e+"'");zt(this,n,kt.OBSERVE,Zt,null,t)}_createNotifyingProperty(e){this._addPropertyEffect(e,kt.NOTIFY,{fn:It,info:{eventName:Je(e)+"-changed",property:e}})}_createReflectedProperty(e){let t=this.constructor.attributeNameForProperty(e);"-"===t[0]||this._addPropertyEffect(e,kt.REFLECT,{fn:Qt,info:{attrName:t}})}_createComputedProperty(e,t,n){let i=Wt(t);if(!i)throw new Error("Malformed computed expression '"+t+"'");const r=zt(this,i,kt.COMPUTE,Dt,e,n);Ct(this,"__computeInfo")[e]=r}_marshalArgs(e,t,n){const i=this.__data,r=[];for(let s=0,o=e.length;s<o;s++){let{name:o,structured:a,wildcard:l,value:h,literal:c}=e[s];if(!c)if(l){const e=Ue(o,t),r=Yt(i,n,e?t:o);h={path:e?t:o,value:r,base:e?je(i,o):r}}else h=a?Yt(i,n,o):i[o];if(Oe&&!this._overrideLegacyUndefined&&void 0===h&&e.length>1)return St;r[s]=h}return r}static addPropertyEffect(e,t,n){this.prototype._addPropertyEffect(e,t,n)}static createPropertyObserver(e,t,n){this.prototype._createPropertyObserver(e,t,n)}static createMethodObserver(e,t){this.prototype._createMethodObserver(e,t)}static createNotifyingProperty(e){this.prototype._createNotifyingProperty(e)}static createReadOnlyProperty(e,t){this.prototype._createReadOnlyProperty(e,t)}static createReflectedProperty(e){this.prototype._createReflectedProperty(e)}static createComputedProperty(e,t,n){this.prototype._createComputedProperty(e,t,n)}static bindTemplate(e){return this.prototype._bindTemplate(e)}_bindTemplate(e,t){let n=this.constructor._parseTemplate(e),i=this.__preBoundTemplateInfo==n;if(!i)for(let e in n.propertyEffects)this._createPropertyAccessor(e);if(t)if(n=Object.create(n),n.wasPreBound=i,this.__templateInfo){const t=e._parentTemplateInfo||this.__templateInfo,i=t.lastChild;n.parent=t,t.lastChild=n,n.previousSibling=i,i?i.nextSibling=n:t.firstChild=n}else this.__templateInfo=n;else this.__preBoundTemplateInfo=n;return n}static _addTemplatePropertyEffect(e,t,n){(e.hostProps=e.hostProps||{})[t]=!0;let i=e.propertyEffects=e.propertyEffects||{};(i[t]=i[t]||[]).push(n)}_stampTemplate(e,t){t=t||this._bindTemplate(e,!0),tn.push(this);let n=super._stampTemplate(e,t);if(tn.pop(),t.nodeList=n.nodeList,!t.wasPreBound){let e=t.childNodes=[];for(let t=n.firstChild;t;t=t.nextSibling)e.push(t)}return n.templateInfo=t,function(e,t){let{nodeList:n,nodeInfoList:i}=t;if(i.length)for(let t=0;t<i.length;t++){let r=i[t],s=n[t],o=r.bindings;if(o)for(let t=0;t<o.length;t++){let n=o[t];Ut(s,n),Vt(s,e,n)}s.__dataHost=e}}(this,t),this.__dataClientsReady&&(this._runEffectsForTemplate(t,this.__data,null,!1),this._flushClients()),n}_removeBoundDom(e){const t=e.templateInfo,{previousSibling:n,nextSibling:i,parent:r}=t;n?n.nextSibling=i:r&&(r.firstChild=i),i?i.previousSibling=n:r&&(r.lastChild=n),t.nextSibling=t.previousSibling=null;let s=t.childNodes;for(let e=0;e<s.length;e++){let t=s[e];De(De(t).parentNode).removeChild(t)}}static _parseTemplateNode(e,n,i){let r=t._parseTemplateNode.call(this,e,n,i);if(e.nodeType===Node.TEXT_NODE){let t=this._parseBindings(e.textContent,n);t&&(e.textContent=Gt(t)||" ",Xt(this,n,i,"text","textContent",t),r=!0)}return r}static _parseTemplateNodeAttribute(e,n,i,r,s){let o=this._parseBindings(s,n);if(o){let t=r,s="property";At.test(r)?s="attribute":"$"==r[r.length-1]&&(r=r.slice(0,-1),s="attribute");let a=Gt(o);return a&&"attribute"==s&&("class"==r&&e.hasAttribute("class")&&(a+=" "+e.getAttribute(r)),e.setAttribute(r,a)),"attribute"==s&&"disable-upgrade$"==t&&e.setAttribute(r,""),"input"===e.localName&&"value"===t&&e.setAttribute(t,""),e.removeAttribute(t),"property"===s&&(r=Ye(r)),Xt(this,n,i,s,r,o,a),!0}return t._parseTemplateNodeAttribute.call(this,e,n,i,r,s)}static _parseTemplateNestedTemplate(e,n,i){let r=t._parseTemplateNestedTemplate.call(this,e,n,i);const s=e.parentNode,o=i.templateInfo,a="dom-if"===s.localName,l="dom-repeat"===s.localName;ve&&(a||l)&&(s.removeChild(e),(i=i.parentInfo).templateInfo=o,i.noted=!0,r=!1);let h=o.hostProps;if(be&&a)h&&(n.hostProps=Object.assign(n.hostProps||{},h),ve||(i.parentInfo.noted=!0));else{let e="{";for(let t in h){Xt(this,n,i,"property","_host_"+t,[{mode:e,source:t,dependencies:[t],hostProp:!0}])}}return r}static _parseBindings(e,t){let n,i=[],r=0;for(;null!==(n=qt.exec(e));){n.index>r&&i.push({literal:e.slice(r,n.index)});let s=n[1][0],o=Boolean(n[2]),a=n[3].trim(),l=!1,h="",c=-1;"{"==s&&(c=a.indexOf("::"))>0&&(h=a.substring(c+2),a=a.substring(0,c),l=!0);let u=Wt(a),d=[];if(u){let{args:e,methodName:n}=u;for(let t=0;t<e.length;t++){let n=e[t];n.literal||d.push(n)}let i=t.dynamicFns;(i&&i[n]||u.static)&&(d.push(n),u.dynamicFn=!0)}else d.push(a);i.push({source:a,mode:s,negate:o,customEvent:l,signature:u,dependencies:d,event:h}),r=qt.lastIndex}if(r&&r<e.length){let t=e.substring(r);t&&i.push({literal:t})}return i.length?i:null}static _evaluateBinding(e,t,n,i,r,s){let o;return o=t.signature?Zt(e,n,i,0,t.signature):n!=t.source?je(e,t.source):s&&Xe(n)?je(e,n):e.__data[n],t.negate&&(o=!o),o}}})),tn=[];const nn=Ae((e=>{const t=lt(e);function n(e){const t=Object.getPrototypeOf(e);return t.prototype instanceof r?t:null}function i(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",e))){let t=null;if(e.hasOwnProperty(JSCompiler_renameProperty("properties",e))){const n=e.properties;n&&(t=
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
function(e){const t={};for(let n in e){const i=e[n];t[n]="function"==typeof i?{type:i}:i}return t}(n))}e.__ownProperties=t}return e.__ownProperties}class r extends t{static get observedAttributes(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))){this.prototype;const e=this._properties;this.__observedAttributes=e?Object.keys(e).map((e=>this.prototype._addPropertyToAttributeMap(e))):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const e=n(this);e&&e.finalize(),this.__finalized=!0,this._finalizeClass()}}static _finalizeClass(){const e=i(this);e&&this.createProperties(e)}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const e=n(this);this.__properties=Object.assign({},e&&e._properties,i(this))}return this.__properties}static typeForProperty(e){const t=this._properties[e];return t&&t.type}_initializeProperties(){this.constructor.finalize(),super._initializeProperties()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._enableProperties()}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback()}}return r})),rn=window.ShadyCSS&&window.ShadyCSS.cssBuild,sn=Ae((e=>{const t=nn(en(e));function n(e,t,n,i){n.computed&&(n.readOnly=!0),n.computed&&(e._hasReadOnlyEffect(t)||e._createComputedProperty(t,n.computed,i)),n.readOnly&&!e._hasReadOnlyEffect(t)?e._createReadOnlyProperty(t,!n.computed):!1===n.readOnly&&e._hasReadOnlyEffect(t),n.reflectToAttribute&&!e._hasReflectEffect(t)?e._createReflectedProperty(t):!1===n.reflectToAttribute&&e._hasReflectEffect(t),n.notify&&!e._hasNotifyEffect(t)?e._createNotifyingProperty(t):!1===n.notify&&e._hasNotifyEffect(t),n.observer&&e._createPropertyObserver(t,n.observer,i[n.observer]),e._addPropertyToAttributeMap(t)}function i(e,t,n,i){if(!rn){const r=t.content.querySelectorAll("style"),s=Re(t),o=function(e){let t=$e(e);return t?Me(t):[]}(n),a=t.content.firstElementChild;for(let n=0;n<o.length;n++){let r=o[n];r.textContent=e._processStyleText(r.textContent,i),t.content.insertBefore(r,a)}let l=0;for(let t=0;t<s.length;t++){let n=s[t],o=r[l];o!==n?(n=n.cloneNode(!0),o.parentNode.insertBefore(n,o)):l++,n.textContent=e._processStyleText(n.textContent,i)}}if(window.ShadyCSS&&window.ShadyCSS.prepareTemplate(t,n),Se&&rn&&le){const n=t.content.querySelectorAll("style");if(n){let t="";Array.from(n).forEach((e=>{t+=e.textContent,e.parentNode.removeChild(e)})),e._styleSheet=new CSSStyleSheet,e._styleSheet.replaceSync(t)}}}return class extends t{static get polymerElementVersion(){return"3.4.1"}static _finalizeClass(){t._finalizeClass.call(this);const e=((n=this).hasOwnProperty(JSCompiler_renameProperty("__ownObservers",n))||(n.__ownObservers=n.hasOwnProperty(JSCompiler_renameProperty("observers",n))?n.observers:null),n.__ownObservers);var n;e&&this.createObservers(e,this._properties),this._prepareTemplate()}static _prepareTemplate(){let e=this.template;e&&("string"==typeof e?e=null:fe||(e=e.cloneNode(!0))),this.prototype._template=e}static createProperties(e){for(let t in e)n(this.prototype,t,e[t],e)}static createObservers(e,t){const n=this.prototype;for(let i=0;i<e.length;i++)n._createMethodObserver(e[i],t)}static get template(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_template",this))){const e=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:void 0;this._template=void 0!==e?e:this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&function(e){let t=null;if(e&&(!de||pe)&&(t=Pe.import(e,"template"),de&&!t))throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${e}`);return t}(this.is)||Object.getPrototypeOf(this.prototype).constructor.template}return this._template}static set template(e){this._template=e}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const e=this.importMeta;if(e)this._importPath=oe(e.url);else{const e=Pe.import(this.is);this._importPath=e&&e.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super(),this._template,this._importPath,this.rootPath,this.importPath,this.root,this.$}_initializeProperties(){this.constructor.finalize(),this.constructor._finalizeTemplate(this.localName),super._initializeProperties(),this.rootPath=he,this.importPath=this.constructor.importPath;let e=function(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",e))){e.__propertyDefaults=null;let t=e._properties;for(let n in t){let i=t[n];"value"in i&&(e.__propertyDefaults=e.__propertyDefaults||{},e.__propertyDefaults[n]=i)}}return e.__propertyDefaults}(this.constructor);if(e)for(let t in e){let n=e[t];if(this._canApplyPropertyDefault(t)){let e="function"==typeof n.value?n.value.call(this):n.value;this._hasAccessor(t)?this._setPendingProperty(t,e,!0):this[t]=e}}}_canApplyPropertyDefault(e){return!this.hasOwnProperty(e)}static _processStyleText(e,t){return se(e,t)}static _finalizeTemplate(e){const t=this.prototype._template;if(t&&!t.__polymerFinalized){t.__polymerFinalized=!0;const n=this.importPath;i(this,t,e,n?re(n):""),this.prototype._bindTemplate(t)}}connectedCallback(){window.ShadyCSS&&this._template&&window.ShadyCSS.styleElement(this),super.connectedCallback()}ready(){this._template&&(this.root=this._stampTemplate(this._template),this.$=this.root.$),super.ready()}_readyClients(){this._template&&(this.root=this._attachDom(this.root)),super._readyClients()}_attachDom(e){const t=De(this);if(t.attachShadow)return e?(t.shadowRoot||(t.attachShadow({mode:"open",shadyUpgradeFragment:e}),t.shadowRoot.appendChild(e),this.constructor._styleSheet&&(t.shadowRoot.adoptedStyleSheets=[this.constructor._styleSheet])),ge&&window.ShadyDOM&&window.ShadyDOM.flushInitial(t.shadowRoot),t.shadowRoot):null;throw new Error("ShadowDOM not available. PolymerElement can create dom as children instead of in ShadowDOM by setting `this.root = this;` before `ready`.")}updateStyles(e){window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,e)}resolveUrl(e,t){return!t&&this.importPath&&(t=re(this.importPath)),re(e,t)}static _parseTemplateContent(e,n,i){return n.dynamicFns=n.dynamicFns||this._properties,t._parseTemplateContent.call(this,e,n,i)}static _addTemplatePropertyEffect(e,n,i){return me&&!(n in this._properties)&&(!i.info.part.signature||!i.info.part.signature.static)&&!i.info.part.hostProp&&e.nestedTemplate,t._addTemplatePropertyEffect.call(this,e,n,i)}}}));
/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
class on{constructor(){this._asyncModule=null,this._callback=null,this._timer=null}setConfig(e,t){this._asyncModule=e,this._callback=t,this._timer=this._asyncModule.run((()=>{this._timer=null,an.delete(this),this._callback()}))}cancel(){this.isActive()&&(this._cancelAsync(),an.delete(this))}_cancelAsync(){this.isActive()&&(this._asyncModule.cancel(this._timer),this._timer=null)}flush(){this.isActive()&&(this.cancel(),this._callback())}isActive(){return null!=this._timer}static debounce(e,t,n){return e instanceof on?e._cancelAsync():e=new on,e.setConfig(t,n),e}}let an=new Set;const ln=function(e){an.add(e)},hn=function(){const e=Boolean(an.size);return an.forEach((e=>{try{e.flush()}catch(e){setTimeout((()=>{throw e}))}})),e};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
let cn="string"==typeof document.head.style.touchAction,un="__polymerGestures",dn="__polymerGesturesHandled",pn="__polymerGesturesTouchAction",fn=["mousedown","mousemove","mouseup","click"],mn=[0,1,4,2],gn=function(){try{return 1===new MouseEvent("test",{buttons:1}).buttons}catch(e){return!1}}();function On(e){return fn.indexOf(e)>-1}let yn=!1;function vn(e){if(!On(e)&&"touchend"!==e)return cn&&yn&&ue?{passive:!0}:void 0}!function(){try{let e=Object.defineProperty({},"passive",{get(){yn=!0}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}}();let bn=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/);const wn=[],xn={button:!0,input:!0,keygen:!0,meter:!0,output:!0,textarea:!0,progress:!0,select:!0},Sn={button:!0,command:!0,fieldset:!0,input:!0,keygen:!0,optgroup:!0,option:!0,select:!0,textarea:!0};function kn(e){let t=Array.prototype.slice.call(e.labels||[]);if(!t.length){t=[];let n=e.getRootNode();if(e.id){let i=n.querySelectorAll(`label[for = ${e.id}]`);for(let e=0;e<i.length;e++)t.push(i[e])}}return t}let An=function(e){let t=e.sourceCapabilities;var n;if((!t||t.firesTouchEvents)&&(e[dn]={skip:!0},"click"===e.type)){let t=!1,i=$n(e);for(let e=0;e<i.length;e++){if(i[e].nodeType===Node.ELEMENT_NODE)if("label"===i[e].localName)wn.push(i[e]);else if(n=i[e],xn[n.localName]){let n=kn(i[e]);for(let e=0;e<n.length;e++)t=t||wn.indexOf(n[e])>-1}if(i[e]===En.mouse.target)return}if(t)return;e.preventDefault(),e.stopPropagation()}};function Cn(e){let t=bn?["click"]:fn;for(let n,i=0;i<t.length;i++)n=t[i],e?(wn.length=0,document.addEventListener(n,An,!0)):document.removeEventListener(n,An,!0)}function _n(e){let t=e.type;if(!On(t))return!1;if("mousemove"===t){let t=void 0===e.buttons?1:e.buttons;return e instanceof window.MouseEvent&&!gn&&(t=mn[e.which]||0),Boolean(1&t)}return 0===(void 0===e.button?0:e.button)}let En={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};function Tn(e,t,n){e.movefn=t,e.upfn=n,document.addEventListener("mousemove",t),document.addEventListener("mouseup",n)}function Pn(e){document.removeEventListener("mousemove",e.movefn),document.removeEventListener("mouseup",e.upfn),e.movefn=null,e.upfn=null}document.addEventListener("touchend",(function(e){En.mouse.mouseIgnoreJob||Cn(!0),En.mouse.target=$n(e)[0],En.mouse.mouseIgnoreJob=on.debounce(En.mouse.mouseIgnoreJob,st.after(2500),(function(){Cn(),En.mouse.target=null,En.mouse.mouseIgnoreJob=null}))}),!!yn&&{passive:!0});const $n=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:e=>e.composedPath&&e.composedPath()||[],Nn={},In=[];function Qn(e){const t=$n(e);return t.length>0?t[0]:e.target}function Rn(e){let t,n=e.type,i=e.currentTarget.__polymerGestures;if(!i)return;let r=i[n];if(r){if(!e[dn]&&(e[dn]={},"touch"===n.slice(0,5))){let t=e.changedTouches[0];if("touchstart"===n&&1===e.touches.length&&(En.touch.id=t.identifier),En.touch.id!==t.identifier)return;cn||"touchstart"!==n&&"touchmove"!==n||function(e){let t=e.changedTouches[0],n=e.type;if("touchstart"===n)En.touch.x=t.clientX,En.touch.y=t.clientY,En.touch.scrollDecided=!1;else if("touchmove"===n){if(En.touch.scrollDecided)return;En.touch.scrollDecided=!0;let n=function(e){let t="auto",n=$n(e);for(let e,i=0;i<n.length;i++)if(e=n[i],e[pn]){t=e[pn];break}return t}(e),i=!1,r=Math.abs(En.touch.x-t.clientX),s=Math.abs(En.touch.y-t.clientY);e.cancelable&&("none"===n?i=!0:"pan-x"===n?i=s>r:"pan-y"===n&&(i=r>s)),i?e.preventDefault():Ln("track")}}(e)}if(t=e[dn],!t.skip){for(let n,i=0;i<In.length;i++)n=In[i],r[n.name]&&!t[n.name]&&n.flow&&n.flow.start.indexOf(e.type)>-1&&n.reset&&n.reset();for(let i,s=0;s<In.length;s++)i=In[s],r[i.name]&&!t[i.name]&&(t[i.name]=!0,i[n](e))}}}function Mn(e,t,n){return!!Nn[t]&&(function(e,t,n){let i=Nn[t],r=i.deps,s=i.name,o=e[un];o||(e[un]=o={});for(let t,n,i=0;i<r.length;i++)t=r[i],bn&&On(t)&&"click"!==t||(n=o[t],n||(o[t]=n={_count:0}),0===n._count&&e.addEventListener(t,Rn,vn(t)),n[s]=(n[s]||0)+1,n._count=(n._count||0)+1);e.addEventListener(t,n),i.touchAction&&Xn(e,i.touchAction)}(e,t,n),!0)}function Bn(e,t,n){return!!Nn[t]&&(function(e,t,n){let i=Nn[t],r=i.deps,s=i.name,o=e[un];if(o)for(let t,n,i=0;i<r.length;i++)t=r[i],n=o[t],n&&n[s]&&(n[s]=(n[s]||1)-1,n._count=(n._count||1)-1,0===n._count&&e.removeEventListener(t,Rn,vn(t)));e.removeEventListener(t,n)}(e,t,n),!0)}function Dn(e){In.push(e);for(let t=0;t<e.emits.length;t++)Nn[e.emits[t]]=e}function Xn(e,t){cn&&e instanceof HTMLElement&&ot.run((()=>{e.style.touchAction=t})),e[pn]=t}function Fn(e,t,n){let i=new Event(t,{bubbles:!0,cancelable:!0,composed:!0});if(i.detail=n,De(e).dispatchEvent(i),i.defaultPrevented){let e=n.preventer||n.sourceEvent;e&&e.preventDefault&&e.preventDefault()}}function Ln(e){let t=function(e){for(let t,n=0;n<In.length;n++){t=In[n];for(let n,i=0;i<t.emits.length;i++)if(n=t.emits[i],n===e)return t}return null}(e);t.info&&(t.info.prevent=!0)}function Un(e,t,n,i){t&&Fn(t,e,{x:n.clientX,y:n.clientY,sourceEvent:n,preventer:i,prevent:function(e){return Ln(e)}})}function Vn(e,t,n){if(e.prevent)return!1;if(e.started)return!0;let i=Math.abs(e.x-t),r=Math.abs(e.y-n);return i>=5||r>=5}function zn(e,t,n){if(!t)return;let i,r=e.moves[e.moves.length-2],s=e.moves[e.moves.length-1],o=s.x-e.x,a=s.y-e.y,l=0;r&&(i=s.x-r.x,l=s.y-r.y),Fn(t,"track",{state:e.state,x:n.clientX,y:n.clientY,dx:o,dy:a,ddx:i,ddy:l,sourceEvent:n,hover:function(){return function(e,t){let n=document.elementFromPoint(e,t),i=n;for(;i&&i.shadowRoot&&!window.ShadyDOM;){let r=i;if(i=i.shadowRoot.elementFromPoint(e,t),r===i)break;i&&(n=i)}return n}(n.clientX,n.clientY)}})}function Zn(e,t,n){let i=Math.abs(t.clientX-e.x),r=Math.abs(t.clientY-e.y),s=Qn(n||t);!s||Sn[s.localName]&&s.hasAttribute("disabled")||(isNaN(i)||isNaN(r)||i<=25&&r<=25||function(e){if("click"===e.type){if(0===e.detail)return!0;let t=Qn(e);if(!t.nodeType||t.nodeType!==Node.ELEMENT_NODE)return!0;let n=t.getBoundingClientRect(),i=e.pageX,r=e.pageY;return!(i>=n.left&&i<=n.right&&r>=n.top&&r<=n.bottom)}return!1}(t))&&(e.prevent||Fn(s,"tap",{x:t.clientX,y:t.clientY,sourceEvent:t,preventer:n}))}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/Dn({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){Pn(this.info)},mousedown:function(e){if(!_n(e))return;let t=Qn(e),n=this;Tn(this.info,(function(e){_n(e)||(Un("up",t,e),Pn(n.info))}),(function(e){_n(e)&&Un("up",t,e),Pn(n.info)})),Un("down",t,e)},touchstart:function(e){Un("down",Qn(e),e.changedTouches[0],e)},touchend:function(e){Un("up",Qn(e),e.changedTouches[0],e)}}),Dn({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(e){this.moves.length>2&&this.moves.shift(),this.moves.push(e)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,Pn(this.info)},mousedown:function(e){if(!_n(e))return;let t=Qn(e),n=this,i=function(e){let i=e.clientX,r=e.clientY;Vn(n.info,i,r)&&(n.info.state=n.info.started?"mouseup"===e.type?"end":"track":"start","start"===n.info.state&&Ln("tap"),n.info.addMove({x:i,y:r}),_n(e)||(n.info.state="end",Pn(n.info)),t&&zn(n.info,t,e),n.info.started=!0)};Tn(this.info,i,(function(e){n.info.started&&i(e),Pn(n.info)})),this.info.x=e.clientX,this.info.y=e.clientY},touchstart:function(e){let t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchmove:function(e){let t=Qn(e),n=e.changedTouches[0],i=n.clientX,r=n.clientY;Vn(this.info,i,r)&&("start"===this.info.state&&Ln("tap"),this.info.addMove({x:i,y:r}),zn(this.info,t,n),this.info.state="track",this.info.started=!0)},touchend:function(e){let t=Qn(e),n=e.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:n.clientX,y:n.clientY}),zn(this.info,t,n))}}),Dn({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},mousedown:function(e){_n(e)&&(this.info.x=e.clientX,this.info.y=e.clientY)},click:function(e){_n(e)&&Zn(this.info,e)},touchstart:function(e){const t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchend:function(e){Zn(this.info,e.changedTouches[0],e)}});const jn=Ae((e=>class extends e{_addEventListenerToNode(e,t,n){Mn(e,t,n)||super._addEventListenerToNode(e,t,n)}_removeEventListenerFromNode(e,t,n){Bn(e,t,n)||super._removeEventListenerFromNode(e,t,n)}})),qn=/:host\(:dir\((ltr|rtl)\)\)/g,Gn=/([\s\w-#\.\[\]\*]*):dir\((ltr|rtl)\)/g,Wn=/:dir\((?:ltr|rtl)\)/,Hn=Boolean(window.ShadyDOM&&window.ShadyDOM.inUse),Yn=[];
/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */let Jn=null,Kn="";function ei(){Kn=document.documentElement.getAttribute("dir")}function ti(e){if(!e.__autoDirOptOut){e.setAttribute("dir",Kn)}}function ni(){ei(),Kn=document.documentElement.getAttribute("dir");for(let e=0;e<Yn.length;e++)ti(Yn[e])}const ii=Ae((e=>{Hn||Jn||(ei(),Jn=new MutationObserver(ni),Jn.observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]}));const t=ut(e);class n extends t{static _processStyleText(e,n){return e=t._processStyleText.call(this,e,n),!Hn&&Wn.test(e)&&(e=this._replaceDirInCssText(e),this.__activateDir=!0),e}static _replaceDirInCssText(e){let t=e;return t=t.replace(qn,':host([dir="$1"])'),t=t.replace(Gn,':host([dir="$2"]) $1'),t}constructor(){super(),this.__autoDirOptOut=!1}ready(){super.ready(),this.__autoDirOptOut=this.hasAttribute("dir")}connectedCallback(){t.prototype.connectedCallback&&super.connectedCallback(),this.constructor.__activateDir&&(Jn&&Jn.takeRecords().length&&ni(),Yn.push(this),ti(this))}disconnectedCallback(){if(t.prototype.disconnectedCallback&&super.disconnectedCallback(),this.constructor.__activateDir){const e=Yn.indexOf(this);e>-1&&Yn.splice(e,1)}}}return n.__activateDir=!1,n}));
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let ri=!1,si=[],oi=[];function ai(){ri=!0,requestAnimationFrame((function(){ri=!1,function(e){for(;e.length;)li(e.shift())}(si),setTimeout((function(){!function(e){for(let t=0,n=e.length;t<n;t++)li(e.shift())}(oi)}))}))}function li(e){const t=e[0],n=e[1],i=e[2];try{n.apply(t,i)}catch(e){setTimeout((()=>{throw e}))}}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
function hi(){document.body.removeAttribute("unresolved")}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
function ci(e,t,n){return{index:e,removed:t,addedCount:n}}"interactive"===document.readyState||"complete"===document.readyState?hi():window.addEventListener("DOMContentLoaded",hi);function ui(e,t,n,i,r,s){let o,a=0,l=0,h=Math.min(n-t,s-r);if(0==t&&0==r&&(a=function(e,t,n){for(let i=0;i<n;i++)if(!pi(e[i],t[i]))return i;return n}(e,i,h)),n==e.length&&s==i.length&&(l=function(e,t,n){let i=e.length,r=t.length,s=0;for(;s<n&&pi(e[--i],t[--r]);)s++;return s}(e,i,h-a)),r+=a,s-=l,(n-=l)-(t+=a)==0&&s-r==0)return[];if(t==n){for(o=ci(t,[],0);r<s;)o.removed.push(i[r++]);return[o]}if(r==s)return[ci(t,[],n-t)];let c=function(e){let t=e.length-1,n=e[0].length-1,i=e[t][n],r=[];for(;t>0||n>0;){if(0==t){r.push(2),n--;continue}if(0==n){r.push(3),t--;continue}let s,o=e[t-1][n-1],a=e[t-1][n],l=e[t][n-1];s=a<l?a<o?a:o:l<o?l:o,s==o?(o==i?r.push(0):(r.push(1),i=o),t--,n--):s==a?(r.push(3),t--,i=a):(r.push(2),n--,i=l)}return r.reverse(),r}(function(e,t,n,i,r,s){let o=s-r+1,a=n-t+1,l=new Array(o);for(let e=0;e<o;e++)l[e]=new Array(a),l[e][0]=e;for(let e=0;e<a;e++)l[0][e]=e;for(let n=1;n<o;n++)for(let s=1;s<a;s++)if(pi(e[t+s-1],i[r+n-1]))l[n][s]=l[n-1][s-1];else{let e=l[n-1][s]+1,t=l[n][s-1]+1;l[n][s]=e<t?e:t}return l}(e,t,n,i,r,s));o=void 0;let u=[],d=t,p=r;for(let e=0;e<c.length;e++)switch(c[e]){case 0:o&&(u.push(o),o=void 0),d++,p++;break;case 1:o||(o=ci(d,[],0)),o.addedCount++,d++,o.removed.push(i[p]),p++;break;case 2:o||(o=ci(d,[],0)),o.addedCount++,d++;break;case 3:o||(o=ci(d,[],0)),o.removed.push(i[p]),p++}return o&&u.push(o),u}function di(e,t){return ui(e,0,e.length,t,0,t.length)}function pi(e,t){return e===t}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function fi(e){return"slot"===e.localName}let mi=class{static getFlattenedNodes(e){const t=De(e);return fi(e)?t.assignedNodes({flatten:!0}):Array.from(t.childNodes).map((e=>fi(e)?De(e).assignedNodes({flatten:!0}):[e])).reduce(((e,t)=>e.concat(t)),[])}constructor(e,t){this._shadyChildrenObserver=null,this._nativeChildrenObserver=null,this._connected=!1,this._target=e,this.callback=t,this._effectiveNodes=[],this._observer=null,this._scheduled=!1,this._boundSchedule=()=>{this._schedule()},this.connect(),this._schedule()}connect(){fi(this._target)?this._listenSlots([this._target]):De(this._target).children&&(this._listenSlots(De(this._target).children),window.ShadyDOM?this._shadyChildrenObserver=window.ShadyDOM.observeChildren(this._target,(e=>{this._processMutations(e)})):(this._nativeChildrenObserver=new MutationObserver((e=>{this._processMutations(e)})),this._nativeChildrenObserver.observe(this._target,{childList:!0}))),this._connected=!0}disconnect(){fi(this._target)?this._unlistenSlots([this._target]):De(this._target).children&&(this._unlistenSlots(De(this._target).children),window.ShadyDOM&&this._shadyChildrenObserver?(window.ShadyDOM.unobserveChildren(this._shadyChildrenObserver),this._shadyChildrenObserver=null):this._nativeChildrenObserver&&(this._nativeChildrenObserver.disconnect(),this._nativeChildrenObserver=null)),this._connected=!1}_schedule(){this._scheduled||(this._scheduled=!0,ot.run((()=>this.flush())))}_processMutations(e){this._processSlotMutations(e),this.flush()}_processSlotMutations(e){if(e)for(let t=0;t<e.length;t++){let n=e[t];n.addedNodes&&this._listenSlots(n.addedNodes),n.removedNodes&&this._unlistenSlots(n.removedNodes)}}flush(){if(!this._connected)return!1;window.ShadyDOM&&ShadyDOM.flush(),this._nativeChildrenObserver?this._processSlotMutations(this._nativeChildrenObserver.takeRecords()):this._shadyChildrenObserver&&this._processSlotMutations(this._shadyChildrenObserver.takeRecords()),this._scheduled=!1;let e={target:this._target,addedNodes:[],removedNodes:[]},t=this.constructor.getFlattenedNodes(this._target),n=di(t,this._effectiveNodes);for(let t,i=0;i<n.length&&(t=n[i]);i++)for(let n,i=0;i<t.removed.length&&(n=t.removed[i]);i++)e.removedNodes.push(n);for(let i,r=0;r<n.length&&(i=n[r]);r++)for(let n=i.index;n<i.index+i.addedCount;n++)e.addedNodes.push(t[n]);this._effectiveNodes=t;let i=!1;return(e.addedNodes.length||e.removedNodes.length)&&(i=!0,this.callback.call(this._target,e)),i}_listenSlots(e){for(let t=0;t<e.length;t++){let n=e[t];fi(n)&&n.addEventListener("slotchange",this._boundSchedule)}}_unlistenSlots(e){for(let t=0;t<e.length;t++){let n=e[t];fi(n)&&n.removeEventListener("slotchange",this._boundSchedule)}}};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const gi=function(){let e,t;do{e=window.ShadyDOM&&ShadyDOM.flush(),window.ShadyCSS&&window.ShadyCSS.ScopingShim&&window.ShadyCSS.ScopingShim.flush(),t=hn()}while(e||t)},Oi=Element.prototype,yi=Oi.matches||Oi.matchesSelector||Oi.mozMatchesSelector||Oi.msMatchesSelector||Oi.oMatchesSelector||Oi.webkitMatchesSelector,vi=function(e,t){return yi.call(e,t)};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/class bi{constructor(e){window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.patch(e),this.node=e}observeNodes(e){return new mi(this.node,e)}unobserveNodes(e){e.disconnect()}notifyObserver(){}deepContains(e){if(De(this.node).contains(e))return!0;let t=e,n=e.ownerDocument;for(;t&&t!==n&&t!==this.node;)t=De(t).parentNode||De(t).host;return t===this.node}getOwnerRoot(){return De(this.node).getRootNode()}getDistributedNodes(){return"slot"===this.node.localName?De(this.node).assignedNodes({flatten:!0}):[]}getDestinationInsertionPoints(){let e=[],t=De(this.node).assignedSlot;for(;t;)e.push(t),t=De(t).assignedSlot;return e}importNode(e,t){let n=this.node instanceof Document?this.node:this.node.ownerDocument;return De(n).importNode(e,t)}getEffectiveChildNodes(){return mi.getFlattenedNodes(this.node)}queryDistributedElements(e){let t=this.getEffectiveChildNodes(),n=[];for(let i,r=0,s=t.length;r<s&&(i=t[r]);r++)i.nodeType===Node.ELEMENT_NODE&&vi(i,e)&&n.push(i);return n}get activeElement(){let e=this.node;return void 0!==e._activeElement?e._activeElement:e.activeElement}}function wi(e,t){for(let n=0;n<t.length;n++){let i=t[n];Object.defineProperty(e,i,{get:function(){return this.node[i]},configurable:!0})}}class xi{constructor(e){this.event=e}get rootTarget(){return this.path[0]}get localTarget(){return this.event.target}get path(){return this.event.composedPath()}}bi.prototype.cloneNode,bi.prototype.appendChild,bi.prototype.insertBefore,bi.prototype.removeChild,bi.prototype.replaceChild,bi.prototype.setAttribute,bi.prototype.removeAttribute,bi.prototype.querySelector,bi.prototype.querySelectorAll,bi.prototype.parentNode,bi.prototype.firstChild,bi.prototype.lastChild,bi.prototype.nextSibling,bi.prototype.previousSibling,bi.prototype.firstElementChild,bi.prototype.lastElementChild,bi.prototype.nextElementSibling,bi.prototype.previousElementSibling,bi.prototype.childNodes,bi.prototype.children,bi.prototype.classList,bi.prototype.textContent,bi.prototype.innerHTML;let Si=bi;if(window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.noPatch&&window.ShadyDOM.Wrapper){class e extends window.ShadyDOM.Wrapper{}Object.getOwnPropertyNames(bi.prototype).forEach((t=>{"activeElement"!=t&&(e.prototype[t]=bi.prototype[t])})),wi(e.prototype,["classList"]),Si=e,Object.defineProperties(xi.prototype,{localTarget:{get(){const e=this.event.currentTarget,t=e&&ki(e).getOwnerRoot(),n=this.path;for(let e=0;e<n.length;e++){const i=n[e];if(ki(i).getOwnerRoot()===t)return i}},configurable:!0},path:{get(){return window.ShadyDOM.composedPath(this.event)},configurable:!0}})}else!function(e,t){for(let n=0;n<t.length;n++){let i=t[n];e[i]=function(){return this.node[i].apply(this.node,arguments)}}}(bi.prototype,["cloneNode","appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute","querySelector","querySelectorAll"]),wi(bi.prototype,["parentNode","firstChild","lastChild","nextSibling","previousSibling","firstElementChild","lastElementChild","nextElementSibling","previousElementSibling","childNodes","children","classList"]),function(e,t){for(let n=0;n<t.length;n++){let i=t[n];Object.defineProperty(e,i,{get:function(){return this.node[i]},set:function(e){this.node[i]=e},configurable:!0})}}(bi.prototype,["textContent","innerHTML","className"]);const ki=function(e){if((e=e||document)instanceof Si)return e;if(e instanceof xi)return e;let t=e.__domApi;return t||(t=e instanceof Event?new xi(e):new Si(e),e.__domApi=t),t},Ai=window.ShadyDOM,Ci=window.ShadyCSS;
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function _i(e,t){return De(e).getRootNode()===t}
/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */
const Ei=e=>{for(;e;){const t=Object.getOwnPropertyDescriptor(e,"observedAttributes");if(t)return t.get;e=Object.getPrototypeOf(e.prototype).constructor}return()=>[]};Ae((e=>{const t=sn(e);let n=Ei(t);return class extends t{constructor(){super(),this.__isUpgradeDisabled}static get observedAttributes(){return n.call(this).concat("disable-upgrade")}_initializeProperties(){this.hasAttribute("disable-upgrade")?this.__isUpgradeDisabled=!0:super._initializeProperties()}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(e){return super._canApplyPropertyDefault(e)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(e))}attributeChangedCallback(e,t,n,i){"disable-upgrade"==e?this.__isUpgradeDisabled&&null==n&&(super._initializeProperties(),this.__isUpgradeDisabled=!1,De(this).isConnected&&super.connectedCallback()):super.attributeChangedCallback(e,t,n,i)}connectedCallback(){this.__isUpgradeDisabled||super.connectedCallback()}disconnectedCallback(){this.__isUpgradeDisabled||super.disconnectedCallback()}}}));let Ti=window.ShadyCSS;const Pi=Ae((e=>{const t=jn(sn(e)),n=rn?t:ii(t),i=Ei(n),r={x:"pan-x",y:"pan-y",none:"none",all:"auto"};class s extends n{constructor(){super(),this.isAttached,this.__boundListeners,this._debouncers,this.__isUpgradeDisabled,this.__needsAttributesAtConnected,this._legacyForceObservedAttributes}static get importMeta(){return this.prototype.importMeta}created(){}__attributeReaction(e,t,n){(this.__dataAttributes&&this.__dataAttributes[e]||"disable-upgrade"===e)&&this.attributeChangedCallback(e,t,n,null)}setAttribute(e,t){if(xe&&!this._legacyForceObservedAttributes){const n=this.getAttribute(e);super.setAttribute(e,t),this.__attributeReaction(e,n,String(t))}else super.setAttribute(e,t)}removeAttribute(e){if(xe&&!this._legacyForceObservedAttributes){const t=this.getAttribute(e);super.removeAttribute(e),this.__attributeReaction(e,t,null)}else super.removeAttribute(e)}static get observedAttributes(){return xe&&!this.prototype._legacyForceObservedAttributes?(this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))||(this.__observedAttributes=[],this.prototype),this.__observedAttributes):i.call(this).concat("disable-upgrade")}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(e){return super._canApplyPropertyDefault(e)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(e))}connectedCallback(){this.__needsAttributesAtConnected&&this._takeAttributes(),this.__isUpgradeDisabled||(super.connectedCallback(),this.isAttached=!0,this.attached())}attached(){}disconnectedCallback(){this.__isUpgradeDisabled||(super.disconnectedCallback(),this.isAttached=!1,this.detached())}detached(){}attributeChangedCallback(e,t,n,i){t!==n&&("disable-upgrade"==e?this.__isUpgradeDisabled&&null==n&&(this._initializeProperties(),this.__isUpgradeDisabled=!1,De(this).isConnected&&this.connectedCallback()):(super.attributeChangedCallback(e,t,n,i),this.attributeChanged(e,t,n)))}attributeChanged(e,t,n){}_initializeProperties(){if(fe&&this.hasAttribute("disable-upgrade"))this.__isUpgradeDisabled=!0;else{let e=Object.getPrototypeOf(this);e.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",e))||(this._registered(),e.__hasRegisterFinished=!0),super._initializeProperties(),this.root=this,this.created(),xe&&!this._legacyForceObservedAttributes&&(this.hasAttributes()?this._takeAttributes():this.parentNode||(this.__needsAttributesAtConnected=!0)),this._applyListeners()}}_takeAttributes(){const e=this.attributes;for(let t=0,n=e.length;t<n;t++){const n=e[t];this.__attributeReaction(n.name,null,n.value)}}_registered(){}ready(){this._ensureAttributes(),super.ready()}_ensureAttributes(){}_applyListeners(){}serialize(e){return this._serializeValue(e)}deserialize(e,t){return this._deserializeValue(e,t)}reflectPropertyToAttribute(e,t,n){this._propertyToAttribute(e,t,n)}serializeValueToAttribute(e,t,n){this._valueToNodeAttribute(n||this,e,t)}extend(e,t){if(!e||!t)return e||t;let n=Object.getOwnPropertyNames(t);for(let i,r=0;r<n.length&&(i=n[r]);r++){let n=Object.getOwnPropertyDescriptor(t,i);n&&Object.defineProperty(e,i,n)}return e}mixin(e,t){for(let n in t)e[n]=t[n];return e}chainObject(e,t){return e&&t&&e!==t&&(e.__proto__=t),e}instanceTemplate(e){let t=this.constructor._contentForTemplate(e);return document.importNode(t,!0)}fire(e,t,n){n=n||{},t=null==t?{}:t;let i=new Event(e,{bubbles:void 0===n.bubbles||n.bubbles,cancelable:Boolean(n.cancelable),composed:void 0===n.composed||n.composed});i.detail=t;let r=n.node||this;return De(r).dispatchEvent(i),i}listen(e,t,n){e=e||this;let i=this.__boundListeners||(this.__boundListeners=new WeakMap),r=i.get(e);r||(r={},i.set(e,r));let s=t+n;r[s]||(r[s]=this._addMethodEventListenerToNode(e,t,n,this))}unlisten(e,t,n){e=e||this;let i=this.__boundListeners&&this.__boundListeners.get(e),r=t+n,s=i&&i[r];s&&(this._removeEventListenerFromNode(e,t,s),i[r]=null)}setScrollDirection(e,t){Xn(t||this,r[e]||"auto")}$$(e){return this.root.querySelector(e)}get domHost(){let e=De(this).getRootNode();return e instanceof DocumentFragment?e.host:e}distributeContent(){const e=ki(this);window.ShadyDOM&&e.shadowRoot&&ShadyDOM.flush()}getEffectiveChildNodes(){return ki(this).getEffectiveChildNodes()}queryDistributedElements(e){return ki(this).queryDistributedElements(e)}getEffectiveChildren(){return this.getEffectiveChildNodes().filter((function(e){return e.nodeType===Node.ELEMENT_NODE}))}getEffectiveTextContent(){let e=this.getEffectiveChildNodes(),t=[];for(let n,i=0;n=e[i];i++)n.nodeType!==Node.COMMENT_NODE&&t.push(n.textContent);return t.join("")}queryEffectiveChildren(e){let t=this.queryDistributedElements(e);return t&&t[0]}queryAllEffectiveChildren(e){return this.queryDistributedElements(e)}getContentChildNodes(e){let t=this.root.querySelector(e||"slot");return t?ki(t).getDistributedNodes():[]}getContentChildren(e){let t=this.getContentChildNodes(e).filter((function(e){return e.nodeType===Node.ELEMENT_NODE}));return t}isLightDescendant(e){const t=this;return t!==e&&De(t).contains(e)&&De(t).getRootNode()===De(e).getRootNode()}isLocalDescendant(e){return this.root===De(e).getRootNode()}scopeSubtree(e,t=!1){return function(e,t=!1){if(!Ai||!Ci)return null;if(!Ai.handlesDynamicScoping)return null;const n=Ci.ScopingShim;if(!n)return null;const i=n.scopeForNode(e),r=De(e).getRootNode(),s=e=>{if(!_i(e,r))return;const t=Array.from(Ai.nativeMethods.querySelectorAll.call(e,"*"));t.push(e);for(let e=0;e<t.length;e++){const s=t[e];if(!_i(s,r))continue;const o=n.currentScopeForNode(s);o!==i&&(""!==o&&n.unscopeNode(s,o),n.scopeNode(s,i))}};if(s(e),t){const t=new MutationObserver((e=>{for(let t=0;t<e.length;t++){const n=e[t];for(let e=0;e<n.addedNodes.length;e++){const t=n.addedNodes[e];t.nodeType===Node.ELEMENT_NODE&&s(t)}}}));return t.observe(e,{childList:!0,subtree:!0}),t}return null}(e,t)}getComputedStyleValue(e){return Ti.getComputedStyleValue(this,e)}debounce(e,t,n){return this._debouncers=this._debouncers||{},this._debouncers[e]=on.debounce(this._debouncers[e],n>0?st.after(n):ot,t.bind(this))}isDebouncerActive(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];return!(!t||!t.isActive())}flushDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.flush()}cancelDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.cancel()}async(e,t){return t>0?st.run(e.bind(this),t):~ot.run(e.bind(this))}cancelAsync(e){e<0?ot.cancel(~e):st.cancel(e)}create(e,t){let n=document.createElement(e);if(t)if(n.setProperties)n.setProperties(t);else for(let e in t)n[e]=t[e];return n}elementMatches(e,t){return vi(t||this,e)}toggleAttribute(e,t){let n=this;return 3===arguments.length&&(n=arguments[2]),1==arguments.length&&(t=!n.hasAttribute(e)),t?(De(n).setAttribute(e,""),!0):(De(n).removeAttribute(e),!1)}toggleClass(e,t,n){n=n||this,1==arguments.length&&(t=!n.classList.contains(e)),t?n.classList.add(e):n.classList.remove(e)}transform(e,t){(t=t||this).style.webkitTransform=e,t.style.transform=e}translate3d(e,t,n,i){i=i||this,this.transform("translate3d("+e+","+t+","+n+")",i)}arrayDelete(e,t){let n;if(Array.isArray(e)){if(n=e.indexOf(t),n>=0)return e.splice(n,1)}else{if(n=je(this,e).indexOf(t),n>=0)return this.splice(e,n,1)}return null}_logger(e,t){switch(Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),e){case"log":case"warn":case"error":console[e](...t)}}_log(...e){this._logger("log",e)}_warn(...e){this._logger("warn",e)}_error(...e){this._logger("error",e)}_logf(e,...t){return["[%s::%s]",this.is,e,...t]}}return s.prototype.is="",s})),$i={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,listeners:!0,hostAttributes:!0},Ni={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,behaviors:!0,_noAccessors:!0},Ii=Object.assign({listeners:!0,hostAttributes:!0,properties:!0,observers:!0},Ni);
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function Qi(e,t,n,i){!function(e,t,n){const i=e._noAccessors,r=Object.getOwnPropertyNames(e);for(let s=0;s<r.length;s++){let o=r[s];if(!(o in n))if(i)t[o]=e[o];else{let n=Object.getOwnPropertyDescriptor(e,o);n&&(n.configurable=!0,Object.defineProperty(t,o,n))}}}(t,e,i);for(let e in $i)t[e]&&(n[e]=n[e]||[],n[e].push(t[e]))}function Ri(e,t,n){t=t||[];for(let i=e.length-1;i>=0;i--){let r=e[i];r&&(Array.isArray(r)?Ri(r,t):t.indexOf(r)<0&&(!n||n.indexOf(r)<0)&&t.unshift(r))}return t}function Mi(e,t){for(const n in t){const i=e[n],r=t[n];e[n]=!("value"in r)&&i&&"value"in i?Object.assign({value:i.value},r):r}}const Bi=Pi(HTMLElement);function Di(e,t,n){let i;const r={};class s extends t{static _finalizeClass(){if(this.hasOwnProperty(JSCompiler_renameProperty("generatedFrom",this))){if(i)for(let e,t=0;t<i.length;t++)e=i[t],e.properties&&this.createProperties(e.properties),e.observers&&this.createObservers(e.observers,e.properties);e.properties&&this.createProperties(e.properties),e.observers&&this.createObservers(e.observers,e.properties),this._prepareTemplate()}else t._finalizeClass.call(this)}static get properties(){const t={};if(i)for(let e=0;e<i.length;e++)Mi(t,i[e].properties);return Mi(t,e.properties),t}static get observers(){let t=[];if(i)for(let e,n=0;n<i.length;n++)e=i[n],e.observers&&(t=t.concat(e.observers));return e.observers&&(t=t.concat(e.observers)),t}created(){super.created();const e=r.created;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}_registered(){const e=s.prototype;if(!e.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",e))){e.__hasRegisterFinished=!0,super._registered(),fe&&o(e);const t=Object.getPrototypeOf(this);let n=r.beforeRegister;if(n)for(let e=0;e<n.length;e++)n[e].call(t);if(n=r.registered,n)for(let e=0;e<n.length;e++)n[e].call(t)}}_applyListeners(){super._applyListeners();const e=r.listeners;if(e)for(let t=0;t<e.length;t++){const n=e[t];if(n)for(let e in n)this._addMethodEventListenerToNode(this,e,n[e])}}_ensureAttributes(){const e=r.hostAttributes;if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];for(let e in n)this._ensureAttribute(e,n[e])}super._ensureAttributes()}ready(){super.ready();let e=r.ready;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}attached(){super.attached();let e=r.attached;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}detached(){super.detached();let e=r.detached;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}attributeChanged(e,t,n){super.attributeChanged();let i=r.attributeChanged;if(i)for(let r=0;r<i.length;r++)i[r].call(this,e,t,n)}}if(n){Array.isArray(n)||(n=[n]);let e=t.prototype.behaviors;i=Ri(n,null,e),s.prototype.behaviors=e?e.concat(n):i}const o=t=>{i&&function(e,t,n){for(let i=0;i<t.length;i++)Qi(e,t[i],n,Ii)}(t,i,r),Qi(t,e,r,Ni)};return fe||o(s.prototype),s.generatedFrom=e,s}const Xi=function(e){let t;return t="function"==typeof e?e:Xi.Class(e),e._legacyForceObservedAttributes&&(t.prototype._legacyForceObservedAttributes=e._legacyForceObservedAttributes),customElements.define(t.is,t),t};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
function Fi(e,t,n,i,r){let s;r&&(s="object"==typeof n&&null!==n,s&&(i=e.__dataTemp[t]));let o=i!==n&&(i==i||n==n);return s&&o&&(e.__dataTemp[t]=n),o}Xi.Class=function(e,t){let n=t?t(Bi):Bi;return n=Di(e,n,e.behaviors),n.is=n.prototype.is=e.is,n};const Li=Ae((e=>class extends e{_shouldPropertyChange(e,t,n){return Fi(this,e,t,n,!0)}})),Ui=Ae((e=>class extends e{static get properties(){return{mutableData:Boolean}}_shouldPropertyChange(e,t,n){return Fi(this,e,t,n,this.mutableData)}}));Li._mutablePropertyChange=Fi;
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
let Vi=null;function zi(){return Vi}zi.prototype=Object.create(HTMLTemplateElement.prototype,{constructor:{value:zi,writable:!0}});const Zi=en(zi),ji=Li(Zi);const qi=en(class{});function Gi(e,t){for(let n=0;n<t.length;n++){let i=t[n];if(Boolean(e)!=Boolean(i.__hideTemplateChildren__))if(i.nodeType===Node.TEXT_NODE)e?(i.__polymerTextContent__=i.textContent,i.textContent=""):i.textContent=i.__polymerTextContent__;else if("slot"===i.localName)if(e)i.__polymerReplaced__=document.createComment("hidden-slot"),De(De(i).parentNode).replaceChild(i.__polymerReplaced__,i);else{const e=i.__polymerReplaced__;e&&De(De(e).parentNode).replaceChild(i,e)}else i.style&&(e?(i.__polymerDisplay__=i.style.display,i.style.display="none"):i.style.display=i.__polymerDisplay__);i.__hideTemplateChildren__=e,i._showHideChildren&&i._showHideChildren(e)}}class Wi extends qi{constructor(e){super(),this._configureProperties(e),this.root=this._stampTemplate(this.__dataHost);let t=[];this.children=t;for(let e=this.root.firstChild;e;e=e.nextSibling)t.push(e),e.__templatizeInstance=this;this.__templatizeOwner&&this.__templatizeOwner.__hideTemplateChildren__&&this._showHideChildren(!0);let n=this.__templatizeOptions;(e&&n.instanceProps||!n.instanceProps)&&this._enableProperties()}_configureProperties(e){if(this.__templatizeOptions.forwardHostProp)for(let e in this.__hostProps)this._setPendingProperty(e,this.__dataHost["_host_"+e]);for(let t in e)this._setPendingProperty(t,e[t])}forwardHostProp(e,t){this._setPendingPropertyOrPath(e,t,!1,!0)&&this.__dataHost._enqueueClient(this)}_addEventListenerToNode(e,t,n){if(this._methodHost&&this.__templatizeOptions.parentModel)this._methodHost._addEventListenerToNode(e,t,(e=>{e.model=this,n(e)}));else{let i=this.__dataHost.__dataHost;i&&i._addEventListenerToNode(e,t,n)}}_showHideChildren(e){Gi(e,this.children)}_setUnmanagedPropertyToNode(e,t,n){e.__hideTemplateChildren__&&e.nodeType==Node.TEXT_NODE&&"textContent"==t?e.__polymerTextContent__=n:super._setUnmanagedPropertyToNode(e,t,n)}get parentModel(){let e=this.__parentModel;if(!e){let t;e=this;do{e=e.__dataHost.__dataHost}while((t=e.__templatizeOptions)&&!t.parentModel);this.__parentModel=e}return e}dispatchEvent(e){return!0}}Wi.prototype.__dataHost,Wi.prototype.__templatizeOptions,Wi.prototype._methodHost,Wi.prototype.__templatizeOwner,Wi.prototype.__hostProps;const Hi=Li(Wi);function Yi(e){let t=e.__dataHost;return t&&t._methodHost||t}function Ji(e,t,n){let i=n.mutableData?Hi:Wi;nr.mixin&&(i=nr.mixin(i));let r=class extends i{};return r.prototype.__templatizeOptions=n,r.prototype._bindTemplate(e),function(e,t,n,i){let r=n.hostProps||{};for(let t in i.instanceProps){delete r[t];let n=i.notifyInstanceProp;n&&e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:tr(t,n)})}if(i.forwardHostProp&&t.__dataHost)for(let t in r)n.hasHostProps||(n.hasHostProps=!0),e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:function(e,t,n){e.__dataHost._setPendingPropertyOrPath("_host_"+t,n[t],!0,!0)}})}(r,e,t,n),r}function Ki(e,t,n,i){let r=n.forwardHostProp;if(r&&t.hasHostProps){const s="template"==e.localName;let o=t.templatizeTemplateClass;if(!o){if(s){let e=n.mutableData?ji:Zi;class i extends e{}o=t.templatizeTemplateClass=i}else{const n=e.constructor;class i extends n{}o=t.templatizeTemplateClass=i}let a=t.hostProps;for(let e in a)o.prototype._addPropertyEffect("_host_"+e,o.prototype.PROPERTY_EFFECT_TYPES.PROPAGATE,{fn:er(e,r)}),o.prototype._createNotifyingProperty("_host_"+e);me&&i&&function(e,t,n){const i=n.constructor._properties,{propertyEffects:r}=e,{instanceProps:s}=t;for(let e in r)if(!(i[e]||s&&s[e])){const t=r[e];for(let e=0;e<t.length;e++){const{part:n}=t[e].info;if(!n.signature||!n.signature.static)break}}}(t,n,i)}if(e.__dataProto&&Object.assign(e.__data,e.__dataProto),s)!function(e,t){Vi=e,Object.setPrototypeOf(e,t.prototype),new t,Vi=null}(e,o),e.__dataTemp={},e.__dataPending=null,e.__dataOld=null,e._enableProperties();else{Object.setPrototypeOf(e,o.prototype);const n=t.hostProps;for(let t in n)if(t="_host_"+t,t in e){const n=e[t];delete e[t],e.__data[t]=n}}}}function er(e,t){return function(e,n,i){t.call(e.__templatizeOwner,n.substring("_host_".length),i[n])}}function tr(e,t){return function(e,n,i){t.call(e.__templatizeOwner,e,n,i[n])}}function nr(e,t,n){if(de&&!Yi(e))throw new Error("strictTemplatePolicy: template owner not trusted");if(n=n||{},e.__templatizeOwner)throw new Error("A <template> can only be templatized once");e.__templatizeOwner=t;let i=(t?t.constructor:Wi)._parseTemplate(e),r=i.templatizeInstanceClass;r||(r=Ji(e,i,n),i.templatizeInstanceClass=r);const s=Yi(e);Ki(e,i,n,s);let o=class extends r{};return o.prototype._methodHost=s,o.prototype.__dataHost=e,o.prototype.__templatizeOwner=t,o.prototype.__hostProps=i.hostProps,o}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
let ir=!1;function rr(){if(fe&&!ae){if(!ir){ir=!0;const e=document.createElement("style");e.textContent="dom-bind,dom-if,dom-repeat{display:none;}",document.head.appendChild(e)}return!0}return!1}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const sr=jn(Ui(en(HTMLElement)));customElements.define("dom-bind",class extends sr{static get observedAttributes(){return["mutable-data"]}constructor(){if(super(),de)throw new Error("strictTemplatePolicy: dom-bind not allowed");this.root=null,this.$=null,this.__children=null}attributeChangedCallback(e,t,n,i){this.mutableData=!0}connectedCallback(){rr()||(this.style.display="none"),this.render()}disconnectedCallback(){this.__removeChildren()}__insertChildren(){De(De(this).parentNode).insertBefore(this.root,this)}__removeChildren(){if(this.__children)for(let e=0;e<this.__children.length;e++)this.root.appendChild(this.__children[e])}render(){let e;if(!this.__children){if(e=e||this.querySelector("template"),!e){let t=new MutationObserver((()=>{if(e=this.querySelector("template"),!e)throw new Error("dom-bind requires a <template> child");t.disconnect(),this.render()}));return void t.observe(this,{childList:!0})}this.root=this._stampTemplate(e),this.$=this.root.$,this.__children=[];for(let e=this.root.firstChild;e;e=e.nextSibling)this.__children[this.__children.length]=e;this._enableProperties()}this.__insertChildren(),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}});
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
class or{constructor(e){this.value=e.toString()}toString(){return this.value}}function ar(e){if(e instanceof HTMLTemplateElement)return e.innerHTML;if(e instanceof or)return function(e){if(e instanceof or)return e.value;throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${e}`)}(e);throw new Error(`non-template value passed to Polymer's html function: ${e}`)}const lr=function(e,...t){const n=document.createElement("template");return n.innerHTML=t.reduce(((t,n,i)=>t+ar(n)+e[i+1]),e[0]),n},hr=sn(HTMLElement),cr=Ui(hr);
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/class ur extends cr{static get is(){return"dom-repeat"}static get template(){return null}static get properties(){return{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},itemsIndexAs:{type:String,value:"itemsIndex"},sort:{type:Function,observer:"__sortChanged"},filter:{type:Function,observer:"__filterChanged"},observe:{type:String,observer:"__observeChanged"},delay:Number,renderedItemCount:{type:Number,notify:!we,readOnly:!0},initialCount:{type:Number},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:"__computeFrameTime(targetFramerate)"},notifyDomChange:{type:Boolean},reuseChunkedInstances:{type:Boolean}}}static get observers(){return["__itemsChanged(items.*)"]}constructor(){super(),this.__instances=[],this.__renderDebouncer=null,this.__itemsIdxToInstIdx={},this.__chunkCount=null,this.__renderStartTime=null,this.__itemsArrayChanged=!1,this.__shouldMeasureChunk=!1,this.__shouldContinueChunking=!1,this.__chunkingId=0,this.__sortFn=null,this.__filterFn=null,this.__observePaths=null,this.__ctor=null,this.__isDetached=!0,this.template=null,this._templateInfo}disconnectedCallback(){super.disconnectedCallback(),this.__isDetached=!0;for(let e=0;e<this.__instances.length;e++)this.__detachInstance(e)}connectedCallback(){if(super.connectedCallback(),rr()||(this.style.display="none"),this.__isDetached){this.__isDetached=!1;let e=De(De(this).parentNode);for(let t=0;t<this.__instances.length;t++)this.__attachInstance(t,e)}}__ensureTemplatized(){if(!this.__ctor){const e=this;let t=this.template=e._templateInfo?e:this.querySelector("template");if(!t){let e=new MutationObserver((()=>{if(!this.querySelector("template"))throw new Error("dom-repeat requires a <template> child");e.disconnect(),this.__render()}));return e.observe(this,{childList:!0}),!1}let n={};n[this.as]=!0,n[this.indexAs]=!0,n[this.itemsIndexAs]=!0,this.__ctor=nr(t,this,{mutableData:this.mutableData,parentModel:!0,instanceProps:n,forwardHostProp:function(e,t){let n=this.__instances;for(let i,r=0;r<n.length&&(i=n[r]);r++)i.forwardHostProp(e,t)},notifyInstanceProp:function(e,t,n){if((i=this.as)===(r=t)||Le(i,r)||Ue(i,r)){let i=e[this.itemsIndexAs];t==this.as&&(this.items[i]=n);let r=Ve(this.as,`${JSCompiler_renameProperty("items",this)}.${i}`,t);this.notifyPath(r,n)}var i,r}})}return!0}__getMethodHost(){return this.__dataHost._methodHost||this.__dataHost}__functionFromPropertyValue(e){if("string"==typeof e){let t=e,n=this.__getMethodHost();return function(){return n[t].apply(n,arguments)}}return e}__sortChanged(e){this.__sortFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__filterChanged(e){this.__filterFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__computeFrameTime(e){return Math.ceil(1e3/e)}__observeChanged(){this.__observePaths=this.observe&&this.observe.replace(".*",".").split(" ")}__handleObservedPaths(e){if(this.__sortFn||this.__filterFn)if(e){if(this.__observePaths){let t=this.__observePaths;for(let n=0;n<t.length;n++)0===e.indexOf(t[n])&&this.__debounceRender(this.__render,this.delay)}}else this.__debounceRender(this.__render,this.delay)}__itemsChanged(e){this.items&&Array.isArray(this.items),this.__handleItemPath(e.path,e.value)||("items"===e.path&&(this.__itemsArrayChanged=!0),this.__debounceRender(this.__render))}__debounceRender(e,t=0){this.__renderDebouncer=on.debounce(this.__renderDebouncer,t>0?st.after(t):ot,e.bind(this)),ln(this.__renderDebouncer)}render(){this.__debounceRender(this.__render),gi()}__render(){if(!this.__ensureTemplatized())return;let e=this.items||[];const t=this.__sortAndFilterItems(e),n=this.__calculateLimit(t.length);this.__updateInstances(e,n,t),this.initialCount&&(this.__shouldMeasureChunk||this.__shouldContinueChunking)&&(cancelAnimationFrame(this.__chunkingId),this.__chunkingId=requestAnimationFrame((()=>this.__continueChunking()))),this._setRenderedItemCount(this.__instances.length),we&&!this.notifyDomChange||this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}__sortAndFilterItems(e){let t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=n;return this.__filterFn&&(t=t.filter(((t,n,i)=>this.__filterFn(e[t],n,i)))),this.__sortFn&&t.sort(((t,n)=>this.__sortFn(e[t],e[n]))),t}__calculateLimit(e){let t=e;const n=this.__instances.length;if(this.initialCount){let i;!this.__chunkCount||this.__itemsArrayChanged&&!this.reuseChunkedInstances?(t=Math.min(e,this.initialCount),i=Math.max(t-n,0),this.__chunkCount=i||1):(i=Math.min(Math.max(e-n,0),this.__chunkCount),t=Math.min(n+i,e)),this.__shouldMeasureChunk=i===this.__chunkCount,this.__shouldContinueChunking=t<e,this.__renderStartTime=performance.now()}return this.__itemsArrayChanged=!1,t}__continueChunking(){if(this.__shouldMeasureChunk){const e=performance.now()-this.__renderStartTime,t=this._targetFrameTime/e;this.__chunkCount=Math.round(this.__chunkCount*t)||1}this.__shouldContinueChunking&&this.__debounceRender(this.__render)}__updateInstances(e,t,n){const i=this.__itemsIdxToInstIdx={};let r;for(r=0;r<t;r++){let t=this.__instances[r],s=n[r],o=e[s];i[s]=r,t?(t._setPendingProperty(this.as,o),t._setPendingProperty(this.indexAs,r),t._setPendingProperty(this.itemsIndexAs,s),t._flushProperties()):this.__insertInstance(o,r,s)}for(let e=this.__instances.length-1;e>=r;e--)this.__detachAndRemoveInstance(e)}__detachInstance(e){let t=this.__instances[e];const n=De(t.root);for(let e=0;e<t.children.length;e++){let i=t.children[e];n.appendChild(i)}return t}__attachInstance(e,t){let n=this.__instances[e];t.insertBefore(n.root,this)}__detachAndRemoveInstance(e){this.__detachInstance(e),this.__instances.splice(e,1)}__stampInstance(e,t,n){let i={};return i[this.as]=e,i[this.indexAs]=t,i[this.itemsIndexAs]=n,new this.__ctor(i)}__insertInstance(e,t,n){const i=this.__stampInstance(e,t,n);let r=this.__instances[t+1],s=r?r.children[0]:this;return De(De(this).parentNode).insertBefore(i.root,s),this.__instances[t]=i,i}_showHideChildren(e){for(let t=0;t<this.__instances.length;t++)this.__instances[t]._showHideChildren(e)}__handleItemPath(e,t){let n=e.slice(6),i=n.indexOf("."),r=i<0?n:n.substring(0,i);if(r==parseInt(r,10)){let e=i<0?"":n.substring(i+1);this.__handleObservedPaths(e);let s=this.__itemsIdxToInstIdx[r],o=this.__instances[s];if(o){let n=this.as+(e?"."+e:"");o._setPendingPropertyOrPath(n,t,!1,!0),o._flushProperties()}return!0}}itemForElement(e){let t=this.modelForElement(e);return t&&t[this.as]}indexForElement(e){let t=this.modelForElement(e);return t&&t[this.indexAs]}modelForElement(e){return function(e,t){let n;for(;t;)if(n=t.__dataHost?t:t.__templatizeInstance){if(n.__dataHost==e)return n;t=n.__dataHost}else t=De(t).parentNode;return null}(this.template,e)}}customElements.define(ur.is,ur);
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
class dr extends hr{static get is(){return"dom-if"}static get template(){return null}static get properties(){return{if:{type:Boolean,observer:"__debounceRender"},restamp:{type:Boolean,observer:"__debounceRender"},notifyDomChange:{type:Boolean}}}constructor(){super(),this.__renderDebouncer=null,this._lastIf=!1,this.__hideTemplateChildren__=!1,this.__template,this._templateInfo}__debounceRender(){this.__renderDebouncer=on.debounce(this.__renderDebouncer,ot,(()=>this.__render())),ln(this.__renderDebouncer)}disconnectedCallback(){super.disconnectedCallback();const e=De(this).parentNode;e&&(e.nodeType!=Node.DOCUMENT_FRAGMENT_NODE||De(e).host)||this.__teardownInstance()}connectedCallback(){super.connectedCallback(),rr()||(this.style.display="none"),this.if&&this.__debounceRender()}__ensureTemplate(){if(!this.__template){const e=this;let t=e._templateInfo?e:De(e).querySelector("template");if(!t){let e=new MutationObserver((()=>{if(!De(this).querySelector("template"))throw new Error("dom-if requires a <template> child");e.disconnect(),this.__render()}));return e.observe(this,{childList:!0}),!1}this.__template=t}return!0}__ensureInstance(){let e=De(this).parentNode;if(this.__hasInstance()){let t=this.__getInstanceNodes();if(t&&t.length){if(De(this).previousSibling!==t[t.length-1])for(let n,i=0;i<t.length&&(n=t[i]);i++)De(e).insertBefore(n,this)}}else{if(!e)return!1;if(!this.__ensureTemplate())return!1;this.__createAndInsertInstance(e)}return!0}render(){gi()}__render(){if(this.if){if(!this.__ensureInstance())return}else this.restamp&&this.__teardownInstance();this._showHideChildren(),we&&!this.notifyDomChange||this.if==this._lastIf||(this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this._lastIf=this.if)}__hasInstance(){}__getInstanceNodes(){}__createAndInsertInstance(e){}__teardownInstance(){}_showHideChildren(){}}const pr=be?class extends dr{constructor(){super(),this.__instance=null,this.__syncInfo=null}__hasInstance(){return Boolean(this.__instance)}__getInstanceNodes(){return this.__instance.templateInfo.childNodes}__createAndInsertInstance(e){const t=this.__dataHost||this;if(de&&!this.__dataHost)throw new Error("strictTemplatePolicy: template owner not trusted");const n=t._bindTemplate(this.__template,!0);n.runEffects=(e,t,n)=>{let i=this.__syncInfo;if(this.if)i&&(this.__syncInfo=null,this._showHideChildren(),t=Object.assign(i.changedProps,t)),e(t,n);else if(this.__instance)if(i||(i=this.__syncInfo={runEffects:e,changedProps:{}}),n)for(const e in t){const t=Fe(e);i.changedProps[t]=this.__dataHost[t]}else Object.assign(i.changedProps,t)},this.__instance=t._stampTemplate(this.__template,n),De(e).insertBefore(this.__instance,this)}__syncHostProperties(){const e=this.__syncInfo;e&&(this.__syncInfo=null,e.runEffects(e.changedProps,!1))}__teardownInstance(){const e=this.__dataHost||this;this.__instance&&(e._removeBoundDom(this.__instance),this.__instance=null,this.__syncInfo=null)}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&Boolean(this.__instance.__hidden)!==e&&(this.__instance.__hidden=e,Gi(e,this.__instance.templateInfo.childNodes)),e||this.__syncHostProperties()}}:class extends dr{constructor(){super(),this.__ctor=null,this.__instance=null,this.__invalidProps=null}__hasInstance(){return Boolean(this.__instance)}__getInstanceNodes(){return this.__instance.children}__createAndInsertInstance(e){this.__ctor||(this.__ctor=nr(this.__template,this,{mutableData:!0,forwardHostProp:function(e,t){this.__instance&&(this.if?this.__instance.forwardHostProp(e,t):(this.__invalidProps=this.__invalidProps||Object.create(null),this.__invalidProps[Fe(e)]=!0))}})),this.__instance=new this.__ctor,De(e).insertBefore(this.__instance.root,this)}__teardownInstance(){if(this.__instance){let e=this.__instance.children;if(e&&e.length){let t=De(e[0]).parentNode;if(t){t=De(t);for(let n,i=0;i<e.length&&(n=e[i]);i++)t.removeChild(n)}}this.__invalidProps=null,this.__instance=null}}__syncHostProperties(){let e=this.__invalidProps;if(e){this.__invalidProps=null;for(let t in e)this.__instance._setPendingProperty(t,this.__dataHost[t]);this.__instance._flushProperties()}}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&Boolean(this.__instance.__hidden)!==e&&(this.__instance.__hidden=e,this.__instance._showHideChildren(e)),e||this.__syncHostProperties()}};customElements.define(pr.is,pr);
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
let fr=Ae((e=>{let t=sn(e);return class extends t{static get properties(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}static get observers(){return["__updateSelection(multi, items.*)"]}constructor(){super(),this.__lastItems=null,this.__lastMulti=null,this.__selectedMap=null}__updateSelection(e,t){let n=t.path;if(n==JSCompiler_renameProperty("items",this)){let n=t.base||[],i=this.__lastItems;if(e!==this.__lastMulti&&this.clearSelection(),i){let e=di(n,i);this.__applySplices(e)}this.__lastItems=n,this.__lastMulti=e}else if(t.path==`${JSCompiler_renameProperty("items",this)}.splices`)this.__applySplices(t.value.indexSplices);else{let e=n.slice(`${JSCompiler_renameProperty("items",this)}.`.length),t=parseInt(e,10);e.indexOf(".")<0&&e==t&&this.__deselectChangedIdx(t)}}__applySplices(e){let t=this.__selectedMap;for(let n=0;n<e.length;n++){let i=e[n];t.forEach(((e,n)=>{e<i.index||(e>=i.index+i.removed.length?t.set(n,e+i.addedCount-i.removed.length):t.set(n,-1))}));for(let e=0;e<i.addedCount;e++){let n=i.index+e;t.has(this.items[n])&&t.set(this.items[n],n)}}this.__updateLinks();let n=0;t.forEach(((e,i)=>{e<0?(this.multi?this.splice(JSCompiler_renameProperty("selected",this),n,1):this.selected=this.selectedItem=null,t.delete(i)):n++}))}__updateLinks(){if(this.__dataLinkedPaths={},this.multi){let e=0;this.__selectedMap.forEach((t=>{t>=0&&this.linkPaths(`${JSCompiler_renameProperty("items",this)}.${t}`,`${JSCompiler_renameProperty("selected",this)}.${e++}`)}))}else this.__selectedMap.forEach((e=>{this.linkPaths(JSCompiler_renameProperty("selected",this),`${JSCompiler_renameProperty("items",this)}.${e}`),this.linkPaths(JSCompiler_renameProperty("selectedItem",this),`${JSCompiler_renameProperty("items",this)}.${e}`)}))}clearSelection(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}isSelected(e){return this.__selectedMap.has(e)}isIndexSelected(e){return this.isSelected(this.items[e])}__deselectChangedIdx(e){let t=this.__selectedIndexForItemIndex(e);if(t>=0){let e=0;this.__selectedMap.forEach(((n,i)=>{t==e++&&this.deselect(i)}))}}__selectedIndexForItemIndex(e){let t=this.__dataLinkedPaths[`${JSCompiler_renameProperty("items",this)}.${e}`];if(t)return parseInt(t.slice(`${JSCompiler_renameProperty("selected",this)}.`.length),10)}deselect(e){let t=this.__selectedMap.get(e);if(t>=0){let n;this.__selectedMap.delete(e),this.multi&&(n=this.__selectedIndexForItemIndex(t)),this.__updateLinks(),this.multi?this.splice(JSCompiler_renameProperty("selected",this),n,1):this.selected=this.selectedItem=null}}deselectIndex(e){this.deselect(this.items[e])}select(e){this.selectIndex(this.items.indexOf(e))}selectIndex(e){let t=this.items[e];this.isSelected(t)?this.toggle&&this.deselectIndex(e):(this.multi||this.__selectedMap.clear(),this.__selectedMap.set(t,e),this.__updateLinks(),this.multi?this.push(JSCompiler_renameProperty("selected",this),t):this.selected=this.selectedItem=t)}}})),mr=fr(hr);class gr extends mr{static get is(){return"array-selector"}static get template(){return null}}customElements.define(gr.is,gr);
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
const Or=new Y;window.ShadyCSS||(window.ShadyCSS={prepareTemplate(e,t,n){},prepareTemplateDom(e,t){},prepareTemplateStyles(e,t,n){},styleSubtree(e,t){Or.processStyles(),T(e,t)},styleElement(e){Or.processStyles()},styleDocument(e){Or.processStyles(),T(document.body,e)},getComputedStyleValue:(e,t)=>P(e,t),flushCustomStyles(){},nativeCss:s,nativeShadow:e,cssBuild:n,disableRuntime:r}),window.ShadyCSS.CustomStyleInterface=Or;
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
const yr=window.ShadyCSS.CustomStyleInterface;class vr extends HTMLElement{constructor(){super(),this._style=null,yr.addCustomStyle(this)}getStyle(){if(this._style)return this._style;const e=this.querySelector("style");if(!e)return null;this._style=e;const t=e.getAttribute("include");return t&&(e.removeAttribute("include"),e.textContent=function(e){let t=e.trim().split(/\s+/),n="";for(let e=0;e<t.length;e++)n+=Be(t[e]);return n}(t)+e.textContent),this.ownerDocument!==window.document&&window.document.head.appendChild(this),this._style}}window.customElements.define("custom-style",vr);
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
const br=Pi(HTMLElement).prototype,wr=Xi({_template:lr`<style>:host{display:inline-block;position:fixed;clip:rect(0,0,0,0)}</style><div aria-live$="[[mode]]">[[_text]]</div>`,is:"iron-a11y-announcer",properties:{mode:{type:String,value:"polite"},timeout:{type:Number,value:150},_text:{type:String,value:""}},created:function(){wr.instance||(wr.instance=this),document.addEventListener("iron-announce",this._onIronAnnounce.bind(this))},announce:function(e){this._text="",this.async((function(){this._text=e}),this.timeout)},_onIronAnnounce:function(e){e.detail&&e.detail.text&&this.announce(e.detail.text)}});
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/wr.instance=null,wr.requestAvailability=function(){wr.instance||(wr.instance=document.createElement("iron-a11y-announcer")),document.body?document.body.appendChild(wr.instance):document.addEventListener("load",(function(){document.body.appendChild(wr.instance)}))};
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
class xr{constructor(e){xr[" "](e),this.type=e&&e.type||"default",this.key=e&&e.key,e&&"value"in e&&(this.value=e.value)}get value(){var e=this.type,t=this.key;if(e&&t)return xr.types[e]&&xr.types[e][t]}set value(e){var t=this.type,n=this.key;t&&n&&(t=xr.types[t]=xr.types[t]||{},null==e?delete t[n]:t[n]=e)}get list(){if(this.type){var e=xr.types[this.type];return e?Object.keys(e).map((function(e){return Sr[this.type][e]}),this):[]}}byKey(e){return this.key=e,this.value}}xr[" "]=function(){},xr.types={};var Sr=xr.types;Xi({is:"iron-meta",properties:{type:{type:String,value:"default"},key:{type:String},value:{type:String,notify:!0},self:{type:Boolean,observer:"_selfChanged"},__meta:{type:Boolean,computed:"__computeMeta(type, key, value)"}},hostAttributes:{hidden:!0},__computeMeta:function(e,t,n){var i=new xr({type:e,key:t});return void 0!==n&&n!==i.value?i.value=n:this.value!==i.value&&(this.value=i.value),i},get list(){return this.__meta&&this.__meta.list},_selfChanged:function(e){e&&(this.value=this)},byKey:function(e){return new xr({type:this.type,key:e}).value}});
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
let kr=null;const Ar={properties:{validator:{type:String},invalid:{notify:!0,reflectToAttribute:!0,type:Boolean,value:!1,observer:"_invalidChanged"}},registered:function(){kr=new xr({type:"validator"})},_invalidChanged:function(){this.invalid?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid")},get _validator(){return kr&&kr.byKey(this.validator)},hasValidator:function(){return null!=this._validator},validate:function(e){return void 0===e&&void 0!==this.value?this.invalid=!this._getValidity(this.value):this.invalid=!this._getValidity(e),!this.invalid},_getValidity:function(e){return!this.hasValidator()||this._validator.validate(e)}};
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
if(Xi({_template:lr`<style>:host{display:inline-block}</style><slot id="content"></slot>`,is:"iron-input",behaviors:[Ar],properties:{bindValue:{type:String,value:""},value:{type:String,computed:"_computeValue(bindValue)"},allowedPattern:{type:String},autoValidate:{type:Boolean,value:!1},_inputElement:Object},observers:["_bindValueChanged(bindValue, _inputElement)"],listeners:{input:"_onInput",keypress:"_onKeypress"},created:function(){wr.requestAvailability(),this._previousValidInput="",this._patternAlreadyChecked=!1},attached:function(){this._observer=ki(this).observeNodes(function(e){this._initSlottedInput()}.bind(this))},detached:function(){this._observer&&(ki(this).unobserveNodes(this._observer),this._observer=null)},get inputElement(){return this._inputElement},_initSlottedInput:function(){this._inputElement=this.getEffectiveChildren()[0],this.inputElement&&this.inputElement.value&&(this.bindValue=this.inputElement.value),this.fire("iron-input-ready")},get _patternRegExp(){var e;if(this.allowedPattern)e=new RegExp(this.allowedPattern);else if("number"===this.inputElement.type)e=/[0-9.,e-]/;return e},_bindValueChanged:function(e,t){t&&(void 0===e?t.value=null:e!==t.value&&(this.inputElement.value=e),this.autoValidate&&this.validate(),this.fire("bind-value-changed",{value:e}))},_onInput:function(){this.allowedPattern&&!this._patternAlreadyChecked&&(this._checkPatternValidity()||(this._announceInvalidCharacter("Invalid string of characters not entered."),this.inputElement.value=this._previousValidInput));this.bindValue=this._previousValidInput=this.inputElement.value,this._patternAlreadyChecked=!1},_isPrintable:function(e){var t=8==e.keyCode||9==e.keyCode||13==e.keyCode||27==e.keyCode,n=19==e.keyCode||20==e.keyCode||45==e.keyCode||46==e.keyCode||144==e.keyCode||145==e.keyCode||e.keyCode>32&&e.keyCode<41||e.keyCode>111&&e.keyCode<124;return!(t||0==e.charCode&&n)},_onKeypress:function(e){if(this.allowedPattern||"number"===this.inputElement.type){var t=this._patternRegExp;if(t&&!(e.metaKey||e.ctrlKey||e.altKey)){this._patternAlreadyChecked=!0;var n=String.fromCharCode(e.charCode);this._isPrintable(e)&&!t.test(n)&&(e.preventDefault(),this._announceInvalidCharacter("Invalid character "+n+" not entered."))}}},_checkPatternValidity:function(){var e=this._patternRegExp;if(!e)return!0;for(var t=0;t<this.inputElement.value.length;t++)if(!e.test(this.inputElement.value[t]))return!1;return!0},validate:function(){if(!this.inputElement)return this.invalid=!1,!0;var e=this.inputElement.checkValidity();return e&&(this.required&&""===this.bindValue?e=!1:this.hasValidator()&&(e=Ar.validate.call(this,this.bindValue))),this.invalid=!e,this.fire("iron-input-validate"),e},_announceInvalidCharacter:function(e){this.fire("iron-announce",{text:e})},_computeValue:function(e){return e}}),!window.polymerSkipLoadingFontRoboto){const e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.crossOrigin="anonymous",e.href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,300,300italic,400italic,500,500italic,700,700italic",document.head.appendChild(e)}
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/const Cr=lr`<custom-style><style is="custom-style">html{--paper-font-common-base:{font-family:Roboto,Noto,sans-serif;-webkit-font-smoothing:antialiased};--paper-font-common-code:{font-family:'Roboto Mono',Consolas,Menlo,monospace;-webkit-font-smoothing:antialiased};--paper-font-common-expensive-kerning:{text-rendering:optimizeLegibility};--paper-font-common-nowrap:{white-space:nowrap;overflow:hidden;text-overflow:ellipsis};--paper-font-display4:{@apply --paper-font-common-base;@apply --paper-font-common-nowrap;font-size:112px;font-weight:300;letter-spacing:-.044em;line-height:120px};--paper-font-display3:{@apply --paper-font-common-base;@apply --paper-font-common-nowrap;font-size:56px;font-weight:400;letter-spacing:-.026em;line-height:60px};--paper-font-display2:{@apply --paper-font-common-base;font-size:45px;font-weight:400;letter-spacing:-.018em;line-height:48px};--paper-font-display1:{@apply --paper-font-common-base;font-size:34px;font-weight:400;letter-spacing:-.01em;line-height:40px};--paper-font-headline:{@apply --paper-font-common-base;font-size:24px;font-weight:400;letter-spacing:-.012em;line-height:32px};--paper-font-title:{@apply --paper-font-common-base;@apply --paper-font-common-nowrap;font-size:20px;font-weight:500;line-height:28px};--paper-font-subhead:{@apply --paper-font-common-base;font-size:16px;font-weight:400;line-height:24px};--paper-font-body2:{@apply --paper-font-common-base;font-size:14px;font-weight:500;line-height:24px};--paper-font-body1:{@apply --paper-font-common-base;font-size:14px;font-weight:400;line-height:20px};--paper-font-caption:{@apply --paper-font-common-base;@apply --paper-font-common-nowrap;font-size:12px;font-weight:400;letter-spacing:.011em;line-height:20px};--paper-font-menu:{@apply --paper-font-common-base;@apply --paper-font-common-nowrap;font-size:13px;font-weight:500;line-height:24px};--paper-font-button:{@apply --paper-font-common-base;@apply --paper-font-common-nowrap;font-size:14px;font-weight:500;letter-spacing:.018em;line-height:24px;text-transform:uppercase};--paper-font-code2:{@apply --paper-font-common-code;font-size:14px;font-weight:700;line-height:20px};--paper-font-code1:{@apply --paper-font-common-code;font-size:14px;font-weight:500;line-height:20px};}</style></custom-style>`;Cr.setAttribute("style","display: none;"),document.head.appendChild(Cr.content);
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const _r={attached:function(){this.fire("addon-attached")},update:function(e){}};
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/Xi({_template:lr`<style>:host{display:inline-block;float:right;@apply --paper-font-caption;@apply --paper-input-char-counter;}:host([hidden]){display:none!important}:host(:dir(rtl)){float:left}</style><span>[[_charCounterStr]]</span>`,is:"paper-input-char-counter",behaviors:[_r],properties:{_charCounterStr:{type:String,value:"0"}},update:function(e){if(e.inputElement){e.value=e.value||"";var t=e.value.toString().length.toString();e.inputElement.hasAttribute("maxlength")&&(t+="/"+e.inputElement.getAttribute("maxlength")),this._charCounterStr=t}}});
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const Er=lr`<custom-style><style is="custom-style">[hidden]{display:none!important}</style></custom-style><custom-style><style is="custom-style">html{--layout:{display:-ms-flexbox;display:-webkit-flex;display:flex};--layout-inline:{display:-ms-inline-flexbox;display:-webkit-inline-flex;display:inline-flex};--layout-horizontal:{@apply --layout;-ms-flex-direction:row;-webkit-flex-direction:row;flex-direction:row};--layout-horizontal-reverse:{@apply --layout;-ms-flex-direction:row-reverse;-webkit-flex-direction:row-reverse;flex-direction:row-reverse};--layout-vertical:{@apply --layout;-ms-flex-direction:column;-webkit-flex-direction:column;flex-direction:column};--layout-vertical-reverse:{@apply --layout;-ms-flex-direction:column-reverse;-webkit-flex-direction:column-reverse;flex-direction:column-reverse};--layout-wrap:{-ms-flex-wrap:wrap;-webkit-flex-wrap:wrap;flex-wrap:wrap};--layout-wrap-reverse:{-ms-flex-wrap:wrap-reverse;-webkit-flex-wrap:wrap-reverse;flex-wrap:wrap-reverse};--layout-flex-auto:{-ms-flex:1 1 auto;-webkit-flex:1 1 auto;flex:1 1 auto};--layout-flex-none:{-ms-flex:none;-webkit-flex:none;flex:none};--layout-flex:{-ms-flex:1 1 .000000001px;-webkit-flex:1;flex:1;-webkit-flex-basis:.000000001px;flex-basis:.000000001px};--layout-flex-2:{-ms-flex:2;-webkit-flex:2;flex:2};--layout-flex-3:{-ms-flex:3;-webkit-flex:3;flex:3};--layout-flex-4:{-ms-flex:4;-webkit-flex:4;flex:4};--layout-flex-5:{-ms-flex:5;-webkit-flex:5;flex:5};--layout-flex-6:{-ms-flex:6;-webkit-flex:6;flex:6};--layout-flex-7:{-ms-flex:7;-webkit-flex:7;flex:7};--layout-flex-8:{-ms-flex:8;-webkit-flex:8;flex:8};--layout-flex-9:{-ms-flex:9;-webkit-flex:9;flex:9};--layout-flex-10:{-ms-flex:10;-webkit-flex:10;flex:10};--layout-flex-11:{-ms-flex:11;-webkit-flex:11;flex:11};--layout-flex-12:{-ms-flex:12;-webkit-flex:12;flex:12};--layout-start:{-ms-flex-align:start;-webkit-align-items:flex-start;align-items:flex-start};--layout-center:{-ms-flex-align:center;-webkit-align-items:center;align-items:center};--layout-end:{-ms-flex-align:end;-webkit-align-items:flex-end;align-items:flex-end};--layout-baseline:{-ms-flex-align:baseline;-webkit-align-items:baseline;align-items:baseline};--layout-start-justified:{-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start};--layout-center-justified:{-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center};--layout-end-justified:{-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end};--layout-around-justified:{-ms-flex-pack:distribute;-webkit-justify-content:space-around;justify-content:space-around};--layout-justified:{-ms-flex-pack:justify;-webkit-justify-content:space-between;justify-content:space-between};--layout-center-center:{@apply --layout-center;@apply --layout-center-justified;};--layout-self-start:{-ms-align-self:flex-start;-webkit-align-self:flex-start;align-self:flex-start};--layout-self-center:{-ms-align-self:center;-webkit-align-self:center;align-self:center};--layout-self-end:{-ms-align-self:flex-end;-webkit-align-self:flex-end;align-self:flex-end};--layout-self-stretch:{-ms-align-self:stretch;-webkit-align-self:stretch;align-self:stretch};--layout-self-baseline:{-ms-align-self:baseline;-webkit-align-self:baseline;align-self:baseline};--layout-start-aligned:{-ms-flex-line-pack:start;-ms-align-content:flex-start;-webkit-align-content:flex-start;align-content:flex-start};--layout-end-aligned:{-ms-flex-line-pack:end;-ms-align-content:flex-end;-webkit-align-content:flex-end;align-content:flex-end};--layout-center-aligned:{-ms-flex-line-pack:center;-ms-align-content:center;-webkit-align-content:center;align-content:center};--layout-between-aligned:{-ms-flex-line-pack:justify;-ms-align-content:space-between;-webkit-align-content:space-between;align-content:space-between};--layout-around-aligned:{-ms-flex-line-pack:distribute;-ms-align-content:space-around;-webkit-align-content:space-around;align-content:space-around};--layout-block:{display:block};--layout-invisible:{visibility:hidden!important};--layout-relative:{position:relative};--layout-fit:{position:absolute;top:0;right:0;bottom:0;left:0};--layout-scroll:{-webkit-overflow-scrolling:touch;overflow:auto};--layout-fullbleed:{margin:0;height:100vh};--layout-fixed-top:{position:fixed;top:0;left:0;right:0};--layout-fixed-right:{position:fixed;top:0;right:0;bottom:0};--layout-fixed-bottom:{position:fixed;right:0;bottom:0;left:0};--layout-fixed-left:{position:fixed;top:0;bottom:0;left:0};}</style></custom-style>`;Er.setAttribute("style","display: none;"),document.head.appendChild(Er.content);var Tr=document.createElement("style");Tr.textContent="[hidden] { display: none !important; }",document.head.appendChild(Tr);
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const Pr=lr`<custom-style><style is="custom-style">html{--google-red-100:#f4c7c3;--google-red-300:#e67c73;--google-red-500:#db4437;--google-red-700:#c53929;--google-blue-100:#c6dafc;--google-blue-300:#7baaf7;--google-blue-500:#4285f4;--google-blue-700:#3367d6;--google-green-100:#b7e1cd;--google-green-300:#57bb8a;--google-green-500:#0f9d58;--google-green-700:#0b8043;--google-yellow-100:#fce8b2;--google-yellow-300:#f7cb4d;--google-yellow-500:#f4b400;--google-yellow-700:#f09300;--google-grey-100:#f5f5f5;--google-grey-300:#e0e0e0;--google-grey-500:#9e9e9e;--google-grey-700:#616161;--paper-red-50:#ffebee;--paper-red-100:#ffcdd2;--paper-red-200:#ef9a9a;--paper-red-300:#e57373;--paper-red-400:#ef5350;--paper-red-500:#f44336;--paper-red-600:#e53935;--paper-red-700:#d32f2f;--paper-red-800:#c62828;--paper-red-900:#b71c1c;--paper-red-a100:#ff8a80;--paper-red-a200:#ff5252;--paper-red-a400:#ff1744;--paper-red-a700:#d50000;--paper-pink-50:#fce4ec;--paper-pink-100:#f8bbd0;--paper-pink-200:#f48fb1;--paper-pink-300:#f06292;--paper-pink-400:#ec407a;--paper-pink-500:#e91e63;--paper-pink-600:#d81b60;--paper-pink-700:#c2185b;--paper-pink-800:#ad1457;--paper-pink-900:#880e4f;--paper-pink-a100:#ff80ab;--paper-pink-a200:#ff4081;--paper-pink-a400:#f50057;--paper-pink-a700:#c51162;--paper-purple-50:#f3e5f5;--paper-purple-100:#e1bee7;--paper-purple-200:#ce93d8;--paper-purple-300:#ba68c8;--paper-purple-400:#ab47bc;--paper-purple-500:#9c27b0;--paper-purple-600:#8e24aa;--paper-purple-700:#7b1fa2;--paper-purple-800:#6a1b9a;--paper-purple-900:#4a148c;--paper-purple-a100:#ea80fc;--paper-purple-a200:#e040fb;--paper-purple-a400:#d500f9;--paper-purple-a700:#aa00ff;--paper-deep-purple-50:#ede7f6;--paper-deep-purple-100:#d1c4e9;--paper-deep-purple-200:#b39ddb;--paper-deep-purple-300:#9575cd;--paper-deep-purple-400:#7e57c2;--paper-deep-purple-500:#673ab7;--paper-deep-purple-600:#5e35b1;--paper-deep-purple-700:#512da8;--paper-deep-purple-800:#4527a0;--paper-deep-purple-900:#311b92;--paper-deep-purple-a100:#b388ff;--paper-deep-purple-a200:#7c4dff;--paper-deep-purple-a400:#651fff;--paper-deep-purple-a700:#6200ea;--paper-indigo-50:#e8eaf6;--paper-indigo-100:#c5cae9;--paper-indigo-200:#9fa8da;--paper-indigo-300:#7986cb;--paper-indigo-400:#5c6bc0;--paper-indigo-500:#3f51b5;--paper-indigo-600:#3949ab;--paper-indigo-700:#303f9f;--paper-indigo-800:#283593;--paper-indigo-900:#1a237e;--paper-indigo-a100:#8c9eff;--paper-indigo-a200:#536dfe;--paper-indigo-a400:#3d5afe;--paper-indigo-a700:#304ffe;--paper-blue-50:#e3f2fd;--paper-blue-100:#bbdefb;--paper-blue-200:#90caf9;--paper-blue-300:#64b5f6;--paper-blue-400:#42a5f5;--paper-blue-500:#2196f3;--paper-blue-600:#1e88e5;--paper-blue-700:#1976d2;--paper-blue-800:#1565c0;--paper-blue-900:#0d47a1;--paper-blue-a100:#82b1ff;--paper-blue-a200:#448aff;--paper-blue-a400:#2979ff;--paper-blue-a700:#2962ff;--paper-light-blue-50:#e1f5fe;--paper-light-blue-100:#b3e5fc;--paper-light-blue-200:#81d4fa;--paper-light-blue-300:#4fc3f7;--paper-light-blue-400:#29b6f6;--paper-light-blue-500:#03a9f4;--paper-light-blue-600:#039be5;--paper-light-blue-700:#0288d1;--paper-light-blue-800:#0277bd;--paper-light-blue-900:#01579b;--paper-light-blue-a100:#80d8ff;--paper-light-blue-a200:#40c4ff;--paper-light-blue-a400:#00b0ff;--paper-light-blue-a700:#0091ea;--paper-cyan-50:#e0f7fa;--paper-cyan-100:#b2ebf2;--paper-cyan-200:#80deea;--paper-cyan-300:#4dd0e1;--paper-cyan-400:#26c6da;--paper-cyan-500:#00bcd4;--paper-cyan-600:#00acc1;--paper-cyan-700:#0097a7;--paper-cyan-800:#00838f;--paper-cyan-900:#006064;--paper-cyan-a100:#84ffff;--paper-cyan-a200:#18ffff;--paper-cyan-a400:#00e5ff;--paper-cyan-a700:#00b8d4;--paper-teal-50:#e0f2f1;--paper-teal-100:#b2dfdb;--paper-teal-200:#80cbc4;--paper-teal-300:#4db6ac;--paper-teal-400:#26a69a;--paper-teal-500:#009688;--paper-teal-600:#00897b;--paper-teal-700:#00796b;--paper-teal-800:#00695c;--paper-teal-900:#004d40;--paper-teal-a100:#a7ffeb;--paper-teal-a200:#64ffda;--paper-teal-a400:#1de9b6;--paper-teal-a700:#00bfa5;--paper-green-50:#e8f5e9;--paper-green-100:#c8e6c9;--paper-green-200:#a5d6a7;--paper-green-300:#81c784;--paper-green-400:#66bb6a;--paper-green-500:#4caf50;--paper-green-600:#43a047;--paper-green-700:#388e3c;--paper-green-800:#2e7d32;--paper-green-900:#1b5e20;--paper-green-a100:#b9f6ca;--paper-green-a200:#69f0ae;--paper-green-a400:#00e676;--paper-green-a700:#00c853;--paper-light-green-50:#f1f8e9;--paper-light-green-100:#dcedc8;--paper-light-green-200:#c5e1a5;--paper-light-green-300:#aed581;--paper-light-green-400:#9ccc65;--paper-light-green-500:#8bc34a;--paper-light-green-600:#7cb342;--paper-light-green-700:#689f38;--paper-light-green-800:#558b2f;--paper-light-green-900:#33691e;--paper-light-green-a100:#ccff90;--paper-light-green-a200:#b2ff59;--paper-light-green-a400:#76ff03;--paper-light-green-a700:#64dd17;--paper-lime-50:#f9fbe7;--paper-lime-100:#f0f4c3;--paper-lime-200:#e6ee9c;--paper-lime-300:#dce775;--paper-lime-400:#d4e157;--paper-lime-500:#cddc39;--paper-lime-600:#c0ca33;--paper-lime-700:#afb42b;--paper-lime-800:#9e9d24;--paper-lime-900:#827717;--paper-lime-a100:#f4ff81;--paper-lime-a200:#eeff41;--paper-lime-a400:#c6ff00;--paper-lime-a700:#aeea00;--paper-yellow-50:#fffde7;--paper-yellow-100:#fff9c4;--paper-yellow-200:#fff59d;--paper-yellow-300:#fff176;--paper-yellow-400:#ffee58;--paper-yellow-500:#ffeb3b;--paper-yellow-600:#fdd835;--paper-yellow-700:#fbc02d;--paper-yellow-800:#f9a825;--paper-yellow-900:#f57f17;--paper-yellow-a100:#ffff8d;--paper-yellow-a200:#ffff00;--paper-yellow-a400:#ffea00;--paper-yellow-a700:#ffd600;--paper-amber-50:#fff8e1;--paper-amber-100:#ffecb3;--paper-amber-200:#ffe082;--paper-amber-300:#ffd54f;--paper-amber-400:#ffca28;--paper-amber-500:#ffc107;--paper-amber-600:#ffb300;--paper-amber-700:#ffa000;--paper-amber-800:#ff8f00;--paper-amber-900:#ff6f00;--paper-amber-a100:#ffe57f;--paper-amber-a200:#ffd740;--paper-amber-a400:#ffc400;--paper-amber-a700:#ffab00;--paper-orange-50:#fff3e0;--paper-orange-100:#ffe0b2;--paper-orange-200:#ffcc80;--paper-orange-300:#ffb74d;--paper-orange-400:#ffa726;--paper-orange-500:#ff9800;--paper-orange-600:#fb8c00;--paper-orange-700:#f57c00;--paper-orange-800:#ef6c00;--paper-orange-900:#e65100;--paper-orange-a100:#ffd180;--paper-orange-a200:#ffab40;--paper-orange-a400:#ff9100;--paper-orange-a700:#ff6500;--paper-deep-orange-50:#fbe9e7;--paper-deep-orange-100:#ffccbc;--paper-deep-orange-200:#ffab91;--paper-deep-orange-300:#ff8a65;--paper-deep-orange-400:#ff7043;--paper-deep-orange-500:#ff5722;--paper-deep-orange-600:#f4511e;--paper-deep-orange-700:#e64a19;--paper-deep-orange-800:#d84315;--paper-deep-orange-900:#bf360c;--paper-deep-orange-a100:#ff9e80;--paper-deep-orange-a200:#ff6e40;--paper-deep-orange-a400:#ff3d00;--paper-deep-orange-a700:#dd2c00;--paper-brown-50:#efebe9;--paper-brown-100:#d7ccc8;--paper-brown-200:#bcaaa4;--paper-brown-300:#a1887f;--paper-brown-400:#8d6e63;--paper-brown-500:#795548;--paper-brown-600:#6d4c41;--paper-brown-700:#5d4037;--paper-brown-800:#4e342e;--paper-brown-900:#3e2723;--paper-grey-50:#fafafa;--paper-grey-100:#f5f5f5;--paper-grey-200:#eeeeee;--paper-grey-300:#e0e0e0;--paper-grey-400:#bdbdbd;--paper-grey-500:#9e9e9e;--paper-grey-600:#757575;--paper-grey-700:#616161;--paper-grey-800:#424242;--paper-grey-900:#212121;--paper-blue-grey-50:#eceff1;--paper-blue-grey-100:#cfd8dc;--paper-blue-grey-200:#b0bec5;--paper-blue-grey-300:#90a4ae;--paper-blue-grey-400:#78909c;--paper-blue-grey-500:#607d8b;--paper-blue-grey-600:#546e7a;--paper-blue-grey-700:#455a64;--paper-blue-grey-800:#37474f;--paper-blue-grey-900:#263238;--dark-divider-opacity:0.12;--dark-disabled-opacity:0.38;--dark-secondary-opacity:0.54;--dark-primary-opacity:0.87;--light-divider-opacity:0.12;--light-disabled-opacity:0.3;--light-secondary-opacity:0.7;--light-primary-opacity:1.0}</style></custom-style>`;Pr.setAttribute("style","display: none;"),document.head.appendChild(Pr.content);
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const $r=lr`<custom-style><style is="custom-style">html{--primary-text-color:var(--light-theme-text-color);--primary-background-color:var(--light-theme-background-color);--secondary-text-color:var(--light-theme-secondary-color);--disabled-text-color:var(--light-theme-disabled-color);--divider-color:var(--light-theme-divider-color);--error-color:var(--paper-deep-orange-a700);--primary-color:var(--paper-indigo-500);--light-primary-color:var(--paper-indigo-100);--dark-primary-color:var(--paper-indigo-700);--accent-color:var(--paper-pink-a200);--light-accent-color:var(--paper-pink-a100);--dark-accent-color:var(--paper-pink-a400);--light-theme-background-color:#ffffff;--light-theme-base-color:#000000;--light-theme-text-color:var(--paper-grey-900);--light-theme-secondary-color:#737373;--light-theme-disabled-color:#9b9b9b;--light-theme-divider-color:#dbdbdb;--dark-theme-background-color:var(--paper-grey-900);--dark-theme-base-color:#ffffff;--dark-theme-text-color:#ffffff;--dark-theme-secondary-color:#bcbcbc;--dark-theme-disabled-color:#646464;--dark-theme-divider-color:#3c3c3c;--text-primary-color:var(--dark-theme-text-color);--default-primary-color:var(--primary-color)}</style></custom-style>`;$r.setAttribute("style","display: none;"),document.head.appendChild($r.content);
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const Nr=lr`<custom-style><style is="custom-style">html{--paper-input-container-shared-input-style:{position:relative;outline:0;box-shadow:none;padding:0;margin:0;width:100%;max-width:100%;background:0 0;border:none;color:var(--paper-input-container-input-color,var(--primary-text-color));-webkit-appearance:none;text-align:inherit;vertical-align:var(--paper-input-container-input-align,bottom);@apply --paper-font-subhead;};}</style></custom-style>`;Nr.setAttribute("style","display: none;"),document.head.appendChild(Nr.content),Xi({_template:lr`<style>:host{display:block;padding:8px 0;@apply --paper-input-container;}:host([inline]){display:inline-block}:host([disabled]){pointer-events:none;opacity:.33;@apply --paper-input-container-disabled;}:host([hidden]){display:none!important}[hidden]{display:none!important}.floated-label-placeholder{@apply --paper-font-caption;}.underline{height:2px;position:relative}.focused-line{@apply --layout-fit;border-bottom:2px solid var(--paper-input-container-focus-color,var(--primary-color));-webkit-transform-origin:center center;transform-origin:center center;-webkit-transform:scale3d(0,1,1);transform:scale3d(0,1,1);@apply --paper-input-container-underline-focus;}.underline.is-highlighted .focused-line{-webkit-transform:none;transform:none;-webkit-transition:-webkit-transform .25s;transition:transform .25s;@apply --paper-transition-easing;}.underline.is-invalid .focused-line{border-color:var(--paper-input-container-invalid-color,var(--error-color));-webkit-transform:none;transform:none;-webkit-transition:-webkit-transform .25s;transition:transform .25s;@apply --paper-transition-easing;}.unfocused-line{@apply --layout-fit;border-bottom:1px solid var(--paper-input-container-color,var(--secondary-text-color));@apply --paper-input-container-underline;}:host([disabled]) .unfocused-line{border-bottom:1px dashed;border-color:var(--paper-input-container-color,var(--secondary-text-color));@apply --paper-input-container-underline-disabled;}.input-wrapper{@apply --layout-horizontal;@apply --layout-center;position:relative}.input-content{@apply --layout-flex-auto;@apply --layout-relative;max-width:100%}.input-content ::slotted(.paper-input-label),.input-content ::slotted(label){position:absolute;top:0;left:0;width:100%;font:inherit;color:var(--paper-input-container-color,var(--secondary-text-color));-webkit-transition:-webkit-transform .25s,width .25s;transition:transform .25s,width .25s;-webkit-transform-origin:left top;transform-origin:left top;min-height:1px;@apply --paper-font-common-nowrap;@apply --paper-font-subhead;@apply --paper-input-container-label;@apply --paper-transition-easing;}.input-content ::slotted(.paper-input-label):before,.input-content ::slotted(label):before{@apply --paper-input-container-label-before;}.input-content ::slotted(.paper-input-label):after,.input-content ::slotted(label):after{@apply --paper-input-container-label-after;}.input-content.label-is-floating ::slotted(.paper-input-label),.input-content.label-is-floating ::slotted(label){-webkit-transform:translateY(-75%) scale(.75);transform:translateY(-75%) scale(.75);width:133%;@apply --paper-input-container-label-floating;}:host(:dir(rtl)) .input-content.label-is-floating ::slotted(.paper-input-label),:host(:dir(rtl)) .input-content.label-is-floating ::slotted(label){right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top}.input-content.label-is-highlighted ::slotted(.paper-input-label),.input-content.label-is-highlighted ::slotted(label){color:var(--paper-input-container-focus-color,var(--primary-color));@apply --paper-input-container-label-focus;}.input-content.is-invalid ::slotted(.paper-input-label),.input-content.is-invalid ::slotted(label){color:var(--paper-input-container-invalid-color,var(--error-color))}.input-content.label-is-hidden ::slotted(.paper-input-label),.input-content.label-is-hidden ::slotted(label){visibility:hidden}.input-content ::slotted(.paper-input-input),.input-content ::slotted(input),.input-content ::slotted(iron-autogrow-textarea),.input-content ::slotted(iron-input),.input-content ::slotted(textarea){@apply --paper-input-container-shared-input-style;color:var(--paper-input-container-input-color,var(--primary-text-color));@apply --paper-input-container-input;}.input-content ::slotted(input)::-webkit-inner-spin-button,.input-content ::slotted(input)::-webkit-outer-spin-button{@apply --paper-input-container-input-webkit-spinner;}.input-content.focused ::slotted(.paper-input-input),.input-content.focused ::slotted(input),.input-content.focused ::slotted(iron-autogrow-textarea),.input-content.focused ::slotted(iron-input),.input-content.focused ::slotted(textarea){@apply --paper-input-container-input-focus;}.input-content.is-invalid ::slotted(.paper-input-input),.input-content.is-invalid ::slotted(input),.input-content.is-invalid ::slotted(iron-autogrow-textarea),.input-content.is-invalid ::slotted(iron-input),.input-content.is-invalid ::slotted(textarea){@apply --paper-input-container-input-invalid;}.prefix ::slotted(*){display:inline-block;@apply --paper-font-subhead;@apply --layout-flex-none;@apply --paper-input-prefix;}.suffix ::slotted(*){display:inline-block;@apply --paper-font-subhead;@apply --layout-flex-none;@apply --paper-input-suffix;}.input-content ::slotted(input){min-width:0}.input-content ::slotted(textarea){resize:none}.add-on-content{position:relative}.add-on-content.is-invalid ::slotted(*){color:var(--paper-input-container-invalid-color,var(--error-color))}.add-on-content.is-highlighted ::slotted(*){color:var(--paper-input-container-focus-color,var(--primary-color))}</style><div class="floated-label-placeholder" aria-hidden="true" hidden="[[noLabelFloat]]"></div><div class="input-wrapper"><span class="prefix"><slot name="prefix"></slot></span><div class$="[[_computeInputContentClass(noLabelFloat,alwaysFloatLabel,focused,invalid,_inputHasContent)]]" id="labelAndInputContainer"><slot name="label"></slot><slot name="input"></slot></div><span class="suffix"><slot name="suffix"></slot></span></div><div class$="[[_computeUnderlineClass(focused,invalid)]]"><div class="unfocused-line"></div><div class="focused-line"></div></div><div class$="[[_computeAddOnContentClass(focused,invalid)]]"><slot name="add-on"></slot></div>`,is:"paper-input-container",properties:{noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},attrForValue:{type:String,value:"bind-value"},autoValidate:{type:Boolean,value:!1},invalid:{observer:"_invalidChanged",type:Boolean,value:!1},focused:{readOnly:!0,type:Boolean,value:!1,notify:!0},_addons:{type:Array},_inputHasContent:{type:Boolean,value:!1},_inputSelector:{type:String,value:"input,iron-input,textarea,.paper-input-input"},_boundOnFocus:{type:Function,value:function(){return this._onFocus.bind(this)}},_boundOnBlur:{type:Function,value:function(){return this._onBlur.bind(this)}},_boundOnInput:{type:Function,value:function(){return this._onInput.bind(this)}},_boundValueChanged:{type:Function,value:function(){return this._onValueChanged.bind(this)}}},listeners:{"addon-attached":"_onAddonAttached","iron-input-validate":"_onIronInputValidate"},get _valueChangedEvent(){return this.attrForValue+"-changed"},get _propertyForValue(){return Ye(this.attrForValue)},get _inputElement(){return ki(this).querySelector(this._inputSelector)},get _inputElementValue(){return this._inputElement[this._propertyForValue]||this._inputElement.value},ready:function(){this.__isFirstValueUpdate=!0,this._addons||(this._addons=[]),this.addEventListener("focus",this._boundOnFocus,!0),this.addEventListener("blur",this._boundOnBlur,!0)},attached:function(){this.attrForValue?this._inputElement.addEventListener(this._valueChangedEvent,this._boundValueChanged):this.addEventListener("input",this._onInput),this._inputElementValue&&""!=this._inputElementValue?this._handleValueAndAutoValidate(this._inputElement):this._handleValue(this._inputElement)},_onAddonAttached:function(e){this._addons||(this._addons=[]);var t=e.target;-1===this._addons.indexOf(t)&&(this._addons.push(t),this.isAttached&&this._handleValue(this._inputElement))},_onFocus:function(){this._setFocused(!0)},_onBlur:function(){this._setFocused(!1),this._handleValueAndAutoValidate(this._inputElement)},_onInput:function(e){this._handleValueAndAutoValidate(e.target)},_onValueChanged:function(e){var t=e.target;this.__isFirstValueUpdate&&(this.__isFirstValueUpdate=!1,void 0===t.value||""===t.value)||this._handleValueAndAutoValidate(e.target)},_handleValue:function(e){var t=this._inputElementValue;t||0===t||"number"===e.type&&!e.checkValidity()?this._inputHasContent=!0:this._inputHasContent=!1,this.updateAddons({inputElement:e,value:t,invalid:this.invalid})},_handleValueAndAutoValidate:function(e){var t;this.autoValidate&&e&&(t=e.validate?e.validate(this._inputElementValue):e.checkValidity(),this.invalid=!t);this._handleValue(e)},_onIronInputValidate:function(e){this.invalid=this._inputElement.invalid},_invalidChanged:function(){this._addons&&this.updateAddons({invalid:this.invalid})},updateAddons:function(e){for(var t,n=0;t=this._addons[n];n++)t.update(e)},_computeInputContentClass:function(e,t,n,i,r){var s="input-content";if(e)r&&(s+=" label-is-hidden"),i&&(s+=" is-invalid");else{var o=this.querySelector("label");t||r?(s+=" label-is-floating",this.$.labelAndInputContainer.style.position="static",i?s+=" is-invalid":n&&(s+=" label-is-highlighted")):(o&&(this.$.labelAndInputContainer.style.position="relative"),i&&(s+=" is-invalid"))}return n&&(s+=" focused"),s},_computeUnderlineClass:function(e,t){var n="underline";return t?n+=" is-invalid":e&&(n+=" is-highlighted"),n},_computeAddOnContentClass:function(e,t){var n="add-on-content";return t?n+=" is-invalid":e&&(n+=" is-highlighted"),n}}),
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
Xi({_template:lr`<style>:host{display:inline-block;visibility:hidden;color:var(--paper-input-container-invalid-color,var(--error-color));@apply --paper-font-caption;@apply --paper-input-error;position:absolute;left:0;right:0}:host([invalid]){visibility:visible}#a11yWrapper{visibility:hidden}:host([invalid]) #a11yWrapper{visibility:visible}</style><div id="a11yWrapper"><slot></slot></div>`,is:"paper-input-error",behaviors:[_r],properties:{invalid:{readOnly:!0,reflectToAttribute:!0,type:Boolean}},update:function(e){this._setInvalid(e.invalid)}});
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const Ir={properties:{name:{type:String},value:{notify:!0,type:String},required:{type:Boolean,value:!1}},attached:function(){},detached:function(){}};
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/var Qr={"U+0008":"backspace","U+0009":"tab","U+001B":"esc","U+0020":"space","U+007F":"del"},Rr={8:"backspace",9:"tab",13:"enter",27:"esc",33:"pageup",34:"pagedown",35:"end",36:"home",32:"space",37:"left",38:"up",39:"right",40:"down",46:"del",106:"*"},Mr={shift:"shiftKey",ctrl:"ctrlKey",alt:"altKey",meta:"metaKey"},Br=/[a-z0-9*]/,Dr=/U\+/,Xr=/^arrow/,Fr=/^space(bar)?/,Lr=/^escape$/;function Ur(e,t){var n="";if(e){var i=e.toLowerCase();" "===i||Fr.test(i)?n="space":Lr.test(i)?n="esc":1==i.length?t&&!Br.test(i)||(n=i):n=Xr.test(i)?i.replace("arrow",""):"multiply"==i?"*":i}return n}function Vr(e,t){return e.key?Ur(e.key,t):e.detail&&e.detail.key?Ur(e.detail.key,t):(n=e.keyIdentifier,i="",n&&(n in Qr?i=Qr[n]:Dr.test(n)?(n=parseInt(n.replace("U+","0x"),16),i=String.fromCharCode(n).toLowerCase()):i=n.toLowerCase()),i||function(e){var t="";return Number(e)&&(t=e>=65&&e<=90?String.fromCharCode(32+e):e>=112&&e<=123?"f"+(e-112+1):e>=48&&e<=57?String(e-48):e>=96&&e<=105?String(e-96):Rr[e]),t}(e.keyCode)||"");var n,i}function zr(e,t){return Vr(t,e.hasModifiers)===e.key&&(!e.hasModifiers||!!t.shiftKey==!!e.shiftKey&&!!t.ctrlKey==!!e.ctrlKey&&!!t.altKey==!!e.altKey&&!!t.metaKey==!!e.metaKey)}function Zr(e){return e.trim().split(" ").map((function(e){return function(e){return 1===e.length?{combo:e,key:e,event:"keydown"}:e.split("+").reduce((function(e,t){var n=t.split(":"),i=n[0],r=n[1];return i in Mr?(e[Mr[i]]=!0,e.hasModifiers=!0):(e.key=i,e.event=r||"keydown"),e}),{combo:e.split(":").shift()})}(e)}))}const jr={properties:{keyEventTarget:{type:Object,value:function(){return this}},stopKeyboardEventPropagation:{type:Boolean,value:!1},_boundKeyHandlers:{type:Array,value:function(){return[]}},_imperativeKeyBindings:{type:Object,value:function(){return{}}}},observers:["_resetKeyEventListeners(keyEventTarget, _boundKeyHandlers)"],keyBindings:{},registered:function(){this._prepKeyBindings()},attached:function(){this._listenKeyEventListeners()},detached:function(){this._unlistenKeyEventListeners()},addOwnKeyBinding:function(e,t){this._imperativeKeyBindings[e]=t,this._prepKeyBindings(),this._resetKeyEventListeners()},removeOwnKeyBindings:function(){this._imperativeKeyBindings={},this._prepKeyBindings(),this._resetKeyEventListeners()},keyboardEventMatchesKeys:function(e,t){for(var n=Zr(t),i=0;i<n.length;++i)if(zr(n[i],e))return!0;return!1},_collectKeyBindings:function(){var e=this.behaviors.map((function(e){return e.keyBindings}));return-1===e.indexOf(this.keyBindings)&&e.push(this.keyBindings),e},_prepKeyBindings:function(){for(var e in this._keyBindings={},this._collectKeyBindings().forEach((function(e){for(var t in e)this._addKeyBinding(t,e[t])}),this),this._imperativeKeyBindings)this._addKeyBinding(e,this._imperativeKeyBindings[e]);for(var t in this._keyBindings)this._keyBindings[t].sort((function(e,t){var n=e[0].hasModifiers;return n===t[0].hasModifiers?0:n?-1:1}))},_addKeyBinding:function(e,t){Zr(e).forEach((function(e){this._keyBindings[e.event]=this._keyBindings[e.event]||[],this._keyBindings[e.event].push([e,t])}),this)},_resetKeyEventListeners:function(){this._unlistenKeyEventListeners(),this.isAttached&&this._listenKeyEventListeners()},_listenKeyEventListeners:function(){this.keyEventTarget&&Object.keys(this._keyBindings).forEach((function(e){var t=this._keyBindings[e],n=this._onKeyBindingEvent.bind(this,t);this._boundKeyHandlers.push([this.keyEventTarget,e,n]),this.keyEventTarget.addEventListener(e,n)}),this)},_unlistenKeyEventListeners:function(){for(var e,t,n,i;this._boundKeyHandlers.length;)t=(e=this._boundKeyHandlers.pop())[0],n=e[1],i=e[2],t.removeEventListener(n,i)},_onKeyBindingEvent:function(e,t){if(this.stopKeyboardEventPropagation&&t.stopPropagation(),!t.defaultPrevented)for(var n=0;n<e.length;n++){var i=e[n][0],r=e[n][1];if(zr(i,t)&&(this._triggerKeyHandler(i,r,t),t.defaultPrevented))return}},_triggerKeyHandler:function(e,t,n){var i=Object.create(e);i.keyboardEvent=n;var r=new CustomEvent(e.event,{detail:i,cancelable:!0});this[t].call(this,r),r.defaultPrevented&&n.preventDefault()}},qr={properties:{focused:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},disabled:{type:Boolean,value:!1,notify:!0,observer:"_disabledChanged",reflectToAttribute:!0},_oldTabIndex:{type:String},_boundFocusBlurHandler:{type:Function,value:function(){return this._focusBlurHandler.bind(this)}}},observers:["_changedControlState(focused, disabled)"],ready:function(){this.addEventListener("focus",this._boundFocusBlurHandler,!0),this.addEventListener("blur",this._boundFocusBlurHandler,!0)},_focusBlurHandler:function(e){this._setFocused("focus"===e.type)},_disabledChanged:function(e,t){this.setAttribute("aria-disabled",e?"true":"false"),this.style.pointerEvents=e?"none":"",e?(this._oldTabIndex=this.getAttribute("tabindex"),this._setFocused(!1),this.tabIndex=-1,this.blur()):void 0!==this._oldTabIndex&&(null===this._oldTabIndex?this.removeAttribute("tabindex"):this.setAttribute("tabindex",this._oldTabIndex))},_changedControlState:function(){this._controlStateChanged&&this._controlStateChanged()}},Gr={NextLabelID:1,NextAddonID:1,NextInputID:1},Wr={properties:{label:{type:String},value:{notify:!0,type:String},disabled:{type:Boolean,value:!1},invalid:{type:Boolean,value:!1,notify:!0},allowedPattern:{type:String},type:{type:String},list:{type:String},pattern:{type:String},required:{type:Boolean,value:!1},errorMessage:{type:String},charCounter:{type:Boolean,value:!1},noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},autoValidate:{type:Boolean,value:!1},validator:{type:String},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,observer:"_autofocusChanged"},inputmode:{type:String},minlength:{type:Number},maxlength:{type:Number},min:{type:String},max:{type:String},step:{type:String},name:{type:String},placeholder:{type:String,value:""},readonly:{type:Boolean,value:!1},size:{type:Number},autocapitalize:{type:String,value:"none"},autocorrect:{type:String,value:"off"},autosave:{type:String},results:{type:Number},accept:{type:String},multiple:{type:Boolean},_ariaDescribedBy:{type:String,value:""},_ariaLabelledBy:{type:String,value:""},_inputId:{type:String,value:""}},listeners:{"addon-attached":"_onAddonAttached"},keyBindings:{"shift+tab:keydown":"_onShiftTabDown"},hostAttributes:{tabindex:0},get inputElement(){return this.$||(this.$={}),this.$.input||(this._generateInputId(),this.$.input=this.$$("#"+this._inputId)),this.$.input},get _focusableElement(){return this.inputElement},created:function(){this._typesThatHaveText=["date","datetime","datetime-local","month","time","week","file"]},attached:function(){this._updateAriaLabelledBy(),!hr&&this.inputElement&&-1!==this._typesThatHaveText.indexOf(this.inputElement.type)&&(this.alwaysFloatLabel=!0)},_appendStringWithSpace:function(e,t){return e=e?e+" "+t:t},_onAddonAttached:function(e){var t=ki(e).rootTarget;if(t.id)this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,t.id);else{var n="paper-input-add-on-"+Gr.NextAddonID++;t.id=n,this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,n)}},validate:function(){return this.inputElement.validate()},_focusBlurHandler:function(e){qr._focusBlurHandler.call(this,e),this.focused&&!this._shiftTabPressed&&this._focusableElement&&this._focusableElement.focus()},_onShiftTabDown:function(e){var t=this.getAttribute("tabindex");this._shiftTabPressed=!0,this.setAttribute("tabindex","-1"),this.async((function(){this.setAttribute("tabindex",t),this._shiftTabPressed=!1}),1)},_handleAutoValidate:function(){this.autoValidate&&this.validate()},updateValueAndPreserveCaret:function(e){try{var t=this.inputElement.selectionStart;this.value=e,this.inputElement.selectionStart=t,this.inputElement.selectionEnd=t}catch(t){this.value=e}},_computeAlwaysFloatLabel:function(e,t){return t||e},_updateAriaLabelledBy:function(){var e,t=ki(this.root).querySelector("label");t?(t.id?e=t.id:(e="paper-input-label-"+Gr.NextLabelID++,t.id=e),this._ariaLabelledBy=e):this._ariaLabelledBy=""},_generateInputId:function(){this._inputId&&""!==this._inputId||(this._inputId="input-"+Gr.NextInputID++)},_onChange:function(e){this.shadowRoot&&this.fire(e.type,{sourceEvent:e},{node:this,bubbles:e.bubbles,cancelable:e.cancelable})},_autofocusChanged:function(){if(this.autofocus&&this._focusableElement){var e=document.activeElement;e instanceof HTMLElement&&e!==document.body&&e!==document.documentElement||this._focusableElement.focus()}}};
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
Xi({is:"paper-input",_template:lr`<style>:host{display:block}:host([focused]){outline:0}:host([hidden]){display:none!important}input{min-width:0}iron-input>input{@apply --paper-input-container-shared-input-style;font-family:inherit;font-weight:inherit;font-size:inherit;letter-spacing:inherit;word-spacing:inherit;line-height:inherit;text-shadow:inherit;color:inherit;cursor:inherit}input:disabled{@apply --paper-input-container-input-disabled;}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{@apply --paper-input-container-input-webkit-spinner;}input::-webkit-clear-button{@apply --paper-input-container-input-webkit-clear;}input::-webkit-calendar-picker-indicator{@apply --paper-input-container-input-webkit-calendar-picker-indicator;}input::-webkit-input-placeholder{color:var(--paper-input-container-color,var(--secondary-text-color))}input:-moz-placeholder{color:var(--paper-input-container-color,var(--secondary-text-color))}input::-moz-placeholder{color:var(--paper-input-container-color,var(--secondary-text-color))}input::-ms-clear{@apply --paper-input-container-ms-clear;}input::-ms-reveal{@apply --paper-input-container-ms-reveal;}input:-ms-input-placeholder{color:var(--paper-input-container-color,var(--secondary-text-color))}label{pointer-events:none}</style><paper-input-container id="container" no-label-float="[[noLabelFloat]]" always-float-label="[[_computeAlwaysFloatLabel(alwaysFloatLabel,placeholder)]]" auto-validate$="[[autoValidate]]" disabled$="[[disabled]]" invalid="[[invalid]]"><slot name="prefix" slot="prefix"></slot><label hidden$="[[!label]]" aria-hidden="true" for$="[[_inputId]]" slot="label">[[label]]</label><iron-input bind-value="{{value}}" slot="input" class="input-element" id$="[[_inputId]]" maxlength$="[[maxlength]]" allowed-pattern="[[allowedPattern]]" invalid="{{invalid}}" validator="[[validator]]"><input aria-labelledby$="[[_ariaLabelledBy]]" aria-describedby$="[[_ariaDescribedBy]]" disabled$="[[disabled]]" title$="[[title]]" type$="[[type]]" pattern$="[[pattern]]" required$="[[required]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]" min$="[[min]]" max$="[[max]]" step$="[[step]]" name$="[[name]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" list$="[[list]]" size$="[[size]]" autocapitalize$="[[autocapitalize]]" autocorrect$="[[autocorrect]]" on-change="_onChange" tabindex$="[[tabIndex]]" autosave$="[[autosave]]" results$="[[results]]" accept$="[[accept]]" multiple$="[[multiple]]" role$="[[inputRole]]" aria-haspopup$="[[inputAriaHaspopup]]"></iron-input><slot name="suffix" slot="suffix"></slot><template is="dom-if" if="[[errorMessage]]"><paper-input-error aria-live="assertive" slot="add-on">[[errorMessage]]</paper-input-error></template><template is="dom-if" if="[[charCounter]]"><paper-input-char-counter slot="add-on"></paper-input-char-counter></template></paper-input-container>`,behaviors:[[qr,jr,Wr],Ir],properties:{value:{type:String},inputRole:{type:String,value:void 0},inputAriaHaspopup:{type:String,value:void 0}},get _focusableElement(){return this.inputElement._inputElement},listeners:{"iron-input-ready":"_onIronInputReady"},_onIronInputReady:function(){this.$.nativeInput||(this.$.nativeInput=this.$$("input")),this.inputElement&&-1!==this._typesThatHaveText.indexOf(this.$.nativeInput.type)&&(this.alwaysFloatLabel=!0),this.inputElement.bindValue&&this.$.container._handleValueAndAutoValidate(this.inputElement)}});
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const Hr={properties:{checked:{type:Boolean,value:!1,reflectToAttribute:!0,notify:!0,observer:"_checkedChanged"},toggles:{type:Boolean,value:!0,reflectToAttribute:!0},value:{type:String,value:"on",observer:"_valueChanged"}},observers:["_requiredChanged(required)"],created:function(){this._hasIronCheckedElementBehavior=!0},_getValidity:function(e){return this.disabled||!this.required||this.checked},_requiredChanged:function(){this.required?this.setAttribute("aria-required","true"):this.removeAttribute("aria-required")},_checkedChanged:function(){this.active=this.checked,this.fire("iron-change")},_valueChanged:function(){void 0!==this.value&&null!==this.value||(this.value="on")}},Yr=[Ir,Ar,Hr],Jr={properties:{pressed:{type:Boolean,readOnly:!0,value:!1,reflectToAttribute:!0,observer:"_pressedChanged"},toggles:{type:Boolean,value:!1,reflectToAttribute:!0},active:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},pointerDown:{type:Boolean,readOnly:!0,value:!1},receivedFocusFromKeyboard:{type:Boolean,readOnly:!0},ariaActiveAttribute:{type:String,value:"aria-pressed",observer:"_ariaActiveAttributeChanged"}},listeners:{down:"_downHandler",up:"_upHandler",tap:"_tapHandler"},observers:["_focusChanged(focused)","_activeChanged(active, ariaActiveAttribute)"],keyBindings:{"enter:keydown":"_asyncClick","space:keydown":"_spaceKeyDownHandler","space:keyup":"_spaceKeyUpHandler"},_mouseEventRe:/^mouse/,_tapHandler:function(){this.toggles?this._userActivate(!this.active):this.active=!1},_focusChanged:function(e){this._detectKeyboardFocus(e),e||this._setPressed(!1)},_detectKeyboardFocus:function(e){this._setReceivedFocusFromKeyboard(!this.pointerDown&&e)},_userActivate:function(e){this.active!==e&&(this.active=e,this.fire("change"))},_downHandler:function(e){this._setPointerDown(!0),this._setPressed(!0),this._setReceivedFocusFromKeyboard(!1)},_upHandler:function(){this._setPointerDown(!1),this._setPressed(!1)},_spaceKeyDownHandler:function(e){var t=e.detail.keyboardEvent,n=ki(t).localTarget;this.isLightDescendant(n)||(t.preventDefault(),t.stopImmediatePropagation(),this._setPressed(!0))},_spaceKeyUpHandler:function(e){var t=e.detail.keyboardEvent,n=ki(t).localTarget;this.isLightDescendant(n)||(this.pressed&&this._asyncClick(),this._setPressed(!1))},_asyncClick:function(){this.async((function(){this.click()}),1)},_pressedChanged:function(e){this._changedButtonState()},_ariaActiveAttributeChanged:function(e,t){t&&t!=e&&this.hasAttribute(t)&&this.removeAttribute(t)},_activeChanged:function(e,t){this.toggles?this.setAttribute(this.ariaActiveAttribute,e?"true":"false"):this.removeAttribute(this.ariaActiveAttribute),this._changedButtonState()},_controlStateChanged:function(){this.disabled?this._setPressed(!1):this._changedButtonState()},_changedButtonState:function(){this._buttonStateChanged&&this._buttonStateChanged()}},Kr=[jr,Jr];
/**
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
var es={distance:function(e,t,n,i){var r=e-n,s=t-i;return Math.sqrt(r*r+s*s)},now:window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now};function ts(e){this.element=e,this.width=this.boundingRect.width,this.height=this.boundingRect.height,this.size=Math.max(this.width,this.height)}function ns(e){this.element=e,this.color=window.getComputedStyle(e).color,this.wave=document.createElement("div"),this.waveContainer=document.createElement("div"),this.wave.style.backgroundColor=this.color,this.wave.classList.add("wave"),this.waveContainer.classList.add("wave-container"),ki(this.waveContainer).appendChild(this.wave),this.resetInteractionState()}ts.prototype={get boundingRect(){return this.element.getBoundingClientRect()},furthestCornerDistanceFrom:function(e,t){var n=es.distance(e,t,0,0),i=es.distance(e,t,this.width,0),r=es.distance(e,t,0,this.height),s=es.distance(e,t,this.width,this.height);return Math.max(n,i,r,s)}},ns.MAX_RADIUS=300,ns.prototype={get recenters(){return this.element.recenters},get center(){return this.element.center},get mouseDownElapsed(){var e;return this.mouseDownStart?(e=es.now()-this.mouseDownStart,this.mouseUpStart&&(e-=this.mouseUpElapsed),e):0},get mouseUpElapsed(){return this.mouseUpStart?es.now()-this.mouseUpStart:0},get mouseDownElapsedSeconds(){return this.mouseDownElapsed/1e3},get mouseUpElapsedSeconds(){return this.mouseUpElapsed/1e3},get mouseInteractionSeconds(){return this.mouseDownElapsedSeconds+this.mouseUpElapsedSeconds},get initialOpacity(){return this.element.initialOpacity},get opacityDecayVelocity(){return this.element.opacityDecayVelocity},get radius(){var e=this.containerMetrics.width*this.containerMetrics.width,t=this.containerMetrics.height*this.containerMetrics.height,n=1.1*Math.min(Math.sqrt(e+t),ns.MAX_RADIUS)+5,i=1.1-n/ns.MAX_RADIUS*.2,r=this.mouseInteractionSeconds/i,s=n*(1-Math.pow(80,-r));return Math.abs(s)},get opacity(){return this.mouseUpStart?Math.max(0,this.initialOpacity-this.mouseUpElapsedSeconds*this.opacityDecayVelocity):this.initialOpacity},get outerOpacity(){var e=.3*this.mouseUpElapsedSeconds,t=this.opacity;return Math.max(0,Math.min(e,t))},get isOpacityFullyDecayed(){return this.opacity<.01&&this.radius>=Math.min(this.maxRadius,ns.MAX_RADIUS)},get isRestingAtMaxRadius(){return this.opacity>=this.initialOpacity&&this.radius>=Math.min(this.maxRadius,ns.MAX_RADIUS)},get isAnimationComplete(){return this.mouseUpStart?this.isOpacityFullyDecayed:this.isRestingAtMaxRadius},get translationFraction(){return Math.min(1,this.radius/this.containerMetrics.size*2/Math.sqrt(2))},get xNow(){return this.xEnd?this.xStart+this.translationFraction*(this.xEnd-this.xStart):this.xStart},get yNow(){return this.yEnd?this.yStart+this.translationFraction*(this.yEnd-this.yStart):this.yStart},get isMouseDown(){return this.mouseDownStart&&!this.mouseUpStart},resetInteractionState:function(){this.maxRadius=0,this.mouseDownStart=0,this.mouseUpStart=0,this.xStart=0,this.yStart=0,this.xEnd=0,this.yEnd=0,this.slideDistance=0,this.containerMetrics=new ts(this.element)},draw:function(){var e,t,n;this.wave.style.opacity=this.opacity,e=this.radius/(this.containerMetrics.size/2),t=this.xNow-this.containerMetrics.width/2,n=this.yNow-this.containerMetrics.height/2,this.waveContainer.style.webkitTransform="translate("+t+"px, "+n+"px)",this.waveContainer.style.transform="translate3d("+t+"px, "+n+"px, 0)",this.wave.style.webkitTransform="scale("+e+","+e+")",this.wave.style.transform="scale3d("+e+","+e+",1)"},downAction:function(e){var t=this.containerMetrics.width/2,n=this.containerMetrics.height/2;this.resetInteractionState(),this.mouseDownStart=es.now(),this.center?(this.xStart=t,this.yStart=n,this.slideDistance=es.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)):(this.xStart=e?e.detail.x-this.containerMetrics.boundingRect.left:this.containerMetrics.width/2,this.yStart=e?e.detail.y-this.containerMetrics.boundingRect.top:this.containerMetrics.height/2),this.recenters&&(this.xEnd=t,this.yEnd=n,this.slideDistance=es.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)),this.maxRadius=this.containerMetrics.furthestCornerDistanceFrom(this.xStart,this.yStart),this.waveContainer.style.top=(this.containerMetrics.height-this.containerMetrics.size)/2+"px",this.waveContainer.style.left=(this.containerMetrics.width-this.containerMetrics.size)/2+"px",this.waveContainer.style.width=this.containerMetrics.size+"px",this.waveContainer.style.height=this.containerMetrics.size+"px"},upAction:function(e){this.isMouseDown&&(this.mouseUpStart=es.now())},remove:function(){ki(ki(this.waveContainer).parentNode).removeChild(this.waveContainer)}},Xi({_template:lr`<style>:host{display:block;position:absolute;border-radius:inherit;overflow:hidden;top:0;left:0;right:0;bottom:0;pointer-events:none}:host([animating]){-webkit-transform:translate(0,0);transform:translate3d(0,0,0)}#background,#waves,.wave,.wave-container{pointer-events:none;position:absolute;top:0;left:0;width:100%;height:100%}#background,.wave{opacity:0}#waves,.wave{overflow:hidden}.wave,.wave-container{border-radius:50%}:host(.circle) #background,:host(.circle) #waves{border-radius:50%}:host(.circle) .wave-container{overflow:hidden}</style><div id="background"></div><div id="waves"></div>`,is:"paper-ripple",behaviors:[jr],properties:{initialOpacity:{type:Number,value:.25},opacityDecayVelocity:{type:Number,value:.8},recenters:{type:Boolean,value:!1},center:{type:Boolean,value:!1},ripples:{type:Array,value:function(){return[]}},animating:{type:Boolean,readOnly:!0,reflectToAttribute:!0,value:!1},holdDown:{type:Boolean,value:!1,observer:"_holdDownChanged"},noink:{type:Boolean,value:!1},_animating:{type:Boolean},_boundAnimate:{type:Function,value:function(){return this.animate.bind(this)}}},get target(){return this.keyEventTarget},keyBindings:{"enter:keydown":"_onEnterKeydown","space:keydown":"_onSpaceKeydown","space:keyup":"_onSpaceKeyup"},attached:function(){11==ki(this).parentNode.nodeType?this.keyEventTarget=ki(this).getOwnerRoot().host:this.keyEventTarget=ki(this).parentNode;var e=this.keyEventTarget;this.listen(e,"up","uiUpAction"),this.listen(e,"down","uiDownAction")},detached:function(){this.unlisten(this.keyEventTarget,"up","uiUpAction"),this.unlisten(this.keyEventTarget,"down","uiDownAction"),this.keyEventTarget=null},get shouldKeepAnimating(){for(var e=0;e<this.ripples.length;++e)if(!this.ripples[e].isAnimationComplete)return!0;return!1},simulatedRipple:function(){this.downAction(null),this.async((function(){this.upAction()}),1)},uiDownAction:function(e){this.noink||this.downAction(e)},downAction:function(e){this.holdDown&&this.ripples.length>0||(this.addRipple().downAction(e),this._animating||(this._animating=!0,this.animate()))},uiUpAction:function(e){this.noink||this.upAction(e)},upAction:function(e){this.holdDown||(this.ripples.forEach((function(t){t.upAction(e)})),this._animating=!0,this.animate())},onAnimationComplete:function(){this._animating=!1,this.$.background.style.backgroundColor="",this.fire("transitionend")},addRipple:function(){var e=new ns(this);return ki(this.$.waves).appendChild(e.waveContainer),this.$.background.style.backgroundColor=e.color,this.ripples.push(e),this._setAnimating(!0),e},removeRipple:function(e){var t=this.ripples.indexOf(e);t<0||(this.ripples.splice(t,1),e.remove(),this.ripples.length||this._setAnimating(!1))},animate:function(){if(this._animating){var e,t;for(e=0;e<this.ripples.length;++e)(t=this.ripples[e]).draw(),this.$.background.style.opacity=t.outerOpacity,t.isOpacityFullyDecayed&&!t.isRestingAtMaxRadius&&this.removeRipple(t);this.shouldKeepAnimating||0!==this.ripples.length?window.requestAnimationFrame(this._boundAnimate):this.onAnimationComplete()}},animateRipple:function(){return this.animate()},_onEnterKeydown:function(){this.uiDownAction(),this.async(this.uiUpAction,1)},_onSpaceKeydown:function(){this.uiDownAction()},_onSpaceKeyup:function(){this.uiUpAction()},_holdDownChanged:function(e,t){void 0!==t&&(e?this.downAction():this.upAction())}});
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const is={properties:{noink:{type:Boolean,observer:"_noinkChanged"},_rippleContainer:{type:Object}},_buttonStateChanged:function(){this.focused&&this.ensureRipple()},_downHandler:function(e){Jr._downHandler.call(this,e),this.pressed&&this.ensureRipple(e)},ensureRipple:function(e){if(!this.hasRipple()){this._ripple=this._createRipple(),this._ripple.noink=this.noink;var t=this._rippleContainer||this.root;if(t&&ki(t).appendChild(this._ripple),e){var n=ki(this._rippleContainer||this),i=ki(e).rootTarget;n.deepContains(i)&&this._ripple.uiDownAction(e)}}},getRipple:function(){return this.ensureRipple(),this._ripple},hasRipple:function(){return Boolean(this._ripple)},_createRipple:function(){return document.createElement("paper-ripple")},_noinkChanged:function(e){this.hasRipple()&&(this._ripple.noink=e)}},rs={observers:["_focusedChanged(receivedFocusFromKeyboard)"],_focusedChanged:function(e){e&&this.ensureRipple(),this.hasRipple()&&(this._ripple.holdDown=e)},_createRipple:function(){var e=is._createRipple();return e.id="ink",e.setAttribute("center",""),e.classList.add("circle"),e}},ss=[[Kr,qr,is,rs],Yr,{_checkedChanged:function(){Hr._checkedChanged.call(this),this.hasRipple()&&(this.checked?this._ripple.setAttribute("checked",""):this._ripple.removeAttribute("checked"))},_buttonStateChanged:function(){is._buttonStateChanged.call(this),this.disabled||this.isAttached&&(this.checked=this.active)}}],os=lr`<style>:host{display:inline-block;white-space:nowrap;cursor:pointer;--calculated-paper-checkbox-size:var(--paper-checkbox-size, 18px);--calculated-paper-checkbox-ink-size:var(--paper-checkbox-ink-size, -1px);@apply --paper-font-common-base;line-height:0;-webkit-tap-highlight-color:transparent}:host([hidden]){display:none!important}:host(:focus){outline:0}.hidden{display:none}#checkboxContainer{display:inline-block;position:relative;width:var(--calculated-paper-checkbox-size);height:var(--calculated-paper-checkbox-size);min-width:var(--calculated-paper-checkbox-size);margin:var(--paper-checkbox-margin,initial);vertical-align:var(--paper-checkbox-vertical-align,middle);background-color:var(--paper-checkbox-unchecked-background-color,transparent)}#ink{position:absolute;top:calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size))/ 2);left:calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size))/ 2);width:var(--calculated-paper-checkbox-ink-size);height:var(--calculated-paper-checkbox-ink-size);color:var(--paper-checkbox-unchecked-ink-color,var(--primary-text-color));opacity:.6;pointer-events:none}#ink:dir(rtl){right:calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size))/ 2);left:auto}#ink[checked]{color:var(--paper-checkbox-checked-ink-color,var(--primary-color))}#checkbox{position:relative;box-sizing:border-box;height:100%;border:solid 2px;border-color:var(--paper-checkbox-unchecked-color,var(--primary-text-color));border-radius:2px;pointer-events:none;-webkit-transition:background-color 140ms,border-color 140ms;transition:background-color 140ms,border-color 140ms;-webkit-transition-duration:var(--paper-checkbox-animation-duration,140ms);transition-duration:var(--paper-checkbox-animation-duration,140ms)}#checkbox.checked #checkmark{-webkit-animation:checkmark-expand 140ms ease-out forwards;animation:checkmark-expand 140ms ease-out forwards;-webkit-animation-duration:var(--paper-checkbox-animation-duration,140ms);animation-duration:var(--paper-checkbox-animation-duration,140ms)}@-webkit-keyframes checkmark-expand{0%{-webkit-transform:scale(0,0) rotate(45deg)}100%{-webkit-transform:scale(1,1) rotate(45deg)}}@keyframes checkmark-expand{0%{transform:scale(0,0) rotate(45deg)}100%{transform:scale(1,1) rotate(45deg)}}#checkbox.checked{background-color:var(--paper-checkbox-checked-color,var(--primary-color));border-color:var(--paper-checkbox-checked-color,var(--primary-color))}#checkmark{position:absolute;width:36%;height:70%;border-style:solid;border-top:none;border-left:none;border-right-width:calc(2/15 * var(--calculated-paper-checkbox-size));border-bottom-width:calc(2/15 * var(--calculated-paper-checkbox-size));border-color:var(--paper-checkbox-checkmark-color,#fff);-webkit-transform-origin:97% 86%;transform-origin:97% 86%;box-sizing:content-box}#checkmark:dir(rtl){-webkit-transform-origin:50% 14%;transform-origin:50% 14%}#checkboxLabel{position:relative;display:inline-block;vertical-align:middle;padding-left:var(--paper-checkbox-label-spacing,8px);white-space:normal;line-height:normal;color:var(--paper-checkbox-label-color,var(--primary-text-color));@apply --paper-checkbox-label;}:host([checked]) #checkboxLabel{color:var(--paper-checkbox-label-checked-color,var(--paper-checkbox-label-color,var(--primary-text-color)));@apply --paper-checkbox-label-checked;}#checkboxLabel:dir(rtl){padding-right:var(--paper-checkbox-label-spacing,8px);padding-left:0}#checkboxLabel[hidden]{display:none}:host([disabled]) #checkbox{opacity:.5;border-color:var(--paper-checkbox-unchecked-color,var(--primary-text-color))}:host([disabled][checked]) #checkbox{background-color:var(--paper-checkbox-unchecked-color,var(--primary-text-color));opacity:.5}:host([disabled]) #checkboxLabel{opacity:.65}#checkbox.invalid:not(.checked){border-color:var(--paper-checkbox-error-color,var(--error-color))}</style><div id="checkboxContainer"><div id="checkbox" class$="[[_computeCheckboxClass(checked, invalid)]]"><div id="checkmark" class$="[[_computeCheckmarkClass(checked)]]"></div></div></div><div id="checkboxLabel"><slot></slot></div>`;
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/os.setAttribute("strip-whitespace",""),Xi({_template:os,is:"paper-checkbox",behaviors:[ss],hostAttributes:{role:"checkbox","aria-checked":!1,tabindex:0},properties:{ariaActiveAttribute:{type:String,value:"aria-checked"}},attached:function(){var e,t,n;e=this,t=function(){if("-1px"===this.getComputedStyleValue("--calculated-paper-checkbox-ink-size").trim()){var e=this.getComputedStyleValue("--calculated-paper-checkbox-size").trim(),t="px",n=e.match(/[A-Za-z]+$/);null!==n&&(t=n[0]);var i=parseFloat(e),r=8/3*i;"px"===t&&(r=Math.floor(r))%2!=i%2&&r++,this.updateStyles({"--paper-checkbox-ink-size":r+t})}},ri||ai(),oi.push([e,t,n])},_computeCheckboxClass:function(e,t){var n="";return e&&(n+="checked "),t&&(n+="invalid"),n},_computeCheckmarkClass:function(e){return e?"":"hidden"},_createRipple:function(){return this._rippleContainer=this.$.checkboxContainer,rs._createRipple.call(this)}});
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const as=lr`<custom-style><style is="custom-style">html{--shadow-transition:{transition:box-shadow .28s cubic-bezier(.4,0,.2,1)};--shadow-none:{box-shadow:none};--shadow-elevation-2dp:{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2)};--shadow-elevation-3dp:{box-shadow:0 3px 4px 0 rgba(0,0,0,.14),0 1px 8px 0 rgba(0,0,0,.12),0 3px 3px -2px rgba(0,0,0,.4)};--shadow-elevation-4dp:{box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4)};--shadow-elevation-6dp:{box-shadow:0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12),0 3px 5px -1px rgba(0,0,0,.4)};--shadow-elevation-8dp:{box-shadow:0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12),0 5px 5px -3px rgba(0,0,0,.4)};--shadow-elevation-12dp:{box-shadow:0 12px 16px 1px rgba(0,0,0,.14),0 4px 22px 3px rgba(0,0,0,.12),0 6px 7px -4px rgba(0,0,0,.4)};--shadow-elevation-16dp:{box-shadow:0 16px 24px 2px rgba(0,0,0,.14),0 6px 30px 5px rgba(0,0,0,.12),0 8px 10px -5px rgba(0,0,0,.4)};--shadow-elevation-24dp:{box-shadow:0 24px 38px 3px rgba(0,0,0,.14),0 9px 46px 8px rgba(0,0,0,.12),0 11px 15px -7px rgba(0,0,0,.4)};}</style></custom-style>`;as.setAttribute("style","display: none;"),document.head.appendChild(as.content);
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const ls=lr`<dom-module id="paper-material-styles"><template><style>html{--paper-material:{display:block;position:relative};--paper-material-elevation-1:{@apply --shadow-elevation-2dp;};--paper-material-elevation-2:{@apply --shadow-elevation-4dp;};--paper-material-elevation-3:{@apply --shadow-elevation-6dp;};--paper-material-elevation-4:{@apply --shadow-elevation-8dp;};--paper-material-elevation-5:{@apply --shadow-elevation-16dp;};}.paper-material{@apply --paper-material;}.paper-material[elevation="1"]{@apply --paper-material-elevation-1;}.paper-material[elevation="2"]{@apply --paper-material-elevation-2;}.paper-material[elevation="3"]{@apply --paper-material-elevation-3;}.paper-material[elevation="4"]{@apply --paper-material-elevation-4;}.paper-material[elevation="5"]{@apply --paper-material-elevation-5;}:host{--paper-material:{display:block;position:relative};--paper-material-elevation-1:{@apply --shadow-elevation-2dp;};--paper-material-elevation-2:{@apply --shadow-elevation-4dp;};--paper-material-elevation-3:{@apply --shadow-elevation-6dp;};--paper-material-elevation-4:{@apply --shadow-elevation-8dp;};--paper-material-elevation-5:{@apply --shadow-elevation-16dp;};}:host(.paper-material){@apply --paper-material;}:host(.paper-material[elevation="1"]){@apply --paper-material-elevation-1;}:host(.paper-material[elevation="2"]){@apply --paper-material-elevation-2;}:host(.paper-material[elevation="3"]){@apply --paper-material-elevation-3;}:host(.paper-material[elevation="4"]){@apply --paper-material-elevation-4;}:host(.paper-material[elevation="5"]){@apply --paper-material-elevation-5;}</style></template></dom-module>`;ls.setAttribute("style","display: none;"),document.head.appendChild(ls.content);
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const hs={properties:{elevation:{type:Number,reflectToAttribute:!0,readOnly:!0}},observers:["_calculateElevation(focused, disabled, active, pressed, receivedFocusFromKeyboard)","_computeKeyboardClass(receivedFocusFromKeyboard)"],hostAttributes:{role:"button",tabindex:"0",animated:!0},_calculateElevation:function(){var e=1;this.disabled?e=0:this.active||this.pressed?e=4:this.receivedFocusFromKeyboard&&(e=3),this._setElevation(e)},_computeKeyboardClass:function(e){this.toggleClass("keyboard-focus",e)},_spaceKeyDownHandler:function(e){Jr._spaceKeyDownHandler.call(this,e),this.hasRipple()&&this.getRipple().ripples.length<1&&this._ripple.uiDownAction()},_spaceKeyUpHandler:function(e){Jr._spaceKeyUpHandler.call(this,e),this.hasRipple()&&this._ripple.uiUpAction()}},cs=[Kr,qr,is,hs],us=lr`<style include="paper-material-styles">:host{@apply --layout-inline;@apply --layout-center-center;position:relative;box-sizing:border-box;min-width:5.14em;margin:0 .29em;background:0 0;-webkit-tap-highlight-color:transparent;-webkit-tap-highlight-color:transparent;font:inherit;text-transform:uppercase;outline-width:0;border-radius:3px;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;user-select:none;cursor:pointer;z-index:0;padding:.7em .57em;@apply --paper-font-common-base;@apply --paper-button;}:host([elevation="1"]){@apply --paper-material-elevation-1;}:host([elevation="2"]){@apply --paper-material-elevation-2;}:host([elevation="3"]){@apply --paper-material-elevation-3;}:host([elevation="4"]){@apply --paper-material-elevation-4;}:host([elevation="5"]){@apply --paper-material-elevation-5;}:host([hidden]){display:none!important}:host([raised].keyboard-focus){font-weight:700;@apply --paper-button-raised-keyboard-focus;}:host(:not([raised]).keyboard-focus){font-weight:700;@apply --paper-button-flat-keyboard-focus;}:host([disabled]){background:0 0;color:#a8a8a8;cursor:auto;pointer-events:none;@apply --paper-button-disabled;}:host([disabled][raised]){background:#eaeaea}:host([animated]){@apply --shadow-transition;}paper-ripple{color:var(--paper-button-ink-color)}</style><slot></slot>`;us.setAttribute("strip-whitespace",""),Xi({_template:us,is:"paper-button",behaviors:[cs],properties:{raised:{type:Boolean,reflectToAttribute:!0,value:!1,observer:"_calculateElevation"}},_calculateElevation:function(){this.raised?hs._calculateElevation.apply(this):this._setElevation(0)}}),function(e){var t={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:f,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:f,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:f,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n?(?!hr|heading|lheading| {0,3}>|tag)[^\n]+)+)/,text:/^[^\n]+/};function n(e){this.tokens=[],this.tokens.links={},this.options=e||g.defaults,this.rules=t.normal,this.options.gfm&&(this.options.tables?this.rules=t.tables:this.rules=t.gfm)}t._label=/(?:\\[\[\]]|[^\[\]])+/,t._title=/(?:"(?:\\"|[^"]|"[^"\n]*")*"|'\n?(?:[^'\n]+\n?)*'|\([^()]*\))/,t.def=c(t.def).replace("label",t._label).replace("title",t._title).getRegex(),t.bullet=/(?:[*+-]|\d+\.)/,t.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,t.item=c(t.item,"gm").replace(/bull/g,t.bullet).getRegex(),t.list=c(t.list).replace(/bull/g,t.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+t.def.source+")").getRegex(),t._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b",t.html=c(t.html).replace("comment",/<!--[\s\S]*?-->/).replace("closed",/<(tag)[\s\S]+?<\/\1>/).replace("closing",/<tag(?:"[^"]*"|'[^']*'|\s[^'"\/>\s]*)*?\/?>/).replace(/tag/g,t._tag).getRegex(),t.paragraph=c(t.paragraph).replace("hr",t.hr).replace("heading",t.heading).replace("lheading",t.lheading).replace("tag","<"+t._tag).getRegex(),t.blockquote=c(t.blockquote).replace("paragraph",t.paragraph).getRegex(),t.normal=m({},t),t.gfm=m({},t.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\n? *\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),t.gfm.paragraph=c(t.paragraph).replace("(?!","(?!"+t.gfm.fences.source.replace("\\1","\\2")+"|"+t.list.source.replace("\\1","\\3")+"|").getRegex(),t.tables=m({},t.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),n.rules=t,n.lex=function(e,t){return new n(t).lex(e)},n.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},n.prototype.token=function(e,n){var i,r,s,o,a,l,h,c,u,d,p;for(e=e.replace(/^ +$/gm,"");e;)if((s=this.rules.newline.exec(e))&&(e=e.substring(s[0].length),s[0].length>1&&this.tokens.push({type:"space"})),s=this.rules.code.exec(e))e=e.substring(s[0].length),s=s[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?s:s.replace(/\n+$/,"")});else if(s=this.rules.fences.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"code",lang:s[2],text:s[3]||""});else if(s=this.rules.heading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:s[1].length,text:s[2]});else if(n&&(s=this.rules.nptable.exec(e))){for(e=e.substring(s[0].length),l={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/\n$/,"").split("\n")},c=0;c<l.align.length;c++)/^ *-+: *$/.test(l.align[c])?l.align[c]="right":/^ *:-+: *$/.test(l.align[c])?l.align[c]="center":/^ *:-+ *$/.test(l.align[c])?l.align[c]="left":l.align[c]=null;for(c=0;c<l.cells.length;c++)l.cells[c]=l.cells[c].split(/ *\| */);this.tokens.push(l)}else if(s=this.rules.hr.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"hr"});else if(s=this.rules.blockquote.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"blockquote_start"}),s=s[0].replace(/^ *> ?/gm,""),this.token(s,n),this.tokens.push({type:"blockquote_end"});else if(s=this.rules.list.exec(e)){for(e=e.substring(s[0].length),p=(o=s[2]).length>1,this.tokens.push({type:"list_start",ordered:p,start:p?+o:""}),i=!1,d=(s=s[0].match(this.rules.item)).length,c=0;c<d;c++)h=(l=s[c]).length,~(l=l.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(h-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+h+"}","gm"),"")),this.options.smartLists&&c!==d-1&&(o===(a=t.bullet.exec(s[c+1])[0])||o.length>1&&a.length>1||(e=s.slice(c+1).join("\n")+e,c=d-1)),r=i||/\n\n(?!\s*$)/.test(l),c!==d-1&&(i="\n"===l.charAt(l.length-1),r||(r=i)),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(l,!1),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(s=this.rules.html.exec(e))e=e.substring(s[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===s[1]||"script"===s[1]||"style"===s[1]),text:s[0]});else if(n&&(s=this.rules.def.exec(e)))e=e.substring(s[0].length),s[3]&&(s[3]=s[3].substring(1,s[3].length-1)),u=s[1].toLowerCase(),this.tokens.links[u]||(this.tokens.links[u]={href:s[2],title:s[3]});else if(n&&(s=this.rules.table.exec(e))){for(e=e.substring(s[0].length),l={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/(?: *\| *)?\n$/,"").split("\n")},c=0;c<l.align.length;c++)/^ *-+: *$/.test(l.align[c])?l.align[c]="right":/^ *:-+: *$/.test(l.align[c])?l.align[c]="center":/^ *:-+ *$/.test(l.align[c])?l.align[c]="left":l.align[c]=null;for(c=0;c<l.cells.length;c++)l.cells[c]=l.cells[c].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(s=this.rules.lheading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:"="===s[2]?1:2,text:s[1]});else if(n&&(s=this.rules.paragraph.exec(e)))e=e.substring(s[0].length),this.tokens.push({type:"paragraph",text:"\n"===s[1].charAt(s[1].length-1)?s[1].slice(0,-1):s[1]});else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"text",text:s[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var i={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:f,tag:/^<!--[\s\S]*?-->|^<\/?[a-zA-Z0-9\-]+(?:"[^"]*"|'[^']*'|\s[^<'">\/\s]*)*?\/?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^_([^\s_](?:[^_]|__)+?[^\s_])_\b|^\*((?:\*\*|[^*])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`]?)\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:f,text:/^[\s\S]+?(?=[\\<!\[`*]|\b_| {2,}\n|$)/};function r(e,t){if(this.options=t||g.defaults,this.links=e,this.rules=i.normal,this.renderer=this.options.renderer||new s,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=i.breaks:this.rules=i.gfm:this.options.pedantic&&(this.rules=i.pedantic)}function s(e){this.options=e||{}}function o(){}function a(e){this.tokens=[],this.token=null,this.options=e||g.defaults,this.options.renderer=this.options.renderer||new s,this.renderer=this.options.renderer,this.renderer.options=this.options}function l(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function h(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,(function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}function c(e,t){return e=e.source,t=t||"",{replace:function(t,n){return n=(n=n.source||n).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(t,n),this},getRegex:function(){return new RegExp(e,t)}}}function u(e,t){return d[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?d[" "+e]=e+"/":d[" "+e]=e.replace(/[^/]*$/,"")),e=d[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}i._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,i._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,i.autolink=c(i.autolink).replace("scheme",i._scheme).replace("email",i._email).getRegex(),i._inside=/(?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]]|\](?=[^\[]*\]))*/,i._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,i.link=c(i.link).replace("inside",i._inside).replace("href",i._href).getRegex(),i.reflink=c(i.reflink).replace("inside",i._inside).getRegex(),i.normal=m({},i),i.pedantic=m({},i.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),i.gfm=m({},i.normal,{escape:c(i.escape).replace("])","~|])").getRegex(),url:c(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("email",i._email).getRegex(),_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:c(i.text).replace("]|","~]|").replace("|","|https?://|ftp://|www\\.|[a-zA-Z0-9.!#$%&'*+/=?^_`{\\|}~-]+@|").getRegex()}),i.breaks=m({},i.gfm,{br:c(i.br).replace("{2,}","*").getRegex(),text:c(i.gfm.text).replace("{2,}","*").getRegex()}),r.rules=i,r.output=function(e,t,n){return new r(t,n).output(e)},r.prototype.output=function(e){for(var t,n,i,r,s="";e;)if(r=this.rules.escape.exec(e))e=e.substring(r[0].length),s+=r[1];else if(r=this.rules.autolink.exec(e))e=e.substring(r[0].length),i="@"===r[2]?"mailto:"+(n=l(this.mangle(r[1]))):n=l(r[1]),s+=this.renderer.link(i,null,n);else if(this.inLink||!(r=this.rules.url.exec(e))){if(r=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(r[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(r[0])&&(this.inLink=!1),e=e.substring(r[0].length),s+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):l(r[0]):r[0];else if(r=this.rules.link.exec(e))e=e.substring(r[0].length),this.inLink=!0,s+=this.outputLink(r,{href:r[2],title:r[3]}),this.inLink=!1;else if((r=this.rules.reflink.exec(e))||(r=this.rules.nolink.exec(e))){if(e=e.substring(r[0].length),t=(r[2]||r[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){s+=r[0].charAt(0),e=r[0].substring(1)+e;continue}this.inLink=!0,s+=this.outputLink(r,t),this.inLink=!1}else if(r=this.rules.strong.exec(e))e=e.substring(r[0].length),s+=this.renderer.strong(this.output(r[2]||r[1]));else if(r=this.rules.em.exec(e))e=e.substring(r[0].length),s+=this.renderer.em(this.output(r[2]||r[1]));else if(r=this.rules.code.exec(e))e=e.substring(r[0].length),s+=this.renderer.codespan(l(r[2].trim(),!0));else if(r=this.rules.br.exec(e))e=e.substring(r[0].length),s+=this.renderer.br();else if(r=this.rules.del.exec(e))e=e.substring(r[0].length),s+=this.renderer.del(this.output(r[1]));else if(r=this.rules.text.exec(e))e=e.substring(r[0].length),s+=this.renderer.text(l(this.smartypants(r[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else r[0]=this.rules._backpedal.exec(r[0])[0],e=e.substring(r[0].length),"@"===r[2]?i="mailto:"+(n=l(r[0])):(n=l(r[0]),i="www."===r[1]?"http://"+n:n),s+=this.renderer.link(i,null,n);return s},r.prototype.outputLink=function(e,t){var n=l(t.href),i=t.title?l(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,i,this.output(e[1])):this.renderer.image(n,i,l(e[1]))},r.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,""):e},r.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",i=e.length,r=0;r<i;r++)t=e.charCodeAt(r),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},s.prototype.code=function(e,t,n){if(this.options.highlight){var i=this.options.highlight(e,t);null!=i&&i!==e&&(n=!0,e=i)}return t?'<pre><code class="'+this.options.langPrefix+l(t,!0)+'">'+(n?e:l(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:l(e,!0))+"\n</code></pre>"},s.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},s.prototype.html=function(e){return e},s.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},s.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},s.prototype.list=function(e,t,n){var i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+i+">\n"},s.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},s.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},s.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},s.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},s.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},s.prototype.strong=function(e){return"<strong>"+e+"</strong>"},s.prototype.em=function(e){return"<em>"+e+"</em>"},s.prototype.codespan=function(e){return"<code>"+e+"</code>"},s.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},s.prototype.del=function(e){return"<del>"+e+"</del>"},s.prototype.link=function(e,t,n){if(this.options.sanitize){try{var i=decodeURIComponent(h(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return n}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:")||0===i.indexOf("data:"))return n}this.options.baseUrl&&!p.test(e)&&(e=u(this.options.baseUrl,e));var r='<a href="'+e+'"';return t&&(r+=' title="'+t+'"'),r+=">"+n+"</a>"},s.prototype.image=function(e,t,n){this.options.baseUrl&&!p.test(e)&&(e=u(this.options.baseUrl,e));var i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">"},s.prototype.text=function(e){return e},o.prototype.strong=o.prototype.em=o.prototype.codespan=o.prototype.del=o.prototype.text=function(e){return e},o.prototype.link=o.prototype.image=function(e,t,n){return""+n},o.prototype.br=function(){return""},a.parse=function(e,t){return new a(t).parse(e)},a.prototype.parse=function(e){this.inline=new r(e.links,this.options),this.inlineText=new r(e.links,m({},this.options,{renderer:new o})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},a.prototype.next=function(){return this.token=this.tokens.pop()},a.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},a.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},a.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,h(this.inlineText.output(this.token.text)));case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,i,r="",s="";for(n="",e=0;e<this.token.header.length;e++)n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(r+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",i=0;i<t.length;i++)n+=this.renderer.tablecell(this.inline.output(t[i]),{header:!1,align:this.token.align[i]});s+=this.renderer.tablerow(n)}return this.renderer.table(r,s);case"blockquote_start":for(s="";"blockquote_end"!==this.next().type;)s+=this.tok();return this.renderer.blockquote(s);case"list_start":s="";for(var o=this.token.ordered,a=this.token.start;"list_end"!==this.next().type;)s+=this.tok();return this.renderer.list(s,o,a);case"list_item_start":for(s="";"list_item_end"!==this.next().type;)s+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(s);case"loose_item_start":for(s="";"list_item_end"!==this.next().type;)s+=this.tok();return this.renderer.listitem(s);case"html":var l=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(l);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}};var d={},p=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function f(){}function m(e){for(var t,n,i=1;i<arguments.length;i++)for(n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function g(e,t,i){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(i||"function"==typeof t){i||(i=t,t=null);var r,s,o=(t=m({},g.defaults,t||{})).highlight,h=0;try{r=n.lex(e,t)}catch(e){return i(e)}s=r.length;var c=function(e){if(e)return t.highlight=o,i(e);var n;try{n=a.parse(r,t)}catch(t){e=t}return t.highlight=o,e?i(e):i(null,n)};if(!o||o.length<3)return c();if(delete t.highlight,!s)return c();for(;h<r.length;h++)!function(e){"code"!==e.type?--s||c():o(e.text,e.lang,(function(t,n){return t?c(t):null==n||n===e.text?--s||c():(e.text=n,e.escaped=!0,void(--s||c()))}))}(r[h])}else try{return t&&(t=m({},g.defaults,t)),a.parse(n.lex(e,t),t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(t||g.defaults).silent)return"<p>An error occurred:</p><pre>"+l(e.message+"",!0)+"</pre>";throw e}}f.exec=f,g.options=g.setOptions=function(e){return m(g.defaults,e),g},g.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new s,xhtml:!1,baseUrl:null},g.Parser=a,g.parser=a.parse,g.Renderer=s,g.TextRenderer=o,g.Lexer=n,g.lexer=n.lex,g.InlineLexer=r,g.inlineLexer=r.output,g.parse=g,"undefined"!=typeof module&&"object"==typeof exports?module.exports=g:"function"==typeof define&&define.amd?define((function(){return g})):e.marked=g}("undefined"!=typeof window?window:global);var ds=Object.freeze({__proto__:null});
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/window.marked||(window.marked=ds)
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/,Xi({_template:lr`<style>:host{display:block}</style><slot name="markdown-html"><div id="content"></div></slot>`,is:"marked-element",properties:{markdown:{type:String,value:null},breaks:{type:Boolean,value:!1},pedantic:{type:Boolean,value:!1},renderer:{type:Function,value:null},sanitize:{type:Boolean,value:!1},sanitizer:{type:Function,value:null},disableRemoteSanitization:{type:Boolean,value:!1},smartypants:{type:Boolean,value:!1},callback:{type:Function,value:null},xhr:{type:Object,notify:!0,readOnly:!0}},observers:["render(markdown, breaks, pedantic, renderer, sanitize, sanitizer, smartypants, callback)"],ready:function(){this.markdown||(this._markdownElement=ki(this).querySelector('[type="text/markdown"]'),this._markdownElement&&(this._markdownElement.src&&this._request(this._markdownElement.src),""!==this._markdownElement.textContent.trim()&&(this.markdown=this._unindent(this._markdownElement.textContent)),new MutationObserver(this._onScriptAttributeChanged.bind(this)).observe(this._markdownElement,{attributes:!0})))},attached:function(){this._attached=!0,this._outputElement=this.outputElement,this.render()},detached:function(){this._attached=!1},unindent:function(e){return this._unindent(e)},get outputElement(){return ki(this).queryDistributedElements('[slot="markdown-html"]')[0]||this.$.content},render:function(){if(this._attached)if(this.markdown){var e=new marked.Renderer;this.renderer&&this.renderer(e);var t={renderer:e,highlight:this._highlight.bind(this),breaks:this.breaks,sanitize:this.sanitize,sanitizer:this.sanitizer,pedantic:this.pedantic,smartypants:this.smartypants};ki(this._outputElement).innerHTML=marked(this.markdown,t,this.callback),this.fire("marked-render-complete",{},{composed:!0})}else ki(this._outputElement).innerHTML=""},_highlight:function(e,t){return this.fire("syntax-highlight",{code:e,lang:t},{composed:!0}).detail.code||e},_unindent:function(e){if(!e)return e;var t=e.replace(/\t/g,"  ").split("\n"),n=t.reduce((function(e,t){if(/^\s*$/.test(t))return e;var n=t.match(/^(\s*)/)[0].length;return null===e||n<e?n:e}),null);return t.map((function(e){return e.substr(n)})).join("\n")},_request:function(e){this._setXhr(new XMLHttpRequest);var t=this.xhr;if(t.readyState>0)return null;t.addEventListener("error",this._handleError.bind(this)),t.addEventListener("loadend",function(e){var t=this.xhr.status||0;0===t||t>=200&&t<300?(this.sanitize=!this.disableRemoteSanitization,this.markdown=e.target.response):this._handleError(e),this.fire("marked-loadend",e)}.bind(this)),t.open("GET",e),t.setRequestHeader("Accept","text/markdown"),t.send()},_handleError:function(e){this.fire("marked-request-error",e,{cancelable:!0}).defaultPrevented||(this.markdown="Failed loading markdown source")},_onScriptAttributeChanged:function(e){"src"===e[0].attributeName&&this._request(this._markdownElement.src)}});var ps=function(e){var t=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,n=0,i={},r={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof s?new s(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++n}),e.__id},clone:function e(t,n){var i,s;switch(n=n||{},r.util.type(t)){case"Object":if(s=r.util.objId(t),n[s])return n[s];for(var o in i={},n[s]=i,t)t.hasOwnProperty(o)&&(i[o]=e(t[o],n));return i;case"Array":return s=r.util.objId(t),n[s]?n[s]:(i=[],n[s]=i,t.forEach((function(t,r){i[r]=e(t,n)})),i);default:return t}},getLanguage:function(e){for(;e;){var n=t.exec(e.className);if(n)return n[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,n){e.className=e.className.replace(RegExp(t,"gi"),""),e.classList.add("language-"+n)},currentScript:function(){if("undefined"==typeof document)return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(i){var e=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(i.stack)||[])[1];if(e){var t=document.getElementsByTagName("script");for(var n in t)if(t[n].src==e)return t[n]}return null}},isActive:function(e,t,n){for(var i="no-"+t;e;){var r=e.classList;if(r.contains(t))return!0;if(r.contains(i))return!1;e=e.parentElement}return!!n}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(e,t){var n=r.util.clone(r.languages[e]);for(var i in t)n[i]=t[i];return n},insertBefore:function(e,t,n,i){var s=(i=i||r.languages)[e],o={};for(var a in s)if(s.hasOwnProperty(a)){if(a==t)for(var l in n)n.hasOwnProperty(l)&&(o[l]=n[l]);n.hasOwnProperty(a)||(o[a]=s[a])}var h=i[e];return i[e]=o,r.languages.DFS(r.languages,(function(t,n){n===h&&t!=e&&(this[t]=o)})),o},DFS:function e(t,n,i,s){s=s||{};var o=r.util.objId;for(var a in t)if(t.hasOwnProperty(a)){n.call(t,a,t[a],i||a);var l=t[a],h=r.util.type(l);"Object"!==h||s[o(l)]?"Array"!==h||s[o(l)]||(s[o(l)]=!0,e(l,n,a,s)):(s[o(l)]=!0,e(l,n,null,s))}}},plugins:{},highlightAll:function(e,t){r.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,n){var i={callback:n,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};r.hooks.run("before-highlightall",i),i.elements=Array.prototype.slice.apply(i.container.querySelectorAll(i.selector)),r.hooks.run("before-all-elements-highlight",i);for(var s,o=0;s=i.elements[o++];)r.highlightElement(s,!0===t,i.callback)},highlightElement:function(t,n,i){var s=r.util.getLanguage(t),o=r.languages[s];r.util.setLanguage(t,s);var a=t.parentElement;a&&"pre"===a.nodeName.toLowerCase()&&r.util.setLanguage(a,s);var l={element:t,language:s,grammar:o,code:t.textContent};function h(e){l.highlightedCode=e,r.hooks.run("before-insert",l),l.element.innerHTML=l.highlightedCode,r.hooks.run("after-highlight",l),r.hooks.run("complete",l),i&&i.call(l.element)}if(r.hooks.run("before-sanity-check",l),(a=l.element.parentElement)&&"pre"===a.nodeName.toLowerCase()&&!a.hasAttribute("tabindex")&&a.setAttribute("tabindex","0"),!l.code)return r.hooks.run("complete",l),void(i&&i.call(l.element));if(r.hooks.run("before-highlight",l),l.grammar)if(n&&e.Worker){var c=new Worker(r.filename);c.onmessage=function(e){h(e.data)},c.postMessage(JSON.stringify({language:l.language,code:l.code,immediateClose:!0}))}else h(r.highlight(l.code,l.grammar,l.language));else h(r.util.encode(l.code))},highlight:function(e,t,n){var i={code:e,grammar:t,language:n};if(r.hooks.run("before-tokenize",i),!i.grammar)throw new Error('The language "'+i.language+'" has no grammar.');return i.tokens=r.tokenize(i.code,i.grammar),r.hooks.run("after-tokenize",i),s.stringify(r.util.encode(i.tokens),i.language)},tokenize:function(e,t){var n=t.rest;if(n){for(var i in n)t[i]=n[i];delete t.rest}var r=new l;return h(r,r.head,e),a(e,r,t,r.head,0),function(e){var t=[],n=e.head.next;for(;n!==e.tail;)t.push(n.value),n=n.next;return t}(r)},hooks:{all:{},add:function(e,t){var n=r.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=r.hooks.all[e];if(n&&n.length)for(var i,s=0;i=n[s++];)i(t)}},Token:s};function s(e,t,n,i){this.type=e,this.content=t,this.alias=n,this.length=0|(i||"").length}function o(e,t,n,i){e.lastIndex=t;var r=e.exec(n);if(r&&i&&r[1]){var s=r[1].length;r.index+=s,r[0]=r[0].slice(s)}return r}function a(e,t,n,i,l,u){for(var d in n)if(n.hasOwnProperty(d)&&n[d]){var p=n[d];p=Array.isArray(p)?p:[p];for(var f=0;f<p.length;++f){if(u&&u.cause==d+","+f)return;var m=p[f],g=m.inside,O=!!m.lookbehind,y=!!m.greedy,v=m.alias;if(y&&!m.pattern.global){var b=m.pattern.toString().match(/[imsuy]*$/)[0];m.pattern=RegExp(m.pattern.source,b+"g")}for(var w=m.pattern||m,x=i.next,S=l;x!==t.tail&&!(u&&S>=u.reach);S+=x.value.length,x=x.next){var k=x.value;if(t.length>e.length)return;if(!(k instanceof s)){var A,C=1;if(y){if(!(A=o(w,S,e,O))||A.index>=e.length)break;var _=A.index,E=A.index+A[0].length,T=S;for(T+=x.value.length;_>=T;)T+=(x=x.next).value.length;if(S=T-=x.value.length,x.value instanceof s)continue;for(var P=x;P!==t.tail&&(T<E||"string"==typeof P.value);P=P.next)C++,T+=P.value.length;C--,k=e.slice(S,T),A.index-=S}else if(!(A=o(w,0,k,O)))continue;_=A.index;var $=A[0],N=k.slice(0,_),I=k.slice(_+$.length),Q=S+k.length;u&&Q>u.reach&&(u.reach=Q);var R=x.prev;if(N&&(R=h(t,R,N),S+=N.length),c(t,R,C),x=h(t,R,new s(d,g?r.tokenize($,g):$,v,$)),I&&h(t,x,I),C>1){var M={cause:d+","+f,reach:Q};a(e,t,n,x.prev,S,M),u&&M.reach>u.reach&&(u.reach=M.reach)}}}}}}function l(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0}function h(e,t,n){var i=t.next,r={value:n,prev:t,next:i};return t.next=r,i.prev=r,e.length++,r}function c(e,t,n){for(var i=t.next,r=0;r<n&&i!==e.tail;r++)i=i.next;t.next=i,i.prev=t,e.length-=r}if(e.Prism=r,s.stringify=function e(t,n){if("string"==typeof t)return t;if(Array.isArray(t)){var i="";return t.forEach((function(t){i+=e(t,n)})),i}var s={type:t.type,content:e(t.content,n),tag:"span",classes:["token",t.type],attributes:{},language:n},o=t.alias;o&&(Array.isArray(o)?Array.prototype.push.apply(s.classes,o):s.classes.push(o)),r.hooks.run("wrap",s);var a="";for(var l in s.attributes)a+=" "+l+'="'+(s.attributes[l]||"").replace(/"/g,"&quot;")+'"';return"<"+s.tag+' class="'+s.classes.join(" ")+'"'+a+">"+s.content+"</"+s.tag+">"},!e.document)return e.addEventListener?(r.disableWorkerMessageHandler||e.addEventListener("message",(function(t){var n=JSON.parse(t.data),i=n.language,s=n.code,o=n.immediateClose;e.postMessage(r.highlight(s,r.languages[i],i)),o&&e.close()}),!1),r):r;var u=r.util.currentScript();function d(){r.manual||r.highlightAll()}if(u&&(r.filename=u.src,u.hasAttribute("data-manual")&&(r.manual=!0)),!r.manual){var p=document.readyState;"loading"===p||"interactive"===p&&u&&u.defer?document.addEventListener("DOMContentLoaded",d):window.requestAnimationFrame?window.requestAnimationFrame(d):window.setTimeout(d,16)}return r}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});
/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */"undefined"!=typeof module&&module.exports&&(module.exports=ps),"undefined"!=typeof global&&(global.Prism=ps),ps.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},ps.languages.markup.tag.inside["attr-value"].inside.entity=ps.languages.markup.entity,ps.languages.markup.doctype.inside["internal-subset"].inside=ps.languages.markup,ps.hooks.add("wrap",(function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))})),Object.defineProperty(ps.languages.markup.tag,"addInlined",{value:function(e,t){var n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:ps.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var i={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};i["language-"+t]={pattern:/[\s\S]+/,inside:ps.languages[t]};var r={};r[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,(function(){return e})),"i"),lookbehind:!0,greedy:!0,inside:i},ps.languages.insertBefore("markup","cdata",r)}}),Object.defineProperty(ps.languages.markup.tag,"addAttribute",{value:function(e,t){ps.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:ps.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),ps.languages.html=ps.languages.markup,ps.languages.mathml=ps.languages.markup,ps.languages.svg=ps.languages.markup,ps.languages.xml=ps.languages.extend("markup",{}),ps.languages.ssml=ps.languages.xml,ps.languages.atom=ps.languages.xml,ps.languages.rss=ps.languages.xml,function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))}(ps),ps.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},ps.languages.javascript=ps.languages.extend("clike",{"class-name":[ps.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),ps.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,ps.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)\/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/,lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:ps.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:ps.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:ps.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:ps.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:ps.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),ps.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:ps.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),ps.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),ps.languages.markup&&(ps.languages.markup.tag.addInlined("script","javascript"),ps.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),ps.languages.js=ps.languages.javascript,function(){if(void 0!==ps&&"undefined"!=typeof document){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var e={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},t="data-src-status",n="loading",i="loaded",r='pre[data-src]:not([data-src-status="loaded"]):not([data-src-status="loading"])';ps.hooks.add("before-highlightall",(function(e){e.selector+=", "+r})),ps.hooks.add("before-sanity-check",(function(s){var o=s.element;if(o.matches(r)){s.code="",o.setAttribute(t,n);var a=o.appendChild(document.createElement("CODE"));a.textContent="Loading";var l=o.getAttribute("data-src"),h=s.language;if("none"===h){var c=(/\.(\w+)$/.exec(l)||[,"none"])[1];h=e[c]||c}ps.util.setLanguage(a,h),ps.util.setLanguage(o,h);var u=ps.plugins.autoloader;u&&u.loadLanguages(h),function(e,t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=function(){4==i.readyState&&(i.status<400&&i.responseText?t(i.responseText):i.status>=400?n(" Error "+i.status+" while fetching file: "+i.statusText):n(" Error: File does not exist or is empty"))},i.send(null)}(l,(function(e){o.setAttribute(t,i);var n=function(e){var t=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(e||"");if(t){var n=Number(t[1]),i=t[2],r=t[3];return i?r?[n,Number(r)]:[n,void 0]:[n,n]}}(o.getAttribute("data-range"));if(n){var r=e.split(/\r\n?|\n/g),s=n[0],l=null==n[1]?r.length:n[1];s<0&&(s+=r.length),s=Math.max(0,Math.min(s-1,r.length)),l<0&&(l+=r.length),l=Math.max(0,Math.min(l,r.length)),e=r.slice(s,l).join("\n"),o.hasAttribute("data-start")||o.setAttribute("data-start",String(s+1))}a.textContent=e,ps.highlightElement(a)}),(function(e){o.setAttribute(t,"failed"),a.textContent=e}))}})),ps.plugins.fileHighlight={highlight:function(e){for(var t,n=(e||document).querySelectorAll(r),i=0;t=n[i++];)ps.highlightElement(t)}},ps.fileHighlight=function(){ps.plugins.fileHighlight.highlight.apply(this,arguments)}}}();Xi({is:"prism-highlighter",properties:{languages:{type:Object,value:function(){return{}}}},ready:function(){this._handler=this._highlight.bind(this)},attached:function(){(this.parentNode.host||this.parentElement).addEventListener("syntax-highlight",this._handler)},detached:function(){(this.parentNode.host||this.parentElement).removeEventListener("syntax-highlight",this._handler)},_highlight:function(e){if(e.detail&&e.detail.code){e.stopPropagation();var t=e.detail;t.code=Prism.highlight(t.code,this._detectLang(t.code,t.lang))}else br._warn("Malformed","syntax-highlight","event:",e.detail)},_detectLang:function(e,t){if(!t)return e.match(/^\s*</)?Prism.languages.markup:Prism.languages.javascript;if(this.languages[t])return this.languages[t];if(Prism.languages[t])return Prism.languages[t];switch(t.substr(0,2)){case"js":case"es":return Prism.languages.javascript;case"c":return Prism.languages.clike;default:return Prism.languages.markup}}});
/**
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const fs=lr`<dom-module id="prism-theme-default"><template><style>code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style></template></dom-module>`;document.head.appendChild(fs.content),
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
Xi({_template:lr`<style include="prism-theme-default">:host{display:block;@apply --demo-snippet;}.demo{display:block;background:rgba(240,245,255,.5) margin: 0;padding:1rem;@apply --demo-snippet-demo;display:flex;align-items:center;flex-wrap:wrap}:host(.nodemo) .demo{display:none}.code-container{margin:0;font-size:13px;overflow:auto;padding:0 20px;z-index:-1;@apply --demo-snippet-code;margin-bottom:1rem}:host(.nodemo) .code-container{padding:1rem 1rem 0 1rem}.code{margin:0;background-color:var(--google-grey-100);font-size:.9rem;overflow:auto;@apply --demo-snippet-code;padding:0 1rem}.code>pre{margin:0;padding:0 0 10px 0;background:0 0}button{position:absolute;top:0;right:0;text-transform:uppercase;border:none;cursor:pointer;background:#e0e0e0}</style><prism-highlighter></prism-highlighter><div class="demo"><slot id="content"></slot></div><div class="code-container"><marked-element markdown="[[_markdown]]" id="marked"><div class="code" slot="markdown-html" id="code"></div></marked-element></div>`,is:"demo-snippet",properties:{_markdown:{type:String}},attached:function(){this._observer=ki(this.$.content).observeNodes(function(e){this._updateMarkdown()}.bind(this))},detached:function(){this._observer&&(ki(this.$.content).unobserveNodes(this._observer),this._observer=null)},_updateMarkdown:function(){var e=ki(this).queryDistributedElements("template")[0];if(e){var t=this.$.marked.unindent(e.innerHTML);t=(t=t.replace(/ class=""/g,"")).replace(/=""/g,""),this._markdown="```\n"+t+"\n```",e.hasAttribute("is")||(ki(this.$.content).unobserveNodes(this._observer),this._observer=null,ki(this).appendChild(document.importNode(e.content,!0))),this.dispatchEvent(new CustomEvent("dom-ready"))}else this._markdown=""},_copyToClipboard:function(){var e=document.createRange();e.selectNodeContents(this.$.code);var t=window.getSelection();t.removeAllRanges(),t.addRange(e);var n=!1;try{n=document.execCommand("copy"),this.$.copyButton.textContent="done"}catch(e){this.$.copyButton.textContent="error"}return setTimeout(this._resetCopyButtonState.bind(this),1e3),t.removeAllRanges(),n},_resetCopyButtonState:function(){this.$.copyButton.textContent="copy"}});
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const ms=lr`<dom-module id="demo-pages-shared-styles"><template><style>body{font-family:Roboto,Noto,sans-serif;font-size:14px;margin:0;padding:24px;background-color:#fafafa}.horizontal-section-container{@apply --layout-horizontal;@apply --layout-center-justified;@apply --layout-wrap;}.vertical-section-container{@apply --layout-vertical;@apply --center-justified;}.centered{max-width:600px;margin-left:auto;margin-right:auto}demo-snippet.centered-demo{--demo-snippet-demo:{@apply --layout-horizontal;@apply --layout-wrap;@apply --layout-center-justified;};}</style></template></dom-module>`;function gs(e,t,n,i){const r={op:t,func:n,data:i};return e.push(r),r}function Os(e,t){return e}ms.setAttribute("style","display: none;"),document.head.appendChild(ms.content),(()=>{var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i,a=class{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){let i=[];return this.decompose(0,e,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(t,this.length,i,1),h.from(i,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let n=[];return this.decompose(e,t,n,0),h.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),i=new d(this),r=new d(e);for(let e=t,s=t;;){if(i.next(e),r.next(e),e=0,i.lineBreak!=r.lineBreak||i.done!=r.done||i.value!=r.value)return!1;if(s+=i.value.length,i.done||s>=n)return!0}}iter(e=1){return new d(this,e)}iterRange(e,t=this.length){return new p(this,e,t)}iterLines(e,t){let n;if(null==e)n=this.iter();else{null==t&&(t=this.lines+1);let i=this.line(e).from;n=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new f(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(0==e.length)throw new RangeError("A document must have at least one line");return 1!=e.length||e[0]?e.length<=32?new l(e):h.from(l.split(e,[])):a.empty}},l=class extends a{constructor(e,t=function(e){let t=-1;for(let n of e)t+=n.length+1;return t}(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,i){for(let r=0;;r++){let s=this.text[r],o=i+s.length;if((t?n:o)>=e)return new m(i,o,n,s);i=o+1,n++}}decompose(e,t,n,i){let r=e<=0&&t>=this.length?this:new l(u(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(1&i){let e=n.pop(),t=c(r.text,e.text.slice(),0,r.length);if(t.length<=32)n.push(new l(t,e.length+r.length));else{let e=t.length>>1;n.push(new l(t.slice(0,e)),new l(t.slice(e)))}}else n.push(r)}replace(e,t,n){if(!(n instanceof l))return super.replace(e,t,n);let i=c(this.text,c(n.text,u(this.text,0,e)),t),r=this.length+n.length-(t-e);return i.length<=32?new l(i,r):h.from(l.split(i,[]),r)}sliceString(e,t=this.length,n="\n"){let i="";for(let r=0,s=0;r<=t&&s<this.text.length;s++){let o=this.text[s],a=r+o.length;r>e&&s&&(i+=n),e<a&&t>r&&(i+=o.slice(Math.max(0,e-r),t-r)),r=a+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],i=-1;for(let r of e)n.push(r),i+=r.length+1,32==n.length&&(t.push(new l(n,i)),n=[],i=-1);return i>-1&&t.push(new l(n,i)),t}},h=class extends a{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let t of e)this.lines+=t.lines}lineInner(e,t,n,i){for(let r=0;;r++){let s=this.children[r],o=i+s.length,a=n+s.lines-1;if((t?a:o)>=e)return s.lineInner(e,t,n,i);i=o+1,n=a+1}}decompose(e,t,n,i){for(let r=0,s=0;s<=t&&r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(e<=a&&t>=s){let r=i&((s<=e?1:0)|(a>=t?2:0));s>=e&&a<=t&&!r?n.push(o):o.decompose(e-s,t-s,n,r)}s=a+1}}replace(e,t,n){if(n.lines<this.lines)for(let i=0,r=0;i<this.children.length;i++){let s=this.children[i],o=r+s.length;if(e>=r&&t<=o){let a=s.replace(e-r,t-r,n),l=this.lines-s.lines+a.lines;if(a.lines<l>>4&&a.lines>l>>6){let r=this.children.slice();return r[i]=a,new h(r,this.length-(t-e)+n.length)}return super.replace(r,o,a)}r=o+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n="\n"){let i="";for(let r=0,s=0;r<this.children.length&&s<=t;r++){let o=this.children[r],a=s+o.length;s>e&&r&&(i+=n),e<a&&t>s&&(i+=o.sliceString(e-s,t-s,n)),s=a+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof h))return 0;let n=0,[i,r,s,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,r+=t){if(i==s||r==o)return n;let a=this.children[i],l=e.children[r];if(a!=l)return n+a.scanIdentical(l,t);n+=a.length+1}}static from(e,t=e.reduce(((e,t)=>e+t.length+1),-1)){let n=0;for(let t of e)n+=t.lines;if(n<32){let n=[];for(let t of e)t.flatten(n);return new l(n,t)}let i=Math.max(32,n>>5),r=i<<1,s=i>>1,o=[],a=0,c=-1,u=[];function d(e){let t;if(e.lines>r&&e instanceof h)for(let t of e.children)d(t);else e.lines>s&&(a>s||!a)?(p(),o.push(e)):e instanceof l&&a&&(t=u[u.length-1])instanceof l&&e.lines+t.lines<=32?(a+=e.lines,c+=e.length+1,u[u.length-1]=new l(t.text.concat(e.text),t.length+1+e.length)):(a+e.lines>i&&p(),a+=e.lines,c+=e.length+1,u.push(e))}function p(){0!=a&&(o.push(1==u.length?u[0]:h.from(u,c)),c=-1,a=u.length=0)}for(let t of e)d(t);return p(),1==o.length?o[0]:new h(o,t)}};function c(e,t,n=0,i=1e9){for(let r=0,s=0,o=!0;s<e.length&&r<=i;s++){let a=e[s],l=r+a.length;l>=n&&(l>i&&(a=a.slice(0,i-r)),r<n&&(a=a.slice(n-r)),o?(t[t.length-1]+=a,o=!1):t.push(a)),r=l+1}return t}function u(e,t,n){return c(e,[""],t,n)}a.empty=new l([""],0);var d=class{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof l?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],r=this.offsets[n],s=r>>1,o=i instanceof l?i.text.length:i.children.length;if(s==(t>0?o:0)){if(0==n)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(t>0?0:1)){if(this.offsets[n]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--}else if(i instanceof l){let r=i.text[s+(t<0?-1:0)];if(this.offsets[n]+=t,r.length>Math.max(0,e))return this.value=0==e?r:t>0?r.slice(e):r.slice(0,r.length-e),this;e-=r.length}else{let r=i.children[s+(t<0?-1:0)];e>r.length?(e-=r.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(r),this.offsets.push(t>0?1:(r instanceof l?r.text.length:r.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}},p=class{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new d(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=n?i:t<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}},f=class{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:i}=this.inner.next(e);return t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}};typeof Symbol<"u"&&(a.prototype[Symbol.iterator]=function(){return this.iter()},d.prototype[Symbol.iterator]=p.prototype[Symbol.iterator]=f.prototype[Symbol.iterator]=function(){return this});var m=class{constructor(e,t,n,i){this.from=e,this.to=t,this.number=n,this.text=i}get length(){return this.to-this.from}},g="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((e=>e?parseInt(e,36):1));for(let e=1;e<g.length;e++)g[e]+=g[e-1];function O(e){for(let t=1;t<g.length;t+=2)if(g[t]>e)return g[t-1]<=e;return!1}function y(e){return e>=127462&&e<=127487}function v(e,t,n=!0,i=!0){return(n?b:w)(e,t,i)}function b(e,t,n){if(t==e.length)return t;t&&x(e.charCodeAt(t))&&S(e.charCodeAt(t-1))&&t--;let i=k(e,t);for(t+=C(i);t<e.length;){let r=k(e,t);if(8205==i||8205==r||n&&O(r))t+=C(r),i=r;else{if(!y(r))break;{let n=0,i=t-2;for(;i>=0&&y(k(e,i));)n++,i-=2;if(n%2==0)break;t+=2}}}return t}function w(e,t,n){for(;t>0;){let i=b(e,t-2,n);if(i<t)return i;t--}return 0}function x(e){return e>=56320&&e<57344}function S(e){return e>=55296&&e<56320}function k(e,t){let n=e.charCodeAt(t);if(!S(n)||t+1==e.length)return n;let i=e.charCodeAt(t+1);return x(i)?i-56320+(n-55296<<10)+65536:n}function A(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function C(e){return e<65536?1:2}var _=/\r\n?|\n/,E=function(e){return e[e.Simple=0]="Simple",e[e.TrackDel=1]="TrackDel",e[e.TrackBefore=2]="TrackBefore",e[e.TrackAfter=3]="TrackAfter",e}(E||(E={})),T=class{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,i=0;t<this.sections.length;){let r=this.sections[t++],s=this.sections[t++];s<0?(e(n,i,r),i+=r):i+=s,n+=r}}iterChangedRanges(e,t=!1){I(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];i<0?e.push(n,i):e.push(i,n)}return new T(e)}composeDesc(e){return this.empty?e:e.empty?this:R(this,e)}mapDesc(e,t=!1){return e.empty?this:Q(this,e,t)}mapPos(e,t=-1,n=E.Simple){let i=0,r=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],a=this.sections[s++],l=i+o;if(a<0){if(l>e)return r+(e-i);r+=o}else{if(n!=E.Simple&&l>=e&&(n==E.TrackDel&&i<e&&l>e||n==E.TrackBefore&&i<e||n==E.TrackAfter&&l>e))return null;if(l>e||l==e&&t<0&&!o)return e==i||t<0?r:r+a;r+=a}i=l}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return r}touchesRange(e,t=e){for(let n=0,i=0;n<this.sections.length&&i<=t;){let r=i+this.sections[n++];if(this.sections[n++]>=0&&i<=t&&r>=e)return!(i<e&&r>t)||"cover";i=r}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+n+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some((e=>"number"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new T(e)}},P=class extends T{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return I(this,((t,n,i,r,s)=>e=e.replace(i,i+(n-t),s)),!1),e}mapDesc(e,t=!1){return Q(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let i=0,r=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o>=0){t[i]=o,t[i+1]=s;let l=i>>1;for(;n.length<l;)n.push(a.empty);n.push(s?e.slice(r,r+s):a.empty)}r+=s}return new P(t,n)}compose(e){return this.empty?e:e.empty?this:R(this,e,!0)}map(e,t=!1){return e.empty?this:Q(this,e,t,!0)}iterChanges(e,t=!1){I(this,e,t)}get desc(){return new T(this.sections)}filter(e){let t=[],n=[],i=[],r=new M(this);e:for(let s=0,o=0;;){let a=s==e.length?1e9:e[s++];for(;o<a||o==a&&0==r.len;){if(r.done)break e;let e=Math.min(r.len,a-o);$(i,e,-1);let s=-1==r.ins?-1:0==r.off?r.ins:0;$(t,e,s),s>0&&N(n,t,r.text),r.forward(e),o+=e}let l=e[s++];for(;o<l;){if(r.done)break e;let e=Math.min(r.len,l-o);$(t,e,-1),$(i,e,-1==r.ins?-1:0==r.off?r.ins:0),r.forward(e),o+=e}}return{changes:new P(t,n),filtered:new T(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],i=this.sections[t+1];i<0?e.push(n):0==i?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let i=[],r=[],s=0,o=null;function l(e=!1){if(!e&&!i.length)return;s<t&&$(i,t-s,-1);let n=new P(i,r);o=o?o.compose(n.map(o)):n,i=[],r=[],s=0}return function e(h){if(Array.isArray(h))for(let t of h)e(t);else if(h instanceof P){if(h.length!=t)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${t})`);l(),o=o?o.compose(h.map(o)):h}else{let{from:e,to:o=e,insert:c}=h;if(e>o||e<0||o>t)throw new RangeError(`Invalid change range ${e} to ${o} (in doc of length ${t})`);let u=c?"string"==typeof c?a.of(c.split(n||_)):c:a.empty,d=u.length;if(e==o&&0==d)return;e<s&&l(),e>s&&$(i,e-s,-1),$(i,o-e,d),N(r,i,u),s=o}}(e),l(!o),o}static empty(e){return new P(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let i=0;i<e.length;i++){let r=e[i];if("number"==typeof r)t.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some(((e,t)=>t&&"string"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)t.push(r[0],0);else{for(;n.length<i;)n.push(a.empty);n[i]=a.of(r.slice(1)),t.push(r[0],n[i].length)}}}return new P(t,n)}};function $(e,t,n,i=!1){if(0==t&&n<=0)return;let r=e.length-2;r>=0&&n<=0&&n==e[r+1]?e[r]+=t:0==t&&0==e[r]?e[r+1]+=n:i?(e[r]+=t,e[r+1]+=n):e.push(t,n)}function N(e,t,n){if(0==n.length)return;let i=t.length-2>>1;if(i<e.length)e[e.length-1]=e[e.length-1].append(n);else{for(;e.length<i;)e.push(a.empty);e.push(n)}}function I(e,t,n){let i=e.inserted;for(let r=0,s=0,o=0;o<e.sections.length;){let l=e.sections[o++],h=e.sections[o++];if(h<0)r+=l,s+=l;else{let c=r,u=s,d=a.empty;for(;c+=l,u+=h,h&&i&&(d=d.append(i[o-2>>1])),!(n||o==e.sections.length||e.sections[o+1]<0);)l=e.sections[o++],h=e.sections[o++];t(r,c,s,u,d),r=c,s=u}}}function Q(e,t,n,i=!1){let r=[],s=i?[]:null,o=new M(e),a=new M(t);for(let e=0,t=0;;)if(-1==o.ins)e+=o.len,o.next();else if(-1==a.ins&&t<e){let n=Math.min(a.len,e-t);a.forward(n),$(r,n,-1),t+=n}else if(a.ins>=0&&(o.done||t<e||t==e&&(a.len<o.len||a.len==o.len&&!n))){for($(r,a.ins,-1);e>t&&!o.done&&e+o.len<t+a.len;)e+=o.len,o.next();t+=a.len,a.next()}else{if(!(o.ins>=0)){if(o.done&&a.done)return s?new P(r,s):new T(r);throw new Error("Mismatched change set lengths")}{let n=0,i=e+o.len;for(;;)if(a.ins>=0&&t>e&&t+a.len<i)n+=a.ins,t+=a.len,a.next();else{if(!(-1==a.ins&&t<i))break;{let e=Math.min(a.len,i-t);n+=e,a.forward(e),t+=e}}$(r,n,o.ins),s&&N(s,r,o.text),e=i,o.next()}}}function R(e,t,n=!1){let i=[],r=n?[]:null,s=new M(e),o=new M(t);for(let e=!1;;){if(s.done&&o.done)return r?new P(i,r):new T(i);if(0==s.ins)$(i,s.len,0,e),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let t=Math.min(s.len2,o.len),n=i.length;if(-1==s.ins){let n=-1==o.ins?-1:o.off?0:o.ins;$(i,t,n,e),r&&n&&N(r,i,o.text)}else-1==o.ins?($(i,s.off?0:s.len,t,e),r&&N(r,i,s.textBit(t))):($(i,s.off?0:s.len,o.off?0:o.ins,e),r&&!o.off&&N(r,i,o.text));e=(s.ins>t||o.ins>=0&&o.len>t)&&(e||i.length>n),s.forward2(t),o.forward(t)}}else $(i,0,o.ins,e),r&&N(r,i,o.text),o.next()}}var M=class{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?a.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?a.empty:t[n].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}},B=class{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return 16&this.flags?this.to:this.from}get head(){return 16&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 4&this.flags?-1:8&this.flags?1:0}get bidiLevel(){let e=3&this.flags;return 3==e?null:e}get goalColumn(){let e=this.flags>>5;return 33554431==e?void 0:e}map(e,t=-1){let n,i;return this.empty?n=i=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),n==this.from&&i==this.to?this:new B(n,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return D.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return D.range(this.anchor,n)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid JSON representation for SelectionRange");return D.range(e.anchor,e.head)}},D=class{constructor(e,t=0){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:D.create(this.ranges.map((n=>n.map(e,t))),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new D([this.main])}addRange(e,t=!0){return D.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,D.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((e=>e.toJSON())),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new D(e.ranges.map((e=>B.fromJSON(e))),e.main)}static single(e,t=e){return new D([D.range(e,t)],0)}static create(e,t=0){if(0==e.length)throw new RangeError("A selection needs at least one range");for(let n=0,i=0;i<e.length;i++){let r=e[i];if(r.empty?r.from<=n:r.from<n)return X(e.slice(),t);n=r.to}return new D(e,t)}static cursor(e,t=0,n,i){return new B(e,e,(0==t?0:t<0?4:8)|(null==n?3:Math.min(2,n))|(i??33554431)<<5)}static range(e,t,n){let i=(n??33554431)<<5;return t<e?new B(t,e,24|i):new B(e,t,i|(t>e?4:0))}};function X(e,t=0){let n=e[t];e.sort(((e,t)=>e.from-t.from)),t=e.indexOf(n);for(let n=1;n<e.length;n++){let i=e[n],r=e[n-1];if(i.empty?i.from<=r.to:i.from<r.to){let s=r.from,o=Math.max(i.to,r.to);n<=t&&t--,e.splice(--n,2,i.anchor>i.head?D.range(o,s):D.range(s,o))}}return new D(e,t)}function F(e,t){for(let n of e.ranges)if(n.to>t)throw new RangeError("Selection points outside of document")}var L=0,U=class{constructor(e,t,n,i,r){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=i,this.extensions=r,this.id=L++,this.default=e([])}static define(e={}){return new U(e.combine||(e=>e),e.compareInput||((e,t)=>e===t),e.compare||(e.combine?(e,t)=>e===t:V),!!e.static,e.enables)}of(e){return new z([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new z(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new z(e,this,2,t)}from(e,t){return t||(t=e=>e),this.compute([e],(n=>t(n.field(e))))}};function V(e,t){return e==t||e.length==t.length&&e.every(((e,n)=>e===t[n]))}var z=class{constructor(e,t,n,i){this.dependencies=e,this.facet=t,this.type=n,this.value=i,this.id=L++}dynamicSlot(e){var t;let n=this.value,i=this.facet.compareInput,r=this.id,s=e[r]>>1,o=2==this.type,a=!1,l=!1,h=[];for(let n of this.dependencies)"doc"==n?a=!0:"selection"==n?l=!0:0==(1&(null!==(t=e[n.id])&&void 0!==t?t:1))&&h.push(e[n.id]);return{create:e=>(e.values[s]=n(e),1),update(e,t){if(a&&t.docChanged||l&&(t.docChanged||t.selection)||j(e,h)){let t=n(e);if(o?!Z(t,e.values[s],i):!i(t,e.values[s]))return e.values[s]=t,1}return 0},reconfigure:(e,t)=>{let a=n(e),l=t.config.address[r];if(null!=l){let n=ae(t,l);if(this.dependencies.every((n=>n instanceof U?t.facet(n)===e.facet(n):!(n instanceof W)||t.field(n,!1)==e.field(n,!1)))||(o?Z(a,n,i):i(a,n)))return e.values[s]=n,0}return e.values[s]=a,1}}}};function Z(e,t,n){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function j(e,t){let n=!1;for(let i of t)1&oe(e,i)&&(n=!0);return n}function q(e,t,n){let i=n.map((t=>e[t.id])),r=n.map((e=>e.type)),s=i.filter((e=>!(1&e))),o=e[t.id]>>1;function a(e){let n=[];for(let t=0;t<i.length;t++){let s=ae(e,i[t]);if(2==r[t])for(let e of s)n.push(e);else n.push(s)}return t.combine(n)}return{create(e){for(let t of i)oe(e,t);return e.values[o]=a(e),1},update(e,n){if(!j(e,s))return 0;let i=a(e);return t.compare(i,e.values[o])?0:(e.values[o]=i,1)},reconfigure(e,r){let s=j(e,i),l=r.config.facets[t.id],h=r.facet(t);if(l&&!s&&V(n,l))return e.values[o]=h,0;let c=a(e);return t.compare(c,h)?(e.values[o]=h,0):(e.values[o]=c,1)}}}var G=U.define({static:!0}),W=class{constructor(e,t,n,i,r){this.id=e,this.createF=t,this.updateF=n,this.compareF=i,this.spec=r,this.provides=void 0}static define(e){let t=new W(L++,e.create,e.update,e.compare||((e,t)=>e===t),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(G).find((e=>e.field==this));return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:e=>(e.values[t]=this.create(e),1),update:(e,n)=>{let i=e.values[t],r=this.updateF(i,n);return this.compareF(i,r)?0:(e.values[t]=r,1)},reconfigure:(e,n)=>null!=n.config.address[this.id]?(e.values[t]=n.field(this),0):(e.values[t]=this.create(e),1)}}init(e){return[this,G.of({field:this,create:e})]}get extension(){return this}},H=4,Y=3,J=2,K=1;function ee(e){return t=>new ne(t,e)}var te={highest:ee(0),high:ee(K),default:ee(J),low:ee(Y),lowest:ee(H)},ne=class{constructor(e,t){this.inner=e,this.prec=t}},ie=class{of(e){return new re(this,e)}reconfigure(e){return ie.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}},re=class{constructor(e,t){this.compartment=e,this.inner=t}},se=class{constructor(e,t,n,i,r,s){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=i,this.staticValues=r,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let i=[],r=Object.create(null),s=new Map;for(let n of function(e,t,n){let i=[[],[],[],[],[]],r=new Map;function s(e,o){let a=r.get(e);if(null!=a){if(a<=o)return;let t=i[a].indexOf(e);t>-1&&i[a].splice(t,1),e instanceof re&&n.delete(e.compartment)}if(r.set(e,o),Array.isArray(e))for(let t of e)s(t,o);else if(e instanceof re){if(n.has(e.compartment))throw new RangeError("Duplicate use of compartment in extensions");let i=t.get(e.compartment)||e.inner;n.set(e.compartment,i),s(i,o)}else if(e instanceof ne)s(e.inner,e.prec);else if(e instanceof W)i[o].push(e),e.provides&&s(e.provides,o);else if(e instanceof z)i[o].push(e),e.facet.extensions&&s(e.facet.extensions,o);else{let t=e.extension;if(!t)throw new Error(`Unrecognized extension value in extension set (${e}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(t,o)}}return s(e,J),i.reduce(((e,t)=>e.concat(t)))}(e,t,s))n instanceof W?i.push(n):(r[n.facet.id]||(r[n.facet.id]=[])).push(n);let o=Object.create(null),a=[],l=[];for(let e of i)o[e.id]=l.length<<1,l.push((t=>e.slot(t)));let h=n?.config.facets;for(let e in r){let t=r[e],i=t[0].facet,s=h&&h[e]||[];if(t.every((e=>0==e.type)))if(o[i.id]=a.length<<1|1,V(s,t))a.push(n.facet(i));else{let e=i.combine(t.map((e=>e.value)));a.push(n&&i.compare(e,n.facet(i))?n.facet(i):e)}else{for(let e of t)0==e.type?(o[e.id]=a.length<<1|1,a.push(e.value)):(o[e.id]=l.length<<1,l.push((t=>e.dynamicSlot(t))));o[i.id]=l.length<<1,l.push((e=>q(e,i,t)))}}let c=l.map((e=>e(o)));return new se(e,s,c,o,a,r)}};function oe(e,t){if(1&t)return 2;let n=t>>1,i=e.status[n];if(4==i)throw new Error("Cyclic dependency between fields and/or facets");if(2&i)return i;e.status[n]=4;let r=e.computeSlot(e,e.config.dynamicSlots[n]);return e.status[n]=2|r}function ae(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}var le=U.define(),he=U.define({combine:e=>e.some((e=>e)),static:!0}),ce=U.define({combine:e=>e.length?e[0]:void 0,static:!0}),ue=U.define(),de=U.define(),pe=U.define(),fe=U.define({combine:e=>!!e.length&&e[0]}),me=class{constructor(e,t){this.type=e,this.value=t}static define(){return new ge}},ge=class{of(e){return new me(this,e)}},Oe=class{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return void 0===t?void 0:t==this.value?this:new Oe(this.type,t)}is(e){return this.type==e}static define(e={}){return new class{constructor(e){this.map=e}of(e){return new Oe(this,e)}}(e.map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let i of e){let e=i.map(t);e&&n.push(e)}return n}};Oe.reconfigure=Oe.define(),Oe.appendConfig=Oe.define();var ye=class{constructor(e,t,n,i,r,s){this.startState=e,this.changes=t,this.selection=n,this.effects=i,this.annotations=r,this.scrollIntoView=s,this._doc=null,this._state=null,n&&F(n,t.newLength),r.some((e=>e.type==ye.time))||(this.annotations=r.concat(ye.time.of(Date.now())))}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(ye.userEvent);return!(!t||!(t==e||t.length>e.length&&t.slice(0,e.length)==e&&"."==t[e.length]))}};function ve(e,t){let n=[];for(let i=0,r=0;;){let s,o;if(i<e.length&&(r==t.length||t[r]>=e[i]))s=e[i++],o=e[i++];else{if(!(r<t.length))return n;s=t[r++],o=t[r++]}!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function be(e,t,n){var i;let r,s,o;return n?(r=t.changes,s=P.empty(t.changes.length),o=e.changes.compose(t.changes)):(r=t.changes.map(e.changes),s=e.changes.mapDesc(t.changes,!0),o=e.changes.compose(r)),{changes:o,selection:t.selection?t.selection.map(s):null===(i=e.selection)||void 0===i?void 0:i.map(r),effects:Oe.mapEffects(e.effects,r).concat(Oe.mapEffects(t.effects,s)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function we(e,t,n){let i=t.selection,r=ke(t.annotations);return t.userEvent&&(r=r.concat(ye.userEvent.of(t.userEvent))),{changes:t.changes instanceof P?t.changes:P.of(t.changes||[],n,e.facet(ce)),selection:i&&(i instanceof D?i:D.single(i.anchor,i.head)),effects:ke(t.effects),annotations:r,scrollIntoView:!!t.scrollIntoView}}function xe(e,t,n){let i=we(e,t.length?t[0]:{},e.doc.length);t.length&&!1===t[0].filter&&(n=!1);for(let r=1;r<t.length;r++){!1===t[r].filter&&(n=!1);let s=!!t[r].sequential;i=be(i,we(e,t[r],s?i.changes.newLength:e.doc.length),s)}let r=new ye(e,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return function(e){let t=e.startState,n=t.facet(pe),i=e;for(let r=n.length-1;r>=0;r--){let s=n[r](e);s&&Object.keys(s).length&&(i=be(e,we(t,s,e.changes.newLength),!0))}return i==e?e:new ye(t,e.changes,e.selection,i.effects,i.annotations,i.scrollIntoView)}(n?function(e){let t=e.startState,n=!0;for(let i of t.facet(ue)){let t=i(e);if(!1===t){n=!1;break}Array.isArray(t)&&(n=!0===n?t:ve(n,t))}if(!0!==n){let i,r;if(!1===n)r=e.changes.invertedDesc,i=P.empty(t.doc.length);else{let t=e.changes.filter(n);i=t.changes,r=t.filtered.invertedDesc}e=new ye(t,i,e.selection&&e.selection.map(r),Oe.mapEffects(e.effects,r),e.annotations,e.scrollIntoView)}let i=t.facet(de);for(let n=i.length-1;n>=0;n--){let r=i[n](e);e=r instanceof ye?r:Array.isArray(r)&&1==r.length&&r[0]instanceof ye?r[0]:xe(t,ke(r),!1)}return e}(r):r)}ye.time=me.define(),ye.userEvent=me.define(),ye.addToHistory=me.define(),ye.remote=me.define();var Se=[];function ke(e){return null==e?Se:Array.isArray(e)?e:[e]}var Ae,Ce=function(e){return e[e.Word=0]="Word",e[e.Space=1]="Space",e[e.Other=2]="Other",e}(Ce||(Ce={})),_e=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{Ae=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Ee(e){return t=>{if(!/\S/.test(t))return Ce.Space;if(function(e){if(Ae)return Ae.test(e);for(let t=0;t<e.length;t++){let n=e[t];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||_e.test(n)))return!0}return!1}(t))return Ce.Word;for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return Ce.Word;return Ce.Other}}var Te=class{constructor(e,t,n,i,r,s){this.config=e,this.doc=t,this.selection=n,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=r,s&&(s._state=this);for(let e=0;e<this.config.dynamicSlots.length;e++)oe(this,e<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(null!=n)return oe(this,n),ae(this,n);if(t)throw new RangeError("Field is not present in this state")}update(...e){return xe(this,e,!0)}applyTransaction(e){let t,n=this.config,{base:i,compartments:r}=n;for(let t of e.effects)t.is(ie.reconfigure)?(n&&(r=new Map,n.compartments.forEach(((e,t)=>r.set(t,e))),n=null),r.set(t.value.compartment,t.value.extension)):t.is(Oe.reconfigure)?(n=null,i=t.value):t.is(Oe.appendConfig)&&(n=null,i=ke(i).concat(t.value));n?t=e.startState.values.slice():(n=se.resolve(i,r,this),t=new Te(n,this.doc,this.selection,n.dynamicSlots.map((()=>null)),((e,t)=>t.reconfigure(e,this)),null).values),new Te(n,e.newDoc,e.newSelection,t,((t,n)=>n.update(t,e)),e)}replaceSelection(e){return"string"==typeof e&&(e=this.toText(e)),this.changeByRange((t=>({changes:{from:t.from,to:t.to,insert:e},range:D.cursor(t.from+e.length)})))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),i=this.changes(n.changes),r=[n.range],s=ke(n.effects);for(let n=1;n<t.ranges.length;n++){let o=e(t.ranges[n]),a=this.changes(o.changes),l=a.map(i);for(let e=0;e<n;e++)r[e]=r[e].map(l);let h=i.mapDesc(a,!0);r.push(o.range.map(h)),i=i.compose(l),s=Oe.mapEffects(s,l).concat(Oe.mapEffects(ke(o.effects),h))}return{changes:i,selection:D.create(r,t.mainIndex),effects:s}}changes(e=[]){return e instanceof P?e:P.of(e,this.doc.length,this.facet(Te.lineSeparator))}toText(e){return a.of(e.split(this.facet(Te.lineSeparator)||_))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return null==t?e.default:(oe(this,t),ae(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let i=e[n];i instanceof W&&(t[n]=i.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||"string"!=typeof e.doc)throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(n)for(let t in n){let r=n[t],s=e[t];i.push(r.init((e=>r.spec.fromJSON(s,e))))}return Te.create({doc:e.doc,selection:D.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(e={}){let t=se.resolve(e.extensions||[],new Map),n=e.doc instanceof a?e.doc:a.of((e.doc||"").split(t.staticFacet(Te.lineSeparator)||_)),i=e.selection?e.selection instanceof D?e.selection:D.single(e.selection.anchor,e.selection.head):D.single(0);return F(i,n.length),t.staticFacet(he)||(i=i.asSingle()),new Te(t,n,i,t.dynamicSlots.map((()=>null)),((e,t)=>t.create(e)),null)}get tabSize(){return this.facet(Te.tabSize)}get lineBreak(){return this.facet(Te.lineSeparator)||"\n"}get readOnly(){return this.facet(fe)}phrase(e){for(let t of this.facet(Te.phrases))if(Object.prototype.hasOwnProperty.call(t,e))return t[e];return e}languageDataAt(e,t,n=-1){let i=[];for(let r of this.facet(le))for(let s of r(this,t,n))Object.prototype.hasOwnProperty.call(s,e)&&i.push(s[e]);return i}charCategorizer(e){return Ee(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:i}=this.doc.lineAt(e),r=this.charCategorizer(e),s=e-n,o=e-n;for(;s>0;){let e=v(t,s,!1);if(r(t.slice(e,s))!=Ce.Word)break;s=e}for(;o<i;){let e=v(t,o);if(r(t.slice(o,e))!=Ce.Word)break;o=e}return s==o?null:D.range(s+n,o+n)}};function Pe(e,t,n={}){let i={};for(let t of e)for(let e of Object.keys(t)){let r=t[e],s=i[e];if(void 0===s)i[e]=r;else if(s!==r&&void 0!==r){if(!Object.hasOwnProperty.call(n,e))throw new Error("Config merge conflict for field "+e);i[e]=n[e](s,r)}}for(let e in t)void 0===i[e]&&(i[e]=t[e]);return i}Te.allowMultipleSelections=he,Te.tabSize=U.define({combine:e=>e.length?e[0]:4}),Te.lineSeparator=ce,Te.readOnly=fe,Te.phrases=U.define({compare(e,t){let n=Object.keys(e),i=Object.keys(t);return n.length==i.length&&n.every((n=>e[n]==t[n]))}}),Te.languageData=le,Te.changeFilter=ue,Te.transactionFilter=de,Te.transactionExtender=pe,ie.reconfigure=Oe.define();var $e=class{eq(e){return this==e}range(e,t=e){return new Ne(e,t,this)}};$e.prototype.startSide=$e.prototype.endSide=0,$e.prototype.point=!1,$e.prototype.mapMode=E.TrackDel;var Ne=class{constructor(e,t,n){this.from=e,this.to=t,this.value=n}};function Ie(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}var Qe=class{constructor(e,t,n,i){this.from=e,this.to=t,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,i=0){let r=n?this.to:this.from;for(let s=i,o=r.length;;){if(s==o)return s;let i=s+o>>1,a=r[i]-e||(n?this.value[i].endSide:this.value[i].startSide)-t;if(i==s)return a>=0?s:o;a>=0?o=i:s=i+1}}between(e,t,n,i){for(let r=this.findIndex(t,-1e9,!0),s=this.findIndex(n,1e9,!1,r);r<s;r++)if(!1===i(this.from[r]+e,this.to[r]+e,this.value[r]))return!1}map(e,t){let n=[],i=[],r=[],s=-1,o=-1;for(let a=0;a<this.value.length;a++){let l,h,c=this.value[a],u=this.from[a]+e,d=this.to[a]+e;if(u==d){let e=t.mapPos(u,c.startSide,c.mapMode);if(null==e||(l=h=e,c.startSide!=c.endSide&&(h=t.mapPos(u,c.endSide),h<l)))continue}else if(l=t.mapPos(u,c.startSide),h=t.mapPos(d,c.endSide),l>h||l==h&&c.startSide>0&&c.endSide<=0)continue;(h-l||c.endSide-c.startSide)<0||(s<0&&(s=l),c.point&&(o=Math.max(o,h-l)),n.push(c),i.push(l-s),r.push(h-s))}return{mapped:n.length?new Qe(i,r,n,o):null,pos:s}}},Re=class{constructor(e,t,n=Re.empty,i){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=i}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:i=0,filterTo:r=this.length}=e,s=e.filter;if(0==t.length&&!s)return this;if(n&&(t=t.slice().sort(Ie)),this.isEmpty)return t.length?Re.of(t):this;let o=new De(this,null,-1).goto(0),a=0,l=[],h=new Me;for(;o.value||a<t.length;)if(a<t.length&&(o.from-t[a].from||o.startSide-t[a].value.startSide)>=0){let e=t[a++];h.addInner(e.from,e.to,e.value)||l.push(e)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(o.chunkIndex)<t[a].from)&&(!s||i>this.chunkEnd(o.chunkIndex)||r<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||i>o.to||r<o.from||s(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||l.push(new Ne(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!l.length?Re.empty:this.nextLayer.update({add:l,filter:s,filterFrom:i,filterTo:r}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],i=-1;for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r],a=e.touchesRange(s,s+o.length);if(!1===a)i=Math.max(i,o.maxPoint),t.push(o),n.push(e.mapPos(s));else if(!0===a){let{mapped:r,pos:a}=o.map(s,e);r&&(i=Math.max(i,r.maxPoint),t.push(r),n.push(a))}}let r=this.nextLayer.map(e);return 0==t.length?r:new Re(n,t,r,i)}between(e,t,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let r=this.chunkPos[i],s=this.chunk[i];if(t>=r&&e<=r+s.length&&!1===s.between(r,e-r,t-r,n))return}this.nextLayer.between(e,t,n)}}iter(e=0){return Xe.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Xe.from(e).goto(t)}static compare(e,t,n,i,r=-1){let s=e.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=r)),o=t.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=r)),a=Be(s,o,n),l=new Le(s,a,r),h=new Le(o,a,r);n.iterGaps(((e,t,n)=>Ue(l,e,h,t,n,i))),n.empty&&0==n.length&&Ue(l,0,h,0,0,i)}static eq(e,t,n=0,i){null==i&&(i=1e9);let r=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0)),s=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0));if(r.length!=s.length)return!1;if(!r.length)return!0;let o=Be(r,s),a=new Le(r,o,0).goto(n),l=new Le(s,o,0).goto(n);for(;;){if(a.to!=l.to||!Ve(a.active,l.active)||a.point&&(!l.point||!a.point.eq(l.point)))return!1;if(a.to>i)return!0;a.next(),l.next()}}static spans(e,t,n,i,r=-1){let s=new Le(e,null,r).goto(t),o=t,a=s.openStart;for(;;){let e=Math.min(s.to,n);if(s.point?(i.point(o,e,s.point,s.activeForPoint(s.to),a,s.pointRank),a=s.openEnd(e)+(s.to>e?1:0)):e>o&&(i.span(o,e,s.active,a),a=s.openEnd(e)),s.to>n)break;o=s.to,s.next()}return a}static of(e,t=!1){let n=new Me;for(let i of e instanceof Ne?[e]:t?function(e){if(e.length>1)for(let t=e[0],n=1;n<e.length;n++){let i=e[n];if(Ie(t,i)>0)return e.slice().sort(Ie);t=i}return e}(e):e)n.add(i.from,i.to,i.value);return n.finish()}};Re.empty=new Re([],[],null,-1),Re.empty.nextLayer=Re.empty;var Me=class{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new Qe(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new Me)).add(e,t,n)}addInner(e,t,n){let i=e-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(i<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(Re.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;let t=new Re(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}};function Be(e,t,n){let i=new Map;for(let t of e)for(let e=0;e<t.chunk.length;e++)t.chunk[e].maxPoint<=0&&i.set(t.chunk[e],t.chunkPos[e]);let r=new Set;for(let e of t)for(let t=0;t<e.chunk.length;t++){let s=i.get(e.chunk[t]);null!=s&&(n?n.mapPos(s):s)==e.chunkPos[t]&&!n?.touchesRange(s,s+e.chunk[t].length)&&r.add(e.chunk[t])}return r}var De=class{constructor(e,t,n,i=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let t=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(t)||this.layer.chunkEnd(this.chunkIndex)<e||t.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}},Xe=class{constructor(e){this.heap=e}static from(e,t=null,n=-1){let i=[];for(let r=0;r<e.length;r++)for(let s=e[r];!s.isEmpty;s=s.nextLayer)s.maxPoint>=n&&i.push(new De(s,t,n,r));return 1==i.length?i[0]:new Xe(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let e=this.heap.length>>1;e>=0;e--)Fe(this.heap,e);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let e=this.heap.length>>1;e>=0;e--)Fe(this.heap,e);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Fe(this.heap,0)}}};function Fe(e,t){for(let n=e[t];;){let i=1+(t<<1);if(i>=e.length)break;let r=e[i];if(i+1<e.length&&r.compare(e[i+1])>=0&&(r=e[i+1],i++),n.compare(r)<0)break;e[i]=n,e[t]=r,t=i}}var Le=class{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Xe.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){ze(this.active,e),ze(this.activeTo,e),ze(this.activeRank,e),this.minActive=je(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:i,rank:r}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=r;)t++;Ze(this.active,t,n),Ze(this.activeTo,t,i),Ze(this.activeRank,t,r),e&&Ze(e,t,this.cursor.from),this.minActive=je(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null,i=0;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),n&&ze(n,r)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let r=this.cursor.value;if(r.point){if(!(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.from<e&&(i=1),this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(n),this.cursor.next()}}}if(n){let t=0;for(;t<n.length&&n[t]<e;)t++;this.openStart=t+i}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}};function Ue(e,t,n,i,r,s){e.goto(t),n.goto(i);let o=i+r,a=i,l=i-t;for(;;){let t=e.to+l-n.to||e.endSide-n.endSide,i=t<0?e.to+l:n.to,r=Math.min(i,o);if(e.point||n.point?e.point&&n.point&&(e.point==n.point||e.point.eq(n.point))&&Ve(e.activeForPoint(e.to+l),n.activeForPoint(n.to))||s.comparePoint(a,r,e.point,n.point):r>a&&!Ve(e.active,n.active)&&s.compareRange(a,r,e.active,n.active),i>o)break;a=i,t<=0&&e.next(),t>=0&&n.next()}}function Ve(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n]&&!e[n].eq(t[n]))return!1;return!0}function ze(e,t){for(let n=t,i=e.length-1;n<i;n++)e[n]=e[n+1];e.pop()}function Ze(e,t,n){for(let n=e.length-1;n>=t;n--)e[n+1]=e[n];e[t]=n}function je(e,t){let n=-1,i=1e9;for(let r=0;r<t.length;r++)(t[r]-i||e[r].endSide-e[n].endSide)<0&&(n=r,i=t[r]);return n}function qe(e,t,n=e.length){let i=0;for(let r=0;r<n;)9==e.charCodeAt(r)?(i+=t-i%t,r++):(i++,r=v(e,r));return i}function Ge(e,t,n,i){for(let i=0,r=0;;){if(r>=t)return i;if(i==e.length)break;r+=9==e.charCodeAt(i)?n-r%n:1,i=v(e,i)}return!0===i?-1:e.length}var We,He,Ye=typeof Symbol>"u"?"__":Symbol.for(""),Je=typeof Symbol>"u"?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),Ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{},et=class{constructor(e,t){this.rules=[];let{finish:n}=t||{};function i(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}function r(e,t,s,o){let a=[],l=/^@(\w+)\b/.exec(e[0]),h=l&&"keyframes"==l[1];if(l&&null==t)return s.push(e[0]+";");for(let n in t){let o=t[n];if(/&/.test(n))r(n.split(/,\s*/).map((t=>e.map((e=>t.replace(/&/,e))))).reduce(((e,t)=>e.concat(t))),o,s);else if(o&&"object"==typeof o){if(!l)throw new RangeError("The value of a property ("+n+") should be a primitive value.");r(i(n),o,a,h)}else null!=o&&a.push(n.replace(/_.*/,"").replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))+": "+o+";")}(a.length||h)&&s.push((!n||l||o?e:e.map(n)).join(", ")+" {"+a.join(" ")+"}")}for(let t in e)r(i(t),e[t],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let e=Ke[Ye]||1;return Ke[Ye]=e+1,""+e.toString(36)}static mount(e,t){(e[Je]||new nt(e)).mount(Array.isArray(t)?t:[t])}},tt=null,nt=class{constructor(e){if(!e.head&&e.adoptedStyleSheets&&typeof CSSStyleSheet<"u"){if(tt)return e.adoptedStyleSheets=[tt.sheet].concat(e.adoptedStyleSheets),e[Je]=tt;this.sheet=new CSSStyleSheet,e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets),tt=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");let t=e.head||e;t.insertBefore(this.styleTag,t.firstChild)}this.modules=[],e[Je]=this}mount(e){let t=this.sheet,n=0,i=0;for(let r=0;r<e.length;r++){let s=e[r],o=this.modules.indexOf(s);if(o<i&&o>-1&&(this.modules.splice(o,1),i--,o=-1),-1==o){if(this.modules.splice(i++,0,s),t)for(let e=0;e<s.rules.length;e++)t.insertRule(s.rules[e],n++)}else{for(;i<o;)n+=this.modules[i++].rules.length;n+=s.rules.length,i++}}if(!t){let e="";for(let t=0;t<this.modules.length;t++)e+=this.modules[t].getRules()+"\n";this.styleTag.textContent=e}}},it={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},rt={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},st=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),ot=typeof navigator<"u"&&/Apple Computer/.test(navigator.vendor),at=typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent),lt=typeof navigator<"u"&&/Mac/.test(navigator.platform),ht=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),ct=st&&(lt||+st[1]<57)||at&&lt;for(We=0;We<10;We++)it[48+We]=it[96+We]=String(We);for(We=1;We<=24;We++)it[We+111]="F"+We;for(We=65;We<=90;We++)it[We]=String.fromCharCode(We+32),rt[We]=String.fromCharCode(We);for(He in it)rt.hasOwnProperty(He)||(rt[He]=it[He]);function ut(e){let t;return t=11==e.nodeType?e.getSelection?e:e.ownerDocument:e,t.getSelection()}function dt(e,t){return!!t&&(e==t||e.contains(1!=t.nodeType?t.parentNode:t))}function pt(e,t){if(!t.anchorNode)return!1;try{return dt(e,t.anchorNode)}catch{return!1}}function ft(e){return 3==e.nodeType?At(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function mt(e,t,n,i){return!!n&&(Ot(e,t,n,i,-1)||Ot(e,t,n,i,1))}function gt(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function Ot(e,t,n,i,r){for(;;){if(e==n&&t==i)return!0;if(t==(r<0?0:yt(e))){if("DIV"==e.nodeName)return!1;let n=e.parentNode;if(!n||1!=n.nodeType)return!1;t=gt(e)+(r<0?0:1),e=n}else{if(1!=e.nodeType)return!1;if(1==(e=e.childNodes[t+(r<0?-1:0)]).nodeType&&"false"==e.contentEditable)return!1;t=r<0?yt(e):0}}}function yt(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}var vt={left:0,right:0,top:0,bottom:0};function bt(e,t){let n=t?e.left:e.right;return{left:n,right:n,top:e.top,bottom:e.bottom}}function wt(e){return{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}var xt,St=null;function kt(e){if(e.setActive)return e.setActive();if(St)return e.focus(St);let t=[];for(let n=e;n&&(t.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(e.focus(null==St?{get preventScroll(){return St={preventScroll:!0},!0}}:void 0),!St){St=!1;for(let e=0;e<t.length;){let n=t[e++],i=t[e++],r=t[e++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=r&&(n.scrollLeft=r)}}}function At(e,t,n=t){let i=xt||(xt=document.createRange());return i.setEnd(e,n),i.setStart(e,t),i}function Ct(e,t,n){let i={key:t,code:t,keyCode:n,which:n,cancelable:!0},r=new KeyboardEvent("keydown",i);r.synthetic=!0,e.dispatchEvent(r);let s=new KeyboardEvent("keyup",i);return s.synthetic=!0,e.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function _t(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0])}var Et=class{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new Et(e.parentNode,gt(e),t)}static after(e,t){return new Et(e.parentNode,gt(e)+1,t)}},Tt=[],Pt=class{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e){if(2&this.dirty){let t,n=this.dom,i=null;for(let r of this.children){if(r.dirty){if(!r.dom&&(t=i?i.nextSibling:n.firstChild)){let e=Pt.get(t);(!e||!e.parent&&e.constructor==r.constructor)&&r.reuseDOM(t)}r.sync(e),r.dirty=0}if(t=i?i.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&t!=r.dom&&(e.written=!0),r.dom.parentNode==n)for(;t&&t!=r.dom;)t=$t(t);else n.insertBefore(r.dom,t);i=r.dom}for(t=i?i.nextSibling:n.firstChild,t&&e&&e.node==n&&(e.written=!0);t;)t=$t(t)}else if(1&this.dirty)for(let t of this.children)t.dirty&&(t.sync(e),t.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let i=0==yt(e)?0:0==t?-1:1;for(;;){let t=e.parentNode;if(t==this.dom)break;0==i&&t.firstChild!=t.lastChild&&(i=e==t.firstChild?-1:1),e=t}n=i<0?e:e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!Pt.get(n);)n=n.nextSibling;if(!n)return this.length;for(let e=0,t=0;;e++){let i=this.children[e];if(i.dom==n)return t;t+=i.length+i.breakAfter}}domBoundsAround(e,t,n=0){let i=-1,r=-1,s=-1,o=-1;for(let a=0,l=n,h=n;a<this.children.length;a++){let n=this.children[a],c=l+n.length;if(l<e&&c>t)return n.domBoundsAround(e,t,l);if(c>=e&&-1==i&&(i=a,r=l),l>t&&n.dom.parentNode==this.dom){s=a,o=h;break}h=c,l=c+n.breakAfter}return{from:r,to:o<0?n+this.length:o,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),1&t.dirty)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=Tt){this.markDirty();for(let n=e;n<t;n++){let e=this.children[n];e.parent==this&&e.destroy()}this.children.splice(e,t-e,...n);for(let e=0;e<n.length;e++)n[e].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Nt(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}merge(e,t,n,i,r,s){return!1}become(e){return!1}getSide(){return 0}destroy(){this.parent=null}};function $t(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}Pt.prototype.breakAfter=0;var Nt=class{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}};function It(e,t,n,i,r,s,o,a,l){let{children:h}=e,c=h.length?h[t]:null,u=s.length?s[s.length-1]:null,d=u?u.breakAfter:o;if(!(t==i&&c&&!o&&!d&&s.length<2&&c.merge(n,r,s.length?u:null,0==n,a,l))){if(i<h.length){let e=h[i];e&&r<e.length?(t==i&&(e=e.split(r),r=0),!d&&u&&e.merge(0,r,u,!0,0,l)?s[s.length-1]=e:(r&&e.merge(0,r,null,!1,0,l),s.push(e))):e?.breakAfter&&(u?u.breakAfter=1:o=1),i++}for(c&&(c.breakAfter=o,n>0&&(!o&&s.length&&c.merge(n,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(n<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(n,c.length,null,!1,a,0),t++));t<i&&s.length;)if(h[i-1].become(s[s.length-1]))i--,s.pop(),l=s.length?0:a;else{if(!h[t].become(s[0]))break;t++,s.shift(),a=s.length?0:l}!s.length&&t&&i<h.length&&!h[t-1].breakAfter&&h[i].merge(0,0,h[t-1],!1,a,l)&&t--,(t<i||s.length)&&e.replaceChildren(t,i,s)}}function Qt(e,t,n,i,r,s){let o=e.childCursor(),{i:a,off:l}=o.findPos(n,1),{i:h,off:c}=o.findPos(t,-1),u=t-n;for(let e of i)u+=e.length;e.length+=u,It(e,h,c,a,l,i,0,r,s)}var Rt=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Mt=typeof document<"u"?document:{documentElement:{style:{}}},Bt=/Edge\/(\d+)/.exec(Rt.userAgent),Dt=/MSIE \d/.test(Rt.userAgent),Xt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Rt.userAgent),Ft=!!(Dt||Xt||Bt),Lt=!Ft&&/gecko\/(\d+)/i.test(Rt.userAgent),Ut=!Ft&&/Chrome\/(\d+)/.exec(Rt.userAgent),Vt="webkitFontSmoothing"in Mt.documentElement.style,zt=!Ft&&/Apple Computer/.test(Rt.vendor),Zt=zt&&(/Mobile\/\w+/.test(Rt.userAgent)||Rt.maxTouchPoints>2),jt={mac:Zt||/Mac/.test(Rt.platform),windows:/Win/.test(Rt.platform),linux:/Linux|X11/.test(Rt.platform),ie:Ft,ie_version:Dt?Mt.documentMode||6:Xt?+Xt[1]:Bt?+Bt[1]:0,gecko:Lt,gecko_version:Lt?+(/Firefox\/(\d+)/.exec(Rt.userAgent)||[0,0])[1]:0,chrome:!!Ut,chrome_version:Ut?+Ut[1]:0,ios:Zt,android:/Android\b/.test(Rt.userAgent),webkit:Vt,safari:zt,webkit_version:Vt?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=Mt.documentElement.style.tabSize?"tab-size":"-moz-tab-size"},qt=class extends Pt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){3==e.nodeType&&this.createDOM(e)}merge(e,t,n){return(!n||n instanceof qt&&!(this.length-(t-e)+n.length>256))&&(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new qt(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Et(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Wt(this.dom,e,t)}},Gt=class extends Pt{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let e of t)e.setParent(this)}setAttrs(e){if(_t(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e)}merge(e,t,n,i,r,s){return(!n||!(!(n instanceof Gt&&n.mark.eq(this.mark))||e&&r<=0||t<this.length&&s<=0))&&(Qt(this,e,t,n?n.children:[],r-1,s-1),this.markDirty(),!0)}split(e){let t=[],n=0,i=-1,r=0;for(let s of this.children){let o=n+s.length;o>e&&t.push(n<e?s.split(e-n):s),i<0&&n>=e&&(i=r),n=o,r++}let s=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new Gt(this.mark,t,s)}domAtPos(e){return tn(this.dom,this.children,e)}coordsAt(e,t){return rn(this,e,t)}};function Wt(e,t,n){let i=e.nodeValue.length;t>i&&(t=i);let r=t,s=t,o=0;0==t&&n<0||t==i&&n>=0?jt.chrome||jt.gecko||(t?(r--,o=1):(s++,o=-1)):n<0?r--:s++;let a=At(e,r,s).getClientRects();if(!a.length)return vt;let l=a[(o?o<0:n>=0)?0:a.length-1];return jt.safari&&!o&&0==l.width&&(l=Array.prototype.find.call(a,(e=>e.width))||l),o?bt(l,o<0):l||null}var Ht=class extends Pt{constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}static create(e,t,n){return new(e.customView||Ht)(e,t,n)}split(e){let t=Ht.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,n,i,r,s){return!(n&&(!(n instanceof Ht&&this.widget.compare(n.widget))||e>0&&r<=0||t<this.length&&s<=0))&&(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e.length==this.length&&e instanceof Ht&&e.side==this.side&&this.widget.constructor==e.widget.constructor&&(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return a.empty;let e=this;for(;e.parent;)e=e.parent;let t=e.editorView,n=t&&t.state.doc,i=this.posAtStart;return n?n.slice(i,i+this.length):a.empty}domAtPos(e){return 0==e?Et.before(this.dom):Et.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.dom.getClientRects(),i=null;if(!n.length)return vt;for(let t=e>0?n.length-1:0;i=n[t],!(e>0?0==t:t==n.length-1||i.top<i.bottom);t+=e>0?-1:1);return 0==e&&t>0||e==this.length&&t<=0?i:bt(i,0==e)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},Yt=class extends Ht{domAtPos(e){let{topView:t,text:n}=this.widget;return t?Jt(e,0,t,n,((e,t)=>e.domAtPos(t)),(e=>new Et(n,Math.min(e,n.nodeValue.length)))):new Et(n,Math.min(e,n.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:n,text:i}=this.widget;return n?Kt(e,t,n,i):Math.min(t,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){let{topView:n,text:i}=this.widget;return n?Jt(e,t,n,i,((e,t,n)=>e.coordsAt(t,n)),((e,t)=>Wt(i,e,t))):Wt(i,e,t)}destroy(){var e;super.destroy(),null===(e=this.widget.topView)||void 0===e||e.destroy()}get isEditable(){return!0}};function Jt(e,t,n,i,r,s){if(n instanceof Gt){for(let o of n.children){let n=dt(o.dom,i),a=n?i.nodeValue.length:o.length;if(e<a||e==a&&o.getSide()<=0)return n?Jt(e,t,o,i,r,s):r(o,e,t);e-=a}return r(n,n.length,-1)}return n.dom==i?s(e,t):r(n,e,t)}function Kt(e,t,n,i){if(n instanceof Gt)for(let r of n.children){let n=0,s=dt(r.dom,i);if(dt(r.dom,e))return n+(s?Kt(e,t,r,i):r.localPosFromDOM(e,t));n+=s?i.nodeValue.length:r.length}else if(n.dom==i)return Math.min(t,i.nodeValue.length);return n.localPosFromDOM(e,t)}var en=class extends Pt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof en&&e.side==this.side}split(){return new en(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return Et.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect(),n=function(e,t){let n=e.parent,i=n?n.children.indexOf(e):-1;for(;n&&i>=0;)if(t<0?i>0:i<n.children.length){let e=n.children[i+t];if(e instanceof qt){let n=e.coordsAt(t<0?e.length:0,t);if(n)return n}i+=t}else{if(!(n instanceof Gt&&n.parent)){let e=n.dom.lastChild;if(e&&"BR"==e.nodeName)return e.getClientRects()[0];break}i=n.parent.children.indexOf(n)+(t<0?0:1),n=n.parent}}(this,this.side>0?-1:1);return n&&n.top<t.bottom&&n.bottom>t.top?{left:t.left,right:t.right,top:n.top,bottom:n.bottom}:t}get overrideDOMText(){return a.empty}};function tn(e,t,n){let i=0;for(let r=0;i<t.length;i++){let s=t[i],o=r+s.length;if(!(o==r&&s.getSide()<=0)){if(n>r&&n<o&&s.dom.parentNode==e)return s.domAtPos(n-r);if(n<=r)break;r=o}}for(;i>0;i--){let n=t[i-1].dom;if(n.parentNode==e)return Et.after(n)}return new Et(e,0)}function nn(e,t,n){let i,{children:r}=e;n>0&&t instanceof Gt&&r.length&&(i=r[r.length-1])instanceof Gt&&i.mark.eq(t.mark)?nn(i,t.children[0],n-1):(r.push(t),t.setParent(e)),e.length+=t.length}function rn(e,t,n){for(let i=0,r=0;r<e.children.length;r++){let s,o=e.children[r],a=i+o.length;if((n<=0||a==e.length||o.getSide()>0?a>=t:a>t)&&(t<a||r+1==e.children.length||(s=e.children[r+1]).length||s.getSide()>0)){let e=0;if(a==i){if(o.getSide()<=0)continue;e=n=-o.getSide()}let r=o.coordsAt(Math.max(0,t-i),n);return e&&r?bt(r,n<0):r}i=a}let i=e.dom.lastChild;if(!i)return e.dom.getBoundingClientRect();let r=ft(i);return r[r.length-1]||null}function sn(e,t){for(let n in e)"class"==n&&t.class?t.class+=" "+e.class:"style"==n&&t.style?t.style+=";"+e.style:t[n]=e[n];return t}function on(e,t){if(e==t)return!0;if(!e||!t)return!1;let n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(let r of n)if(-1==i.indexOf(r)||e[r]!==t[r])return!1;return!0}function an(e,t,n){if(t)for(let i in t)n&&i in n||e.removeAttribute(i);if(n)for(let i in n)t&&t[i]==n[i]||e.setAttribute(i,n[i])}qt.prototype.children=Ht.prototype.children=en.prototype.children=Tt;var ln=class{eq(e){return!1}updateDOM(e){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}},hn=function(e){return e[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange",e}(hn||(hn={})),cn=class extends $e{constructor(e,t,n,i){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(e){return new un(e)}static widget(e){let t=e.side||0,n=!!e.block;return t+=n?t>0?3e8:-4e8:t>0?1e8:-1e8,new pn(e,t,t,n,e.widget||null,!1)}static replace(e){let t,n,i=!!e.block;if(e.isBlockGap)t=-5e8,n=4e8;else{let{start:r,end:s}=fn(e,i);t=(r?i?-3e8:-1:5e8)-1,n=1+(s?i?2e8:1:-6e8)}return new pn(e,t,n,i,e.widget||null,!0)}static line(e){return new dn(e)}static set(e,t=!1){return Re.of(e,t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}};cn.none=Re.empty;var un=class extends cn{constructor(e){let{start:t,end:n}=fn(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof un&&this.tagName==e.tagName&&this.class==e.class&&on(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}};un.prototype.point=!1;var dn=class extends cn{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof dn&&on(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}};dn.prototype.mapMode=E.TrackBefore,dn.prototype.point=!0;var pn=class extends cn{constructor(e,t,n,i,r,s){super(t,n,r,e),this.block=i,this.isReplace=s,this.mapMode=i?t<=0?E.TrackBefore:E.TrackAfter:E.TrackDel}get type(){return this.startSide<this.endSide?hn.WidgetRange:this.startSide<=0?hn.WidgetBefore:hn.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof pn&&function(e,t){return e==t||!!(e&&t&&e.compare(t))}(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}};function fn(e,t=!1){let{inclusiveStart:n,inclusiveEnd:i}=e;return null==n&&(n=e.inclusive),null==i&&(i=e.inclusive),{start:n??t,end:i??t}}function mn(e,t,n,i=0){let r=n.length-1;r>=0&&n[r]+i>=e?n[r]=Math.max(n[r],t):n.push(e,t)}pn.prototype.point=!0;var gn=class extends Pt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,i,r,s){if(n){if(!(n instanceof gn))return!1;this.dom||n.transferDOM(this)}return i&&this.setDeco(n?n.attrs:null),Qt(this,e,t,n?n.children:[],r,s),!0}split(e){let t=new gn;if(t.breakAfter=this.breakAfter,0==this.length)return t;let{i:n,off:i}=this.childPos(e);i&&(t.append(this.children[n].split(i),0),this.children[n].merge(i,this.children[n].length,null,!1,0,0),n++);for(let e=n;e<this.children.length;e++)t.append(this.children[e],0);for(;n>0&&0==this.children[n-1].length;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){!this.dom||(e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){on(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){nn(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=sn(t,this.attrs||{})),n&&(this.attrs=sn({class:n},this.attrs||{}))}domAtPos(e){return tn(this.dom,this.children,e)}reuseDOM(e){"DIV"==e.nodeName&&(this.setDOM(e),this.dirty|=6)}sync(e){var t;this.dom?4&this.dirty&&(_t(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(an(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e);let n=this.dom.lastChild;for(;n&&Pt.get(n)instanceof Gt;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(t=Pt.get(n))||void 0===t?void 0:t.isEditable)||jt.ios&&this.children.some((e=>e instanceof qt))))){let e=document.createElement("BR");e.cmIgnore=!0,this.dom.appendChild(e)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let e=0;for(let t of this.children){if(!(t instanceof qt))return null;let n=ft(t.dom);if(1!=n.length)return null;e+=n[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}}coordsAt(e,t){return rn(this,e,t)}become(e){return!1}get type(){return hn.Text}static find(e,t){for(let n=0,i=0;n<e.children.length;n++){let r=e.children[n],s=i+r.length;if(s>=t){if(r instanceof gn)return r;if(s>t)break}i=s+r.breakAfter}return null}},On=class extends Pt{constructor(e,t,n){super(),this.widget=e,this.length=t,this.type=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,i,r,s){return!(n&&(!(n instanceof On&&this.widget.compare(n.widget))||e>0&&r<=0||t<this.length&&s<=0))&&(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return 0==e?Et.before(this.dom):Et.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new On(this.widget,t,this.type);return n.breakAfter=this.breakAfter,n}get children(){return Tt}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):a.empty}domBoundsAround(){return null}become(e){return e instanceof On&&e.type==this.type&&e.widget.constructor==this.widget.constructor&&(e.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},yn=class{constructor(e,t,n,i){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof On&&e.type==hn.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new gn),this.atCursorPos=!0),this.curLine}flushBuffer(e){this.pendingBuffer&&(this.curLine.append(vn(new en(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer([]),this.curLine=null,this.content.push(e)}finish(e){e?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:t,lineBreak:n,done:i}=this.cursor.next(this.skip);if(this.skip=0,i)throw new Error("Ran out of text content when drawing inline views");if(n){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,e--;continue}this.text=t,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(0,n)),this.getLine().append(vn(new qt(this.text.slice(this.textOff,this.textOff+i)),t),n),this.atCursorPos=!0,this.textOff+=i,e-=i,n=0}}span(e,t,n,i){this.buildText(t-e,n,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,n,i,r,s){if(this.disallowBlockEffectsFor[s]&&n instanceof pn){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(n instanceof pn)if(n.block){let{type:e}=n;e==hn.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new On(n.widget||new bn("div"),o,e))}else{let s=Ht.create(n.widget||new bn("span"),o,n.startSide),a=this.atCursorPos&&!s.isEditable&&r<=i.length&&(e<t||n.startSide>0),l=!s.isEditable&&(e<t||n.startSide<=0),h=this.getLine();2==this.pendingBuffer&&!a&&(this.pendingBuffer=0),this.flushBuffer(i),a&&(h.append(vn(new en(1),i),r),r=i.length+Math.max(0,r-i.length)),h.append(vn(s,i),r),this.atCursorPos=l,this.pendingBuffer=l?e<t?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=r)}static build(e,t,n,i,r){let s=new yn(e,t,n,r);return s.openEnd=Re.spans(i,t,n,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}};function vn(e,t){for(let n of t)e=new Gt(n,[e],e.length);return e}var bn=class extends ln{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}},wn=[],xn=U.define(),Sn=U.define(),kn=U.define(),An=U.define(),Cn=U.define(),_n=U.define(),En=U.define({combine:e=>e.some((e=>e))}),Tn=class{constructor(e,t="nearest",n="nearest",i=5,r=5){this.range=e,this.y=t,this.x=n,this.yMargin=i,this.xMargin=r}map(e){return e.empty?this:new Tn(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}},Pn=Oe.define({map:(e,t)=>e.map(t)});function $n(e,t,n){let i=e.facet(An);i.length?i[0](t):window.onerror&&window.onerror(String(t),n,void 0,void 0,t)}var Nn=U.define({combine:e=>!e.length||e[0]}),In=0,Qn=U.define(),Rn=class{constructor(e,t,n,i){this.id=e,this.create=t,this.domEventHandlers=n,this.extension=i(this)}static define(e,t){let{eventHandlers:n,provide:i,decorations:r}=t||{};return new Rn(In++,e,n,(e=>{let t=[Qn.of(e)];return r&&t.push(Xn.of((t=>{let n=t.plugin(e);return n?r(n):cn.none}))),i&&t.push(i(e)),t}))}static fromClass(e,t){return Rn.define((t=>new e(t)),t)}},Mn=class{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(t){if($n(e.state,t,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){$n(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(null!==(t=this.value)&&void 0!==t&&t.destroy)try{this.value.destroy()}catch(t){$n(e.state,t,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}},Bn=U.define(),Dn=U.define(),Xn=U.define(),Fn=U.define(),Ln=U.define(),Un=U.define(),Vn=class{constructor(e,t,n,i){this.fromA=e,this.toA=t,this.fromB=n,this.toB=i}join(e){return new Vn(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(0==t.length)return e;let n=[];for(let i=0,r=0,s=0,o=0;;i++){let a=i==e.length?null:e[i],l=s-o,h=a?a.fromB:1e9;for(;r<t.length&&t[r]<h;){let e=t[r],i=t[r+1],s=Math.max(o,e),a=Math.min(h,i);if(s<=a&&new Vn(s+l,a+l,s,a).addToSet(n),i>h)break;r+=2}if(!a)return n;new Vn(a.fromA,a.toA,a.fromB,a.toB).addToSet(n),s=a.toA,o=a.toB}}},zn=class{constructor(e,t,n=wn){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=P.empty(this.startState.doc.length);for(let e of n)this.changes=this.changes.compose(e.changes);let i=[];this.changes.iterChangedRanges(((e,t,n,r)=>i.push(new Vn(e,t,n,r)))),this.changedRanges=i;let r=e.hasFocus;r!=e.inputState.notifiedFocused&&(e.inputState.notifiedFocused=r,this.flags|=1)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((e=>e.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}},Zn=function(e){return e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e}(Zn||(Zn={})),jn=Zn.LTR,qn=Zn.RTL;function Gn(e){let t=[];for(let n=0;n<e.length;n++)t.push(1<<+e[n]);return t}var Wn=Gn("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Hn=Gn("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Yn=Object.create(null),Jn=[];for(let e of["()","[]","{}"]){let t=e.charCodeAt(0),n=e.charCodeAt(1);Yn[t]=n,Yn[n]=-t}function Kn(e){return e<=247?Wn[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?Hn[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8203||8204==e?256:1}var ei=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,ti=class{constructor(e,t,n){this.from=e,this.to=t,this.level=n}get dir(){return this.level%2?qn:jn}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,n,i){let r=-1;for(let s=0;s<e.length;s++){let o=e[s];if(o.from<=t&&o.to>=t){if(o.level==n)return s;(r<0||(0!=i?i<0?o.from<t:o.to>t:e[r].level>o.level))&&(r=s)}}if(r<0)throw new RangeError("Index out of range");return r}},ni=[];function ii(e){return[new ti(0,e,0)]}var ri="";function si(e,t,n,i,r){var s;let o=i.head-e.from,a=-1;if(0==o){if(!r||!e.length)return null;t[0].level!=n&&(o=t[0].side(!1,n),a=0)}else if(o==e.length){if(r)return null;let e=t[t.length-1];e.level!=n&&(o=e.side(!0,n),a=t.length-1)}a<0&&(a=ti.find(t,o,null!==(s=i.bidiLevel)&&void 0!==s?s:-1,i.assoc));let l=t[a];o==l.side(r,n)&&(l=t[a+=r?1:-1],o=l.side(!r,n));let h=r==(l.dir==n),c=v(e.text,o,h);if(ri=e.text.slice(Math.min(o,c),Math.max(o,c)),c!=l.side(r,n))return D.cursor(c+e.from,h?-1:1,l.level);let u=a==(r?t.length-1:0)?null:t[a+(r?1:-1)];return u||l.level==n?u&&u.level<l.level?D.cursor(u.side(!r,n)+e.from,r?1:-1,u.level):D.cursor(c+e.from,r?-1:1,l.level):D.cursor(r?e.to:e.from,r?-1:1,n)}var oi="",ai=class{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(Te.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=oi}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let i=e;;){this.findPointBefore(n,i),this.readNode(i);let e=i.nextSibling;if(e==t)break;let r=Pt.get(i),s=Pt.get(e);(r&&s?r.breakAfter:(r?r.breakAfter:li(i))||li(e)&&("BR"!=i.nodeName||i.cmIgnore))&&this.lineBreak(),i=e}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let r,s=-1,o=1;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(r=i.exec(t))&&(s=r.index,o=r[0].length),this.append(t.slice(n,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let t of this.points)t.node==e&&t.pos>this.text.length&&(t.pos-=o-1);n=s+o}}readNode(e){if(e.cmIgnore)return;let t=Pt.get(e),n=t&&t.overrideDOMText;if(null!=n){this.findPointInside(e,n.length);for(let e=n.iter();!e.next().done;)e.lineBreak?this.lineBreak():this.append(e.value)}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(3==e.nodeType?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+Math.min(t,n.offset))}};function li(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}var hi=class{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}},ci=class extends Pt{constructor(e){super(),this.view=e,this.compositionDeco=cn.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new gn],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Vn(0,0,0,e.state.doc.length)],0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every((({fromA:e,toA:t})=>t<this.minWidthFrom||e>this.minWidthTo))?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=cn.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=function(e,t){let n=di(e);if(!n)return cn.none;let{from:i,to:r,node:s,text:o}=n,a=t.mapPos(i,1),l=Math.max(a,t.mapPos(r,-1)),{state:h}=e,c=3==s.nodeType?s.nodeValue:new ai([],h).readRange(s.firstChild,null).text;if(l-a<c.length)if(h.doc.sliceString(a,Math.min(h.doc.length,a+c.length),oi)==c)l=a+c.length;else{if(h.doc.sliceString(Math.max(0,l-c.length),l,oi)!=c)return cn.none;a=l-c.length}else if(h.doc.sliceString(a,l,oi)!=c)return cn.none;let u=Pt.get(s);return u instanceof Yt?u=u.widget.topView:u&&(u.parent=null),cn.set(cn.replace({widget:new pi(s,o,u)}).range(a,l))}(this.view,e.changes)),(jt.ie||jt.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let n=function(e,t,n){let i=new class{constructor(){this.changes=[]}compareRange(e,t){mn(e,t,this.changes)}comparePoint(e,t){mn(e,t,this.changes)}};return Re.compare(e,t,n,i),i.changes}(this.decorations,this.updateDeco(),e.changes);return t=Vn.extendWithRanges(t,n),(0!=this.dirty||0!=t.length)&&(this.updateInner(t,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);let{observer:n}=this.view;n.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.minWidth=this.minWidth?this.minWidth+"px":"";let e=jt.chrome||jt.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(e),this.dirty=0,e&&(e.written||n.selectionRange.focusNode!=e.node)&&(this.forceSelection=!0),this.dom.style.height=""}));let i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let e of this.children)e instanceof On&&e.widget instanceof ui&&i.push(e.dom);n.updateGaps(i)}updateChildren(e,t){let n=this.childCursor(t);for(let t=e.length-1;;t--){let i=t>=0?e[t]:null;if(!i)break;let{fromA:r,toA:s,fromB:o,toB:a}=i,{content:l,breakAtStart:h,openStart:c,openEnd:u}=yn.build(this.view.state.doc,o,a,this.decorations,this.dynamicDecorationMap),{i:d,off:p}=n.findPos(s,1),{i:f,off:m}=n.findPos(r,-1);It(this,f,m,d,p,l,h,c,u)}}updateSelection(e=!1,t=!1){if(e&&this.view.observer.readSelectionRange(),!t&&!this.mayControlSelection()||jt.ios&&this.view.inputState.rapidCompositionStart)return;let n=this.forceSelection;this.forceSelection=!1;let i=this.view.state.selection.main,r=this.domAtPos(i.anchor),s=i.empty?r:this.domAtPos(i.head);if(jt.gecko&&i.empty&&function(e){return 1==e.node.nodeType&&e.node.firstChild&&(0==e.offset||"false"==e.node.childNodes[e.offset-1].contentEditable)&&(e.offset==e.node.childNodes.length||"false"==e.node.childNodes[e.offset].contentEditable)}(r)){let e=document.createTextNode("");this.view.observer.ignore((()=>r.node.insertBefore(e,r.node.childNodes[r.offset]||null))),r=s=new Et(e,0),n=!0}let o=this.view.observer.selectionRange;(n||!o.focusNode||!mt(r.node,r.offset,o.anchorNode,o.anchorOffset)||!mt(s.node,s.offset,o.focusNode,o.focusOffset))&&(this.view.observer.ignore((()=>{jt.android&&jt.chrome&&this.dom.contains(o.focusNode)&&function(e,t){for(let n=e;n&&n!=t;n=n.assignedSlot||n.parentNode)if(1==n.nodeType&&"false"==n.contentEditable)return!0;return!1}(o.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let e=ut(this.root);if(i.empty){if(jt.gecko){let e=function(e,t){return 1!=e.nodeType?0:(t&&"false"==e.childNodes[t-1].contentEditable?1:0)|(t<e.childNodes.length&&"false"==e.childNodes[t].contentEditable?2:0)}(r.node,r.offset);if(e&&3!=e){let t=fi(r.node,r.offset,1==e?1:-1);t&&(r=new Et(t,1==e?0:t.nodeValue.length))}}e.collapse(r.node,r.offset),null!=i.bidiLevel&&null!=o.cursorBidiLevel&&(o.cursorBidiLevel=i.bidiLevel)}else if(e.extend)e.collapse(r.node,r.offset),e.extend(s.node,s.offset);else{let t=document.createRange();i.anchor>i.head&&([r,s]=[s,r]),t.setEnd(s.node,s.offset),t.setStart(r.node,r.offset),e.removeAllRanges(),e.addRange(t)}})),this.view.observer.setSelectionRange(r,s)),this.impreciseAnchor=r.precise?null:new Et(o.anchorNode,o.anchorOffset),this.impreciseHead=s.precise?null:new Et(o.focusNode,o.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let e=this.view.state.selection.main,t=ut(this.root);if(!e.empty||!e.assoc||!t.modify)return;let n=gn.find(this,e.head);if(!n)return;let i=n.posAtStart;if(e.head==i||e.head==i+n.length)return;let r=this.coordsAt(e.head,-1),s=this.coordsAt(e.head,1);if(!r||!s||r.bottom>s.top)return;let o=this.domAtPos(e.head+e.assoc);t.collapse(o.node,o.offset),t.modify("move",e.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){return this.view.state.facet(Nn)?this.root.activeElement==this.dom:pt(this.dom,this.view.observer.selectionRange)}nearest(e){for(let t=e;t;){let e=Pt.get(t);if(e&&e.rootView==this)return e;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let e=this.children[t];if(n<e.length||e instanceof gn)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){for(let n=this.length,i=this.children.length-1;;i--){let r=this.children[i],s=n-r.breakAfter-r.length;if(e>s||e==s&&r.type!=hn.WidgetBefore&&r.type!=hn.WidgetAfter&&(!i||2==t||this.children[i-1].breakAfter||this.children[i-1].type==hn.WidgetBefore&&t>-2))return r.coordsAt(e-s,t);n=s}}measureVisibleLineHeights(e){let t=[],{from:n,to:i}=e,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,a=this.view.textDirection==Zn.LTR;for(let e=0,l=0;l<this.children.length;l++){let h=this.children[l],c=e+h.length;if(c>i)break;if(e>=n){let n=h.dom.getBoundingClientRect();if(t.push(n.height),s){let t=h.dom.lastChild,i=t?ft(t):[];if(i.length){let t=i[i.length-1],s=a?t.right-n.left:n.right-t.left;s>o&&(o=s,this.minWidth=r,this.minWidthFrom=e,this.minWidthTo=c)}}}e=c+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return"rtl"==getComputedStyle(this.children[t].dom).direction?Zn.RTL:Zn.LTR}measureTextSize(){for(let e of this.children)if(e instanceof gn){let t=e.measureTextSize();if(t)return t}let e,t,n=document.createElement("div");return n.className="cm-line",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let i=ft(n.firstChild)[0];e=n.getBoundingClientRect().height,t=i?i.width/27:7,n.remove()})),{lineHeight:e,charWidth:t}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Nt(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,i=0;;i++){let r=i==t.viewports.length?null:t.viewports[i],s=r?r.from-1:this.length;if(s>n){let i=t.lineBlockAt(s).bottom-t.lineBlockAt(n).top;e.push(cn.replace({widget:new ui(i),block:!0,inclusive:!0,isBlockGap:!0}).range(n,s))}if(!r)break;n=r.to+1}return cn.set(e)}updateDeco(){let e=this.view.state.facet(Xn).map(((e,t)=>(this.dynamicDecorationMap[t]="function"==typeof e)?e(this.view):e));for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let t,{range:n}=e,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1);if(!i)return;!n.empty&&(t=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,t.left),top:Math.min(i.top,t.top),right:Math.max(i.right,t.right),bottom:Math.max(i.bottom,t.bottom)});let r=0,s=0,o=0,a=0;for(let e of this.view.state.facet(Ln).map((e=>e(this.view))))if(e){let{left:t,right:n,top:i,bottom:l}=e;null!=t&&(r=Math.max(r,t)),null!=n&&(s=Math.max(s,n)),null!=i&&(o=Math.max(o,i)),null!=l&&(a=Math.max(a,l))}let l={left:i.left-r,top:i.top-o,right:i.right+s,bottom:i.bottom+a};!function(e,t,n,i,r,s,o,a){let l=e.ownerDocument,h=l.defaultView;for(let c=e;c;)if(1==c.nodeType){let e,u=c==l.body;if(u)e=wt(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let t=c.getBoundingClientRect();e={left:t.left,right:t.left+c.clientWidth,top:t.top,bottom:t.top+c.clientHeight}}let d=0,p=0;if("nearest"==r)t.top<e.top?(p=-(e.top-t.top+o),n>0&&t.bottom>e.bottom+p&&(p=t.bottom-e.bottom+p+o)):t.bottom>e.bottom&&(p=t.bottom-e.bottom+o,n<0&&t.top-p<e.top&&(p=-(e.top+p-t.top+o)));else{let i=t.bottom-t.top,s=e.bottom-e.top;p=("center"==r&&i<=s?t.top+i/2-s/2:"start"==r||"center"==r&&n<0?t.top-o:t.bottom-s+o)-e.top}if("nearest"==i?t.left<e.left?(d=-(e.left-t.left+s),n>0&&t.right>e.right+d&&(d=t.right-e.right+d+s)):t.right>e.right&&(d=t.right-e.right+s,n<0&&t.left<e.left+d&&(d=-(e.left+d-t.left+s))):d=("center"==i?t.left+(t.right-t.left)/2-(e.right-e.left)/2:"start"==i==a?t.left-s:t.right-(e.right-e.left)+s)-e.left,d||p)if(u)h.scrollBy(d,p);else{if(p){let e=c.scrollTop;c.scrollTop+=p,p=c.scrollTop-e}if(d){let e=c.scrollLeft;c.scrollLeft+=d,d=c.scrollLeft-e}t={left:t.left-d,top:t.top-p,right:t.right-d,bottom:t.bottom-p}}if(u)break;c=c.assignedSlot||c.parentNode,i=r="nearest"}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,l,n.head<n.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==Zn.LTR)}};var ui=class extends ln{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}};function di(e){let t=e.observer.selectionRange,n=t.focusNode&&fi(t.focusNode,t.focusOffset,0);if(!n)return null;let i=e.docView.nearest(n);if(!i)return null;if(i instanceof gn){let e=n;for(;e.parentNode!=i.dom;)e=e.parentNode;let t=e.previousSibling;for(;t&&!Pt.get(t);)t=t.previousSibling;let r=t?Pt.get(t).posAtEnd:i.posAtStart;return{from:r,to:r,node:e,text:n}}{for(;;){let{parent:e}=i;if(!e)return null;if(e instanceof gn)break;i=e}let e=i.posAtStart;return{from:e,to:e+i.length,node:i.dom,text:n}}}var pi=class extends ln{constructor(e,t,n){super(),this.top=e,this.text=t,this.topView=n}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return Yt}};function fi(e,t,n){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0&&n<=0)t=yt(e=e.childNodes[t-1]);else{if(!(1==e.nodeType&&t<e.childNodes.length&&n>=0))return null;e=e.childNodes[t],t=0}}}function mi(e,t){return t.left>e?t.left-e:Math.max(0,e-t.right)}function gi(e,t){return t.top>e?t.top-e:Math.max(0,e-t.bottom)}function Oi(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function yi(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function vi(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function bi(e,t,n){let i,r,s,o,a,l,h,c;for(let u=e.firstChild;u;u=u.nextSibling){let e=ft(u);for(let d=0;d<e.length;d++){let p=e[d];r&&Oi(r,p)&&(p=yi(vi(p,r.bottom),r.top));let f=mi(t,p),m=gi(n,p);if(0==f&&0==m)return 3==u.nodeType?wi(u,t,n):bi(u,t,n);(!i||o>m||o==m&&s>f)&&(i=u,r=p,s=f,o=m),0==f?n>p.bottom&&(!h||h.bottom<p.bottom)?(a=u,h=p):n<p.top&&(!c||c.top>p.top)&&(l=u,c=p):h&&Oi(h,p)?h=vi(h,p.bottom):c&&Oi(c,p)&&(c=yi(c,p.top))}}if(h&&h.bottom>=n?(i=a,r=h):c&&c.top<=n&&(i=l,r=c),!i)return{node:e,offset:0};let u=Math.max(r.left,Math.min(r.right,t));return 3==i.nodeType?wi(i,u,n):s||"true"!=i.contentEditable?{node:e,offset:Array.prototype.indexOf.call(e.childNodes,i)+(t>=(r.left+r.right)/2?1:0)}:bi(i,u,n)}function wi(e,t,n){let i=e.nodeValue.length,r=-1,s=1e9,o=0;for(let a=0;a<i;a++){let i=At(e,a,a+1).getClientRects();for(let l=0;l<i.length;l++){let h=i[l];if(h.top==h.bottom)continue;o||(o=t-h.left);let c=(h.top>n?h.top-n:n-h.bottom)-1;if(h.left-1<=t&&h.right+1>=t&&c<s){let n=t>=(h.left+h.right)/2,i=n;if((jt.chrome||jt.gecko)&&At(e,a).getBoundingClientRect().left==h.right&&(i=!n),c<=0)return{node:e,offset:a+(i?1:0)};r=a+(i?1:0),s=c}}}return{node:e,offset:r>-1?r:o>0?e.nodeValue.length:0}}function xi(e,{x:t,y:n},i,r=-1){var s;let o,a=e.contentDOM.getBoundingClientRect(),l=a.top+e.viewState.paddingTop,{docHeight:h}=e.viewState,c=n-l;if(c<0)return 0;if(c>h)return e.state.doc.length;for(let t=e.defaultLineHeight/2,n=!1;o=e.elementAtHeight(c),o.type!=hn.Text;)for(;c=r>0?o.bottom+t:o.top-t,!(c>=0&&c<=h);){if(n)return i?null:0;n=!0,r=-r}n=l+c;let u=o.from;if(u<e.viewport.from)return 0==e.viewport.from?0:i?null:Si(e,a,o,t,n);if(u>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:i?null:Si(e,a,o,t,n);let d=e.dom.ownerDocument,p=e.root.elementFromPoint?e.root:d,f=p.elementFromPoint(t,n);f&&!e.contentDOM.contains(f)&&(f=null),f||(t=Math.max(a.left+1,Math.min(a.right-1,t)),f=p.elementFromPoint(t,n),f&&!e.contentDOM.contains(f)&&(f=null));let m,g=-1;if(f&&0!=(null===(s=e.docView.nearest(f))||void 0===s?void 0:s.isEditable))if(d.caretPositionFromPoint){let e=d.caretPositionFromPoint(t,n);e&&({offsetNode:m,offset:g}=e)}else if(d.caretRangeFromPoint){let e=d.caretRangeFromPoint(t,n);e&&(({startContainer:m,startOffset:g}=e),jt.safari&&function(e,t,n){let i;if(3!=e.nodeType||t!=(i=e.nodeValue.length))return!1;for(let t=e.nextSibling;t;t=t.nextSibling)if(1!=t.nodeType||"BR"!=t.nodeName)return!1;return At(e,i-1,i).getBoundingClientRect().left>n}(m,g,t)&&(m=void 0))}if(!m||!e.docView.dom.contains(m)){let i=gn.find(e.docView,u);if(!i)return c>o.top+o.height/2?o.to:o.from;({node:m,offset:g}=bi(i.dom,t,n))}return e.docView.posFromDOM(m,g)}function Si(e,t,n,i,r){let s=Math.round((i-t.left)*e.defaultCharacterWidth);e.lineWrapping&&n.height>1.5*e.defaultLineHeight&&(s+=Math.floor((r-n.top)/e.defaultLineHeight)*e.viewState.heightOracle.lineLength);let o=e.state.sliceDoc(n.from,n.to);return n.from+Ge(o,s,e.state.tabSize)}function ki(e,t,n,i){let r=e.state.doc.lineAt(t.head),s=e.bidiSpans(r),o=e.textDirectionAt(r.from);for(let a=t,l=null;;){let t=si(r,s,o,a,n),h=ri;if(!t){if(r.number==(n?e.state.doc.lines:1))return a;h="\n",r=e.state.doc.line(r.number+(n?1:-1)),s=e.bidiSpans(r),t=D.cursor(n?r.from:r.to)}if(l){if(!l(h))return a}else{if(!i)return t;l=i(h)}a=t}}function Ai(e,t,n){let i=e.state.facet(Fn).map((t=>t(e)));for(;;){let e=!1;for(let r of i)r.between(n.from-1,n.from+1,((i,r,s)=>{n.from>i&&n.from<r&&(n=t.from>n.from?D.cursor(i,1):D.cursor(r,-1),e=!0)}));if(!e)return n}}var Ci=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],_i=[16,17,18,20,91,92,224,225];function Ei(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n,i=t.target;i!=e.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||(n=Pt.get(i))&&n.ignoreEvent(t))return!1;return!0}var Ti=Object.create(null),Pi=jt.ie&&jt.ie_version<15||jt.ios&&jt.webkit_version<604;function $i(e,t){let n,{state:i}=e,r=1,s=i.toText(t),o=s.lines==i.selection.ranges.length;if(null!=zi&&i.selection.ranges.every((e=>e.empty))&&zi==s.toString()){let e=-1;n=i.changeByRange((n=>{let a=i.doc.lineAt(n.from);if(a.from==e)return{range:n};e=a.from;let l=i.toText((o?s.line(r++).text:t)+i.lineBreak);return{changes:{from:a.from,insert:l},range:D.cursor(n.from+l.length)}}))}else n=o?i.changeByRange((e=>{let t=s.line(r++);return{changes:{from:e.from,to:e.to,insert:t.text},range:D.cursor(e.from+t.length)}})):i.replaceSelection(s);e.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Ti.keydown=(e,t)=>{e.inputState.setSelectionOrigin("select"),27==t.keyCode?e.inputState.lastEscPress=Date.now():_i.indexOf(t.keyCode)<0&&(e.inputState.lastEscPress=0)};var Ni=0;function Ii(e,t,n,i){if(1==i)return D.cursor(t,n);if(2==i)return function(e,t,n=1){let i=e.charCategorizer(t),r=e.doc.lineAt(t),s=t-r.from;if(0==r.length)return D.cursor(t);0==s?n=1:s==r.length&&(n=-1);let o=s,a=s;n<0?o=v(r.text,s,!1):a=v(r.text,s);let l=i(r.text.slice(o,a));for(;o>0;){let e=v(r.text,o,!1);if(i(r.text.slice(e,o))!=l)break;o=e}for(;a<r.length;){let e=v(r.text,a);if(i(r.text.slice(a,e))!=l)break;a=e}return D.range(o+r.from,a+r.from)}(e.state,t,n);{let n=gn.find(e.docView,t),i=e.state.doc.lineAt(n?n.posAtEnd:t),r=n?n.posAtStart:i.from,s=n?n.posAtEnd:i.to;return s<e.state.doc.length&&s==i.to&&s++,D.range(r,s)}}Ti.touchstart=(e,t)=>{Ni=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},Ti.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},Ti.mousedown=(e,t)=>{if(e.observer.flush(),Ni>Date.now()-2e3&&1==Ui(t))return;let n=null;for(let i of e.state.facet(kn))if(n=i(e,t),n)break;if(!n&&0==t.button&&(n=function(e,t){let n=Bi(e,t),i=Ui(t),r=e.state.selection,s=n,o=t;return{update(e){e.docChanged&&(n&&(n.pos=e.changes.mapPos(n.pos)),r=r.map(e.changes),o=null)},get(t,a,l){let h;if(o&&t.clientX==o.clientX&&t.clientY==o.clientY?h=s:(h=s=Bi(e,t),o=t),!h||!n)return r;let c=Ii(e,h.pos,h.bias,i);if(n.pos!=h.pos&&!a){let t=Ii(e,n.pos,n.bias,i),r=Math.min(t.from,c.from),s=Math.max(t.to,c.to);c=r<c.from?D.range(r,s):D.range(s,r)}return a?r.replaceRange(r.main.extend(c.from,c.to)):l?r.addRange(c):D.create([c])}}}(e,t)),n){let i=e.root.activeElement!=e.contentDOM;i&&e.observer.ignore((()=>kt(e.contentDOM))),e.inputState.startMouseSelection(new class{constructor(e,t,n,i){this.view=e,this.style=n,this.mustSelect=i,this.lastEvent=t;let r=e.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Te.allowMultipleSelections)&&function(e,t){let n=e.state.facet(xn);return n.length?n[0](t):jt.mac?t.metaKey:t.ctrlKey}(e,t),this.dragMove=function(e,t){let n=e.state.facet(Sn);return n.length?n[0](t):jt.mac?!t.altKey:!t.ctrlKey}(e,t),this.dragging=!(!function(e,t){let{main:n}=e.state.selection;if(n.empty)return!1;let i=ut(e.root);if(0==i.rangeCount)return!0;let r=i.getRangeAt(0).getClientRects();for(let e=0;e<r.length;e++){let n=r[e];if(n.left<=t.clientX&&n.right>=t.clientX&&n.top<=t.clientY&&n.bottom>=t.clientY)return!0}return!1}(e,t)||1!=Ui(t))&&null,!1===this.dragging&&(t.preventDefault(),this.select(t))}move(e){if(0==e.buttons)return this.destroy();!1===this.dragging&&this.select(this.lastEvent=e)}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(e){let t=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:t,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout((()=>this.select(this.lastEvent)),20)}}(e,t,n,i))}};var Qi=(e,t)=>e>=t.top&&e<=t.bottom,Ri=(e,t,n)=>Qi(t,n)&&e>=n.left&&e<=n.right;function Mi(e,t,n,i){let r=gn.find(e.docView,t);if(!r)return 1;let s=t-r.posAtStart;if(0==s)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&Ri(n,i,o))return-1;let a=r.coordsAt(s,1);return a&&Ri(n,i,a)?1:o&&Qi(i,o)?-1:1}function Bi(e,t){let n=e.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:n,bias:Mi(e,n,t.clientX,t.clientY)}}var Di=jt.ie&&jt.ie_version<=11,Xi=null,Fi=0,Li=0;function Ui(e){if(!Di)return e.detail;let t=Xi,n=Li;return Xi=e,Li=Date.now(),Fi=!t||n>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(Fi+1)%3:1}function Vi(e,t,n,i){if(!n)return;let r=e.posAtCoords({x:t.clientX,y:t.clientY},!1);t.preventDefault();let{mouseSelection:s}=e.inputState,o=i&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,a={from:r,insert:n},l=e.state.changes(o?[o,a]:a);e.focus(),e.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}Ti.dragstart=(e,t)=>{let{selection:{main:n}}=e.state,{mouseSelection:i}=e.inputState;i&&(i.dragging=n),t.dataTransfer&&(t.dataTransfer.setData("Text",e.state.sliceDoc(n.from,n.to)),t.dataTransfer.effectAllowed="copyMove")},Ti.drop=(e,t)=>{if(!t.dataTransfer)return;if(e.state.readOnly)return t.preventDefault();let n=t.dataTransfer.files;if(n&&n.length){t.preventDefault();let i=Array(n.length),r=0,s=()=>{++r==n.length&&Vi(e,t,i.filter((e=>null!=e)).join(e.state.lineBreak),!1)};for(let e=0;e<n.length;e++){let t=new FileReader;t.onerror=s,t.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(t.result)||(i[e]=t.result),s()},t.readAsText(n[e])}}else Vi(e,t,t.dataTransfer.getData("Text"),!0)},Ti.paste=(e,t)=>{if(e.state.readOnly)return t.preventDefault();e.observer.flush();let n=Pi?null:t.clipboardData;n?($i(e,n.getData("text/plain")),t.preventDefault()):function(e){let t=e.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout((()=>{e.focus(),n.remove(),$i(e,n.value)}),50)}(e)};var zi=null;function Zi(e,t){if(e.docView.compositionDeco.size){e.inputState.rapidCompositionStart=t;try{e.update([])}finally{e.inputState.rapidCompositionStart=!1}}}Ti.copy=Ti.cut=(e,t)=>{let{text:n,ranges:i,linewise:r}=function(e){let t=[],n=[],i=!1;for(let i of e.selection.ranges)i.empty||(t.push(e.sliceDoc(i.from,i.to)),n.push(i));if(!t.length){let r=-1;for(let{from:i}of e.selection.ranges){let s=e.doc.lineAt(i);s.number>r&&(t.push(s.text),n.push({from:s.from,to:Math.min(e.doc.length,s.to+1)})),r=s.number}i=!0}return{text:t.join(e.lineBreak),ranges:n,linewise:i}}(e.state);if(!n&&!r)return;zi=r?n:null;let s=Pi?null:t.clipboardData;s?(t.preventDefault(),s.clearData(),s.setData("text/plain",n)):function(e,t){let n=e.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout((()=>{i.remove(),e.focus()}),50)}(e,n),"cut"==t.type&&!e.state.readOnly&&e.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"})},Ti.focus=Ti.blur=e=>{setTimeout((()=>{e.hasFocus!=e.inputState.notifiedFocused&&e.update([])}),10)},Ti.compositionstart=Ti.compositionupdate=e=>{null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0,e.docView.compositionDeco.size&&(e.observer.flush(),Zi(e,!0)))},Ti.compositionend=e=>{e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionFirstChange=null,setTimeout((()=>{e.inputState.composing<0&&Zi(e,!1)}),50)},Ti.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},Ti.beforeinput=(e,t)=>{var n;let i;if(jt.chrome&&jt.android&&(i=Ci.find((e=>e.inputType==t.inputType)))&&(e.observer.delayAndroidKey(i.key,i.keyCode),"Backspace"==i.key||"Delete"==i.key)){let t=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var n;((null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0)>t+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus())}),100)}};var ji=["pre-wrap","normal","pre-line","break-spaces"],qi=class{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}},Gi=class{constructor(e,t,n,i,r){this.from=e,this.length=t,this.top=n,this.height=i,this.type=r}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new Gi(this.from,this.length+e.length,this.top,this.height+e.height,t)}},Wi=function(e){return e[e.ByPos=0]="ByPos",e[e.ByHeight=1]="ByHeight",e[e.ByPosNoHeight=2]="ByPosNoHeight",e}(Wi||(Wi={})),Hi=.001,Yi=class{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=(e?2:0)|-3&this.flags}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>Hi&&(e.heightChanged=!0),this.height=t)}replace(e,t,n){return Yi.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,i){let r=this;for(let s=i.length-1;s>=0;s--){let{fromA:o,toA:a,fromB:l,toB:h}=i[s],c=r.lineAt(o,Wi.ByPosNoHeight,t,0,0),u=c.to>=a?c:r.lineAt(a,Wi.ByPosNoHeight,t,0,0);for(h+=u.to-a,a=u.to;s>0&&c.from<=i[s-1].toA;)o=i[s-1].fromA,l=i[s-1].fromB,s--,o<c.from&&(c=r.lineAt(o,Wi.ByPosNoHeight,t,0,0));l+=c.from-o,o=c.from;let d=ir.build(n,e,l,h);r=r.replace(o,a,d)}return r.updateHeight(n,0)}static empty(){return new Ki(0,0)}static of(e){if(1==e.length)return e[0];let t=0,n=e.length,i=0,r=0;for(;;)if(t==n)if(i>2*r){let r=e[t-1];r.break?e.splice(--t,1,r.left,null,r.right):e.splice(--t,1,r.left,r.right),n+=1+r.break,i-=r.size}else{if(!(r>2*i))break;{let t=e[n];t.break?e.splice(n,1,t.left,null,t.right):e.splice(n,1,t.left,t.right),n+=2+t.break,r-=t.size}}else if(i<r){let n=e[t++];n&&(i+=n.size)}else{let t=e[--n];t&&(r+=t.size)}let s=0;return null==e[t-1]?(s=1,t--):null==e[t]&&(s=1,n++),new tr(Yi.of(e.slice(0,t)),s,Yi.of(e.slice(n)))}};Yi.prototype.size=1;var Ji=class extends Yi{constructor(e,t,n){super(e,t),this.type=n}blockAt(e,t,n,i){return new Gi(i,this.length,n,this.height,this.type)}lineAt(e,t,n,i,r){return this.blockAt(0,n,i,r)}forEachLine(e,t,n,i,r,s){e<=r+this.length&&t>=r&&s(this.blockAt(0,n,i,r))}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(e,i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}},Ki=class extends Ji{constructor(e,t){super(e,t,hn.Text),this.collapsed=0,this.widgetHeight=0}replace(e,t,n){let i=n[0];return 1==n.length&&(i instanceof Ki||i instanceof er&&4&i.flags)&&Math.abs(this.length-i.length)<10?(i instanceof er?i=new Ki(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):Yi.of(n)}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more?this.setHeight(e,i.heights[i.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},er=class extends Yi{constructor(e){super(e,0)}lines(e,t){let n=e.lineAt(t).number,i=e.lineAt(t+this.length).number;return{firstLine:n,lastLine:i,lineHeight:this.height/(i-n+1)}}blockAt(e,t,n,i){let{firstLine:r,lastLine:s,lineHeight:o}=this.lines(t,i),a=Math.max(0,Math.min(s-r,Math.floor((e-n)/o))),{from:l,length:h}=t.line(r+a);return new Gi(l,h,n+o*a,o,hn.Text)}lineAt(e,t,n,i,r){if(t==Wi.ByHeight)return this.blockAt(e,n,i,r);if(t==Wi.ByPosNoHeight){let{from:t,to:i}=n.lineAt(e);return new Gi(t,i-t,0,0,hn.Text)}let{firstLine:s,lineHeight:o}=this.lines(n,r),{from:a,length:l,number:h}=n.lineAt(e);return new Gi(a,l,i+o*(h-s),o,hn.Text)}forEachLine(e,t,n,i,r,s){let{firstLine:o,lineHeight:a}=this.lines(n,r);for(let l=Math.max(e,r),h=Math.min(r+this.length,t);l<=h;){let t=n.lineAt(l);l==e&&(i+=a*(t.number-o)),s(new Gi(t.from,t.length,i,a,hn.Text)),i+=a,l=t.to+1}}replace(e,t,n){let i=this.length-t;if(i>0){let e=n[n.length-1];e instanceof er?n[n.length-1]=new er(e.length+i):n.push(null,new er(i-1))}if(e>0){let t=n[0];t instanceof er?n[0]=new er(e+t.length):n.unshift(new er(e-1),null)}return Yi.of(n)}decomposeLeft(e,t){t.push(new er(e-1),null)}decomposeRight(e,t){t.push(null,new er(this.length-e-1))}updateHeight(e,t=0,n=!1,i){let r=t+this.length;if(i&&i.from<=t+this.length&&i.more){let n=[],s=Math.max(t,i.from),o=-1,a=e.heightChanged;for(i.from>t&&n.push(new er(i.from-t-1).updateHeight(e,t));s<=r&&i.more;){let t=e.doc.lineAt(s).length;n.length&&n.push(null);let r=i.heights[i.index++];-1==o?o=r:Math.abs(r-o)>=Hi&&(o=-2);let a=new Ki(t,r);a.outdated=!1,n.push(a),s+=t+1}s<=r&&n.push(null,new er(r-s).updateHeight(e,s));let l=Yi.of(n);return e.heightChanged=a||o<0||Math.abs(l.height-this.height)>=Hi||Math.abs(o-this.lines(e.doc,t).lineHeight)>=Hi,l}return(n||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}},tr=class extends Yi{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return 1&this.flags}blockAt(e,t,n,i){let r=n+this.left.height;return e<r?this.left.blockAt(e,t,n,i):this.right.blockAt(e,t,r,i+this.left.length+this.break)}lineAt(e,t,n,i,r){let s=i+this.left.height,o=r+this.left.length+this.break,a=t==Wi.ByHeight?e<s:e<o,l=a?this.left.lineAt(e,t,n,i,r):this.right.lineAt(e,t,n,s,o);if(this.break||(a?l.to<o:l.from>o))return l;let h=t==Wi.ByPosNoHeight?Wi.ByPosNoHeight:Wi.ByPos;return a?l.join(this.right.lineAt(o,h,n,s,o)):this.left.lineAt(o,h,n,i,r).join(l)}forEachLine(e,t,n,i,r,s){let o=i+this.left.height,a=r+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,n,i,r,s),t>=a&&this.right.forEachLine(e,t,n,o,a,s);else{let l=this.lineAt(a,Wi.ByPos,n,i,r);e<l.from&&this.left.forEachLine(e,l.from-1,n,i,r,s),l.to>=e&&l.from<=t&&s(l),t>l.to&&this.right.forEachLine(l.to+1,t,n,o,a,s)}}replace(e,t,n){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,n));let r=[];e>0&&this.decomposeLeft(e,r);let s=r.length;for(let e of n)r.push(e);if(e>0&&nr(r,s-1),t<this.length){let e=r.length;this.decomposeRight(t,r),nr(r,e)}return Yi.of(r)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,i=n+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Yi.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,i){let{left:r,right:s}=this,o=t+r.length+this.break,a=null;return i&&i.from<=t+r.length&&i.more?a=r=r.updateHeight(e,t,n,i):r.updateHeight(e,t,n),i&&i.from<=o+s.length&&i.more?a=s=s.updateHeight(e,o,n,i):s.updateHeight(e,o,n),a?this.balanced(r,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}};function nr(e,t){let n,i;null==e[t]&&(n=e[t-1])instanceof er&&(i=e[t+1])instanceof er&&e.splice(t-1,3,new er(n.length+1+i.length))}var ir=class{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let e=Math.min(t,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof Ki?n.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new Ki(e-this.pos,-1)),this.writtenTo=e,t>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0;i<0&&(i=this.oracle.lineHeight);let r=t-e;n.block?this.addBlock(new Ji(r,i,n.type)):(r||i>=5)&&this.addLineDeco(i,r)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ki(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new er(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ki)return e;let t=new Ki(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine(),e.type==hn.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=hn.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let n=this.ensureLine();n.length+=t,n.collapsed+=t,n.widgetHeight=Math.max(n.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof Ki||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new Ki(0,-1));let n=e;for(let e of this.nodes)e instanceof Ki&&e.updateHeight(this.oracle,n),n+=e?e.length:1;return this.nodes}static build(e,t,n,i){let r=new ir(n,e);return Re.spans(t,n,i,r,0),r.finish(n)}};var rr=class{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,i){(e<t||n&&n.heightRelevant||i&&i.heightRelevant)&&mn(e,t,this.changes,5)}};function sr(e,t){let n=e.getBoundingClientRect(),i=Math.max(0,n.left),r=Math.min(innerWidth,n.right),s=Math.max(0,n.top),o=Math.min(innerHeight,n.bottom),a=e.ownerDocument.body;for(let t=e.parentNode;t&&t!=a;)if(1==t.nodeType){let e=t,n=window.getComputedStyle(e);if((e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)&&"visible"!=n.overflow){let t=e.getBoundingClientRect();i=Math.max(i,t.left),r=Math.min(r,t.right),s=Math.max(s,t.top),o=Math.min(o,t.bottom)}t="absolute"==n.position||"fixed"==n.position?e.offsetParent:e.parentNode}else{if(11!=t.nodeType)break;t=t.host}return{left:i-n.left,right:Math.max(i,r)-n.left,top:s-(n.top+t),bottom:Math.max(s,o)-(n.top+t)}}function or(e,t){let n=e.getBoundingClientRect();return{left:0,right:n.right-n.left,top:t,bottom:n.bottom-(n.top+t)}}var ar=class{constructor(e,t,n){this.from=e,this.to=t,this.size=n}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],r=t[n];if(i.from!=r.from||i.to!=r.to||i.size!=r.size)return!1}return!0}draw(e){return cn.replace({widget:new lr(this.size,e)}).range(this.from,this.to)}},lr=class extends ln{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}},hr=class{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new class{constructor(){this.doc=a.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength)),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return ji.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let i=e[n];i<0?n++:this.heightSamples[Math.floor(10*i)]||(t=!0,this.heightSamples[Math.floor(10*i)]=!0)}return t}refresh(e,t,n,i,r){let s=ji.indexOf(e)>-1,o=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=t,this.charWidth=n,this.lineLength=i,o){this.heightSamples={};for(let e=0;e<r.length;e++){let t=r[e];t<0?e++:this.heightSamples[Math.floor(10*t)]=!0}}return o}},this.scaler=gr,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Zn.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=e.facet(Xn).filter((e=>"function"!=typeof e)),this.heightMap=Yi.empty().applyChanges(this.stateDeco,a.empty,this.heightOracle.setDoc(e.doc),[new Vn(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=cn.set(this.lineGaps.map((e=>e.draw(!1)))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let i=n?t.head:t.anchor;if(!e.some((({from:e,to:t})=>i>=e&&i<=t))){let{from:t,to:n}=this.lineBlockAt(i);e.push(new cr(t,n))}}this.viewports=e.sort(((e,t)=>e.from-t.from)),this.scaler=this.heightMap.height<=7e6?gr:new Or(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(e=>{this.viewportLines.push(1==this.scaler.scale?e:yr(e,this.scaler))}))}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Xn).filter((e=>"function"!=typeof e));let i=e.changedRanges,r=Vn.extendWithRanges(i,function(e,t,n){let i=new rr;return Re.compare(e,t,n,i,0),i.changes}(n,this.stateDeco,e?e.changes:P.empty(this.state.doc.length))),s=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=s&&(e.flags|=2);let o=r.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<o.from||t.range.head>o.to)||!this.viewportIsAppropriate(o))&&(o=this.getViewport(0,t));let a=!e.changes.empty||2&e.flags||o.from!=this.viewport.from||o.to!=this.viewport.to;this.viewport=o,this.updateForViewport(),a&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),i=this.heightOracle,r=n.whiteSpace;this.defaultTextDirection="rtl"==n.direction?Zn.RTL:Zn.LTR;let s=this.heightOracle.mustRefreshForWrapping(r),o=s||this.mustMeasureContent||this.contentDOMHeight!=t.clientHeight,a=0,l=0;if(this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(o=!0),this.editorWidth=e.scrollDOM.clientWidth,a|=8),o){this.mustMeasureContent=!1,this.contentDOMHeight=t.clientHeight;let e=parseInt(n.paddingTop)||0,i=parseInt(n.paddingBottom)||0;(this.paddingTop!=e||this.paddingBottom!=i)&&(a|=8,this.paddingTop=e,this.paddingBottom=i)}let h=(this.printing?or:sr)(t,this.paddingTop),c=h.top-this.pixelViewport.top,u=h.bottom-this.pixelViewport.bottom;this.pixelViewport=h;let d=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(d!=this.inView&&(this.inView=d,d&&(o=!0)),!this.inView)return 0;let p=t.clientWidth;if((this.contentDOMWidth!=p||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=p,this.editorHeight=e.scrollDOM.clientHeight,a|=8),o){let t=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(t)&&(s=!0),s||i.lineWrapping&&Math.abs(p-this.contentDOMWidth)>i.charWidth){let{lineHeight:n,charWidth:o}=e.docView.measureTextSize();s=i.refresh(r,n,o,p/o,t),s&&(e.docView.minWidth=0,a|=8)}c>0&&u>0?l=Math.max(c,u):c<0&&u<0&&(l=Math.min(c,u)),i.heightChanged=!1;for(let n of this.viewports){let r=n.from==this.viewport.from?t:e.docView.measureVisibleLineHeights(n);this.heightMap=this.heightMap.updateHeight(i,0,s,new qi(n.from,r))}i.heightChanged&&(a|=2)}let f=!this.viewportIsAppropriate(this.viewport,l)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return f&&(this.viewport=this.getViewport(l,this.scrollTarget)),this.updateForViewport(),(2&a||f)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,r=this.state.doc,{visibleTop:s,visibleBottom:o}=this,a=new cr(i.lineAt(s-1e3*n,Wi.ByHeight,r,0,0).from,i.lineAt(o+1e3*(1-n),Wi.ByHeight,r,0,0).to);if(t){let{head:e}=t.range;if(e<a.from||e>a.to){let n,s=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=i.lineAt(e,Wi.ByPos,r,0,0);n="center"==t.y?(o.top+o.bottom)/2-s/2:"start"==t.y||"nearest"==t.y&&e<a.from?o.top:o.bottom-s,a=new cr(i.lineAt(n-500,Wi.ByHeight,r,0,0).from,i.lineAt(n+s+500,Wi.ByHeight,r,0,0).to)}}return a}mapViewport(e,t){let n=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new cr(this.heightMap.lineAt(n,Wi.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(i,Wi.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,Wi.ByPos,this.state.doc,0,0),{bottom:r}=this.heightMap.lineAt(t,Wi.ByPos,this.state.doc,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==e||i<=s-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||r>=o+Math.max(10,Math.min(n,250)))&&i>s-2e3&&r<o+2e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let i of e)t.touchesRange(i.from,i.to)||n.push(new ar(t.mapPos(i.from),t.mapPos(i.to),i.size));return n}ensureLineGaps(e){let t=[];if(this.defaultTextDirection!=Zn.LTR)return t;for(let n of this.viewportLines){if(n.length<4e3)continue;let i,r,s=ur(n.from,n.to,this.stateDeco);if(s.total<4e3)continue;if(this.heightOracle.lineWrapping){let e=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;i=dr(s,(this.visibleTop-n.top-e)/n.height),r=dr(s,(this.visibleBottom-n.top+e)/n.height)}else{let e=s.total*this.heightOracle.charWidth,t=2e3*this.heightOracle.charWidth;i=dr(s,(this.pixelViewport.left-t)/e),r=dr(s,(this.pixelViewport.right+t)/e)}let o=[];i>n.from&&o.push({from:n.from,to:i}),r<n.to&&o.push({from:r,to:n.to});let a=this.state.selection.main;a.from>=n.from&&a.from<=n.to&&fr(o,a.from-10,a.from+10),!a.empty&&a.to>=n.from&&a.to<=n.to&&fr(o,a.to-10,a.to+10);for(let{from:i,to:r}of o)r-i>1e3&&t.push(mr(e,(e=>e.from>=n.from&&e.to<=n.to&&Math.abs(e.from-i)<1e3&&Math.abs(e.to-r)<1e3))||new ar(i,r,this.gapSize(n,i,r,s)))}return t}gapSize(e,t,n,i){let r=pr(i,n)-pr(i,t);return this.heightOracle.lineWrapping?e.height*r:i.total*this.heightOracle.charWidth*r}updateLineGaps(e){ar.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=cn.set(e.map((e=>e.draw(this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];Re.spans(e,this.viewport.from,this.viewport.to,{span(e,n){t.push({from:e,to:n})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some(((e,n)=>e.from!=t[n].from||e.to!=t[n].to));return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find((t=>t.from<=e&&t.to>=e))||yr(this.heightMap.lineAt(e,Wi.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(e){return yr(this.heightMap.lineAt(this.scaler.fromDOM(e),Wi.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(e){return yr(this.heightMap.blockAt(this.scaler.fromDOM(e),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}},cr=class{constructor(e,t){this.from=e,this.to=t}};function ur(e,t,n){let i=[],r=e,s=0;return Re.spans(n,e,t,{span(){},point(e,t){e>r&&(i.push({from:r,to:e}),s+=e-r),r=t}},20),r<t&&(i.push({from:r,to:t}),s+=t-r),{total:s,ranges:i}}function dr({total:e,ranges:t},n){if(n<=0)return t[0].from;if(n>=1)return t[t.length-1].to;let i=Math.floor(e*n);for(let e=0;;e++){let{from:n,to:r}=t[e],s=r-n;if(i<=s)return n+i;i-=s}}function pr(e,t){let n=0;for(let{from:i,to:r}of e.ranges){if(t<=r){n+=t-i;break}n+=r-i}return n/e.total}function fr(e,t,n){for(let i=0;i<e.length;i++){let r=e[i];if(r.from<n&&r.to>t){let s=[];r.from<t&&s.push({from:r.from,to:t}),r.to>n&&s.push({from:n,to:r.to}),e.splice(i,1,...s),i+=s.length-1}}}function mr(e,t){for(let n of e)if(t(n))return n}var gr={toDOM:e=>e,fromDOM:e=>e,scale:1},Or=class{constructor(e,t,n){let i=0,r=0,s=0;this.viewports=n.map((({from:n,to:r})=>{let s=t.lineAt(n,Wi.ByPos,e,0,0).top,o=t.lineAt(r,Wi.ByPos,e,0,0).bottom;return i+=o-s,{from:n,to:r,top:s,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-i)/(t.height-i);for(let e of this.viewports)e.domTop=s+(e.top-r)*this.scale,s=e.domBottom=e.domTop+(e.bottom-e.top),r=e.bottom}toDOM(e){for(let t=0,n=0,i=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.top)return i+(e-n)*this.scale;if(e<=r.bottom)return r.domTop+(e-r.top);n=r.bottom,i=r.domBottom}}fromDOM(e){for(let t=0,n=0,i=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.domTop)return n+(e-i)/this.scale;if(e<=r.domBottom)return r.top+(e-r.domTop);n=r.bottom,i=r.domBottom}}};function yr(e,t){if(1==t.scale)return e;let n=t.toDOM(e.top),i=t.toDOM(e.bottom);return new Gi(e.from,e.length,n,i-n,Array.isArray(e.type)?e.type.map((e=>yr(e,t))):e.type)}var vr=U.define({combine:e=>e.join(" ")}),br=U.define({combine:e=>e.indexOf(!0)>-1}),wr=et.newName(),xr=et.newName(),Sr=et.newName(),kr={"&light":"."+xr,"&dark":"."+Sr};function Ar(e,t,n){return new et(t,{finish:t=>/&/.test(t)?t.replace(/&\w*/,(t=>{if("&"==t)return e;if(!n||!n[t])throw new RangeError(`Unsupported selector: ${t}`);return n[t]})):e+" "+t})}var Cr=Ar("."+wr,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},kr),_r={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Er=jt.ie&&jt.ie_version<=11;function Tr(e,t,n){for(;t;){let i=Pt.get(t);if(i&&i.parent==e)return i;let r=t.parentNode;t=r!=e.dom?r:n>0?t.nextSibling:t.previousSibling}return null}function Pr(e,t,n,i){let r,s,o=e.state.selection.main;if(t>-1){let i=e.docView.domBoundsAround(t,n,0);if(!i||e.state.readOnly)return;let{from:l,to:h}=i,c=e.docView.impreciseHead||e.docView.impreciseAnchor?[]:function(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}=e.observer.selectionRange;return n&&(t.push(new hi(n,i)),(r!=n||s!=i)&&t.push(new hi(r,s))),t}(e),u=new ai(c,e.state);u.readRange(i.startDOM,i.endDOM);let d=o.from,p=null;(8===e.inputState.lastKeyCode&&e.inputState.lastKeyTime>Date.now()-100||jt.android&&u.text.length<h-l)&&(d=o.to,p="end");let f=function(e,t,n,i){let r=Math.min(e.length,t.length),s=0;for(;s<r&&e.charCodeAt(s)==t.charCodeAt(s);)s++;if(s==r&&e.length==t.length)return null;let o=e.length,a=t.length;for(;o>0&&a>0&&e.charCodeAt(o-1)==t.charCodeAt(a-1);)o--,a--;if("end"==i){n-=o+Math.max(0,s-Math.min(o,a))-s}return o<s&&e.length<t.length?(s-=n<=s&&n>=o?s-n:0,a=s+(a-o),o=s):a<s&&(s-=n<=s&&n>=a?s-n:0,o=s+(o-a),a=s),{from:s,toA:o,toB:a}}(e.state.doc.sliceString(l,h,oi),u.text,d-l,p);f&&(jt.chrome&&13==e.inputState.lastKeyCode&&f.toB==f.from+2&&""==u.text.slice(f.from,f.toB)&&f.toB--,r={from:l+f.from,to:l+f.toA,insert:a.of(u.text.slice(f.from,f.toB).split(oi))}),s=function(e,t){if(0==e.length)return null;let n=e[0].pos,i=2==e.length?e[1].pos:n;return n>-1&&i>-1?D.single(n+t,i+t):null}(c,l)}else if(e.hasFocus||!e.state.facet(Nn)){let t=e.observer.selectionRange,{impreciseHead:n,impreciseAnchor:i}=e.docView,r=n&&n.node==t.focusNode&&n.offset==t.focusOffset||!dt(e.contentDOM,t.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(t.focusNode,t.focusOffset),a=i&&i.node==t.anchorNode&&i.offset==t.anchorOffset||!dt(e.contentDOM,t.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(t.anchorNode,t.anchorOffset);(r!=o.head||a!=o.anchor)&&(s=D.single(a,r))}if(r||s)if(!r&&i&&!o.empty&&s&&s.main.empty?r={from:o.from,to:o.to,insert:e.state.doc.slice(o.from,o.to)}:r&&r.from>=o.from&&r.to<=o.to&&(r.from!=o.from||r.to!=o.to)&&o.to-o.from-(r.to-r.from)<=4&&(r={from:o.from,to:o.to,insert:e.state.doc.slice(o.from,r.from).append(r.insert).append(e.state.doc.slice(r.to,o.to))}),r){let t=e.state;if(jt.ios&&e.inputState.flushIOSKey(e)||jt.android&&(r.from==o.from&&r.to==o.to&&1==r.insert.length&&2==r.insert.lines&&Ct(e.contentDOM,"Enter",13)||r.from==o.from-1&&r.to==o.to&&0==r.insert.length&&Ct(e.contentDOM,"Backspace",8)||r.from==o.from&&r.to==o.to+1&&0==r.insert.length&&Ct(e.contentDOM,"Delete",46)))return;let n,i=r.insert.toString();if(e.state.facet(_n).some((t=>t(e,r.from,r.to,i))))return;if(e.inputState.composing>=0&&e.inputState.composing++,r.from>=o.from&&r.to<=o.to&&r.to-r.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==r.from+r.insert.length)&&e.inputState.composing<0){let i=o.from<r.from?t.sliceDoc(o.from,r.from):"",s=o.to>r.to?t.sliceDoc(r.to,o.to):"";n=t.replaceSelection(e.state.toText(i+r.insert.sliceString(0,void 0,e.state.lineBreak)+s))}else{let i=t.changes(r),a=s&&!t.selection.main.eq(s.main)&&s.main.to<=i.newLength?s.main:void 0;if(t.selection.ranges.length>1&&e.inputState.composing>=0&&r.to<=o.to&&r.to>=o.to-10){let s=e.state.sliceDoc(r.from,r.to),l=di(e)||e.state.doc.lineAt(o.head),h=o.to-r.to,c=o.to-o.from;n=t.changeByRange((n=>{if(n.from==o.from&&n.to==o.to)return{changes:i,range:a||n.map(i)};let u=n.to-h,d=u-s.length;if(n.to-n.from!=c||e.state.sliceDoc(d,u)!=s||l&&n.to>=l.from&&n.from<=l.to)return{range:n};let p=t.changes({from:d,to:u,insert:r.insert}),f=n.to-o.to;return{changes:p,range:a?D.range(Math.max(0,a.anchor+f),Math.max(0,a.head+f)):n.map(p)}}))}else n={changes:i,selection:a&&t.selection.replaceRange(a)}}let a="input.type";e.composing&&(a+=".compose",e.inputState.compositionFirstChange&&(a+=".start",e.inputState.compositionFirstChange=!1)),e.dispatch(n,{scrollIntoView:!0,userEvent:a})}else if(s&&!s.main.eq(o)){let t=!1,n="select";e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),n=e.inputState.lastSelectionOrigin),e.dispatch({selection:s,scrollIntoView:t,userEvent:n})}}var $r=class{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(e=>this.update([e])),this.dispatch=this.dispatch.bind(this),this.root=e.root||function(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}(e.parent)||document,this.viewState=new hr(e.state||Te.create()),this.plugins=this.state.facet(Qn).map((e=>new Mn(e)));for(let e of this.plugins)e.update(this);this.observer=new class{constructor(e,t,n){this.view=e,this.onChange=t,this.onScrollChanged=n,this.active=!1,this.selectionRange=new class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,n,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=i}},this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver((t=>{for(let e of t)this.queue.push(e);(jt.ie&&jt.ie_version<=11||jt.ios&&e.composing)&&t.some((e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length))?this.flushSoon():this.flush()})),Er&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),window.addEventListener("resize",this.onResize=this.onResize.bind(this)),"function"==typeof ResizeObserver&&(this.resize=new ResizeObserver((()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()})),this.resize.observe(e.scrollDOM)),window.addEventListener("beforeprint",this.onPrint=this.onPrint.bind(this)),this.start(),window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this)),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some(((t,n)=>t!=e[n])))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:t}=this,n=this.selectionRange;if(t.state.facet(Nn)?t.root.activeElement!=this.dom:!pt(t.dom,n))return;let i=n.anchorNode&&t.docView.nearest(n.anchorNode);i&&i.ignoreEvent(e)||((jt.ie&&jt.ie_version<=11||jt.android&&jt.chrome)&&!t.state.selection.main.empty&&n.focusNode&&mt(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:e}=this.view,t=ut(e),n=jt.safari&&11==e.nodeType&&function(){let e=document.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}()==this.view.contentDOM&&function(e){let t=null;function n(e){e.preventDefault(),e.stopImmediatePropagation(),t=e.getTargetRanges()[0]}if(e.contentDOM.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",n,!0),!t)return null;let i=t.startContainer,r=t.startOffset,s=t.endContainer,o=t.endOffset,a=e.docView.domAtPos(e.state.selection.main.anchor);return mt(a.node,a.offset,s,o)&&([i,r,s,o]=[s,o,i,r]),{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:o}}(this.view)||t;return!this.selectionRange.eq(n)&&(this.selectionRange.setRange(n),this.selectionChanged=!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(1==n.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else{if(11!=n.nodeType)break;n=n.host}if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(let e of this.scrollTargets=t)e.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,_r),Er&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){!this.active||(this.active=!1,this.observer.disconnect(),Er&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){this.delayedAndroidKey||requestAnimationFrame((()=>{let e=this.delayedAndroidKey;this.delayedAndroidKey=null;let t=this.view.state;Ct(this.view.contentDOM,e.key,e.keyCode)?this.processRecords():this.flush(),this.view.state==t&&this.view.update([])})),(!this.delayedAndroidKey||"Enter"==e)&&(this.delayedAndroidKey={key:e,keyCode:t})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout((()=>{this.delayedFlush=-1,this.flush()}),20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let e=this.queue;for(let t of this.observer.takeRecords())e.push(t);e.length&&(this.queue=[]);let t=-1,n=-1,i=!1;for(let r of e){let e=this.readMutation(r);!e||(e.typeOver&&(i=!0),-1==t?({from:t,to:n}=e):(t=Math.min(e.from,t),n=Math.max(e.to,n)))}return{from:t,to:n,typeOver:i}}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;e&&this.readSelectionRange();let{from:t,to:n,typeOver:i}=this.processRecords(),r=this.selectionChanged&&pt(this.dom,this.selectionRange);if(t<0&&!r)return;this.selectionChanged=!1;let s=this.view.state;this.onChange(t,n,i),this.view.state==s&&this.view.update([])}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty("attributes"==e.type),"attributes"==e.type&&(t.dirty|=4),"childList"==e.type){let n=Tr(t,e.previousSibling||e.target.previousSibling,-1),i=Tr(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}return"characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}destroy(){var e,t,n;this.stop(),null===(e=this.intersection)||void 0===e||e.disconnect(),null===(t=this.gapIntersection)||void 0===t||t.disconnect(),null===(n=this.resize)||void 0===n||n.disconnect();for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),window.removeEventListener("beforeprint",this.onPrint),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}(this,((e,t,n)=>{Pr(this,e,t,n)}),(e=>{this.inputState.runScrollHandlers(this,e),this.observer.intersecting&&this.measure()})),this.inputState=new class{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let t in Ti){let n=Ti[t];e.contentDOM.addEventListener(t,(i=>{!Ei(e,i)||this.ignoreDuringComposition(i)||"keydown"==t&&this.keydown(e,i)||(this.mustFlushObserver(i)&&e.observer.forceFlush(),this.runCustomHandlers(t,e,i)?i.preventDefault():n(e,i))})),this.registeredEvents.push(t)}this.notifiedFocused=e.hasFocus,jt.safari&&e.contentDOM.addEventListener("input",(()=>null))}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,t){var n;let i;for(let r of t)if(i=null===(n=r.update(e).spec)||void 0===n?void 0:n.domEventHandlers){this.customHandlers.push({plugin:r.value,handlers:i});for(let t in i)this.registeredEvents.indexOf(t)<0&&"scroll"!=t&&(this.registeredEvents.push(t),e.contentDOM.addEventListener(t,(n=>{!Ei(e,n)||this.runCustomHandlers(t,e,n)&&n.preventDefault()})))}}runCustomHandlers(e,t,n){for(let i of this.customHandlers){let r=i.handlers[e];if(r)try{if(r.call(i.plugin,n,t)||n.defaultPrevented)return!0}catch(e){$n(t.state,e)}}return!1}runScrollHandlers(e,t){for(let n of this.customHandlers){let i=n.handlers.scroll;if(i)try{i.call(n.plugin,t,e)}catch(t){$n(e.state,t)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(jt.android&&jt.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let n;return!(!jt.ios||!(n=Ci.find((e=>e.keyCode==t.keyCode)))||t.ctrlKey||t.altKey||t.metaKey||t.synthetic||(this.pendingIOSKey=n,setTimeout((()=>this.flushIOSKey(e)),250),0))}flushIOSKey(e){let t=this.pendingIOSKey;return!!t&&(this.pendingIOSKey=void 0,Ct(e.contentDOM,t.key,t.keyCode))}ignoreDuringComposition(e){return!!/^key/.test(e.type)&&(this.composing>0||!!(jt.safari&&Date.now()-this.compositionEndedAt<100)&&(this.compositionEndedAt=0,!0))}mustFlushObserver(e){return"keydown"==e.type&&229!=e.keyCode||"compositionend"==e.type&&!jt.ios}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new ci(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}dispatch(...e){this._dispatch(1==e.length&&e[0]instanceof ye?e[0]:this.state.update(...e))}update(e){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t,n=!1,i=this.state;for(let t of e){if(t.startState!=i)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");i=t.state}if(this.destroyed)return void(this.viewState.state=i);if(i.facet(Te.phrases)!=this.state.facet(Te.phrases))return this.setState(i);t=new zn(this,i,e);let r=this.viewState.scrollTarget;try{this.updateState=2;for(let t of e){if(r&&(r=r.map(t.changes)),t.scrollIntoView){let{main:e}=t.state.selection;r=new Tn(e.empty?e:D.cursor(e.head,e.head>e.anchor?-1:1))}for(let e of t.effects)e.is(Pn)&&(r=e.value)}this.viewState.update(t,r),this.bidiCache=Qr.update(this.bidiCache,t.changes),t.empty||(this.updatePlugins(t),this.inputState.update(t)),n=this.docView.update(t),this.state.facet(Un)!=this.styleModules&&this.mountStyles(),this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some((e=>e.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(t.startState.facet(vr)!=t.state.facet(vr)&&(this.viewState.mustMeasureContent=!0),(n||r||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!t.empty)for(let e of this.state.facet(Cn))e(t)}setState(e){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=e);this.updateState=2;let t=this.hasFocus;try{for(let e of this.plugins)e.destroy(this);this.viewState=new hr(e),this.plugins=e.facet(Qn).map((e=>new Mn(e))),this.pluginMap.clear();for(let e of this.plugins)e.update(this);this.docView=new ci(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Qn),n=e.state.facet(Qn);if(t!=n){let i=[];for(let r of n){let n=t.indexOf(r);if(n<0)i.push(new Mn(r));else{let t=this.plugins[n];t.mustUpdate=e,i.push(t)}}for(let t of this.plugins)t.mustUpdate!=e&&t.destroy(this);this.plugins=i,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let t of this.plugins)t.mustUpdate=e;for(let e=0;e<this.plugins.length;e++)this.plugins[e].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.flush();let t=null;try{for(let e=0;;e++){this.updateState=1;let n=this.viewport,i=this.viewState.measure(this);if(!i&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(e>5)break;let r=[];4&i||([this.measureRequests,r]=[r,this.measureRequests]);let s=r.map((e=>{try{return e.read(this)}catch(e){return $n(this.state,e),Ir}})),o=new zn(this,this.state),a=!1,l=!1;o.flags|=i,t?t.flags|=i:t=o,this.updateState=2,o.empty||(this.updatePlugins(o),this.inputState.update(o),this.updateAttrs(),a=this.docView.update(o));for(let e=0;e<r.length;e++)if(s[e]!=Ir)try{let t=r[e];t.write&&t.write(s[e],this)}catch(e){$n(this.state,e)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,l=!0),a&&this.docView.updateSelection(!0),this.viewport.from==n.from&&this.viewport.to==n.to&&!l&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let e of this.state.facet(Cn))e(t)}get themeClasses(){return wr+" "+(this.state.facet(br)?Sr:xr)+" "+this.state.facet(vr)}updateAttrs(){let e=Rr(this,Bn,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Nn)?"true":"false",class:"cm-content",style:`${jt.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Rr(this,Dn,t),this.observer.ignore((()=>{an(this.contentDOM,this.contentAttrs,t),an(this.dom,this.editorAttrs,e)})),this.editorAttrs=e,this.contentAttrs=t}showAnnouncements(e){let t=!0;for(let n of e)for(let e of n.effects)if(e.is($r.announce)){t&&(this.announceDOM.textContent=""),t=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=e.value}}mountStyles(){this.styleModules=this.state.facet(Un),et.mount(this.root,this.styleModules.concat(Cr).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame((()=>this.measure()))),e){if(null!=e.key)for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key)return void(this.measureRequests[t]=e);this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(void 0===t||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find((t=>t.spec==e))||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Ai(this,e,ki(this,e,t,n))}moveByGroup(e,t){return Ai(this,e,ki(this,e,t,(t=>function(e,t,n){let i=e.state.charCategorizer(t),r=i(n);return e=>{let t=i(e);return r==Ce.Space&&(r=t),r==t}}(this,e.head,t))))}moveToLineBoundary(e,t,n=!0){return function(e,t,n,i){let r=e.state.doc.lineAt(t.head),s=i&&e.lineWrapping?e.coordsAtPos(t.assoc<0&&t.head>r.from?t.head-1:t.head):null;if(s){let t=e.dom.getBoundingClientRect(),i=e.textDirectionAt(r.from),o=e.posAtCoords({x:n==(i==Zn.LTR)?t.right-1:t.left+1,y:(s.top+s.bottom)/2});if(null!=o)return D.cursor(o,n?-1:1)}let o=gn.find(e.docView,t.head),a=o?n?o.posAtEnd:o.posAtStart:n?r.to:r.from;return D.cursor(a,n?-1:1)}(this,e,t,n)}moveVertically(e,t,n){return Ai(this,e,function(e,t,n,i){let r=t.head,s=n?1:-1;if(r==(n?e.state.doc.length:0))return D.cursor(r,t.assoc);let o,a=t.goalColumn,l=e.contentDOM.getBoundingClientRect(),h=e.coordsAtPos(r),c=e.documentTop;if(h)null==a&&(a=h.left-l.left),o=s<0?h.top:h.bottom;else{let t=e.viewState.lineBlockAt(r);null==a&&(a=Math.min(l.right-l.left,e.defaultCharacterWidth*(r-t.from))),o=(s<0?t.top:t.bottom)+c}let u=l.left+a,d=i??e.defaultLineHeight>>1;for(let n=0;;n+=10){let i=o+(d+n)*s,h=xi(e,{x:u,y:i},!1,s);if(i<l.top||i>l.bottom||(s<0?h<r:h>r))return D.cursor(h,t.assoc,void 0,a)}}(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),xi(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(e),r=this.bidiSpans(i);return bt(n,r[ti.find(r,e-i.from,-1,t)].dir==Zn.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(En)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Nr)return ii(e.length);let t=this.textDirectionAt(e.from);for(let n of this.bidiCache)if(n.from==e.from&&n.dir==t)return n.order;let n=function(e,t){let n=e.length,i=t==jn?1:2,r=t==jn?2:1;if(!e||1==i&&!ei.test(e))return ii(n);for(let t=0,r=i,s=i;t<n;t++){let n=Kn(e.charCodeAt(t));512==n?n=r:8==n&&4==s&&(n=16),ni[t]=4==n?2:n,7&n&&(s=n),r=n}for(let e=0,t=i,r=i;e<n;e++){let i=ni[e];if(128==i)e<n-1&&t==ni[e+1]&&24&t?i=ni[e]=t:ni[e]=256;else if(64==i){let i=e+1;for(;i<n&&64==ni[i];)i++;let s=e&&8==t||i<n&&8==ni[i]?1==r?1:8:256;for(let t=e;t<i;t++)ni[t]=s;e=i-1}else 8==i&&1==r&&(ni[e]=1);t=i,7&i&&(r=i)}for(let t,s,o,a=0,l=0,h=0;a<n;a++)if(s=Yn[t=e.charCodeAt(a)])if(s<0){for(let e=l-3;e>=0;e-=3)if(Jn[e+1]==-s){let t=Jn[e+2],n=2&t?i:4&t?1&t?r:i:0;n&&(ni[a]=ni[Jn[e]]=n),l=e;break}}else{if(189==Jn.length)break;Jn[l++]=a,Jn[l++]=t,Jn[l++]=h}else if(2==(o=ni[a])||1==o){let e=o==i;h=e?0:1;for(let t=l-3;t>=0;t-=3){let n=Jn[t+2];if(2&n)break;if(e)Jn[t+2]|=2;else{if(4&n)break;Jn[t+2]|=4}}}for(let e=0;e<n;e++)if(256==ni[e]){let t=e+1;for(;t<n&&256==ni[t];)t++;let r=1==(e?ni[e-1]:i),s=r==(1==(t<n?ni[t]:i))?r?1:2:i;for(let n=e;n<t;n++)ni[n]=s;e=t-1}let s=[];if(1==i)for(let e=0;e<n;){let t=e,i=1!=ni[e++];for(;e<n&&i==(1!=ni[e]);)e++;if(i)for(let n=e;n>t;){let e=n,i=2!=ni[--n];for(;n>t&&i==(2!=ni[n-1]);)n--;s.push(new ti(n,e,i?2:1))}else s.push(new ti(t,e,0))}else for(let e=0;e<n;){let t=e,i=2==ni[e++];for(;e<n&&i==(2==ni[e]);)e++;s.push(new ti(t,e,i?1:2))}return s}(e.text,t);return this.bidiCache.push(new Qr(e.from,e.to,t,n)),n}get hasFocus(){var e;return(document.hasFocus()||jt.safari&&(null===(e=this.inputState)||void 0===e?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{kt(this.contentDOM),this.docView.updateSelection()}))}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Pn.of(new Tn("number"==typeof e?D.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return Rn.define((()=>({})),{eventHandlers:e})}static theme(e,t){let n=et.newName(),i=[vr.of(n),Un.of(Ar(`.${n}`,e))];return t&&t.dark&&i.push(br.of(!0)),i}static baseTheme(e){return te.lowest(Un.of(Ar("."+wr,e,kr)))}};$r.styleModule=Un,$r.inputHandler=_n,$r.perLineTextDirection=En,$r.exceptionSink=An,$r.updateListener=Cn,$r.editable=Nn,$r.mouseSelectionStyle=kn,$r.dragMovesSelection=Sn,$r.clickAddsSelectionRange=xn,$r.decorations=Xn,$r.atomicRanges=Fn,$r.scrollMargins=Ln,$r.darkTheme=br,$r.contentAttributes=Dn,$r.editorAttributes=Bn,$r.lineWrapping=$r.contentAttributes.of({class:"cm-lineWrapping"}),$r.announce=Oe.define();var Nr=4096,Ir={},Qr=class{constructor(e,t,n,i){this.from=e,this.to=t,this.dir=n,this.order=i}static update(e,t){if(t.empty)return e;let n=[],i=e.length?e[e.length-1].dir:Zn.LTR;for(let r=Math.max(0,e.length-10);r<e.length;r++){let s=e[r];s.dir==i&&!t.touchesRange(s.from,s.to)&&n.push(new Qr(t.mapPos(s.from,1),t.mapPos(s.to,-1),s.dir,s.order))}return n}};function Rr(e,t,n){for(let i=e.state.facet(t),r=i.length-1;r>=0;r--){let t=i[r],s="function"==typeof t?t(e):t;s&&sn(s,n)}return n}var Mr=jt.mac?"mac":jt.windows?"win":jt.linux?"linux":"key";function Br(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}var Dr=$r.domEventHandlers({keydown:(e,t)=>Vr(Lr(t.state),e,t,"editor")}),Xr=U.define({enables:Dr}),Fr=new WeakMap;function Lr(e){let t=e.facet(Xr),n=Fr.get(t);return n||Fr.set(t,n=function(e,t=Mr){let n=Object.create(null),i=Object.create(null),r=(e,t)=>{let n=i[e];if(null==n)i[e]=t;else if(n!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},s=(e,i,s,o)=>{let a=n[e]||(n[e]=Object.create(null)),l=i.split(/ (?!$)/).map((e=>function(e,t){let n,i,r,s,o=e.split(/-(?!$)/),a=o[o.length-1];"Space"==a&&(a=" ");for(let e=0;e<o.length-1;++e){let a=o[e];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))r=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);"mac"==t?s=!0:i=!0}}return n&&(a="Alt-"+a),i&&(a="Ctrl-"+a),s&&(a="Meta-"+a),r&&(a="Shift-"+a),a}(e,t)));for(let t=1;t<l.length;t++){let n=l.slice(0,t).join(" ");r(n,!0),a[n]||(a[n]={preventDefault:!0,commands:[t=>{let i=Ur={view:t,prefix:n,scope:e};return setTimeout((()=>{Ur==i&&(Ur=null)}),4e3),!0}]})}let h=l.join(" ");r(h,!1);let c=a[h]||(a[h]={preventDefault:!1,commands:[]});c.commands.push(s),o&&(c.preventDefault=!0)};for(let n of e){let e=n[t]||n.key;if(e)for(let t of n.scope?n.scope.split(" "):["editor"])s(t,e,n.run,n.preventDefault),n.shift&&s(t,"Shift-"+e,n.shift,n.preventDefault)}return n}(t.reduce(((e,t)=>e.concat(t)),[]))),n}var Ur=null;function Vr(e,t,n,i){let r=function(e){var t=!(ct&&(e.ctrlKey||e.altKey||e.metaKey)||(ot||ht)&&e.shiftKey&&e.key&&1==e.key.length)&&e.key||(e.shiftKey?rt:it)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(t),s=1==r.length&&" "!=r,o="",a=!1;Ur&&Ur.view==n&&Ur.scope==i&&(o=Ur.prefix+" ",(a=_i.indexOf(t.keyCode)<0)&&(Ur=null));let l,h=e=>{if(e){for(let t of e.commands)if(t(n))return!0;e.preventDefault&&(a=!0)}return!1},c=e[i];if(c){if(h(c[o+Br(r,t,!s)]))return!0;if(s&&(t.shiftKey||t.altKey||t.metaKey)&&(l=it[t.keyCode])&&l!=r){if(h(c[o+Br(l,t,!0)]))return!0}else if(s&&t.shiftKey&&h(c[o+Br(r,t,!0)]))return!0}return a}var zr=!jt.ios,Zr=U.define({combine:e=>Pe(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})});var jr=class{constructor(e,t,n,i,r){this.left=e,this.top=t,this.width=n,this.height=i,this.className=r}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width>=0&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}},qr=Rn.fromClass(class{constructor(e){this.view=e,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=e.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className="cm-selectionLayer",this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(Zr).cursorBlinkRate+"ms"}update(e){let t=e.startState.facet(Zr)!=e.state.facet(Zr);(t||e.selectionSet||e.geometryChanged||e.viewportChanged)&&this.view.requestMeasure(this.measureReq),e.transactions.some((e=>e.scrollIntoView))&&(this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink"),t&&this.setBlinkRate()}readPos(){let{state:e}=this.view,t=e.facet(Zr),n=e.selection.ranges.map((e=>e.empty?[]:function(e,t){if(t.to<=e.viewport.from||t.from>=e.viewport.to)return[];let n=Math.max(t.from,e.viewport.from),i=Math.min(t.to,e.viewport.to),r=e.textDirection==Zn.LTR,s=e.contentDOM,o=s.getBoundingClientRect(),a=Hr(e),l=window.getComputedStyle(s.firstChild),h=o.left+parseInt(l.paddingLeft)+Math.min(0,parseInt(l.textIndent)),c=o.right-parseInt(l.paddingRight),u=Jr(e,n),d=Jr(e,i),p=u.type==hn.Text?u:null,f=d.type==hn.Text?d:null;if(e.lineWrapping&&(p&&(p=Yr(e,n,p)),f&&(f=Yr(e,i,f))),p&&f&&p.from==f.from)return g(O(t.from,t.to,p));{let n=p?O(t.from,null,p):y(u,!1),i=f?O(null,t.to,f):y(d,!0),r=[];return(p||u).to<(f||d).from-1?r.push(m(h,n.bottom,c,i.top)):n.bottom<i.top&&e.elementAtHeight((n.bottom+i.top)/2).type==hn.Text&&(n.bottom=i.top=(n.bottom+i.top)/2),g(n).concat(r).concat(g(i))}function m(e,t,n,i){return new jr(e-a.left,t-a.top-.01,n-e,i-t+.01,"cm-selectionBackground")}function g({top:e,bottom:t,horizontal:n}){let i=[];for(let r=0;r<n.length;r+=2)i.push(m(n[r],e,n[r+1],t));return i}function O(t,n,i){let s=1e9,o=-1e9,a=[];function l(t,n,l,u,d){let p=e.coordsAtPos(t,t==i.to?-2:2),f=e.coordsAtPos(l,l==i.from?2:-2);s=Math.min(p.top,f.top,s),o=Math.max(p.bottom,f.bottom,o),d==Zn.LTR?a.push(r&&n?h:p.left,r&&u?c:f.right):a.push(!r&&u?h:f.left,!r&&n?c:p.right)}let u=t??i.from,d=n??i.to;for(let i of e.visibleRanges)if(i.to>u&&i.from<d)for(let r=Math.max(i.from,u),s=Math.min(i.to,d);;){let i=e.state.doc.lineAt(r);for(let o of e.bidiSpans(i)){let e=o.from+i.from,a=o.to+i.from;if(e>=s)break;a>r&&l(Math.max(e,r),null==t&&e<=u,Math.min(a,s),null==n&&a>=d,o.dir)}if(r=i.to+1,r>=s)break}return 0==a.length&&l(u,null==t,d,null==n,e.textDirection),{top:s,bottom:o,horizontal:a}}function y(e,t){let n=o.top+(t?e.top:e.bottom);return{top:n,bottom:n,horizontal:[]}}}(this.view,e))).reduce(((e,t)=>e.concat(t))),i=[];for(let n of e.selection.ranges){let r=n==e.selection.main;if(n.empty?!r||zr:t.drawRangeCursor){let e=Kr(this.view,n,r);e&&i.push(e)}}return{rangePieces:n,cursors:i}}drawSel({rangePieces:e,cursors:t}){if(e.length!=this.rangePieces.length||e.some(((e,t)=>!e.eq(this.rangePieces[t])))){this.selectionLayer.textContent="";for(let t of e)this.selectionLayer.appendChild(t.draw());this.rangePieces=e}if(t.length!=this.cursors.length||t.some(((e,t)=>!e.eq(this.cursors[t])))){let e=this.cursorLayer.children;if(e.length!==t.length){this.cursorLayer.textContent="";for(let e of t)this.cursorLayer.appendChild(e.draw())}else t.forEach(((t,n)=>t.adjust(e[n])));this.cursors=t}}destroy(){this.selectionLayer.remove(),this.cursorLayer.remove()}}),Gr={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};zr&&(Gr[".cm-line"].caretColor="transparent !important");var Wr=te.highest($r.theme(Gr));function Hr(e){let t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==Zn.LTR?t.left:t.right-e.scrollDOM.clientWidth)-e.scrollDOM.scrollLeft,top:t.top-e.scrollDOM.scrollTop}}function Yr(e,t,n){let i=D.cursor(t);return{from:Math.max(n.from,e.moveToLineBoundary(i,!1,!0).from),to:Math.min(n.to,e.moveToLineBoundary(i,!0,!0).from),type:hn.Text}}function Jr(e,t){let n=e.lineBlockAt(t);if(Array.isArray(n.type))for(let e of n.type)if(e.to>t||e.to==t&&(e.to==n.to||e.type==hn.Text))return e;return n}function Kr(e,t,n){let i=e.coordsAtPos(t.head,t.assoc||1);if(!i)return null;let r=Hr(e);return new jr(i.left-r.left,i.top-r.top,-1,i.bottom-i.top,n?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}var es=Oe.define({map:(e,t)=>null==e?null:t.mapPos(e)}),ts=W.define({create:()=>null,update:(e,t)=>(null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce(((e,t)=>t.is(es)?t.value:e),e))}),ns=Rn.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let n=e.state.field(ts);null==n?null!=this.cursor&&(null===(t=this.cursor)||void 0===t||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(ts)!=n||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let e=this.view.state.field(ts),t=null!=e&&this.view.coordsAtPos(e);if(!t)return null;let n=this.view.scrollDOM.getBoundingClientRect();return{left:t.left-n.left+this.view.scrollDOM.scrollLeft,top:t.top-n.top+this.view.scrollDOM.scrollTop,height:t.bottom-t.top}}drawCursor(e){this.cursor&&(e?(this.cursor.style.left=e.left+"px",this.cursor.style.top=e.top+"px",this.cursor.style.height=e.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(ts)!=e&&this.view.dispatch({effects:es.of(e)})}},{eventHandlers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){(e.target==this.view.contentDOM||!this.view.contentDOM.contains(e.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function is(e,t,n,i,r){t.lastIndex=0;for(let s,o=e.iterRange(n,i),a=n;!o.next().done;a+=o.value.length)if(!o.lineBreak)for(;s=t.exec(o.value);)r(a+s.index,a+s.index+s[0].length,s)}var rs=null!=/x/.unicode?"gu":"g",ss=new RegExp("[\0-\b\n--\u2028\u2029\ufeff-]",rs),os={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},as=null;var ls=U.define({combine(e){let t=Pe(e,{render:null,specialChars:ss,addSpecialChars:null});return(t.replaceTabs=!function(){var e;if(null==as&&typeof document<"u"&&document.body){let t=document.body.style;as=null!=(null!==(e=t.tabSize)&&void 0!==e?e:t.MozTabSize)}return as||!1}())&&(t.specialChars=new RegExp("\t|"+t.specialChars.source,rs)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,rs)),t}});var hs=null;var cs=class extends ln{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=function(e){return e>=32?"":10==e?"":String.fromCharCode(9216+e)}(this.code),n=e.state.phrase("Control character")+" "+(os[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,t);if(i)return i;let r=document.createElement("span");return r.textContent=t,r.title=n,r.setAttribute("aria-label",n),r.className="cm-specialChar",r}ignoreEvent(){return!1}},us=class extends ln{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="\t",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}};var ds=cn.line({class:"cm-activeLine"}),ps=Rn.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,n=[];for(let i of e.state.selection.ranges){if(!i.empty)return cn.none;let r=e.lineBlockAt(i.head);r.from>t&&(n.push(ds.range(r.from)),t=r.from)}return cn.set(n)}},{decorations:e=>e.decorations}),fs=2e3;function ms(e,t){let n=e.posAtCoords({x:t.clientX,y:t.clientY},!1),i=e.state.doc.lineAt(n),r=n-i.from,s=r>fs?-1:r==i.length?function(e,t){let n=e.coordsAtPos(e.viewport.from);return n?Math.round(Math.abs((n.left-t)/e.defaultCharacterWidth)):-1}(e,t.clientX):qe(i.text,e.state.tabSize,n-i.from);return{line:i.number,col:s,off:r}}function gs(e,t){let n=ms(e,t),i=e.state.selection;return n?{update(e){if(e.docChanged){let t=e.changes.mapPos(e.startState.doc.line(n.line).from),r=e.state.doc.lineAt(t);n={line:r.number,col:n.col,off:Math.min(n.off,r.length)},i=i.map(e.changes)}},get(t,r,s){let o=ms(e,t);if(!o)return i;let a=function(e,t,n){let i=Math.min(t.line,n.line),r=Math.max(t.line,n.line),s=[];if(t.off>fs||n.off>fs||t.col<0||n.col<0){let o=Math.min(t.off,n.off),a=Math.max(t.off,n.off);for(let t=i;t<=r;t++){let n=e.doc.line(t);n.length<=a&&s.push(D.range(n.from+o,n.to+a))}}else{let o=Math.min(t.col,n.col),a=Math.max(t.col,n.col);for(let t=i;t<=r;t++){let n=e.doc.line(t),i=Ge(n.text,o,e.tabSize,!0);if(i>-1){let t=Ge(n.text,a,e.tabSize);s.push(D.range(n.from+i,n.from+t))}}}return s}(e.state,n,o);return a.length?s?D.create(a.concat(i.ranges)):D.create(a):i}}:null}var Os={Alt:[18,e=>e.altKey],Control:[17,e=>e.ctrlKey],Shift:[16,e=>e.shiftKey],Meta:[91,e=>e.metaKey]},ys={style:"cursor: crosshair"};var vs="-10000px",bs=class{constructor(e,t,n){this.facet=t,this.createTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter((e=>e)),this.tooltipViews=this.tooltips.map(n)}update(e){let t=e.state.facet(this.facet),n=t.filter((e=>e));if(t===this.input){for(let t of this.tooltipViews)t.update&&t.update(e);return!1}let i=[];for(let t=0;t<n.length;t++){let r=n[t],s=-1;if(r){for(let e=0;e<this.tooltips.length;e++){let t=this.tooltips[e];t&&t.create==r.create&&(s=e)}if(s<0)i[t]=this.createTooltipView(r);else{let n=i[t]=this.tooltipViews[s];n.update&&n.update(e)}}}for(let e of this.tooltipViews)i.indexOf(e)<0&&e.dom.remove();return this.input=t,this.tooltips=n,this.tooltipViews=i,!0}};function ws(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}var xs=U.define({combine:e=>{var t,n,i;return{position:jt.ios?"absolute":(null===(t=e.find((e=>e.position)))||void 0===t?void 0:t.position)||"fixed",parent:(null===(n=e.find((e=>e.parent)))||void 0===n?void 0:n.parent)||null,tooltipSpace:(null===(i=e.find((e=>e.tooltipSpace)))||void 0===i?void 0:i.tooltipSpace)||ws}}}),Ss=Rn.fromClass(class{constructor(e){var t;this.view=e,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let n=e.state.facet(xs);this.position=n.position,this.parent=n.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new bs(e,Cs,(e=>this.createTooltip(e))),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),null===(t=e.dom.ownerDocument.defaultView)||void 0===t||t.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let e of this.manager.tooltipViews)this.intersectionObserver.observe(e.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(e){e.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(e);t&&this.observeIntersection();let n=t||e.geometryChanged,i=e.state.facet(xs);if(i.position!=this.position){this.position=i.position;for(let e of this.manager.tooltipViews)e.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let e of this.manager.tooltipViews)this.container.appendChild(e.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(e){let t=e.create(this.view);if(t.dom.classList.add("cm-tooltip"),e.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",t.dom.appendChild(e)}return t.dom.style.position=this.position,t.dom.style.top=vs,this.container.appendChild(t.dom),t.mount&&t.mount(this.view),t}destroy(){var e,t;null===(e=this.view.dom.ownerDocument.defaultView)||void 0===e||e.removeEventListener("resize",this.measureSoon);for(let{dom:e}of this.manager.tooltipViews)e.remove();null===(t=this.intersectionObserver)||void 0===t||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let e=this.view.dom.getBoundingClientRect();return{editor:e,parent:this.parent?this.container.getBoundingClientRect():e,pos:this.manager.tooltips.map(((e,t)=>{let n=this.manager.tooltipViews[t];return n.getCoords?n.getCoords(e.pos):this.view.coordsAtPos(e.pos)})),size:this.manager.tooltipViews.map((({dom:e})=>e.getBoundingClientRect())),space:this.view.state.facet(xs).tooltipSpace(this.view)}}writeMeasure(e){let{editor:t,space:n}=e,i=[];for(let r=0;r<this.manager.tooltips.length;r++){let s=this.manager.tooltips[r],o=this.manager.tooltipViews[r],{dom:a}=o,l=e.pos[r],h=e.size[r];if(!l||l.bottom<=Math.max(t.top,n.top)||l.top>=Math.min(t.bottom,n.bottom)||l.right<Math.max(t.left,n.left)-.1||l.left>Math.min(t.right,n.right)+.1){a.style.top=vs;continue}let c=s.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null,u=c?7:0,d=h.right-h.left,p=h.bottom-h.top,f=o.offset||As,m=this.view.textDirection==Zn.LTR,g=h.width>n.right-n.left?m?n.left:n.right-h.width:m?Math.min(l.left-(c?14:0)+f.x,n.right-d):Math.max(n.left,l.left-d+(c?14:0)-f.x),O=!!s.above;!s.strictSide&&(O?l.top-(h.bottom-h.top)-f.y<n.top:l.bottom+(h.bottom-h.top)+f.y>n.bottom)&&O==n.bottom-l.bottom>l.top-n.top&&(O=!O);let y=O?l.top-p-u-f.y:l.bottom+u+f.y,v=g+d;if(!0!==o.overlap)for(let e of i)e.left<v&&e.right>g&&e.top<y+p&&e.bottom>y&&(y=O?e.top-p-2-u:e.bottom+u+2);"absolute"==this.position?(a.style.top=y-e.parent.top+"px",a.style.left=g-e.parent.left+"px"):(a.style.top=y+"px",a.style.left=g+"px"),c&&(c.style.left=l.left+(m?f.x:-f.x)-(g+14-7)+"px"),!0!==o.overlap&&i.push({left:g,top:y,right:v,bottom:y+p}),a.classList.toggle("cm-tooltip-above",O),a.classList.toggle("cm-tooltip-below",!O),o.positioned&&o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let e of this.manager.tooltipViews)e.dom.style.top=vs}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),ks=$r.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),As={x:0,y:0},Cs=U.define({enables:[Ss,ks]}),_s=U.define(),Es=class{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new bs(e,_s,(e=>this.createHostedView(e)))}static create(e){return new Es(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned()}update(e){this.manager.update(e)}},Ts=Cs.compute([_s],(e=>{let t=e.facet(_s).filter((e=>e));return 0===t.length?null:{pos:Math.min(...t.map((e=>e.pos))),end:Math.max(...t.filter((e=>null!=e.end)).map((e=>e.end))),create:Es.create,above:t[0].above,arrow:t.some((e=>e.arrow))}}));function Ps(e,t={}){let n=Oe.define(),i=W.define({create:()=>null,update(e,i){if(e&&(t.hideOnChange&&(i.docChanged||i.selection)||t.hideOn&&t.hideOn(i,e)))return null;if(e&&i.docChanged){let t=i.changes.mapPos(e.pos,-1,E.TrackDel);if(null==t)return null;let n=Object.assign(Object.create(null),e);n.pos=t,null!=e.end&&(n.end=i.changes.mapPos(e.end)),e=n}for(let t of i.effects)t.is(n)&&(e=t.value),t.is($s)&&(e=null);return e},provide:e=>_s.from(e)});return[i,Rn.define((r=>new class{constructor(e,t,n,i,r){this.view=e,this.source=t,this.field=n,this.setHover=i,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((()=>this.startHover()),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){var e;clearTimeout(this.restartTimeout);let{lastMove:t}=this,n=this.view.contentDOM.contains(t.target)?this.view.posAtCoords(t):null;if(null==n)return;let i=this.view.coordsAtPos(n);if(null==i||t.y<i.top||t.y>i.bottom||t.x<i.left-this.view.defaultCharacterWidth||t.x>i.right+this.view.defaultCharacterWidth)return;let r=this.view.bidiSpans(this.view.state.doc.lineAt(n)).find((e=>e.from<=n&&e.to>=n)),s=r&&r.dir==Zn.RTL?-1:1,o=this.source(this.view,n,t.x<i.left?-s:s);if(null!==(e=o)&&void 0!==e&&e.then){let e=this.pending={pos:n};o.then((t=>{this.pending==e&&(this.pending=null,t&&this.view.dispatch({effects:this.setHover.of(t)}))}),(e=>$n(this.view.state,e,"hover tooltip")))}else o&&this.view.dispatch({effects:this.setHover.of(o)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let n=this.active;if(n&&!function(e){for(let t=e;t;t=t.parentNode)if(1==t.nodeType&&t.classList.contains("cm-tooltip"))return!0;return!1}(this.lastMove.target)||this.pending){let{pos:i}=n||this.pending,r=null!==(t=n?.end)&&void 0!==t?t:i;(i==r?this.view.posAtCoords(this.lastMove)!=i:!function(e,t,n,i,r,s){let o=document.createRange(),a=e.domAtPos(t),l=e.domAtPos(n);o.setEnd(l.node,l.offset),o.setStart(a.node,a.offset);let h=o.getClientRects();o.detach();for(let e=0;e<h.length;e++){let t=h[e];if(Math.max(t.top-r,r-t.bottom,t.left-i,i-t.right)<=s)return!0}return!1}(this.view,i,r,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}(r,e,i,n,t.hoverTime||300))),Ts]}var $s=Oe.define(),Ns=U.define({combine(e){let t,n;for(let i of e)t=t||i.topContainer,n=n||i.bottomContainer;return{topContainer:t,bottomContainer:n}}});function Is(e,t){let n=e.plugin(Qs),i=n?n.specs.indexOf(t):-1;return i>-1?n.panels[i]:null}var Qs=Rn.fromClass(class{constructor(e){this.input=e.state.facet(Bs),this.specs=this.input.filter((e=>e)),this.panels=this.specs.map((t=>t(e)));let t=e.state.facet(Ns);this.top=new Rs(e,!0,t.topContainer),this.bottom=new Rs(e,!1,t.bottomContainer),this.top.sync(this.panels.filter((e=>e.top))),this.bottom.sync(this.panels.filter((e=>!e.top)));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(e){let t=e.state.facet(Ns);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Rs(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Rs(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=e.state.facet(Bs);if(n!=this.input){let t=n.filter((e=>e)),i=[],r=[],s=[],o=[];for(let n of t){let t,a=this.specs.indexOf(n);a<0?(t=n(e.view),o.push(t)):(t=this.panels[a],t.update&&t.update(e)),i.push(t),(t.top?r:s).push(t)}this.specs=t,this.panels=i,this.top.sync(r),this.bottom.sync(s);for(let e of o)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}else for(let t of this.panels)t.update&&t.update(e)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:e=>$r.scrollMargins.of((t=>{let n=t.plugin(e);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}}))}),Rs=class{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Ms(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Ms(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}};function Ms(e){let t=e.nextSibling;return e.remove(),t}var Bs=U.define({enables:Qs}),Ds=class extends $e{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}};Ds.prototype.elementClass="",Ds.prototype.toDOM=void 0,Ds.prototype.mapMode=E.TrackBefore,Ds.prototype.startSide=Ds.prototype.endSide=-1,Ds.prototype.point=!0;var Xs=U.define(),Fs={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Re.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Ls=U.define();function Us(e){return[zs(),Ls.of(Object.assign(Object.assign({},Fs),e))]}var Vs=U.define({combine:e=>e.some((e=>e))});function zs(e){let t=[Zs];return e&&!1===e.fixed&&t.push(Vs.of(!0)),t}var Zs=Rn.fromClass(class{constructor(e){this.view=e,this.prevViewport=e.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=e.state.facet(Ls).map((t=>new Ws(e,t)));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!e.state.facet(Vs),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),e.scrollDOM.insertBefore(this.dom,e.contentDOM)}update(e){if(this.updateGutters(e)){let t=this.prevViewport,n=e.view.viewport,i=Math.min(t.to,n.to)-Math.max(t.from,n.from);this.syncGutters(i<.8*(n.to-n.from))}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Vs)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;e&&this.dom.remove();let n=Re.iter(this.view.state.facet(Xs),this.view.viewport.from),i=[],r=this.gutters.map((e=>new Gs(e,this.view.viewport,-this.view.documentPadding.top)));for(let e of this.view.viewportLineBlocks){let t;if(Array.isArray(e.type)){for(let n of e.type)if(n.type==hn.Text){t=n;break}}else t=e.type==hn.Text?e:void 0;if(t){i.length&&(i=[]),qs(n,i,e.from);for(let e of r)e.line(this.view,t,i)}}for(let e of r)e.finish();e&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(e){let t=e.startState.facet(Ls),n=e.state.facet(Ls),i=e.docChanged||e.heightChanged||e.viewportChanged||!Re.eq(e.startState.facet(Xs),e.state.facet(Xs),e.view.viewport.from,e.view.viewport.to);if(t==n)for(let t of this.gutters)t.update(e)&&(i=!0);else{i=!0;let r=[];for(let i of n){let n=t.indexOf(i);n<0?r.push(new Ws(this.view,i)):(this.gutters[n].update(e),r.push(this.gutters[n]))}for(let e of this.gutters)e.dom.remove(),r.indexOf(e)<0&&e.destroy();for(let e of r)this.dom.appendChild(e.dom);this.gutters=r}return i}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove()}},{provide:e=>$r.scrollMargins.of((t=>{let n=t.plugin(e);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==Zn.LTR?{left:n.dom.offsetWidth}:{right:n.dom.offsetWidth}:null}))});function js(e){return Array.isArray(e)?e:[e]}function qs(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next()}var Gs=class{constructor(e,t,n){this.gutter=e,this.height=n,this.localMarkers=[],this.i=0,this.cursor=Re.iter(e.markers,t.from)}line(e,t,n){this.localMarkers.length&&(this.localMarkers=[]),qs(this.cursor,this.localMarkers,t.from);let i=n.length?this.localMarkers.concat(n):this.localMarkers,r=this.gutter.config.lineMarker(e,t,i);r&&i.unshift(r);let s=this.gutter;if(0==i.length&&!s.config.renderEmptyElements)return;let o=t.top-this.height;if(this.i==s.elements.length){let n=new Hs(e,t.height,o,i);s.elements.push(n),s.dom.appendChild(n.dom)}else s.elements[this.i].update(e,t.height,o,i);this.height=t.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}},Ws=class{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,(i=>{let r=e.lineBlockAtHeight(i.clientY-e.documentTop);t.domEventHandlers[n](e,r,i)&&i.preventDefault()}));this.markers=js(t.markers(e)),t.initialSpacer&&(this.spacer=new Hs(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=js(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let t=this.config.updateSpacer(this.spacer.markers[0],e);t!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[t])}let n=e.view.viewport;return!Re.eq(this.markers,t,n.from,n.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}destroy(){for(let e of this.elements)e.destroy()}},Hs=class{constructor(e,t,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.update(e,t,n,i)}update(e,t,n,i){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),function(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0}(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let n="cm-gutterElement",i=this.dom.firstChild;for(let r=0,s=0;;){let o=s,a=r<t.length?t[r++]:null,l=!1;if(a){let e=a.elementClass;e&&(n+=" "+e);for(let e=s;e<this.markers.length;e++)if(this.markers[e].compare(a)){o=e,l=!0;break}}else o=this.markers.length;for(;s<o;){let e=this.markers[s++];if(e.toDOM){e.destroy(i);let t=i.nextSibling;i.remove(),i=t}}if(!a)break;a.toDOM&&(l?i=i.nextSibling:this.dom.insertBefore(a.toDOM(e),i)),l&&s++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}};var Ys=U.define(),Js=U.define({combine:e=>Pe(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let e in t){let i=n[e],r=t[e];n[e]=i?(e,t,n)=>i(e,t,n)||r(e,t,n):r}return n}})}),Ks=class extends Ds{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}};function eo(e,t){return e.state.facet(Js).formatNumber(t,e.state)}var to=Ls.compute([Js],(e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:e=>e.state.facet(Ys),lineMarker:(e,t,n)=>n.some((e=>e.toDOM))?null:new Ks(eo(e,e.state.doc.lineAt(t.from).number)),lineMarkerChange:e=>e.startState.facet(Js)!=e.state.facet(Js),initialSpacer:e=>new Ks(eo(e,no(e.state.doc.lines))),updateSpacer(e,t){let n=eo(t.view,no(t.view.state.doc.lines));return n==e.number?e:new Ks(n)},domEventHandlers:e.facet(Js).domEventHandlers})));function no(e){let t=9;for(;t<e;)t=10*t+9;return t}var io=new class extends Ds{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},ro=Xs.compute(["selection"],(e=>{let t=[],n=-1;for(let i of e.selection.ranges)if(i.empty){let r=e.doc.lineAt(i.head).from;r>n&&(n=r,t.push(io.range(r)))}return Re.of(t)}));var so=0,oo=class{constructor(e,t){this.from=e,this.to=t}},ao=class{constructor(e={}){this.id=so++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=ho.match(e)),t=>{let n=e(t);return void 0===n?null:[this,n]}}};ao.closedBy=new ao({deserialize:e=>e.split(" ")}),ao.openedBy=new ao({deserialize:e=>e.split(" ")}),ao.group=new ao({deserialize:e=>e.split(" ")}),ao.contextHash=new ao({perNode:!0}),ao.lookAhead=new ao({perNode:!0}),ao.mounted=new ao({perNode:!0});var lo=Object.create(null),ho=class{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):lo,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),i=new ho(e.name||"",t,e.id,n);if(e.props)for(let n of e.props)if(Array.isArray(n)||(n=n(i)),n){if(n[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[n[0].id]=n[1]}return i}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(ao.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return e=>{for(let n=e.prop(ao.group),i=-1;i<(n?n.length:0);i++){let r=t[i<0?e.name:n[i]];if(r)return r}}}};ho.none=new ho("",Object.create(null),0,8);var co,uo=class{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let i=null;for(let t of e){let e=t(n);e&&(i||(i=Object.assign({},n.props)),i[e[0].id]=e[1])}t.push(i?new ho(n.name,i,n.id,n.flags):n)}return new uo(t)}},po=new WeakMap,fo=new WeakMap;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"}(co||(co={}));var mo=class{constructor(e,t,n,i,r){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,r&&r.length){this.props=Object.create(null);for(let[e,t]of r)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=this.prop(ao.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let n=e.toString();n&&(t&&(t+=","),t+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Co(this.topNode,e)}cursorAt(e,t=0,n=0){let i=po.get(this)||this.topNode,r=new Co(i);return r.moveTo(e,t),po.set(this,r._tree),r}get topNode(){return new wo(this,0,0,null)}resolve(e,t=0){let n=bo(po.get(this)||this.topNode,e,t,!1);return po.set(this,n),n}resolveInner(e,t=0){let n=bo(fo.get(this)||this.topNode,e,t,!0);return fo.set(this,n),n}iterate(e){let{enter:t,leave:n,from:i=0,to:r=this.length}=e;for(let s=this.cursor((e.mode||0)|co.IncludeAnonymous);;){let e=!1;if(s.from<=r&&s.to>=i&&(s.type.isAnonymous||!1!==t(s))){if(s.firstChild())continue;e=!0}for(;e&&n&&!s.type.isAnonymous&&n(s),!s.nextSibling();){if(!s.parent())return;e=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Po(ho.none,this.children,this.positions,0,this.children.length,0,this.length,((e,t,n)=>new mo(this.type,e,t,n,this.propValues)),e.makeTree||((e,t,n)=>new mo(ho.none,e,t,n)))}static build(e){return function(e){var t;let{buffer:n,nodeSet:i,maxBufferLength:r=1024,reused:s=[],minRepeatType:o=i.types.length}=e,a=Array.isArray(n)?new go(n,n.length):n,l=i.types,h=0,c=0;function u(e,t,n,O,y){let{id:v,start:b,end:w,size:x}=a,S=c;for(;x<0;){if(a.next(),-1==x){let t=s[v];return n.push(t),void O.push(b-e)}if(-3==x)return void(h=v);if(-4==x)return void(c=v);throw new RangeError(`Unrecognized record size: ${x}`)}let k,A,C=l[v],_=b-e;if(w-b<=r&&(A=m(a.pos-t,y))){let t=new Uint16Array(A.size-A.skip),n=a.pos-A.size,r=t.length;for(;a.pos>n;)r=g(A.start,t,r);k=new Oo(t,w-A.start,i),_=A.start-e}else{let e=a.pos-x;a.next();let t=[],n=[],i=v>=o?v:-1,s=0,l=w;for(;a.pos>e;)i>=0&&a.id==i&&a.size>=0?(a.end<=l-r&&(p(t,n,b,s,a.end,l,i,S),s=t.length,l=a.end),a.next()):u(b,e,t,n,i);if(i>=0&&s>0&&s<t.length&&p(t,n,b,s,b,l,i,S),t.reverse(),n.reverse(),i>-1&&s>0){let e=d(C);k=Po(C,t,n,0,t.length,0,w-b,e,e)}else k=f(C,t,n,w-b,S-w)}n.push(k),O.push(_)}function d(e){return(t,n,i)=>{let r,s,o=0,a=t.length-1;if(a>=0&&(r=t[a])instanceof mo){if(!a&&r.type==e&&r.length==i)return r;(s=r.prop(ao.lookAhead))&&(o=n[a]+r.length+s)}return f(e,t,n,i,o)}}function p(e,t,n,r,s,o,a,l){let h=[],c=[];for(;e.length>r;)h.push(e.pop()),c.push(t.pop()+n-s);e.push(f(i.types[a],h,c,o-s,l-o)),t.push(s-n)}function f(e,t,n,i,r=0,s){if(h){let e=[ao.contextHash,h];s=s?[e].concat(s):[e]}if(r>25){let e=[ao.lookAhead,r];s=s?[e].concat(s):[e]}return new mo(e,t,n,i,s)}function m(e,t){let n=a.fork(),i=0,s=0,l=0,h=n.end-r,c={size:0,start:0,skip:0};e:for(let r=n.pos-e;n.pos>r;){let e=n.size;if(n.id==t&&e>=0){c.size=i,c.start=s,c.skip=l,l+=4,i+=4,n.next();continue}let a=n.pos-e;if(e<0||a<r||n.start<h)break;let u=n.id>=o?4:0,d=n.start;for(n.next();n.pos>a;){if(n.size<0){if(-3!=n.size)break e;u+=4}else n.id>=o&&(u+=4);n.next()}s=d,i+=e,l+=u}return(t<0||i==e)&&(c.size=i,c.start=s,c.skip=l),c.size>4?c:void 0}function g(e,t,n){let{id:i,start:r,end:s,size:l}=a;if(a.next(),l>=0&&i<o){let o=n;if(l>4){let i=a.pos-(l-4);for(;a.pos>i;)n=g(e,t,n)}t[--n]=o,t[--n]=s-e,t[--n]=r-e,t[--n]=i}else-3==l?h=i:-4==l&&(c=i);return n}let O=[],y=[];for(;a.pos>0;)u(e.start||0,e.bufferStart||0,O,y,-1);let v=null!==(t=e.length)&&void 0!==t?t:O.length?y[0]+O[0].length:0;return new mo(l[e.topID],O.reverse(),y.reverse(),v)}(e)}};mo.empty=new mo(ho.none,[],[],0);var go=class{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new go(this.buffer,this.index)}},Oo=class{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return ho.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],r=i.name;if(/\W/.test(r)&&!i.isError&&(r=JSON.stringify(r)),n==(e+=4))return r;let s=[];for(;e<n;)s.push(this.childString(e)),e=this.buffer[e+3];return r+"("+s.join(",")+")"}findChild(e,t,n,i,r){let{buffer:s}=this,o=-1;for(let a=e;a!=t&&!(yo(r,i,s[a+1],s[a+2])&&(o=a,n>0));a=s[a+3]);return o}slice(e,t,n,i){let r=this.buffer,s=new Uint16Array(t-e);for(let i=e,o=0;i<t;)s[o++]=r[i++],s[o++]=r[i++]-n,s[o++]=r[i++]-n,s[o++]=r[i++]-e;return new Oo(s,i-n,this.set)}};function yo(e,t,n,i){switch(e){case-2:return n<t;case-1:return i>=t&&n<t;case 0:return n<t&&i>t;case 1:return n<=t&&i>t;case 2:return i>t;case 4:return!0}}function vo(e,t){let n=e.childBefore(t);for(;n;){let t=n.lastChild;if(!t||t.to!=n.to)break;t.type.isError&&t.from==t.to?(e=n,n=t.prevSibling):n=t}return e}function bo(e,t,n,i){for(var r;e.from==e.to||(n<1?e.from>=t:e.from>t)||(n>-1?e.to<=t:e.to<t);){let t=!i&&e instanceof wo&&e.index<0?null:e.parent;if(!t)return e;e=t}let s=i?0:co.IgnoreOverlays;if(i)for(let i=e,o=i.parent;o;i=o,o=i.parent)i instanceof wo&&i.index<0&&(null===(r=o.enter(t,n,s))||void 0===r?void 0:r.from)!=i.from&&(e=o);for(;;){let i=e.enter(t,n,s);if(!i)return e;e=i}}var wo=class{constructor(e,t,n,i){this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,r=0){for(let s=this;;){for(let{children:o,positions:a}=s._tree,l=t>0?o.length:-1;e!=l;e+=t){let l=o[e],h=a[e]+s.from;if(yo(i,n,h,h+l.length))if(l instanceof Oo){if(r&co.ExcludeBuffers)continue;let o=l.findChild(0,l.buffer.length,t,n-h,i);if(o>-1)return new Ao(new ko(s,l,e,h),null,o)}else if(r&co.IncludeAnonymous||!l.type.isAnonymous||_o(l)){let o;if(!(r&co.IgnoreMounts)&&l.props&&(o=l.prop(ao.mounted))&&!o.overlay)return new wo(o.tree,h,e,s);let a=new wo(l,h,e,s);return r&co.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(t<0?l.children.length-1:0,t,n,i)}}if(r&co.IncludeAnonymous||!s.type.isAnonymous||(e=s.index>=0?s.index+t:t<0?-1:s._parent._tree.children.length,s=s._parent,!s))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&co.IgnoreOverlays)&&(i=this._tree.prop(ao.mounted))&&i.overlay){let n=e-this.from;for(let{from:e,to:r}of i.overlay)if((t>0?e<=n:e<n)&&(t<0?r>=n:r>n))return new wo(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new Co(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return bo(this,e,t,!1)}resolveInner(e,t=0){return bo(this,e,t,!0)}enterUnfinishedNodesBefore(e){return vo(this,e)}getChild(e,t=null,n=null){let i=xo(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return xo(this,e,t,n)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return So(this,e)}};function xo(e,t,n,i){let r=e.cursor(),s=[];if(!r.firstChild())return s;if(null!=n)for(;!r.type.is(n);)if(!r.nextSibling())return s;for(;;){if(null!=i&&r.type.is(i))return s;if(r.type.is(t)&&s.push(r.node),!r.nextSibling())return null==i?s:[]}}function So(e,t,n=t.length-1){for(let i=e.parent;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[n]&&t[n]!=i.name)return!1;n--}}return!0}var ko=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},Ao=class{constructor(e,t,n){this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,n){let{buffer:i}=this.context,r=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return r<0?null:new Ao(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&co.ExcludeBuffers)return null;let{buffer:i}=this.context,r=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return r<0?null:new Ao(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Ao(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Ao(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new Co(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,r=n.buffer[this.index+3];if(r>i){let s=n.buffer[this.index+1],o=n.buffer[this.index+2];e.push(n.slice(i,r,s,o)),t.push(0)}return new mo(this.type,e,t,this.to-this.from)}resolve(e,t=0){return bo(this,e,t,!1)}resolveInner(e,t=0){return bo(this,e,t,!0)}enterUnfinishedNodesBefore(e){return vo(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,n=null){let i=xo(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return xo(this,e,t,n)}get node(){return this}matchContext(e){return So(this,e)}},Co=class{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof wo)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return!!e&&(e instanceof wo?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,r=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?!(n&co.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&co.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&co.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let e=n<0?0:this.stack[n]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(e)}return n<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(i.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;({index:t,_parent:n}=n))if(t>-1)for(let i=t+e,r=e<0?-1:n._tree.children.length;i!=r;i+=e){let e=n._tree.children[i];if(this.mode&co.IncludeAnonymous||e instanceof Oo||!e.type.isAnonymous||_o(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,r=this.stack.length;r>=0;){for(let s=e;s;s=s._parent)if(s.index==i){if(i==this.index)return s;t=s,n=r+1;break e}i=this.stack[--r]}for(let e=n;e<this.stack.length;e++)t=new Ao(this.buffer,t,this.stack[e]);return this.bufferNode=new Ao(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;i&&t&&t(this),i=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return So(this.node,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,r=this.stack.length-1;i>=0;r--){if(r<0)return So(this.node,e,i);let s=n[t.buffer[this.stack[r]]];if(!s.isAnonymous){if(e[i]&&e[i]!=s.name)return!1;i--}}return!0}};function _o(e){return e.children.some((e=>e instanceof Oo||!e.type.isAnonymous||_o(e)))}var Eo=new WeakMap;function To(e,t){if(!e.isAnonymous||t instanceof Oo||t.type!=e)return 1;let n=Eo.get(t);if(null==n){n=1;for(let i of t.children){if(i.type!=e||!(i instanceof mo)){n=1;break}n+=To(e,i)}Eo.set(t,n)}return n}function Po(e,t,n,i,r,s,o,a,l){let h=0;for(let n=i;n<r;n++)h+=To(e,t[n]);let c=Math.ceil(1.5*h/8),u=[],d=[];return function t(n,i,r,o,a){for(let h=r;h<o;){let r=h,p=i[h],f=To(e,n[h]);for(h++;h<o;h++){let t=To(e,n[h]);if(f+t>=c)break;f+=t}if(h==r+1){if(f>c){let e=n[r];t(e.children,e.positions,0,e.children.length,i[r]+a);continue}u.push(n[r])}else{let t=i[h-1]+n[h-1].length-p;u.push(Po(e,n,i,r,h,p,t,null,l))}d.push(p+a-s)}}(t,n,i,r,0),(a||l)(u,d,o)}var $o=class{constructor(e,t,n,i,r=!1,s=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(e,t=[],n=!1){let i=[new $o(0,e.length,e,0,!1,n)];for(let n of t)n.to>e.length&&i.push(n);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],r=1,s=e.length?e[0]:null;for(let o=0,a=0,l=0;;o++){let h=o<t.length?t[o]:null,c=h?h.fromA:1e9;if(c-a>=n)for(;s&&s.from<c;){let t=s;if(a>=t.from||c<=t.to||l){let e=Math.max(t.from,a)-l,n=Math.min(t.to,c)-l;t=e>=n?null:new $o(e,n,t.tree,t.offset+l,o>0,!!h)}if(t&&i.push(t),s.to>c)break;s=r<e.length?e[r++]:null}if(!h)break;a=h.toA,l=h.toA-h.toB}return i}},No=class{startParse(e,t,n){return"string"==typeof e&&(e=new Io(e)),n=n?n.length?n.map((e=>new oo(e.from,e.to))):[new oo(0,0)]:[new oo(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let e=i.advance();if(e)return e}}},Io=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new ao({perNode:!0});var Qo=0,Ro=class{constructor(e,t,n){this.set=e,this.base=t,this.modified=n,this.id=Qo++}static define(e){if(e?.base)throw new Error("Can not derive from a modified tag");let t=new Ro([],null,[]);if(t.set.push(t),e)for(let n of e.set)t.set.push(n);return t}static defineModifier(){let e=new Bo;return t=>t.modified.indexOf(e)>-1?t:Bo.get(t.base||t,t.modified.concat(e).sort(((e,t)=>e.id-t.id)))}},Mo=0,Bo=class{constructor(){this.instances=[],this.id=Mo++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find((n=>n.base==e&&function(e,t){return e.length==t.length&&e.every(((e,n)=>e==t[n]))}(t,n.modified)));if(n)return n;let i=[],r=new Ro(i,e,t);for(let e of t)e.instances.push(r);let s=Do(t);for(let t of e.set)for(let e of s)i.push(Bo.get(t,e));return r}};function Do(e){let t=[e];for(let n=0;n<e.length;n++)for(let i of Do(e.slice(0,n).concat(e.slice(n+1))))t.push(i);return t}function Xo(e){let t=Object.create(null);for(let n in e){let i=e[n];Array.isArray(i)||(i=[i]);for(let e of n.split(" "))if(e){let n=[],r=2,s=e;for(let t=0;;){if("..."==s&&t>0&&t+3==e.length){r=1;break}let i=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!i)throw new RangeError("Invalid path: "+e);if(n.push("*"==i[0]?"":'"'==i[0][0]?JSON.parse(i[0]):i[0]),t+=i[0].length,t==e.length)break;let o=e[t++];if(t==e.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+e);s=e.slice(t)}let o=n.length-1,a=n[o];if(!a)throw new RangeError("Invalid path: "+e);let l=new Lo(i,r,o>0?n.slice(0,o):null);t[a]=l.sort(t[a])}}return Fo.add(t)}var Fo=new ao,Lo=class{constructor(e,t,n,i){this.tags=e,this.mode=t,this.context=n,this.next=i}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};function Uo(e,t){let n=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)n[e.id]=t.class;else n[t.tag.id]=t.class;let{scope:i,all:r=null}=t||{};return{style:e=>{let t=r;for(let i of e)for(let e of i.set){let i=n[e.id];if(i){t=t?t+" "+i:i;break}}return t},scope:i}}function Vo(e,t){let n=null;for(let i of e){let e=i.style(t);e&&(n=n?n+" "+e:e)}return n}function zo(e,t,n,i=0,r=e.length){let s=new Zo(i,Array.isArray(t)?t:[t],n);s.highlightRange(e.cursor(),i,r,"",s.highlighters),s.flush(r)}var Zo=class{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,i,r){let{type:s,from:o,to:a}=e;if(o>=n||a<=t)return;s.isTop&&(r=this.highlighters.filter((e=>!e.scope||e.scope(s))));let l=i,h=s.prop(Fo),c=!1;for(;h;){if(!h.context||e.matchContext(h.context)){let e=Vo(r,h.tags);e&&(l&&(l+=" "),l+=e,1==h.mode?i+=(i?" ":"")+e:0==h.mode&&(c=!0));break}h=h.next}if(this.startSpan(e.from,l),c)return;let u=e.tree&&e.tree.prop(ao.mounted);if(u&&u.overlay){let s=e.node.enter(u.overlay[0].from+o,1),h=this.highlighters.filter((e=>!e.scope||e.scope(u.tree.type))),c=e.firstChild();for(let d=0,p=o;;d++){let f=d<u.overlay.length?u.overlay[d]:null,m=f?f.from+o:a,g=Math.max(t,p),O=Math.min(n,m);if(g<O&&c)for(;e.from<O&&(this.highlightRange(e,g,O,i,r),this.startSpan(Math.min(n,e.to),l),!(e.to>=m)&&e.nextSibling()););if(!f||m>n)break;p=f.to+o,p>t&&(this.highlightRange(s.cursor(),Math.max(t,f.from+o),Math.min(n,p),i,h),this.startSpan(p,l))}c&&e.parent()}else if(e.firstChild()){do{if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,i,r),this.startSpan(Math.min(n,e.to),l)}}while(e.nextSibling());e.parent()}}},jo=Ro.define,qo=jo(),Go=jo(),Wo=jo(Go),Ho=jo(Go),Yo=jo(),Jo=jo(Yo),Ko=jo(Yo),ea=jo(),ta=jo(ea),na=jo(),ia=jo(),ra=jo(),sa=jo(ra),oa=jo(),aa={comment:qo,lineComment:jo(qo),blockComment:jo(qo),docComment:jo(qo),name:Go,variableName:jo(Go),typeName:Wo,tagName:jo(Wo),propertyName:Ho,attributeName:jo(Ho),className:jo(Go),labelName:jo(Go),namespace:jo(Go),macroName:jo(Go),literal:Yo,string:Jo,docString:jo(Jo),character:jo(Jo),attributeValue:jo(Jo),number:Ko,integer:jo(Ko),float:jo(Ko),bool:jo(Yo),regexp:jo(Yo),escape:jo(Yo),color:jo(Yo),url:jo(Yo),keyword:na,self:jo(na),null:jo(na),atom:jo(na),unit:jo(na),modifier:jo(na),operatorKeyword:jo(na),controlKeyword:jo(na),definitionKeyword:jo(na),moduleKeyword:jo(na),operator:ia,derefOperator:jo(ia),arithmeticOperator:jo(ia),logicOperator:jo(ia),bitwiseOperator:jo(ia),compareOperator:jo(ia),updateOperator:jo(ia),definitionOperator:jo(ia),typeOperator:jo(ia),controlOperator:jo(ia),punctuation:ra,separator:jo(ra),bracket:sa,angleBracket:jo(sa),squareBracket:jo(sa),paren:jo(sa),brace:jo(sa),content:ea,heading:ta,heading1:jo(ta),heading2:jo(ta),heading3:jo(ta),heading4:jo(ta),heading5:jo(ta),heading6:jo(ta),contentSeparator:jo(ea),list:jo(ea),quote:jo(ea),emphasis:jo(ea),strong:jo(ea),link:jo(ea),monospace:jo(ea),strikethrough:jo(ea),inserted:jo(),deleted:jo(),changed:jo(),invalid:jo(),meta:oa,documentMeta:jo(oa),annotation:jo(oa),processingInstruction:jo(oa),definition:Ro.defineModifier(),constant:Ro.defineModifier(),function:Ro.defineModifier(),standard:Ro.defineModifier(),local:Ro.defineModifier(),special:Ro.defineModifier()};Uo([{tag:aa.link,class:"tok-link"},{tag:aa.heading,class:"tok-heading"},{tag:aa.emphasis,class:"tok-emphasis"},{tag:aa.strong,class:"tok-strong"},{tag:aa.keyword,class:"tok-keyword"},{tag:aa.atom,class:"tok-atom"},{tag:aa.bool,class:"tok-bool"},{tag:aa.url,class:"tok-url"},{tag:aa.labelName,class:"tok-labelName"},{tag:aa.inserted,class:"tok-inserted"},{tag:aa.deleted,class:"tok-deleted"},{tag:aa.literal,class:"tok-literal"},{tag:aa.string,class:"tok-string"},{tag:aa.number,class:"tok-number"},{tag:[aa.regexp,aa.escape,aa.special(aa.string)],class:"tok-string2"},{tag:aa.variableName,class:"tok-variableName"},{tag:aa.local(aa.variableName),class:"tok-variableName tok-local"},{tag:aa.definition(aa.variableName),class:"tok-variableName tok-definition"},{tag:aa.special(aa.variableName),class:"tok-variableName2"},{tag:aa.definition(aa.propertyName),class:"tok-propertyName tok-definition"},{tag:aa.typeName,class:"tok-typeName"},{tag:aa.namespace,class:"tok-namespace"},{tag:aa.className,class:"tok-className"},{tag:aa.macroName,class:"tok-macroName"},{tag:aa.propertyName,class:"tok-propertyName"},{tag:aa.operator,class:"tok-operator"},{tag:aa.comment,class:"tok-comment"},{tag:aa.meta,class:"tok-meta"},{tag:aa.invalid,class:"tok-invalid"},{tag:aa.punctuation,class:"tok-punctuation"}]);var la,ha=new ao;var ca=class{constructor(e,t,n=[]){this.data=e,Te.prototype.hasOwnProperty("tree")||Object.defineProperty(Te.prototype,"tree",{get(){return pa(this)}}),this.parser=t,this.extension=[wa.of(this),Te.languageData.of(((e,t,n)=>e.facet(ua(e,t,n))))].concat(n)}isActiveAt(e,t,n=-1){return ua(e,t,n)==this.data}findRegions(e){let t=e.facet(wa);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(e,t)=>{if(e.prop(ha)==this.data)return void n.push({from:t,to:t+e.length});let r=e.prop(ao.mounted);if(r){if(r.tree.prop(ha)==this.data){if(r.overlay)for(let e of r.overlay)n.push({from:e.from+t,to:e.to+t});else n.push({from:t,to:t+e.length});return}if(r.overlay){let e=n.length;if(i(r.tree,r.overlay[0].from+t),n.length>e)return}}for(let n=0;n<e.children.length;n++){let r=e.children[n];r instanceof mo&&i(r,e.positions[n]+t)}};return i(pa(e),0),n}get allowsNesting(){return!0}};function ua(e,t,n){let i=e.facet(wa);if(!i)return null;let r=i.data;if(i.allowsNesting)for(let i=pa(e).topNode;i;i=i.enter(t,n,co.ExcludeBuffers))r=i.type.prop(ha)||r;return r}ca.setState=Oe.define();var da=class extends ca{constructor(e,t){super(e,t),this.parser=t}static define(e){let t=function(e){return U.define({combine:e?t=>t.concat(e):void 0})}(e.languageData);return new da(t,e.parser.configure({props:[ha.add((e=>e.isTop?t:void 0))]}))}configure(e){return new da(this.data,this.parser.configure(e))}get allowsNesting(){return this.parser.hasWrappers()}};function pa(e){let t=e.field(ca.state,!1);return t?t.tree:mo.empty}var fa=null,ma=class{constructor(e,t,n=[],i,r,s,o,a){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}startParse(){return this.parser.startParse(new class{constructor(e,t=e.length){this.doc=e,this.length=t,this.cursorPos=0,this.string="",this.cursor=e.iter()}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}(this.state.doc),this.fragments)}work(e,t){return null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=mo.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var n;if("number"==typeof e){let t=Date.now()+e;e=()=>Date.now()>t}for(this.parse||(this.parse=this.startParse()),null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i){if(this.fragments=this.withoutTempSkipped($o.addTree(i,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(n=this.parse.stoppedAt)&&void 0!==n?n:this.state.doc.length,this.tree=i,this.parse=null,!(this.treeLen<(t??this.state.doc.length)))return!0;this.parse=this.startParse()}if(e())return!1}}))}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext((()=>{for(;!(t=this.parse.advance()););})),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped($o.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=fa;fa=this;try{return e()}finally{fa=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=ga(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:r,viewport:s,skipped:o}=this;if(this.takeTree(),!e.empty){let t=[];if(e.iterChangedRanges(((e,n,i,r)=>t.push({fromA:e,toA:n,fromB:i,toB:r}))),n=$o.applyChanges(n,t),i=mo.empty,r=0,s={from:e.mapPos(s.from,-1),to:e.mapPos(s.to,1)},this.skipped.length){o=[];for(let t of this.skipped){let n=e.mapPos(t.from,1),i=e.mapPos(t.to,-1);n<i&&o.push({from:n,to:i})}}}return new ma(this.parser,t,n,i,r,s,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let t=0;t<this.skipped.length;t++){let{from:n,to:i}=this.skipped[t];n<e.to&&i>e.from&&(this.fragments=ga(this.fragments,n,i),this.skipped.splice(t--,1))}return!(this.skipped.length>=t)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends No{createParse(t,n,i){let r=i[0].from,s=i[i.length-1].to;return{parsedPos:r,advance(){let t=fa;if(t){for(let e of i)t.tempSkipped.push(e);e&&(t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e)}return this.parsedPos=s,new mo(ho.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return fa}};function ga(e,t,n){return $o.applyChanges(e,[{fromA:t,toA:n,fromB:t,toB:n}])}var Oa=class{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new Oa(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=new ma(e.facet(wa).parser,e,[],mo.empty,0,{from:0,to:t},[],null);return n.work(20,t)||n.takeTree(),new Oa(n)}};ca.state=W.define({create:Oa.init,update(e,t){for(let e of t.effects)if(e.is(ca.setState))return e.value;return t.startState.facet(wa)!=t.state.facet(wa)?Oa.init(t.state):e.apply(t)}});var ya=e=>{let t=setTimeout((()=>e()),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(ya=e=>{let t=-1,n=setTimeout((()=>{t=requestIdleCallback(e,{timeout:400})}),100);return()=>t<0?clearTimeout(n):cancelIdleCallback(t)});var va=typeof navigator<"u"&&(null===(la=navigator.scheduling)||void 0===la?void 0:la.isInputPending)?()=>navigator.scheduling.isInputPending():null,ba=Rn.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(ca.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(ca.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=ya(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,r=n.field(ca.state);if(r.tree==r.context.tree&&r.context.isDone(i+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,e&&!va?Math.max(25,e.timeRemaining()-5):1e9),o=r.context.treeLen<i&&n.doc.length>i+1e3,a=r.context.work((()=>va&&va()||Date.now()>s),i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:ca.setState.of(new Oa(r.context))})),this.chunkBudget>0&&!(a&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then((()=>this.scheduleWork())).catch((e=>$n(this.view.state,e))).then((()=>this.workScheduled--)),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),wa=U.define({combine:e=>e.length?e[0]:null,enables:[ca.state,ba]}),xa=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}},Sa=U.define(),ka=U.define({combine:e=>{if(!e.length)return"  ";if(!/^(?: +|\t+)$/.test(e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return e[0]}});function Aa(e){let t=e.facet(ka);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function Ca(e,t){let n="",i=e.tabSize;if(9==e.facet(ka).charCodeAt(0))for(;t>=i;)n+="\t",t-=i;for(let e=0;e<t;e++)n+=" ";return n}function _a(e,t){e instanceof Te&&(e=new Ea(e));for(let n of e.state.facet(Sa)){let i=n(e,t);if(null!=i)return i}let n=pa(e.state);return n?function(e,t,n){return $a(t.resolveInner(n).enterUnfinishedNodesBefore(n),n,e)}(e,n,t):null}var Ea=class{constructor(e,t={}){this.state=e,this.options=t,this.unit=Aa(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:r}=this.options;return null!=i&&i>=n.from&&i<=n.to?r&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(e,t);return n.slice(e-i,Math.min(n.length,e+100-i))}column(e,t=1){let{text:n,from:i}=this.lineAt(e,t),r=this.countColumn(n,e-i),s=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return s>-1&&(r+=s-this.countColumn(n,n.search(/\S|$/))),r}countColumn(e,t=e.length){return qe(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:i}=this.lineAt(e,t),r=this.options.overrideIndentation;if(r){let e=r(i);if(e>-1)return e}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}},Ta=new ao;function Pa(e){let t=e.type.prop(Ta);if(t)return t;let n,i=e.firstChild;if(i&&(n=i.type.prop(ao.closedBy))){let t=e.lastChild,i=t&&n.indexOf(t.name)>-1;return e=>function(e,t,n,i,r){let s=e.textAfter,o=s.match(/^\s*/)[0].length,a=i&&s.slice(o,o+i.length)==i||r==e.pos+o,l=t?function(e){let t=e.node,n=t.childAfter(t.from),i=t.lastChild;if(!n)return null;let r=e.options.simulateBreak,s=e.state.doc.lineAt(n.from),o=null==r||r<=s.from?s.to:Math.min(s.to,r);for(let e=n.to;;){let r=t.childAfter(e);if(!r||r==i)return null;if(!r.type.isSkipped)return r.from<o?n:null;e=r.to}}(e):null;return l?a?e.column(l.from):e.column(l.to):e.baseIndent+(a?0:e.unit*n)}(e,!0,1,void 0,i&&!function(e){return e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak}(e)?t.from:void 0)}return null==e.parent?Na:null}function $a(e,t,n){for(;e;e=e.parent){let i=Pa(e);if(i)return i(new Ia(n,t,e))}return null}function Na(){return 0}var Ia=class extends Ea{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.node=n}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);for(;t.parent&&t.parent.from==t.from;)t=t.parent;if(Qa(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?$a(e,this.pos,this.base):0}};function Qa(e,t){for(let n=t;n;n=n.parent)if(e==n)return!0;return!1}var Ra=U.define(),Ma=new ao;function Ba(e){let t=e.lastChild;return t&&t.to==e.to&&t.type.isError}function Da(e,t,n){for(let i of e.facet(Ra)){let r=i(e,t,n);if(r)return r}return function(e,t,n){let i=pa(e);if(i.length<n)return null;let r=null;for(let s=i.resolveInner(n);s;s=s.parent){if(s.to<=n||s.from>n)continue;if(r&&s.from<t)break;let o=s.type.prop(Ma);if(o&&(s.to<i.length-50||i.length==e.doc.length||!Ba(s))){let i=o(s,e);i&&i.from<=n&&i.from>=t&&i.to>n&&(r=i)}}return r}(e,t,n)}function Xa(e,t){let n=t.mapPos(e.from,1),i=t.mapPos(e.to,-1);return n>=i?void 0:{from:n,to:i}}var Fa=Oe.define({map:Xa}),La=Oe.define({map:Xa});function Ua(e){let t=[];for(let{head:n}of e.state.selection.ranges)t.some((e=>e.from<=n&&e.to>=n))||t.push(e.lineBlockAt(n));return t}var Va=W.define({create:()=>cn.none,update(e,t){e=e.map(t.changes);for(let n of t.effects)n.is(Fa)&&!Za(e,n.value.from,n.value.to)?e=e.update({add:[Ja.range(n.value.from,n.value.to)]}):n.is(La)&&(e=e.update({filter:(e,t)=>n.value.from!=e||n.value.to!=t,filterFrom:n.value.from,filterTo:n.value.to}));if(t.selection){let n=!1,{head:i}=t.selection.main;e.between(i,i,((e,t)=>{e<i&&t>i&&(n=!0)})),n&&(e=e.update({filterFrom:i,filterTo:i,filter:(e,t)=>t<=i||e>=i}))}return e},provide:e=>$r.decorations.from(e)});function za(e,t,n){var i;let r=null;return null===(i=e.field(Va,!1))||void 0===i||i.between(t,n,((e,t)=>{(!r||r.from>e)&&(r={from:e,to:t})})),r}function Za(e,t,n){let i=!1;return e.between(t,t,((e,r)=>{e==t&&r==n&&(i=!0)})),i}function ja(e,t){return e.field(Va,!1)?t:t.concat(Oe.appendConfig.of(Ya()))}function qa(e,t,n=!0){let i=e.state.doc.lineAt(t.from).number,r=e.state.doc.lineAt(t.to).number;return $r.announce.of(`${e.state.phrase(n?"Folded lines":"Unfolded lines")} ${i} ${e.state.phrase("to")} ${r}.`)}var Ga=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:e=>{for(let t of Ua(e)){let n=Da(e.state,t.from,t.to);if(n)return e.dispatch({effects:ja(e.state,[Fa.of(n),qa(e,n)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e=>{if(!e.state.field(Va,!1))return!1;let t=[];for(let n of Ua(e)){let i=za(e.state,n.from,n.to);i&&t.push(La.of(i),qa(e,i,!1))}return t.length&&e.dispatch({effects:t}),t.length>0}},{key:"Ctrl-Alt-[",run:e=>{let{state:t}=e,n=[];for(let i=0;i<t.doc.length;){let r=e.lineBlockAt(i),s=Da(t,r.from,r.to);s&&n.push(Fa.of(s)),i=(s?e.lineBlockAt(s.to):r).to+1}return n.length&&e.dispatch({effects:ja(e.state,n)}),!!n.length}},{key:"Ctrl-Alt-]",run:e=>{let t=e.state.field(Va,!1);if(!t||!t.size)return!1;let n=[];return t.between(0,e.state.doc.length,((e,t)=>{n.push(La.of({from:e,to:t}))})),e.dispatch({effects:n}),!0}}],Wa={placeholderDOM:null,placeholderText:""},Ha=U.define({combine:e=>Pe(e,Wa)});function Ya(e){let t=[Va,tl];return e&&t.push(Ha.of(e)),t}var Ja=cn.replace({widget:new class extends ln{toDOM(e){let{state:t}=e,n=t.facet(Ha),i=t=>{let n=e.lineBlockAt(e.posAtDOM(t.target)),i=za(e.state,n.from,n.to);i&&e.dispatch({effects:La.of(i)}),t.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(e,i);let r=document.createElement("span");return r.textContent=n.placeholderText,r.setAttribute("aria-label",t.phrase("folded code")),r.title=t.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=i,r}}}),Ka={openText:"",closedText:"",markerDOM:null,domEventHandlers:{}},el=class extends Ds{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}};var tl=$r.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),nl=class{constructor(e,t){let n;function i(e){let t=et.newName();return(n||(n=Object.create(null)))["."+t]=e,t}let r=t.scope;this.scope=r instanceof ca?e=>e.prop(ha)==r.data:r?e=>e==r:void 0,this.style=Uo(e.map((e=>({tag:e.tag,class:e.class||i(Object.assign({},e,{tag:null}))}))),{all:"string"==typeof t.all?t.all:t.all?i(t.all):void 0}).style,this.module=n?new et(n):null,this.themeType=t.themeType}static define(e,t){return new nl(e,t||{})}},il=U.define(),rl=U.define({combine:e=>e.length?[e[0]]:null});function sl(e){let t=e.facet(il);return t.length?t:e.facet(rl)}var ol=te.high(Rn.fromClass(class{constructor(e){this.markCache=Object.create(null),this.tree=pa(e.state),this.decorations=this.buildDeco(e,sl(e.state))}update(e){let t=pa(e.state),n=sl(e.state),i=n!=sl(e.startState);t.length<e.view.viewport.to&&!i&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n))}buildDeco(e,t){if(!t||!this.tree.length)return cn.none;let n=new Me;for(let{from:i,to:r}of e.visibleRanges)zo(this.tree,t,((e,t,i)=>{n.add(e,t,this.markCache[i]||(this.markCache[i]=cn.mark({class:i})))}),i,r);return n.finish()}},{decorations:e=>e.decorations})),al=nl.define([{tag:aa.meta,color:"#7a757a"},{tag:aa.link,textDecoration:"underline"},{tag:aa.heading,textDecoration:"underline",fontWeight:"bold"},{tag:aa.emphasis,fontStyle:"italic"},{tag:aa.strong,fontWeight:"bold"},{tag:aa.strikethrough,textDecoration:"line-through"},{tag:aa.keyword,color:"#708"},{tag:[aa.atom,aa.bool,aa.url,aa.contentSeparator,aa.labelName],color:"#219"},{tag:[aa.literal,aa.inserted],color:"#164"},{tag:[aa.string,aa.deleted],color:"#a11"},{tag:[aa.regexp,aa.escape,aa.special(aa.string)],color:"#e40"},{tag:aa.definition(aa.variableName),color:"#00f"},{tag:aa.local(aa.variableName),color:"#30a"},{tag:[aa.typeName,aa.namespace],color:"#085"},{tag:aa.className,color:"#167"},{tag:[aa.special(aa.variableName),aa.macroName],color:"#256"},{tag:aa.definition(aa.propertyName),color:"#00c"},{tag:aa.comment,color:"#940"},{tag:aa.invalid,color:"#f00"}]),ll=$r.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),hl="()[]{}",cl=U.define({combine:e=>Pe(e,{afterCursor:!0,brackets:hl,maxScanDistance:1e4,renderMatch:pl})}),ul=cn.mark({class:"cm-matchingBracket"}),dl=cn.mark({class:"cm-nonmatchingBracket"});function pl(e){let t=[],n=e.matched?ul:dl;return t.push(n.range(e.start.from,e.start.to)),e.end&&t.push(n.range(e.end.from,e.end.to)),t}var fl=W.define({create:()=>cn.none,update(e,t){if(!t.docChanged&&!t.selection)return e;let n=[],i=t.state.facet(cl);for(let e of t.state.selection.ranges){if(!e.empty)continue;let r=Ol(t.state,e.head,-1,i)||e.head>0&&Ol(t.state,e.head-1,1,i)||i.afterCursor&&(Ol(t.state,e.head,1,i)||e.head<t.state.doc.length&&Ol(t.state,e.head+1,-1,i));r&&(n=n.concat(i.renderMatch(r,t.state)))}return cn.set(n,!0)},provide:e=>$r.decorations.from(e)}),ml=[fl,ll];function gl(e,t,n){let i=e.prop(t<0?ao.openedBy:ao.closedBy);if(i)return i;if(1==e.name.length){let i=n.indexOf(e.name);if(i>-1&&i%2==(t<0?1:0))return[n[i+t]]}return null}function Ol(e,t,n,i={}){let r=i.maxScanDistance||1e4,s=i.brackets||hl,o=pa(e),a=o.resolveInner(t,n);for(let i=a;i;i=i.parent){let r=gl(i.type,n,s);if(r&&i.from<i.to)return yl(e,t,n,i,r,s)}return function(e,t,n,i,r,s,o){let a=n<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),l=o.indexOf(a);if(l<0||l%2==0!=n>0)return null;let h={from:n<0?t-1:t,to:n>0?t+1:t},c=e.doc.iterRange(t,n>0?e.doc.length:0),u=0;for(let e=0;!c.next().done&&e<=s;){let s=c.value;n<0&&(e+=s.length);let a=t+e*n;for(let e=n>0?0:s.length-1,t=n>0?s.length:-1;e!=t;e+=n){let t=o.indexOf(s[e]);if(!(t<0||i.resolve(a+e,1).type!=r))if(t%2==0==n>0)u++;else{if(1==u)return{start:h,end:{from:a+e,to:a+e+1},matched:t>>1==l>>1};u--}}n>0&&(e+=s.length)}return c.done?{start:h,matched:!1}:null}(e,t,n,o,a.type,r,s)}function yl(e,t,n,i,r,s){let o=i.parent,a={from:i.from,to:i.to},l=0,h=o?.cursor();if(h&&(n<0?h.childBefore(i.from):h.childAfter(i.to)))do{if(n<0?h.to<=i.from:h.from>=i.to){if(0==l&&r.indexOf(h.type.name)>-1&&h.from<h.to)return{start:a,end:{from:h.from,to:h.to},matched:!0};if(gl(h.type,n,s))l++;else if(gl(h.type,-n,s)&&(l--,0==l))return{start:a,end:h.from==h.to?void 0:{from:h.from,to:h.to},matched:!1}}}while(n<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}var vl=Object.create(null),bl=[ho.none],wl=Object.create(null);for(let[e,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])wl[e]=xl(vl,t);function xl(e,t){let n=null;for(let i of t.split(".")){let t=e[i]||aa[i];t&&("function"==typeof t?n&&(n=t(n)):n||(n=t))}if(!n)return 0;let i=t.replace(/ /g,"_"),r=ho.define({id:bl.length,name:i,props:[Xo({[i]:n})]});return bl.push(r),r.id}function Sl(e,t){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let r=e(t,n);return!!r&&(i(n.update(r)),!0)}}var kl=Sl((function(e,t,n=t.selection.ranges){let i=[],r=-1;for(let{from:e,to:s}of n){let n=i.length,o=1e9;for(let n=e;n<=s;){let a=t.doc.lineAt(n);if(a.from>r&&(e==s||s>a.from)){r=a.from;let e=_l(t,n).line;if(!e)continue;let s=/^\s*/.exec(a.text)[0].length,l=s==a.length,h=a.text.slice(s,s+e.length)==e?s:-1;s<a.text.length&&s<o&&(o=s),i.push({line:a,comment:h,token:e,indent:s,empty:l,single:!1})}n=a.to+1}if(o<1e9)for(let e=n;e<i.length;e++)i[e].indent<i[e].line.text.length&&(i[e].indent=o);i.length==n+1&&(i[n].single=!0)}if(2!=e&&i.some((e=>e.comment<0&&(!e.empty||e.single)))){let e=[];for(let{line:t,token:n,indent:r,empty:s,single:o}of i)(o||!s)&&e.push({from:t.from+r,insert:n+" "});let n=t.changes(e);return{changes:n,selection:t.selection.map(n,1)}}if(1!=e&&i.some((e=>e.comment>=0))){let e=[];for(let{line:t,comment:n,token:r}of i)if(n>=0){let i=t.from+n,s=i+r.length;" "==t.text[s-t.from]&&s++,e.push({from:i,to:s})}return{changes:e}}return null}),0),Al=Sl(El,0),Cl=Sl(((e,t)=>El(e,t,function(e){let t=[];for(let n of e.selection.ranges){let i=e.doc.lineAt(n.from),r=n.to<=i.to?i:e.doc.lineAt(n.to),s=t.length-1;s>=0&&t[s].to>i.from?t[s].to=r.to:t.push({from:i.from,to:r.to})}return t}(t))),0);function _l(e,t=e.selection.main.head){let n=e.languageDataAt("commentTokens",t);return n.length?n[0]:{}}function El(e,t,n=t.selection.ranges){let i=n.map((e=>_l(t,e.from).block));if(!i.every((e=>e)))return null;let r=n.map(((e,n)=>function(e,{open:t,close:n},i,r){let s,o,a=e.sliceDoc(i-50,i),l=e.sliceDoc(r,r+50),h=/\s*$/.exec(a)[0].length,c=/^\s*/.exec(l)[0].length,u=a.length-h;if(a.slice(u-t.length,u)==t&&l.slice(c,c+n.length)==n)return{open:{pos:i-h,margin:h&&1},close:{pos:r+c,margin:c&&1}};r-i<=100?s=o=e.sliceDoc(i,r):(s=e.sliceDoc(i,i+50),o=e.sliceDoc(r-50,r));let d=/^\s*/.exec(s)[0].length,p=/\s*$/.exec(o)[0].length,f=o.length-p-n.length;return s.slice(d,d+t.length)==t&&o.slice(f,f+n.length)==n?{open:{pos:i+d+t.length,margin:/\s/.test(s.charAt(d+t.length))?1:0},close:{pos:r-p-n.length,margin:/\s/.test(o.charAt(f-1))?1:0}}:null}(t,i[n],e.from,e.to)));if(2!=e&&!r.every((e=>e)))return{changes:t.changes(n.map(((e,t)=>r[t]?[]:[{from:e.from,insert:i[t].open+" "},{from:e.to,insert:" "+i[t].close}])))};if(1!=e&&r.some((e=>e))){let e=[];for(let t,n=0;n<r.length;n++)if(t=r[n]){let r=i[n],{open:s,close:o}=t;e.push({from:s.pos-r.open.length,to:s.pos+s.margin},{from:o.pos-o.margin,to:o.pos+r.close.length})}return{changes:e}}return null}var Tl=me.define(),Pl=me.define(),$l=U.define(),Nl=U.define({combine:e=>Pe(e,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})});var Il=W.define({create:()=>Gl.empty,update(e,t){let n=t.state.facet(Nl),i=t.annotation(Tl);if(i){let r=t.docChanged?D.single(function(e){let t=0;return e.iterChangedRanges(((e,n)=>t=n)),t}(t.changes)):void 0,s=Xl.fromTransaction(t,r),o=i.side,a=0==o?e.undone:e.done;return a=s?Fl(a,a.length,n.minDepth,s):Vl(a,t.startState.selection),new Gl(0==o?i.rest:a,0==o?a:i.rest)}let r=t.annotation(Pl);if(("full"==r||"before"==r)&&(e=e.isolate()),!1===t.annotation(ye.addToHistory))return t.changes.empty?e:e.addMapping(t.changes.desc);let s=Xl.fromTransaction(t),o=t.annotation(ye.time),a=t.annotation(ye.userEvent);return s?e=e.addChanges(s,o,a,n.newGroupDelay,n.minDepth):t.selection&&(e=e.addSelection(t.startState.selection,o,a,n.newGroupDelay)),("full"==r||"after"==r)&&(e=e.isolate()),e},toJSON:e=>({done:e.done.map((e=>e.toJSON())),undone:e.undone.map((e=>e.toJSON()))}),fromJSON:e=>new Gl(e.done.map(Xl.fromJSON),e.undone.map(Xl.fromJSON))});function Ql(e,t){return function({state:n,dispatch:i}){if(!t&&n.readOnly)return!1;let r=n.field(Il,!1);if(!r)return!1;let s=r.pop(e,n,t);return!!s&&(i(s),!0)}}var Rl=Ql(0,!1),Ml=Ql(1,!1),Bl=Ql(0,!0),Dl=Ql(1,!0),Xl=class{constructor(e,t,n,i,r){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=i,this.selectionsAfter=r}setSelAfter(e){return new Xl(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:null===(e=this.changes)||void 0===e?void 0:e.toJSON(),mapped:null===(t=this.mapped)||void 0===t?void 0:t.toJSON(),startSelection:null===(n=this.startSelection)||void 0===n?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map((e=>e.toJSON()))}}static fromJSON(e){return new Xl(e.changes&&P.fromJSON(e.changes),[],e.mapped&&T.fromJSON(e.mapped),e.startSelection&&D.fromJSON(e.startSelection),e.selectionsAfter.map(D.fromJSON))}static fromTransaction(e,t){let n=Ul;for(let t of e.startState.facet($l)){let i=t(e);i.length&&(n=n.concat(i))}return!n.length&&e.changes.empty?null:new Xl(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,Ul)}static selection(e){return new Xl(void 0,Ul,void 0,void 0,e)}};function Fl(e,t,n,i){let r=t+1>n+20?t-n-1:0,s=e.slice(r,t);return s.push(i),s}function Ll(e,t){return e.length?t.length?e.concat(t):e:t}var Ul=[];function Vl(e,t){if(e.length){let n=e[e.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-200));return i.length&&i[i.length-1].eq(t)?e:(i.push(t),Fl(e,e.length-1,1e9,n.setSelAfter(i)))}return[Xl.selection([t])]}function zl(e){let t=e[e.length-1],n=e.slice();return n[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),n}function Zl(e,t){if(!e.length)return e;let n=e.length,i=Ul;for(;n;){let r=jl(e[n-1],t,i);if(r.changes&&!r.changes.empty||r.effects.length){let t=e.slice(0,n);return t[n-1]=r,t}t=r.mapped,n--,i=r.selectionsAfter}return i.length?[Xl.selection(i)]:Ul}function jl(e,t,n){let i=Ll(e.selectionsAfter.length?e.selectionsAfter.map((e=>e.map(t))):Ul,n);if(!e.changes)return Xl.selection(i);let r=e.changes.map(t),s=t.mapDesc(e.changes,!0),o=e.mapped?e.mapped.composeDesc(s):s;return new Xl(r,Oe.mapEffects(e.effects,t),o,e.startSelection.map(s),i)}var ql=/^(input\.type|delete)($|\.)/,Gl=class{constructor(e,t,n=0,i){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=i}isolate(){return this.prevTime?new Gl(this.done,this.undone):this}addChanges(e,t,n,i,r){let s=this.done,o=s[s.length-1];return s=o&&o.changes&&!o.changes.empty&&e.changes&&(!n||ql.test(n))&&(!o.selectionsAfter.length&&t-this.prevTime<i&&function(e,t){let n=[],i=!1;return e.iterChangedRanges(((e,t)=>n.push(e,t))),t.iterChangedRanges(((e,t,r,s)=>{for(let e=0;e<n.length;){let t=n[e++],o=n[e++];s>=t&&r<=o&&(i=!0)}})),i}(o.changes,e.changes)||"input.type.compose"==n)?Fl(s,s.length-1,r,new Xl(e.changes.compose(o.changes),Ll(e.effects,o.effects),o.mapped,o.startSelection,Ul)):Fl(s,s.length,r,e),new Gl(s,Ul,t,n)}addSelection(e,t,n,i){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:Ul;return r.length>0&&t-this.prevTime<i&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&function(e,t){return e.ranges.length==t.ranges.length&&0===e.ranges.filter(((e,n)=>e.empty!=t.ranges[n].empty)).length}(r[r.length-1],e)?this:new Gl(Vl(this.done,e),this.undone,t,n)}addMapping(e){return new Gl(Zl(this.done,e),Zl(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let i=0==e?this.done:this.undone;if(0==i.length)return null;let r=i[i.length-1];if(n&&r.selectionsAfter.length)return t.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:Tl.of({side:e,rest:zl(i)}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let n=1==i.length?Ul:i.slice(0,i.length-1);return r.mapped&&(n=Zl(n,r.mapped)),t.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:Tl.of({side:e,rest:n}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}return null}};Gl.empty=new Gl(Ul,Ul);var Wl=[{key:"Mod-z",run:Rl,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Ml,preventDefault:!0},{key:"Mod-u",run:Bl,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Dl,preventDefault:!0}];function Hl(e,t){return D.create(e.ranges.map(t),e.mainIndex)}function Yl(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function Jl({state:e,dispatch:t},n){let i=Hl(e.selection,n);return!i.eq(e.selection)&&(t(Yl(e,i)),!0)}function Kl(e,t){return D.cursor(t?e.to:e.from)}function eh(e,t){return Jl(e,(n=>n.empty?e.moveByChar(n,t):Kl(n,t)))}function th(e){return e.textDirectionAt(e.state.selection.main.head)==Zn.LTR}var nh=e=>eh(e,!th(e)),ih=e=>eh(e,th(e));function rh(e,t){return Jl(e,(n=>n.empty?e.moveByGroup(n,t):Kl(n,t)))}function sh(e,t,n){if(t.type.prop(n))return!0;let i=t.to-t.from;return i&&(i>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function oh(e,t,n){let i,r,s=pa(e).resolveInner(t.head),o=n?ao.closedBy:ao.openedBy;for(let i=t.head;;){let t=n?s.childAfter(i):s.childBefore(i);if(!t)break;sh(e,t,o)?s=t:i=n?t.to:t.from}return r=s.type.prop(o)&&(i=n?Ol(e,s.from,1):Ol(e,s.to,-1))&&i.matched?n?i.end.to:i.end.from:n?s.to:s.from,D.cursor(r,n?-1:1)}function ah(e,t){return Jl(e,(n=>{if(!n.empty)return Kl(n,t);let i=e.moveVertically(n,t);return i.head!=n.head?i:e.moveToLineBoundary(n,t)}))}var lh=e=>ah(e,!1),hh=e=>ah(e,!0);function ch(e,t){let{state:n}=e,i=Hl(n.selection,(n=>n.empty?e.moveVertically(n,t,Math.min(e.dom.clientHeight,innerHeight)):Kl(n,t)));if(i.eq(n.selection))return!1;let r,s=e.coordsAtPos(n.selection.main.head),o=e.scrollDOM.getBoundingClientRect();return s&&s.top>o.top&&s.bottom<o.bottom&&s.top-o.top<=e.scrollDOM.scrollHeight-e.scrollDOM.scrollTop-e.scrollDOM.clientHeight&&(r=$r.scrollIntoView(i.main.head,{y:"start",yMargin:s.top-o.top})),e.dispatch(Yl(n,i),{effects:r}),!0}var uh=e=>ch(e,!1),dh=e=>ch(e,!0);function ph(e,t,n){let i=e.lineBlockAt(t.head),r=e.moveToLineBoundary(t,n);if(r.head==t.head&&r.head!=(n?i.to:i.from)&&(r=e.moveToLineBoundary(t,n,!1)),!n&&r.head==i.from&&i.length){let n=/^\s*/.exec(e.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;n&&t.head!=i.from+n&&(r=D.cursor(i.from+n))}return r}var fh=e=>Jl(e,(t=>ph(e,t,!0))),mh=e=>Jl(e,(t=>ph(e,t,!1)));function gh(e,t){let n=Hl(e.state.selection,(e=>{let n=t(e);return D.range(e.anchor,n.head,n.goalColumn)}));return!n.eq(e.state.selection)&&(e.dispatch(Yl(e.state,n)),!0)}function Oh(e,t){return gh(e,(n=>e.moveByChar(n,t)))}var yh=e=>Oh(e,!th(e)),vh=e=>Oh(e,th(e));function bh(e,t){return gh(e,(n=>e.moveByGroup(n,t)))}function wh(e,t){return gh(e,(n=>e.moveVertically(n,t)))}var xh=e=>wh(e,!1),Sh=e=>wh(e,!0);function kh(e,t){return gh(e,(n=>e.moveVertically(n,t,Math.min(e.dom.clientHeight,innerHeight))))}var Ah=e=>kh(e,!1),Ch=e=>kh(e,!0),_h=e=>gh(e,(t=>ph(e,t,!0))),Eh=e=>gh(e,(t=>ph(e,t,!1))),Th=({state:e,dispatch:t})=>(t(Yl(e,{anchor:0})),!0),Ph=({state:e,dispatch:t})=>(t(Yl(e,{anchor:e.doc.length})),!0),$h=({state:e,dispatch:t})=>(t(Yl(e,{anchor:e.selection.main.anchor,head:0})),!0),Nh=({state:e,dispatch:t})=>(t(Yl(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0);function Ih({state:e,dispatch:t},n){if(e.readOnly)return!1;let i="delete.selection",r=e.changeByRange((e=>{let{from:t,to:r}=e;if(t==r){let e=n(t);e<t?i="delete.backward":e>t&&(i="delete.forward"),t=Math.min(t,e),r=Math.max(r,e)}return t==r?{range:e}:{changes:{from:t,to:r},range:D.cursor(t)}}));return!r.changes.empty&&(t(e.update(r,{scrollIntoView:!0,userEvent:i})),!0)}function Qh(e,t,n){if(e instanceof $r)for(let i of e.state.facet($r.atomicRanges).map((t=>t(e))))i.between(t,t,((e,i)=>{e<t&&i>t&&(t=n?i:e)}));return t}var Rh=(e,t)=>Ih(e,(n=>{let i,r,{state:s}=e,o=s.doc.lineAt(n);if(!t&&n>o.from&&n<o.from+200&&!/[^ \t]/.test(i=o.text.slice(0,n-o.from))){if("\t"==i[i.length-1])return n-1;let e=qe(i,s.tabSize)%Aa(s)||Aa(s);for(let t=0;t<e&&" "==i[i.length-1-t];t++)n--;r=n}else r=v(o.text,n-o.from,t,t)+o.from,r==n&&o.number!=(t?s.doc.lines:1)&&(r+=t?1:-1);return Qh(e,r,t)})),Mh=e=>Rh(e,!1),Bh=e=>Rh(e,!0),Dh=(e,t)=>Ih(e,(n=>{let i=n,{state:r}=e,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let e=null;;){if(i==(t?s.to:s.from)){i==n&&s.number!=(t?r.doc.lines:1)&&(i+=t?1:-1);break}let a=v(s.text,i-s.from,t)+s.from,l=s.text.slice(Math.min(i,a)-s.from,Math.max(i,a)-s.from),h=o(l);if(null!=e&&h!=e)break;(" "!=l||i!=n)&&(e=h),i=a}return Qh(e,i,t)})),Xh=e=>Dh(e,!1),Fh=e=>Ih(e,(t=>{let n=e.lineBlockAt(t).to;return Qh(e,t<n?n:Math.min(e.state.doc.length,t+1),!0)}));function Lh(e){let t=[],n=-1;for(let i of e.selection.ranges){let r=e.doc.lineAt(i.from),s=e.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=e.doc.lineAt(i.to-1)),n>=r.number){let e=t[t.length-1];e.to=s.to,e.ranges.push(i)}else t.push({from:r.from,to:s.to,ranges:[i]});n=s.number+1}return t}function Uh(e,t,n){if(e.readOnly)return!1;let i=[],r=[];for(let t of Lh(e)){if(n?t.to==e.doc.length:0==t.from)continue;let s=e.doc.lineAt(n?t.to+1:t.from-1),o=s.length+1;if(n){i.push({from:t.to,to:s.to},{from:t.from,insert:s.text+e.lineBreak});for(let n of t.ranges)r.push(D.range(Math.min(e.doc.length,n.anchor+o),Math.min(e.doc.length,n.head+o)))}else{i.push({from:s.from,to:t.from},{from:t.to,insert:e.lineBreak+s.text});for(let e of t.ranges)r.push(D.range(e.anchor-o,e.head-o))}}return!!i.length&&(t(e.update({changes:i,scrollIntoView:!0,selection:D.create(r,e.selection.mainIndex),userEvent:"move.line"})),!0)}function Vh(e,t,n){if(e.readOnly)return!1;let i=[];for(let t of Lh(e))n?i.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):i.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});return t(e.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}var zh=jh(!1),Zh=jh(!0);function jh(e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let i=t.changeByRange((n=>{let{from:i,to:r}=n,s=t.doc.lineAt(i),o=!e&&i==r&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let n,i=pa(e).resolveInner(t),r=i.childBefore(t),s=i.childAfter(t);return r&&s&&r.to<=t&&s.from>=t&&(n=r.type.prop(ao.closedBy))&&n.indexOf(s.name)>-1&&e.doc.lineAt(r.to).from==e.doc.lineAt(s.from).from?{from:r.to,to:s.from}:null}(t,i);e&&(i=r=(r<=s.to?s:t.doc.lineAt(r)).to);let l=new Ea(t,{simulateBreak:i,simulateDoubleBreak:!!o}),h=_a(l,i);for(null==h&&(h=/^\s*/.exec(t.doc.lineAt(i).text)[0].length);r<s.to&&/\s/.test(s.text[r-s.from]);)r++;o?({from:i,to:r}=o):i>s.from&&i<s.from+100&&!/\S/.test(s.text.slice(0,i))&&(i=s.from);let c=["",Ca(t,h)];return o&&c.push(Ca(t,l.lineIndent(s.from,-1))),{changes:{from:i,to:r,insert:a.of(c)},range:D.cursor(i+1+c[1].length)}}));return n(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function qh(e,t){let n=-1;return e.changeByRange((i=>{let r=[];for(let s=i.from;s<=i.to;){let o=e.doc.lineAt(s);o.number>n&&(i.empty||i.to>o.from)&&(t(o,r,i),n=o.number),s=o.to+1}let s=e.changes(r);return{changes:r,range:D.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}}))}var Gh=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(qh(e,((t,n)=>{n.push({from:t.from,insert:e.facet(ka)})})),{userEvent:"input.indent"})),!0),Wh=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(qh(e,((t,n)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let r=qe(i,e.tabSize),s=0,o=Ca(e,Math.max(0,r-Aa(e)));for(;s<i.length&&s<o.length&&i.charCodeAt(s)==o.charCodeAt(s);)s++;n.push({from:t.from+s,to:t.from+i.length,insert:o.slice(s)})})),{userEvent:"delete.dedent"})),!0),Hh=[{key:"Ctrl-b",run:nh,shift:yh,preventDefault:!0},{key:"Ctrl-f",run:ih,shift:vh},{key:"Ctrl-p",run:lh,shift:xh},{key:"Ctrl-n",run:hh,shift:Sh},{key:"Ctrl-a",run:e=>Jl(e,(t=>D.cursor(e.lineBlockAt(t.head).from,1))),shift:e=>gh(e,(t=>D.cursor(e.lineBlockAt(t.head).from)))},{key:"Ctrl-e",run:e=>Jl(e,(t=>D.cursor(e.lineBlockAt(t.head).to,-1))),shift:e=>gh(e,(t=>D.cursor(e.lineBlockAt(t.head).to)))},{key:"Ctrl-d",run:Bh},{key:"Ctrl-h",run:Mh},{key:"Ctrl-k",run:Fh},{key:"Ctrl-Alt-h",run:Xh},{key:"Ctrl-o",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:a.of(["",""])},range:D.cursor(e.from)})));return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange((t=>{if(!t.empty||0==t.from||t.from==e.doc.length)return{range:t};let n=t.from,i=e.doc.lineAt(n),r=n==i.from?n-1:v(i.text,n-i.from,!1)+i.from,s=n==i.to?n+1:v(i.text,n-i.from,!0)+i.from;return{changes:{from:r,to:s,insert:e.doc.slice(n,s).append(e.doc.slice(r,n))},range:D.cursor(s)}}));return!n.changes.empty&&(t(e.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:dh}],Yh=[{key:"ArrowLeft",run:nh,shift:yh,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>rh(e,!th(e)),shift:e=>bh(e,!th(e))},{mac:"Cmd-ArrowLeft",run:mh,shift:Eh},{key:"ArrowRight",run:ih,shift:vh,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>rh(e,th(e)),shift:e=>bh(e,th(e))},{mac:"Cmd-ArrowRight",run:fh,shift:_h},{key:"ArrowUp",run:lh,shift:xh,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Th,shift:$h},{mac:"Ctrl-ArrowUp",run:uh,shift:Ah},{key:"ArrowDown",run:hh,shift:Sh,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Ph,shift:Nh},{mac:"Ctrl-ArrowDown",run:dh,shift:Ch},{key:"PageUp",run:uh,shift:Ah},{key:"PageDown",run:dh,shift:Ch},{key:"Home",run:mh,shift:Eh,preventDefault:!0},{key:"Mod-Home",run:Th,shift:$h},{key:"End",run:fh,shift:_h,preventDefault:!0},{key:"Mod-End",run:Ph,shift:Nh},{key:"Enter",run:zh},{key:"Mod-a",run:({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:Mh,shift:Mh},{key:"Delete",run:Bh},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Xh},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>Dh(e,!0)},{mac:"Mod-Backspace",run:e=>Ih(e,(t=>{let n=e.lineBlockAt(t).from;return Qh(e,t>n?n:Math.max(0,t-1),!1)}))},{mac:"Mod-Delete",run:Fh}].concat(Hh.map((e=>({mac:e.key,run:e.run,shift:e.shift})))),Jh=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>Jl(e,(t=>oh(e.state,t,!th(e)))),shift:e=>gh(e,(t=>oh(e.state,t,!th(e))))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>Jl(e,(t=>oh(e.state,t,th(e)))),shift:e=>gh(e,(t=>oh(e.state,t,th(e))))},{key:"Alt-ArrowUp",run:({state:e,dispatch:t})=>Uh(e,t,!1)},{key:"Shift-Alt-ArrowUp",run:({state:e,dispatch:t})=>Vh(e,t,!1)},{key:"Alt-ArrowDown",run:({state:e,dispatch:t})=>Uh(e,t,!0)},{key:"Shift-Alt-ArrowDown",run:({state:e,dispatch:t})=>Vh(e,t,!0)},{key:"Escape",run:({state:e,dispatch:t})=>{let n=e.selection,i=null;return n.ranges.length>1?i=D.create([n.main]):n.main.empty||(i=D.create([D.cursor(n.main.head)])),!!i&&(t(Yl(e,i)),!0)}},{key:"Mod-Enter",run:Zh},{key:"Alt-l",mac:"Ctrl-l",run:({state:e,dispatch:t})=>{let n=Lh(e).map((({from:t,to:n})=>D.range(t,Math.min(n+1,e.doc.length))));return t(e.update({selection:D.create(n),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:e,dispatch:t})=>{let n=Hl(e.selection,(t=>{var n;let i=pa(e).resolveInner(t.head,1);for(;!(i.from<t.from&&i.to>=t.to||i.to>t.to&&i.from<=t.from||null===(n=i.parent)||void 0===n)&&n.parent;)i=i.parent;return D.range(i.to,i.from)}));return t(Yl(e,n)),!0},preventDefault:!0},{key:"Mod-[",run:Wh},{key:"Mod-]",run:Gh},{key:"Mod-Alt-\\",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=Object.create(null),i=new Ea(e,{overrideIndentation:e=>n[e]??-1}),r=qh(e,((t,r,s)=>{let o=_a(i,t.from);if(null==o)return;/\S/.test(t.text)||(o=0);let a=/^\s*/.exec(t.text)[0],l=Ca(e,o);(a!=l||s.from<t.from+a.length)&&(n[t.from]=o,r.push({from:t.from,to:t.from+a.length,insert:l}))}));return r.changes.empty||t(e.update(r,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:e=>{if(e.state.readOnly)return!1;let{state:t}=e,n=t.changes(Lh(t).map((({from:e,to:n})=>(e>0?e--:n<t.doc.length&&n++,{from:e,to:n})))),i=Hl(t.selection,(t=>e.moveVertically(t,!0))).map(n);return e.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:e,dispatch:t})=>function(e,t,n){let i=!1,r=Hl(e.selection,(t=>{let r=Ol(e,t.head,-1)||Ol(e,t.head,1)||t.head>0&&Ol(e,t.head-1,1)||t.head<e.doc.length&&Ol(e,t.head+1,-1);if(!r||!r.end)return t;i=!0;let s=r.start.from==t.head?r.end.to:r.end.from;return n?D.range(t.anchor,s):D.cursor(s)}));return!!i&&(t(Yl(e,r)),!0)}(e,t,!1)},{key:"Mod-/",run:e=>{let t=_l(e.state);return t.line?kl(e):!!t.block&&Cl(e)}},{key:"Alt-A",run:Al}].concat(Yh),Kh={key:"Tab",run:Gh,shift:Wh};function ec(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,n=arguments[1];if(n&&"object"==typeof n&&null==n.nodeType&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];"string"==typeof r?e.setAttribute(i,r):null!=r&&(e[i]=r)}t++}for(;t<arguments.length;t++)tc(e,arguments[t]);return e}function tc(e,t){if("string"==typeof t)e.appendChild(document.createTextNode(t));else if(null!=t)if(null!=t.nodeType)e.appendChild(t);else{if(!Array.isArray(t))throw new RangeError("Unsupported child node: "+t);for(var n=0;n<t.length;n++)tc(e,t[n])}}var nc="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e,ic=class{constructor(e,t,n=0,i=e.length,r){this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=r?e=>r(nc(e)):nc,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return k(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=A(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=C(e);let i=this.normalize(t);for(let e=0,r=n;;e++){let s=i.charCodeAt(e),o=this.match(s,r);if(o)return this.value=o,this;if(e==i.length-1)break;r==n&&e<t.length&&t.charCodeAt(e)==s&&r++}}}match(e,t){let n=null;for(let i=0;i<this.matches.length;i+=2){let r=this.matches[i],s=!1;this.query.charCodeAt(r)==e&&(r==this.query.length-1?n={from:this.matches[i+1],to:t+1}:(this.matches[i]++,s=!0)),s||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?n={from:t,to:t+1}:this.matches.push(1,t)),n}};typeof Symbol<"u"&&(ic.prototype[Symbol.iterator]=function(){return this});var rc={from:-1,to:-1,match:/.*/.exec("")},sc="gm"+(null==/x/.unicode?"":"u"),oc=class{constructor(e,t,n,i=0,r=e.length){if(this.to=r,this.curLine="",this.done=!1,this.value=rc,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new hc(e,t,n,i,r);this.re=new RegExp(t,sc+(n?.ignoreCase?"i":"")),this.iter=e.iter();let s=e.lineAt(i);this.curLineStart=s.from,this.matchPos=i,this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,i=n+t[0].length;if(this.matchPos=i+(n==i?1:0),n==this.curLine.length&&this.nextLine(),n<i||n>this.value.to)return this.value={from:n,to:i,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}},ac=new WeakMap,lc=class{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let i=ac.get(e);if(!i||i.from>=n||i.to<=t){let i=new lc(t,e.sliceString(t,n));return ac.set(e,i),i}if(i.from==t&&i.to==n)return i;let{text:r,from:s}=i;return s>t&&(r=e.sliceString(t,s)+r,s=t),i.to<n&&(r+=e.sliceString(i.to,n)),ac.set(e,new lc(s,r)),new lc(t,r.slice(t-s,n-s))}},hc=class{constructor(e,t,n,i,r){this.text=e,this.to=r,this.done=!1,this.value=rc,this.matchPos=i,this.re=new RegExp(t,sc+(n?.ignoreCase?"i":"")),this.flat=lc.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t&&this.flat.to<this.to&&t.index+t[0].length>this.flat.text.length-10&&(t=null),t){let e=this.flat.from+t.index,n=e+t[0].length;return this.value={from:e,to:n,match:t},this.matchPos=n+(e==n?1:0),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=lc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}};function cc(e){let t=ec("input",{class:"cm-textfield",name:"line"}),n=ec("form",{class:"cm-gotoLine",onkeydown:t=>{27==t.keyCode?(t.preventDefault(),e.dispatch({effects:uc.of(!1)}),e.focus()):13==t.keyCode&&(t.preventDefault(),i())},onsubmit:e=>{e.preventDefault(),i()}},ec("label",e.state.phrase("Go to line"),": ",t)," ",ec("button",{class:"cm-button",type:"submit"},e.state.phrase("go")));function i(){let n=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!n)return;let{state:i}=e,r=i.doc.lineAt(i.selection.main.head),[,s,o,a,l]=n,h=a?+a.slice(1):0,c=o?+o:r.number;if(o&&l){let e=c/100;s&&(e=e*("-"==s?-1:1)+r.number/i.doc.lines),c=Math.round(i.doc.lines*e)}else o&&s&&(c=c*("-"==s?-1:1)+r.number);let u=i.doc.line(Math.max(1,Math.min(i.doc.lines,c)));e.dispatch({effects:uc.of(!1),selection:D.cursor(u.from+Math.max(0,Math.min(h,u.length))),scrollIntoView:!0}),e.focus()}return{dom:n}}typeof Symbol<"u"&&(oc.prototype[Symbol.iterator]=hc.prototype[Symbol.iterator]=function(){return this});var uc=Oe.define(),dc=W.define({create:()=>!0,update(e,t){for(let n of t.effects)n.is(uc)&&(e=n.value);return e},provide:e=>Bs.from(e,(e=>e?cc:null))}),pc=$r.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),fc={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},mc=U.define({combine:e=>Pe(e,fc,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})});var gc=cn.mark({class:"cm-selectionMatch"}),Oc=cn.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function yc(e,t,n,i){return!(0!=n&&e(t.sliceDoc(n-1,n))==Ce.Word||i!=t.doc.length&&e(t.sliceDoc(i,i+1))==Ce.Word)}var vc=Rn.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=e.state.facet(mc),{state:n}=e,i=n.selection;if(i.ranges.length>1)return cn.none;let r,s=i.main,o=null;if(s.empty){if(!t.highlightWordAroundCursor)return cn.none;let e=n.wordAt(s.head);if(!e)return cn.none;o=n.charCategorizer(s.head),r=n.sliceDoc(e.from,e.to)}else{let e=s.to-s.from;if(e<t.minSelectionLength||e>200)return cn.none;if(t.wholeWords){if(r=n.sliceDoc(s.from,s.to),o=n.charCategorizer(s.head),!yc(o,n,s.from,s.to)||!function(e,t,n,i){return e(t.sliceDoc(n,n+1))==Ce.Word&&e(t.sliceDoc(i-1,i))==Ce.Word}(o,n,s.from,s.to))return cn.none}else if(r=n.sliceDoc(s.from,s.to).trim(),!r)return cn.none}let a=[];for(let i of e.visibleRanges){let e=new ic(n.doc,r,i.from,i.to);for(;!e.next().done;){let{from:i,to:r}=e.value;if((!o||yc(o,n,i,r))&&(s.empty&&i<=s.from&&r>=s.to?a.push(Oc.range(i,r)):(i>=s.to||r<=s.from)&&a.push(gc.range(i,r)),a.length>t.maxMatches))return cn.none}}return cn.set(a)}},{decorations:e=>e.decorations}),bc=$r.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});var wc=U.define({combine(e){var t;return{top:e.reduce(((e,t)=>e??t.top),void 0)||!1,caseSensitive:e.reduce(((e,t)=>e??t.caseSensitive),void 0)||!1,createPanel:(null===(t=e.find((e=>e.createPanel)))||void 0===t?void 0:t.createPanel)||(e=>new jc(e))}}}),xc=class{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||function(e){try{return new RegExp(e,sc),!0}catch{return!1}}(this.search)),this.unquoted=e.literal?this.search:this.search.replace(/\\([nrt\\])/g,((e,t)=>"n"==t?"\n":"r"==t?"\r":"t"==t?"\t":"\\"))}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp}create(){return this.regexp?new _c(this):new Ac(this)}getCursor(e,t=0,n=e.length){return this.regexp?Cc(this,e,t,n):kc(this,e,t,n)}},Sc=class{constructor(e){this.spec=e}};function kc(e,t,n,i){return new ic(t,e.unquoted,n,i,e.caseSensitive?void 0:e=>e.toLowerCase())}var Ac=class extends Sc{constructor(e){super(e)}nextMatch(e,t,n){let i=kc(this.spec,e,n,e.length).nextOverlapping();return i.done&&(i=kc(this.spec,e,0,t).nextOverlapping()),i.done?null:i.value}prevMatchInRange(e,t,n){for(let i=n;;){let n=Math.max(t,i-1e4-this.spec.unquoted.length),r=kc(this.spec,e,n,i),s=null;for(;!r.nextOverlapping().done;)s=r.value;if(s)return s;if(n==t)return null;i-=1e4}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.length)}getReplacement(e){return this.spec.replace}matchAll(e,t){let n=kc(this.spec,e,0,e.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let r=kc(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.length));for(;!r.next().done;)i(r.value.from,r.value.to)}};function Cc(e,t,n,i){return new oc(t,e.search,e.caseSensitive?void 0:{ignoreCase:!0},n,i)}var _c=class extends Sc{nextMatch(e,t,n){let i=Cc(this.spec,e,n,e.length).next();return i.done&&(i=Cc(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,n){for(let i=1;;i++){let r=Math.max(t,n-1e4*i),s=Cc(this.spec,e,r,n),o=null;for(;!s.next().done;)o=s.value;if(o&&(r==t||o.from>r+10))return o;if(r==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.length)}getReplacement(e){return this.spec.replace.replace(/\$([$&\d+])/g,((t,n)=>"$"==n?"$":"&"==n?e.match[0]:"0"!=n&&+n<e.match.length?e.match[n]:t))}matchAll(e,t){let n=Cc(this.spec,e,0,e.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let r=Cc(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.length));for(;!r.next().done;)i(r.value.from,r.value.to)}},Ec=Oe.define(),Tc=Oe.define(),Pc=W.define({create:e=>new $c(Uc(e).create(),null),update(e,t){for(let n of t.effects)n.is(Ec)?e=new $c(n.value.create(),e.panel):n.is(Tc)&&(e=new $c(e.query,n.value?Lc:null));return e},provide:e=>Bs.from(e,(e=>e.panel))}),$c=class{constructor(e,t){this.query=e,this.panel=t}},Nc=cn.mark({class:"cm-searchMatch"}),Ic=cn.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Qc=Rn.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(Pc))}update(e){let t=e.state.field(Pc);(t!=e.startState.field(Pc)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return cn.none;let{view:n}=this,i=new Me;for(let t=0,r=n.visibleRanges,s=r.length;t<s;t++){let{from:o,to:a}=r[t];for(;t<s-1&&a>r[t+1].from-500;)a=r[++t].to;e.highlight(n.state.doc,o,a,((e,t)=>{let r=n.state.selection.ranges.some((n=>n.from==e&&n.to==t));i.add(e,t,r?Ic:Nc)}))}return i.finish()}},{decorations:e=>e.decorations});function Rc(e){return t=>{let n=t.state.field(Pc,!1);return n&&n.query.spec.valid?e(t,n):Vc(t)}}var Mc=Rc(((e,{query:t})=>{let{from:n,to:i}=e.state.selection.main,r=t.nextMatch(e.state.doc,n,i);return!(!r||r.from==n&&r.to==i)&&(e.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:Wc(e,r),userEvent:"select.search"}),!0)})),Bc=Rc(((e,{query:t})=>{let{state:n}=e,{from:i,to:r}=n.selection.main,s=t.prevMatch(n.doc,i,r);return!!s&&(e.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:Wc(e,s),userEvent:"select.search"}),!0)})),Dc=Rc(((e,{query:t})=>{let n=t.matchAll(e.state.doc,1e3);return!(!n||!n.length)&&(e.dispatch({selection:D.create(n.map((e=>D.range(e.from,e.to)))),userEvent:"select.search.matches"}),!0)})),Xc=Rc(((e,{query:t})=>{let{state:n}=e,{from:i,to:r}=n.selection.main;if(n.readOnly)return!1;let s=t.nextMatch(n.doc,i,i);if(!s)return!1;let o,a,l=[];if(s.from==i&&s.to==r&&(a=n.toText(t.getReplacement(s)),l.push({from:s.from,to:s.to,insert:a}),s=t.nextMatch(n.doc,s.from,s.to)),s){let e=0==l.length||l[0].from>=s.to?0:s.to-s.from-a.length;o={anchor:s.from-e,head:s.to-e}}return e.dispatch({changes:l,selection:o,scrollIntoView:!!o,effects:s?Wc(e,s):void 0,userEvent:"input.replace"}),!0})),Fc=Rc(((e,{query:t})=>{if(e.state.readOnly)return!1;let n=t.matchAll(e.state.doc,1e9).map((e=>{let{from:n,to:i}=e;return{from:n,to:i,insert:t.getReplacement(e)}}));return!!n.length&&(e.dispatch({changes:n,userEvent:"input.replace.all"}),!0)}));function Lc(e){return e.state.facet(wc).createPanel(e)}function Uc(e,t){var n;let i=e.selection.main,r=i.empty||i.to>i.from+100?"":e.sliceDoc(i.from,i.to),s=null!==(n=t?.caseSensitive)&&void 0!==n?n:e.facet(wc).caseSensitive;return t&&!r?t:new xc({search:r.replace(/\n/g,"\\n"),caseSensitive:s})}var Vc=e=>{let t=e.state.field(Pc,!1);if(t&&t.panel){let n=Is(e,Lc);if(!n)return!1;let i=n.dom.querySelector("[name=search]");if(i!=e.root.activeElement){let n=Uc(e.state,t.query.spec);n.valid&&e.dispatch({effects:Ec.of(n)}),i.focus(),i.select()}}else e.dispatch({effects:[Tc.of(!0),t?Ec.of(Uc(e.state,t.query.spec)):Oe.appendConfig.of(Yc)]});return!0},zc=e=>{let t=e.state.field(Pc,!1);if(!t||!t.panel)return!1;let n=Is(e,Lc);return n&&n.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:Tc.of(!1)}),!0},Zc=[{key:"Mod-f",run:Vc,scope:"editor search-panel"},{key:"F3",run:Mc,shift:Bc,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Mc,shift:Bc,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:zc,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:e,dispatch:t})=>{let n=e.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:i,to:r}=n.main,s=[],o=0;for(let t=new ic(e.doc,e.sliceDoc(i,r));!t.next().done;){if(s.length>1e3)return!1;t.value.from==i&&(o=s.length),s.push(D.range(t.value.from,t.value.to))}return t(e.update({selection:D.create(s,o),userEvent:"select.search.matches"})),!0}},{key:"Alt-g",run:e=>{let t=Is(e,cc);if(!t){let n=[uc.of(!0)];null==e.state.field(dc,!1)&&n.push(Oe.appendConfig.of([dc,pc])),e.dispatch({effects:n}),t=Is(e,cc)}return t&&t.dom.querySelector("input").focus(),!0}},{key:"Mod-d",run:({state:e,dispatch:t})=>{let{ranges:n}=e.selection;if(n.some((e=>e.from===e.to)))return(({state:e,dispatch:t})=>{let{selection:n}=e,i=D.create(n.ranges.map((t=>e.wordAt(t.head)||D.cursor(t.head))),n.mainIndex);return!i.eq(n)&&(t(e.update({selection:i})),!0)})({state:e,dispatch:t});let i=e.sliceDoc(n[0].from,n[0].to);if(e.selection.ranges.some((t=>e.sliceDoc(t.from,t.to)!=i)))return!1;let r=function(e,t){let{main:n,ranges:i}=e.selection,r=e.wordAt(n.head),s=r&&r.from==n.from&&r.to==n.to;for(let n=!1,r=new ic(e.doc,t,i[i.length-1].to);;){if(r.next(),!r.done){if(n&&i.some((e=>e.from==r.value.from)))continue;if(s){let t=e.wordAt(r.value.from);if(!t||t.from!=r.value.from||t.to!=r.value.to)continue}return r.value}if(n)return null;r=new ic(e.doc,t,0,Math.max(0,i[i.length-1].from-1)),n=!0}}(e,i);return!!r&&(t(e.update({selection:e.selection.addRange(D.range(r.from,r.to),!1),effects:$r.scrollIntoView(r.to)})),!0)},preventDefault:!0}],jc=class{constructor(e){this.view=e;let t=this.query=e.state.field(Pc).query.spec;function n(e,t,n){return ec("button",{class:"cm-button",name:e,onclick:t,type:"button"},n)}this.commit=this.commit.bind(this),this.searchField=ec("input",{value:t.search,placeholder:qc(e,"Find"),"aria-label":qc(e,"Find"),class:"cm-textfield",name:"search",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ec("input",{value:t.replace,placeholder:qc(e,"Replace"),"aria-label":qc(e,"Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit}),this.caseField=ec("input",{type:"checkbox",name:"case",checked:t.caseSensitive,onchange:this.commit}),this.reField=ec("input",{type:"checkbox",name:"re",checked:t.regexp,onchange:this.commit}),this.dom=ec("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,n("next",(()=>Mc(e)),[qc(e,"next")]),n("prev",(()=>Bc(e)),[qc(e,"previous")]),n("select",(()=>Dc(e)),[qc(e,"all")]),ec("label",null,[this.caseField,qc(e,"match case")]),ec("label",null,[this.reField,qc(e,"regexp")]),...e.state.readOnly?[]:[ec("br"),this.replaceField,n("replace",(()=>Xc(e)),[qc(e,"replace")]),n("replaceAll",(()=>Fc(e)),[qc(e,"replace all")]),ec("button",{name:"close",onclick:()=>zc(e),"aria-label":qc(e,"close"),type:"button"},[""])]])}commit(){let e=new xc({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ec.of(e)}))}keydown(e){!function(e,t,n){return Vr(Lr(e.state),t,e,n)}(this.view,e,"search-panel")?13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Bc:Mc)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),Xc(this.view)):e.preventDefault()}update(e){for(let t of e.transactions)for(let e of t.effects)e.is(Ec)&&!e.value.eq(this.query)&&this.setQuery(e.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(wc).top}};function qc(e,t){return e.state.phrase(t)}var Gc=/[\s\.,:;?!]/;function Wc(e,{from:t,to:n}){let i=e.state.doc.lineAt(t).from,r=e.state.doc.lineAt(n).to,s=Math.max(i,t-30),o=Math.min(r,n+30),a=e.state.sliceDoc(s,o);if(s!=i)for(let e=0;e<30;e++)if(!Gc.test(a[e+1])&&Gc.test(a[e])){a=a.slice(e);break}if(o!=r)for(let e=a.length-1;e>a.length-30;e--)if(!Gc.test(a[e-1])&&Gc.test(a[e])){a=a.slice(0,e);break}return $r.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${e.state.doc.lineAt(t).number}`)}var Hc=$r.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Yc=[Pc,te.lowest(Qc),Hc],Jc=class{constructor(e,t,n){this.state=e,this.pos=t,this.explicit=n,this.abortListeners=[]}tokenBefore(e){let t=pa(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),i=t.text.slice(n-t.from,this.pos-t.from),r=i.search(iu(e,!1));return r<0?null:{from:n+r,to:this.pos,text:i.slice(r)}}get aborted(){return null==this.abortListeners}addEventListener(e,t){"abort"==e&&this.abortListeners&&this.abortListeners.push(t)}};function Kc(e){let t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),`[${n?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function eu(e){let t=e.map((e=>"string"==typeof e?{label:e}:e)),[n,i]=t.every((e=>/^\w+$/.test(e.label)))?[/\w*$/,/\w+$/]:function(e){let t=Object.create(null),n=Object.create(null);for(let{label:i}of e){t[i[0]]=!0;for(let e=1;e<i.length;e++)n[i[e]]=!0}let i=Kc(t)+Kc(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}(t);return e=>{let r=e.matchBefore(i);return r||e.explicit?{from:r?r.from:e.pos,options:t,validFor:n}:null}}var tu=class{constructor(e,t,n){this.completion=e,this.source=t,this.match=n}};function nu(e){return e.selection.main.head}function iu(e,t){var n;let{source:i}=e,r=t&&"^"!=i[0],s="$"!=i[i.length-1];return r||s?new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,null!==(n=e.flags)&&void 0!==n?n:e.ignoreCase?"i":""):e}var ru=me.define();function su(e,t){let n=t.completion.apply||t.completion.label,i=t.source;"string"==typeof n?e.dispatch(e.state.changeByRange((t=>{if(t==e.state.selection.main)return{changes:{from:i.from,to:i.to,insert:n},range:D.cursor(i.from+n.length)};let r=i.to-i.from;return!t.empty||r&&e.state.sliceDoc(t.from-r,t.from)!=e.state.sliceDoc(i.from,i.to)?{range:t}:{changes:{from:t.from-r,to:t.from,insert:n},range:D.cursor(t.from-r+n.length)}})),{userEvent:"input.complete",annotations:ru.of(t.completion)}):n(e,t.completion,i.from,i.to)}var ou=new WeakMap;function au(e){if(!Array.isArray(e))return e;let t=ou.get(e);return t||ou.set(e,t=eu(e)),t}var lu=class{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let t=0;t<e.length;){let n=k(e,t),i=C(n);this.chars.push(n);let r=e.slice(t,t+i),s=r.toUpperCase();this.folded.push(k(s==r?r.toLowerCase():s,0)),t+=i}this.astral=e.length!=this.chars.length}match(e){if(0==this.pattern.length)return[0];if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:i,precise:r,byWord:s}=this;if(1==t.length){let i=k(e,0);return i==t[0]?[0,0,C(i)]:i==n[0]?[-200,0,C(i)]:null}let o=e.indexOf(this.pattern);if(0==o)return[0,0,this.pattern.length];let a=t.length,l=0;if(o<0){for(let r=0,s=Math.min(e.length,200);r<s&&l<a;){let s=k(e,r);(s==t[l]||s==n[l])&&(i[l++]=r),r+=C(s)}if(l<a)return null}let h=0,c=0,u=!1,d=0,p=-1,f=-1,m=/[a-z]/.test(e),g=!0;for(let i=0,l=Math.min(e.length,200),O=0;i<l&&c<a;){let l=k(e,i);o<0&&(h<a&&l==t[h]&&(r[h++]=i),d<a&&(l==t[d]||l==n[d]?(0==d&&(p=i),f=i+1,d++):d=0));let y,v=l<255?l>=48&&l<=57||l>=97&&l<=122?2:l>=65&&l<=90?1:0:(y=A(l))!=y.toLowerCase()?1:y!=y.toUpperCase()?2:0;(!i||1==v&&m||0==O&&0!=v)&&(t[c]==l||n[c]==l&&(u=!0)?s[c++]=i:s.length&&(g=!1)),O=v,i+=C(l)}return c==a&&0==s[0]&&g?this.result((u?-200:0)-100,s,e):d==a&&0==p?[-200-e.length,0,f]:o>-1?[-700-e.length,o,o+this.pattern.length]:d==a?[-900-e.length,p,f]:c==a?this.result((u?-200:0)-100-700+(g?0:-1100),s,e):2==t.length?null:this.result((i[0]?-700:0)-200-1100,i,e)}result(e,t,n){let i=[e-n.length],r=1;for(let e of t){let t=e+(this.astral?C(k(n,e)):1);r>1&&i[r-1]==e?i[r-1]=t:(i[r++]=e,i[r++]=t)}return i}},hu=U.define({combine:e=>Pe(e,{activateOnTyping:!0,override:null,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[]},{defaultKeymap:(e,t)=>e&&t,icons:(e,t)=>e&&t,optionClass:(e,t)=>n=>function(e,t){return e?t?e+" "+t:e:t}(e(n),t(n)),addToOptions:(e,t)=>e.concat(t)})});function cu(e,t,n){if(e<=n)return{from:0,to:e};if(t<=e>>1){let e=Math.floor(t/n);return{from:e*n,to:(e+1)*n}}let i=Math.floor((e-t)/n);return{from:e-(i+1)*n,to:e-i*n}}function uu(e){return t=>new class{constructor(e,t){this.view=e,this.stateField=t,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:e=>this.positionInfo(e),key:this};let n=e.state.field(t),{options:i,selected:r}=n.open,s=e.state.facet(hu);this.optionContent=function(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(e){let t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map((e=>"cm-completionIcon-"+e))),t.setAttribute("aria-hidden","true"),t},position:20}),t.push({render(e,t,n){let i=document.createElement("span");i.className="cm-completionLabel";let{label:r}=e,s=0;for(let e=1;e<n.length;){let t=n[e++],o=n[e++];t>s&&i.appendChild(document.createTextNode(r.slice(s,t)));let a=i.appendChild(document.createElement("span"));a.appendChild(document.createTextNode(r.slice(t,o))),a.className="cm-completionMatchedText",s=o}return s<r.length&&i.appendChild(document.createTextNode(r.slice(s))),i},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort(((e,t)=>e.position-t.position)).map((e=>e.render))}(s),this.optionClass=s.optionClass,this.range=cu(i.length,r,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",(t=>{for(let n,r=t.target;r&&r!=this.dom;r=r.parentNode)if("LI"==r.nodeName&&(n=/-(\d+)$/.exec(r.id))&&+n[1]<i.length)return su(e,i[+n[1]]),void t.preventDefault()})),this.list=this.dom.appendChild(this.createListBox(i,n.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfo)}))}mount(){this.updateSel()}update(e){e.state.field(this.stateField)!=e.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=cu(t.options.length,t.selected,this.view.state.facet(hu).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t.options,e.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfo)}))),this.updateSelectedOption(t.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:n}=t.options[t.selected],{info:i}=n;if(!i)return;let r="string"==typeof i?document.createTextNode(i):i(n);if(!r)return;"then"in r?r.then((t=>{t&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(t)})).catch((e=>$n(this.view.state,e,"completion info"))):this.addInfoPane(r)}}addInfoPane(e){let t=this.info=document.createElement("div");t.className="cm-tooltip cm-completionInfo",t.appendChild(e),this.dom.appendChild(t),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)i==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&function(e,t){let n=e.getBoundingClientRect(),i=t.getBoundingClientRect();i.top<n.top?e.scrollTop-=n.top-i.top:i.bottom>n.bottom&&(e.scrollTop+=i.bottom-n.bottom)}(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=e.getBoundingClientRect();if(i.top>Math.min(innerHeight,t.bottom)-10||i.bottom<Math.max(0,t.top)+10)return null;let r=Math.max(0,Math.min(i.top,innerHeight-n.height))-t.top,s=this.view.textDirection==Zn.RTL,o=t.left,a=innerWidth-t.right;return s&&o<Math.min(n.width,a)?s=!1:!s&&a<Math.min(n.width,o)&&(s=!0),{top:r,left:s}}positionInfo(e){this.info&&(this.info.style.top=(e?e.top:-1e6)+"px",e&&(this.info.classList.toggle("cm-completionInfo-left",e.left),this.info.classList.toggle("cm-completionInfo-right",!e.left)))}createListBox(e,t,n){let i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true");for(let r=n.from;r<n.to;r++){let{completion:n,match:s}=e[r],o=i.appendChild(document.createElement("li"));o.id=t+"-"+r,o.setAttribute("role","option");let a=this.optionClass(n);a&&(o.className=a);for(let e of this.optionContent){let t=e(n,this.view.state,s);t&&o.appendChild(t)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}}(t,e)}function du(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}var pu=class{constructor(e,t,n,i,r){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=i,this.selected=r}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new pu(this.options,gu(t,e),this.tooltip,this.timestamp,e)}static build(e,t,n,i,r){let s=function(e,t){let n=[],i=0;for(let r of e)if(r.hasResult())if(!1===r.result.filter)for(let e of r.result.options)n.push(new tu(e,r,[1e9-i++]));else{let e,i=new lu(t.sliceDoc(r.from,r.to));for(let t of r.result.options)(e=i.match(t.label))&&(null!=t.boost&&(e[0]+=t.boost),n.push(new tu(t,r,e)))}let r=[],s=null;for(let e of n.sort(yu))!s||s.label!=e.completion.label||s.detail!=e.completion.detail||null!=s.type&&null!=e.completion.type&&s.type!=e.completion.type||s.apply!=e.completion.apply?r.push(e):du(e.completion)>du(s)&&(r[r.length-1]=e),s=e.completion;return r}(e,t);if(!s.length)return null;let o=0;if(i&&i.selected){let e=i.options[i.selected].completion;for(let t=0;t<s.length;t++)if(s[t].completion==e){o=t;break}}return new pu(s,gu(n,o),{pos:e.reduce(((e,t)=>t.hasResult()?Math.min(e,t.from):e),1e8),create:uu(Cu),above:r.aboveCursor},i?i.timestamp:Date.now(),o)}map(e){return new pu(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}},fu=class{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new fu(Ou,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(e){let{state:t}=e,n=t.facet(hu),i=(n.override||t.languageDataAt("autocomplete",nu(t)).map(au)).map((t=>(this.active.find((e=>e.source==t))||new bu(t,this.active.some((e=>0!=e.state))?1:0)).update(e,n)));i.length==this.active.length&&i.every(((e,t)=>e==this.active[t]))&&(i=this.active);let r=e.selection||i.some((t=>t.hasResult()&&e.changes.touchesRange(t.from,t.to)))||!function(e,t){if(e==t)return!0;for(let n=0,i=0;;){for(;n<e.length&&!e[n].hasResult;)n++;for(;i<t.length&&!t[i].hasResult;)i++;let r=n==e.length,s=i==t.length;if(r||s)return r==s;if(e[n++].result!=t[i++].result)return!1}}(i,this.active)?pu.build(i,t,this.id,this.open,n):this.open&&e.docChanged?this.open.map(e.changes):this.open;!r&&i.every((e=>1!=e.state))&&i.some((e=>e.hasResult()))&&(i=i.map((e=>e.hasResult()?new bu(e.source,0):e)));for(let t of e.effects)t.is(Au)&&(r=r&&r.setSelected(t.value,this.id));return i==this.active&&r==this.open?this:new fu(i,this.id,r)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:mu}};var mu={"aria-autocomplete":"list"};function gu(e,t){return{"aria-autocomplete":"list","aria-haspopup":"listbox","aria-activedescendant":e+"-"+t,"aria-controls":e}}var Ou=[];function yu(e,t){return t.match[0]-e.match[0]||e.completion.label.localeCompare(t.completion.label)}function vu(e){return e.isUserEvent("input.type")?"input":e.isUserEvent("delete.backward")?"delete":null}var bu=class{constructor(e,t,n=-1){this.source=e,this.state=t,this.explicitPos=n}hasResult(){return!1}update(e,t){let n=vu(e),i=this;n?i=i.handleUserEvent(e,n,t):e.docChanged?i=i.handleChange(e):e.selection&&0!=i.state&&(i=new bu(i.source,0));for(let t of e.effects)if(t.is(xu))i=new bu(i.source,1,t.value?nu(e.state):-1);else if(t.is(Su))i=new bu(i.source,0);else if(t.is(ku))for(let e of t.value)e.source==i.source&&(i=e);return i}handleUserEvent(e,t,n){return"delete"!=t&&n.activateOnTyping?new bu(this.source,1):this.map(e.changes)}handleChange(e){return e.changes.touchesRange(nu(e.startState))?new bu(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new bu(this.source,this.state,e.mapPos(this.explicitPos))}},wu=class extends bu{constructor(e,t,n,i,r){super(e,2,t),this.result=n,this.from=i,this.to=r}hasResult(){return!0}handleUserEvent(e,t,n){var i;let r=e.changes.mapPos(this.from),s=e.changes.mapPos(this.to,1),o=nu(e.state);if((this.explicitPos<0?o<=r:o<this.from)||o>s||"delete"==t&&nu(e.startState)==this.from)return new bu(this.source,"input"==t&&n.activateOnTyping?1:0);let a,l=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return function(e,t,n,i){if(!e)return!1;let r=t.sliceDoc(n,i);return"function"==typeof e?e(r,n,i,t):iu(e,!0).test(r)}(this.result.validFor,e.state,r,s)?new wu(this.source,l,this.result,r,s):this.result.update&&(a=this.result.update(this.result,r,s,new Jc(e.state,o,l>=0)))?new wu(this.source,l,a,a.from,null!==(i=a.to)&&void 0!==i?i:nu(e.state)):new bu(this.source,1,l)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new bu(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new wu(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}};var xu=Oe.define(),Su=Oe.define(),ku=Oe.define({map:(e,t)=>e.map((e=>e.map(t)))}),Au=Oe.define(),Cu=W.define({create:()=>fu.start(),update:(e,t)=>e.update(t),provide:e=>[Cs.from(e,(e=>e.tooltip)),$r.contentAttributes.from(e,(e=>e.attrs))]});function _u(e,t="option"){return n=>{let i=n.state.field(Cu,!1);if(!i||!i.open||Date.now()-i.open.timestamp<75)return!1;let r,s=1;"page"==t&&(r=function(e,t){let n=e.plugin(Ss);if(!n)return null;let i=n.manager.tooltips.indexOf(t);return i<0?null:n.manager.tooltipViews[i]}(n,i.open.tooltip))&&(s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let o=i.open.selected+s*(e?1:-1),{length:a}=i.open.options;return o<0?o="page"==t?0:a-1:o>=a&&(o="page"==t?a-1:0),n.dispatch({effects:Au.of(o)}),!0}}var Eu=Rn.fromClass(class{constructor(e){this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let t of e.state.field(Cu).active)1==t.state&&this.startQuery(t)}update(e){let t=e.state.field(Cu);if(!e.selectionSet&&!e.docChanged&&e.startState.field(Cu)==t)return;let n=e.transactions.some((e=>(e.selection||e.docChanged)&&!vu(e)));for(let t=0;t<this.running.length;t++){let i=this.running[t];if(n||i.updates.length+e.transactions.length>50&&Date.now()-i.time>1e3){for(let e of i.context.abortListeners)try{e()}catch(e){$n(this.view.state,e)}i.context.abortListeners=null,this.running.splice(t--,1)}else i.updates.push(...e.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=t.active.some((e=>1==e.state&&!this.running.some((t=>t.active.source==e.source))))?setTimeout((()=>this.startUpdate()),50):-1,0!=this.composing)for(let t of e.transactions)"input"==vu(t)?this.composing=2:2==this.composing&&t.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:e}=this.view,t=e.field(Cu);for(let e of t.active)1==e.state&&!this.running.some((t=>t.active.source==e.source))&&this.startQuery(e)}startQuery(e){let{state:t}=this.view,n=nu(t),i=new Jc(t,n,e.explicitPos==n),r=new class{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}(e,i);this.running.push(r),Promise.resolve(e.source(i)).then((e=>{r.context.aborted||(r.done=e||null,this.scheduleAccept())}),(e=>{this.view.dispatch({effects:Su.of(null)}),$n(this.view.state,e)}))}scheduleAccept(){this.running.every((e=>void 0!==e.done))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((()=>this.accept()),50))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],n=this.view.state.facet(hu);for(let i=0;i<this.running.length;i++){let r=this.running[i];if(void 0===r.done)continue;if(this.running.splice(i--,1),r.done){let i=new wu(r.active.source,r.active.explicitPos,r.done,r.done.from,null!==(e=r.done.to)&&void 0!==e?e:nu(r.updates.length?r.updates[0].startState:this.view.state));for(let e of r.updates)i=i.update(e,n);if(i.hasResult()){t.push(i);continue}}let s=this.view.state.field(Cu).active.find((e=>e.source==r.active.source));if(s&&1==s.state)if(null==r.done){let e=new bu(r.active.source,0);for(let t of r.updates)e=e.update(t,n);1!=e.state&&t.push(e)}else this.startQuery(s)}t.length&&this.view.dispatch({effects:ku.of(t)})}},{eventHandlers:{compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout((()=>this.view.dispatch({effects:xu.of(!1)})),20),this.composing=0}}}),Tu=$r.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Pu=class{constructor(e,t,n,i){this.field=e,this.line=t,this.from=n,this.to=i}},$u=class{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,E.TrackDel),n=e.mapPos(this.to,1,E.TrackDel);return null==t||null==n?null:new $u(this.field,t,n)}},Nu=class{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],i=[t],r=e.doc.lineAt(t),s=/^\s*/.exec(r.text)[0];for(let r of this.lines){if(n.length){let n=s,o=/^\t*/.exec(r)[0].length;for(let t=0;t<o;t++)n+=e.facet(ka);i.push(t+n.length-o),r=n+r.slice(o)}n.push(r),t+=r.length+1}let o=this.fieldPositions.map((e=>new $u(e.field,i[e.line]+e.from,i[e.line]+e.to)));return{text:n,ranges:o}}static parse(e){let t,n=[],i=[],r=[];for(let s of e.split(/\r\n?|\n/)){for(;t=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(s);){let e=t[1]?+t[1]:null,o=t[2]||t[3]||"",a=-1;for(let t=0;t<n.length;t++)(null!=e?n[t].seq==e:o&&n[t].name==o)&&(a=t);if(a<0){let t=0;for(;t<n.length&&(null==e||null!=n[t].seq&&n[t].seq<e);)t++;n.splice(t,0,{seq:e,name:o}),a=t;for(let e of r)e.field>=a&&e.field++}r.push(new Pu(a,i.length,t.index,t.index+o.length)),s=s.slice(0,t.index)+o+s.slice(t.index+t[0].length)}i.push(s)}return new Nu(i,r)}},Iu=cn.widget({widget:new class extends ln{toDOM(){let e=document.createElement("span");return e.className="cm-snippetFieldPosition",e}ignoreEvent(){return!1}}}),Qu=cn.mark({class:"cm-snippetField"}),Ru=class{constructor(e,t){this.ranges=e,this.active=t,this.deco=cn.set(e.map((e=>(e.from==e.to?Iu:Qu).range(e.from,e.to))))}map(e){let t=[];for(let n of this.ranges){let i=n.map(e);if(!i)return null;t.push(i)}return new Ru(t,this.active)}selectionInsideField(e){return e.ranges.every((e=>this.ranges.some((t=>t.field==this.active&&t.from<=e.from&&t.to>=e.to))))}},Mu=Oe.define({map:(e,t)=>e&&e.map(t)}),Bu=Oe.define(),Du=W.define({create:()=>null,update(e,t){for(let n of t.effects){if(n.is(Mu))return n.value;if(n.is(Bu)&&e)return new Ru(e.ranges,n.value)}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.selectionInsideField(t.selection)&&(e=null),e},provide:e=>$r.decorations.from(e,(e=>e?e.deco:cn.none))});function Xu(e,t){return D.create(e.filter((e=>e.field==t)).map((e=>D.range(e.from,e.to))))}function Fu(e){return({state:t,dispatch:n})=>{let i=t.field(Du,!1);if(!i||e<0&&0==i.active)return!1;let r=i.active+e,s=e>0&&!i.ranges.some((t=>t.field==r+e));return n(t.update({selection:Xu(i.ranges,r),effects:Mu.of(s?null:new Ru(i.ranges,r))})),!0}}var Lu=[{key:"Tab",run:Fu(1),shift:Fu(-1)},{key:"Escape",run:({state:e,dispatch:t})=>!!e.field(Du,!1)&&(t(e.update({effects:Mu.of(null)})),!0)}],Uu=U.define({combine:e=>e.length?e[0]:Lu}),Vu=te.highest(Xr.compute([Uu],(e=>e.facet(Uu)))),zu=$r.domEventHandlers({mousedown(e,t){let n,i=t.state.field(Du,!1);if(!i||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;let r=i.ranges.find((e=>e.from<=n&&e.to>=n));return!(!r||r.field==i.active)&&(t.dispatch({selection:Xu(i.ranges,r.field),effects:Mu.of(i.ranges.some((e=>e.field>r.field))?new Ru(i.ranges,r.field):null)}),!0)}}),Zu={brackets:["(","[","{","'",'"'],before:")]}:;>"},ju=Oe.define({map:(e,t)=>t.mapPos(e,-1,E.TrackAfter)??void 0}),qu=Oe.define({map:(e,t)=>t.mapPos(e)}),Gu=new class extends $e{};Gu.startSide=1,Gu.endSide=-1;var Wu=W.define({create:()=>Re.empty,update(e,t){if(t.selection){let n=t.state.doc.lineAt(t.selection.main.head).from,i=t.startState.doc.lineAt(t.startState.selection.main.head).from;n!=t.changes.mapPos(i,-1)&&(e=Re.empty)}e=e.map(t.changes);for(let n of t.effects)n.is(ju)?e=e.update({add:[Gu.range(n.value,n.value+1)]}):n.is(qu)&&(e=e.update({filter:e=>e!=n.value}));return e}});var Hu="()[]{}<>";function Yu(e){for(let t=0;t<Hu.length;t+=2)if(Hu.charCodeAt(t)==e)return Hu.charAt(t+1);return A(e<128?e:e+1)}function Ju(e,t){return e.languageDataAt("closeBrackets",t)[0]||Zu}var Ku="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),ed=$r.inputHandler.of(((e,t,n,i)=>{if((Ku?e.composing:e.compositionStarted)||e.state.readOnly)return!1;let r=e.state.selection.main;if(i.length>2||2==i.length&&1==C(k(i,0))||t!=r.from||n!=r.to)return!1;let s=function(e,t){let n=Ju(e,e.selection.main.head),i=n.brackets||Zu.brackets;for(let r of i){let s=Yu(k(r,0));if(t==r)return s==r?od(e,r,i.indexOf(r+r+r)>-1):rd(e,r,s,n.before||Zu.before);if(t==s&&nd(e,e.selection.main.from))return sd(e,r,s)}return null}(e.state,i);return!!s&&(e.dispatch(s),!0)})),td=[{key:"Backspace",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=Ju(e,e.selection.main.head).brackets||Zu.brackets,i=null,r=e.changeByRange((t=>{if(t.empty){let i=function(e,t){let n=e.sliceString(t-2,t);return C(k(n,0))==n.length?n:n.slice(1)}(e.doc,t.head);for(let r of n)if(r==i&&id(e.doc,t.head)==Yu(k(r,0)))return{changes:{from:t.head-r.length,to:t.head+r.length},range:D.cursor(t.head-r.length),userEvent:"delete.backward"}}return{range:i=t}}));return i||t(e.update(r,{scrollIntoView:!0})),!i}}];function nd(e,t){let n=!1;return e.field(Wu).between(0,e.doc.length,(e=>{e==t&&(n=!0)})),n}function id(e,t){let n=e.sliceString(t,t+2);return n.slice(0,C(k(n,0)))}function rd(e,t,n,i){let r=null,s=e.changeByRange((s=>{if(!s.empty)return{changes:[{insert:t,from:s.from},{insert:n,from:s.to}],effects:ju.of(s.to+t.length),range:D.range(s.anchor+t.length,s.head+t.length)};let o=id(e.doc,s.head);return!o||/\s/.test(o)||i.indexOf(o)>-1?{changes:{insert:t+n,from:s.head},effects:ju.of(s.head+t.length),range:D.cursor(s.head+t.length)}:{range:r=s}}));return r?null:e.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function sd(e,t,n){let i=null,r=e.selection.ranges.map((t=>t.empty&&id(e.doc,t.head)==n?D.cursor(t.head+n.length):i=t));return i?null:e.update({selection:D.create(r,e.selection.mainIndex),scrollIntoView:!0,effects:e.selection.ranges.map((({from:e})=>qu.of(e)))})}function od(e,t,n){let i=null,r=e.changeByRange((r=>{if(!r.empty)return{changes:[{insert:t,from:r.from},{insert:t,from:r.to}],effects:ju.of(r.to+t.length),range:D.range(r.anchor+t.length,r.head+t.length)};let s=r.head,o=id(e.doc,s);if(o==t){if(ad(e,s))return{changes:{insert:t+t,from:s},effects:ju.of(s+t.length),range:D.cursor(s+t.length)};if(nd(e,s)){let i=n&&e.sliceDoc(s,s+3*t.length)==t+t+t;return{range:D.cursor(s+t.length*(i?3:1)),effects:qu.of(s)}}}else{if(n&&e.sliceDoc(s-2*t.length,s)==t+t&&ad(e,s-2*t.length))return{changes:{insert:t+t+t+t,from:s},effects:ju.of(s+t.length),range:D.cursor(s+t.length)};if(e.charCategorizer(s)(o)!=Ce.Word){let n=e.sliceDoc(s-1,s);if(n!=t&&e.charCategorizer(s)(n)!=Ce.Word&&!function(e,t,n){let i=pa(e).resolveInner(t,-1);for(let r=0;r<5;r++){if(e.sliceDoc(i.from,i.from+n.length)==n)return!0;let r=i.to==t&&i.parent;if(!r)break;i=r}return!1}(e,s,t))return{changes:{insert:t+t,from:s},effects:ju.of(s+t.length),range:D.cursor(s+t.length)}}}return{range:i=r}}));return i?null:e.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function ad(e,t){let n=pa(e).resolveInner(t+1);return n.parent&&n.from==t}var ld=[{key:"Ctrl-Space",run:e=>!!e.state.field(Cu,!1)&&(e.dispatch({effects:xu.of(!0)}),!0)},{key:"Escape",run:e=>{let t=e.state.field(Cu,!1);return!(!t||!t.active.some((e=>0!=e.state)))&&(e.dispatch({effects:Su.of(null)}),!0)}},{key:"ArrowDown",run:_u(!0)},{key:"ArrowUp",run:_u(!1)},{key:"PageDown",run:_u(!0,"page")},{key:"PageUp",run:_u(!1,"page")},{key:"Enter",run:e=>{let t=e.state.field(Cu,!1);return!(e.state.readOnly||!t||!t.open||Date.now()-t.open.timestamp<75)&&(su(e,t.open.options[t.open.selected]),!0)}}],hd=te.highest(Xr.computeN([hu],(e=>e.facet(hu).defaultKeymap?[ld]:[]))),cd=class{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let i=e,r=n.facet(kd).markerFilter;r&&(i=r(i));let s=cn.set(i.map((e=>e.from==e.to||e.from==e.to-1&&n.doc.lineAt(e.from).to==e.from?cn.widget({widget:new Ed(e),diagnostic:e}).range(e.from):cn.mark({attributes:{class:"cm-lintRange cm-lintRange-"+e.severity},diagnostic:e}).range(e.from,e.to))),!0);return new cd(s,t,ud(s))}};function ud(e,t=null,n=0){let i=null;return e.between(n,1e9,((e,n,{spec:r})=>{if(!t||r.diagnostic==t)return i=new class{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}(e,n,r.diagnostic),!1})),i}function dd(e,t){return!(!e.effects.some((e=>e.is(fd)))&&!e.changes.touchesRange(t.pos))}function pd(e,t){return e.field(Od,!1)?t:t.concat(Oe.appendConfig.of([Od,$r.decorations.compute([Od],(e=>{let{selected:t,panel:n}=e.field(Od);return t&&n&&t.from!=t.to?cn.set([yd.range(t.from,t.to)]):cn.none})),Ps(vd,{hideOn:dd}),Id]))}var fd=Oe.define(),md=Oe.define(),gd=Oe.define(),Od=W.define({create:()=>new cd(cn.none,null,null),update(e,t){if(t.docChanged){let n=e.diagnostics.map(t.changes),i=null;if(e.selected){let r=t.changes.mapPos(e.selected.from,1);i=ud(n,e.selected.diagnostic,r)||ud(n,null,r)}e=new cd(n,e.panel,i)}for(let n of t.effects)n.is(fd)?e=cd.init(n.value,e.panel,t.state):n.is(md)?e=new cd(e.diagnostics,n.value?Pd.open:null,e.selected):n.is(gd)&&(e=new cd(e.diagnostics,e.panel,n.value));return e},provide:e=>[Bs.from(e,(e=>e.panel)),$r.decorations.from(e,(e=>e.diagnostics))]}),yd=cn.mark({class:"cm-lintRange cm-lintRange-active"});function vd(e,t,n){let{diagnostics:i}=e.state.field(Od),r=[],s=2e8,o=0;i.between(t-(n<0?1:0),t+(n>0?1:0),((e,i,{spec:a})=>{t>=e&&t<=i&&(e==i||(t>e||n>0)&&(t<i||n<0))&&(r.push(a.diagnostic),s=Math.min(e,s),o=Math.max(i,o))}));let a=e.state.facet(kd).tooltipFilter;return a&&(r=a(r)),r.length?{pos:s,end:o,above:e.state.doc.lineAt(s).to<o,create:()=>({dom:bd(e,r)})}:null}function bd(e,t){return ec("ul",{class:"cm-tooltip-lint"},t.map((t=>_d(e,t,!1))))}var wd=e=>{let t=e.state.field(Od,!1);return!(!t||!t.panel)&&(e.dispatch({effects:md.of(!1)}),!0)},xd=[{key:"Mod-Shift-m",run:e=>{let t=e.state.field(Od,!1);(!t||!t.panel)&&e.dispatch({effects:pd(e.state,[md.of(!0)])});let n=Is(e,Pd.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0}},{key:"F8",run:e=>{let t=e.state.field(Od,!1);if(!t)return!1;let n=e.state.selection.main,i=t.diagnostics.iter(n.to+1);return!(!i.value&&(i=t.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to))&&(e.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)}}],Sd=Rn.fromClass(class{constructor(e){this.view=e,this.timeout=-1,this.set=!0;let{delay:t}=e.state.facet(kd);this.lintTime=Date.now()+t,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,t)}run(){let e=Date.now();if(e<this.lintTime-10)setTimeout(this.run,this.lintTime-e);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(kd);Promise.all(t.map((e=>Promise.resolve(e(this.view))))).then((t=>{let n=t.reduce(((e,t)=>e.concat(t)));this.view.state.doc==e.doc&&this.view.dispatch(function(e,t){return{effects:pd(e,[fd.of(t)])}}(this.view.state,n))}),(e=>{$n(this.view.state,e)}))}}update(e){let t=e.state.facet(kd);(e.docChanged||t!=e.startState.facet(kd))&&(this.lintTime=Date.now()+t.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,t.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),kd=U.define({combine:e=>Object.assign({sources:e.map((e=>e.source))},Pe(e.map((e=>e.config)),{delay:750,markerFilter:null,tooltipFilter:null})),enables:Sd});function Ad(e,t={}){return kd.of({source:e,config:t})}function Cd(e){let t=[];if(e)e:for(let{name:n}of e){for(let e=0;e<n.length;e++){let i=n[e];if(/[a-zA-Z]/.test(i)&&!t.some((e=>e.toLowerCase()==i.toLowerCase()))){t.push(i);continue e}}t.push("")}return t}function _d(e,t,n){var i;let r=n?Cd(t.actions):[];return ec("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},ec("span",{class:"cm-diagnosticText"},t.message),null===(i=t.actions)||void 0===i?void 0:i.map(((n,i)=>{let s=i=>{i.preventDefault();let r=ud(e.state.field(Od).diagnostics,t);r&&n.apply(e,r.from,r.to)},{name:o}=n,a=r[i]?o.indexOf(r[i]):-1,l=a<0?o:[o.slice(0,a),ec("u",o.slice(a,a+1)),o.slice(a+1)];return ec("button",{type:"button",class:"cm-diagnosticAction",onclick:s,onmousedown:s,"aria-label":` Action: ${o}${a<0?"":` (access key "${r[i]})"`}.`},l)})),t.source&&ec("div",{class:"cm-diagnosticSource"},t.source))}var Ed=class extends ln{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return ec("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}},Td=class{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=_d(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}},Pd=class{constructor(e){this.view=e,this.items=[];this.list=ec("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t=>{if(27==t.keyCode)wd(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65&&t.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:n}=this.items[this.selectedIndex],i=Cd(n.actions);for(let r=0;r<i.length;r++)if(i[r].toUpperCase().charCodeAt(0)==t.keyCode){let t=ud(this.view.state.field(Od).diagnostics,n);t&&n.actions[r].apply(e,t.from,t.to)}}}t.preventDefault()},onclick:e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)}}),this.dom=ec("div",{class:"cm-panel-lint"},this.list,ec("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>wd(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(Od).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Od),n=0,i=!1,r=null;for(e.between(0,this.view.state.doc.length,((e,s,{spec:o})=>{let a,l=-1;for(let e=n;e<this.items.length;e++)if(this.items[e].diagnostic==o.diagnostic){l=e;break}l<0?(a=new Td(this.view,o.diagnostic),this.items.splice(n,0,a),i=!0):(a=this.items[l],l>n&&(this.items.splice(n,l-n),i=!0)),t&&a.diagnostic==t.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),r=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),n++}));n<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();0==this.items.length&&(this.items.push(new Td(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{e.top<t.top?this.list.scrollTop-=t.top-e.top:e.bottom>t.bottom&&(this.list.scrollTop+=e.bottom-t.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=ud(this.view.state.field(Od).diagnostics,this.items[e].diagnostic);!t||this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:gd.of(t)})}static open(e){return new Pd(e)}};function $d(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}function Nd(e){return $d(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}var Id=$r.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Nd("#d11")},".cm-lintRange-warning":{backgroundImage:Nd("orange")},".cm-lintRange-info":{backgroundImage:Nd("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Qd=class extends Ds{constructor(e){super(),this.diagnostics=e,this.severity=e.reduce(((e,t)=>{let n=t.severity;return"error"==n||"warning"==n&&"info"==e?n:e}),"info")}toDOM(e){let t=document.createElement("div");t.className="cm-lint-marker cm-lint-marker-"+this.severity;let n=this.diagnostics,i=e.state.facet(Ld).tooltipFilter;return i&&(n=i(n)),n.length&&(t.onmouseover=()=>function(e,t,n){function i(){let i=e.elementAtHeight(t.getBoundingClientRect().top+5-e.documentTop);e.coordsAtPos(i.from)&&e.dispatch({effects:Dd.of({pos:i.from,above:!1,create:()=>({dom:bd(e,n),getCoords:()=>t.getBoundingClientRect()})})}),t.onmouseout=t.onmousemove=null,function(e,t){let n=i=>{let r=t.getBoundingClientRect();if(!(i.clientX>r.left-10&&i.clientX<r.right+10&&i.clientY>r.top-10&&i.clientY<r.bottom+10)){for(let e=i.target;e;e=e.parentNode)if(1==e.nodeType&&e.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",n),e.state.field(Xd)&&e.dispatch({effects:Dd.of(null)})}};window.addEventListener("mousemove",n)}(e,t)}let{hoverTime:r}=e.state.facet(Ld),s=setTimeout(i,r);t.onmouseout=()=>{clearTimeout(s),t.onmouseout=t.onmousemove=null},t.onmousemove=()=>{clearTimeout(s),s=setTimeout(i,r)}}(e,t,n)),t}};function Rd(e,t){let n=Object.create(null);for(let i of t){let t=e.lineAt(i.from);(n[t.from]||(n[t.from]=[])).push(i)}let i=[];for(let e in n)i.push(new Qd(n[e]).range(+e));return Re.of(i,!0)}var Md=Us({class:"cm-gutter-lint",markers:e=>e.state.field(Bd)}),Bd=W.define({create:()=>Re.empty,update(e,t){e=e.map(t.changes);let n=t.state.facet(Ld).markerFilter;for(let i of t.effects)if(i.is(fd)){let r=i.value;n&&(r=n(r||[])),e=Rd(t.state.doc,r.slice(0))}return e}}),Dd=Oe.define(),Xd=W.define({create:()=>null,update:(e,t)=>(e&&t.docChanged&&(e=dd(t,e)?null:Object.assign(Object.assign({},e),{pos:t.changes.mapPos(e.pos)})),t.effects.reduce(((e,t)=>t.is(Dd)?t.value:e),e)),provide:e=>Cs.from(e)}),Fd=$r.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:$d('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:$d('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error:before":{content:$d('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),Ld=U.define({combine:e=>Pe(e,{hoverTime:300,markerFilter:null,tooltipFilter:null})});function Ud(e={}){return[Ld.of(e),Bd,Md,Fd,Xd]}var Vd,zd=[function(e={}){return[Js.of(e),zs(),to]}(),ro,function(e={}){return[ls.of(e),hs||(hs=Rn.fromClass(class{constructor(e){this.view=e,this.decorations=cn.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(ls)),this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new class{constructor(e){let{regexp:t,decoration:n,boundary:i,maxLength:r=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=t,this.getDeco="function"==typeof n?n:()=>n,this.boundary=i,this.maxLength=r}createDeco(e){let t=new Me;for(let{from:n,to:i}of function(e,t){let n=e.visibleRanges;if(1==n.length&&n[0].from==e.viewport.from&&n[0].to==e.viewport.to)return n;let i=[];for(let{from:r,to:s}of n)r=Math.max(e.state.doc.lineAt(r).from,r-t),s=Math.min(e.state.doc.lineAt(s).to,s+t),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}(e,this.maxLength))is(e.state.doc,this.regexp,n,i,((n,i,r)=>t.add(n,i,this.getDeco(r,e,n))));return t.finish()}updateDeco(e,t){let n=1e9,i=-1;return e.docChanged&&e.changes.iterChanges(((t,r,s,o)=>{o>e.view.viewport.from&&s<e.view.viewport.to&&(n=Math.min(s,n),i=Math.max(o,i))})),e.viewportChanged||i-n>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),n,i):t}updateRange(e,t,n,i){for(let r of e.visibleRanges){let s=Math.max(r.from,n),o=Math.min(r.to,i);if(o>s){let n=e.state.doc.lineAt(s),i=n.to<o?e.state.doc.lineAt(o):n,a=Math.max(r.from,n.from),l=Math.min(r.to,i.to);if(this.boundary){for(;s>n.from;s--)if(this.boundary.test(n.text[s-1-n.from])){a=s;break}for(;o<i.to;o++)if(this.boundary.test(i.text[o-i.from])){l=o;break}}let h,c=[];if(n==i)for(this.regexp.lastIndex=a-n.from;(h=this.regexp.exec(n.text))&&h.index<l-n.from;){let t=h.index+n.from;c.push(this.getDeco(h,e,t).range(t,t+h[0].length))}else is(e.state.doc,this.regexp,a,l,((t,n,i)=>c.push(this.getDeco(i,e,t).range(t,n))));t=t.update({filterFrom:a,filterTo:l,filter:(e,t)=>e<a||t>l,add:c})}}return t}}({regexp:e.specialChars,decoration:(t,n,i)=>{let{doc:r}=n.state,s=k(t[0],0);if(9==s){let e=r.lineAt(i),t=n.state.tabSize,s=qe(e.text,t,i-e.from);return cn.replace({widget:new us((t-s%t)*this.view.defaultCharacterWidth)})}return this.decorationCache[s]||(this.decorationCache[s]=cn.replace({widget:new cs(e,s)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(ls);e.startState.facet(ls)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))]}(),function(e={}){return[Il,Nl.of(e),$r.domEventHandlers({beforeinput(e,t){let n="historyUndo"==e.inputType?Rl:"historyRedo"==e.inputType?Ml:null;return!!n&&(e.preventDefault(),n(t))}})]}(),function(e={}){let t=Object.assign(Object.assign({},Ka),e),n=new el(t,!0),i=new el(t,!1),r=Rn.fromClass(class{constructor(e){this.from=e.viewport.from,this.markers=this.buildMarkers(e)}update(e){(e.docChanged||e.viewportChanged||e.startState.facet(wa)!=e.state.facet(wa)||e.startState.field(Va,!1)!=e.state.field(Va,!1)||pa(e.startState)!=pa(e.state))&&(this.markers=this.buildMarkers(e.view))}buildMarkers(e){let t=new Me;for(let r of e.viewportLineBlocks){let s=za(e.state,r.from,r.to)?i:Da(e.state,r.from,r.to)?n:null;s&&t.add(r.from,r.from,s)}return t.finish()}}),{domEventHandlers:s}=t;return[r,Us({class:"cm-foldGutter",markers(e){var t;return(null===(t=e.plugin(r))||void 0===t?void 0:t.markers)||Re.empty},initialSpacer:()=>new el(t,!1),domEventHandlers:Object.assign(Object.assign({},s),{click:(e,t,n)=>{if(s.click&&s.click(e,t,n))return!0;let i=za(e.state,t.from,t.to);if(i)return e.dispatch({effects:La.of(i)}),!0;let r=Da(e.state,t.from,t.to);return!!r&&(e.dispatch({effects:Fa.of(r)}),!0)}})}),Ya()]}(),function(e={}){return[Zr.of(e),qr,Wr]}(),[ts,ns],Te.allowMultipleSelections.of(!0),Te.transactionFilter.of((e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let n=e.newDoc,{head:i}=e.newSelection.main,r=n.lineAt(i);if(i>r.from+200)return e;let s=n.sliceString(r.from,i);if(!t.some((e=>e.test(s))))return e;let{state:o}=e,a=-1,l=[];for(let{head:e}of o.selection.ranges){let t=o.doc.lineAt(e);if(t.from==a)continue;a=t.from;let n=_a(o,t.from);if(null==n)continue;let i=/^\s*/.exec(t.text)[0],r=Ca(o,n);i!=r&&l.push({from:t.from,to:t.from+i.length,insert:r})}return l.length?[e,{changes:l,sequential:!0}]:e})),function(e,t){let n,i=[ol];return e instanceof nl&&(e.module&&i.push($r.styleModule.of(e.module)),n=e.themeType),t?.fallback?i.push(rl.of(e)):n?i.push(il.computeN([$r.darkTheme],(t=>t.facet($r.darkTheme)==("dark"==n)?[e]:[]))):i.push(il.of(e)),i}(al,{fallback:!0}),function(e={}){return[cl.of(e),ml]}(),[ed,Wu],function(e={}){return[Cu,hu.of(e),Eu,hd,Tu]}(),function(e){let t=e?.eventFilter||(e=>e.altKey&&0==e.button);return $r.mouseSelectionStyle.of(((e,n)=>t(n)?gs(e,n):null))}(),function(e={}){let[t,n]=Os[e.key||"Alt"],i=Rn.fromClass(class{constructor(e){this.view=e,this.isDown=!1}set(e){this.isDown!=e&&(this.isDown=e,this.view.update([]))}},{eventHandlers:{keydown(e){this.set(e.keyCode==t||n(e))},keyup(e){(e.keyCode==t||!n(e))&&this.set(!1)}}});return[i,$r.contentAttributes.of((e=>{var t;return null!==(t=e.plugin(i))&&void 0!==t&&t.isDown?ys:null}))]}(),ps,function(e){let t=[bc,vc];return e&&t.push(mc.of(e)),t}(),Xr.of([...td,...Jh,...Zc,...Wl,...Ga,...ld,...xd])],Zd=class{constructor(e,t,n,i,r,s,o,a,l,h=0,c){this.p=e,this.stack=t,this.state=n,this.reducePos=i,this.pos=r,this.score=s,this.buffer=o,this.bufferBase=a,this.curContext=l,this.lookAhead=h,this.parent=c}toString(){return`[${this.stack.filter(((e,t)=>t%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let i=e.parser.context;return new Zd(e,[],t,n,n,0,[],0,i?new jd(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){let t=e>>19,n=65535&e,{parser:i}=this.p,r=i.dynamicPrecedence(n);if(r&&(this.score+=r),0==t)return this.pushState(i.getGoto(this.state,n,!0),this.reducePos),n<i.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,4,!0),void this.reduceContext(n,this.reducePos);let s=this.stack.length-3*(t-1)-(262144&e?6:0),o=this.stack[s-2],a=this.stack[s-1],l=this.bufferBase+this.buffer.length-a;if(n<i.minRepeatTerm||131072&e){let e=i.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,o,e,l+4,!0)}if(262144&e)this.state=this.stack[s];else{let e=this.stack[s-3];this.state=i.getGoto(e,n,!0)}for(;this.stack.length>s;)this.stack.pop();this.reduceContext(n,o)}storeNode(e,t,n,i=4,r=!1){if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let e=this,i=this.buffer.length;if(0==i&&e.parent&&(i=e.bufferBase-e.parent.bufferBase,e=e.parent),i>0&&0==e.buffer[i-4]&&e.buffer[i-1]>-1){if(t==n)return;if(e.buffer[i-2]>=t)return void(e.buffer[i-2]=n)}}if(r&&this.pos!=n){let r=this.buffer.length;if(r>0&&0!=this.buffer[r-4])for(;r>0&&this.buffer[r-2]>n;)this.buffer[r]=this.buffer[r-4],this.buffer[r+1]=this.buffer[r-3],this.buffer[r+2]=this.buffer[r-2],this.buffer[r+3]=this.buffer[r-1],r-=4,i>4&&(i-=4);this.buffer[r]=e,this.buffer[r+1]=t,this.buffer[r+2]=n,this.buffer[r+3]=i}else this.buffer.push(e,t,n,i)}shift(e,t,n){let i=this.pos;if(131072&e)this.pushState(65535&e,this.pos);else if(0==(262144&e)){let r=e,{parser:s}=this.p;(n>this.pos||t<=s.maxNode)&&(this.pos=n,s.stateFlag(r,1)||(this.reducePos=n)),this.pushState(r,i),this.shiftContext(t,i),t<=s.maxNode&&this.buffer.push(t,i,n,4)}else this.pos=n,this.shiftContext(t,i),t<=this.p.parser.maxNode&&this.buffer.push(t,i,n,4)}apply(e,t,n){65536&e?this.reduce(e):this.shift(e,t,n)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(t,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),i=e.bufferBase+t;for(;e&&i==e.bufferBase;)e=e.parent;return new Zd(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new qd(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==(65536&n))return!0;if(0==n)return!1;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let n=[];for(let i,r=0;r<t.length;r+=2)(i=t[r+1])!=this.state&&this.p.parser.hasAction(i,e)&&n.push(t[r],i);if(this.stack.length<120)for(let e=0;n.length<8&&e<t.length;e+=2){let i=t[e+1];n.some(((e,t)=>1&t&&e==i))||n.push(t[e],i)}t=n}let n=[];for(let e=0;e<t.length&&n.length<4;e+=2){let i=t[e+1];if(i==this.state)continue;let r=this.split();r.pushState(i,this.pos),r.storeNode(0,r.pos,r.pos,4,!0),r.shiftContext(t[e],this.pos),r.score-=200,n.push(r)}return n}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if(0==(65536&e))return!1;let{parser:t}=this.p;if(!t.validAction(this.state,e)){let n=e>>19,i=65535&e,r=this.stack.length-3*n;if(r<0||t.getGoto(this.stack[r],i,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new jd(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}},jd=class{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}};!function(e){e[e.Insert=200]="Insert",e[e.Delete=190]="Delete",e[e.Reduce=100]="Reduce",e[e.MaxNext=4]="MaxNext",e[e.MaxInsertStackDepth=300]="MaxInsertStackDepth",e[e.DampenInsertStackDepth=120]="DampenInsertStackDepth"}(Vd||(Vd={}));var qd=class{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=65535&e,n=e>>19;0==n?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(n-1);let i=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=i}},Gd=class{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Gd(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new Gd(this.stack,this.pos,this.index)}},Wd=class{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}},Hd=new Wd,Yd=class{constructor(e,t){this.data=e,this.id=t}token(e,t){!function(e,t,n,i){let r=0,s=1<<i,{parser:o}=n.p,{dialect:a}=o;e:for(;0!=(s&e[r]);){let n=e[r+1];for(let i=r+3;i<n;i+=2)if((e[i+1]&s)>0){let n=e[i];if(a.allows(n)&&(-1==t.token.value||t.token.value==n||o.overrides(n,t.token.value))){t.acceptToken(n);break}}for(let i=t.next,s=0,o=e[r+2];s<o;){let a=s+o>>1,l=n+a+(a<<1),h=e[l],c=e[l+1];if(i<h)o=a;else{if(!(i>=c)){r=e[l+2],t.advance();continue e}s=a+1}}break}}(this.data,e,t,this.id)}};Yd.prototype.contextual=Yd.prototype.fallback=Yd.prototype.extend=!1;var Jd=class{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}};function Kd(e,t=Uint16Array){if("string"!=typeof e)return e;let n=null;for(let i=0,r=0;i<e.length;){let s=0;for(;;){let t=e.charCodeAt(i++),n=!1;if(126==t){s=65535;break}t>=92&&t--,t>=34&&t--;let r=t-32;if(r>=46&&(r-=46,n=!0),s+=r,n)break;s*=46}n?n[r++]=s:n=new t(s)}return n}var ep,tp=typeof process<"u"&&/\bparse\b/.test(process.env.LOG),np=null;function ip(e,t,n){let i=e.cursor(co.IncludeAnonymous);for(i.moveTo(t);;)if(!(n<0?i.childBefore(t):i.childAfter(t)))for(;;){if((n<0?i.to<t:i.from>t)&&!i.type.isError)return n<0?Math.max(0,Math.min(i.to-1,t-25)):Math.min(e.length,Math.max(i.from+1,t+25));if(n<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return n<0?0:e.length}}!function(e){e[e.Margin=25]="Margin"}(ep||(ep={}));var rp;!function(e){e[e.Distance=5]="Distance",e[e.MaxRemainingPerStep=3]="MaxRemainingPerStep",e[e.MinBufferLengthPrune=500]="MinBufferLengthPrune",e[e.ForceReduceLimit=10]="ForceReduceLimit",e[e.CutDepth=15e3]="CutDepth",e[e.CutTo=9e3]="CutTo"}(rp||(rp={}));function sp(e,t){for(let n=0;n<t.length;n++){let i=t[n];if(i.pos==e.pos&&i.sameState(e))return void(t[n].score<e.score&&(t[n]=e))}t.push(e)}var op=e=>e,ap=class extends No{constructor(e){if(super(),this.wrappers=[],14!=e.version)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let n=0;n<e.repeatNodeCount;n++)t.push("");let n=Object.keys(e.topRules).map((t=>e.topRules[t][1])),i=[];for(let e=0;e<t.length;e++)i.push([]);function r(e,t,n){i[e].push([t,t.deserialize(String(n))])}if(e.nodeProps)for(let t of e.nodeProps){let e=t[0];"string"==typeof e&&(e=ao[e]);for(let n=1;n<t.length;){let i=t[n++];if(i>=0)r(i,e,t[n++]);else{let s=t[n+-i];for(let o=-i;o>0;o--)r(t[n++],e,s);n++}}}this.nodeSet=new uo(t.map(((t,r)=>ho.define({name:r>=this.minRepeatTerm?void 0:t,id:r,props:i[r],top:n.indexOf(r)>-1,error:0==r,skipped:e.skippedNodes&&e.skippedNodes.indexOf(r)>-1})))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=1024;let s=Kd(e.tokenData);if(this.context=e.context,this.specialized=new Uint16Array(e.specialized?e.specialized.length:0),this.specializers=[],e.specialized)for(let t=0;t<e.specialized.length;t++)this.specialized[t]=e.specialized[t].term,this.specializers[t]=e.specialized[t].get;this.states=Kd(e.states,Uint32Array),this.data=Kd(e.stateData),this.goto=Kd(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((e=>"number"==typeof e?new Yd(s,e):e)),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let i=new class{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new class{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Hd,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,i=this.rangeIndex,r=this.pos+e;for(;r<n.from;){if(!i)return null;let e=this.ranges[--i];r-=n.from-e.to,n=e}for(;t<0?r>n.to:r>=n.to;){if(i==this.ranges.length-1)return null;let e=this.ranges[++i];r+=e.from-n.to,n=e}return r}peek(e){let t,n,i=this.chunkOff+e;if(i>=0&&i<this.chunk.length)t=this.pos+e,n=this.chunk.charCodeAt(i);else{let i=this.resolveOffset(e,1);if(null==i)return-1;if(t=i,t>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(t-this.chunk2Pos);else{let e=this.rangeIndex,i=this.range;for(;i.to<=t;)i=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>i.to&&(this.chunk2=this.chunk2.slice(0,i.to-t)),n=this.chunk2.charCodeAt(0)}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),n}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(null==n||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=Hd,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let i of this.ranges){if(i.from>=t)break;i.to>e&&(n+=this.input.read(Math.max(i.from,e),Math.min(i.to,t)))}return n}}(t,i),this.tokens=new class{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map((e=>new Wd))}getActions(e){let t=0,n=null,{parser:i}=e.p,{tokenizers:r}=i,s=i.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,a=0;for(let i=0;i<r.length;i++){if(0==(1<<i&s))continue;let l=r[i],h=this.tokens[i];if((!n||l.fallback)&&((l.contextual||h.start!=e.pos||h.mask!=s||h.context!=o)&&(this.updateCachedToken(h,l,e),h.mask=s,h.context=o),h.lookAhead>h.end+25&&(a=Math.max(h.lookAhead,a)),0!=h.value)){let i=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!l.extend&&(n=h,t>i))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),!n&&e.pos==this.stream.end&&(n=new Wd,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Wd,{pos:n,p:i}=e;return t.start=n,t.end=Math.min(n+1,i.stream.end),t.value=n==i.stream.end?i.parser.eofTerm:0,t}updateCachedToken(e,t,n){if(t.token(this.stream.reset(n.pos,e),n),e.value>-1){let{parser:t}=n.p;for(let i=0;i<t.specialized.length;i++)if(t.specialized[i]==e.value){let r=t.specializers[i](this.stream.read(e.start,e.end),n);if(r>=0&&n.p.parser.dialect.allows(r>>1)){0==(1&r)?e.value=r>>1:e.extended=r>>1;break}}}else e.value=0,e.end=Math.min(n.p.stream.end,n.pos+1)}putAction(e,t,n,i){for(let t=0;t<i;t+=3)if(this.actions[t]==e)return i;return this.actions[i++]=e,this.actions[i++]=t,this.actions[i++]=n,i}addActions(e,t,n,i){let{state:r}=e,{parser:s}=e.p,{data:o}=s;for(let e=0;e<2;e++)for(let a=s.stateSlot(r,e?2:1);;a+=3){if(65535==o[a]){if(1!=o[a+1]){0==i&&2==o[a+1]&&(i=this.putAction(lp(o,a+2),t,n,i));break}a=lp(o,a+2)}o[a]==t&&(i=this.putAction(lp(o,a+1),t,n,i))}return i}}(e,this.stream),this.topTerm=e.top[1];let{from:r}=i[0];this.stacks=[Zd.start(this,e.top[0],r)],this.fragments=n.length&&this.stream.end-r>4*e.bufferLength?new class{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?ip(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?ip(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],i=this.index[t];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=n.children[i],s=this.start[t]+n.positions[i];if(s>e)return this.nextStart=s,null;if(r instanceof mo){if(s==e){if(s<this.safeFrom)return null;let e=s+r.length;if(e<=this.safeTo){let t=r.prop(ao.lookAhead);if(!t||e+t<this.fragment.to)return r}}this.index[t]++,s+r.length>=Math.max(this.safeFrom,e)&&(this.trees.push(r),this.start.push(s),this.index.push(0))}else this.index[t]++,this.nextStart=s+r.length}}}(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e,t,n=this.stacks,i=this.minStackPos,r=this.stacks=[];for(let s=0;s<n.length;s++){let o=n[s];for(;;){if(this.tokens.mainToken=null,o.pos>i)r.push(o);else{if(this.advanceStack(o,r,n))continue;{e||(e=[],t=[]),e.push(o);let n=this.tokens.getMainToken(o);t.push(n.value,n.end)}}break}}if(!r.length){let t=e&&function(e){let t=null;for(let n of e){let e=n.p.stoppedAt;(n.pos==n.p.stream.end||null!=e&&n.pos>e)&&n.p.parser.stateFlag(n.state,2)&&(!t||t.score<n.score)&&(t=n)}return t}(e);if(t)return this.stackToTree(t);if(this.parser.strict)throw new SyntaxError("No parse at "+i);this.recovering||(this.recovering=5)}if(this.recovering&&e){let n=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,r);if(n)return this.stackToTree(n.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(r.length>e)for(r.sort(((e,t)=>t.score-e.score));r.length>e;)r.pop();r.some((e=>e.reducePos>i))&&this.recovering--}else if(r.length>1)e:for(let e=0;e<r.length-1;e++){let t=r[e];for(let n=e+1;n<r.length;n++){let i=r[n];if(t.sameState(i)||t.buffer.length>500&&i.buffer.length>500){if(!((t.score-i.score||t.buffer.length-i.buffer.length)>0)){r.splice(e--,1);continue e}r.splice(n--,1)}}}this.minStackPos=r[0].pos;for(let e=1;e<r.length;e++)r[e].pos<this.minStackPos&&(this.minStackPos=r[e].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let i=e.pos,{parser:r}=this;if(tp&&this.stackID(e),null!=this.stoppedAt&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,n=t?e.curContext.hash:0;for(let s=this.fragments.nodeAt(i);s;){let i=this.parser.nodeSet.types[s.type.id]==s.type?r.getGoto(e.state,s.type.id):-1;if(i>-1&&s.length&&(!t||(s.prop(ao.contextHash)||0)==n))return e.useNode(s,i),!0;if(!(s instanceof mo)||0==s.children.length||s.positions[0]>0)break;let o=s.children[0];if(!(o instanceof mo&&0==s.positions[0]))break;s=o}}let s=r.stateSlot(e.state,4);if(s>0)return e.reduce(s),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let o=this.tokens.getActions(e);for(let r=0;r<o.length;){let s=o[r++],a=o[r++],l=o[r++],h=r==o.length||!n,c=h?e:e.split();if(c.apply(s,a,l),h)return!0;c.pos>i?t.push(c):n.push(c)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return sp(e,t),!0}}runRecovery(e,t,n){let i=null,r=!1;for(let s=0;s<e.length;s++){let o=e[s],a=t[s<<1],l=t[1+(s<<1)];if(tp&&this.stackID(o),o.deadEnd&&(r||(r=!0,o.restart(),this.advanceFully(o,n))))continue;let h=o.split();for(let e=0;h.forceReduce()&&e<10&&!this.advanceFully(h,n);e++)tp&&this.stackID(h);for(let e of o.recoverByInsert(a))this.advanceFully(e,n);this.stream.end>o.pos?(l==o.pos&&(l++,a=0),o.recoverByDelete(a,l),sp(o,n)):(!i||i.score<o.score)&&(i=o)}return i}stackToTree(e){return e.close(),mo.build({buffer:Gd.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(np||(np=new WeakMap)).get(e);return t||np.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}(this,e,t,n);for(let r of this.wrappers)i=r(i,e,t,n);return i}getGoto(e,t,n=!1){let i=this.goto;if(t>=i[0])return-1;for(let r=i[t+1];;){let t=i[r++],s=1&t,o=i[r++];if(s&&n)return o;for(let n=r+(t>>1);r<n;r++)if(i[r]==e)return o;if(s)return-1}}hasAction(e,t){let n=this.data;for(let i=0;i<2;i++)for(let r,s=this.stateSlot(e,i?2:1);;s+=3){if(65535==(r=n[s])){if(1!=n[s+1]){if(2==n[s+1])return lp(n,s+2);break}r=n[s=lp(n,s+2)]}if(r==t||0==r)return lp(n,s+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){if(t==this.stateSlot(e,4))return!0;for(let n=this.stateSlot(e,1);;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])return!1;n=lp(this.data,n+2)}if(t==lp(this.data,n+1))return!0}}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=lp(this.data,n+2)}if(0==(1&this.data[n+2])){let e=this.data[n+1];t.some(((t,n)=>1&n&&t==e))||t.push(this.data[n],e)}}return t}overrides(e,t){let n=hp(this.data,this.tokenPrecTable,t);return n<0||hp(this.data,this.tokenPrecTable,e)<n}configure(e){let t=Object.assign(Object.create(ap.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map((t=>{let n=e.tokenizers.find((e=>e.from==t));return n?n.to:t}))),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),null!=e.bufferLength&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map((()=>!1));if(e)for(let i of e.split(" ")){let e=t.indexOf(i);e>=0&&(n[e]=!0)}let i=null;for(let e=0;e<t.length;e++)if(!n[e])for(let n,r=this.dialects[t[e]];65535!=(n=this.data[r++]);)(i||(i=new Uint8Array(this.maxTerm+1)))[n]=1;return new class{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||0==this.disabled[e]}}(e,n,i)}static deserialize(e){return new ap(e)}};function lp(e,t){return e[t]|e[t+1]<<16}function hp(e,t,n){for(let i,r=t;65535!=(i=e[r]);r++)if(i==n)return r-t;return-1}function cp(e){return 45==e||46==e||58==e||e>=65&&e<=90||95==e||e>=97&&e<=122||e>=161}function up(e){return 9==e||10==e||13==e||32==e}var dp=null,pp=null,fp=0;function mp(e,t){let n=e.pos+t;if(pp==e&&fp==n)return dp;for(;up(e.peek(t));)t++;let i="";for(;;){let n=e.peek(t);if(!cp(n))break;i+=String.fromCharCode(n),t++}return pp=e,fp=n,dp=i||null}function gp(e,t){this.name=e,this.parent=t,this.hash=t?t.hash:0;for(let t=0;t<e.length;t++)this.hash+=(this.hash<<4)+e.charCodeAt(t)+(e.charCodeAt(t)<<8)}var Op=new class{constructor(e){this.start=e.start,this.shift=e.shift||op,this.reduce=e.reduce||op,this.reuse=e.reuse||op,this.hash=e.hash||(()=>0),this.strict=!1!==e.strict}}({start:null,shift:(e,t,n,i)=>1==t?new gp(mp(i,1)||"",e):e,reduce:(e,t)=>11==t&&e?e.parent:e,reuse(e,t,n,i){let r=t.type.id;return 1==r||13==r?new gp(mp(i,1)||"",e):e},hash:e=>e?e.hash:0,strict:!1}),yp=new Jd(((e,t)=>{if(60==e.next)if(e.advance(),47==e.next){e.advance();let n=mp(e,0);if(!n)return e.acceptToken(5);if(t.context&&n==t.context.name)return e.acceptToken(2);for(let i=t.context;i;i=i.parent)if(i.name==n)return e.acceptToken(3,-2);e.acceptToken(4)}else if(33!=e.next&&63!=e.next)return e.acceptToken(1)}),{contextual:!0});function vp(e,t){return new Jd((n=>{for(let i=0,r=0;;r++){if(n.next<0){r&&n.acceptToken(e);break}if(n.next==t.charCodeAt(i)){if(i++,i==t.length){r>t.length&&n.acceptToken(e,1-t.length);break}}else i=0;n.advance()}}))}var bp=vp(35,"--\x3e"),wp=vp(36,"?>"),xp=vp(37,"]]>"),Sp=Xo({Text:aa.content,"StartTag StartCloseTag EndTag SelfCloseEndTag":aa.angleBracket,TagName:aa.tagName,"MismatchedCloseTag/Tagname":[aa.tagName,aa.invalid],AttributeName:aa.attributeName,AttributeValue:aa.attributeValue,Is:aa.definitionOperator,"EntityReference CharacterReference":aa.character,Comment:aa.blockComment,ProcessingInst:aa.processingInstruction,DoctypeDecl:aa.documentMeta,Cdata:aa.special(aa.string)}),kp=ap.deserialize({version:14,states:",SOQOaOOOrOxO'#CfOzOpO'#CiO!tOaO'#CgOOOP'#Cg'#CgO!{OrO'#CrO#TOtO'#CsO#]OpO'#CtOOOP'#DS'#DSOOOP'#Cv'#CvQQOaOOOOOW'#Cw'#CwO#eOxO,59QOOOP,59Q,59QOOOO'#Cx'#CxO#mOpO,59TO#uO!bO,59TOOOP'#C{'#C{O$TOaO,59RO$[OpO'#CoOOOP,59R,59ROOOQ'#C|'#C|O$dOrO,59^OOOP,59^,59^OOOS'#C}'#C}O$lOtO,59_OOOP,59_,59_O$tOpO,59`O$|OpO,59`OOOP-E6t-E6tOOOW-E6u-E6uOOOP1G.l1G.lOOOO-E6v-E6vO%UO!bO1G.oO%UO!bO1G.oO%dOpO'#CkO%lO!bO'#CyO%zO!bO1G.oOOOP1G.o1G.oOOOP1G.w1G.wOOOP-E6y-E6yOOOP1G.m1G.mO&VOpO,59ZO&_OpO,59ZOOOQ-E6z-E6zOOOP1G.x1G.xOOOS-E6{-E6{OOOP1G.y1G.yO&gOpO1G.zO&gOpO1G.zOOOP1G.z1G.zO&oO!bO7+$ZO&}O!bO7+$ZOOOP7+$Z7+$ZOOOP7+$c7+$cO'YOpO,59VO'bOpO,59VO'jO!bO,59eOOOO-E6w-E6wO'xOpO1G.uO'xOpO1G.uOOOP1G.u1G.uO(QOpO7+$fOOOP7+$f7+$fO(YO!bO<<GuOOOP<<Gu<<GuOOOP<<G}<<G}O'bOpO1G.qO'bOpO1G.qO(eO#tO'#CnOOOO1G.q1G.qO(sOpO7+$aOOOP7+$a7+$aOOOP<<HQ<<HQOOOPAN=aAN=aOOOPAN=iAN=iO'bOpO7+$]OOOO7+$]7+$]OOOO'#Cz'#CzO({O#tO,59YOOOO,59Y,59YOOOP<<G{<<G{OOOO<<Gw<<GwOOOO-E6x-E6xOOOO1G.t1G.t",stateData:")Z~OPQOSVOTWOVWOWWOXWOiXOxPO}TO!PUO~OuZOw]O~O^`Oy^O~OPQOQcOSVOTWOVWOWWOXWOxPO}TO!PUO~ORdO~P!SOseO|gO~OthO!OjO~O^lOy^O~OuZOwoO~O^qOy^O~O[vO`sOdwOy^O~ORyO~P!SO^{Oy^O~OseO|}O~OthO!O!PO~O^!QOy^O~O[!SOy^O~O[!VO`sOd!WOy^O~Oa!YOy^O~Oy^O[mX`mXdmX~O[!VO`sOd!WO~O^!]Oy^O~O[!_Oy^O~O[!aOy^O~O[!cO`sOd!dOy^O~O[!cO`sOd!dO~Oa!eOy^O~Oy^Oz!gO~Oy^O[ma`madma~O[!jOy^O~O[!kOy^O~O[!lO`sOd!mO~OW!pOX!pOz!rO{!pO~O[!sOy^O~OW!pOX!pOz!vO{!pO~O",goto:"%[wPPPPPPPPPPxxP!OP!UPP!_!iP!oxxxP!u!{#R$Z$j$p$v$|PPPP%SXWORYbXRORYb_t`qru!T!U!bQ!h!YS!o!e!fR!t!nQdRRybXSORYbQYORmYQ[PRn[Q_QQkVjp_krz!R!T!X!Z!^!`!f!i!nQr`QzcQ!RlQ!TqQ!XsQ!ZtQ!^{Q!`!QQ!f!YQ!i!]R!n!eQu`S!UqrU![u!U!bR!b!TQ!q!gR!u!qQbRRxbQfTR|fQiUR!OiSXOYTaRb",nodeNames:" StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Text EntityReference CharacterReference Cdata Element EndTag OpenTag TagName Attribute AttributeName Is AttributeValue CloseTag SelfCloseEndTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag DoctypeDecl",maxTerm:47,context:Op,nodeProps:[["closedBy",1,"SelfCloseEndTag EndTag",13,"CloseTag MissingCloseTag"],["openedBy",12,"StartTag StartCloseTag",19,"OpenTag",20,"StartTag"]],propSources:[Sp],skippedNodes:[0],repeatNodeCount:8,tokenData:"Az~R!WOX$kXY%rYZ%rZ]$k]^%r^p$kpq%rqr$krs&tsv$kvw'Uw}$k}!O(q!O!P$k!P!Q*n!Q![$k![!]+z!]!^$k!^!_/s!_!`=i!`!a>U!a!b>q!b!c$k!c!}+z!}#P$k#P#Q?}#Q#R$k#R#S+z#S#T$k#T#o+z#o%W$k%W%o+z%o%p$k%p&a+z&a&b$k&b1p+z1p4U$k4U4d+z4d4e$k4e$IS+z$IS$I`$k$I`$Ib+z$Ib$Kh$k$Kh%#t+z%#t&/x$k&/x&Et+z&Et&FV$k&FV;'S+z;'S;:j/S;:j?&r$k?&r?Ah+z?Ah?BY$k?BY?Mn+z?Mn~$kX$rUVP{WOr$krs%Usv$kw!^$k!^!_%d!_~$kP%ZRVPOv%Uw!^%U!_~%UW%iR{WOr%dsv%dw~%d_%{]VP{WyUOX$kXY%rYZ%rZ]$k]^%r^p$kpq%rqr$krs%Usv$kw!^$k!^!_%d!_~$kZ&{RzYVPOv%Uw!^%U!_~%U~'XTOp'hqs'hst(Pt!]'h!^~'h~'kTOp'hqs'ht!]'h!]!^'z!^~'h~(POW~~(SROp(]q!](]!^~(]~(`SOp(]q!](]!]!^(l!^~(]~(qOX~Z(xWVP{WOr$krs%Usv$kw}$k}!O)b!O!^$k!^!_%d!_~$kZ)iWVP{WOr$krs%Usv$kw!^$k!^!_%d!_!`$k!`!a*R!a~$kZ*[U|QVP{WOr$krs%Usv$kw!^$k!^!_%d!_~$k]*uWVP{WOr$krs%Usv$kw!^$k!^!_%d!_!`$k!`!a+_!a~$k]+hUdSVP{WOr$krs%Usv$kw!^$k!^!_%d!_~$k_,V}`S^QVP{WOr$krs%Usv$kw}$k}!O+z!O!P+z!P!Q$k!Q![+z![!]+z!]!^$k!^!_%d!_!c$k!c!}+z!}#R$k#R#S+z#S#T$k#T#o+z#o$}$k$}%O+z%O%W$k%W%o+z%o%p$k%p&a+z&a&b$k&b1p+z1p4U+z4U4d+z4d4e$k4e$IS+z$IS$I`$k$I`$Ib+z$Ib$Je$k$Je$Jg+z$Jg$Kh$k$Kh%#t+z%#t&/x$k&/x&Et+z&Et&FV$k&FV;'S+z;'S;:j/S;:j?&r$k?&r?Ah+z?Ah?BY$k?BY?Mn+z?Mn~$k_/ZWVP{WOr$krs%Usv$kw!^$k!^!_%d!_;=`$k;=`<%l+z<%l~$kX/xU{WOq%dqr0[sv%dw!a%d!a!b=X!b~%dX0aZ{WOr%dsv%dw}%d}!O1S!O!f%d!f!g1x!g!}%d!}#O5s#O#W%d#W#X:k#X~%dX1XT{WOr%dsv%dw}%d}!O1h!O~%dX1oR}P{WOr%dsv%dw~%dX1}T{WOr%dsv%dw!q%d!q!r2^!r~%dX2cT{WOr%dsv%dw!e%d!e!f2r!f~%dX2wT{WOr%dsv%dw!v%d!v!w3W!w~%dX3]T{WOr%dsv%dw!{%d!{!|3l!|~%dX3qT{WOr%dsv%dw!r%d!r!s4Q!s~%dX4VT{WOr%dsv%dw!g%d!g!h4f!h~%dX4kV{WOr4frs5Qsv4fvw5Qw!`4f!`!a5c!a~4fP5TRO!`5Q!`!a5^!a~5QP5cOiPX5jRiP{WOr%dsv%dw~%dX5xV{WOr%dsv%dw!e%d!e!f6_!f#V%d#V#W8w#W~%dX6dT{WOr%dsv%dw!f%d!f!g6s!g~%dX6xT{WOr%dsv%dw!c%d!c!d7X!d~%dX7^T{WOr%dsv%dw!v%d!v!w7m!w~%dX7rT{WOr%dsv%dw!c%d!c!d8R!d~%dX8WT{WOr%dsv%dw!}%d!}#O8g#O~%dX8nR{WxPOr%dsv%dw~%dX8|T{WOr%dsv%dw#W%d#W#X9]#X~%dX9bT{WOr%dsv%dw#T%d#T#U9q#U~%dX9vT{WOr%dsv%dw#h%d#h#i:V#i~%dX:[T{WOr%dsv%dw#T%d#T#U8R#U~%dX:pT{WOr%dsv%dw#c%d#c#d;P#d~%dX;UT{WOr%dsv%dw#V%d#V#W;e#W~%dX;jT{WOr%dsv%dw#h%d#h#i;y#i~%dX<OT{WOr%dsv%dw#m%d#m#n<_#n~%dX<dT{WOr%dsv%dw#d%d#d#e<s#e~%dX<xT{WOr%dsv%dw#X%d#X#Y4f#Y~%dX=`R!PP{WOr%dsv%dw~%dZ=rUaQVP{WOr$krs%Usv$kw!^$k!^!_%d!_~$k_>_U[UVP{WOr$krs%Usv$kw!^$k!^!_%d!_~$kZ>xWVP{WOr$krs%Usv$kw!^$k!^!_%d!_!`$k!`!a?b!a~$kZ?kU!OQVP{WOr$krs%Usv$kw!^$k!^!_%d!_~$kZ@UWVP{WOr$krs%Usv$kw!^$k!^!_%d!_#P$k#P#Q@n#Q~$kZ@uWVP{WOr$krs%Usv$kw!^$k!^!_%d!_!`$k!`!aA_!a~$kZAhUwQVP{WOr$krs%Usv$kw!^$k!^!_%d!_~$k",tokenizers:[yp,bp,wp,xp,0,1,2,3],topRules:{Document:[0,6]},tokenPrec:0});function Ap(e,t){let n=t&&t.getChild("TagName");return n?e.sliceString(n.from,n.to):""}function Cp(e,t){let n=t&&t.firstChild;return n&&"OpenTag"==n.name?Ap(e,n):""}function _p(e){for(let t=e&&e.parent;t;t=t.parent)if("Element"==t.name)return t;return null}var Ep=class{constructor(e,t,n){this.attrs=t,this.attrValues=n,this.children=[],this.name=e.name,this.completion=Object.assign(Object.assign({type:"type"},e.completion||{}),{label:this.name}),this.openCompletion=Object.assign(Object.assign({},this.completion),{label:"<"+this.name}),this.closeCompletion=Object.assign(Object.assign({},this.completion),{label:"</"+this.name+">",boost:2}),this.closeNameCompletion=Object.assign(Object.assign({},this.completion),{label:this.name+">"}),this.text=e.textContent?e.textContent.map((e=>({label:e,type:"text"}))):[]}},Tp=/^[:\-\.\w\u00b7-\uffff]*$/;function Pp(e){return Object.assign(Object.assign({type:"property"},e.completion||{}),{label:e.name})}function $p(e){return"string"==typeof e?{label:`"${e}"`,type:"constant"}:/^"/.test(e.label)?e:Object.assign(Object.assign({},e),{label:`"${e.label}"`})}function Np(e,t){let n=[],i=[],r=Object.create(null);for(let e of t){let t=Pp(e);n.push(t),e.global&&i.push(t),e.values&&(r[e.name]=e.values.map($p))}let s=[],o=[],a=Object.create(null);for(let t of e){let e=i,l=r;t.attributes&&(e=e.concat(t.attributes.map((e=>"string"==typeof e?n.find((t=>t.label==e))||{label:e,type:"property"}:(e.values&&(l==r&&(l=Object.create(l)),l[e.name]=e.values.map($p)),Pp(e))))));let h=new Ep(t,e,l);a[h.name]=h,s.push(h),t.top&&o.push(h)}o.length||(o=s);for(let t=0;t<s.length;t++){let n=e[t],i=s[t];if(n.children)for(let e of n.children)a[e]&&i.children.push(a[e]);else i.children=s}return e=>{var t;let{doc:n}=e.state,l=function(e,t){var n;let i=pa(e).resolveInner(t,-1),r=null;for(let e=i;!r&&e.parent;e=e.parent)("OpenTag"==e.name||"CloseTag"==e.name||"SelfClosingTag"==e.name||"MismatchedCloseTag"==e.name)&&(r=e);if(r&&(r.to>t||r.lastChild.type.isError)){let e=r.parent;if("TagName"==i.name)return"CloseTag"==r.name||"MismatchedCloseTag"==r.name?{type:"closeTag",from:i.from,context:e}:{type:"openTag",from:i.from,context:_p(e)};if("AttributeName"==i.name)return{type:"attrName",from:i.from,context:r};if("AttributeValue"==i.name)return{type:"attrValue",from:i.from,context:r};let n=i==r||"Attribute"==i.name?i.childBefore(t):i;return"StartTag"==n?.name?{type:"openTag",from:t,context:_p(e)}:"StartCloseTag"==n?.name&&n.to<=t?{type:"closeTag",from:t,context:e}:"Is"==n?.name?{type:"attrValue",from:t,context:r}:n?{type:"attrName",from:t,context:r}:null}if("StartCloseTag"==i.name)return{type:"closeTag",from:t,context:i.parent};for(;i.parent&&i.to==t&&(null===(n=i.lastChild)||void 0===n||!n.type.isError);)i=i.parent;return"Element"==i.name||"Text"==i.name||"Document"==i.name?{type:"tag",from:t,context:"Element"==i.name?i:_p(i)}:null}(e.state,e.pos);if(!l||"tag"==l.type&&!e.explicit)return null;let{type:h,from:c,context:u}=l;if("openTag"==h){let e=o,t=Cp(n,u);if(t){e=a[t]?.children||s}return{from:c,options:e.map((e=>e.completion)),validFor:Tp}}if("closeTag"==h){let i=Cp(n,u);return i?{from:c,to:e.pos+(">"==n.sliceString(e.pos,e.pos+1)?1:0),options:[(null===(t=a[i])||void 0===t?void 0:t.closeNameCompletion)||{label:i+">",type:"type"}],validFor:Tp}:null}if("attrName"==h){return{from:c,options:a[Ap(n,u)]?.attrs||i,validFor:Tp}}if("attrValue"==h){let t=function(e,t,n){let i=t&&t.getChildren("Attribute").find((e=>e.from<=n&&e.to>=n)),r=i&&i.getChild("AttributeName");return r?e.sliceString(r.from,r.to):""}(n,u,c);if(!t)return null;let i=(a[Ap(n,u)]?.attrValues||r)[t];return i&&i.length?{from:c,to:e.pos+('"'==n.sliceString(e.pos,e.pos+1)?1:0),options:i,validFor:/^"[^"]*"?$/}:null}if("tag"==h){let t=Cp(n,u),i=a[t],r=[],l=u&&u.lastChild;t&&(!l||"CloseTag"!=l.name||Ap(n,l)!=t)&&r.push(i?i.closeCompletion:{label:"</"+t+">",type:"type",boost:2});let h=r.concat((i?.children||(u?s:o)).map((e=>e.openCompletion)));if(u&&i?.text.length){let t=u.firstChild;t.to>e.pos-20&&!/\S/.test(e.state.sliceDoc(t.to,e.pos))&&(h=h.concat(i.text))}return{from:c,options:h,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}return null}}var Ip=da.define({parser:kp.configure({props:[Ta.add({Element(e){let t=/^\s*<\//.test(e.textAfter);return e.lineIndent(e.node.from)+(t?0:e.unit)},"OpenTag CloseTag SelfClosingTag":e=>e.column(e.node.from)+e.unit}),Ma.add({Element(e){let t=e.firstChild,n=e.lastChild;return t&&"OpenTag"==t.name?{from:t.to,to:"CloseTag"==n.name?n.from:e.to}:null}})]}),languageData:{commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}},indentOnInput:/^\s*<\/$/}});var Qp=(e=>(e.xml="xml",e.leiden_plus="leiden_plus",e.edcs="edcs",e.phi="phi",e.default="default",e))(Qp||{}),Rp=(e,t)=>n=>(n.dispatch(n.state.changeByRange((n=>({changes:[{from:n.from,insert:e},{from:n.to,insert:t}],range:D.range(n.from+e.length,n.to+e.length)})))),!0),Mp=e=>t=>(e=e.replace(/\$\|([^|]+)\|/g,"${$1}"),t.state.selection.ranges.forEach((n=>{let i=t.state.doc.slice(n.from,n.to);!function(e){let t=Nu.parse(e);return(e,n,i,r)=>{let{text:s,ranges:o}=t.instantiate(e.state,i),l={changes:{from:i,to:r,insert:a.of(s)}};if(o.length&&(l.selection=Xu(o,0)),o.length>1){let t=new Ru(o,0),n=l.effects=[Mu.of(t)];void 0===e.state.field(Du,!1)&&n.push(Oe.appendConfig.of([Du,Vu,zu,Tu]))}e.dispatch(e.state.update(l))}}(e.replace(/\${_}/,`\${${i.toString()}}`))(t,{label:""},n.from,n.to)})),!0),Bp=class{constructor(e){this.editor=e}getConfig(){let e=this,t=Rn.fromClass(class{update(t){if(t.docChanged){let n=pa(t.state),i=t.state.doc.toJSON(),r=e.onUpdate(n,i.join("\n"));try{let t=e.serialize();if(!t)return;e.editor._value=t,e.editor.emitUpdateEvent(r)}catch(e){return}}else{let n=t.transactions[0];if(n){let t=n.effects.filter((e=>e.is(fd)));if(t){let n=t.reduce(((e,t)=>{let n=t.value.filter((e=>"error"===e.severity)),i=t.value.filter((e=>"info"===e.severity));if(n.length){e.valid=!1;for(let t of n)e.errors.push(null==t?void 0:t.message)}return i.length&&!e.errors.length&&(e.valid=!0),e}),{valid:e.editor.valid,errors:[]});if(e.editor.valid=n.valid,n.valid)return void e.editor.dispatchEvent(new CustomEvent("valid",{composed:!0,bubbles:!0}));e.editor.dispatchEvent(new CustomEvent("invalid",{detail:n.errors,composed:!0,bubbles:!0}))}}}}}),n=this.getExtensions(this.editor);return{extensions:[zd,$r.lineWrapping,Xr.of([Kh]),...n,t]}}getCommands(){return{}}onUpdate(e,t){return t}},Dp=Oe.define(),Xp=W.define({create:()=>!1,update(e,t){for(let n of t.effects)n.is(Dp)&&(e=n.value);return e},provide:e=>Bs.from(e,(e=>e?Fp:null))});function Fp(e){let t=document.createElement("div");t.className="cm-input-panel";let n=document.createElement("input");return n.type="text",n.placeholder="Name of element (enter to confirm, esc to abort)",n.addEventListener("keyup",(t=>{switch(t.key){case"Enter":t.preventDefault();let i=n.value;""!==i&&(Rp(`<${i}>`,`</${i}>`)(e),e.focus());case"Esc":case"Escape":e.dispatch({effects:Dp.of(!1)})}})),t.appendChild(n),{top:!1,dom:t,mount:()=>n.focus()}}var Lp=$r.baseTheme({".cm-input-panel":{padding:"5px 10px",fontFamily:"monospace"},".cm-input-panel input":{width:"100%"}});var Up={selectElement:e=>(e.dispatch(e.state.changeByRange((t=>{let n=null;for(let i=pa(e.state).resolveInner(t.from);!n&&i.parent;i=i.parent)"Element"==i.name&&(n=i);return n?{selection:D.range(n.from,n.to),range:D.range(n.from,n.to)}:{range:t}}))),!0),removeEnclosing:e=>(e.dispatch(e.state.changeByRange((t=>{let n=null;for(let i=pa(e.state).resolveInner(t.from);!n&&i.parent;i=i.parent)"Element"==i.name&&(n=i);if(n){let e=n.firstChild,t=n.lastChild;if(e&&t)return"SelfClosingTag"===e.name?{range:D.range(e.from,e.from),changes:[{from:e.from,to:e.to,insert:""}]}:{range:D.range(e.from,t.from-(e.to-e.from)),changes:[{from:e.from,to:e.to,insert:""},{from:t.from,to:t.to,insert:""}]}}return{range:t}}))),!0),encloseWith:e=>(e.dispatch({effects:Dp.of(!e.state.field(Xp))}),!0),snippet:{create:e=>Mp(e)}},Vp=e=>e.filter((e=>"info"!==e.severity)),zp=e=>({name:"Fix",apply:(t,n,i)=>{let r=t.state.update({changes:{from:n,to:i,insert:e}});t.dispatch(r)}}),Zp=e=>t=>{let n=[];if(0===t.state.doc.length)return n;let i=pa(t.state),r=!1,s=[];return i.iterate({enter:i=>{if(i.type.isError&&n.push({message:"Syntax error",severity:"error",from:i.from,to:i.to}),"StartTag"===i.type.name)i.nextSibling(),s.push(t.state.sliceDoc(i.from,i.to));else if("StartCloseTag"===i.type.name){i.nextSibling();let e=t.state.sliceDoc(i.from,i.to),r=s.pop();e!==r&&n.push({message:`Expected closing tag for ${r}`,severity:"error",from:i.from,to:i.to})}else if("SelfCloseEndTag"===i.type.name)s.pop();else if(((e,t)=>"AttributeName"===t.type.name&&"xmlns"===e.state.sliceDoc(t.from,t.to))(t,i)){r=!0,i.nextSibling(),i.nextSibling();let s=t.state.sliceDoc(i.from+1,i.to-1);e&&s!==e&&n.push({message:"Wrong Namespace",severity:"error",from:i.from+1,to:i.to-1,actions:[zp(e)]})}else((e,t)=>"Comment"===t.type.name&&/\<\!\-\- Error\:([^ ])* \-\-\>/.test(e.state.sliceDoc(t.from,t.to)))(t,i)&&n.push({message:"Syntax error in source input",severity:"warning",from:i.from,to:i.to})},leave:t=>{"Document"===t.type.name&&e&&!r&&n.push({message:"Missing TEI namespace",severity:"error",from:t.from,to:t.to}),"Document"===t.type.name&&!n.length&&n.push({message:"All fine",severity:"info",from:t.from,to:t.to}),t.type.isError&&n.push({message:"Syntaxfehler",severity:"error",from:t.from,to:t.to})}}),n},jp=[{key:"Ctrl-Shift-s",mac:"Cmd-Shift-s",run:Up.selectElement},{key:"Ctrl-Shift-x",mac:"Cmd-Shift-x",run:Up.removeEnclosing},{key:"Ctrl-Shift-e",mac:"Cmd-Shift-e",run:Up.encloseWith}],qp=class extends Bp{constructor(e,t=null,n=!1,i=!1){super(e),this.namespace=t,this.checkNamespace=n,this.unwrap=i}getDefaultExtensions(){return[[Xp,Lp],Xr.of(jp),Ad(Zp(this.checkNamespace?this.namespace:null),{delay:300,markerFilter:Vp}),Ud({markerFilter:Vp})]}getExtensions(){return this.getDefaultExtensions().concat(function(e={}){return new xa(Ip,Ip.data.of({autocomplete:Np(e.elements||[],e.attributes||[])}))}())}getCommands(){return Up}loadSchema(e){return((e,t,n)=>new Promise(((i,r)=>{var s=e=>{try{a(n.next(e))}catch(e){r(e)}},o=e=>{try{a(n.throw(e))}catch(e){r(e)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,o);a((n=n.apply(e,t)).next())})))(this,null,(function*(){return yield fetch(e).then((e=>e.json()))}))}serialize(){var e;let t=new DOMParser,n=this.unwrap?`<R xmlns="${this.namespace||""}">${this.editor.content}</R>`:this.editor.content,i=t.parseFromString(n,"application/xml");return i.getElementsByTagName("parsererror").length?null:this.unwrap?null==(e=i.firstElementChild)?void 0:e.childNodes:i.firstElementChild}setFromValue(e){if(!e||!(e instanceof Element||e instanceof NodeList))return"";let t=new XMLSerializer;if(e instanceof NodeList){let n=[];for(let i=0;i<e.length;i++)n.push(t.serializeToString(e[i]));return n.join("")}return t.serializeToString(e)}},Gp="() <>?=.0123456789[]",Wp=new Jd((e=>{let t="";for(;!(e.next<0);){if(46===e.next&&"lost"===t)return e.advance(),void e.acceptToken(31);let n=String.fromCharCode(e.next);if(Gp.indexOf(n)>-1||803===e.peek(1))break;t+=n,e.advance()}t.length>0&&e.acceptToken(30)})),Hp=new Jd((e=>{let t=0;for(;!(e.next<0||Gp.indexOf(String.fromCharCode(e.next))>-1)&&803===e.peek(1);)t++,e.advance(2);t>0&&e.acceptToken(1)})),Yp=ap.deserialize({version:14,states:"(QOQOVOOOQOVO'#C_OQOVO'#C`OQOVO'#CaO!eOWO'#CbO!pOVO'#ClO#wOVO'#CmOOOR'#Co'#CoO$ROSO'#CpO!pOVO'#CqOOOR'#DX'#DXOOOR'#Cr'#CrO$WOSO'#CtO!pOVO'#CvOOOR'#Ch'#ChOOOR'#C|'#C|OOOR'#Cw'#CwQQOVOOO$`OVO,58yO$gOVO,58zO$nOVO,58{OQOVO,58|OQOVO,59OOQOVO,59QOOOR'#Cx'#CxO$uOVO,59WO$|OVO,59XOOOR,59X,59XO%WOSO,59XO%]OSO,59[O%bOVO,59]O%lOSO,59`O%qOVO,59bOOOR-E6u-E6uOOOR1G.e1G.eOOOR1G.f1G.fOOOR1G.g1G.gO%xOVO1G.hO&POVO1G.jO&WOVO1G.lOOOR-E6v-E6vOOOR1G.r1G.rOOOR1G.s1G.sO&_OSO1G.sOOOR1G.v1G.vOOOR1G.w1G.wO&dOSO1G.wOOOR1G.z1G.zOOOR1G.|1G.|OOOR7+$S7+$SOOOR7+$U7+$UOOOR7+$W7+$WOOOR7+$_7+$_OOOR7+$c7+$c",stateData:"&n~OP^O]^O^^O_^OgZOi^OnZOo[OqPOsQOuROvSOwTOyUO|VO}WO!PXO!QZO!RZO!SZO!U]O~OVeOXfOZgO~OP^O]^O^^O_^OgZOi^OnZOo[OwTOyUO|VO}WO!PXO!QZO!RZO!SZO!U]O~OblOzkO~P!pO_mO~O_oOgoO~OrrO~PQOtsO~PQOttO~PQOxyO~P!pOb{OzzO~P!pOzzO~O!O|O~Ob!OO!O}O~P!pO!T!PO~O!V!QO~P!pOt!RO~PQOt!SO~PQOt!TO~PQOz!UO~O!O!VO~OZ^_Z~",goto:"%_|PPP}}}}P}P}P!_PPP!y!yP#c#c#c!yP!yP!y#{$kPPP$}PPPPPPPPPP!ym_OPQRabcdefguvwl_OPQRabcdefguvwahTUX]ijnp}^OPQRTUX]abcdefgijnpuvw}YOPQRTUX]abcdefgijnpuvwQaOQbPQcQQdR^qabcduvwQueQvfRwgQiTQjUQnXQp]Xxijnpm`OPQRabcdefguvw",nodeNames:" Unclear Document Div Recto Verso Part PartId Fragment FragmentNum Column ColumnNum Inline LineBreakWrapped LineBreak Number Abbrev Supplied CertLow GapUnknown Gap SuppliedLost Text QuestionMark LostLines Illegible Erasure",maxTerm:53,skippedNodes:[0],repeatNodeCount:2,tokenData:"+y~Rapq!Wxy!]yz!p!O!P!u!Q![#v!^!_'v!_!`(y!`!a)f!a!b)k!c!}'^!}#O)p#P#Q*]#T#`'^#`#a*b#a#o'^&Fp&Fq+o&Fq&Fr+t~!]O!R~~!bPw~!a!b!e~!hPyz!k~!pOb~~!uOx~~!zQ!Q~!Q![#Q!a!b#n~#VQi~!Q![#Q#`#a#]~#`P#]#^#c~#fP#b#c#i~#nOi~~#sPi~#`#a#]~#{S_P!O!P$X!Q![#v!c!}'^#T#o'^~$^T^Ppq$m}!O$r#V#W%P#Y#Z%t#d#e&uP$rO^P~$wP]~pq$z~%PO]~Q%SP#c#d%VQ%YP#`#a%]Q%`P#i#j%cQ%fP#a#b%iQ%lP#b#c%oQ%tOZQ~%wP#f#g%z~%}P#T#U&Q~&TP#Z#[&W~&ZP#a#b&^~&aP#X#Y&d~&gP#b#c&j~&mP#h#i&p~&uOX~Q&xP#T#U&{Q'OP#f#g'RQ'UP#h#i'XQ'^OVQQ'aS!O!P'm!Q!['^!c!}'^#T#o'^Q'pQ#V#W%P#d#e&u~'{Qy~!_!`(R!f!g(W~(WOq~~(ZP!_!`(^~(aP!O!P(d~(iQv~#f#g(o#j#k(t~(tOs~~(yOu~~)OQ!S~!`!a)U!f!g)Z~)ZOr~~)^P!`!a)a~)fOt~~)kOz~~)pOg~~)uP!P~!O!P)x~)}P}~!a!b*Q~*TP#P#Q*W~*]O|~~*bO!O~R*eU!O!P'm!Q!['^!c!}'^#T#]'^#]#^*w#^#o'^R*zU!O!P'm!Q!['^!c!}'^#T#b'^#b#c+^#c#o'^R+cS!TP!O!P'm!Q!['^!c!}'^#T#o'^~+tO!U~~+yO!V~",tokenizers:[Wp,Hp,0,1],topRules:{Document:[0,2]},tokenPrec:255}),Jp=["Recto","Verso","Fragment","Part","Div"];var Kp=da.define({parser:Yp.configure({props:[Xo({Number:aa.number,"LineBreak LineBreakWrapped":aa.contentSeparator,"Illegible GapUnknown Gap SuppliedLost Supplied Unclear":aa.comment,"Div Recto Verso Part Fragment":aa.keyword,"( )":aa.paren})]}),languageData:{closeBrackets:{brackets:["(","[","{","<"]}}});function ef(e,t){for(let n=0;n<e.childNodes.length;n++)tf(e.childNodes[n],t)}function tf(e,t){if(e)switch(e.nodeType){case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:tf(e.firstElementChild,t);break;case Node.ELEMENT_NODE:let n,i=e;switch(i.localName){case"ab":t.push("<="),ef(i,t),t.push("=>");break;case"abbr":ef(i,t);break;case"del":t.push(""),ef(i,t),t.push("");break;case"div":n=i.getAttribute("n"),t.push(`<D=.${n}.column`),ef(i,t),t.push("=D>");break;case"expan":case"ex":let e=i.getAttribute("cert");t.push("("),ef(i,t),"low"===e&&t.push("?"),t.push(")");break;case"gap":!function(e,t){let n=e.getAttribute("unit"),i=e.getAttribute("quantity"),r=e.getAttribute("reason");if(r)switch(r){case"lost":switch(n){case"character":i?t.push(`[.${i}]`):t.push("[.?]");break;case"line":i?t.push(`lost.${i}lin`):t.push("lost.?lin")}break;case"illegible":switch(n){case"character":i?t.push(`.${i}`):t.push(".?");break;case"line":i&&t.push(`.${i}lin`)}}}(i,t);break;case"lb":n=i.getAttribute("n"),t.length>0&&!/\n+$/.test(t[t.length-1])&&t.push("\n"),t.push(`${n}. `);break;case"supplied":!function(e,t){let n=e.getAttribute("reason");if(n){let i=e.getAttribute("cert");if("omitted"===n)t.push("<"),ef(e,t),i&&"low"===i&&t.push("(?)"),t.push(">");else t.push("["),ef(e,t),i&&"low"===i&&t.push("(?)"),t.push("]")}}(i,t)}break;case Node.TEXT_NODE:t.push(e.nodeValue||"")}}function nf(e){if(!(e instanceof Element))return"";let t=[],n=e.querySelectorAll("cb");if(n.length>0)for(let i=0;i<=n.length;i++){let r=document.createRange();0===i?r.setStart(e,0):r.setStartAfter(n[i-1]),i===n.length?e.lastChild&&r.setEndAfter(e.lastChild):r.setEndBefore(n[i]);let s=document.createElement("div");s.setAttribute("type","textpart"),s.setAttribute("subtype","column"),s.setAttribute("n",(i+1).toString()),r.surroundContents(s),tf(s,t)}else tf(e,t);return t.join("")}var rf={expan:Mp("(${_}(${}))"),div:Rp("<=\n","\n=>"),fragment:Mp("<D=.${1:1}.fragment<=\n${2}\n=>=D>"),part:Mp("<D=.${1:A}.part<=\n${2}\n=>=D>"),recto:Rp("<D=.r<=\n","\n=>=D>"),verso:Rp("<D=.v<=\n","\n=>=D>"),erasure:Rp("",""),unclear:e=>(e.dispatch(e.state.changeByRange((t=>{let n=e.state.doc.slice(t.from,t.to).toString(),i="";for(let e=0;e<n.length;e++)e+1<n.length&&803===n.charCodeAt(e+1)?(i+=n.charAt(e),e++):i+=`${n.charAt(e)}`;return{changes:[{from:t.from,to:t.to,insert:i}],range:D.range(t.from,t.from+i.length)}}))),!0)},sf=[{key:"Ctrl-Shift-e",mac:"Cmd-Shift-e",run:rf.expan},{key:"Ctrl-Shift-a",mac:"Cmd-Shift-a",run:rf.div},{key:"Ctrl-Shift-f",mac:"Cmd-Shift-f",run:rf.fragment},{key:"Ctrl-Shift-p",mac:"Cmd-Shift-p",run:rf.part},{key:"Ctrl-Shift-r",mac:"Cmd-Shift-r",run:rf.recto},{key:"Ctrl-Shift-v",mac:"Cmd-Shift-v",run:rf.verso},{key:"Ctrl-Shift-d",mac:"Cmd-Shift-d",run:rf.erasure},{key:"Ctrl-Shift-u",mac:"Cmd-Shift-u",run:rf.unclear}],of=class extends Bp{getExtensions(){return[new xa(Kp),Ad((e=>{let t=[];return pa(e.state).iterate({enter:e=>{e.type.isError&&t.push({message:"Syntaxfehler",severity:"error",from:e.from,to:e.to})}}),t})),Xr.of(sf),Ud()]}getCommands(){return rf}onUpdate(e,t){return function(e,t=Yp.parse(e)){function n(t){return e.substring(t.from,t.to)}let i,r=[],s=[],o=!1,a="ab";return t.iterate({enter:e=>{if(e.type.isError)return void s.push(`\x3c!-- Error:${n(e)} --\x3e`);let t=e.name;switch(t){case"Document":let l=0;if(e.firstChild())do{l++,Jp.includes(e.type.name)&&(a="div"),o=o||"Inline"===e.type.name}while(e.nextSibling());o=l>1||o,o&&s.push(`<${a}>\n`),e.parent();break;case"Text":case"Number":s.push(n(e));break;case"LineBreak":e.firstChild(),i=/^([0-9]+)\..*$/.exec(n(e)),s.push(`<lb n="${i?i[1]:""}"/>`);break;case"LineBreakWrapped":e.firstChild(),i=/^([0-9]+)\..*$/.exec(n(e)),s.push(`<lb n="${i?i[1]:""}" break="no"/>`);break;case"Div":s.push("<ab>");break;case"Recto":case"Verso":s.push('<div n="r" type="textpart">');break;case"Fragment":e.firstChild(),i=/^([0-9]+)\..*$/.exec(n(e)),s.push(`<div n="${i?i[1]:""}" subtype="fragment" type="textpart">`);break;case"Part":e.firstChild(),i=/^([a-zA-Z0-9]+)\..*$/.exec(n(e)),s.push(`<div n="${i?i[1]:""}" subtype="part" type="textpart">`);break;case"Column":e.firstChild(),i=/^([a-zA-Z0-9]+)\..*$/.exec(n(e)),s.push(`<div n="${i?i[1]:""}" subtype="column" type="textpart">`);break;case"Unclear":let h=n(e),c="";for(let e=0;e<h.length;e++){let t=h.codePointAt(e);t&&803!==t&&(c+=String.fromCodePoint(t))}return s.push(`<unclear>${c}</unclear>`),!1;case"Gap":return e.next(!0),s.push(`<gap reason="lost" quantity="${n(e)}" unit="character"/>`),!1;case"GapUnknown":return s.push('<gap reason="lost" extent="unknown" unit="character"/>'),!1;case"Illegible":return i=/^\.([0-9?]+)(lin)?$/.exec(n(e)),i&&("lin"===i[2]?s.push(`<gap reason="illegible" quantity="${i?i[1]:""}" unit="line"/>`):"?"===i[1]?s.push('<gap reason="illegible" extent="unkown" unit="character"/>'):s.push(`<gap reason="illegible" quantity="${i?i[1]:""}" unit="character"/>`)),!1;case"Erasure":s.push('<del rend="erasure">');break;case"LostLines":return i=/^lost\.([0-9?]+)lin$/.exec(n(e)),i&&("?"===i[1]?s.push('<gap reason="lost" extent="unknown" unit="line"/>'):s.push(`<gap reason="lost" quantity="${i?i[1]:""}" unit="line"/>`)),!1;case"Abbrev":r.length>0?(e.lastChild(),i=n(e),i.length>0&&"?"===i.charAt(i.length-1)?s.push('<ex cert="low">'):s.push("<ex>"),e.parent()):s.push("<expan>"),r.push("expan");break;case"Supplied":e.lastChild(),"CertLow"===e.name?s.push('<supplied reason="omitted" cert="low">'):s.push('<supplied reason="omitted">'),e.parent();break;case"SuppliedLost":e.lastChild(),"CertLow"===e.name?s.push('<supplied reason="lost" cert="low">'):s.push('<supplied reason="lost">'),e.parent();break;case"CertLow":return!1;case"QuestionMark":return r.length<2&&s.push("?"),!1;case"Inline":break;default:s.push(`<${t}>`)}},leave:e=>{switch(e.name){case"Document":o&&s.push(`\n</${a}>`);break;case"Abbrev":if(r.length>1){let e=s[s.length-1];e.endsWith("?")&&(s[s.length-1]=e.substring(0,e.length-2)),s.push("</ex>")}else s.push("</expan>");r.pop();break;case"Div":s.push("</ab>");break;case"Recto":case"Verso":case"Fragment":case"Part":case"Column":s.push("</div>\n");break;case"Supplied":case"SuppliedLost":s.push("</supplied>");break;case"Erasure":s.push("</del>")}}}),"Inline"===t.type.name&&s.push("</ab>"),s.join("")}(t,e)}serialize(){return this.editor.content}setFromValue(e){if(!e)return"";if(e instanceof NodeList){let t=[];return e.forEach((e=>t.push(nf(e)))),t.join("")}if(e instanceof Element)return nf(e);if("string"!=typeof e)throw new Error("cannot set value");return e}};function af(e,t){(e=(e=e.toString().replace(/\t+/g,"")).replace(/\r/g,"")).toString().length-e.toString().lastIndexOf(" ")==1&&(e=e.toString().substring(0,e.toString().lastIndexOf(" ")));{e='<lb n="'+1..toString()+'"/>'+e;let n=/(\-|-?|\=?)\s?\n/g,i=0;if(e=e.replace(n,(function(e,t){return"-"===t||"="===t?'\n<lb n="'+(2+i++)+'" break="no"/>':'\n<lb n="'+(2+i++)+'"/>'})),e=e.replace(/(\<lb n=\"[0-9]*\"\/\>)\[(\s?\s?){3,50}\]\n(\<lb n=\"[0-9]*\"\/\>)/g,'$1<gap reason="illegible" quantity="1" unit="line"/>\n$3'),"edcs"==t){i=0,e=e.replace(/(\s)?(\/\/)(?!\>)(\s)?/g,(function(e){if("/"===e[0])var t=' break="no"';else t="";return'\n<cb n="'+(2+i++)+'"'+t+"/>"}));let t=/(\s)?(\/{1})(?!\>)(\s)?/g;i=0,e=e.replace(t,(function(e){if("/"===e[0])var t=' break="no"';else t="";return'\n<lb n="'+(2+i++)+'"'+t+"/>"}))}"phi"==t&&(e=(e=(e=e.replace(/#/g,'<gap reason="illegible" quantity="1" unit="character"/>')).replace(/###/g,'<gap reason="illegible" quantity="3" unit="character"/>')).replace(/#/g,'<g type="interpunct"></g>'));let r=/\n<lb n=\'([0-9])\'\/>\1\s/g,s='\n<lb n="$1"/>';e=e.replace(r,s);let o=/(\"[0-9]{1,3}\"\/>)([0-9]{1,3})/g,a="$1";e=e.replace(o,a)}if(e=(e=e.replace(/\<([^\x00-\x7F]*[aA-zZ]*)(?!\=)(?!\/)\>/g,'<supplied reason="omitted">$1</supplied>')).replace(/([^\x00-\x7F]*[aA-zZ]*)(?!\=)(?!\/)/g,'<supplied reason="omitted">$1</supplied>'),"edcs"==t){let t=/\<([^\x00-\x7F]*[aA-zZ]*)(\=)([^\x00-\x7F]*[aA-zZ]*)(?!\/)\>/g,n="<choice><corr>$1</corr><sic>$3</sic></choice>";e=e.replace(t,n),e=(e=(e=(e=(e=(e=(e=e.replace(/\[6\]/g,'<gap reason="lost" quantity="1" unit="line"/>')).replace(/\[3\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[3\s([^\x00-\x7F]*[aA-zZ]*)\]/g,'<gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">$1</supplied>')).replace(/\[3\s/g,'<gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">')).replace(/\s3\s/g," - - - ")).replace(/\s3\]/g," - - -]")).replace(/a\(\)/g,"<abbr>a</abbr>")}let n=/\[(\|\-)\s?(\|\-)\s?(\|\-)\]/g;e=(e=(e=e.replace(/\(\!\)/g,"<note>!</note>")).replace(/\(sic\)/g,"<note>sic</note>")).replace(n,(function(e,t){return'<gap reason="lost" extent="unknown" unit="character"/>'})),n=/\[(?:(?:\s?\.\s?){1,99})([1-9][0-9]*)(?:(?:\s?\.\s?){1,99})\]/g,e=e.replace(n,(function(e,t){return'<gap reason="lost" quantity="'+t+'" unit="character"/>'})),n=/\[(?:(?:\s?\.\s?){1,99})([1-9][0-9]*)(?:(?:\s?\.\s?){1,99})\s/g,e=e.replace(n,(function(e,t){return e.length,'<gap reason="lost" quantity="'+t+'" unit="character"/><supplied reason="lost">'})),n=/\s(?:(?:\s?\.\s?){1,99})([1-9][0-9]*)(?:(?:\s?\.\s?){1,99})\]/g,e=e.replace(n,(function(e,t){return e.length,'</supplied><gap reason="lost" quantity="'+t+'" unit="character"/>'})),n=/\s(?:(?:\s?\.\s?){1,99})([1-9][0-9]*)(?:(?:\s?\.\s?){1,99})\s/g,e=e.replace(n,(function(e,t){return e.length,'</supplied><gap reason="lost" quantity="'+t+'" unit="character"/><supplied reason="lost">'})),n=/\[((\.){1,99})\]/g,e=e.replace(n,(function(e,t){return'<gap reason="lost" quantity="'+(e.length-2)+'" unit="character"/>'})),n=/\[((\.){1,99})\s/g,e=e.replace(n,(function(e,t){return'<gap reason="lost" quantity="'+(e.length-2)+'" unit="character"/><supplied reason="lost">'})),n=/\s((\.){1,99})\]/g,e=e.replace(n,(function(e,t){return'</supplied><gap reason="lost" quantity="'+(e.length-2)+'" unit="character"/>'})),n=/\s((\.){1,99})\s/g,e=e.replace(n,(function(e,t){return'</supplied><gap reason="lost" quantity="'+(e.length-2)+'" unit="character"/><supplied reason="lost">'})),n=/([^\x00-\x7F]*[aA-zZ]*)\[([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)(\])/g;let i='<expan><abbr>$1<supplied reason="lost">$2</supplied></abbr><ex>$3</ex></expan>';e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\[(-||\.\s?){1,20}ca\.(\s?)([1-9][0-9]*)((-)([1-9][0-9]*))(\s?)(-||\.\s?){1,20}\]/g,'<gap reason="lost" atLeast="$3" atMost="$6" unit="character"/>')).replace(/\[(-||\.\s?){1,20}ca\.(\s?)([1-9][0-9]*)(\s?)(-||\.\s?){1,20}\]/g,'<gap reason="lost" quantity="$3" unit="character" precision="low"/>')).replace(/\[(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20}(?:\s?)\]/g,'<gap reason="lost" atLeast="$1" atMost="$2" unit="character"/>')).replace(/\[(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:\s?)(?:[\.]){1,20}(?:\s?)\]/g,'<gap reason="lost" quantity="$1" unit="character" precision="low"/>')).replace(/\[(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20}(?:\s)/g,'<gap reason="lost" atLeast="$1" atMost="$2" unit="character"/><supplied reason="lost">')).replace(/\[(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:\s?)(?:[\.]){1,20}(?:\s)/g,'<gap reason="lost" quantity="$1" unit="character" precision="low"/><supplied reason="lost">')).replace(/\s(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20}(?:\s?)\]/g,'</supplied><gap reason="lost" atLeast="$1" atMost="$2" unit="character"/>')).replace(/\s(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:\s?)(?:[\.]){1,20}(?:\s?)\]/g,'</supplied><gap reason="lost" quantity="$1" unit="character" precision="low"/>')).replace(/\s(?:[\.]){2,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20}(?:\s)/g,'</supplied><gap reason="lost" atLeast="$1" atMost="$2" unit="character"/><supplied reason="lost">')).replace(/\s(?:[\.]){2,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:\s?)(?:[\.]){1,20}(?:\s)/g,'</supplied><gap reason="lost" quantity="$1" unit="character" precision="low"/><supplied reason="lost">')).replace(/(?:\s|\n)\(([^\x00-\x7F]*[aA-zZ]*)\)/g," <expan><ex>$1</ex></expan>")).replace(/\[{2}/g,"")).replace(/\]{2}/g,"")).replace(/\[([^\x00-\x7F]*[aA-zZ]*[^\]])\]([^\x00-\x7F]*[aA-zZ]*[^\]])\(([^\x00-\x7F]*?[aA-zZ]*?)\)/g,'<expan><abbr><supplied reason="lost">$1</supplied>$2</abbr><ex>$3</ex></expan>')).replace(/(||\[\[)([^\x00-\x7F]*[aA-zZ]*[^\]])(||]])([^\x00-\x7F]*[aA-zZ]*[^\]])\(([^\x00-\x7F]*?[aA-zZ]*?)\)/g,'<expan><abbr><supplied reason="lost">$1</supplied>$2</abbr><ex>$3</ex></expan>')).replace(/\[(\w*?\s?)(?:(?:(?:\-|\|\)\s?){1,20})(\w*?)\](?![^\x00-\x7F]*?[aA-zZ]*?\()/g,'<supplied reason="lost">$1</supplied><gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">$2</supplied>')).replace(/<supplied reason=\"lost\"><\/supplied>/g,"")).replace(/(?:|)(.*?\s?)(?:(?:(?:\-|\|\)\s?){1,20})(.*?)(?:|)(?![^\x00-\x7F]*?[aA-zZ]*?\()/g,'<del rend="erasure">$1</del><gap reason="lost" extent="unknown" unit="character"/><del rend="erasure">$2</del>')).replace(/(?:\s)\[(.*?)\](?:\n)/g,' <supplied reason="lost">$1</supplied>\n')).replace(/(?:\s)\[(.*)\](?:\s)/g,' <supplied reason="lost">$1</supplied> ')).replace(/(?:\s)(?:|)(.*?)(?:|)(?:\n)/g,' <del rend="erasure">$1</del>\n')).replace(/(?:\s)(?:|)(.*?)(?:|)(?:\s)/g,' <del256 rend="erasure">$1</del> ')).replace(n,i),n=/([^\x00-\x7F]*[aA-zZ]*)(?:|)([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)(?:|)/g,i='<expan><abbr>$1<del rend="erasure">$2</del></abbr><ex>$3</ex></expan>',e=e.replace(n,i),n=/([^\x00-\x7F]*[aA-zZ]*)\[([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)(\s)?([^\x00-\x7F]*[aA-zZ]*)?(\s)?(\])/g,i='<expan><abbr>$1<supplied reason="lost">$2</supplied></abbr><ex>$3</ex></expan><supplied reason="lost">$4$5</supplied>',e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/([^\x00-\x7F]*?[aA-zZ]*?[^>])?\[([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\)(.*?[^\-\\])\](?![^\x00-\x7F]*?[aA-zZ]*\()/g,'<expan><abbr>$1<supplied reason="lost">$2</supplied></abbr><ex>$3</ex></expan> <supplied reason="lost">$4</supplied>')).replace(/([^\x00-\x7F]*?[aA-zZ]*?[^\s][^>])?(?:\s?)(?:|)([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\)(.*?[^\-\\])(?:|)(?![^\x00-\x7F]*?[aA-zZ]*\()/g,'<expan><abbr>$1<del rend="erasure">$2</del></abbr><ex>$3</ex></expan> <del rend="erasure">$4</del>')).replace(/([^\x00-\x7F]*?[aA-zZ]+)\[([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\)(.*?[^\-\\])([^\x00-\x7F]*?[aA-zZ]*?)\](?:([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\))/g,'<expan><abbr>$1<supplied reason="lost">$2</supplied></abbr><ex>$3</ex></expan> <supplied reason="lost">$4</supplied><expan><abbr><supplied reason="lost">$5</supplied>$6</abbr><ex>$7</ex></expan>')).replace(/([^\x00-\x7F]*?[aA-zZ]*?)(?:|)([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\)(.*?[^\-\\])([^\x00-\x7F]*?[aA-zZ]*?)(?:|)(?:([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\))/g,'<expan><abbr>$1<del rend="erasure">$2</del></abbr><ex>$3</ex></expan> <del rend="erasure">$4</del><expan><abbr><del rend="erasure">$5</del>$6</abbr><ex>$7</ex></expan>')).replace(/<supplied reason="lost"> (?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20} <\/supplied>/g,'<gap reason="lost" atLeast="$1" atMost="$2" unit="character"/>')).replace(/<supplied reason=\"lost\">(<gap reason=\"lost\" atLeast=\"[0-9]*\" atMost=\"[0-9]\" unit="character"\/>)<\/supplied>/g,"$1")).replace(/\[(.[^\[\-\\]*)\](?![^\x00-\x7F]*[aA-zZ]*\()/g,'<supplied reason="lost">$1</supplied>')).replace(/(?:|)(.[^\[]*)\](?![^\x00-\x7F]*[aA-zZ]*\()/g,'<del rend="erasure">$1</supplied>')).replace(/(?:\s)\[((.[^\.<])*)\s/g,' <supplied reason="lost"><expan><abbr>$1</abbr><ex>$2</ex></expan></supplied>')).replace(/(?!([^\x00-\x7F]*[aA-zZ]*))(\s)([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)\]/g,'$1<supplied reason="lost"><expan><abbr>$2</abbr><ex>$3</ex></expan></supplied>')).replace(/(\s)([^\x00-\x7F]*?[aA-zZ]*?)\]([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*[aA-zZ]*)\)/g,'$1</supplied><expan><abbr><supplied reason="lost">$2</supplied>$3</abbr><ex>$4</ex></expan>')).replace(/(\s)([^\x00-\x7F]+[aA-zZ]+)\[([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)/g,' <expan><abbr>$2<supplied reason="lost">$3</supplied></abbr><ex>$4</ex></expan> <supplied reason="lost">')).replace(/\[([^\x00-\x7F]*[aA-zZ]*)\(\?\)((\s?(\-|\|\)\s?){1,20})\]/g,'<supplied reason="lost" cert="low">$1</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[([^\x00-\x7F]*[aA-zZ]*)((\s?(\-|\|\)\s?){1,20})\]/g,'<supplied reason="lost">$1</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(n,i),n=/(||\[\[)([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)([^\x00-\x7F]*[aA-zZ]*)?(||]])/g,i='<del rend="erasure"><expan><abbr>$2</abbr><ex>$3</ex></expan>$4</del>',e=e.replace(n,i),n=/\[([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)(])/g,i='<supplied reason="lost"><expan><abbr>$1</abbr><ex>$2</ex></expan></supplied>',e=e.replace(n,i),n=/([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\?\)/g;e=e.replace(n,'<expan><abbr>$1</abbr><ex cert="low">$2</ex></expan>'),n=/([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)([^\x00-\x7F]*[aA-zZ]*)*\(([^\x00-\x7F]*[aA-zZ]*)\)/g,i="<expan><abbr>$1</abbr><ex>$2</ex><abbr>$3</abbr><ex>$4</ex></expan>",e=e.replace(n,i),n=/([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)([^\x00-\x7F]*[aA-zZ]*)*/g,i="<expan><abbr>$1</abbr><ex>$2</ex>$3</expan>";e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(n,i)).replace("</expan><expan><abbr>","<abbr>")).replace("\n[------]",'<gap unit="line" />')).replace(/(-){6}/g,'<gap unit="line" />')).replace(/\[(\s?)*\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[---\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[  ca\.([1-9][0-9]*)((-)([1-9][0-9]*))?  \]/g,'<gap reason="lost" quantity="$1" unit="character" precision="low"/>')).replace(/\[   ca\.([1-9][0-9]*)((-)([1-9][0-9]*))?   \]/g,'<gap reason="lost" quantity="$1" unit="character" precision="low"/>')).replace(/\[(-|\s?){1,20}ca\.(\s?)([1-9][0-9]*)?(\s?)(-|\s?){1,20}\]/g,'<gap reason="lost" quantity="$3" unit="character" precision="low"/>')).replace(/\------\?/g,'<gap reason="lost" extent="unknown" unit="line"><certainty match=".." locus="name"/></gap>')).replace(/\[\------\?\]/g,'<gap reason="lost" extent="unknown" unit="line"><certainty match=".." locus="name"/></gap>')).replace(/\[\---\?\]/g,'<gap reason="lost" extent="unknown" unit="line"><certainty match=".." locus="name"/></gap>')).replace(/\[(-||\\s?){1,20}([^\x00-\x7F]*[aA-zZ]*)\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[(-||\\s?){1,20}([^\x00-\x7F]*[aA-zZ]*)\]/g,'<gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">$2</supplied>')).replace(/(?:|)(-||\\s?){1,20}([^\x00-\x7F]*[aA-zZ]*)(?:|)/g,'<gap reason="lost" extent="unknown" unit="character"/><del rend="erasure">$2</supplied>')).replace(/\[(?!([\-\\]))(((?!([\-\\\[\]]))[^\x00-\x7F]*[aA-zZ]*(\s?)){1,10})(([\-\\])\s?){1,20}\]/g,'<supplied reason="lost">$2</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(/(([\-\\])\s?){1,20}\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/<expan><abbr>\[/g,'<supplied reason="lost"><expan><abbr>')).replace(/<\/expan> <\/supplied></g,"</expan></supplied> <")).replace(/<supplied reason=\"lost\"><expan><abbr>([^\x00-\x7F]*?[aA-zZ]*?)\]/g,'<expan><abbr><supplied reason="lost">$1</supplied>')).replace(/<expan><abbr><\/abbr><ex>/g,"<expan><ex>")).replace(/\[/g,'<supplied reason="lost">')).replace(/\]/g,"</supplied>")).replace(/<\/ex><\/supplied><\/expan>/g,"</ex></expan></supplied>")).replace(/((\s?(\-|\|\)\s?){1,20})<\/supplied>/g,'</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(/((\s?(\-|\|\)\s?){1,20})<\/supplied>/g,'</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(/<supplied reason=\"lost\">((\s?(\-|\|\)\s?){1,20})/g,'<gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">')).replace(/<supplied reason=\"lost\"><\/supplied><gap reason=\"lost\" extent=\"unknown\" unit=\"character\"\/><supplied reason=\"lost\"><\/supplied>/g,'</supplied><gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">')).replace(/<supplied reason=\"lost\"> <\/supplied>/g,"")).replace(/<del rend=\"erasure\">\s?<\/del>/g,"")).replace(/<\/supplied>\s?<\/supplied>/g,"</supplied>")).replace(/\/><\/supplied><gap/g,"/><gap")).replace(/\[(?!([\-\\]))((?:\s?(?:(?!(?:[\-\\\[\]]))[^\x00-\x7F]*[aA-zZ](?!\s)*)){1,10})(?:(?:\s?[\-\\])\s?){1,20}((?:(?!([\-\\\[\]]))[^\x00-\x7F]*[aA-zZ]*))\]/g,'<supplied reason="lost">$2</supplied><gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">$3</supplied>')).replace(/(\s?([\-\\])\s?){1,20}/g,'</supplied><gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">')).replace(/\[(.[^\[]*)(\s)([^\x00-\x7F]*[aA-zZ]*)\]([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)/g,'<supplied reason="lost">$1</supplied><expan><abbr><supplied reason="lost">$3</supplied>$4</abbr><ex>$5</ex></expan>')).replace(/([+])+/g,(function(e){return'<gap reason="illegible" quantity="'+e.length+'" unit="character"/>'}));e=e.replace(/\[({1,20})\]/g,(function(e){return'<gap reason="illegible" quantity="'+(e.length-2)+'" unit="character"/>'}));n=/()(([^\x00-\x7F]*[aA-zZ]*)([\s\,\.]([^\x00-\x7F]*[aA-zZ]*))*)()/gm,i='<del rend="erasure">$2</del>',e=(e=(e=(e=(e=e.replace(/<supplied reason=\"lost\"> <gap/g," <gap")).replace(/(hed\.)/gi,'<g type="hedera"></g>')).replace(/vac\./gi,'<space extent="unknown" unit="character"/>')).replace(/\{([^\x00-\x7F]*[aA-zZ]*)\}/g,"<surplus>$1</surplus>")).replace(n,i),n=/()(([^\x00-\x7F]*[aA-zZ]*)([\s\,\.]([^\x00-\x7F]*[aA-zZ]*))*)()/gm,i='<del rend="erasure">$2</del>',e=e.replace(n,i),n=/(\[){2}(([^\x00-\x7F]*[aA-zZ]*)([\s\,\.]([^\x00-\x7F]*[aA-zZ]*))*)(\]){2}/gm,i='<del rend="erasure">$2</del>';e=(e=e.replace(n,i)).replace(/(\[)(([^\x00-\x7F]*[aA-zZ]*)([\s\,\.]([^\x00-\x7F]*[aA-zZ]*))*)(\])/gm,'<supplied reason="lost">$2</supplied>'),n=new RegExp("a","u");return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/(\[)([^\x00-\x7F]*[aA-zZ]*\s?[^\x00-\x7F]*[aA-zZ]*)(---)?(\])/g,'<supplied reason="lost">$2</supplied><gap reason="lost" />')).replace(/([^\x00-\x7F]?[aA-zZ]?)/g,"<unclear>$1</unclear>")).replace(/(\<\/unclear\>\<unclear\>)/g,"")).replace(/(<gap reason=\"lost\" atLeast=\"[0-9]*\" atMost=\"[0-9]\" unit=\"character\"\/>)<expan><abbr>((?:[^\x00-\x7F]*?[aA-zZ]*?)*)<\/supplied>/g,'$1<expan><abbr><supplied reason="lost">$2</supplied>')).replace(/(<gap reason=\"lost\" atLeast=\"[0-9]*\" atMost=\"[0-9]\" unit=\"character\"\/>)<\/supplied>/g,"$1")).replace(/(<gap reason=\"lost\" atLeast=\"[0-9]*\" atMost=\"[0-9]\" unit=\"character\"\/>)<expan><abbr>((?:[^\x00-\x7F]*?[aA-zZ]*?)*)<\/supplied>/g,'$1<expan><abbr><supplied reason="lost">$2</supplied>')).replace(/(<gap reason=\"lost\" quantity=\"[0-9]*\" unit=\"character\" precision=\"low\"\/>)<\/supplied>/g,"$1")).replace(/(\/\>)\s(\<lb n=\"[0-9]*\"\/\>)/g,"$1\n$2")).replace(/unit=\"line\"\/>\s(\w)/g,'unit="line"/>$1')).replace(/ ? ?/g,' <g type="interpunct"></g> ')).replace(/ ? ?/g,' <g type="denarius"/> ')).replace(//g,' <g type="hedera"></g> ')).replace(/\s\s/g," ")).replace(/ {2,99}/g,"")}var lf=(e,t)=>n=>{let i=function(e,t){let n=`<ab>${af(e,t)}\n</ab>`,i=(new DOMParser).parseFromString(n,"application/xml");return i.firstElementChild?nf(i.firstElementChild):""}(n.state.doc.toJSON().join("\n"),t);return e.content=i,e.mode="leiden_plus",!0},hf={erasure:Rp("[[","]]"),gap:(e=>t=>(t.dispatch(t.state.changeByRange((t=>({changes:[{from:t.from,insert:e}],range:D.range(t.from,t.from)})))),!0))("[---]")},cf=[{key:"Ctrl-Shift-d",mac:"Cmd-Shift-d",run:hf.erasure},{key:"Ctrl-Shift-l",mac:"Cmd-Shift-l",run:hf.gap}],uf=class extends Bp{constructor(e,t){super(e),this._sourceType=t}getExtensions(){return[Xr.of(cf),Ud()]}getCommands(){return((e,i)=>t(e,n(i)))(((e,t)=>{for(var n in t||(t={}))r.call(t,n)&&o(e,n,t[n]);if(i)for(var n of i(t))s.call(t,n)&&o(e,n,t[n]);return e})({},hf),{convert:lf(this.editor,this._sourceType)})}onUpdate(e,t){return`<ab>\n${af(t,this._sourceType)}\n</ab>`}serialize(){return this.editor.content}setFromValue(e){if(!e)return"";if("string"!=typeof e)throw new Error("cannot set value");return e}},df=class extends HTMLElement{constructor(){super(),this._mode="xml",this.attachShadow({mode:"open"})}connectedCallback(){var e,t,n,i;let r=document.createElement("style");r.innerHTML=this.styles(),null==(e=this.shadowRoot)||e.appendChild(r);let s=document.createElement("slot");s.name="toolbar",null==(t=this.shadowRoot)||t.appendChild(s);let o=document.createElement("div");o.id="editor",null==(n=this.shadowRoot)||n.appendChild(o),this.registerToolbar(null==(i=this.shadowRoot)?void 0:i.querySelector("[name=toolbar]")),this.namespace=this.getAttribute("namespace"),this.mode=this.initModes()||this.getAttribute("mode")||"xml",this.addEventListener("blur",(e=>{let t=e.relatedTarget;if(t){let n=t.parentNode;for(;n;){if(n===this)return e.preventDefault(),void e.stopPropagation();n=n.parentNode}}}))}focus(){this._editor&&this._editor.focus()}set mode(e){var t,n,i;let r=null==(t=this.shadowRoot)?void 0:t.getElementById("editor");if(!r)return;this._editor&&this._editor.destroy(),this._mode=Qp[e],this.activateToolbar(null==(n=this.shadowRoot)?void 0:n.querySelector("[name=toolbar]")),this.configure();let s=this.querySelector("[name=modes]");s&&s instanceof HTMLSelectElement&&(s.value=this._mode);let o=null==(i=this._config)?void 0:i.getConfig();this._editor=new $r({state:Te.create(o),parent:r}),this._config&&(this.content=this._config.setFromValue(this._value))}configure(){switch(this._mode){case"default":case"edcs":case"phi":this._config=new uf(this,this._mode);break;case"leiden_plus":this._config=new of(this);break;default:this._config=new qp(this,this.namespace)}}get mode(){return this._mode}set valid(e){this.setAttribute("valid",e.toString())}get valid(){return Boolean(this.hasAttribute("valid"))}set content(e){this._editor&&this._editor.dispatch({changes:{from:0,to:this._editor.state.doc.length,insert:e}})}get content(){var e;return(null==(e=this._editor)?void 0:e.state.doc.toString())||""}set value(e){var t;this.setValue(e)&&this._editor&&this._config&&(this.content=null==(t=this._config)?void 0:t.setFromValue(this._value))}get value(){return this.getValue()}setValue(e){if(!this._config)return!1;let t=this._config.setFromValue(e);return this._value!==t&&(this._value=e,!0)}getValue(){return this._value?this._value:null}emitUpdateEvent(e){this.dispatchEvent(new CustomEvent("update",{detail:{content:e},composed:!0,bubbles:!0}))}initModes(){let e=this.querySelector("[name=modes]");return e&&e instanceof HTMLSelectElement?(e.addEventListener("change",(()=>{this.mode=e.value})),e.value):null}registerToolbar(e){null==e||e.assignedElements().forEach((e=>{e.querySelectorAll("slot").forEach((e=>this.registerToolbar(e))),e.querySelectorAll("[data-command]").forEach((e=>{let t=e.dataset.command;e.addEventListener("click",(()=>{var n,i;if(!this._config)return;let r=this._config.getCommands()[t];if(r)if(r instanceof Function)r(this._editor),"encloseWithCommand"!==r.name&&(null==(n=this._editor)||n.focus());else{let t=e.dataset.params,n=r.create;if(t){let e;try{e=JSON.parse(t)}catch(n){e=[t]}Array.isArray(e)&&e.length===n.length&&n.apply(null,e)(this._editor)}null==(i=this._editor)||i.focus()}}))}))}))}activateToolbar(e){null==e||e.assignedElements().forEach((e=>{e.querySelectorAll("slot").forEach((e=>this.activateToolbar(e))),e.querySelectorAll("[data-command]").forEach((e=>{let t=e;t.dataset.mode&&t.dataset.mode!==this._mode?t.style.display="none":t.style.display="inline"}))}))}styles(){return"\n            > div, .cm-editor {\n                height: 100%;\n                width: 100%;\n            }\n        "}};window.customElements.define("jinn-codemirror",df);customElements.get("jinn-xml-editor")||window.customElements.define("jinn-xml-editor",class extends df{constructor(){super(...arguments),this.unwrap=!1}connectedCallback(){this.unwrap=this.hasAttribute("unwrap"),super.connectedCallback();let e=this.getAttribute("wrapper");if(e){let t=(new DOMParser).parseFromString(e,"application/xml");t.getElementsByTagName("parsererror").length||this.setValue(t.firstElementChild)}}configure(){let e=this.hasAttribute("check-namespace");this._config=new qp(this,this.namespace,e,this.unwrap)}emitUpdateEvent(e){if(!this.unwrap)return super.emitUpdateEvent(e);this.updateValue(),super.emitUpdateEvent(this._wrapper)}updateValue(){var e,t;if(!this._wrapper)return null;if(this._wrapper.replaceChildren(),this._value)if(this._value instanceof NodeList)for(let t=0;t<this._value.length;t++){let n=this._wrapper.ownerDocument.importNode(this._value[t],!0);null==(e=this._wrapper)||e.appendChild(n)}else{if(!(this._value instanceof Node))throw new Error("value is not a node");null==(t=this._wrapper)||t.appendChild(this._value)}else;}setValue(e){var t,n;if(!this.unwrap)return super.setValue(e);if((null==(t=this._config)?void 0:t.setFromValue(this._wrapper))===(null==(n=this._config)?void 0:n.setFromValue(e)))return!1;if(e||(this._wrapper=null),!(e instanceof Element))throw new Error("Value is not a node");return this._wrapper=e,this._value=e.childNodes,!0}getValue(){if(!this.unwrap)return super.getValue();if(!this._wrapper)return null;if(!(this._wrapper instanceof Element))throw new Error("Value is not a node");return this.updateValue(),this._wrapper}});var pf=class extends HTMLElement{constructor(){super(),this.xmlEditor=null,this.valid=!0,this.unwrap=!1,this.schema=null,this.attachShadow({mode:"open"})}set value(e){this.xmlEditor.value=e}get value(){return this.xmlEditor.value}connectedCallback(){var e,t,n,i;this.unwrap=this.hasAttribute("unwrap"),this.schema=this.getAttribute("schema"),this.shadowRoot.innerHTML=`\n            <style>\n                \n    :host{\n        display: block;\n        width: 100%;\n    }\n    jinn-codemirror {\n        font-size: 1rem;\n        display:block;\n        width:100%;\n    }\n    jinn-codemirror[valid="true"] {\n        outline: thin solid green;\n    }\n    jinn-codemirror[valid="false"] {\n        outline: thin solid red;\n    }\n    #leiden-editor {\n        margin-bottom:0.5rem;\n    }\n    [slot=toolbar] {\n        display: flex;\n    }\n    .hidden {\n        display: none;\n    }\n    #close-leiden {\n        margin-left: .75rem;\n        font-weight: bold;\n    }\n            </style>\n            <jinn-codemirror id="leiden-editor" class="hidden">\n                <div slot="toolbar">\n                    <select name="modes">\n                        <option value="edcs" selected>EDCS/EDH</option>\n                        <option value="default">Petrae</option>\n                        <option value="leiden_plus">Leiden+</option>\n                    </select>\n                    <slot name="leiden-toolbar"></slot>\n                    <button part="button" id="close-leiden">Close</button>\n                </div>\n            </jinn-codemirror>\n            <jinn-xml-editor id="xml-editor" ${this.unwrap?"unwrap":""} schema="${this.schema}">\n                <div slot="toolbar">\n                    <button part="button" id="import" title="Import from Leiden markup">Leiden Editor</button>\n                    <slot name="xml-toolbar"></slot>\n                </div>\n            </jinn-xml-editor>\n        `,this.xmlEditor=null==(e=this.shadowRoot)?void 0:e.querySelector("#xml-editor");let r=null==(t=this.shadowRoot)?void 0:t.querySelector("#leiden-editor"),s=null==(n=this.shadowRoot)?void 0:n.querySelector("#import"),o=null==(i=this.shadowRoot)?void 0:i.querySelector("#close-leiden");if(!(this.xmlEditor&&r&&s&&o))throw new Error("One or more components were not initialized");r.addEventListener("update",(e=>{e.stopPropagation(),this.xmlEditor.content=e.detail.content})),s.addEventListener("click",(()=>{var e;if(r.classList.contains("hidden")){if(this.xmlEditor.content.length>0){r.mode="leiden_plus";let t=null==(e=this.xmlEditor)?void 0:e.value;this.unwrap&&t instanceof Element?r.value=t.childNodes:r.value=t}r.classList.remove("hidden"),r.focus(),s.classList.add("hidden")}else r.classList.add("hidden"),s.classList.remove("hidden"),this.xmlEditor.focus()})),o.addEventListener("click",(()=>{s.classList.remove("hidden"),r.classList.add("hidden"),this.xmlEditor.focus()})),this.xmlEditor.addEventListener("invalid",(e=>{e.stopPropagation(),this.valid=!1,this.setAttribute("valid",this.valid.toString())})),this.xmlEditor.addEventListener("valid",(e=>{e.stopPropagation(),this.valid=!0,this.setAttribute("valid",this.valid.toString())}))}};customElements.get("jinn-epidoc-editor")||window.customElements.define("jinn-epidoc-editor",pf)})();class ys{constructor(){this.program=[]}test(e,t){return gs(this.program,5,e,void 0===t?null:t)}jump(e){return gs(this.program,3,null,e)}record(e,t){return gs(this.program,4,void 0===t?Os:t,e)}bad(e=1){return gs(this.program,1,null,e)}accept(){return gs(this.program,0,null,null)}fail(e){return gs(this.program,2,e||null,null)}}class vs{constructor(e,t,n){this.programLength=e,this.maxFromByPc=t,this.maxSurvivorFromByPc=n}static fromProgram(e){const t=e.length,n=[],i=[];return e.forEach((e=>{n.push(0),i.push(0)})),e.forEach(((e,r)=>{switch(e.op){case 2:if(null===e.func)return;if(r+1>=t)throw new Error("Invalid program: program could run past end");n[r+1]+=1;break;case 1:case 4:if(r+1>=t)throw new Error("Invalid program: program could run past end");n[r+1]+=1;break;case 3:e.data.forEach((e=>{if(e<0||e>=t)throw new Error("Invalid program: program could run past end");n[e]+=1}));break;case 5:if(r+1>=t)throw new Error("Invalid program: program could run past end");i[r+1]+=1;break;case 0:i[r]+=1}})),new vs(t,n,i)}static createStub(e){const t=[],n=[];for(let i=0;i<e;++i)t.push(e),n.push(e);return new vs(e,t,n)}}class bs{constructor(e){this.acceptingTraces=e,this.success=e.length>0}}class ws{constructor(e){this.t=0,this.i=0,this.h=new Uint16Array(e),this.l=new Uint8Array(e)}getBadness(e){return this.l[e]}add(e,t){this.l[e]=t>255?255:t;const n=function(e,t,n,i,r){let s=i,o=r;for(;s<o;){const i=s+o>>>1;n<t[e[i]]?o=i:s=i+1}return s}(this.h,this.l,t,this.i,this.t);this.h.copyWithin(n+1,n,this.t),this.h[n]=e,this.t+=1}reschedule(e,t){const n=Math.max(this.l[e],t>255?255:t);if(this.l[e]!==n){const t=this.h.indexOf(e,this.i);if(t<0||t>=this.t)return void(this.l[e]=n);this.h.copyWithin(t,t+1,this.t),this.t-=1,this.add(e,n)}}getNextPc(){return this.i>=this.t?null:this.h[this.i++]}reset(){this.t=0,this.i=0,this.l.fill(0)}}class xs{constructor(e){this.o=[];let t=e.length;e.forEach((e=>{this.o.push(e>0?t:-1),t+=e})),this.u=new Uint16Array(t)}clear(){this.u.fill(0,0,this.o.length)}add(e,t){const n=this.u[t],i=this.o[t];this.u[t]+=1,this.u[i+n]=e}has(e){return this.u[e]>0}forEach(e,t){const n=this.u[e],i=this.o[e];for(let e=i;e<i+n;++e)t(this.u[e])}}function Ss(e,t,n=!1){return null===e?t:Array.isArray(e)?(-1===e.indexOf(t)&&(n&&(e=e.slice()),e.push(t)),e):e===t?e:[e,t]}class ks{constructor(e,t){this.prefixes=e,this.record=t}}function As(e,t){let n;if(null===t){if(!Array.isArray(e))return e;n=e}else n=e===ks.EMPTY?[]:Array.isArray(e)?e:[e];return new ks(n,t)}ks.EMPTY=new ks([],null);class Cs{constructor(e){this.p=[],this.v=[];for(let t=0;t<e;++t)this.p.push(0),this.v.push(null)}mergeTraces(e,t,n,i,r,s){let o=!1;return n.forEach(t,(t=>{const n=this.trace(t,i,r,s);var a,l,h;l=n,h=o,e=null===(a=e)?l:null===l?a:Array.isArray(l)?l.reduce(((e,t)=>Ss(e,t,e===l)),a):Ss(a,l,h),o=e===n})),e}trace(e,t,n,i){switch(this.p[e]){case 2:return this.v[e];case 1:return null}this.p[e]=1;let r=null;const s=t[e];if(null!==s)r=s;else if(!n.has(e))throw new Error("Trace without source at pc "+e);if(r=this.mergeTraces(r,e,n,t,n,i),null!==r){const t=i[e];null!==t&&(r=As(r,t))}return this.v[e]=r,this.p[e]=2,r}buildSurvivorTraces(e,t,n,i,r){for(let s=0,o=e.length;s<o;++s){if(!n.has(s)){t[s]=null;continue}this.v.fill(null),this.p.fill(0);const o=this.mergeTraces(null,s,n,e,i,r);if(null===o)throw new Error("No non-cyclic paths found to survivor "+s);t[s]=As(o,null)}this.v.fill(null)}}class _s{constructor(e){this.g=[],this.k=[],this.m=[],this.A=new xs(e.maxFromByPc),this.T=new xs(e.maxSurvivorFromByPc),this.S=new Cs(e.programLength);for(let t=0;t<e.programLength;++t)this.g.push(null),this.k.push(null),this.m.push(null);this.k[0]=ks.EMPTY}reset(e){this.A.clear(),this.T.clear(),this.g.fill(null),e&&(this.k.fill(null),this.m.fill(null),this.k[0]=ks.EMPTY)}record(e,t){this.g[e]=t}has(e){return this.A.has(e)||null!==this.k[e]}add(e,t){this.A.add(e,t)}hasSurvivor(e){return this.T.has(e)}addSurvivor(e,t){this.T.add(e,t)}buildSurvivorTraces(){const e=this.k;this.S.buildSurvivorTraces(e,this.m,this.T,this.A,this.g),this.k=this.m,this.m=e}getTraces(e){const t=e.reduce(((e,t)=>Ss(e,this.k[t])),null);return null===t?[]:Array.isArray(t)?t:[t]}}class Es{constructor(e){this.I=[],this.N=new ws(e.programLength),this.M=new ws(e.programLength),this.P=new _s(e)}reset(){this.N.reset(),this.N.add(0,0),this.I.length=0,this.P.reset(!0)}getNextThreadPc(){return this.N.getNextPc()}step(e,t,n){const i=this.P.has(t);this.P.add(e,t);const r=this.N.getBadness(e)+n;i?this.N.reschedule(t,r):this.N.add(t,r)}stepToNextGeneration(e,t){const n=this.P.hasSurvivor(t);this.P.addSurvivor(e,t);const i=this.N.getBadness(e);n?this.M.reschedule(t,i):this.M.add(t,i)}accept(e){this.I.push(e),this.P.addSurvivor(e,e)}fail(e){}record(e,t){this.P.record(e,t)}nextGeneration(){this.P.buildSurvivorTraces(),this.P.reset(!1);const e=this.N;e.reset(),this.N=this.M,this.M=e}getAcceptingTraces(){return this.P.getTraces(this.I)}}class Ts{constructor(e){this.U=[],this.G=e,this.V=vs.fromProgram(e),this.U.push(new Es(this.V))}execute(e,t){const n=this.U.pop()||new Es(this.V);n.reset();const i=e.length;let r,s=-1;do{let o=n.getNextThreadPc();if(null===o)break;for(++s,r=s>=i?null:e[s];null!==o;){const e=this.G[o];switch(e.op){case 0:null===r?n.accept(o):n.fail(o);break;case 2:{const i=e.func;if(null===i||i(t)){n.fail(o);break}n.step(o,o+1,0);break}case 1:n.step(o,o+1,e.data);break;case 5:if(null===r){n.fail(o);break}if(!(0,e.func)(r,e.data,t)){n.fail(o);break}n.stepToNextGeneration(o,o+1);break;case 3:{const t=e.data,i=t.length;if(0===i){n.fail(o);break}for(let e=0;e<i;++e)n.step(o,t[e],0);break}case 4:{const i=(0,e.func)(e.data,s,t);null!=i&&n.record(o,i),n.step(o,o+1,0);break}}o=n.getNextThreadPc()}n.nextGeneration()}while(null!==r);const o=new bs(n.getAcceptingTraces());return n.reset(),this.U.push(n),o}}function Ps(e){return t=>t===e}function $s(e,t){if(null===e||null===t)throw new Error("unescaped hyphen may not be used as a range endpoint");if(t<e)throw new Error("character range is in the wrong order");return n=>e<=n&&n<=t}function Ns(e){return!0}function Is(){return!1}function Qs(e,t){return n=>e(n)||t(n)}function Rs(e,t){switch(t.kind){case"predicate":return void e.test(t.value);case"regexp":return void Ms(e,t.value,!1)}}function Ms(e,t,n){const i=e.program.length,r=e.jump([]);n&&(r.data.push(e.program.length),e.test((()=>!0)),e.jump([i]));const s=[];if(t.forEach((t=>{r.data.push(e.program.length),function(e,t){t.forEach((t=>{!function(e,t){const[n,{min:i,max:r}]=t;if(null!==r){for(let t=0;t<i;++t)Rs(e,n);for(let t=i;t<r;++t){const t=e.jump([]);t.data.push(e.program.length),Rs(e,n),t.data.push(e.program.length)}}else if(i>0){for(let t=0;t<i-1;++t)Rs(e,n);const t=e.program.length;Rs(e,n),e.jump([t]).data.push(e.program.length)}else{const t=e.program.length,i=e.jump([]);i.data.push(e.program.length),Rs(e,n),e.jump([t]),i.data.push(e.program.length)}}(e,t)}))}(e,t),s.push(e.jump([]))})),s.forEach((t=>{t.data.push(e.program.length)})),n){const t=e.program.length,n=e.jump([]);n.data.push(e.program.length),e.test((()=>!0)),e.jump([t]),n.data.push(e.program.length)}}function Bs(e,t){return{success:!0,offset:e,value:t}}function Ds(e){return Bs(e,void 0)}function Xs(e,t,n=!1){return{success:!1,offset:e,expected:t,fatal:n}}function Fs(e){return(t,n)=>{const i=n+e.length;return t.slice(n,i)===e?Bs(i,e):Xs(n,[e])}}function Ls(e,t){return(n,i)=>{const r=e(n,i);return r.success?Bs(r.offset,t(r.value)):r}}function Us(e,t,n,i){return(r,s)=>{const o=e(r,s);return o.success?t(o.value)?o:Xs(s,n,i):o}}function Vs(e,t){return(n,i)=>{let r=null;for(const s of e){const e=s(n,i);if(e.success)return e;if(null===r||e.offset>r.offset?r=e:e.offset===r.offset&&void 0===t&&(r.expected=r.expected.concat(e.expected)),e.fatal)return e}return t=t||(null==r?void 0:r.expected)||[],r&&(r.expected=t),r||Xs(i,t)}}function zs(e){return(t,n)=>{const i=e(t,n);return i.success||i.fatal?i:Bs(n,null)}}function Zs(e){return(t,n)=>{let i=[],r=n;for(;;){const n=e(t,r);if(!n.success){if(n.fatal)return n;break}if(i.push(n.value),n.offset===r)break;r=n.offset}return Bs(r,i)}}function js(e,t,n){return(i,r)=>{const s=e(i,r);if(!s.success)return s;const o=t(i,s.offset);return o.success?Bs(o.offset,n(s.value,o.value)):o}}function qs(e){return js(e,Zs(e),((e,t)=>[e].concat(t)))}function Gs(e,t){return e}function Ws(e,t){return t}function Hs(e,t){return js(e,t,Ws)}function Ys(e,t){return js(e,t,Gs)}function Js(e,t,n,i=!1){return Hs(e,i?eo(Ys(t,n)):Ys(t,n))}function Ks(e,t){return(n,i)=>e(n,i).success?Xs(i,t):Ds(i)}function eo(e){return(t,n)=>{const i=e(t,n);return i.success?i:Xs(i.offset,i.expected,!0)}}const to=(e,t)=>e.length===t?Ds(t):Xs(t,["end of input"]),no=["Lu","Ll","Lt","Lm","Lo","Mn","Mc","Me","Nd","Nl","No","Pc","Pd","Ps","Pe","Pi","Pf","Po","Zs","Zl","Zp","Sm","Sc","Sk","So","Cc","Cf","Co","Cn"],io={};function ro(e){return e.codePointAt(0)}"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("").forEach(((e,t)=>{io[e]=t}));const so=e=>-1===e||-2===e;function oo(e){return t=>!so(t)&&!e(t)}function ao(e,t){return null===t?e:n=>e(n)&&!t(n)}const lo=function(e,t){const n=new Map;let i=0;return["BasicLatin","Latin-1Supplement","LatinExtended-A","LatinExtended-B","IPAExtensions","SpacingModifierLetters","CombiningDiacriticalMarks","GreekandCoptic|Greek","Cyrillic","CyrillicSupplement","Armenian","Hebrew","Arabic","Syriac","ArabicSupplement","Thaana","NKo","Samaritan","Mandaic","SyriacSupplement","ArabicExtended-B","ArabicExtended-A","Devanagari","Bengali","Gurmukhi","Gujarati","Oriya","Tamil","Telugu","Kannada","Malayalam","Sinhala","Thai","Lao","Tibetan","Myanmar","Georgian","HangulJamo","Ethiopic","EthiopicSupplement","Cherokee","UnifiedCanadianAboriginalSyllabics","Ogham","Runic","Tagalog","Hanunoo","Buhid","Tagbanwa","Khmer","Mongolian","UnifiedCanadianAboriginalSyllabicsExtended","Limbu","TaiLe","NewTaiLue","KhmerSymbols","Buginese","TaiTham","CombiningDiacriticalMarksExtended","Balinese","Sundanese","Batak","Lepcha","OlChiki","CyrillicExtended-C","GeorgianExtended","SundaneseSupplement","VedicExtensions","PhoneticExtensions","PhoneticExtensionsSupplement","CombiningDiacriticalMarksSupplement","LatinExtendedAdditional","GreekExtended","GeneralPunctuation","SuperscriptsandSubscripts","CurrencySymbols","CombiningDiacriticalMarksforSymbols|CombiningMarksforSymbols","LetterlikeSymbols","NumberForms","Arrows","MathematicalOperators","MiscellaneousTechnical","ControlPictures","OpticalCharacterRecognition","EnclosedAlphanumerics","BoxDrawing","BlockElements","GeometricShapes","MiscellaneousSymbols","Dingbats","MiscellaneousMathematicalSymbols-A","SupplementalArrows-A","BraillePatterns","SupplementalArrows-B","MiscellaneousMathematicalSymbols-B","SupplementalMathematicalOperators","MiscellaneousSymbolsandArrows","Glagolitic","LatinExtended-C","Coptic","GeorgianSupplement","Tifinagh","EthiopicExtended","CyrillicExtended-A","SupplementalPunctuation","CJKRadicalsSupplement","KangxiRadicals",null,"IdeographicDescriptionCharacters","CJKSymbolsandPunctuation","Hiragana","Katakana","Bopomofo","HangulCompatibilityJamo","Kanbun","BopomofoExtended","CJKStrokes","KatakanaPhoneticExtensions","EnclosedCJKLettersandMonths","CJKCompatibility","CJKUnifiedIdeographsExtensionA","YijingHexagramSymbols","CJKUnifiedIdeographs","YiSyllables","YiRadicals","Lisu","Vai","CyrillicExtended-B","Bamum","ModifierToneLetters","LatinExtended-D","SylotiNagri","CommonIndicNumberForms","Phags-pa","Saurashtra","DevanagariExtended","KayahLi","Rejang","HangulJamoExtended-A","Javanese","MyanmarExtended-B","Cham","MyanmarExtended-A","TaiViet","MeeteiMayekExtensions","EthiopicExtended-A","LatinExtended-E","CherokeeSupplement","MeeteiMayek","HangulSyllables","HangulJamoExtended-B","HighSurrogates","HighPrivateUseSurrogates","LowSurrogates","PrivateUseArea|PrivateUse","CJKCompatibilityIdeographs","AlphabeticPresentationForms","ArabicPresentationForms-A","VariationSelectors","VerticalForms","CombiningHalfMarks","CJKCompatibilityForms","SmallFormVariants","ArabicPresentationForms-B","HalfwidthandFullwidthForms","Specials","LinearBSyllabary","LinearBIdeograms","AegeanNumbers","AncientGreekNumbers","AncientSymbols","PhaistosDisc",null,"Lycian","Carian","CopticEpactNumbers","OldItalic","Gothic","OldPermic","Ugaritic","OldPersian",null,"Deseret","Shavian","Osmanya","Osage","Elbasan","CaucasianAlbanian","Vithkuqi",null,"LinearA","LatinExtended-F",null,"CypriotSyllabary","ImperialAramaic","Palmyrene","Nabataean",null,"Hatran","Phoenician","Lydian",null,"MeroiticHieroglyphs","MeroiticCursive","Kharoshthi","OldSouthArabian","OldNorthArabian",null,"Manichaean","Avestan","InscriptionalParthian","InscriptionalPahlavi","PsalterPahlavi",null,"OldTurkic",null,"OldHungarian","HanifiRohingya",null,"RumiNumeralSymbols","Yezidi","ArabicExtended-C","OldSogdian","Sogdian","OldUyghur","Chorasmian","Elymaic","Brahmi","Kaithi","SoraSompeng","Chakma","Mahajani","Sharada","SinhalaArchaicNumbers","Khojki",null,"Multani","Khudawadi","Grantha",null,"Newa","Tirhuta",null,"Siddham","Modi","MongolianSupplement","Takri",null,"Ahom",null,"Dogra",null,"WarangCiti","DivesAkuru",null,"Nandinagari","ZanabazarSquare","Soyombo","UnifiedCanadianAboriginalSyllabicsExtended-A","PauCinHau","DevanagariExtended-A",null,"Bhaiksuki","Marchen",null,"MasaramGondi","GunjalaGondi",null,"Makasar","Kawi",null,"LisuSupplement","TamilSupplement","Cuneiform","CuneiformNumbersandPunctuation","EarlyDynasticCuneiform",null,"Cypro-Minoan","EgyptianHieroglyphs","EgyptianHieroglyphFormatControls",null,"AnatolianHieroglyphs",null,"BamumSupplement","Mro","Tangsa","BassaVah","PahawhHmong",null,"Medefaidrin",null,"Miao",null,"IdeographicSymbolsandPunctuation","Tangut","TangutComponents","KhitanSmallScript","TangutSupplement",null,"KanaExtended-B","KanaSupplement","KanaExtended-A","SmallKanaExtension","Nushu",null,"Duployan","ShorthandFormatControls",null,"ZnamennyMusicalNotation",null,"ByzantineMusicalSymbols","MusicalSymbols","AncientGreekMusicalNotation",null,"KaktovikNumerals","MayanNumerals","TaiXuanJingSymbols","CountingRodNumerals",null,"MathematicalAlphanumericSymbols","SuttonSignWriting",null,"LatinExtended-G","GlagoliticSupplement","CyrillicExtended-D",null,"NyiakengPuachueHmong",null,"Toto","Wancho",null,"NagMundari",null,"EthiopicExtended-B","MendeKikakui",null,"Adlam",null,"IndicSiyaqNumbers",null,"OttomanSiyaqNumbers",null,"ArabicMathematicalAlphabeticSymbols",null,"MahjongTiles","DominoTiles","PlayingCards","EnclosedAlphanumericSupplement","EnclosedIdeographicSupplement","MiscellaneousSymbolsandPictographs","Emoticons","OrnamentalDingbats","TransportandMapSymbols","AlchemicalSymbols","GeometricShapesExtended","SupplementalArrows-C","SupplementalSymbolsandPictographs","ChessSymbols","SymbolsandPictographsExtended-A","SymbolsforLegacyComputing",null,"CJKUnifiedIdeographsExtensionB",null,"CJKUnifiedIdeographsExtensionC","CJKUnifiedIdeographsExtensionD","CJKUnifiedIdeographsExtensionE","CJKUnifiedIdeographsExtensionF",null,"CJKCompatibilityIdeographsSupplement",null,"CJKUnifiedIdeographsExtensionG","CJKUnifiedIdeographsExtensionH",null,"Tags",null,"VariationSelectorsSupplement",null,"SupplementaryPrivateUseArea-A|PrivateUse","SupplementaryPrivateUseArea-B|PrivateUse"].forEach(((e,r)=>{const s=t[r];null!==e&&e.split("|").forEach((e=>{const t=n.get(e),r=$s(i,i+s-1);n.set(e,t?Qs(t,r):r)})),i+=s})),n}(0,[128,128,128,208,96,80,112,144,256,48,96,112,256,80,48,64,64,64,32,16,48,96,128,128,128,128,128,128,128,128,128,128,128,128,256,160,96,256,384,32,96,640,32,96,32,32,32,32,128,176,80,80,48,96,32,32,144,80,128,64,64,80,48,16,48,16,48,128,64,64,256,256,112,48,48,48,80,64,112,256,256,64,32,160,128,32,96,256,192,48,16,256,128,128,256,256,96,32,128,48,80,96,32,128,128,224,16,16,64,96,96,48,96,16,32,48,16,256,256,6592,64,20992,1168,64,48,320,96,96,32,224,48,16,64,96,32,48,48,32,96,32,96,32,96,32,48,64,80,64,11184,80,896,128,1024,6400,512,80,688,16,16,16,32,32,144,240,16,128,128,64,80,64,48,128,32,64,32,48,32,48,32,64,32,80,48,48,80,48,64,80,64,384,64,64,64,32,32,48,48,32,32,32,64,32,96,96,32,32,32,64,64,32,32,48,80,80,48,128,64,288,32,64,64,48,64,64,48,32,128,80,48,80,48,96,32,80,48,48,80,128,128,128,96,160,128,96,32,80,48,80,176,80,80,96,96,64,96,80,96,16,64,96,160,112,80,64,96,80,304,32,96,80,16,64,1024,128,208,2624,112,1072,48,4e3,640,8576,576,48,96,48,144,688,96,96,160,64,32,6144,768,512,128,8816,16,256,48,64,400,2304,160,16,4688,208,48,256,256,80,112,32,32,96,32,128,1024,688,1104,256,48,96,112,80,320,48,64,464,48,736,32,224,32,96,784,80,64,80,176,256,256,48,112,96,256,256,768,80,48,128,128,128,256,256,112,144,256,1024,42720,32,4160,224,5776,7488,3088,544,1504,4944,4192,711760,128,128,240,65040,65536,65536]),ho=function(e){const t=new Map,n="bfUATCYATCPAQATAXATAOATBKJTBXCTBCZPATAQAZANAZADZPAXAQAXAbgUATAYDaATAZAaAGARAXAcAaAZAaAXAMBZADATBZAMAGASAMCTACWXACGDXXADHA3DAAPDAAtCAAFDBCAADCAABCCDBCCABCAABCCDCCAABCAAFCAADDAABCAABCBADCBDBGACADCGDCAEADACAEADACAEADAAPDAARDACAEADAABCBA7DFCAABCBDBABCCAJjDBAAGADaFRZDFLZNFEZGFAZAFAZQnvBAAADFAZACADABBFADCTACABDZBCATACCBACABACAABCQBACIDiCADBCCDCAXDDCADAXAABCBDBCyDvAhaAHEJBA1CAANDAgfBAABAClBBFATFDoTAOABBaBYABAHsOAHATAHBTAHBTAHABHGaBDGDTBBKcFXCTBYATBaBHKTAcATCGfFAGJHUKJTDGBHAmiBAATAGAHGcAaAHFFBHBaAHDGBKJGCaBGATNBAcAGAHAGdHaBBmYBAAHKGABNKJGgHIFBaATCFABBHAYBGVHDFAHIFAHCFAHEBBTOBAGYHCBBTABAGKBEGXZAGFBAcBBFHHGoFAHXcAHfIAG1HAIAHAGAICHHIDHAIBGAHGGJHBTBKJTAFAGOHAIBBAGHBBGBBBGVBAGGBAGABCGDBBHAGAICHDBBIBBBIBHAGABHIABDGBBAGCHBBBKJGBYBMFaAYAGATAHABBHBIABAGFBDGBBBGVBAGGBAGBBAGBBAGBBBHABAICHBBDHBBBHCBCHABGGDBAGABGKJHBGCHATABJHBIABAGIBAGCBAGVBAGGBAGBBAGEBBHAGAICHEBAHBIABAIBHABBGABOGBHBBBKJTAYABGGAHFBAHAIBBAGHBBGBBBGVBAGGBAGBBAGEBBHAGAIAHAIAHDBBIBBBIBHABGHBIABDGBBAGCHBBBKJaAGAMFBJHAGABAGFBCGCBAGDBCGBBAGABAGBBCGBBCGCBCGLBDIBHAIBBCICBAICHABBGABFIABNKJMCaFYAaABEHAICHAGHBAGCBAGWBAGPBBHAGAHCIDBAHCBAHDBGHBBAGCBBGABBGBHBBBKJBGTAMGaAGAHAIBTAGHBAGCBAGWBAGJBAGEBBHAGAIAHAIEBAHAIBBAIBHBBGIBBFGBBAGBHBBBKJBAGBIABLHBIBGIBAGCBAGoHBGAICHDBAICBAICHAGAaABDGCIAMGGCHBBBKJMIaAGFBAHAIBBAGRBCGXBAGIBAGABBGGBCHABDICHCBAHABAIHBFKJBBIBTABLGvHAGBHGBDYAGFFAHHTAKJTBBkGBBAGABAGEBAGXBAGABAGJHAGBHIGABBGEBAFABAHGBAKJBBGDBfGAaCTOaATAaCHBaFKJMJaAHAaAHAaAHAPAQAPAQAIBGHBAGjBDHNIAHETAHBGEHKBAHjBAaHHAaFBAaBTEaDTBBkGqIBHDIAHFIAHBIBHBGAKJTFGFIBHBGDHCGAICGBIGGCHDGMHAIBHBIFHAGAIAKJICHAaBClBACABECABBDqTAFADCmIFAABAGDBBGGBAGABAGDBBGoBAGDBBGgBAGDBBGGBAGABAGDBBGOBAG4BAGDBBmCBAABBHCTIMTBCGPaJBFiVBAABBDFBBOAmrJAAaATAGQUAGZPAQABCmKBAATCLCGHBGGRHCIABIGSHBIATBBIGRHBBLGMBAGCBAHBBLGzHBIAHGIHHAIBHKTCFATCYAGAHABBKJBFMJBFTFOATDHCcAHAKJBFGiFAG0BGGEHBGhHAGABEmFBAABJGeBAHCIDHBICBDIBHAIFHCBDaABCTBKJGdBBGEBKGrBDGZBFKJMABCahGWHBIBHABBTBG0IAHAIAHGBAHAIAHAIBHHIFHJBBHAKJBFKJBFTGFATFBBHNJAHPBwHDIAGuHAIAHEIAHAIEHAIBGHBCKJTGaJHIaITBBAHBIAGdIAHDIBHBIAHCGBKJGrHAIAHBICHAIAHCIBBHTDGjIHHHIBHBBCTEKJBCGCKJGdFFTBDIBGCqBBCCTHBHHCTAHMIAHGGDHAGFHAGBIAHBGABEDrF+DMFADhFkH/gVCAADHghBAADHCHDFBBCFBBDHCHDHCHDFBBCFBBDHBACABACABACABACADHCHDNBBDHEHDHEHDHEHDEBADBCDEAZADAZCDCBADBCDEAZCDDBBDBCDBAZCDHCEZCBBDCBADBCDEAZBBAUKcEOFTBRASAPARBSAPARATHVAWAcEUATIRASATDNBTCXAPAQATKXATANATJUAcEBAcJMAFABBMFXCPAQAFAMJXCPAQABAFMBCYgBOHMJDHAJCHLBOaBCAaDCAaBDACCDBCCDAaACAaBXACEaFCAaACAaACAaACDaADACDDAGDDAaBDBCBXECADDaAXAaBDAaAMPLiCADALDMAaBBDXEaEXBaDXAaBXAaBXAaGXAaeXBaBXAaAXAae3LEAAaHPAQAPAQAaTXBaGPAQA6QBAAXAadXYanXF6EBAABYaKBUM76NBAAMV62CAAXAaIXAa1XH6uBAAXA63DAAPAQAPAQAPAQAPAQAPAQAPAQAPAQAMdarXEPAQAXePAQAPAQAPAQAPAQAPAQAXP6/DAA3CCAAPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQAX+PAQAPAQAXfPAQA3BEAAavXUaBXFamBBafBA6oBAACvDvABCCDBAFCCADDACADFFBCBgjBAADAaFADHCCADABETDMATBDlBADABEDABBG3BGFATABNHAGWBIGGBAGGBAGGBAGGBAGGBAGGBAGGBAGGBAHfTBRASARASATCRASATARASATIOATBOATARASATBRASAPAQAPAQAPAQAPAQATEFATJOBTDOATAPATMaBTCPAQAPAQAPAQAPAQAOABhaZBA6YBAABL6VDAABZaLBDUATCaAFAGALAPAQAPAQAPAQAPAQAPAQAaBPAQAPAQAPAQAPAQAOAPAQBaALIHDIBOAFEaBLCFAGATAaBBAmVBAABBHBZBFBGAOAmZBAATAFCGABEGqBAmdBAABAaBMDaJGfajBLGPaeBAMJadMHaAMOafMJamMO6/EAAm/mBAa/mUIFAFAm2RAABCa2BIGnFFTBmLEAAFATCGPKJGBBTAtGAHAJCTAHJTAFAAbFBHBmFBAALJHBTFBHZWFIZBANDBA9FADHADCAAJFAZBADGAADDBATCDABCDAPCCADBECADABADABADAADBXFCCADAGAFBDAGGHAGCHAGDHAGWIBHBIAaDHABCMFaBYAaABFGzTDBHIBGxIPHBBHTBKJBFHRGFTCGATAGBHAKJGbHHTBGWHKIBBKTAGcBCHCIAGuHAIBHDIBHBICTMBAFAKJBDTBGEHAFAGIKJGEBAGoHFIBHBIBHBBIGCHAGHHAIABBKJBBTDGPFAGFaCGAIAHAIAGxHAGAHCGBHBGEHBGAHAGABXGBFATBGKIAHBIBTBGAFBIAHABJGFBBGFBBGFBIGGBAGGBADqZAFDDIFAZBBDjPBAAGiIBHAIBHAIBTAIAHABBKJBFmjuCABLGWBDGwhDgAA9/jBAmtFAABBmpBAABlDGBLDEBEGAHAGJXAGMBAGEBAGABAGBBAGBBAmrBAAZQBPmqFAAQAPAaPG/BBG1BGaABfGLYAaCHPTGPAQATABFHPTAOBNBPAQAPAQAPAQAPAQAPAQAPAQAPAQAPAQATBPAQATDNCTCBATDOAPAQAPAQAPAQATCXAOAXCBATAYATBBDGEBAmGCAABBcABATCYATCPAQATAXATAOATBKJTBXCTBCZPATAQAZANAZADZPAXAQAXAPAQATAPAQATBGJFAGsFBGeBCGFBBGFBBGFBBGCBCYBXAZAaAYBBAaAXDaBBJcCaBBBGLBAGZBAGSBAGBBAGOBBGNBhm6BAABETCBDMsBCaIL0MDaQMBaCBAaMBCaABuasHAhBCAAGcBCGwBOHAMaBDGfMDBIGTLAGHLABEGlHEBEGdBATAGjBDGHTALEBpCnDnmNBAABBKJBFCjBDDjBDGnBHGzBKTACKBACOBACGBACBBADKBADOBADGBADBhCBAAm2EAABIGVBJGHBXFFBAFpBAFIhEBAAGFBBGABAGrBAGBBCGABBGWBATAMHGWaBMGGeBHMIBvGSBAGBBEMEGVMFBCTAGZBETAB/G3BDMBGBMPBBMtGAHCBAHBBEHDGDBAGCBAGcBBHCBDHAMIBGTIBGGcMBTAGcMCBfGHaAGbHBBDMETGBIG1BCTGGVBBMHGSBEMHGRBGTDBLMGhPBAAmIBAAB2CyBMDyBGMFGjHDBHKJhlEAAMeBAGpBAHBOABBGBhKBAAHCGcMJGABHGVHKMDTEBVGRHDTDBlGUMGBTGWBIIAHAIAG0HOTGBDMTKJHAGBHBGABIHCIAGsICHDIBHBTBcATDHABJcABBGYBGKJBFHCGjHEIAHHBAKJTDGAIBGABHGiHATBGABIHBIAGvICHIIBGDTDHDTAIAHAKJGATAGATCBAMTBKGRBAGYICHCIBHAIAHBTFHAGBHAB9GGBAGABAGDBAGOBAGJTABFGuHAICHHBEKJBFHBIBBAGHBBGBBBGVBAGGBAGBBAGEBAHBGAIBHAIDBBIBBBICBBGABFIABEGEIBBBHGBCHEhKCAAG0ICHHIBHCIAHAGDTEKJTBBATAHAGCBdGvICHFIAHAIDHBIAHBGBTAGABHKJhlCAAGuICHDBBIDHBIAHBTWGDHBBhGvICHHIBHAIAHBTCGABKKJBFTMBSGqHAIAHAIBHFIAHAGATABFKJB1GaBBHCIBHDIAHEBDKJMBTCaAGGh4CAAGrICHIIAHBTAhjBAACfDfKJMIBLGHBBGABBGHBAGBBAGXIFBAIBBBHBIAHAGAIAGAIAHATCBIKJhFBAAGHBBGmICHDBBHBIDHAGATAGAIABaGAHJGnHFIAGAHDTHHABHGAHFIBHCGtHMIAHBTCGATEBMmIBAABGTJh1DAAGIBAGkIAHGBAHFIAHAGATEBJKJMSBCTBGdBBHVBAIAHGIAHBIAHBhIBAAGGBAGBBAGlHFBCHABAHBBAHGGAHABHKJBFGFBAGBBAGfIEBAHBBAIBHAIAHAGABGKJh1EAAGSHBIBTBBGHBGAIAGMBAGhIBHEBCIBHAIAHATMKJhVBAAGABOMUaHYDaQBMTAmZOAAhlBAAruBAABATEBKmDDAAhLpAAmgBAATBBMmvQAAcPHAGFHOhp+AAmGJAAh4GCAm4IAABGGeBAKJBDTBmOBAABAKJBFGdBBHETABJGvHGTEaDFDTAaABJKJBAMGBAGUBEGShvKAACfDfMWTDhkBAAmKBAABDHAGAI2BGHDFMB/FBTAFAHABKIBBNm3fBABHmVTAABpGIhmLCAFDBAFGBAFBBAmiEAABOGABcGCBBGABNGDBHmLGAAhDkAAmqBAABEGMBCGIBGGJBBaAHBTAcDhbJBAHtBBHWBI6zBAAB761DAABJamBBa7IBHCaCIFcHHHaBHGadHDa8BU6BBAAHCaAh5BAAMTBLMTBL6WBAABIMYhGCAACZDZCZDGBADRCZDZCABACBBBCABBCBBBCDBACHDDBADABADGBADKCZDZCBBACDBBCHBACGBADZCBBACDBACEBACABCCGBADZCZDZCZDZCZDZCZDZCZDZCZDbBBCYXADYXADFCYXADYXADFCYXADYXADFCYXADYXADFCYXADYXADFCADABBKx6/HAAH2aDHxaHHAaNHAaBTEBOHEBAHOhPRAADJGADTBFDFhUDAAHGBAHQBBHGBAHBBAHEBEF9BgHAhvBAAGsBCHGFGBBKJBDGAaAh/EAAGdHABQGrHDKJBEYAhPHAAGaFAHDKJhlLAAGGBAGDBAGBBAGOBAmEDAABBMIHGBoChDhHGFABDKJBDTBhQMAAM6aAMCYAMDhLBAAMsaAMOhBDAAGDBAGaBAGBBAGABBGABAGJBAGDBAGABAGABFGABDGABAGABAGABAGCBAGBBAGABBGABAGABAGABAGABAGABAGBBAGABBGDBAGGBAGDBAGDBAGABAGJBAGQBEGCBAGEBAGQBzXBhNEAAarBD6jBAABLaOBBaOBAaOBAakBJMM6gCAAB3acBMarBDaIBGaBBNaFhZCAA66DAAZE6XLAABDaQBCaMBC62BAABD6eBAABFaLBDaABOaLBDa3BHaJBFanBHadBBaBhNBAA6TFAABLaNBBaMBCaIBGatBAaGBHaNBDaIBGaIBG6SCAABAa2BkKJhFQAAmfbKABfm5ABABFmdDAABBmBaBABNmw0BAhewAAmdIAAhhXAAmKNBABEmfBBAhQxtCcABd8fBAAh/BAAnvDAAhP4PA99/PABB99/PA".split(""),i=no.map((()=>[]));let r=0,s=0;for(;s<n.length;){const e=io[n[s]],t=(31&e)-2;let o=1+io[n[s+1]];switch(32&e?(o+=io[n[s+2]]<<6,o+=io[n[s+3]]<<12,o+=io[n[s+4]]<<18,s+=5):s+=2,t){case-2:{let e=0;for(let t=r;t<r+o;++t)i[e].push(Ps(t)),e=(e+1)%2;break}case-1:break;default:{const e=i[t];1===o?e.push(Ps(r)):e.push($s(r,r+o-1));break}}r+=o}const o=new Map;return no.forEach(((e,n)=>{const r=i[n].reduce(Qs,Is);t.set(e,r);const s=e.charAt(0),a=o.get(s)||[];o.set(s,a),a.push(r)})),o.forEach(((e,n)=>{t.set(n,e.reduce(Qs,Is))})),t}();function co(e){return 32===e||9===e||10===e||13===e}const uo=[Ps(ro(":")),$s(ro("A"),ro("Z")),Ps(ro("_")),$s(ro("a"),ro("z")),$s(192,214),$s(216,246),$s(192,214),$s(216,246),$s(248,767),$s(880,893),$s(895,8191),$s(8204,8205),$s(8304,8591),$s(11264,12271),$s(12289,55295),$s(63744,64975),$s(65008,65533),$s(65536,983039)].reduce(Qs),po=[uo,Ps(ro("-")),Ps(ro(".")),$s(ro("0"),ro("9")),Ps(183),$s(768,879),$s(8255,8256)].reduce(Qs),fo=ho.get("Nd"),mo=oo(fo),go=ao($s(0,1114111),[ho.get("P"),ho.get("Z"),ho.get("C")].reduce(Qs)),Oo=oo(go);function yo(e){return 10!==e&&13!==e&&!so(e)}const vo={s:co,S:oo(co),i:uo,I:oo(uo),c:po,C:oo(po),d:fo,D:mo,w:go,W:Oo},bo=Fs("*"),wo=Fs("\\"),xo=Fs("{"),So=Fs("}"),ko=Fs("["),Ao=Fs("]"),Co=Fs("^"),_o=Fs("$"),Eo=Fs(","),To=Fs("-"),Po=Fs("("),$o=Fs(")"),No=Fs("."),Io=Fs("|"),Qo=Fs("+"),Ro=Fs("?"),Mo=Fs("-["),Bo=ro("0");function Do(e){return[...e].map((e=>e.codePointAt(0)))}var Xo=Object.freeze({__proto__:null,compile:function(e,t={language:"xsd"}){const n=function(e){function t(e){return new Set(e.split("").map((e=>ro(e))))}function n(e,t){const n=e.codePointAt(t);return void 0===n?Xs(t,["any character"]):Bs(t+String.fromCodePoint(n).length,n)}const i="xpath"===e.language?Hs(wo,Vs([Ls(Fs("n"),(()=>10)),Ls(Fs("r"),(()=>13)),Ls(Fs("t"),(()=>9)),Ls(Vs([wo,Io,No,To,Co,Ro,bo,Qo,xo,So,_o,Po,$o,ko,Ao]),(e=>ro(e)))])):Hs(wo,Vs([Ls(Fs("n"),(()=>10)),Ls(Fs("r"),(()=>13)),Ls(Fs("t"),(()=>9)),Ls(Vs([wo,Io,No,To,Co,Ro,bo,Qo,xo,So,Po,$o,ko,Ao]),(e=>ro(e)))]));function r(e,i){const r=t(i);return js(Fs(e),zs(Us(n,(e=>r.has(e)),i.split(""))),((e,t)=>function(e){const t=ho.get(e);if(null==t)throw new Error(e+" is not a valid unicode category");return t}(null===t?e:e+String.fromCodePoint(t))))}const s=Vs([r("L","ultmo"),r("M","nce"),r("N","dlo"),r("P","cdseifo"),r("Z","slp"),r("S","mcko"),r("C","cfon")]),o=[$s(ro("a"),ro("z")),$s(ro("A"),ro("Z")),$s(ro("0"),ro("9")),Ps(45)].reduce(Qs),a=Vs([s,Ls(Hs(Fs("Is"),function(e){return(t,n)=>{const i=e(t,n);return i.success?Bs(i.offset,t.slice(n,i.offset)):i}}(qs(Us(n,o,["block identifier"])))),(t=>function(e,t){const n=lo.get(e);if(void 0===n){if(t)return Ns;throw new Error(`The unicode block identifier "${e}" is not known.`)}return n}(t,"xpath"!==e.language)))]),l=Js(Fs("\\p{"),a,So,!0),h=Ls(Js(Fs("\\P{"),a,So,!0),oo),c=Hs(wo,Ls(Vs("sSiIcCdDwW".split("").map((e=>Fs(e)))),(e=>vo[e]))),u=Ls(No,(()=>yo)),d=Vs([c,l,h]),p=t("\\[]"),f=Vs([i,Us(n,(e=>!p.has(e)),["unescaped character"])]),m=Vs([Ls(To,(()=>null)),f]),g=js(m,Hs(To,m),$s);function O(e,t){return[e].concat(t||[])}const y=Ls(function(e){return(t,n)=>{const i=e(t,n);return i.success?Bs(n,i.value):i}}(Vs([Ao,Mo])),(()=>null)),v=ro("-"),b=Vs([Ls(Ys(Ys(To,Ks(ko,["not ["])),y),(()=>v)),Hs(Ks(To,["not -"]),f)]),w=Vs([js(Ls(b,Ps),Vs([function(e,t){return w(e,t)},y]),O),js(Vs([g,d]),Vs([S,y]),O)]),x=Vs([js(Ls(f,Ps),Vs([w,y]),O),js(Vs([g,d]),Vs([S,y]),O)]);function S(e,t){return x(e,t)}const k=Ls(x,(e=>e.reduce(Qs))),A=Ls(Hs(Co,k),oo),C=js(Vs([Hs(Ks(Co,["not ^"]),k),A]),zs(Hs(To,(function(e,t){return _(e,t)}))),ao),_=Js(ko,C,Ao,!0),E="xpath"===e.language?Vs([Ls(i,Ps),d,_,u,Ls(Co,(()=>e=>-1===e)),Ls(_o,(()=>e=>-2===e))]):Vs([Ls(i,Ps),d,_,u]),T="xpath"===e.language?t(".\\?*+{}()|^$[]"):t(".\\?*+{}()|[]"),P=Us(n,(e=>!T.has(e)),["NormalChar"]),$=Ls(Hs(wo,js(Ls(Us(n,$s(ro("1"),ro("9")),["digit"]),(e=>e-Bo)),Zs(Ls(Us(n,$s(Bo,ro("9")),["digit"]),(e=>e-Bo))),((e,t)=>{t.reduce(((e,t)=>10*e+t),e)}))),(e=>{throw new Error("Backreferences in XPath patterns are not yet implemented.")})),N="xpath"===e.language?Vs([Ls(P,(e=>({kind:"predicate",value:Ps(e)}))),Ls(E,(e=>({kind:"predicate",value:e}))),Ls(Js(Po,Hs(zs(Fs("?:")),D),$o,!0),(e=>({kind:"regexp",value:e}))),$]):Vs([Ls(P,(e=>({kind:"predicate",value:Ps(e)}))),Ls(E,(e=>({kind:"predicate",value:e}))),Ls(Js(Po,D,$o,!0),(e=>({kind:"regexp",value:e})))]),I=Ls(qs(Ls(Us(n,$s(Bo,ro("9")),["digit"]),(e=>e-Bo))),(e=>e.reduce(((e,t)=>10*e+t)))),Q=Vs([js(I,Hs(Eo,I),((e,t)=>{if(t<e)throw new Error("quantifier range is in the wrong order");return{min:e,max:t}})),js(I,Eo,(e=>({min:e,max:null}))),Ls(I,(e=>({min:e,max:e})))]),R="xpath"===e.language?js(Vs([Ls(Ro,(()=>({min:0,max:1}))),Ls(bo,(()=>({min:0,max:null}))),Ls(Qo,(()=>({min:1,max:null}))),Js(xo,Q,So,!0)]),zs(Ro),((e,t)=>e)):Vs([Ls(Ro,(()=>({min:0,max:1}))),Ls(bo,(()=>({min:0,max:null}))),Ls(Qo,(()=>({min:1,max:null}))),Js(xo,Q,So,!0)]),M=Zs(js(N,Ls(zs(R),(e=>null===e?{min:1,max:1}:e)),((e,t)=>[e,t]))),B=js(M,Zs(Hs(Io,eo(M))),((e,t)=>[e].concat(t)));function D(e,t){return B(e,t)}const X=function(e){return js(e,to,Gs)}(B);return function(e){let t;try{t=X(e,0)}catch(t){throw new Error(`Error parsing pattern "${e}": ${t instanceof Error?t.message:t}`)}return t.success?t.value:function(e,t,n){const i=n.map((e=>`"${e}"`));throw new Error(`Error parsing pattern "${e}" at offset ${t}: expected ${i.length>1?"one of "+i.join(", "):i[0]} but found "${e.slice(t,t+1)}"`)}(e,t.offset,t.expected)}}(t)(e),i=function(e){const t=new ys;return e(t),new Ts(t.program)}((e=>{Ms(e,n,"xpath"===t.language),e.accept()}));return function(e){const n="xpath"===t.language?[-1,...Do(e),-2]:Do(e);return i.execute(n).success}}});function Fo(e,t){return{success:!0,offset:e,value:t}}function Lo(e){return Fo(e,void 0)}function Uo(e,t,n=!1){return{success:!1,offset:e,expected:t,fatal:n}}function Vo(e){return e>65535?2:1}function zo(e,t){return(n,i)=>{const r=n.codePointAt(i);return void 0!==r&&e(r)?Lo(i+Vo(r)):Uo(i,t)}}function Zo(e,t){return(n,i)=>{const r=e(n,i);return r.success?Fo(r.offset,t(r.value)):r}}function jo(e){return(t,n)=>{let i=[],r=n;for(;;){const n=e(t,r);if(!n.success){if(n.fatal)return n;break}if(i.push(n.value),n.offset===r)break;r=n.offset}return Fo(r,i)}}function qo(e){return(t,n)=>{let i=n;for(;;){const n=e(t,i);if(!n.success){if(n.fatal)return n;break}if(n.offset===i)break;i=n.offset}return Lo(i)}}function Go(e,t,n){return(i,r)=>{const s=e(i,r);if(!s.success)return s;const o=t(i,s.offset);return o.success?Fo(o.offset,n(s.value,o.value)):o}}function Wo(e,t){return e}function Ho(e,t){return t}function Yo(e,t){return Go(e,t,Ho)}function Jo(e,t){return Go(e,t,Wo)}function Ko(e,t){return(n,i)=>e(n,i).success?Uo(i,t):Lo(i)}function ea(e){return(t,n)=>{const i=e(t,n);return i.success?i:Uo(i.offset,i.expected,!0)}}const ta=(e,t)=>e.length===t?Lo(t):Uo(t,["end of input"]);function na(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return[t,n.value]}var ia=Object.freeze({__proto__:null,codepoint:zo,codepoints:function(e,t){return(n,i)=>{const r=i;for(;;){const t=n.codePointAt(i);if(void 0===t)break;if(!e(t))break;i+=t>65535?2:1}return void 0!==t&&i===r?Uo(i,t):Lo(i)}},collect:na,complete:function(e){return Go(e,ta,Wo)},consume:function(e){return Zo(e,(()=>{}))},cut:ea,delimited:function(e,t,n,i=!1){return Yo(e,i?ea(Jo(t,n)):Jo(t,n))},dispatch:function(e,t,n=0,i=[]){return(r,s)=>{const o=r.codePointAt(s+n);if(void 0===o)return Uo(s,i);const a=e[o];return void 0===a?void 0===t?Uo(s,i):t(r,s):a(r,s)}},end:ta,error:Uo,except:function(e,t,n){return Yo(Ko(t,n),e)},filter:function(e,t,n,i){return(r,s)=>{const o=e(r,s);return o.success?t(o.value)?o:Uo(s,n,i):o}},filterUndefined:function(e){return Zo(e,(e=>e.filter((e=>void 0!==e))))},first:Wo,followed:Jo,map:Zo,not:Ko,ok:Lo,okWithValue:Fo,optional:function(e){return(t,n)=>{const i=e(t,n);return i.success||i.fatal?i:Fo(n,null)}},or:function(e,t){return(n,i)=>{let r=null;for(const s of e){const e=s(n,i);if(e.success)return e;if(null===r||e.offset>r.offset?r=e:e.offset===r.offset&&void 0===t&&(r.expected=r.expected.concat(e.expected)),e.fatal)return e}return t=t||(null==r?void 0:r.expected)||[],r&&(r.expected=t),r||Uo(i,t)}},peek:function(e){return(t,n)=>{const i=e(t,n);return i.success?Fo(n,i.value):i}},plus:function(e){return Go(e,jo(e),((e,t)=>[e].concat(t)))},plusConsumed:function(e){return Go(e,qo(e),Ho)},preceded:Yo,range:function(e,t,n){return zo((n=>e<=n&&n<=t),n||[`${String.fromCodePoint(e)}-${String.fromCodePoint(t)}`])},recognize:function(e){return(t,n)=>{const i=e(t,n);return i.success?Fo(i.offset,t.slice(n,i.offset)):i}},second:Ho,sequence:function(...e){return(t,n)=>{const i=[];for(const r of e){const e=r(t,n);if(!e.success)return e;n=e.offset,i.push(e.value)}return Fo(n,i)}},sequenceConsumed:function(...e){return(t,n)=>{for(const i of e){const e=i(t,n);if(!e.success)return e;n=e.offset}return Lo(n)}},skipChars:function(e){return(t,n)=>{let i=e;for(;i>0;){const e=t.codePointAt(n);if(void 0===e)return Uo(n,["any character"]);n+=Vo(e),i-=1}return Lo(n)}},star:jo,starConsumed:qo,start:(e,t)=>0===t?Lo(t):Uo(t,["start of input"]),streaming:function(e){return function*(t,n){const i=e(t,n);return i.success&&(yield i.value),i}},streamingComplete:function(e){return function*(t,n){const i=yield*e(t,n);return i.success?ta(t,i.offset):i}},streamingFilterUndefined:function(e){return function*(t,n){const i=e(t,n);let r=i.next();for(;!r.done;){const e=r.value;void 0!==e&&(yield e),r=i.next()}return r.value}},streamingOptional:function(e){return function*(t,n){const[i,r]=na(e(t,n));return r.success?(yield*i,r):r.fatal?r:Lo(n)}},streamingStar:function(e){return function*(t,n){for(;;){const[i,r]=na(e(t,n));if(!r.success)return r.fatal?r:Lo(n);if(yield*i,n===r.offset)return Lo(n);n=r.offset}}},streamingThen:function(e,t){return function*(n,i){const r=yield*e(n,i);return r.success?yield*t(n,r.offset):r}},then:Go,token:function(e){return(t,n)=>{const i=n+e.length;return t.slice(n,i)===e?Fo(i,e):Uo(n,[e])}}});const ra=function(e,t){const n={};function i(e,t){if(!("0"!==e&&"-0"!==e||"0"!==t&&"-0"!==t))return 0;var n=/(?:\+|(-))?(\d+)?(?:\.(\d+))?/;e=n.exec(e+"");var i=n.exec(t+""),r=!e[1];const s=!i[1];return t=(e[2]||"").replace(/^0*/,""),n=(i[2]||"").replace(/^0*/,""),e=e[3]||"",i=i[3]||"",r&&!s?1:!r&&s?-1:(r=r&&s,t.length>n.length?r?1:-1:t.length<n.length?r?-1:1:t>n?r?1:-1:t<n?r?-1:1:(t=Math.max(e.length,i.length),(n=e.padEnd(t,"0"))>(t=i.padEnd(t,"0"))?r?1:-1:n<t?r?-1:1:0))}function r(e,t){return!(-1<(e=e.toString()).indexOf(".")&&0===t)&&(!(e=/^[-+]?0*([1-9]\d*)?(?:\.((?:\d*[1-9])*)0*)?$/.exec(e))[2]||e[2].length<=t)}function s(e,t){switch(t){case"required":return/(Z)|([+-])([01]\d):([0-5]\d)$/.test(e.toString());case"prohibited":return!/(Z)|([+-])([01]\d):([0-5]\d)$/.test(e.toString());case"optional":return!0}}function o(e){switch(e){case 1:case 0:case 6:case 3:case 18:case 22:case 21:case 20:case 23:case 44:return{};case 4:return{ka:r,wa:function(e,t){return 1>i(e,t)},nc:function(e,t){return 0>i(e,t)},xa:function(e,t){return-1<i(e,t)},oc:function(e,t){return 0<i(e,t)}};case 9:case 8:case 7:case 11:case 12:case 13:case 15:case 14:return{Ba:s};default:return null}}var a={},l={};function h(e){return/^([+-]?(\d*(\.\d*)?([eE][+-]?\d*)?|INF)|NaN)$/.test(e)}function c(e){return/^[_:A-Za-z][-._:A-Za-z0-9]*$/.test(e)}function u(e){return c(e)&&/^[_A-Za-z]([-._A-Za-z0-9])*$/.test(e)}function d(e){return 1===(e=e.split(":")).length?u(e[0]):2===e.length&&(u(e[0])&&u(e[1]))}function p(e){return!/[\u0009\u000A\u000D]/.test(e)}function f(e){return u(e)}const m=new Map([[45,function(){return!0}],[46,function(){return!0}],[1,function(){return!0}],[0,function(e){return/^(0|1|true|false)$/.test(e)}],[6,function(e){return h(e)}],[3,h],[4,function(e){return/^[+-]?\d*(\.\d*)?$/.test(e)}],[18,function(e){return/^(-)?P(\d+Y)?(\d+M)?(\d+D)?(T(\d+H)?(\d+M)?(\d+(\.\d*)?S)?)?$/.test(e)}],[9,function(e){return/^-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])T(([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\.[0-9]+)?|(24:00:00(\.0+)?))(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[8,function(e){return/^(([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\.[0-9]+)?|(24:00:00(\.0+)?))(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[7,function(e){return/^-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[11,function(e){return/^-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[12,function(e){return/^-?([1-9][0-9]{3,}|0[0-9]{3})(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[13,function(e){return/^--(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[15,function(e){return/^---(0[1-9]|[12][0-9]|3[01])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[14,function(e){return/^--(0[1-9]|1[0-2])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?$/.test(e)}],[22,function(e){return/^([0-9A-Fa-f]{2})*$/.test(e)}],[21,function(e){return new RegExp(/^((([A-Za-z0-9+/] ?){4})*((([A-Za-z0-9+/] ?){3}[A-Za-z0-9+/])|(([A-Za-z0-9+/] ?){2}[AEIMQUYcgkosw048] ?=)|(([A-Za-z0-9+/] ?)[AQgw] ?= ?=)))?$/).test(e)}],[20,function(){return!0}],[44,d],[48,p],[52,function(e){return p(e)&&!/^ | {2,}| $/.test(e)}],[51,function(e){return/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/.test(e)}],[50,function(e){return/^[-._:A-Za-z0-9]+$/.test(e)}],[25,c],[23,d],[24,u],[42,f],[41,f],[26,function(e){return u(e)}],[5,function(e){return/^[+-]?\d+$/.test(e)}],[16,function(e){return/^-?P[0-9]+(Y([0-9]+M)?|M)$/.test(e)}],[17,function(e){return/^-?P([0-9]+D)?(T([0-9]+H)?([0-9]+M)?([0-9]+(\.[0-9]+)?S)?)?$/.test(e)}]]);var g=Object.create(null);function O(e,t){if(!g[t])throw Error("Unknown type");return{type:t,value:e}}[{C:0,name:59},{C:0,name:46,parent:59,K:{whiteSpace:"preserve"}},{C:0,name:19,parent:46},{C:0,name:1,parent:46},{C:0,name:0,parent:46,K:{whiteSpace:"collapse"}},{C:0,name:4,parent:46,K:{whiteSpace:"collapse"}},{C:0,name:6,parent:46,K:{whiteSpace:"collapse"}},{C:0,name:3,parent:46,K:{whiteSpace:"collapse"}},{C:0,name:18,parent:46,K:{whiteSpace:"collapse"}},{C:0,name:9,parent:46,K:{Ba:"optional",whiteSpace:"collapse"}},{C:0,name:8,parent:46,K:{Ba:"optional",whiteSpace:"collapse"}},{C:0,name:7,parent:46,K:{Ba:"optional",whiteSpace:"collapse"}},{C:0,name:11,parent:46,K:{Ba:"optional",whiteSpace:"collapse"}},{C:0,name:12,parent:46,K:{Ba:"optional",whiteSpace:"collapse"}},{C:0,name:13,parent:46,K:{Ba:"optional",whiteSpace:"collapse"}},{C:0,name:15,parent:46,K:{Ba:"optional",whiteSpace:"collapse"}},{C:0,name:14,parent:46,K:{Ba:"optional",whiteSpace:"collapse"}},{C:0,name:22,parent:46,K:{whiteSpace:"collapse"}},{C:0,name:21,parent:46,K:{whiteSpace:"collapse"}},{C:0,name:20,parent:46,K:{whiteSpace:"collapse"}},{C:0,name:23,parent:46,K:{whiteSpace:"collapse"}},{C:0,name:44,parent:46,K:{whiteSpace:"collapse"}},{C:1,name:10,S:9,K:{whiteSpace:"collapse",Ba:"required"}},{C:1,name:48,S:1,K:{whiteSpace:"replace"}},{C:1,name:52,S:48,K:{whiteSpace:"collapse"}},{C:1,name:51,S:52,K:{whiteSpace:"collapse"}},{C:1,name:50,S:52,K:{whiteSpace:"collapse"}},{C:2,name:49,type:50,K:{minLength:1,whiteSpace:"collapse"}},{C:1,name:25,S:52,K:{whiteSpace:"collapse"}},{C:1,name:24,S:25,K:{whiteSpace:"collapse"}},{C:1,name:42,S:24,K:{whiteSpace:"collapse"}},{C:1,name:41,S:24,K:{whiteSpace:"collapse"}},{C:2,name:43,type:41,K:{minLength:1,whiteSpace:"collapse"}},{C:1,name:26,S:24,K:{whiteSpace:"collapse"}},{C:2,name:40,type:26,K:{minLength:1,whiteSpace:"collapse"}},{C:0,name:5,parent:4,K:{ka:0,whiteSpace:"collapse"}},{C:1,name:27,S:5,K:{ka:0,wa:"0",whiteSpace:"collapse"}},{C:1,name:28,S:27,K:{ka:0,wa:"-1",whiteSpace:"collapse"}},{C:1,name:31,S:5,K:{ka:0,wa:"9223372036854775807",xa:"-9223372036854775808",whiteSpace:"collapse"}},{C:1,name:32,S:31,K:{ka:0,wa:"2147483647",xa:"-2147483648",whiteSpace:"collapse"}},{C:1,name:33,S:32,K:{ka:0,wa:"32767",xa:"-32768",whiteSpace:"collapse"}},{C:1,name:34,S:33,K:{ka:0,wa:"127",xa:"-128",whiteSpace:"collapse"}},{C:1,name:30,S:5,K:{ka:0,xa:"0",whiteSpace:"collapse"}},{C:1,name:36,S:30,K:{ka:0,wa:"18446744073709551615",xa:"0",whiteSpace:"collapse"}},{C:1,name:35,S:36,K:{ka:0,wa:"4294967295",xa:"0",whiteSpace:"collapse"}},{C:1,name:38,S:35,K:{ka:0,wa:"65535",xa:"0",whiteSpace:"collapse"}},{C:1,name:37,S:38,K:{ka:0,wa:"255",xa:"0",whiteSpace:"collapse"}},{C:1,name:29,S:30,K:{ka:0,xa:"1",whiteSpace:"collapse"}},{C:1,name:16,S:18,K:{whiteSpace:"collapse"}},{C:1,name:17,S:18,K:{whiteSpace:"collapse"}},{C:1,name:60,S:59},{C:3,name:39,Ca:[]},{C:1,name:61,S:60},{C:1,name:62,S:60},{C:0,name:53,parent:59},{C:1,name:54,S:53},{C:1,name:58,S:53},{C:1,name:47,S:53},{C:1,name:56,S:53},{C:1,name:57,S:53},{C:1,name:55,S:53},{C:3,name:2,Ca:[4,5,6,3]},{C:3,name:63,Ca:[]}].forEach((e=>{const t=e.name,n=e.K||{};switch(e.C){case 0:e=e.parent?g[e.parent]:null;var i=m.get(t)||null;g[t]={C:0,type:t,Ka:n,parent:e,gb:i,Oa:o(t),Ca:[]};break;case 1:e=g[e.S],i=m.get(t)||null,g[t]={C:1,type:t,Ka:n,parent:e,gb:i,Oa:e.Oa,Ca:[]};break;case 2:g[t]={C:2,type:t,Ka:n,parent:g[e.type],gb:null,Oa:a,Ca:[]};break;case 3:e=e.Ca.map((e=>g[e])),g[t]={C:3,type:t,Ka:n,parent:null,gb:null,Oa:l,Ca:e}}}));var y=O(!0,0),v=O(!1,0),b=(e="A wrong argument type was specified in a function call.")=>Error(`FORG0006: ${e}`),w=class{constructor(e,t){this.done=e,this.value=t}},x=new w(!0);function S(e){return new w(!1,e)}function k(e,t){if(3===t.C)return!!t.Ca.find((t=>k(e,t)));for(;e;){if(e.type===t.type)return!0;if(3===e.C)return!!e.Ca.find((e=>A(e.type,t.type)));e=e.parent}return!1}function A(e,t){return e===t||k(g[e],g[t])}var C=class{constructor(){this.value={next:()=>x}}hb(){return this}filter(){return this}first(){return null}O(){return[]}fa(){return!1}Pa(){return 0}F(){return!0}oa(){return!1}map(){return this}N(e){return e([])}X(e){return e.empty?e.empty(this):e.default(this)}},_=class{constructor(e,t){this.type=e,this.value=t}};const E={0:"xs:boolean",1:"xs:string",2:"xs:numeric",3:"xs:double",4:"xs:decimal",5:"xs:integer",6:"xs:float",7:"xs:date",8:"xs:time",9:"xs:dateTime",10:"xs:dateTimeStamp",11:"xs:gYearMonth",12:"xs:gYear",13:"xs:gMonthDay",14:"xs:gMonth",15:"xs:gDay",16:"xs:yearMonthDuration",17:"xs:dayTimeDuration",18:"xs:duration",19:"xs:untypedAtomic",20:"xs:anyURI",21:"xs:base64Binary",22:"xs:hexBinary",23:"xs:QName",24:"xs:NCName",25:"xs:Name",26:"xs:ENTITY",27:"xs:nonPositiveInteger",28:"xs:negativeInteger",29:"xs:positiveInteger",30:"xs:nonNegativeInteger",31:"xs:long",32:"xs:int",33:"xs:short",34:"xs:byte",35:"xs:unsignedInt",36:"xs:unsignedLong",37:"xs:unsignedByte",38:"xs:unsignedShort",39:"xs:error",40:"xs:ENTITIES",41:"xs:IDREF",42:"xs:ID",43:"xs:IDREFS",44:"xs:NOTATION",45:"xs:anySimpleType",46:"xs:anyAtomicType",47:"attribute()",48:"xs:normalizedString",49:"xs:NMTOKENS",50:"xs:NMTOKEN",51:"xs:language",52:"xs:token",53:"node()",54:"element()",55:"document-node()",56:"text()",57:"processing-instruction()",58:"comment()",59:"item()",60:"function(*)",61:"map(*)",62:"array(*)",63:"none"},T={"xs:boolean":0,"xs:string":1,"xs:numeric":2,"xs:double":3,"xs:decimal":4,"xs:integer":5,"xs:float":6,"xs:date":7,"xs:time":8,"xs:dateTime":9,"xs:dateTimeStamp":10,"xs:gYearMonth":11,"xs:gYear":12,"xs:gMonthDay":13,"xs:gMonth":14,"xs:gDay":15,"xs:yearMonthDuration":16,"xs:dayTimeDuration":17,"xs:duration":18,"xs:untypedAtomic":19,"xs:anyURI":20,"xs:base64Binary":21,"xs:hexBinary":22,"xs:QName":23,"xs:NCName":24,"xs:Name":25,"xs:ENTITY":26,"xs:nonPositiveInteger":27,"xs:negativeInteger":28,"xs:positiveInteger":29,"xs:nonNegativeInteger":30,"xs:long":31,"xs:int":32,"xs:short":33,"xs:byte":34,"xs:unsignedInt":35,"xs:unsignedLong":36,"xs:unsignedByte":37,"xs:unsignedShort":38,"xs:error":39,"xs:ENTITIES":40,"xs:IDREF":41,"xs:ID":42,"xs:IDREFS":43,"xs:NOTATION":44,"xs:anySimpleType":45,"xs:anyAtomicType":46,"attribute()":47,"xs:normalizedString":48,"xs:NMTOKENS":49,"xs:NMTOKEN":50,"xs:language":51,"xs:token":52,"node()":53,"element()":54,"document-node()":55,"text()":56,"processing-instruction()":57,"comment()":58,"item()":59,"function(*)":60,"map(*)":61,"array(*)":62};function P(e){return 2===e.g?E[e.type]+"*":1===e.g?E[e.type]+"+":0===e.g?E[e.type]+"?":E[e.type]}function $(e){if("none"===e)throw Error('XPST0051: The type "none" could not be found');if(!e.startsWith("xs:")&&0<=e.indexOf(":"))throw Error(`XPST0081: Invalid prefix for input ${e}`);const t=T[e];if(void 0===t)throw Error(`XPST0051: The type "${e}" could not be found`);return t}function N(e){switch(e[e.length-1]){case"*":return{type:$(e.substr(0,e.length-1)),g:2};case"?":return{type:$(e.substr(0,e.length-1)),g:0};case"+":return{type:$(e.substr(0,e.length-1)),g:1};default:return{type:$(e),g:3}}}function I(e){const t=e.value;if(A(e.type,53))return!0;if(A(e.type,0))return t;if(A(e.type,1)||A(e.type,20)||A(e.type,19))return 0!==t.length;if(A(e.type,2))return!isNaN(t)&&0!==t;throw b(`Cannot determine the effective boolean value of a value with the type ${E[e.type]}`)}function Q(e,t=0){e.h=t}var R=class{constructor(e){this.v=D,this.h=e;let t=!1;this.value={next:()=>t?x:(t=!0,S(e))},this.o=null}hb(){return this}filter(e){return e(this.h,0,this)?this:this.v.create()}first(){return this.h}O(){return[this.h]}fa(){return null===this.o&&(this.o=I(this.h)),this.o}Pa(){return 1}F(){return!1}oa(){return!0}map(e){return this.v.create(e(this.h,0,this))}N(e){return e([this.h])}X(e){return e.m?e.m(this):e.default(this)}};const M=new C;function B(e=null,t=null){if(null===e)return M;if(Array.isArray(e))switch(e.length){case 0:return M;case 1:return new R(e[0]);default:return new class{constructor(e){this.o=D,this.h=e;let t=-1;this.value={next:()=>(t++,t>=e.length?x:S(e[t]))}}hb(){return this}filter(e){let t=-1;return this.o.create({next:()=>{for(t++;t<this.h.length&&!e(this.h[t],t,this);)t++;return t>=this.h.length?x:S(this.h[t])}})}first(){return this.h[0]}O(){return this.h}fa(){if(A(this.h[0].type,53))return!0;throw b("Cannot determine the effective boolean value of a sequence with a length higher than one.")}Pa(){return this.h.length}F(){return!1}oa(){return!1}map(e){let t=-1;return this.o.create({next:()=>++t>=this.h.length?x:S(e(this.h[t],t,this))},this.h.length)}N(e){return e(this.h)}X(e){return e.multiple?e.multiple(this):e.default(this)}}(e)}return e.next?new class{constructor(e,t=null){this.D=D,this.value={next:t=>null!==this.o&&this.h>=this.o?x:void 0!==this.v[this.h]?S(this.v[this.h++]):(t=e.next(t)).done?(this.o=this.h,t):((this.l||2>this.h)&&(this.v[this.h]=t.value),this.h++,t)},this.l=!1,this.v=[],this.h=0,this.o=t}hb(){return this.D.create(this.O())}filter(e){let t=-1;const n=this.value;return this.D.create({next:i=>{for(t++,i=n.next(i);!i.done&&!e(i.value,t,this);)t++,i=n.next(0);return i}})}first(){if(void 0!==this.v[0])return this.v[0];const e=this.value.next(0);return Q(this),e.done?null:e.value}O(){if(this.h>this.v.length&&this.o!==this.v.length)throw Error("Implementation error: Sequence Iterator has progressed.");const e=this.value;this.l=!0;let t=e.next(0);for(;!t.done;)t=e.next(0);return this.v}fa(){const e=this.value,t=this.h;Q(this);var n=e.next(0);if(n.done)return Q(this,t),!1;if(A((n=n.value).type,53))return Q(this,t),!0;if(!e.next(0).done)throw b("Cannot determine the effective boolean value of a sequence with a length higher than one.");return Q(this,t),I(n)}Pa(e=!1){if(null!==this.o)return this.o;if(e)return-1;e=this.h;const t=this.O().length;return Q(this,e),t}F(){return 0===this.o||null===this.first()}oa(){if(null!==this.o)return 1===this.o;var e=this.value;const t=this.h;return Q(this),e.next(0).done?(Q(this,t),!1):(e=e.next(0),Q(this,t),e.done)}map(e){let t=0;const n=this.value;return this.D.create({next:i=>(i=n.next(i)).done?x:S(e(i.value,t++,this))},this.o)}N(e,t){const n=this.value;let i;const r=[];let s=!0;return function(){for(let e=n.next(s?0:t);!e.done;e=n.next(t))s=!1,r.push(e.value);i=e(r).value}(),this.D.create({next:()=>i.next(0)})}X(e){let t=null;const n=e=>{t=e.value,-1!==(e=e.Pa(!0))&&(this.o=e)};return this.D.create({next:i=>t?t.next(i):this.F()?(n(e.empty?e.empty(this):e.default(this)),t.next(i)):this.oa()?(n(e.m?e.m(this):e.default(this)),t.next(i)):(n(e.multiple?e.multiple(this):e.default(this)),t.next(i))})}}(e,t):new R(e)}var D={create:B,m:e=>new R(e),empty:()=>B(),aa:()=>B(y),T:()=>B(v)};function X(e){const t=[],n=e.value;return()=>{let e=0;return D.create({next:()=>{if(void 0!==t[e])return t[e++];const i=n.next(0);return i.done?i:t[e++]=i}})}}var F=class{constructor(e,t,n){this.namespaceURI=t||null,this.prefix=e||"",this.localName=n}za(){return this.prefix?this.prefix+":"+this.localName:this.localName}};var L=class extends _{constructor({j:e,arity:t,Ya:n=!1,I:i=!1,localName:r,namespaceURI:s,i:o,value:a}){for(super(60,null),this.value=a,this.I=i,i=-1,a=0;a<e.length;a++)4===e[a]&&(i=a);-1<i&&(a=Array(t-(e.length-1)).fill(e[i-1]),e=e.slice(0,i).concat(a)),this.o=e,this.v=t,this.ia=n,this.D=r,this.l=s,this.s=o}Ya(){return this.ia}};function U(e,t){const n=[];return 2!==e&&1!==e||n.push("type-1-or-type-2"),n.push(`type-${e}`),t&&n.push(`name-${t}`),n}function V(e){const t=e.node.nodeType;let n;return 2!==t&&1!==t||(n=e.node.localName),U(t,n)}function z(e){let t,n=e.nodeType;return 4===n&&(n=3),2!==n&&1!==n||(t=e.localName),U(n,t)}var Z=class{getAllAttributes(e,t=null){return 1!==e.nodeType?[]:(e=Array.from(e.attributes),null===t?e:e.filter((e=>z(e).includes(t))))}getAttribute(e,t){return 1!==e.nodeType?null:e.getAttribute(t)}getChildNodes(e,t=null){return e=Array.from(e.childNodes),null===t?e:e.filter((e=>z(e).includes(t)))}getData(e){return 2===e.nodeType?e.value:e.data}getFirstChild(e,t=null){for(e=e.firstChild;e;e=e.nextSibling)if(null===t||z(e).includes(t))return e;return null}getLastChild(e,t=null){for(e=e.lastChild;e;e=e.previousSibling)if(null===t||z(e).includes(t))return e;return null}getNextSibling(e,t=null){for(e=e.nextSibling;e;e=e.nextSibling)if(null===t||z(e).includes(t))return e;return null}getParentNode(e,t=null){return(e=2===e.nodeType?e.ownerElement:e.parentNode)&&(null===t||z(e).includes(t))?e:null}getPreviousSibling(e,t=null){for(e=e.previousSibling;e;e=e.previousSibling)if(null===t||z(e).includes(t))return e;return null}};var j=new class{insertBefore(e,t,n){return e.insertBefore(t,n)}removeAttributeNS(e,t,n){return e.removeAttributeNS(t,n)}removeChild(e,t){return e.removeChild(t)}setAttributeNS(e,t,n,i){e.setAttributeNS(t,n,i)}setData(e,t){e.data=t}};class q{constructor(e){this.h=e}insertBefore(e,t,n){return this.h.insertBefore(e,t,n)}removeAttributeNS(e,t,n){return this.h.removeAttributeNS(e,t,n)}removeChild(e,t){return this.h.removeChild(e,t)}setAttributeNS(e,t,n,i){this.h.setAttributeNS(e,t,n,i)}setData(e,t){this.h.setData(e,t)}}function G(e){return void 0!==e.Ra}function W(e,t,n){let i=null;return t&&(G(t.node)?i={G:t.G,offset:n,parent:t.node}:t.G&&(i=t.G)),{node:e,G:i}}function H(e,t,n=null){return e.getAllAttributes(t.node,n).map((e=>W(e,t,e.nodeName)))}function Y(e,t,n){return G(t=t.node)?(e=t.attributes.find((e=>n===e.name)))?e.value:null:(e=e.h.getAttribute(t,n))?e:null}function J(e,t,n=null){return e.getChildNodes(t.node,n).map(((e,n)=>W(e,t,n)))}function K(e,t){return e.getData(t.node)}function ee(e,t,n=null){const i=t.node;return G(i)?e=i.childNodes[0]:((n=e.h.getFirstChild(i,n))&&10===n.nodeType&&(n=e.h.getNextSibling(n)),e=n),e?W(e,t,0):null}function te(e,t,n=null){var i=t.node;return G(i)?(e=i.childNodes.length-1,i=i.childNodes[e]):((i=e.h.getLastChild(i,n))&&10===i.nodeType&&(i=e.h.getPreviousSibling(i)),e=e.getChildNodes(t.node,n).length-1),i?W(i,t,e):null}function ne(e,t,n=null){const i=t.node,r=t.G;if(r)"number"==typeof r.offset&&i===r.parent.childNodes[r.offset]||"string"==typeof r.offset&&i===r.parent.attributes.find((e=>r.offset===e.nodeName))?(e=r.parent,t=r.G):(e=e.getParentNode(i,n),t=r);else{if(G(i))return null;e=e.getParentNode(i,n),t=null}return e?{node:e,G:t}:null}function ie(e,t,n=null){const i=t.node;let r,s,o;const a=t.G;if(G(i))a&&(o=a.offset+1,r=a.parent.childNodes[o]);else{if(!a){for(r=i;r&&(!(r=e.h.getNextSibling(r,n))||10===r.nodeType););return r?{node:r,G:null}:null}o=a.offset+1,s=ne(e,t,null),r=e.getChildNodes(s.node,n)[o]}return r?W(r,s||ne(e,t,n),o):null}function re(e,t,n=null){const i=t.node;let r,s;const o=t.G;let a;if(G(i))o&&(a=o.offset-1,r=o.parent.childNodes[a]);else{if(!o){for(r=i;r&&(!(r=e.h.getPreviousSibling(r,n))||10===r.nodeType););return r?{node:r,G:null}:null}a=o.offset-1,s=ne(e,t,null),r=e.getChildNodes(s.node,n)[a]}return r?W(r,s||ne(e,t,n),a):null}var se=class{constructor(e){this.h=e,this.o=[]}getAllAttributes(e,t=null){return G(e)?e.attributes:this.h.getAllAttributes(e,t)}getChildNodes(e,t=null){return t=G(e)?e.childNodes:this.h.getChildNodes(e,t),9===e.nodeType?t.filter((e=>10!==e.nodeType)):t}getData(e){return G(e)?2===e.nodeType?e.value:e.data:this.h.getData(e)||""}getParentNode(e,t=null){return this.h.getParentNode(e,t)}},oe=(e,t,n,i,r)=>r.N((([e])=>i.N((([t])=>{const n=e.value;if(0>=n||n>t.h.length)throw Error("FOAY0001: array position out of bounds.");return t.h[n-1]()})))),ae=class extends L{constructor(e){super({value:(e,t,n,i)=>oe(0,0,0,D.m(this),i),localName:"get",namespaceURI:"http://www.w3.org/2005/xpath-functions/array",j:[{type:5,g:3}],arity:1,i:{type:59,g:2}}),this.type=62,this.h=e}};function le(e){switch(e.node.nodeType){case 2:return 47;case 1:return 54;case 3:case 4:return 56;case 7:return 57;case 8:return 58;case 9:return 55;default:return 53}}function he(e){return{type:le(e),value:e}}function ce(e,t){return e=e.map((e=>e.first())),t(e)}function ue(e,t){var n=A(e.type,1)||A(e.type,20)||A(e.type,19),i=A(t.type,1)||A(t.type,20)||A(t.type,19);return n&&i?e.value===t.value:(n=A(e.type,4)||A(e.type,3)||A(e.type,6),i=A(t.type,4)||A(t.type,3)||A(t.type,6),n&&i?!(!isNaN(e.value)||!isNaN(t.value))||e.value===t.value:(n=A(e.type,0)||A(e.type,22)||A(e.type,18)||A(e.type,23)||A(e.type,44),i=A(t.type,0)||A(t.type,22)||A(t.type,18)||A(t.type,23)||A(t.type,44),!(!n||!i)&&e.value===t.value))}var de=(e,t,n,i,r)=>ce([i,r],(([e,t])=>(e=e.h.find((e=>ue(e.key,t))))?e.value():D.empty())),pe=class extends L{constructor(e){super({j:[{type:59,g:3}],arity:1,localName:"get",namespaceURI:"http://www.w3.org/2005/xpath-functions/map",value:(e,t,n,i)=>de(0,0,0,D.m(this),i),i:{type:59,g:2}}),this.type=61,this.h=e}};function fe(e,t){return e.h()===t.h()&&e.o()===t.o()}var me=class{$a(){return 0}getHours(){return 0}getMinutes(){return 0}ab(){return 0}h(){return 0}o(){return 0}getSeconds(){return 0}bb(){return 0}na(){return!0}};function ge(e){var t=Math.abs(e.$a()),n=Math.abs(e.getHours());const i=Math.abs(e.getMinutes());return n=(n?`${n}H`:"")+(i?`${i}M`:"")+((e=Math.abs(e.getSeconds()))?`${e}S`:""),(t=""+(t?`${t}D`:""))&&n?`${t}T${n}`:t||(n?`T${n}`:"T0S")}var Oe=class extends me{constructor(e){if(super(),e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error("FODT0002: Number of seconds given to construct DayTimeDuration overflows MAX_SAFE_INTEGER or MIN_SAFE_INTEGER");this.ca=e}$a(){return Math.trunc(this.ca/86400)}getHours(){return Math.trunc(this.ca%86400/3600)}getMinutes(){return Math.trunc(this.ca%3600/60)}o(){return this.ca}getSeconds(){const e=this.ca%60;return Object.is(-0,e)?0:e}na(){return!Object.is(-0,this.ca)&&0<=this.ca}toString(){return(this.na()?"P":"-P")+ge(this)}},ye=(e,t,n,i,r,s)=>(e=86400*e+3600*t+60*n+i+r,new Oe(s||0===e?e:-e)),ve=e=>(e=/^(-)?P(\d+Y)?(\d+M)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+(\.\d*)?S)?)?$/.exec(e))?ye(e[4]?parseInt(e[4],10):0,e[5]?parseInt(e[5],10):0,e[6]?parseInt(e[6],10):0,e[7]?parseInt(e[7],10):0,e[8]?parseFloat(e[8]):0,!e[1]):null,be=e=>"Z"===(e=/^(Z)|([+-])([01]\d):([0-5]\d)$/.exec(e))[1]?ye(0,0,0,0,0,!0):ye(0,e[3]?parseInt(e[3],10):0,e[4]?parseInt(e[4],10):0,0,0,"+"===e[2]);function we(e,t){if(isNaN(t))throw Error("FOCA0005: Cannot multiply xs:dayTimeDuration by NaN");if((e=e.ca*t)>Number.MAX_SAFE_INTEGER||!Number.isFinite(e))throw Error("FODT0002: Value overflow while multiplying xs:dayTimeDuration");return new Oe(e<Number.MIN_SAFE_INTEGER||Object.is(-0,e)?0:e)}function xe(e){return e?parseInt(e,10):null}function Se(e){const t=(e+="").startsWith("-");return t&&(e=e.substring(1)),(t?"-":"")+e.padStart(4,"0")}function ke(e){return(e+"").padStart(2,"0")}function Ae(e){return 1===(e+="").split(".")[0].length&&(e=e.padStart(e.length+1,"0")),e}function Ce(e){return 0===e.getHours()&&0===e.getMinutes()?"Z":(e.na()?"+":"-")+ke(Math.abs(e.getHours()))+":"+ke(Math.abs(e.getMinutes()))}function _e(e){var t=/^(?:(-?\d{4,}))?(?:--?(\d\d))?(?:-{1,3}(\d\d))?(T)?(?:(\d\d):(\d\d):(\d\d))?(\.\d+)?(Z|(?:[+-]\d\d:\d\d))?$/.exec(e);e=t[1]?parseInt(t[1],10):null;const n=xe(t[2]),i=xe(t[3]),r=t[4],s=xe(t[5]),o=xe(t[6]),a=xe(t[7]),l=t[8]?parseFloat(t[8]):0;if(t=t[9]?be(t[9]):null,e&&(-271821>e||273860<e))throw Error("FODT0001: Datetime year is out of bounds");return r?new Pe(e,n,i,s,o,a,l,t,9):null!==s&&null!==o&&null!==a?new Pe(1972,12,31,s,o,a,l,t,8):null!==e&&null!==n&&null!==i?new Pe(e,n,i,0,0,0,0,t,7):null!==e&&null!==n?new Pe(e,n,1,0,0,0,0,t,11):null!==n&&null!==i?new Pe(1972,n,i,0,0,0,0,t,13):null!==e?new Pe(e,1,1,0,0,0,0,t,12):null!==n?new Pe(1972,n,1,0,0,0,0,t,14):new Pe(1972,12,i,0,0,0,0,t,15)}function Ee(e,t){switch(t){case 15:return new Pe(1972,12,e.o,0,0,0,0,e.Y,15);case 14:return new Pe(1972,e.h,1,0,0,0,0,e.Y,14);case 12:return new Pe(e.v,1,1,0,0,0,0,e.Y,12);case 13:return new Pe(1972,e.h,e.o,0,0,0,0,e.Y,13);case 11:return new Pe(e.v,e.h,1,0,0,0,0,e.Y,11);case 8:return new Pe(1972,12,31,e.l,e.s,e.D,e.qa,e.Y,8);case 7:return new Pe(e.v,e.h,e.o,0,0,0,0,e.Y,7);default:return new Pe(e.v,e.h,e.o,e.l,e.s,e.D,e.qa,e.Y,9)}}function Te(e,t){return t=e.Y||t||be("Z"),new Date(Date.UTC(e.v,e.h-1,e.o,e.l-t.getHours(),e.s-t.getMinutes(),e.D,1e3*e.qa))}var Pe=class{constructor(e,t,n,i,r,s,o,a,l=9){this.v=e,this.h=t,this.o=n+(24===i?1:0),this.l=24===i?0:i,this.s=r,this.D=s,this.qa=o,this.Y=a,this.type=l}getDay(){return this.o}getHours(){return this.l}getMinutes(){return this.s}getMonth(){return this.h}getSeconds(){return this.D}getYear(){return this.v}toString(){switch(this.type){case 9:return Se(this.v)+"-"+ke(this.h)+"-"+ke(this.o)+"T"+ke(this.l)+":"+ke(this.s)+":"+Ae(this.D+this.qa)+(this.Y?Ce(this.Y):"");case 7:return Se(this.v)+"-"+ke(this.h)+"-"+ke(this.o)+(this.Y?Ce(this.Y):"");case 8:return ke(this.l)+":"+ke(this.s)+":"+Ae(this.D+this.qa)+(this.Y?Ce(this.Y):"");case 15:return"---"+ke(this.o)+(this.Y?Ce(this.Y):"");case 14:return"--"+ke(this.h)+(this.Y?Ce(this.Y):"");case 13:return"--"+ke(this.h)+"-"+ke(this.o)+(this.Y?Ce(this.Y):"");case 12:return Se(this.v)+(this.Y?Ce(this.Y):"");case 11:return Se(this.v)+"-"+ke(this.h)+(this.Y?Ce(this.Y):"")}throw Error("Unexpected subType")}};function $e(e,t,n){const i=Te(e,n).getTime();return i===(n=Te(t,n).getTime())?e.qa===t.qa?0:e.qa>t.qa?1:-1:i>n?1:-1}function Ne(e,t,n){return 0===$e(e,t,n)}function Ie(e,t,n){return e=(Te(e,n).getTime()-Te(t,n).getTime())/1e3,new Oe(e)}function Qe(e){throw Error(`Not implemented: adding durations to ${E[e.type]}`)}function Re(e){throw Error(`Not implemented: subtracting durations from ${E[e.type]}`)}function Me(e,t){if(null===e)return null;switch(typeof e){case"boolean":return e?y:v;case"number":return O(e,3);case"string":return O(e,1);case"object":if("nodeType"in e)return he({node:e,G:null});if(Array.isArray(e))return new ae(e.map((e=>void 0===e?()=>D.empty():X(e=null===(e=Me(e))?D.empty():D.m(e)))));if(e instanceof Date){const t=_e(e.toISOString());return O(t,t.type)}return new pe(Object.keys(e).filter((t=>void 0!==e[t])).map((t=>{var n=Me(e[t]);return n=null===n?D.empty():D.m(n),{key:O(t,1),value:X(n)}})))}throw Error(`Value ${String(e)} of type "${typeof e}" is not adaptable to an XPath value.`)}function Be(e,t){if("number"!=typeof e&&("string"!=typeof e||!m.get(t)(e)))throw Error(`Cannot convert JavaScript value '${e}' to the XPath type ${E[t]} since it is not valid.`)}function De(e,t,n){if(null===t)return null;switch(e){case 0:return t?y:v;case 1:return O(t+"",1);case 3:case 2:return Be(t,3),O(+t,3);case 4:return Be(t,e),O(+t,4);case 5:return Be(t,e),O(0|t,5);case 6:return Be(t,e),O(+t,6);case 7:case 8:case 9:case 11:case 12:case 13:case 14:case 15:if(!(t instanceof Date))throw Error(`The JavaScript value ${t} with type ${typeof t} is not a valid type to be converted to an XPath ${E[e]}.`);return O(Ee(_e(t.toISOString()),e),e);case 53:case 47:case 55:case 54:case 56:case 57:case 58:if("object"!=typeof t||!("nodeType"in t))throw Error(`The JavaScript value ${t} with type ${typeof t} is not a valid type to be converted to an XPath ${E[e]}.`);return he({node:t,G:null});case 59:case 61:return Me(t);default:throw Error(`Values of the type "${E[e]}" can not be adapted from JavaScript to equivalent XPath values.`)}}function Xe(e,t,n){if(0===n.g)return null===(t=De(n.type,t))?[]:[t];if(2===n.g||1===n.g){if(!Array.isArray(t))throw Error(`The JavaScript value ${t} should be an array if it is to be converted to ${P(n)}.`);return t.map((e=>De(n.type,e))).filter((e=>null!==e))}const i=De(n.type,t);if(null===i)throw Error(`The JavaScript value ${t} should be a single entry if it is to be converted to ${P(n)}.`);return[i]}function Fe(e,t,n={type:59,g:0}){return D.create(Xe(0,t,n))}var Le=2**32;function Ue(e,t,n,i){return new Ge({M:n,Aa:t,ta:i||e.ta,ra:e.ra},e.h,e.o)}function Ve(e,t){let n=0;const i=t.value;return{next:r=>(r=i.next(r)).done?x:S(Ue(e,n++,r.value,t))}}function ze(e){return e.h.ib||(e.h.ib=!0,e.h.qb=_e((new Date).toISOString()),e.h.vb=ve("PT0S")),e.h.qb}function Ze(e){return e.h.ib||(e.h.ib=!0,e.h.qb=_e((new Date).toISOString()),e.h.vb=ve("PT0S")),e.h.vb}function je(e,t=null){return e=29421*(null!=t?t:e.o.h)%Le,{rb:Math.floor(e),$b:e/Le}}function qe(e,t){return new Ge({M:e.M,Aa:e.Aa,ta:e.ta,ra:Object.assign(Object.create(null),e.ra,t)},e.h,e.o)}var Ge=class{constructor(e,t={qb:null,vb:null,ib:!1},n=new class{constructor(){this.h=Math.abs(Math.floor(Math.random()*Le)%Le)}}){this.h=t,this.Aa=e.Aa,this.ta=e.ta,this.M=e.M,this.ra=e.ra||Object.create(null),this.o=n}},We=class{constructor(e,t,n,i,r,s,o,a,l){this.debug=e,this.Ha=t,this.h=n,this.Ja=i,this.Ma=r,this.o=s,this.v=o,this.jb=a,this.Ua=l}};function He(e){let t=0,n=null,i=!0;return D.create({next:r=>{for(;t<e.length;){n||(n=e[t].value,i=!0);const s=n.next(i?0:r);if(i=!1,!s.done)return s;t++,n=null}return x}})}var Ye=(e,t,n)=>Error(`FORG0001: Cannot cast ${e} to ${E[t]}${n?`, ${n}`:""}`),Je=e=>Error(`XPDY0002: ${e}`),Ke=e=>Error(`XPTY0004: ${e}`),et=e=>Error(`FOTY0013: Atomization is not supported for ${E[e]}.`),tt=e=>Error(`XPST0081: The prefix ${e} could not be resolved.`);function nt(e,t){if(A(e.type,46)||A(e.type,19)||A(e.type,0)||A(e.type,4)||A(e.type,3)||A(e.type,6)||A(e.type,5)||A(e.type,2)||A(e.type,23)||A(e.type,1))return D.create(e);const n=t.h;if(A(e.type,53)){const t=e.value;if(2===t.node.nodeType||3===t.node.nodeType)return D.create(O(K(n,t),19));if(8===t.node.nodeType||7===t.node.nodeType)return D.create(O(K(n,t),1));const i=[];return function e(r){if(8!==t.node.nodeType&&7!==t.node.nodeType){var s=r.nodeType;3===s||4===s?i.push(n.getData(r)):1!==s&&9!==s&&11!==s||n.getChildNodes(r).forEach((t=>{e(t)}))}}(t.node),D.create(O(i.join(""),19))}if(A(e.type,60)&&!A(e.type,62))throw et(e.type);if(A(e.type,62))return He(e.h.map((e=>it(e(),t))));throw Error(`Atomizing ${e.type} is not implemented.`)}function it(e,t){let n=!1;const i=e.value;let r=null;return D.create({next:()=>{for(;!n;){if(!r){var e=i.next(0);if(e.done){n=!0;break}r=nt(e.value,t).value}if(!(e=r.next(0)).done)return e;r=null}return x}})}function rt(e){for(e=g[e];e&&0!==e.C;)e=e.parent;return e?e.type:null}function st(e,t){const n=(t=g[t]).Ka;if(!n||!n.whiteSpace)return t.parent?st(e,t.parent.type):e;switch(t.Ka.whiteSpace){case"replace":return e.replace(/[\u0009\u000A\u000D]/g," ");case"collapse":return e.replace(/[\u0009\u000A\u000D]/g," ").replace(/ {2,}/g," ").replace(/^ | $/g,"")}return e}function ot(e,t){for(t=g[t];t&&null===t.gb;){if(2===t.C||3===t.C)return!0;t=t.parent}return!t||t.gb(e)}function at(e,t){for(;e;){if(e.Oa&&e.Oa[t])return e.Oa[t];e=e.parent}return()=>!0}function lt(e){return!e||(2===e.g||0===e.g)}function ht(e,t){return e(2)?e=>({u:!0,value:e}):e(0)?e=>({u:!0,value:e?1:0}):e(1)||e(19)?e=>{switch(e){case"NaN":return{u:!0,value:NaN};case"INF":case"+INF":return{u:!0,value:1/0};case"-INF":return{u:!0,value:-1/0};case"0":case"+0":return{u:!0,value:0};case"-0":return{u:!0,value:-0}}const n=parseFloat(e);return isNaN(n)?{u:!1,error:Ye(e,t)}:{u:!0,value:n}}:()=>({u:!1,error:Error(`XPTY0004: Casting not supported from given type to ${t} or any of its derived types.`)})}function ct(e){const t=Math.abs(e.bb());return(t?`${t}Y`:"")+(""+((e=Math.abs(e.ab()))?`${e}M`:""))||"0M"}var ut=class extends me{constructor(e){if(super(),e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error("FODT0002: Number of months given to construct YearMonthDuration overflows MAX_SAFE_INTEGER or MIN_SAFE_INTEGER");this.ea=e}ab(){const e=this.ea%12;return 0===e?0:e}h(){return this.ea}bb(){return Math.trunc(this.ea/12)}na(){return!Object.is(-0,this.ea)&&0<=this.ea}toString(){return(this.na()?"P":"-P")+ct(this)}},dt=e=>{var t=/^(-)?P(\d+Y)?(\d+M)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+(\.\d*)?S)?)?$/.exec(e);if(t){if(e=!t[1],(t=12*(t[2]?parseInt(t[2],10):0)+(t[3]?parseInt(t[3],10):0))>Number.MAX_SAFE_INTEGER||!Number.isFinite(t))throw Error("FODT0002: Value overflow while constructing xs:yearMonthDuration");e=new ut(e||0===t?t:-t)}else e=null;return e};function pt(e,t){if(isNaN(t))throw Error("FOCA0005: Cannot multiply xs:yearMonthDuration by NaN");if((e=Math.round(e.ea*t))>Number.MAX_SAFE_INTEGER||!Number.isFinite(e))throw Error("FODT0002: Value overflow while constructing xs:yearMonthDuration");return new ut(e<Number.MIN_SAFE_INTEGER||0===e?0:e)}var ft=class extends me{constructor(e,t){super(),this.Va=e,this.Ga=t}$a(){return this.Ga.$a()}getHours(){return this.Ga.getHours()}getMinutes(){return this.Ga.getMinutes()}ab(){return this.Va.ab()}h(){return this.Va.h()}o(){return this.Ga.o()}getSeconds(){return this.Ga.getSeconds()}bb(){return this.Va.bb()}na(){return this.Va.na()&&this.Ga.na()}toString(){const e=this.na()?"P":"-P",t=ct(this.Va),n=ge(this.Ga);return"0M"===t?e+n:"T0S"===n?e+t:e+t+n}};const mt=[3,6,4,5];function gt(e){if(e(1)||e(19))return e=>({u:!0,value:e+""});if(e(20))return e=>({u:!0,value:e});if(e(23))return e=>({u:!0,value:e.prefix?`${e.prefix}:${e.localName}`:e.localName});if(e(44))return e=>({u:!0,value:e.toString()});if(e(2)){if(e(5)||e(4))return e=>({u:!0,value:(e+"").replace("e","E")});if(e(6)||e(3))return e=>isNaN(e)?{u:!0,value:"NaN"}:isFinite(e)?Object.is(e,-0)?{u:!0,value:"-0"}:{u:!0,value:(e+"").replace("e","E").replace("E+","E")}:{u:!0,value:(0>e?"-":"")+"INF"}}return e(9)||e(7)||e(8)||e(15)||e(14)||e(13)||e(12)||e(11)||e(16)||e(17)||e(18)?e=>({u:!0,value:e.toString()}):e(22)?e=>({u:!0,value:e.toUpperCase()}):e=>({u:!0,value:e+""})}const Ot=[2,5,17,16];function yt(e,t){const n=t=>A(e,t);if(39===t)return()=>({u:!1,error:Error("FORG0001: Casting to xs:error is always invalid.")});switch(t){case 19:return function(e){const t=gt(e);return e=>(e=t(e)).u?{u:!0,value:O(e.value,19)}:e}(n);case 1:return function(e){const t=gt(e);return e=>(e=t(e)).u?{u:!0,value:O(e.value,1)}:e}(n);case 6:return function(e){const t=ht(e,6);return e=>(e=t(e)).u?{u:!0,value:O(e.value,6)}:e}(n);case 3:return function(e){const t=ht(e,3);return e=>(e=t(e)).u?{u:!0,value:O(e.value,3)}:e}(n);case 4:return function(e){return e(5)?e=>({u:!0,value:O(e,4)}):e(6)||e(3)?e=>isNaN(e)||!isFinite(e)?{u:!1,error:Error(`FOCA0002: Can not cast ${e} to xs:decimal`)}:Math.abs(e)>Number.MAX_VALUE?{u:!1,error:Error(`FOAR0002: Can not cast ${e} to xs:decimal, it is out of bounds for JavaScript numbers`)}:{u:!0,value:O(e,4)}:e(0)?e=>({u:!0,value:O(e?1:0,4)}):e(1)||e(19)?e=>{const t=parseFloat(e);return!isNaN(t)||isFinite(t)?{u:!0,value:O(t,4)}:{u:!1,error:Error(`FORG0001: Can not cast ${e} to xs:decimal`)}}:()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:decimal or any of its derived types.")})}(n);case 5:return function(e){return e(0)?e=>({u:!0,value:O(e?1:0,5)}):e(2)?e=>{const t=Math.trunc(e);return!isFinite(t)||isNaN(t)?{u:!1,error:Error(`FOCA0002: can not cast ${e} to xs:integer`)}:Number.isSafeInteger(t)?{u:!0,value:O(t,5)}:{u:!1,error:Error(`FOAR0002: can not cast ${e} to xs:integer, it is out of bounds for JavaScript numbers.`)}}:e(1)||e(19)?e=>{const t=parseInt(e,10);return isNaN(t)?{u:!1,error:Ye(e,5)}:Number.isSafeInteger(t)?{u:!0,value:O(t,5)}:{u:!1,error:Error(`FOCA0003: can not cast ${e} to xs:integer, it is out of bounds for JavaScript numbers.`)}}:()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:integer or any of its derived types.")})}(n);case 2:return function(e){var t=yt;return n=>{for(const i of mt){const r=t(e,i)(n);if(r.u)return r}return{u:!1,error:Error(`XPTY0004: Casting not supported from "${n}" given type to xs:numeric or any of its derived types.`)}}}(e);case 18:return function(e){return e(16)?e=>({u:!0,value:O(new ft(e,new Oe(e.na()?0:-0)),18)}):e(17)?e=>({u:!0,value:O(e=new ft(new ut(e.na()?0:-0),e),18)}):e(18)?e=>({u:!0,value:O(e,18)}):e(19)||e(1)?e=>({u:!0,value:O(new ft(dt(e),ve(e)),18)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:duration or any of its derived types.")})}(n);case 16:return function(e){return e(18)&&!e(17)?e=>({u:!0,value:O(e.Va,16)}):e(17)?()=>({u:!0,value:O(dt("P0M"),16)}):e(19)||e(1)?e=>{const t=dt(e);return t?{u:!0,value:O(t,16)}:{u:!1,error:Ye(e,16)}}:()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:yearMonthDuration or any of its derived types.")})}(n);case 17:return function(e){return e(18)&&!e(16)?e=>({u:!0,value:O(e.Ga,17)}):e(16)?()=>({u:!0,value:O(ve("PT0.0S"),17)}):e(19)||e(1)?e=>{const t=ve(e);return t?{u:!0,value:O(t,17)}:{u:!1,error:Error(`FORG0001: Can not cast ${e} to xs:dayTimeDuration`)}}:()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:dayTimeDuration or any of its derived types.")})}(n);case 9:return function(e){return e(7)?e=>({u:!0,value:O(Ee(e,9),9)}):e(19)||e(1)?e=>({u:!0,value:O(_e(e),9)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:dateTime or any of its derived types.")})}(n);case 8:return function(e){return e(9)?e=>({u:!0,value:O(Ee(e,8),8)}):e(19)||e(1)?e=>({u:!0,value:O(_e(e),8)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:time or any of its derived types.")})}(n);case 7:return function(e){return e(9)?e=>({u:!0,value:O(Ee(e,7),7)}):e(19)||e(1)?e=>({u:!0,value:O(_e(e),7)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:date or any of its derived types.")})}(n);case 11:return function(e){return e(7)||e(9)?e=>({u:!0,value:O(Ee(e,11),11)}):e(19)||e(1)?e=>({u:!0,value:O(_e(e),11)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gYearMonth or any of its derived types.")})}(n);case 12:return function(e){return e(7)||e(9)?e=>({u:!0,value:O(Ee(e,12),12)}):e(19)||e(1)?e=>({u:!0,value:O(_e(e),12)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gYear or any of its derived types.")})}(n);case 13:return function(e){return e(7)||e(9)?e=>({u:!0,value:O(Ee(e,13),13)}):e(19)||e(1)?e=>({u:!0,value:O(_e(e),13)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gMonthDay or any of its derived types.")})}(n);case 15:return function(e){return e(7)||e(9)?e=>({u:!0,value:O(Ee(e,15),15)}):e(19)||e(1)?e=>({u:!0,value:O(_e(e),15)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gDay or any of its derived types.")})}(n);case 14:return function(e){return e(7)||e(9)?e=>({u:!0,value:O(Ee(e,14),14)}):e(19)||e(1)?e=>({u:!0,value:O(_e(e),14)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:gMonth or any of its derived types.")})}(n);case 0:return function(e){return e(2)?e=>({u:!0,value:0===e||isNaN(e)?v:y}):e(1)||e(19)?e=>{switch(e){case"true":case"1":return{u:!0,value:y};case"false":case"0":return{u:!0,value:v};default:return{u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:boolean or any of its derived types.")}}}:()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:boolean or any of its derived types.")})}(n);case 21:return function(e){return e(22)?e=>{let t="";for(let n=0;n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return{u:!0,value:O(btoa(t),21)}}:e(1)||e(19)?e=>({u:!0,value:O(e,21)}):()=>({error:Error("XPTY0004: Casting not supported from given type to xs:base64Binary or any of its derived types."),u:!1})}(n);case 22:return function(e){return e(21)?e=>{let t="";for(let n=0,i=(e=atob(e)).length;n<i;n++)t+=Number(e.charCodeAt(n)).toString(16);return{u:!0,value:O(t.toUpperCase(),22)}}:e(1)||e(19)?e=>({u:!0,value:O(e,22)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:hexBinary or any of its derived types.")})}(n);case 20:return function(e){return e(1)||e(19)?e=>({u:!0,value:O(e,20)}):()=>({u:!1,error:Error("XPTY0004: Casting not supported from given type to xs:anyURI or any of its derived types.")})}(n);case 23:throw Error("Casting to xs:QName is not implemented.")}return()=>({u:!1,error:Error(`XPTY0004: Casting not supported from ${e} to ${t}.`)})}const vt=Object.create(null);function bt(e,t){if(19===e&&1===t)return e=>({u:!0,value:O(e,1)});if(44===t)return()=>({u:!1,error:Error("XPST0080: Casting to xs:NOTATION is not permitted.")});if(39===t)return()=>({u:!1,error:Error("FORG0001: Casting to xs:error is not permitted.")});if(45===e||45===t)return()=>({u:!1,error:Error("XPST0080: Casting from or to xs:anySimpleType is not permitted.")});if(46===e||46===t)return()=>({u:!1,error:Error("XPST0080: Casting from or to xs:anyAtomicType is not permitted.")});if(A(e,60)&&1===t)return()=>({u:!1,error:Error("FOTY0014: Casting from function item to xs:string is not permitted.")});if(e===t)return e=>({u:!0,value:{type:t,value:e}});const n=Ot.includes(e)?e:rt(e),i=Ot.includes(t)?t:rt(t);if(null===i||null===n)return()=>({u:!1,error:Error(`XPST0081: Can not cast: type ${i?E[e]:E[t]} is unknown.`)});const r=[];return 1!==n&&19!==n||r.push((e=>{const n=st(e,t);return ot(n,t)?{u:!0,value:n}:{u:!1,error:Ye(e,t,"pattern validation failed.")}})),n!==i&&(r.push(yt(n,i)),r.push((e=>({u:!0,value:e.value})))),19!==i&&1!==i||r.push((e=>ot(e,t)?{u:!0,value:e}:{u:!1,error:Ye(e,t,"pattern validation failed.")})),r.push((e=>function(e,t){let n=g[t];for(;n;){if(n.Ka&&!Object.keys(n.Ka).every((t=>{if("whiteSpace"===t)return!0;const i=at(n,t);return!i||i(e,n.Ka[t])})))return!1;n=n.parent}return!0}(e,t)?{u:!0,value:e}:{u:!1,error:Ye(e,t,"pattern validation failed.")})),r.push((e=>({u:!0,value:{type:t,value:e}}))),e=>{e={u:!0,value:e};for(let t=0,n=r.length;t<n&&(e=r[t](e.value),!1!==e.u);++t);return e}}function wt(e,t){const n=e.type+1e4*t;let i=vt[n];return i||=vt[n]=bt(e.type,t),i.call(void 0,e.value,t)}function xt(e,t){if(!0===(e=wt(e,t)).u)return e.value;throw e.error}function St(e){let t=!1;return{next:()=>t?x:(t=!0,S(e))}}function kt(e,t){return e===t||!(!e||!t||e.offset!==t.offset||e.parent!==t.parent)&&kt(e.G,t.G)}function At(e,t){return!!(e===t||e.node===t.node&&kt(e.G,t.G))}function Ct(e,t){const n=[];for(;t;t=ne(e,t,null))n.unshift(t);return n}function _t(e,t){const n=[];for(;t;t=e.getParentNode(t,null))n.unshift(t);return n}function Et(e,t,n,i){if(n.G||i.G||G(n.node)||G(i.node)){if(At(n,i))return 0;n=Ct(t,n),i=Ct(t,i);const s=n[0],o=i[0];if(!At(s,o))return t=e.findIndex((e=>At(e,s))),n=e.findIndex((e=>At(e,o))),-1===t&&(t=e.push(s)),-1===n&&(n=e.push(o)),t-n;e=1;for(var r=Math.min(n.length,i.length);e<r&&At(n[e],i[e]);++e);return n[e]?i[e]?function(e,t,n){var i=ne(e,t,null);for(let r=0,s=(e=J(e,i,null)).length;r<s;++r){if(i=e[r],At(i,t))return-1;if(At(i,n))return 1}}(t,n[e],i[e]):1:-1}if((n=n.node)===(r=i.node))return 0;if(i=_t(t,n),n=_t(t,r),i[0]!==n[0]){const r={node:i[0],G:null},s={node:n[0],G:null};return t=e.findIndex((e=>At(e,r))),n=e.findIndex((e=>At(e,s))),-1===t&&(t=e.push(r)),-1===n&&(n=e.push(s)),t-n}for(e=1,r=Math.min(i.length,n.length);e<r&&i[e]===n[e];++e);if(i=i[e],r=n[e],!i)return-1;if(!r)return 1;for(let s=0,o=(t=t.getChildNodes(n[e-1],null)).length;s<o;++s){if(e=t[s],e===i)return-1;if(e===r)return 1}}function Tt(e,t,n,i){const r=A(n.type,47),s=A(i.type,47);if(r&&!s){if(At(n=ne(t,n.value),i=i.value))return 1}else if(s&&!r){if(At(n=n.value,i=ne(t,i.value)))return-1}else if(r&&s){if(At(ne(t,i.value),ne(t,n.value)))return n.value.node.localName>i.value.node.localName?1:-1;n=ne(t,n.value),i=ne(t,i.value)}else n=n.value,i=i.value;return Et(e,t,n,i)}function Pt(e,t,n){return Tt(e.o,e,t,n)}function $t(e,t){return It(t,((t,n)=>Tt(e.o,e,t,n))).filter(((e,t,n)=>0===t||!At(e.value,n[t-1].value)))}const Nt=(e,t)=>e<t?-1:0;function It(e,t=Nt){if(1>=e.length)return e;var n=Math.floor(e.length/2);const i=It(e.slice(0,n),t);for(e=It(e.slice(n),t),n=[];i.length&&e.length;)0>t(i[0],e[0])?n.push(i.shift()):n.push(e.shift());return n.concat(i.concat(e))}var Qt=e;function Rt(e,t,n,i,r){if(A(e.type,t.type))return e;if(A(t.type,46)&&A(e.type,53)&&(e=nt(e,n).first()),A(e.type,t.type)||46===t.type)return e;if(A(e.type,19)){if(!(n=xt(e,t.type)))throw Error(`XPTY0004 Unable to convert ${r?"return":"argument"} of type ${E[e.type]} to type ${P(t)} while calling ${i}`);return n}if(n=function(e,t){if(A(e.type,2)){if(A(e.type,6))return 3===t?O(e.value,3):null;if(A(e.type,4)){if(6===t)return O(e.value,6);if(3===t)return O(e.value,3)}return null}return A(e.type,20)&&1===t?O(e.value,1):null}(e,t.type),!n)throw Error(`XPTY0004 Unable to cast ${r?"return":"argument"} of type ${E[e.type]} to type ${P(t)} while calling ${i}`);return n}function Mt(e){switch(e){case 2:return"*";case 1:return"+";case 0:return"?";case 3:return""}}var Bt=(e,t,n,i,r)=>0===e.g?t.X({default:()=>t.map((t=>Rt(t,e,n,i,r))),multiple:()=>{throw Error(`XPTY0004: Multiplicity of ${r?"function return value":"function argument"} of type ${E[e.type]}${Mt(e.g)} for ${i} is incorrect. Expected "?", but got "+".`)}}):1===e.g?t.X({empty:()=>{throw Error(`XPTY0004: Multiplicity of ${r?"function return value":"function argument"} of type ${E[e.type]}${Mt(e.g)} for ${i} is incorrect. Expected "+", but got "empty-sequence()"`)},default:()=>t.map((t=>Rt(t,e,n,i,r)))}):2===e.g?t.map((t=>Rt(t,e,n,i,r))):t.X({m:()=>t.map((t=>Rt(t,e,n,i,r))),default:()=>{throw Error(`XPTY0004: Multiplicity of ${r?"function return value":"function argument"} of type ${E[e.type]}${Mt(e.g)} for ${i} is incorrect. Expected exactly one`)}});function Dt(e,t){return A(e,5)?O(t,5):A(e,6)?O(t,6):A(e,3)?O(t,3):O(t,4)}const Xt=[{la:"M",ja:1e3},{la:"CM",ja:900},{la:"D",ja:500},{la:"CD",ja:400},{la:"C",ja:100},{la:"XC",ja:90},{la:"L",ja:50},{la:"XL",ja:40},{la:"X",ja:10},{la:"IX",ja:9},{la:"V",ja:5},{la:"IV",ja:4},{la:"I",ja:1}];function Ft(e,t){const n=0>e;if(!(e=Math.abs(e)))return"-";let i=Xt.reduce(((t,n)=>{const i=Math.floor(e/n.ja);return e-=i*n.ja,t+n.la.repeat(i)}),"");return t&&(i=i.toLowerCase()),n&&(i=`-${i}`),i}const Lt="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");function Ut(e,t){const n=0>e;if(!(e=Math.abs(e)))return"-";let i,r="";for(;0<e;)i=(e-1)%Lt.length,r=Lt[i]+r,e=(e-i)/Lt.length|0;return t&&(r=r.toLowerCase()),n&&(r=`-${r}`),r}function Vt(e,t,n=[]){return Array.from({length:t},((t,n)=>n+e)).filter((e=>!n.includes(e)))}const zt=Vt(1488,27,[1498,1501,1503,1507,1509]),Zt=Vt(1575,36,[1577,1595,1596,1597,1598,1599,1600,1609]),jt="".split(""),qt=[[1e3,""],[900,""],[800,""],[700,""],[600,""],[500,""],[400,""],[300,""],[200,""],[100,""],[90,""],[80,""],[70,""],[60,""],[50,""],[40,""],[30,""],[20,""],[10,""],[9,""],[8,""],[7,""],[6,""],[5,""],[4,""],[3,""],[2,""],[1,""]],Gt=[[400,""],[300,""],[200,""],[100,""],[90,""],[80,""],[70,""],[60,""],[50,""],[40,""],[30,""],[20,""],[10,""],[9,""],[8,""],[7,""],[6,""],[5,""],[4,""],[3,""],[2,""],[1,""]];function Wt(e,t=[]){var n=25;return t.sort(((e,t)=>e-t)),n-=t.length,function(i){const r=0>i;if(!(i=Math.abs(i)))return"-";const s=[];for(;0<i;){let r=e+(i-1)%n;t.forEach((e=>{r>=e&&r++})),s.unshift(String.fromCodePoint(r)),i=Math.floor((i-1)/n)}return i=s.join(""),r&&(i=`-${i}`),i}}const Ht=Wt(945,[962]),Yt=Wt(913,[930]);function Jt(e){return new Intl.NumberFormat([],{numberingSystem:"arab",useGrouping:!1}).format(e)}function Kt(e){return new Intl.NumberFormat([],{numberingSystem:"arabext",useGrouping:!1}).format(e)}const en=new Map([["A",function(e){return Ut(e,!1)}],["a",function(e){return Ut(e,!0)}],["I",function(e){return Ft(e,!1)}],["i",function(e){return Ft(e,!0)}],["lowerGreek",Ht],["",Ht],["upperGreek",Yt],["",Yt],["arabicAbjadi",function(e){const t=0>e;return(e=Math.abs(e))?(e=Array(Math.floor((e-1)/jt.length)+1).fill(jt[(e-1)%jt.length]).join(String.fromCodePoint(8204)),t&&(e=`-${e}`),e):"-"}],["arabicAbjadNumeral",function(e){const t=0>e;if(!(e=Math.abs(e)))return"-";var n=[],i=Math.floor(e/1e3);if(e-=1e3*i,1===i)n.push(qt[0][1]);else if(1<i){for(const[e,t]of qt){var r=e;const s=t;for(;i>=r;)n.push(s),i-=r}n.push(qt[0][1])}for(const[t,s]of qt)for(i=t,r=s;e>=i;)e-=i,n.push(r);return n=n.join(""),t&&(n=`-${n}`),n}],["arabicAlifBaTa",function(e){const t=0>e;return(e=Math.abs(e))?(e=Array(Math.floor((e-1)/Zt.length)+1).fill(String.fromCodePoint(Zt[(e-1)%Zt.length])).join(String.fromCodePoint(8204)),t&&(e=`-${e}`),e):"-"}],["hebrewAlefBet",function(e){const t=0>e;if(!(e=Math.abs(e)))return"-";var n=Math.floor((e-1)/zt.length);const i=String.fromCodePoint(1514);return(n=Array(n).fill(i)).push(String.fromCodePoint(zt[(e-1)%zt.length])),e=n.join(""),t&&(e=`-${e}`),e}],["hebrewNumeral",function(e){const t=0>e;if(!(e=Math.abs(e)))return"-";var n=[],i=Math.floor(e/400);e-=400*i;for(var r=0;r<i;r++)n.push("");for(const[t,s]of Gt)for(i=t,r=s;e>=i;)e-=i,n.push(r);return""===(e=n.slice(-2).join(""))&&n.splice(-2,2,"",""),""===e&&n.splice(-2,2,"",""),n=n.join(""),t&&(n=`-${n}`),n}],["arabicIndicNumeral",Jt],["",Jt],["",Jt],["",Jt],["",Jt],["",Jt],["",Jt],["",Jt],["",Jt],["",Jt],["persianNumeral",Kt],["",Kt],["",Kt],["",Kt],["",Kt],["",Kt],["",Kt],["",Kt],["",Kt],["",Kt]]);function tn(e,t,n,i,r,s){let o=!1;return D.create({next:()=>{if(o)return x;const t=r.first();if(!t)return o=!0,x;if((A(t.type,6)||A(t.type,3))&&(0===t.value||isNaN(t.value)||1/0===t.value||-1/0===t.value))return o=!0,S(t);var n;if(n=s?s.first().value:0,o=!0,function(e){if(Math.floor(e)===e||isNaN(e))return 0;const t=(e=/\d+(?:\.(\d*))?(?:[Ee](-)?(\d+))*/.exec(`${e}`))[1]?e[1].length:0;return e[3]?e[2]?t+parseInt(e[3],10):0>(e=t-parseInt(e[3],10))?0:e:t}(t.value)<n)return S(t);const i=[5,4,3,6].find((e=>A(t.type,e)));switch(n=function(e,t,n){return t&&0==e*n%1%.5?0==Math.floor(e*n)%2?Math.floor(e*n)/n:Math.ceil(e*n)/n:Math.round(e*n)/n}(xt(t,4).value,e,Math.pow(10,n)),i){case 4:return S(O(n,4));case 3:return S(O(n,3));case 6:return S(O(n,6));case 5:return S(O(n,5))}}})}const nn=(e,t,n,i)=>it(i,t).X({empty:()=>D.m(O(NaN,3)),m:()=>{const e=wt(i.first(),3);return e.u?D.m(e.value):D.m(O(NaN,3))},multiple:()=>{throw Error("fn:number may only be called with zero or one values")}});const rn=(e,t,n,i=D.empty())=>(t=i.F()?je(e):je(e,function(e){let t=5381;for(let n=0;n<e.length;++n)t=33*t+e.charCodeAt(n),t%=Number.MAX_SAFE_INTEGER;return t}(xt(i.first(),1).value)),function t(n){const i=(t,i,r,s)=>{if(s.F()||s.oa())return s;for(t=s.O(),i=n,r=t.length-1;1<r;r--){const n=t[s=(i=je(e,i).rb)%r];t[s]=t[r],t[r]=n}return D.create(t)};return D.m(new pe([{key:O("number",1),value:()=>D.m(O(je(e,n).$b,3))},{key:O("next",1),value:()=>D.m(new L({value:()=>t(je(e,n).rb),Ya:!0,localName:"",namespaceURI:"",j:[],arity:0,i:{type:61,g:3}}))},{key:O("permute",1),value:()=>D.m(new L({value:i,Ya:!0,localName:"",namespaceURI:"",j:[{type:59,g:2}],arity:1,i:{type:59,g:2}}))}]))}(t.rb));var sn=[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"abs",j:[{type:2,g:0}],i:{type:2,g:0},callFunction:(e,t,n,i)=>i.map((e=>Dt(e.type,Math.abs(e.value))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"format-integer",j:[{type:5,g:0},{type:1,g:3}],i:{type:1,g:3},callFunction:(e,t,n,i,r)=>(e=i.first(),r=r.first(),i.F()?D.m(O("",1)):(i=en.get(r.value),r=e.value,i?(i=i(r),D.m(O(i,1))):D.m(O(r.toString(),1))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"ceiling",j:[{type:2,g:0}],i:{type:2,g:0},callFunction:(e,t,n,i)=>i.map((e=>Dt(e.type,Math.ceil(e.value))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"floor",j:[{type:2,g:0}],i:{type:2,g:0},callFunction:(e,t,n,i)=>i.map((e=>Dt(e.type,Math.floor(e.value))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"round",j:[{type:2,g:0}],i:{type:2,g:0},callFunction:tn.bind(null,!1)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"round",j:[{type:2,g:0},{type:5,g:3}],i:{type:2,g:0},callFunction:tn.bind(null,!1)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"round-half-to-even",j:[{type:2,g:0}],i:{type:2,g:0},callFunction:tn.bind(null,!0)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"round-half-to-even",j:[{type:2,g:0},{type:5,g:3}],i:{type:2,g:0},callFunction:tn.bind(null,!0)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"number",j:[{type:46,g:0}],i:{type:3,g:3},callFunction:nn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"number",j:[],i:{type:3,g:3},callFunction:(e,t,n)=>{const i=e.M&&Bt({type:46,g:0},D.m(e.M),t,"fn:number",!1);if(!i)throw Je("fn:number needs an atomizable context item.");return nn(0,t,0,i)}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"random-number-generator",j:[],i:{type:61,g:3},callFunction:rn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"random-number-generator",j:[{type:46,g:0}],i:{type:61,g:3},callFunction:rn}];function on(){throw Error("FOCH0002: No collations are supported")}function an(e,t,n,i){if(null===t.M)throw Je("The function which was called depends on dynamic context, which is absent.");return e(t,n,i,D.m(t.M))}const ln=(e,t,n,i)=>i.X({empty:()=>D.m(O("",1)),default:()=>i.map((e=>{if(A(e.type,53)){const n=nt(e,t).first();return A(e.type,47)?xt(n,1):n}return xt(e,1)}))}),hn=(e,t,n,i,r)=>ce([r],(([e])=>it(i,t).N((t=>(t=t.map((e=>xt(e,1).value)).join(e.value),D.m(O(t,1))))))),cn=(e,t,n,i)=>i.F()?D.m(O(0,5)):(e=i.first().value,D.m(O(Array.from(e).length,5))),un=(e,t,n,i,r,s)=>{const o=tn(!1,0,0,0,r,null),a=null!==s?tn(!1,0,0,0,s,null):null;let l=!1,h=null,c=null,u=null;return D.create({next:()=>l?x:h||(h=i.first(),null!==h)?(c||=o.first(),!u&&s&&(u=null,u=a.first()),l=!0,S(O(Array.from(h.value).slice(Math.max(c.value-1,0),s?c.value+u.value-1:void 0).join(""),1))):(l=!0,S(O("",1)))})},dn=(e,t,n,i,r)=>{if(i.F()||0===i.first().value.length)return D.empty();for(e=i.first().value,(r=gn(r=r.first().value)).lastIndex=0,t=[],n=r.exec(e),i=0;n;)t.push(e.slice(i,n.index)),i=r.lastIndex,n=r.exec(e);return t.push(e.slice(i)),D.create(t.map((e=>O(e,1))))},pn=(e,t,n,i)=>i.F()?D.m(O("",1)):(e=i.first().value.trim(),D.m(O(e.replace(/\s+/g," "),1))),fn=new Map,mn=new Map;function gn(e){if(mn.has(e))return mn.get(e);let t;try{t=new RegExp(e,"g")}catch(e){throw Error(`FORX0002: ${e}`)}if(t.test(""))throw Error(`FORX0003: the pattern ${e} matches the zero length string`);return mn.set(e,t),t}var On=[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"compare",j:[{type:1,g:0},{type:1,g:0}],i:{type:5,g:0},callFunction:(e,t,n,i,r)=>i.F()||r.F()?D.empty():(e=i.first().value)>(r=r.first().value)?D.m(O(1,5)):e<r?D.m(O(-1,5)):D.m(O(0,5))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"compare",j:[{type:1,g:0},{type:1,g:0},{type:1,g:3}],i:{type:5,g:0},callFunction:on},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"concat",j:[{type:46,g:0},{type:46,g:0},4],i:{type:1,g:3},callFunction:(e,t,n,...i)=>(i=i.map((e=>it(e,t).N((e=>D.m(O(e.map((e=>null===e?"":xt(e,1).value)).join(""),1)))))),ce(i,(e=>D.m(O(e.map((e=>e.value)).join(""),1)))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"contains",j:[{type:1,g:0},{type:1,g:0},{type:1,g:0}],i:{type:0,g:3},callFunction:on},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"contains",j:[{type:1,g:0},{type:1,g:0}],i:{type:0,g:3},callFunction:(e,t,n,i,r)=>(e=i.F()?"":i.first().value,0===(r=r.F()?"":r.first().value).length?D.aa():0===e.length?D.T():e.includes(r)?D.aa():D.T())},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"ends-with",j:[{type:1,g:0},{type:1,g:0}],i:{type:0,g:3},callFunction:(e,t,n,i,r)=>0===(e=r.F()?"":r.first().value).length?D.aa():0===(i=i.F()?"":i.first().value).length?D.T():i.endsWith(e)?D.aa():D.T()},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"ends-with",j:[{type:1,g:0},{type:1,g:0},{type:1,g:3}],i:{type:0,g:3},callFunction:on},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"normalize-space",j:[{type:1,g:0}],i:{type:1,g:3},callFunction:pn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"normalize-space",j:[],i:{type:1,g:3},callFunction:an.bind(null,((e,t,n,i)=>pn(e,0,0,ln(0,t,0,i))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"starts-with",j:[{type:1,g:0},{type:1,g:0}],i:{type:0,g:3},callFunction:(e,t,n,i,r)=>0===(e=r.F()?"":r.first().value).length?D.aa():0===(i=i.F()?"":i.first().value).length?D.T():i.startsWith(e)?D.aa():D.T()},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"starts-with",j:[{type:1,g:0},{type:1,g:0},{type:1,g:3}],i:{type:0,g:3},callFunction:on},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string",j:[{type:59,g:0}],i:{type:1,g:3},callFunction:ln},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string",j:[],i:{type:1,g:3},callFunction:an.bind(null,ln)},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"substring-before",j:[{type:1,g:0},{type:1,g:0}],i:{type:1,g:3},callFunction:(e,t,n,i,r)=>(e=i.F()?"":i.first().value,""===(r=r.F()?"":r.first().value)||-1===(r=e.indexOf(r))?D.m(O("",1)):D.m(O(e.substring(0,r),1)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"substring-after",j:[{type:1,g:0},{type:1,g:0}],i:{type:1,g:3},callFunction:(e,t,n,i,r)=>(e=i.F()?"":i.first().value,""===(r=r.F()?"":r.first().value)?D.m(O(e,1)):-1===(t=e.indexOf(r))?D.m(O("",1)):D.m(O(e.substring(t+r.length),1)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"substring",j:[{type:1,g:0},{type:3,g:3}],i:{type:1,g:3},callFunction:un},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"substring",j:[{type:1,g:0},{type:3,g:3},{type:3,g:3}],i:{type:1,g:3},callFunction:un},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"upper-case",j:[{type:1,g:0}],i:{type:1,g:3},callFunction:(e,t,n,i)=>i.F()?D.m(O("",1)):i.map((e=>O(e.value.toUpperCase(),1)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"lower-case",j:[{type:1,g:0}],i:{type:1,g:3},callFunction:(e,t,n,i)=>i.F()?D.m(O("",1)):i.map((e=>O(e.value.toLowerCase(),1)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string-join",j:[{type:46,g:2},{type:1,g:3}],i:{type:1,g:3},callFunction:hn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string-join",j:[{type:46,g:2}],i:{type:1,g:3},callFunction:(e,t,n,i)=>hn(0,t,0,i,D.m(O("",1)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string-length",j:[{type:1,g:0}],i:{type:5,g:3},callFunction:cn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"string-length",j:[],i:{type:5,g:3},callFunction:an.bind(null,((e,t,n,i)=>cn(e,0,0,ln(0,t,0,i))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"tokenize",j:[{type:1,g:0},{type:1,g:3},{type:1,g:3}],i:{type:1,g:2},callFunction(){throw Error("Not implemented: Using flags in tokenize is not supported")}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"tokenize",j:[{type:1,g:0},{type:1,g:3}],i:{type:1,g:2},callFunction:dn},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"tokenize",j:[{type:1,g:0}],i:{type:1,g:2},callFunction:(e,t,n,i)=>dn(e,t,n,pn(e,0,0,i),D.m(O(" ",1)))},{j:[{type:1,g:0},{type:1,g:3},{type:1,g:3}],callFunction:(e,t,n,i,r,s)=>ce([i,r,s],(([e,t,n])=>{e=Array.from(e?e.value:"");const i=Array.from(t.value),r=Array.from(n.value);return t=e.map((e=>i.includes(e)?(e=i.indexOf(e))<=r.length?r[e]:void 0:e)),D.m(O(t.join(""),1))})),localName:"translate",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[{type:5,g:2}],callFunction:(e,t,n,i)=>i.N((e=>(e=e.map((e=>{if(9===(e=e.value)||10===e||13===e||32<=e&&55295>=e||57344<=e&&65533>=e||65536<=e&&1114111>=e)return String.fromCodePoint(e);throw Error("FOCH0001")})).join(""),D.m(O(e,1))))),localName:"codepoints-to-string",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[{type:1,g:0}],callFunction:(e,t,n,i)=>ce([i],(([e])=>0===(e=e?e.value.split(""):[]).length?D.empty():D.create(e.map((e=>O(e.codePointAt(0),5)))))),localName:"string-to-codepoints",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:2}},{j:[{type:1,g:0}],callFunction:(e,t,n,i)=>ce([i],(([e])=>null===e||0===e.value.length?D.create(O("",1)):D.create(O(encodeURIComponent(e.value).replace(/[!'()*]/g,(e=>"%"+e.charCodeAt(0).toString(16).toUpperCase())),1)))),localName:"encode-for-uri",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[{type:1,g:0}],callFunction:(e,t,n,i)=>ce([i],(([e])=>null===e||0===e.value.length?D.create(O("",1)):D.create(O(e.value.replace(/([\u00A0-\uD7FF\uE000-\uFDCF\uFDF0-\uFFEF "<>{}|\\^`/\n\u007f\u0080-\u009f]|[\uD800-\uDBFF][\uDC00-\uDFFF])/g,(e=>encodeURI(e))),1)))),localName:"iri-to-uri",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[{type:1,g:0},{type:1,g:0}],callFunction:(e,t,n,i,r)=>ce([i,r],(([e,t])=>{if(null===e||null===t)return D.empty();e=e.value;var n=t.value;if(e.length!==n.length)return D.T();for(t=e.split(""),e=n.split(""),n=0;n<t.length;n++)if(t[n].codePointAt(0)!==e[n].codePointAt(0))return D.T();return D.aa()})),localName:"codepoint-equal",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:0}},{j:[{type:1,g:0},{type:1,g:3}],callFunction:(e,t,n,i,r)=>ce([i,r],(([e,t])=>{e=e?e.value:"",t=t.value;let n=fn.get(t);if(!n){try{n=(0,Qt.compile)(t,{language:"xpath"})}catch(e){throw Error(`FORX0002: ${e}`)}fn.set(t,n)}return n(e)?D.aa():D.T()})),localName:"matches",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{j:[{type:1,g:0},{type:1,g:3},{type:1,g:3}],callFunction:(e,t,n,i,r,s)=>ce([i,r,s],(([e,t,n])=>{if(e=e?e.value:"",t=t.value,(n=n.value).includes("$0"))throw Error("Using $0 in fn:replace to replace substrings with full matches is not supported.");return n=n.split(/((?:\$\$)|(?:\\\$)|(?:\\\\))/).map((e=>{switch(e){case"\\$":return"$$";case"\\\\":return"\\";case"$$":throw Error('FORX0004: invalid replacement: "$$"');default:return e}})).join(""),t=gn(t),e=e.replace(t,n),D.m(O(e,1))})),localName:"replace",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[{type:1,g:0},{type:1,g:3},{type:1,g:3},{type:1,g:3}],localName:"replace",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3},callFunction(){throw Error("Not implemented: Using flags in replace is not supported")}}];const yn=new WeakMap;let vn=0;function bn(e,t,n,i,r){if(null===n.M)throw Je(`The function ${e} depends on dynamic context, which is absent.`);return t(n,i,r,D.m(n.M))}const wn=(e,t,n,i)=>ce([i],(([e])=>{if(null===e)return D.empty();switch((e=e.value).node.nodeType){case 1:case 2:return D.m(O(new F(e.node.prefix,e.node.namespaceURI,e.node.localName),23));case 7:return D.m(O(new F("","",e.node.target),23));default:return D.empty()}})),xn=(e,t,n,i)=>i.X({default:()=>ln(0,t,0,wn(0,0,0,i)),empty:()=>D.m(O("",1))}),Sn=(e,t,n,i)=>it(i,t),kn=(e,t,n,i)=>{if(i.F())return D.m(O("",1));if(!A(i.first().type,53))throw Error("XPTY0004: The context item must be a node.");return n=i.first().value,t=(e=D).m,n=n.node,yn.has(n)||yn.set(n,"id"+ ++vn),n=yn.get(n),t.call(e,O(n,1))},An=(e,t,n,i)=>ce([i],(([e])=>null!==(e=e?e.value:null)&&ee(t.h,e,null)?D.aa():D.T()));function Cn(e,t){return(e=e.toLowerCase())===(t=t.toLowerCase())||!(5>e.length||!e.startsWith(t))&&Cn(e.replace(/-[a-z0-9]+$/,""),t)}const _n=(e,t,n,i,r)=>{if(t=t.h,i.F())i="";else{if(!A(i.first().type,1))throw Error("XPTY0004: The first argument of lang must be a string.");i=i.first().value}if(r)r=r.first().value;else{if(!e||!e.M)throw Je("The function lang depends on dynamic context if a node is not passed as the second argument.");if(!A(e.M.type,53))throw Error("XPTY0004: The context item must be a node.");r=e.M.value}e:{for(e=i;r;)if(1!==r.node.nodeType)r=ne(t,r);else if(1===r.node.nodeType){if(i=Y(t,r,"xml:lang")){t=Cn(i,e)?D.aa():D.T();break e}r=ne(t,r)}t=D.T()}return t},En=(e,t,n,i)=>ce([i],(([e])=>{function n(e){let t=0,n=e;for(;null!==n;)(e.node.nodeType!==n.node.nodeType?0:1===n.node.nodeType?n.node.localName===e.node.localName&&n.node.namespaceURI===e.node.namespaceURI:7===n.node.nodeType?n.node.target===e.node.target:1)&&t++,n=re(i,n,null);return t}if(null===e)return D.empty();const i=t.h;let r="";for(e=e.value;null!==ne(t.h,e,null);e=ne(t.h,e,null))switch(e.node.nodeType){case 1:var s=e;r=`/Q{${s.node.namespaceURI||""}}${s.node.localName}[${n(s)}]${r}`;break;case 2:r=`/@${(s=e).node.namespaceURI?`Q{${s.node.namespaceURI}}`:""}${s.node.localName}${r}`;break;case 3:r=`/text()[${n(e)}]${r}`;break;case 7:r=`/processing-instruction(${(s=e).node.target})[${n(s)}]${r}`;break;case 8:r=`/comment()[${n(e)}]${r}`}return 9===e.node.nodeType?D.create(O(r||"/",1)):D.create(O("Q{http://www.w3.org/2005/xpath-functions}root()"+r,1))})),Tn=(e,t,n,i)=>i.map((e=>O(e.value.node.namespaceURI||"",20))),Pn=(e,t,n,i)=>i.X({default:()=>i.map((e=>7===e.value.node.nodeType?O(e.value.node.target,1):O(e.value.node.localName||"",1))),empty:()=>D.m(O("",1))});function $n(e,t,n){if(2===t.node.nodeType)return At(t,n);for(;n;){if(At(t,n))return!0;if(9===n.node.nodeType)break;n=ne(e,n,null)}return!1}const Nn=(e,t,n,i)=>i.map((e=>{if(!A(e.type,53))throw Error("XPTY0004 Argument passed to fn:root() should be of the type node()");let n;for(e=e.value;e;)n=e,e=ne(t.h,n,null);return he(n)}));var In=[{j:[{type:53,g:0}],callFunction:xn,localName:"name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[],callFunction:bn.bind(null,"name",xn),localName:"name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[{type:53,g:3}],callFunction:Tn,localName:"namespace-uri",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:20,g:3}},{j:[],callFunction:bn.bind(null,"namespace-uri",Tn),localName:"namespace-uri",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:20,g:3}},{j:[{type:53,g:2}],callFunction:(e,t,n,i)=>i.N((e=>e.length?(e=$t(t.h,e).reduceRight(((e,n,i,r)=>i===r.length-1?(e.push(n),e):($n(t.h,n.value,e[0].value)||e.unshift(n),e)),[]),D.create(e)):D.empty())),localName:"innermost",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:53,g:2}},{j:[{type:53,g:2}],callFunction:(e,t,n,i)=>i.N((e=>e.length?(e=$t(t.h,e).reduce(((e,n,i)=>0===i?(e.push(n),e):($n(t.h,e[e.length-1].value,n.value)||e.push(n),e)),[]),D.create(e)):D.empty()),1),localName:"outermost",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:53,g:2}},{j:[{type:53,g:0}],callFunction:An,localName:"has-children",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{j:[],callFunction:bn.bind(null,"has-children",An),localName:"has-children",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{j:[{type:53,g:0}],callFunction:En,localName:"path",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:0}},{j:[],callFunction:bn.bind(null,"path",En),localName:"path",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:0}},{j:[{type:53,g:0}],callFunction:wn,localName:"node-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:23,g:0}},{j:[],callFunction:bn.bind(null,"node-name",wn),localName:"node-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:23,g:0}},{j:[{type:53,g:0}],callFunction:Pn,localName:"local-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[],callFunction:bn.bind(null,"local-name",Pn),localName:"local-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[{type:53,g:0}],callFunction:Nn,localName:"root",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:53,g:0}},{j:[],callFunction:bn.bind(null,"root",Nn),localName:"root",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:53,g:0}},{j:[],callFunction:bn.bind(null,"data",Sn),localName:"data",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:2}},{j:[{type:59,g:2}],callFunction:Sn,localName:"data",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:2}},{j:[{type:1,g:0}],callFunction:_n,localName:"lang",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{j:[{type:1,g:0},{type:53,g:3}],callFunction:_n,localName:"lang",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{j:[],callFunction:bn.bind(null,"generate-id",kn),localName:"generate-id",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}},{j:[{type:53,g:0}],callFunction:kn,localName:"generate-id",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}}];function Qn(e,t){let n=0;const i=e.length;let r=!1,s=null;return{next:()=>{if(!r){for(;n<i;){s||=t(e[n],n,e);const i=s.next(0);if(s=null,!i.value)return S(!1);n++}return r=!0,S(!0)}return x}}}function Rn(e){return 1===(e=e.node.nodeType)||3===e}function Mn(e,t){if((A(e.type,4)||A(e.type,6))&&(A(t.type,4)||A(t.type,6))){var n=xt(e,6),i=xt(t,6);return n.value===i.value||isNaN(e.value)&&isNaN(t.value)}return(A(e.type,4)||A(e.type,6)||A(e.type,3))&&(A(t.type,4)||A(t.type,6)||A(t.type,3))?(n=xt(e,3),i=xt(t,3),n.value===i.value||isNaN(e.value)&&isNaN(t.value)):A(e.type,23)&&A(t.type,23)?e.value.namespaceURI===t.value.namespaceURI&&e.value.localName===t.value.localName:(A(e.type,9)||A(e.type,7)||A(e.type,8)||A(e.type,11)||A(e.type,12)||A(e.type,13)||A(e.type,14)||A(e.type,15))&&(A(t.type,9)||A(t.type,7)||A(t.type,8)||A(t.type,11)||A(t.type,12)||A(t.type,13)||A(t.type,14)||A(t.type,15))?Ne(e.value,t.value):(A(e.type,16)||A(e.type,17)||A(e.type,18))&&(A(t.type,16)||A(t.type,17)||A(t.type,17))?fe(e.value,t.value):e.value===t.value}function Bn(e,t,n){const[i,r]=[t,n].map((t=>({type:1,value:t.reduce(((t,n)=>t+nt(n,e).first().value),"")})));return S(Mn(i,r))}function Dn(e,t,n,i){for(;e.value&&A(e.value.type,56);){t.push(e.value);const r=ie(i,e.value.value);if(e=n.next(0),r&&3!==r.node.nodeType)break}return e}function Xn(e,t,n,i,r){const s=t.h,o=i.value,a=r.value;let l,h=null,c=null,u=null;const d=[],p=[];return{next:()=>{for(;!l;)if(h||=o.next(0),h=Dn(h,d,o,s),c||=a.next(0),c=Dn(c,p,a,s),d.length||p.length){var i=Bn(t,d,p);if(d.length=0,p.length=0,!1===i.value)return l=!0,i}else{if(h.done||c.done)return l=!0,S(h.done===c.done);if(u||=Ln(e,t,n,h.value,c.value),i=u.next(0),u=null,!1===i.value)return l=!0,i;c=h=null}return x}}}function Fn(e,t,n,i,r){return i=J(t.h,i.value),r=J(t.h,r.value),i=i.filter((e=>Rn(e))),r=r.filter((e=>Rn(e))),i=D.create(i.map((e=>he(e)))),r=D.create(r.map((e=>he(e)))),Xn(e,t,n,i,r)}function Ln(e,t,n,i,r){if(A(i.type,46)&&A(r.type,46))return St(Mn(i,r));if(A(i.type,61)&&A(r.type,61))return function(e,t,n,i,r){return i.h.length!==r.h.length?St(!1):Qn(i.h,(i=>{const s=r.h.find((e=>Mn(e.key,i.key)));return s?Xn(e,t,n,i.value(),s.value()):St(!1)}))}(e,t,n,i,r);if(A(i.type,62)&&A(r.type,62))return function(e,t,n,i,r){return i.h.length!==r.h.length?St(!1):Qn(i.h,((i,s)=>(s=r.h[s],Xn(e,t,n,i(),s()))))}(e,t,n,i,r);if(A(i.type,53)&&A(r.type,53)){if(A(i.type,55)&&A(r.type,55))return Fn(e,t,n,i,r);if(A(i.type,54)&&A(r.type,54))return function(e,t,n,i,r){const s=Xn(e,t,n,wn(0,0,0,D.m(i)),wn(0,0,0,D.m(r))),o=Fn(e,t,n,i,r);i=H(t.h,i.value).filter((e=>"http://www.w3.org/2000/xmlns/"!==e.node.namespaceURI)).sort(((e,t)=>e.node.nodeName>t.node.nodeName?1:-1)).map((e=>he(e))),r=H(t.h,r.value).filter((e=>"http://www.w3.org/2000/xmlns/"!==e.node.namespaceURI)).sort(((e,t)=>e.node.nodeName>t.node.nodeName?1:-1)).map((e=>he(e)));const a=Xn(e,t,n,D.create(i),D.create(r));let l=!1;return{next:()=>{if(l)return x;var e=s.next(0);return!e.done&&!1===e.value||!(e=a.next(0)).done&&!1===e.value?(l=!0,e):(e=o.next(0),l=!0,e)}}}(e,t,n,i,r);if(A(i.type,47)&&A(r.type,47)||A(i.type,57)&&A(r.type,57)||A(i.type,58)&&A(r.type,58))return function(e,t,n,i,r){const s=Xn(e,t,n,wn(0,0,0,D.m(i)),wn(0,0,0,D.m(r)));let o=!1;return{next:()=>{if(o)return x;const e=s.next(0);return e.done||!1!==e.value?S(Mn(nt(i,t).first(),nt(r,t).first())):(o=!0,e)}}}(e,t,n,i,r)}return St(!1)}var Un=class extends Ge{constructor(){super({M:null,Aa:-1,ta:D.empty(),ra:{}})}},Vn=(e="Can not execute an updating expression in a non-updating context.")=>Error(`XUST0001: ${e}`),zn=e=>Error(`XUTY0004: The attribute ${e.name}="${e.value}" follows a node that is not an attribute node.`),Zn=()=>Error("XUTY0005: The target of a insert expression with into must be a single element or document node."),jn=()=>Error("XUTY0006: The target of a insert expression with before or after must be a single element, text, comment, or processing instruction node."),qn=()=>Error("XUTY0008: The target of a replace expression must be a single element, attribute, text, comment, or processing instruction node."),Gn=()=>Error("XUTY0012: The target of a rename expression must be a single element, attribute, or processing instruction node."),Wn=e=>Error(`XUDY0017: The target ${e.outerHTML} is used in more than one replace value of expression.`),Hn=e=>Error(`XUDY0021: Applying the updates will result in the XDM instance violating constraint: '${e}'`),Yn=e=>Error(`XUDY0023: The namespace binding ${e} is conflicting.`),Jn=e=>Error(`XUDY0024: The namespace binding ${e} is conflicting.`),Kn=()=>Error("XUDY0027: The target for an insert, replace, or rename expression expression should not be empty.");function ei(e,t,n){return t&&null!==t.M&&e.B?(null===e.ob&&(e.ob=X(e.h(new Un,n).hb())),e=e.ob()):e=e.h(t,n),e}var ti=class{constructor(e,t,n={B:!1,W:!1,R:"unsorted",subtree:!1},i=!1,r){this.o=e,this.ia=n.R||"unsorted",this.subtree=!!n.subtree,this.W=!!n.W,this.B=!!n.B,this.Fa=t,this.I=!1,this.ob=null,this.Qb=i,this.type=r}D(){return null}v(e){if(this.Fa.forEach((t=>t.v(e))),!this.Qb&&this.Fa.some((e=>e.I)))throw Vn()}},ni=class{constructor(e,t){this.J=e,this.da=t}},ii=class{constructor(e){e&&"object"==typeof e&&"nodeType"in e&&("function"==typeof(e=e.ownerDocument||e).createElementNS&&"function"==typeof e.createProcessingInstruction&&"function"==typeof e.createTextNode&&"function"==typeof e.createComment&&(this.h=e)),this.h||(this.h=null)}createAttributeNS(e,t){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createAttributeNS(e,t)}createCDATASection(e){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createCDATASection(e)}createComment(e){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createComment(e)}createDocument(){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.implementation.createDocument(null,null,null)}createElementNS(e,t){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createElementNS(e,t)}createProcessingInstruction(e,t){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createProcessingInstruction(e,t)}createTextNode(e){if(!this.h)throw Error("Please pass a node factory if an XQuery script uses node constructors");return this.h.createTextNode(e)}};function ri(e,t,n,i){return H(i,e,`name-${t}`).some((e=>e.node.localName===t&&e.node.namespaceURI===n))}var si=(e,t,n)=>{t.forEach((t=>{n.insertBefore(e.node,t.node,null)}))},oi=(e,t,n,i)=>{const r=ne(n,e);var s=e.node.nodeType;if(2===s){if(t.some((e=>2!==e.node.nodeType)))throw Error('Constraint "If $target is an attribute node, $replacement must consist of zero or more attribute nodes." failed.');const s=r?r.node:null;i.removeAttributeNS(s,e.node.namespaceURI,e.node.localName),t.forEach((e=>{const t=e.node.localName,o=e.node.namespaceURI;if(ri(r,t,o,n))throw Hn(`An attribute ${o?`Q{${o}}${t}`:t} already exists.`);i.setAttributeNS(s,o,t,K(n,e))}))}if(1===s||3===s||8===s||7===s){const o=(s=ie(n,e))?s.node:null;i.removeChild(r.node,e.node),t.forEach((e=>{i.insertBefore(r.node,e.node,o)}))}},ai=(e,t,n,i)=>{if(li(e,t),e.filter((e=>-1!==["insertInto","insertAttributes","replaceValue","rename"].indexOf(e.type))).forEach((e=>{switch(e.type){case"insertInto":si(e.target,e.content,i);break;case"insertAttributes":((e,t,n,i)=>{t.forEach((t=>{const r=t.node.localName,s=t.node.namespaceURI;if(ri(e,r,s,n))throw Hn(`An attribute ${s?`Q{${s}}${r}`:r} already exists.`);i.setAttributeNS(e.node,s,r,K(n,t))}))})(e.target,e.content,t,i);break;case"rename":((e,t,n,i,r)=>{let s;switch(i||=new ii(e?e.node:null),e.node.nodeType){case 1:const o=n.getAllAttributes(e.node),a=n.getChildNodes(e.node),l=i.createElementNS(t.namespaceURI,t.za());s={node:l,G:null},o.forEach((e=>{r.setAttributeNS(l,e.namespaceURI,e.nodeName,e.value)})),a.forEach((e=>{r.insertBefore(l,e,null)}));break;case 2:(t=i.createAttributeNS(t.namespaceURI,t.za())).value=K(n,e),s={node:t,G:null};break;case 7:s={node:i.createProcessingInstruction(t.za(),K(n,e)),G:null}}if(!ne(n,e))throw Error("Not supported: renaming detached nodes.");oi(e,[s],n,r)})(e.target,e.o,t,n,i);break;case"replaceValue":var r=e.target;if(e=e.o,2===r.node.nodeType){const n=ne(t,r);n?i.setAttributeNS(n.node,r.node.namespaceURI,r.node.localName,e):r.node.value=e}else i.setData(r.node,e)}})),e.filter((e=>-1!==["insertBefore","insertAfter","insertIntoAsFirst","insertIntoAsLast"].indexOf(e.type))).forEach((e=>{switch(e.type){case"insertAfter":((e,t,n,i)=>{const r=ne(n,e).node,s=(e=ie(n,e))?e.node:null;t.forEach((e=>{i.insertBefore(r,e.node,s)}))})(e.target,e.content,t,i);break;case"insertBefore":((e,t,n,i)=>{const r=ne(n,e).node;t.forEach((t=>{i.insertBefore(r,t.node,e.node)}))})(e.target,e.content,t,i);break;case"insertIntoAsFirst":((e,t,n,i)=>{const r=(n=ee(n,e))?n.node:null;t.forEach((t=>{i.insertBefore(e.node,t.node,r)}))})(e.target,e.content,t,i);break;case"insertIntoAsLast":si(e.target,e.content,i)}})),e.filter((e=>"replaceNode"===e.type)).forEach((e=>{oi(e.target,e.o,t,i)})),e.filter((e=>"replaceElementContent"===e.type)).forEach((e=>{((e,t,n,i)=>{n.getChildNodes(e.node).forEach((t=>i.removeChild(e.node,t))),t&&i.insertBefore(e.node,t.node,null)})(e.target,e.text,t,i)})),e.filter((e=>"delete"===e.type)).forEach((e=>{e=e.target;var n=ne(t,e);(n=n?n.node:null)&&(2===e.node.nodeType?i.removeAttributeNS(n,e.node.namespaceURI,e.node.localName):i.removeChild(n,e.node))})),e.some((e=>"put"===e.type)))throw Error('Not implemented: the execution for pendingUpdate "put" is not yet implemented.')};const li=(e,t)=>{function n(t,n){const i=new Set;e.filter((e=>e.type===t)).map((e=>e.target)).forEach((e=>{e=e?e.node:null,i.has(e)&&n(e),i.add(e)}))}n("rename",(e=>{throw Error(`XUDY0015: The target ${e.outerHTML} is used in more than one rename expression.`)})),n("replaceNode",(e=>{throw Error(`XUDY0016: The target ${e.outerHTML} is used in more than one replace expression.`)})),n("replaceValue",(e=>{throw Wn(e)})),n("replaceElementContent",(e=>{throw Wn(e)}));const i=new Map,r=e=>new F(e.node.prefix,e.node.namespaceURI,e.node.localName);e.filter((e=>"replaceNode"===e.type&&2===e.target.node.nodeType)).forEach((e=>{var n=ne(t,e.target);n=n?n.node:null;const s=i.get(n);s?s.push(...e.o.map(r)):i.set(n,e.o.map(r))})),e.filter((e=>"rename"===e.type&&2===e.target.node.nodeType)).forEach((e=>{var n=ne(t,e.target);if(n){n=n.node;var r=i.get(n);r?r.push(e.o):i.set(n,[e.o])}})),i.forEach((e=>{const t={};e.forEach((e=>{if(t[e.prefix]||(t[e.prefix]=e.namespaceURI),t[e.prefix]!==e.namespaceURI)throw Jn(e.namespaceURI)}))}))};var hi=(e,...t)=>e.concat(...t.filter(Boolean));function ci(e){return e.I?(t,n)=>e.s(t,n):(t,n)=>{const i=e.h(t,n);return{next:()=>S({da:[],J:i.O()})}}}var ui=class extends ti{constructor(e,t,n,i){super(e,t,n,!0,i),this.I=!0}h(){throw Vn()}};function di(e,t){return t((e=e.next(0)).value.da),D.create(e.value.J)}var pi=class extends ui{constructor(e,t,n,i){super(e,t,n,i),this.I=this.Fa.some((e=>e.I))}h(e,t){return this.A(e,t,this.Fa.map((e=>n=>e.h(n,t))))}s(e,t){let n=[];const i=this.A(e,t,this.Fa.map((e=>e.I?i=>di(i=e.s(i,t),(e=>n=hi(n,e))):n=>e.h(n,t))));let r=!1;return{next:()=>{if(r)return x;const e=i.O();return r=!0,S(new ni(e,n))}}}v(e){super.v(e),function(e){e.Fa.some((e=>e.I))&&(e.I=!0)}(this)}};const fi=["external","attribute","nodeName","nodeType","universal"],mi=fi.length;function gi(e,t){for(let n=0;n<mi;++n){if(t.h[n]<e.h[n])return 1;if(t.h[n]>e.h[n])return-1}return 0}var Oi=class{constructor(e){if(this.h=fi.map((t=>e[t]||0)),Object.keys(e).some((e=>!fi.includes(e))))throw Error("Invalid specificity kind passed")}add(e){const t=fi.reduce(((t,n,i)=>(t[n]=this.h[i]+e.h[i],t)),Object.create(null));return new Oi(t)}};const yi=()=>Ke("Expected base expression of a function call to evaluate to a sequence of single function item");function vi(e,t,n,i){const r=[];for(let s=0;s<t.length;++s){if(null===t[s]){r.push(null);continue}const o=Bt(e[s],t[s],n,i,!1);r.push(o)}return r}function bi(e,t){if(!A(e.type,60))throw Ke("Expected base expression to evaluate to a function item");if(e.v!==t)throw yi();return e}function wi(e,t,n,i,r,s,o){let a=0;return r=r.map((e=>e?null:s[a++](n))),0<=(r=vi(e.o,r,i,e.D)).indexOf(null)?function(e,t){const n=e.value,i=t.map((e=>null===e?null:X(e)));return t=t.reduce(((t,n,i)=>(null===n&&t.push(e.o[i]),t)),[]),t=new L({j:t,arity:t.length,Ya:!0,I:e.I,localName:"boundFunction",namespaceURI:e.l,i:e.s,value:function(e,t,r){const s=Array.from(arguments).slice(3),o=i.map((e=>null===e?s.shift():e()));return n.apply(void 0,[e,t,r].concat(o))}}),D.m(t)}(e,r):(t=t.apply(void 0,[n,i,o,...r]),Bt(e.s,t,i,e.D,!0))}var xi=class extends pi{constructor(e,t,n){super(new Oi({external:1}),[e].concat(t.filter((e=>!!e))),{R:"unsorted",W:!1,subtree:!1,B:!1},n),this.ma=t.length,this.P=t.map((e=>null===e)),this.L=null,this.ya=e,this.La=t}s(e,t){if(!this.l||!this.l.I)return super.s(e,t);let n=[];const i=wi(this.l,((e,t,i,...r)=>di(this.l.value(e,t,i,...r),(e=>{n=hi(n,e)}))),e,t,this.P,this.La.map((i=>()=>i.I?di(i.s(e,t),(e=>{n=hi(n,e)})):ei(i,e,t))),this.L);let r=!1;return{next:()=>{if(r)return x;const e=i.O();return r=!0,S({da:n,J:e})}}}A(e,t,[n,...i]){if(this.l)return wi(this.l,((e,t,n,...i)=>this.l.value(e,t,n,...i)),e,t,this.P,i,this.L);const r=n(e);return r.X({default:()=>{throw yi()},m:()=>r.N((([n])=>{if((n=bi(n,this.ma)).I)throw Error("XUDY0038: The function returned by the PrimaryExpr of a dynamic function invocation can not be an updating function");return wi(n,n.value,e,t,this.P,i,this.L)}))})}v(e){if(this.L=pr(e),super.v(e),this.ya.B){if(!(e=ei(this.ya,null,null)).oa())throw yi();this.l=bi(e.first(),this.ma),this.l.I&&(this.I=!0)}}};const Si=(e,t,n,i,r,s)=>ce([i,r,s],(([e,t,n])=>{if(t=t.value,n=n.value,t>e.h.length||0>=t)throw Error("FOAY0001: subarray start out of bounds.");if(0>n)throw Error("FOAY0002: subarray length out of bounds.");if(t+n>e.h.length+1)throw Error("FOAY0001: subarray start + length out of bounds.");return D.m(new ae(e.h.slice(t-1,n+t-1)))})),ki=(e,t,n,i,r)=>ce([i],(([e])=>r.N((t=>{t=t.map((e=>e.value)).sort(((e,t)=>t-e)).filter(((e,t,n)=>n[t-1]!==e));const n=e.h.concat();for(let i=0,r=t.length;i<r;++i){const r=t[i];if(r>e.h.length||0>=r)throw Error("FOAY0001: subarray position out of bounds.");n.splice(r-1,1)}return D.m(new ae(n))})))),Ai=e=>A(e,1)||A(e,20)||A(e,19),Ci=(e,t,n,i,r)=>0===i.length?0!==r.length:0!==r.length&&Ln(e,t,n,i[0],r[0]).next(0).value?Ci(e,t,n,i.slice(1),r.slice(1)):i[0].value!=i[0].value||(Ai(i[0].type)&&0!==r.length&&Ai(r[0].type)||0!==r.length)&&i[0].value<r[0].value;function _i(e){return A(e.type,62)?He(e.h.map((e=>e().N((e=>He(e.map(_i))))))):D.m(e)}var Ei=[{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"size",j:[{type:62,g:3}],i:{type:5,g:3},callFunction:(e,t,n,i)=>ce([i],(([e])=>D.m(O(e.h.length,5))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"get",j:[{type:62,g:3},{type:5,g:3}],i:{type:59,g:2},callFunction:oe},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"put",j:[{type:62,g:3},{type:5,g:3},{type:59,g:2}],i:{type:62,g:3},callFunction:(e,t,n,i,r,s)=>ce([r,i],(([e,t])=>{if(0>=(e=e.value)||e>t.h.length)throw Error("FOAY0001: array position out of bounds.");return(t=t.h.concat()).splice(e-1,1,X(s)),D.m(new ae(t))}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"append",j:[{type:62,g:3},{type:59,g:2}],i:{type:62,g:3},callFunction:(e,t,n,i,r)=>ce([i],(([e])=>D.m(new ae(e.h.concat([X(r)])))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"subarray",j:[{type:62,g:3},{type:5,g:3},{type:5,g:3}],i:{type:62,g:3},callFunction:Si},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"subarray",j:[{type:62,g:3},{type:5,g:3}],i:{type:62,g:3},callFunction(e,t,n,i,r){const s=D.m(O(i.first().value.length-r.first().value+1,5));return Si(0,0,0,i,r,s)}},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"remove",j:[{type:62,g:3},{type:5,g:2}],i:{type:62,g:3},callFunction:ki},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"insert-before",j:[{type:62,g:3},{type:5,g:3},{type:59,g:2}],i:{type:62,g:3},callFunction:(e,t,n,i,r,s)=>ce([i,r],(([e,t])=>{if((t=t.value)>e.h.length+1||0>=t)throw Error("FOAY0001: subarray position out of bounds.");return(e=e.h.concat()).splice(t-1,0,X(s)),D.m(new ae(e))}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"head",j:[{type:62,g:3}],i:{type:59,g:2},callFunction:(e,t,n,i)=>oe(0,0,0,i,D.m(O(1,5)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"tail",j:[{type:62,g:3}],i:{type:59,g:2},callFunction:(e,t,n,i)=>ki(0,0,0,i,D.m(O(1,5)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"reverse",j:[{type:62,g:3}],i:{type:62,g:3},callFunction:(e,t,n,i)=>ce([i],(([e])=>D.m(new ae(e.h.concat().reverse()))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"join",j:[{type:62,g:2}],i:{type:62,g:3},callFunction:(e,t,n,i)=>i.N((e=>(e=e.reduce(((e,t)=>e.concat(t.h)),[]),D.m(new ae(e)))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"for-each",j:[{type:62,g:3},{type:60,g:3}],i:{type:62,g:3},callFunction:(e,t,n,i,r)=>ce([i,r],(([i,r])=>{if(1!==r.v)throw Ke("The callback passed into array:for-each has a wrong arity.");return i=i.h.map((i=>X(r.value.call(void 0,e,t,n,vi(r.o,[i()],t,"array:for-each")[0])))),D.m(new ae(i))}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"filter",j:[{type:62,g:3},{type:60,g:3}],i:{type:62,g:3},callFunction:(e,t,n,i,r)=>ce([i,r],(([i,r])=>{if(1!==r.v)throw Ke("The callback passed into array:filter has a wrong arity.");const s=i.h.map((i=>{i=vi(r.o,[i()],t,"array:filter")[0];return(0,r.value)(e,t,n,i)})),o=[];let a=!1;return D.create({next:()=>{if(a)return x;for(let t=0,n=i.h.length;t<n;++t){var e=s[t].fa();o[t]=e}return e=i.h.filter(((e,t)=>o[t])),a=!0,S(new ae(e))}})}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"fold-left",j:[{type:62,g:3},{type:59,g:2},{type:60,g:3}],i:{type:59,g:2},callFunction:(e,t,n,i,r,s)=>ce([i,s],(([i,s])=>{if(2!==s.v)throw Ke("The callback passed into array:fold-left has a wrong arity.");return i.h.reduce(((i,r)=>(r=vi(s.o,[r()],t,"array:fold-left")[0],s.value.call(void 0,e,t,n,i,r))),r)}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"fold-right",j:[{type:62,g:3},{type:59,g:2},{type:60,g:3}],i:{type:59,g:2},callFunction:(e,t,n,i,r,s)=>ce([i,s],(([i,s])=>{if(2!==s.v)throw Ke("The callback passed into array:fold-right has a wrong arity.");return i.h.reduceRight(((i,r)=>(r=vi(s.o,[r()],t,"array:fold-right")[0],s.value.call(void 0,e,t,n,i,r))),r)}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"for-each-pair",j:[{type:62,g:3},{type:62,g:3},{type:60,g:3}],i:{type:62,g:3},callFunction:(e,t,n,i,r,s)=>ce([i,r,s],(([i,r,s])=>{if(2!==s.v)throw Ke("The callback passed into array:for-each-pair has a wrong arity.");const o=[];for(let a=0,l=Math.min(i.h.length,r.h.length);a<l;++a){const[l,h]=vi(s.o,[i.h[a](),r.h[a]()],t,"array:for-each-pair");o[a]=X(s.value.call(void 0,e,t,n,l,h))}return D.m(new ae(o))}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"sort",j:[{type:62,g:3}],i:{type:62,g:3},callFunction:(e,t,n,i)=>ce([i],(([i])=>(i=i.h.map((e=>e().O())),((e,t,n,i)=>(i.sort(((i,r)=>Xn(e,t,n,D.create(i),D.create(r)).next(0).value?0:Ci(e,t,n,i,r)?-1:1)),D.m(new ae(i.map((e=>()=>D.create(e)))))))(e,t,n,i))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/array",localName:"flatten",j:[{type:59,g:2}],i:{type:59,g:2},callFunction:(e,t,n,i)=>i.N((e=>He(e.map(_i))))}];function Ti(e,t,n,i,r){return r.F()?r:D.m(xt(r.first(),e))}var Pi=[{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"untypedAtomic",j:[{type:46,g:0}],i:{type:19,g:0},callFunction:Ti.bind(null,19)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"error",j:[{type:46,g:0}],i:{type:39,g:0},callFunction:Ti.bind(null,39)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"string",j:[{type:46,g:0}],i:{type:1,g:0},callFunction:Ti.bind(null,1)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"boolean",j:[{type:46,g:0}],i:{type:0,g:0},callFunction:Ti.bind(null,0)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"decimal",j:[{type:46,g:0}],i:{type:4,g:0},callFunction:Ti.bind(null,4)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"float",j:[{type:46,g:0}],i:{type:6,g:0},callFunction:Ti.bind(null,6)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"double",j:[{type:46,g:0}],i:{type:3,g:0},callFunction:Ti.bind(null,3)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"duration",j:[{type:46,g:0}],i:{type:18,g:0},callFunction:Ti.bind(null,18)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"dateTime",j:[{type:46,g:0}],i:{type:9,g:0},callFunction:Ti.bind(null,9)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"dateTimeStamp",j:[{type:46,g:0}],i:{type:10,g:0},callFunction:Ti.bind(null,10)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"time",j:[{type:46,g:0}],i:{type:8,g:0},callFunction:Ti.bind(null,8)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"date",j:[{type:46,g:0}],i:{type:7,g:0},callFunction:Ti.bind(null,7)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gYearMonth",j:[{type:46,g:0}],i:{type:11,g:0},callFunction:Ti.bind(null,11)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gYear",j:[{type:46,g:0}],i:{type:12,g:0},callFunction:Ti.bind(null,12)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gMonthDay",j:[{type:46,g:0}],i:{type:13,g:0},callFunction:Ti.bind(null,13)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gDay",j:[{type:46,g:0}],i:{type:15,g:0},callFunction:Ti.bind(null,15)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"gMonth",j:[{type:46,g:0}],i:{type:14,g:0},callFunction:Ti.bind(null,14)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"hexBinary",j:[{type:46,g:0}],i:{type:22,g:0},callFunction:Ti.bind(null,22)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"base64Binary",j:[{type:46,g:0}],i:{type:21,g:0},callFunction:Ti.bind(null,21)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"QName",j:[{type:46,g:0}],i:{type:23,g:0},callFunction:(e,t,n,i)=>{if(i.F())return i;if(A((e=i.first()).type,2))throw Error("XPTY0004: The provided QName is not a string-like value.");if(!ot(e=st(e=xt(e,1).value,23),23))throw Error("FORG0001: The provided QName is invalid.");if(!e.includes(":"))return n=n.$(""),D.m(O(new F("",n,e),23));const[r,s]=e.split(":");if(!(n=n.$(r)))throw Error(`FONS0004: The value ${e} can not be cast to a QName. Did you mean to use fn:QName?`);return D.m(O(new F(r,n,s),23))}},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"anyURI",j:[{type:46,g:0}],i:{type:20,g:0},callFunction:Ti.bind(null,20)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"normalizedString",j:[{type:46,g:0}],i:{type:48,g:0},callFunction:Ti.bind(null,48)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"token",j:[{type:46,g:0}],i:{type:52,g:0},callFunction:Ti.bind(null,52)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"language",j:[{type:46,g:0}],i:{type:51,g:0},callFunction:Ti.bind(null,51)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"NMTOKEN",j:[{type:46,g:0}],i:{type:50,g:0},callFunction:Ti.bind(null,50)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"NMTOKENS",j:[{type:46,g:0}],i:{type:49,g:2},callFunction:Ti.bind(null,49)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"Name",j:[{type:46,g:0}],i:{type:25,g:0},callFunction:Ti.bind(null,25)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"NCName",j:[{type:46,g:0}],i:{type:24,g:0},callFunction:Ti.bind(null,24)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"ID",j:[{type:46,g:0}],i:{type:42,g:0},callFunction:Ti.bind(null,42)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"IDREF",j:[{type:46,g:0}],i:{type:41,g:0},callFunction:Ti.bind(null,41)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"IDREFS",j:[{type:46,g:0}],i:{type:43,g:2},callFunction:Ti.bind(null,43)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"ENTITY",j:[{type:46,g:0}],i:{type:26,g:0},callFunction:Ti.bind(null,26)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"ENTITIES",j:[{type:46,g:0}],i:{type:40,g:2},callFunction:Ti.bind(null,40)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"integer",j:[{type:46,g:0}],i:{type:5,g:0},callFunction:Ti.bind(null,5)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"nonPositiveInteger",j:[{type:46,g:0}],i:{type:27,g:0},callFunction:Ti.bind(null,27)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"negativeInteger",j:[{type:46,g:0}],i:{type:28,g:0},callFunction:Ti.bind(null,28)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"long",j:[{type:46,g:0}],i:{type:31,g:0},callFunction:Ti.bind(null,31)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"int",j:[{type:46,g:0}],i:{type:32,g:0},callFunction:Ti.bind(null,32)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"short",j:[{type:46,g:0}],i:{type:33,g:0},callFunction:Ti.bind(null,33)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"byte",j:[{type:46,g:0}],i:{type:34,g:0},callFunction:Ti.bind(null,34)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"nonNegativeInteger",j:[{type:46,g:0}],i:{type:30,g:0},callFunction:Ti.bind(null,30)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"unsignedLong",j:[{type:46,g:0}],i:{type:36,g:0},callFunction:Ti.bind(null,36)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"unsignedInt",j:[{type:46,g:0}],i:{type:35,g:0},callFunction:Ti.bind(null,35)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"unsignedShort",j:[{type:46,g:0}],i:{type:38,g:0},callFunction:Ti.bind(null,38)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"unsignedByte",j:[{type:46,g:0}],i:{type:37,g:0},callFunction:Ti.bind(null,37)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"positiveInteger",j:[{type:46,g:0}],i:{type:29,g:0},callFunction:Ti.bind(null,29)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"yearMonthDuration",j:[{type:46,g:0}],i:{type:16,g:0},callFunction:Ti.bind(null,16)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"dayTimeDuration",j:[{type:46,g:0}],i:{type:17,g:0},callFunction:Ti.bind(null,17)},{namespaceURI:"http://www.w3.org/2001/XMLSchema",localName:"dateTimeStamp",j:[{type:46,g:0}],i:{type:10,g:0},callFunction:Ti.bind(null,10)}];const $i=(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.getYear(),5)),Ni=(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.getMonth(),5)),Ii=(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.getDay(),5)),Qi=(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.getHours(),5)),Ri=(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.getMinutes(),5)),Mi=(e,t,n,i)=>(i.F()||(t=(e=D).m,i=i.first().value,i=t.call(e,O(i.D+i.qa,4))),i),Bi=(e,t,n,i)=>i.F()?i:(e=i.first().value.Y)?D.m(O(e,17)):D.empty();var Di=[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"dateTime",j:[{type:7,g:0},{type:8,g:0}],i:{type:9,g:0},callFunction:(e,t,n,i,r)=>{if(i.F())return i;if(r.F())return r;if(e=i.first().value,r=r.first().value,t=e.Y,n=r.Y,t||n){if(!t||n)if(!t&&n)t=n;else if(!fe(t,n))throw Error("FORG0008: fn:dateTime: got a date and time value with different timezones.")}else t=null;return D.m(O(new Pe(e.getYear(),e.getMonth(),e.getDay(),r.getHours(),r.getMinutes(),r.getSeconds(),r.qa,t),9))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"year-from-dateTime",j:[{type:9,g:0}],i:{type:5,g:0},callFunction:$i},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"month-from-dateTime",j:[{type:9,g:0}],i:{type:5,g:0},callFunction:Ni},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"day-from-dateTime",j:[{type:9,g:0}],i:{type:5,g:0},callFunction:Ii},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"hours-from-dateTime",j:[{type:9,g:0}],i:{type:5,g:0},callFunction:Qi},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"minutes-from-dateTime",j:[{type:9,g:0}],i:{type:5,g:0},callFunction:Ri},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"seconds-from-dateTime",j:[{type:9,g:0}],i:{type:4,g:0},callFunction:Mi},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"timezone-from-dateTime",j:[{type:9,g:0}],i:{type:17,g:0},callFunction:Bi},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"year-from-date",j:[{type:7,g:0}],i:{type:5,g:0},callFunction:$i},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"month-from-date",j:[{type:7,g:0}],i:{type:5,g:0},callFunction:Ni},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"day-from-date",j:[{type:7,g:0}],i:{type:5,g:0},callFunction:Ii},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"timezone-from-date",j:[{type:7,g:0}],i:{type:17,g:0},callFunction:Bi},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"hours-from-time",j:[{type:8,g:0}],i:{type:5,g:0},callFunction:Qi},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"minutes-from-time",j:[{type:8,g:0}],i:{type:5,g:0},callFunction:Ri},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"seconds-from-time",j:[{type:8,g:0}],i:{type:4,g:0},callFunction:Mi},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"timezone-from-time",j:[{type:8,g:0}],i:{type:17,g:0},callFunction:Bi}];function Xi(e,t){const n=t.h,i=t.Ja,r=t.Ma;switch(e.node.nodeType){case 1:const o=i.createElementNS(e.node.namespaceURI,e.node.nodeName);for(var s of(n.getAllAttributes(e.node).forEach((e=>r.setAttributeNS(o,e.namespaceURI,e.nodeName,e.value))),J(n,e)))e=Xi(s,t),r.insertBefore(o,e.node,null);return{node:o,G:null};case 2:return(t=i.createAttributeNS(e.node.namespaceURI,e.node.nodeName)).value=K(n,e),{node:t,G:null};case 4:return{node:i.createCDATASection(K(n,e)),G:null};case 8:return{node:i.createComment(K(n,e)),G:null};case 9:s=i.createDocument();for(const i of J(n,e))e=Xi(i,t),r.insertBefore(s,e.node,null);return{node:s,G:null};case 7:return{node:i.createProcessingInstruction(e.node.target,K(n,e)),G:null};case 3:return{node:i.createTextNode(K(n,e)),G:null}}}function Fi(e,t){const n=t.Ma;var i=t.Ja;const r=t.h;if(!G(e.node))return Xi(e,t).node;switch(e.node.nodeType){case 2:return(i=i.createAttributeNS(e.node.namespaceURI,e.node.nodeName)).value=K(r,e),i;case 8:return i.createComment(K(r,e));case 1:const s=e.node.prefix,o=e.node.localName,a=i.createElementNS(e.node.namespaceURI,s?s+":"+o:o);return J(r,e).forEach((e=>{e=Fi(e,t),n.insertBefore(a,e,null)})),H(r,e).forEach((e=>{n.setAttributeNS(a,e.node.namespaceURI,e.node.nodeName,K(r,e))})),a.normalize(),a;case 7:return i.createProcessingInstruction(e.node.target,K(r,e));case 3:return i.createTextNode(K(r,e))}}function Li(e,t,n){var i=e.node;if(!(G(i)||n||e.G))return i;i=t.v;const r=[];return n?Fi(e,t):(e=function(e,t,n){let i=e;for(e=ne(n,i);null!==e;){if(2===i.node.nodeType)t.push(i.node.nodeName);else{const r=J(n,e);t.push(r.findIndex((e=>At(e,i))))}i=e,e=ne(n,i)}return i}(e,r,t.h),(n=i.get(e.node))||(n={node:Fi(e,t),G:null},i.set(e.node,n)),function(e,t,n){for(;0<t.length;){const i=t.pop();e="string"==typeof i?H(n,e).find((e=>e.node.nodeName===i)):J(n,e)[i]}return e.node}(n,r,t.h))}const Ui=(e,t,n,i,r)=>i.N((e=>{var n;let i="";for(let r=0;r<e.length;r++){const s=e[r],o=t.Ua&&A(s.type,53)?t.Ua.serializeToString(Li(s.value,t,!1)):null===(n=it(D.m(s),t).map((e=>xt(e,1))).first())||void 0===n?void 0:n.value;o&&(i+=`{type: ${E[s.type]}, value: ${o}}\n`)}return void 0!==r&&(i+=r.first().value),t.jb.trace(i),D.create(e)}));var Vi=[{j:[{type:59,g:2}],callFunction:Ui,localName:"trace",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2},{type:1,g:3}],callFunction:Ui,localName:"trace",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}}];const zi=(e,t,n,i,r)=>{throw e=void 0===i||i.F()?new F("err","http://www.w3.org/2005/xqt-errors","FOER0000"):i.first().value,t="",void 0===r||r.F()||(t=`: ${r.first().value}`),Error(`${e.localName}${t}`)};var Zi=[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"error",j:[],i:{type:63,g:3},callFunction:zi},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"error",j:[{type:23,g:0}],i:{type:63,g:3},callFunction:zi},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"error",j:[{type:23,g:0},{type:1,g:3}],i:{type:63,g:3},callFunction:zi},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"error",j:[{type:23,g:0},{type:1,g:3},{type:59,g:2}],i:{type:63,g:3},callFunction(){throw Error("Not implemented: Using an error object in error is not supported")}}];function ji(e){return"string"==typeof e?e:(e=(new Z).getChildNodes(e).find((e=>8===e.nodeType)))?e.data:"some expression"}var qi=class extends Error{constructor(e,t){super(e),this.position={end:{ha:t.end.ha,line:t.end.line,offset:t.end.offset},start:{ha:t.start.ha,line:t.start.line,offset:t.start.offset}}}};function Gi(e,t){if(t instanceof Error)throw t;"string"!=typeof e&&(e=ji(e));const n=ys(t);e=e.replace(/\r/g,"").split("\n");const i=Math.floor(Math.log10(Math.min(n.end.line+2,e.length)))+1;throw e=e.reduce(((e,t,r)=>{var s=r+1;if(2<n.start.line-s||2<s-n.end.line)return e;if(r=`${Array(i).fill(" ",0,Math.floor(Math.log10(s))+1-i).join("")}${s}: `,e.push(`${r}${t}`),s>=n.start.line&&s<=n.end.line){const i=s<n.end.line?t.length+r.length:n.end.ha-1+r.length;s=s>n.start.line?r.length:n.start.ha-1+r.length,t=" ".repeat(r.length)+Array.from(t.substring(0,s-r.length),(e=>"\t"===e?"\t":" ")).join("")+"^".repeat(i-s),e.push(t)}return e}),[]),t=vs(t).join("\n"),new qi(e.join("\n")+"\n\n"+t,n)}const Wi=Object.create(null);function Hi(e,t){const n=new Map;for(let t=0;t<e.length+1;++t)n.set(t,new Map);return function i(r,s){if(0===r)return s;if(0===s)return r;if(n.get(r).has(s))return n.get(r).get(s);var o=0;return e[r-1]!==t[s-1]&&(o=1),o=Math.min(i(r-1,s)+1,i(r,s-1)+1,i(r-1,s-1)+o),n.get(r).set(s,o),o}(e.length,t.length)}function Yi(e){const t=Wi[e]?Wi[e]:Object.keys(Wi).map((t=>({name:t,sb:Hi(e,t.slice(t.lastIndexOf(":")+1))}))).sort(((e,t)=>e.sb-t.sb)).slice(0,5).filter((t=>t.sb<e.length/2)).reduce(((e,t)=>e.concat(Wi[t.name])),[]).slice(0,5);return t.length?t.map((e=>`"Q{${e.namespaceURI}}${e.localName} (${e.j.map((e=>4===e?"...":P(e))).join(", ")})"`)).reduce(((e,t,n,i)=>0===n?e+t:e+(n!==i.length-1?", ":" or ")+t),"Did you mean ")+"?":"No similar functions found."}function Ji(e,t,n){var i=Wi[e+":"+t];return i&&(i=i.find((e=>e.j.some((e=>4===e))?e.j.length-1<=n:e.j.length===n)))?{j:i.j,arity:n,callFunction:i.callFunction,I:i.I,localName:t,namespaceURI:e,i:i.i}:null}function Ki(e,t,n,i,r){Wi[e+":"+t]||(Wi[e+":"+t]=[]),Wi[e+":"+t].push({j:n,arity:n.length,callFunction:r,I:!1,localName:t,namespaceURI:e,i:i})}var er={xml:"http://www.w3.org/XML/1998/namespace",xs:"http://www.w3.org/2001/XMLSchema",fn:"http://www.w3.org/2005/xpath-functions",map:"http://www.w3.org/2005/xpath-functions/map",array:"http://www.w3.org/2005/xpath-functions/array",math:"http://www.w3.org/2005/xpath-functions/math",fontoxpath:"http://fontoxml.com/fontoxpath",local:"http://www.w3.org/2005/xquery-local-functions"},tr=class{constructor(e,t,n,i){this.Da=[Object.create(null)],this.Ea=Object.create(null),this.s=e,this.ia=Object.keys(t).reduce(((e,n)=>(void 0===t[n]||(e[n]=`Q{}${n}[0]`),e)),Object.create(null)),this.o=Object.create(null),this.h=Object.create(null),this.v=n,this.l=i,this.D=[]}va(e,t,n){return Ji(e,t,n)}eb(e,t){return e?null:(e=this.ia[t],this.o[t]||(this.o[t]={name:t}),e)}Sa(e,t){const n=this.l(e,t);if(n)this.D.push({cc:e,arity:t,Db:n});else if(""===e.prefix){if(this.v)return{namespaceURI:this.v,localName:e.localName}}else if(t=this.$(e.prefix,!0))return{namespaceURI:t,localName:e.localName};return n}$(e,t=!0){return t?er[e]?er[e]:(t=this.s(e),this.h[e]||(this.h[e]={namespaceURI:t,prefix:e}),void 0!==t||e?t:null):null}},nr=(e,t)=>(e=2===e.node.nodeType?`${e.node.nodeName}="${K(t,e)}"`:e.node.outerHTML,Error(`XQTY0024: The node ${e} follows a node that is not an attribute node or a namespace node.`)),ir=e=>Error(`XQDY0044: The node name "${e.za()}" is invalid for a computed attribute constructor.`),rr=()=>Error("XQST0045: Functions and variables may not be declared in one of the reserved namespace URIs."),sr=(e,t)=>Error(`XQST0049: The function or variable "Q{${e}}${t}" is declared more than once.`),or=()=>Error("XQST0060: Functions declared in a module or as an external function must reside in a namespace."),ar=()=>Error("XQST0066: A Prolog may contain at most one default function namespace declaration."),lr=()=>Error("XQST0070: The prefixes xml and xmlns may not be used in a namespace declaration or be bound to another namespaceURI."),hr=e=>Error(`XQDY0074: The value "${e}" of a name expressions cannot be converted to an expanded QName.`),cr=e=>Error(`XPST0081: The prefix "${e}" could not be resolved`);function ur(e,t){return`Q{${e||""}}${t}`}function dr(e,t){for(let n=e.length-1;0<=n;--n)if(t in e[n])return e[n][t]}function pr(e){const t=new br(e.o);for(let n=0;n<e.h+1;++n)t.D=[Object.assign(Object.create(null),t.D[0],e.D[n])],t.Da=[Object.assign(Object.create(null),t.Da[0],e.Da[n])],t.l=Object.assign(Object.create(null),e.l),t.Ea=e.Ea,t.v=e.v;return t}function fr(e){e.s++,e.h++,e.D[e.h]=Object.create(null),e.Da[e.h]=Object.create(null)}function mr(e,t,n,i,r){if(i=ur(t,n)+"~"+i,e.l[i])throw sr(t,n);e.l[i]=r}function gr(e,t,n){e.D[e.h][t]=n}function Or(e,t,n){return t=ur(t||"",n),e.Da[e.h][t]=`${t}[${e.s}]`}function yr(e,t,n,i){e.Ea[`${ur(t||"",n)}[${e.s}]`]=i}function vr(e){e.D.length=e.h,e.Da.length=e.h,e.h--}var br=class{constructor(e){this.o=e,this.s=this.h=0,this.D=[Object.create(null)],this.l=Object.create(null),this.v=null,this.Ea=e&&e.Ea,this.Da=e&&e.Da}va(e,t,n,i=!1){const r=this.l[ur(e,t)+"~"+n];return!r||i&&r.wb?null===this.o?null:this.o.va(e,t,n,i):r}eb(e,t){const n=dr(this.Da,ur(e,t));return n||(null===this.o?null:this.o.eb(e,t))}Sa(e,t){var n=e.prefix;const i=e.localName;return""===n&&this.v?{localName:i,namespaceURI:this.v}:n&&(n=this.$(n,!1))?{localName:i,namespaceURI:n}:null===this.o?null:this.o.Sa(e,t)}$(e,t=!0){const n=dr(this.D,e||"");return void 0===n?null===this.o?void 0:this.o.$(e||"",t):n}};function wr(e,t){"*"===t||Array.isArray(t)||(t=[t]);for(let n=1;n<e.length;++n){if(!Array.isArray(e[n]))continue;const i=e[n];if("*"===t||t.includes(i[0]))return i}return null}function xr(e){return 2>e.length?"":"object"==typeof e[1]?e[2]||"":e[1]||""}function Sr(e,t){return Array.isArray(e)?"object"!=typeof(e=e[1])||Array.isArray(e)?null:t in e?e[t]:null:null}function kr(e,t){return t.reduce(wr,e)}function Ar(e,t){const n=[];for(let i=1;i<e.length;++i){if(!Array.isArray(e[i]))continue;const r=e[i];"*"!==t&&r[0]!==t||n.push(r)}return n}function Cr(e){return{localName:xr(e),namespaceURI:Sr(e,"URI"),prefix:Sr(e,"prefix")}}function _r(e){const t=wr(e,"typeDeclaration");if(!t||wr(t,"voidSequenceType"))return{type:59,g:2};const n=e=>{switch(e[0]){case"documentTest":return 55;case"elementTest":return 54;case"attributeTest":return 47;case"piTest":return 57;case"commentTest":return 58;case"textTest":return 56;case"anyKindTest":return 53;case"anyItemType":return 59;case"anyFunctionTest":case"functionTest":case"typedFunctionTest":return 60;case"anyMapTest":case"typedMapTest":return 61;case"anyArrayTest":case"typedArrayTest":return 62;case"atomicType":return $([Sr(e,"prefix"),xr(e)].join(":"));case"parenthesizedItemType":return n(wr(e,"*"));default:throw Error(`Type declaration "${wr(t,"*")[0]}" is not supported.`)}};e={type:n(wr(t,"*")),g:3};let i=null;const r=wr(t,"occurrenceIndicator");switch(r&&(i=xr(r)),i){case"*":return e.g=2,e;case"?":return e.g=0,e;case"+":return e.g=1,e;case"":case null:return e}}function Er(e,t,n){if("object"!=typeof e[1]||Array.isArray(e[1])){const i={};i[t]=n,e.splice(1,0,i)}else e[1][t]=n}function Tr(e,t,n){return(e<<20)+(t<<12)+(n.charCodeAt(0)<<8)+n.charCodeAt(1)}var Pr={[Tr(2,2,"idivOp")]:5,[Tr(16,16,"addOp")]:16,[Tr(16,16,"subtractOp")]:16,[Tr(16,16,"divOp")]:4,[Tr(16,2,"multiplyOp")]:16,[Tr(16,2,"divOp")]:16,[Tr(2,16,"multiplyOp")]:16,[Tr(17,17,"addOp")]:17,[Tr(17,17,"subtractOp")]:17,[Tr(17,17,"divOp")]:4,[Tr(17,2,"multiplyOp")]:17,[Tr(17,2,"divOp")]:17,[Tr(2,17,"multiplyOp")]:17,[Tr(9,9,"subtractOp")]:17,[Tr(7,7,"subtractOp")]:17,[Tr(8,8,"subtractOp")]:17,[Tr(9,16,"addOp")]:9,[Tr(9,16,"subtractOp")]:9,[Tr(9,17,"addOp")]:9,[Tr(9,17,"subtractOp")]:9,[Tr(7,16,"addOp")]:7,[Tr(7,16,"subtractOp")]:7,[Tr(7,17,"addOp")]:7,[Tr(7,17,"subtractOp")]:7,[Tr(8,17,"addOp")]:8,[Tr(8,17,"subtractOp")]:8,[Tr(9,16,"addOp")]:9,[Tr(9,16,"subtractOp")]:9,[Tr(9,17,"addOp")]:9,[Tr(9,17,"subtractOp")]:9,[Tr(7,17,"addOp")]:7,[Tr(7,17,"subtractOp")]:7,[Tr(7,16,"addOp")]:7,[Tr(7,16,"subtractOp")]:7,[Tr(8,17,"addOp")]:8,[Tr(8,17,"subtractOp")]:8},$r={[Tr(2,2,"addOp")]:(e,t)=>e+t,[Tr(2,2,"subtractOp")]:(e,t)=>e-t,[Tr(2,2,"multiplyOp")]:(e,t)=>e*t,[Tr(2,2,"divOp")]:(e,t)=>e/t,[Tr(2,2,"modOp")]:(e,t)=>e%t,[Tr(2,2,"idivOp")]:(e,t)=>Math.trunc(e/t),[Tr(16,16,"addOp")]:function(e,t){return new ut(e.ea+t.ea)},[Tr(16,16,"subtractOp")]:function(e,t){return new ut(e.ea-t.ea)},[Tr(16,16,"divOp")]:function(e,t){return e.ea/t.ea},[Tr(16,2,"multiplyOp")]:pt,[Tr(16,2,"divOp")]:function(e,t){if(isNaN(t))throw Error("FOCA0005: Cannot divide xs:yearMonthDuration by NaN");if((e=Math.round(e.ea/t))>Number.MAX_SAFE_INTEGER||!Number.isFinite(e))throw Error("FODT0002: Value overflow while dividing xs:yearMonthDuration");return new ut(e<Number.MIN_SAFE_INTEGER||0===e?0:e)},[Tr(2,16,"multiplyOp")]:(e,t)=>pt(t,e),[Tr(17,17,"addOp")]:function(e,t){return new Oe(e.ca+t.ca)},[Tr(17,17,"subtractOp")]:function(e,t){return new Oe(e.ca-t.ca)},[Tr(17,17,"divOp")]:function(e,t){if(0===t.ca)throw Error("FOAR0001: Division by 0");return e.ca/t.ca},[Tr(17,2,"multiplyOp")]:we,[Tr(17,2,"divOp")]:function(e,t){if(isNaN(t))throw Error("FOCA0005: Cannot divide xs:dayTimeDuration by NaN");if((e=e.ca/t)>Number.MAX_SAFE_INTEGER||!Number.isFinite(e))throw Error("FODT0002: Value overflow while dividing xs:dayTimeDuration");return new Oe(e<Number.MIN_SAFE_INTEGER||Object.is(-0,e)?0:e)},[Tr(2,17,"multiplyOp")]:(e,t)=>we(t,e),[Tr(9,9,"subtractOp")]:Ie,[Tr(7,7,"subtractOp")]:Ie,[Tr(8,8,"subtractOp")]:Ie,[Tr(9,16,"addOp")]:Qe,[Tr(9,16,"subtractOp")]:Re,[Tr(9,17,"addOp")]:Qe,[Tr(9,17,"subtractOp")]:Re,[Tr(7,16,"addOp")]:Qe,[Tr(7,16,"subtractOp")]:Re,[Tr(7,17,"addOp")]:Qe,[Tr(7,17,"subtractOp")]:Re,[Tr(8,17,"addOp")]:Qe,[Tr(8,17,"subtractOp")]:Re,[Tr(9,16,"addOp")]:Qe,[Tr(9,16,"subtractOp")]:Re,[Tr(9,17,"addOp")]:Qe,[Tr(9,17,"subtractOp")]:Re,[Tr(7,17,"addOp")]:Qe,[Tr(7,17,"subtractOp")]:Re,[Tr(7,16,"addOp")]:Qe,[Tr(7,16,"subtractOp")]:Re,[Tr(8,17,"addOp")]:Qe,[Tr(8,17,"subtractOp")]:Re};function Nr(e,t){return A(e,5)&&A(t,5)?5:A(e,4)&&A(t,4)?4:A(e,6)&&A(t,6)?6:3}const Ir=[2,16,17,9,7,8];function Qr(e,t,n){function i(e,t){return{U:r?r(e):e,V:s?s(t):t}}let r=null,s=null;A(t,19)&&(r=e=>xt(e,3),t=3),A(n,19)&&(s=e=>xt(e,3),n=3);const o=Ir.filter((e=>A(t,e))),a=Ir.filter((e=>A(n,e)));if(o.includes(2)&&a.includes(2)){const r=$r[Tr(2,2,e)];let s=Pr[Tr(2,2,e)];return s||=Nr(t,n),"divOp"===e&&5===s&&(s=4),"idivOp"===e?Rr(i,r)[0]:(e,t)=>{const{U:n,V:o}=i(e,t);return O(r(n.value,o.value),s)}}for(const t of o)for(const n of a){const r=$r[Tr(t,n,e)],s=Pr[Tr(t,n,e)];if(r&&void 0!==s)return(e,t)=>{const{U:n,V:o}=i(e,t);return O(r(n.value,o.value),s)}}}function Rr(e,t){return[(n,i)=>{const{U:r,V:s}=e(n,i);if(0===s.value)throw Error("FOAR0001: Divisor of idiv operator cannot be (-)0");if(Number.isNaN(r.value)||Number.isNaN(s.value)||!Number.isFinite(r.value))throw Error("FOAR0002: One of the operands of idiv is NaN or the first operand is (-)INF");return Number.isFinite(r.value)&&!Number.isFinite(s.value)?O(0,5):O(t(r.value,s.value),5)},5]}const Mr=Object.create(null);var Br=class extends ti{constructor(e,t,n,i,r){super(t.o.add(n.o),[t,n],{B:!1},!1,i),this.A=t,this.L=n,this.l=e,this.s=r}h(e,t){return it(ei(this.A,e,t),t).N((n=>0===n.length?D.empty():it(ei(this.L,e,t),t).N((e=>{if(0===e.length)return D.empty();if(1<n.length||1<e.length)throw Error('XPTY0004: the operands of the "'+this.l+'" operator should be empty or singleton.');const t=n[0];if(e=e[0],this.s&&this.type)return D.m(this.s(t,e));var i=t.type,r=e.type,s=this.l;const o=`${i}~${r}~${s}`;let a=Mr[o];if(a||=Mr[o]=Qr(s,i,r),!(i=a))throw Error(`XPTY0004: ${this.l} not available for types ${E[t.type]} and ${E[e.type]}`);return D.m(i(t,e))}))))}};function Dr(e,t,n){const i=Cr(kr(e,["forClauseItem","typedVariableBinding","varName"]));(e=kr(e,["forClauseItem","forExpr","sequenceExpr"]))&&(e=Ar(e,"*").map((e=>n(e,t))),e.includes(void 0)||e.includes(null)||1===(e=Xr(e)).length&&Yr(t,i.localName,e[0]))}function Xr(e){return e.filter(((e,t,n)=>n.findIndex((t=>t.type===e.type&&t.g===e.g))===t))}function Fr(e,t,n){const i=Ar(e,"*"),r=wr(e,"atomicType");if(!r)return{type:59,g:2};if($(Sr(r,"prefix")+":"+r[2])===t.type)if(1===i.length){if(3===t.g)return n}else if(e=wr(e,"occurrenceIndicator")[1],t.g===function(e){switch(e){case"*":return 2;case"?":return 0;case"+":return 1;default:return 3}}(e))return n}function Lr(e,t){Ur(e,t)}function Ur(e,t){var n=Wr.get(e[0]);if(n)return n(e,t);for(n=1;n<e.length;n++)e[n]&&Ur(e[n],t)}const Vr=(e,t)=>{var n=Ur(wr(e,"firstOperand")[1],t);const i=Ur(wr(e,"secondOperand")[1],t);var r=e[0];if(n&&i){if(!(t=function(e,t,n){var i=[2,53,59,46,47];if(i.includes(t)||i.includes(n))return 2;let r=null,s=null;A(t,19)&&(r=e=>xt(e,3),t=3),A(n,19)&&(s=e=>xt(e,3),n=3);var o=Ir.filter((e=>A(t,e)));if(i=Ir.filter((e=>A(n,e))),o.includes(2)&&i.includes(2)){var a=Pr[Tr(2,2,e)];return void 0===a&&(a=Nr(t,n)),"divOp"===e&&5===a&&(a=4),"idivOp"===e?Rr((function(e,t){return{U:r?r(e):e,V:s?s(t):t}}),((e,t)=>Math.trunc(e/t)))[1]:a}for(a of o)for(const t of i)if(o=Pr[Tr(a,t,e)],void 0!==o)return o}(r,n.type,i.type)))throw Error(`XPTY0004: ${r} not available for types ${P(n)} and ${P(i)}`);n={type:t,g:n.g},2!==t&&59!==t&&Er(e,"type",n),e=n}else e={type:2,g:3};return e},zr=(e,t)=>{Ur(wr(e,"firstOperand")[1],t),Ur(wr(e,"secondOperand")[1],t);e:{switch(e[0]){case"orOp":case"andOp":Er(e,"type",t={type:0,g:3}),e=t;break e}e=void 0}return e},Zr=(e,t)=>{Ur(wr(e,"firstOperand")[1],t),Ur(wr(e,"secondOperand")[1],t);e:{switch(e[0]){case"unionOp":case"intersectOp":case"exceptOp":Er(e,"type",t={type:53,g:2}),e=t;break e}e=void 0}return e},jr=(e,t)=>(Ur(wr(e,"firstOperand")[1],t),Ur(wr(e,"secondOperand")[1],t),Er(e,"type",t={type:0,g:3}),t),qr=(e,t)=>{Ur(wr(e,"firstOperand")[1],t),Ur(wr(e,"secondOperand")[1],t),t=Sr(kr(e,["firstOperand","*"]),"type");const n=Sr(kr(e,["secondOperand","*"]),"type");return Er(e,"type",t={type:0,g:lt(t)||lt(n)?0:3}),t},Gr=(e,t)=>{Ur(wr(e,"firstOperand")[1],t),Ur(wr(e,"secondOperand")[1],t),t=Sr(kr(e,["firstOperand","*"]),"type");const n=Sr(kr(e,["secondOperand","*"]),"type");return Er(e,"type",t={type:0,g:lt(t)||lt(n)?0:3}),t},Wr=new Map([["unaryMinusOp",(e,t)=>((t=Ur(wr(e,"operand")[1],t))?A(t.type,2)?(Er(e,"type",t={type:t.type,g:t.g}),e=t):(Er(e,"type",t={type:3,g:3}),e=t):(Er(e,"type",t={type:2,g:2}),e=t),e)],["unaryPlusOp",(e,t)=>((t=Ur(wr(e,"operand")[1],t))?A(t.type,2)?(Er(e,"type",t={type:t.type,g:t.g}),e=t):(Er(e,"type",t={type:3,g:3}),e=t):(Er(e,"type",t={type:2,g:2}),e=t),e)],["addOp",Vr],["subtractOp",Vr],["divOp",Vr],["idivOp",Vr],["modOp",Vr],["multiplyOp",Vr],["andOp",zr],["orOp",zr],["sequenceExpr",(e,t)=>{const n=Ar(e,"*"),i=n.map((e=>Ur(e,t)));return function(e,t,n){return t=0===t?{type:53,g:2}:1===t?n[0]:n.includes(void 0)||n.includes(null)||1<(t=Xr(n)).length?{type:59,g:2}:{type:t[0].type,g:2},t&&59!==t.type&&Er(e,"type",t),t}(e,n.length,i)}],["unionOp",Zr],["intersectOp",Zr],["exceptOp",Zr],["stringConcatenateOp",(e,t)=>(Ur(wr(e,"firstOperand")[1],t),Ur(wr(e,"secondOperand")[1],t),Er(e,"type",t={type:1,g:3}),t)],["rangeSequenceExpr",(e,t)=>(Ur(wr(e,"startExpr")[1],t),Ur(wr(e,"endExpr")[1],t),Er(e,"type",t={type:5,g:1}),t)],["equalOp",jr],["notEqualOp",jr],["lessThanOrEqualOp",jr],["lessThanOp",jr],["greaterThanOrEqualOp",jr],["greaterThanOp",jr],["eqOp",qr],["neOp",qr],["ltOp",qr],["leOp",qr],["gtOp",qr],["geOp",qr],["isOp",Gr],["nodeBeforeOp",Gr],["nodeAfterOp",Gr],["pathExpr",(e,t)=>{const n=wr(e,"rootExpr");return n&&n[1]&&Ur(n[1],t),Ar(e,"stepExpr").map((e=>Ur(e,t))),function(e,t){var n=Ar(e,"stepExpr");if(!n)return{type:59,g:2};for(const e of n){e:{n=e;var i=t;let s=null;if(!n)break e;var r=Ar(n,"*");let o="";for(const e of r)switch(e[0]){case"filterExpr":s=Sr(kr(e,["*"]),"type");break;case"xpathAxis":o=e[1];t:{switch(o){case"attribute":s={type:47,g:2};break t;case"child":case"decendant":case"self":case"descendant-or-self":case"following-sibling":case"following":case"namespace":case"parent":case"ancestor":case"preceding-sibling":case"preceding":case"ancestor-or-self":s={type:53,g:2};break t}s=void 0}break;case"nameTest":if(r=Cr(e),null!==r.namespaceURI)break;if("attribute"===o&&!r.prefix)break;void 0!==(r=i.$(r.prefix||""))&&Er(e,"URI",r);break;case"lookup":s={type:59,g:2}}s&&59!==s.type&&Er(n,"type",s)}i=Sr(e,"type")}return i&&59!==i.type&&Er(e,"type",i),i}(e,t)}],["contextItemExpr",()=>({type:59,g:2})],["ifThenElseExpr",(e,t)=>{var n=wr(e,"ifClause")||wr(Ar(e,"x:stackTrace")[0],"ifClause");const i=wr(e,"thenClause")||wr(Ar(e,"x:stackTrace")[1],"thenClause"),r=wr(e,"elseClause")||wr(Ar(e,"x:stackTrace")[2],"elseClause");return Ur(wr(n,"*"),t),n=Ur(wr(i,"*"),t),t=Ur(wr(r,"*"),t),n&&t&&n.type===t.type&&n.g===t.g?(59!==n.type&&Er(e,"type",n),e=n):e={type:59,g:2},e}],["instanceOfExpr",(e,t)=>(Ur(wr(e,"argExpr"),t),Ur(wr(e,"sequenceType"),t),Er(e,"type",t={type:0,g:3}),t)],["integerConstantExpr",e=>{const t={type:5,g:3};return Er(e,"type",t),t}],["doubleConstantExpr",e=>{const t={type:3,g:3};return Er(e,"type",t),t}],["decimalConstantExpr",e=>{const t={type:4,g:3};return Er(e,"type",t),t}],["stringConstantExpr",e=>{const t={type:1,g:3};return Er(e,"type",t),t}],["functionCallExpr",(e,t)=>(Ar(wr(e,"arguments"),"*").map((e=>Ur(e,t))),function(e,t){if(!t||!t.ga)return{type:59,g:2};const n=wr(e,"functionName");var i=Cr(n);let r=i.localName;var s=i.prefix;let o=i.namespaceURI;if(i=Ar(wr(e,"arguments"),"*"),null===o){if(!(s=t.ga.Sa({localName:r,prefix:s},i.length)))return{type:59,g:2};r=s.localName,o=s.namespaceURI,Er(n,"URI",o),n[2]=r}return(t=t.ga.va(o,r,i.length))&&63!==t.i.type?(59!==t.i.type&&Er(e,"type",t.i),t.i):{type:59,g:2}}(e,t))],["arrowExpr",(e,t)=>(Ur(wr(e,"argExpr")[1],t),function(e,t){if(!t||!t.ga)return{type:59,g:2};var n=wr(e,"EQName");if(!n)return{type:59,g:2};var i=Cr(n);n=i.localName;const r=i.prefix;return i=Ar(wr(e,"arguments"),"*"),(n=t.ga.Sa({localName:n,prefix:r},i.length))&&(t=t.ga.va(n.namespaceURI,n.localName,i.length+1))?(59!==t.i.type&&Er(e,"type",t.i),t.i):{type:59,g:2}}(e,t))],["dynamicFunctionInvocationExpr",(e,t)=>(Ur(kr(e,["functionItem","*"]),t),(e=wr(e,"arguments"))&&Ur(e,t),{type:59,g:2})],["namedFunctionRef",(e,t)=>function(e,t){if(!t||!t.ga)return{type:59,g:2};const n=wr(e,"functionName");var i=Cr(n);let r=i.localName;var s=i.namespaceURI;const o=i.prefix;if(i=Number(kr(e,["integerConstantExpr","value"])[1]),!s){if(!(s=t.ga.Sa({localName:r,prefix:o},i)))return{type:59,g:2};r=s.localName,Er(n,"URI",s=s.namespaceURI)}return(t=t.ga.va(s,r,i)||null)?(59!==t.i.type&&63!==t.i.type&&Er(e,"type",t.i),t.i):{type:59,g:2}}(e,t)],["inlineFunctionExpr",(e,t)=>(Ur(wr(e,"functionBody")[1],t),Er(e,"type",t={type:60,g:3}),t)],["castExpr",e=>{var t=kr(e,["singleType","atomicType"]);return 59!==(t={type:$(Sr(t,"prefix")+":"+t[2]),g:3}).type&&Er(e,"type",t),t}],["castableExpr",e=>{const t={type:0,g:3};return Er(e,"type",t),t}],["simpleMapExpr",(e,t)=>{const n=Ar(e,"pathExpr");let i;for(let e=0;e<n.length;e++)i=Ur(n[e],t);return null!=i?(59!==(t={type:i.type,g:2}).type&&Er(e,"type",t),e=t):e={type:59,g:2},e}],["mapConstructor",(e,t)=>(Ar(e,"mapConstructorEntry").map((e=>({key:Ur(kr(e,["mapKeyExpr","*"]),t),value:Ur(kr(e,["mapValueExpr","*"]),t)}))),function(e){const t={type:61,g:3};return Er(e,"type",t),t}(e))],["arrayConstructor",(e,t)=>(Ar(wr(e,"*"),"arrayElem").map((e=>Ur(e,t))),function(e){const t={type:62,g:3};return Er(e,"type",t),t}(e))],["unaryLookup",e=>(wr(e,"NCName"),{type:59,g:2})],["typeswitchExpr",(e,t)=>{const n=Ur(wr(e,"argExpr")[1],t),i=Ar(e,"typeswitchExprCaseClause").map((e=>Ur(kr(e,["resultExpr"])[1],t)));return function(e,t,n,i){if(!t||n.includes(void 0))return{type:59,g:2};var r=Ar(e,"typeswitchExprCaseClause");for(let o=0;o<n.length;o++){var s=wr(r[o],"*");switch(s[0]){case"sequenceType":if(s=Fr(s,t,n[o]))return 59!==s.type&&Er(e,"type",s),s;continue;case"sequenceTypeUnion":for(i=Ar(s,"*"),r=0;2>r;r++)if(s=Fr(i[r],t,n[o]))return 59!==s.type&&Er(e,"type",s),s;default:return{type:59,g:2}}}return 59!==i.type&&Er(e,"type",i),i}(e,n,i,Ur(kr(e,["typeswitchExprDefaultClause","resultExpr"])[1],t))}],["quantifiedExpr",(e,t)=>(Ar(e,"*").map((e=>Ur(e,t))),function(e){const t={type:0,g:3};return Er(e,"type",t),t}(e))],["x:stackTrace",(e,t)=>Ur((e=Ar(e,"*"))[0],t)],["queryBody",(e,t)=>Ur(e[1],t)],["flworExpr",(e,t)=>function(e,t){var n=Ur;let i=!1;for(var r=1;r<e.length;r++)switch(e[r][0]){case"letClause":Hr(t);var s=e[r],o=t,a=n,l=kr(s,["letClauseItem","typedVariableBinding","varName"]);l=Cr(l),a=a((s=kr(s,["letClauseItem","letExpr"]))[1],o),Yr(o,l.localName,a);break;case"forClause":i=!0,Hr(t),Dr(e[r],t,n);break;case"whereClause":Hr(t),n(o=e[r],t),Er(o,"type",{type:0,g:3});break;case"orderByClause":Hr(t);break;case"returnClause":return o=n,Er(n=kr(r=e[r],["*"]),"type",t=o(n,t)),Er(r,"type",t),(n=t)?(i&&(n={type:n.type,g:2}),59!==n.type&&Er(e,"type",n),n):{type:59,g:2};default:return(n=n(e[r],t))?(i&&(n={type:n.type,g:2}),59!==n.type&&Er(e,"type",n),n):{type:59,g:2}}if(!(0<t.h))throw Error("Variable scope out of bound");t.h--,t.o.pop(),t.v.pop()}(e,t)],["varRef",(e,t)=>{const n=Cr(wr(e,"name"));var i;e:{for(i=t.h;0<=i;i--){const e=t.o[i][n.localName];if(e){i=e;break e}}i=void 0}return i&&59!==i.type&&Er(e,"type",i),null===n.namespaceURI&&(void 0!==(t=t.$(n.prefix))&&Er(e,"URI",t)),i}]]);function Hr(e){e.h++,e.o.push({}),e.v.push({})}function Yr(e,t,n){if(e.o[e.h][t])throw Error(`Another variable of in the scope ${e.h} with the same name ${t} already exists`);e.o[e.h][t]=n}var Jr=class{constructor(e){this.h=0,this.ga=e,this.o=[{}],this.v=[{}]}$(e){for(let t=this.h;0<=t;t--){const n=this.v[t][e];if(void 0!==n)return n}return this.ga?this.ga.$(e):void 0}},Kr=class extends ti{constructor(e,t){super(new Oi({external:1}),e,{B:e.every((e=>e.B))},!1,t),this.l=e}h(e,t){return 0===this.l.length?D.m(new ae([])):ei(this.l[0],e,t).N((e=>D.m(new ae(e.map((e=>X(D.m(e))))))))}},es=class extends ti{constructor(e,t){super(new Oi({external:1}),e,{B:e.every((e=>e.B))},!1,t),this.l=e}h(e,t){return D.m(new ae(this.l.map((n=>X(ei(n,e,t))))))}};function ts(e){if(null===e)throw Je("context is absent, it needs to be present to use axes.");if(!A(e.type,53))throw Error("XPTY0020: Axes can only be applied to nodes.");return e.value}var ns=class extends ti{constructor(e,t){t=t||{Qa:!1},super(e.o,[e],{R:"reverse-sorted",W:!1,subtree:!1,B:!1}),this.l=e,this.s=!!t.Qa}h(e,t){t=t.h,e=ts(e.M);var n=this.l.D();return n=n&&(n.startsWith("name-")||"type-1"===n)?"type-1":null,D.create(function(e,t,n){let i=t;return{next:()=>{if(!i)return x;const t=i;return i=ne(e,t,n),S(he(t))}}}(t,this.s?e:ne(t,e,n),n)).filter((e=>this.l.l(e)))}};const is=new Map([["type-1-or-type-2",["name","type-1","type-2"]],["type-1",["name"]],["type-2",["name"]]]);function rs(e,t){if(null===e)return t;if(null===t||e===t)return e;const n=e.startsWith("name-")?"name":e,i=t.startsWith("name-")?"name":t,r=is.get(n);return void 0!==r&&r.includes(i)?t:void 0!==(t=is.get(i))&&t.includes(n)?e:"empty"}var ss=class extends ti{constructor(e,t){super(new Oi({attribute:1}),[e],{R:"unsorted",subtree:!0,W:!0,B:!1}),this.l=e,this.s=rs(this.l.D(),t)}h(e,t){return t=t.h,1!==(e=ts(e.M)).node.nodeType?D.empty():(e=H(t,e,this.s).filter((e=>"http://www.w3.org/2000/xmlns/"!==e.node.namespaceURI)).map((e=>he(e))).filter((e=>this.l.l(e))),D.create(e))}D(){return"type-1"}},os=class extends ti{constructor(e,t){super(e.o,[e],{R:"sorted",subtree:!0,W:!0,B:!1}),this.s=e,this.l=rs(t,e.D())}h(e,t){const n=t.h,i=ts(e.M);if(1!==(e=i.node.nodeType)&&9!==e)return D.empty();let r=null,s=!1;return D.create({next:()=>{for(;!s;){if(!r){if(r=ee(n,i,this.l),!r){s=!0;continue}return S(he(r))}if(r=ie(n,r,this.l))return S(he(r));s=!0}return x}}).filter((e=>this.s.l(e)))}};function as(e,t,n){const i=t.node.nodeType;if(1!==i&&9!==i)return{next:()=>x};let r=ee(e,t,n);return{next(){if(!r)return x;const t=r;return r=ie(e,r,n),S(t)}}}var ls=class extends ti{constructor(e,t){t=t||{Qa:!1},super(e.o,[e],{B:!1,W:!1,R:"sorted",subtree:!0}),this.l=e,this.s=!!t.Qa,this.A=(e=this.l.D())&&(e.startsWith("name-")||"type-1"===e)||"type-1-or-type-2"===e?"type-1":null}h(e,t){return e=function(e,t,n){const i=[St(t)];return{next:t=>{if(0<i.length&&0!=(1&t)&&i.shift(),!i.length)return x;for(t=i[0].next(0);t.done;){if(i.shift(),!i.length)return x;t=i[0].next(0)}return i.unshift(as(e,t.value,n)),S(he(t.value))}}}(t=t.h,e=ts(e.M),this.A),this.s||e.next(0),D.create(e).filter((e=>this.l.l(e)))}};function hs(e,t,n){var i=e.node.nodeType;if(1!==i&&9!==i)return e;for(i=te(t,e,n);null!==i;){if(1!==i.node.nodeType)return i;i=te(t,e=i,n)}return e}function cs(e,t,n=!1,i){if(n){let n=t,r=!1;return{next:()=>{if(r)return x;if(At(n,t))return n=hs(t,e,i),At(n,t)?(r=!0,x):S(he(n));const s=n.node.nodeType,o=9===s||2===s?null:re(e,n,i);return null!==o?(n=hs(o,e,i),S(he(n))):(n=9===s?null:ne(e,n,i),At(n,t)?(r=!0,x):S(he(n)))}}}const r=[as(e,t,i)];return{next:()=>{if(!r.length)return x;let t=r[0].next(0);for(;t.done;){if(r.shift(),!r.length)return x;t=r[0].next(0)}return r.unshift(as(e,t.value,i)),S(he(t.value))}}}var us=class extends ti{constructor(e){super(e.o,[e],{R:"sorted",W:!0,subtree:!1,B:!1}),this.l=e,this.s=(e=this.l.D())&&(e.startsWith("name-")||"type-1"===e)?"type-1":null}h(e,t){return t=t.h,e=ts(e.M),D.create(function(e,t,n){const i=[];for(;t&&9!==t.node.nodeType;t=ne(e,t,null)){const r=ie(e,t,n);r&&i.push(r)}let r=null;return{next:()=>{for(;r||i.length;){if(!r){r=cs(e,i[0],!1,n);var t=S(he(i[0]));const s=ie(e,i[0],n);return s?i[0]=s:i.shift(),t}if(!(t=r.next(0)).done)return t;r=null}return x}}}(t,e,this.s)).filter((e=>this.l.l(e)))}};var ds=class extends ti{constructor(e,t){super(e.o,[e],{R:"sorted",W:!0,subtree:!1,B:!1}),this.l=e,this.s=rs(this.l.D(),t)}h(e,t){return t=t.h,e=ts(e.M),D.create(function(e,t,n){return{next:()=>(t=t&&ie(e,t,n))?S(he(t)):x}}(t,e,this.s)).filter((e=>this.l.l(e)))}},ps=class extends ti{constructor(e,t){super(e.o,[e],{R:"reverse-sorted",W:!0,subtree:!0,B:!1}),this.l=e,this.s=rs(t,this.l.D())}h(e,t){return(e=ne(t=t.h,e=ts(e.M),this.s))?(e=he(e),this.l.l(e)?D.m(e):D.empty()):D.empty()}};var fs=class extends ti{constructor(e){super(e.o,[e],{B:!1,W:!0,R:"reverse-sorted",subtree:!1}),this.l=e,this.s=(e=this.l.D())&&(e.startsWith("name-")||"type-1"===e)?"type-1":null}h(e,t){return t=t.h,e=ts(e.M),D.create(function(e,t,n){const i=[];for(;t&&9!==t.node.nodeType;t=ne(e,t,null)){const r=re(e,t,n);null!==r&&i.push(r)}let r=null;return{next:()=>{for(;r||i.length;){r||=cs(e,i[0],!0,n);var t=r.next(0);if(t.done){r=null,t=re(e,i[0],n);const s=S(he(i[0]));return null===t?i.shift():i[0]=t,s}return t}return x}}}(t,e,this.s)).filter((e=>this.l.l(e)))}};var ms=class extends ti{constructor(e,t){super(e.o,[e],{B:!1,W:!0,R:"reverse-sorted",subtree:!1}),this.l=e,this.s=rs(this.l.D(),t)}h(e,t){return t=t.h,e=ts(e.M),D.create(function(e,t,n){return{next:()=>(t=t&&re(e,t,n))?S(he(t)):x}}(t,e,this.s)).filter((e=>this.l.l(e)))}},gs=class extends ti{constructor(e,t){super(e.o,[e],{R:"sorted",subtree:!0,W:!0,B:!1}),this.l=e,this.s=rs(this.l.D(),t)}h(e){return ts(e.M),this.l.l(e.M)?D.m(e.M):D.empty()}D(){return this.s}},Os=class extends pi{constructor(e,t,n,i){super(e.o.add(t.o).add(n.o),[e,t,n],{B:e.B&&t.B&&n.B,W:t.W===n.W&&t.W,R:t.ia===n.ia?t.ia:"unsorted",subtree:t.subtree===n.subtree&&t.subtree},i),this.l=e}A(e,t,n){let i=null;const r=n[0](e);return D.create({next:t=>(i||(i=(r.fa()?n[1](e):n[2](e)).value),i.next(t))})}v(e){if(super.v(e),this.l.I)throw Vn()}};function ys(e){return e.h instanceof Error?e.location:ys(e.h)}function vs(e){let t;return t=e.h instanceof qi?["Inner error:",e.h.message]:e.h instanceof Error?[e.h.toString()]:vs(e.h),t.push(`  at <${e.o}${e.Wa?` (${e.Wa})`:""}>:${e.location.start.line}:${e.location.start.ha} - ${e.location.end.line}:${e.location.end.ha}`),t}var bs=class{constructor(e,t,n,i){this.location=e,this.o=t,this.Wa=n,this.h=i}},ws=class extends pi{constructor(e,t,n,i){super(n.o,[n],{B:n.B,W:n.W,R:n.ia,subtree:n.subtree}),this.L=t,this.P={end:{ha:e.end.ha,line:e.end.line,offset:e.end.offset},start:{ha:e.start.ha,line:e.start.line,offset:e.start.offset}},this.l=i}A(e,t,[n]){let i;try{i=n(e)}catch(e){throw new bs(this.P,this.L,this.l,e)}return D.create({next:e=>{try{return i.value.next(e)}catch(e){throw new bs(this.P,this.L,this.l,e)}}})}v(e){try{super.v(e)}catch(e){throw new bs(this.P,this.L,this.l,e)}}D(){return this.Fa[0].D()}};function xs(e,t,n,i){let r=[];const s=e.L(t,n,i,(n=>{if(e.l instanceof ks){return di(xs(e.l,t,n,i),(e=>r=e))}let s=null;return D.create({next:()=>{for(;;){if(!s){var t=n.next(0);if(t.done)return x;t=e.l.s(t.value,i),s=di(t,(e=>r=hi(r,e))).value}if(!(t=s.next(0)).done)return t;s=null}}})}));let o=!1;return{next:()=>{if(o)return x;const e=s.O();return o=!0,S(new ni(e,r))}}}function Ss(e,t,n,i){return e.L(t,n,i,(n=>{if(e.l instanceof ks)return Ss(e.l,t,n,i);let r=null;return D.create({next:()=>{for(;;){if(!r){var t=n.next(0);if(t.done)return x;r=ei(e.l,t.value,i).value}if(!(t=r.next(0)).done)return t;r=null}}})}))}var ks=class extends ti{constructor(e,t,n,i){super(e,t,n,!0),this.l=i,this.I=this.l.I}h(e,t){return this.L(e,St(e),t,(n=>{if(this.l instanceof ks)return Ss(this.l,e,n,t);let i=null;return D.create({next:e=>{for(;;){if(!i){var r=n.next(0);if(r.done)return x;i=ei(this.l,r.value,t).value}if(!(r=i.next(e)).done)return r;i=null}}})}))}s(e,t){return xs(this,e,St(e),t)}v(e){super.v(e),this.I=this.l.I;for(const e of this.Fa)if(e!==this.l&&e.I)throw Vn()}},As=class extends ks{constructor(e,t,n,i){super(t.o.add(i.o),[t,i],{B:!1},i),this.P=e.prefix,this.ma=e.namespaceURI,this.Pb=e.localName,this.yb=null,this.A=n,this.La=null,this.ya=t}L(e,t,n,i){let r=null,s=null,o=0;return i({next:()=>{for(;;){if(!r){var e=t.next(0);if(e.done)return x;s=e.value,o=0,r=ei(this.ya,s,n).value}const i=r.next(0);if(!i.done)return o++,e={[this.yb]:()=>D.m(i.value)},this.La&&(e[this.La]=()=>D.m(new _(5,o))),S(qe(s,e));r=null}}})}v(e){if(this.P&&(this.ma=e.$(this.P),!this.ma&&this.P))throw Error(`XPST0081: Could not resolve namespace for prefix ${this.P} in a for expression`);if(this.ya.v(e),fr(e),this.yb=Or(e,this.ma,this.Pb),this.A){if(this.A.prefix&&(this.A.namespaceURI=e.$(this.A.prefix),!this.A.namespaceURI&&this.A.prefix))throw Error(`XPST0081: Could not resolve namespace for prefix ${this.P} in the positionalVariableBinding in a for expression`);this.La=Or(e,this.A.namespaceURI,this.A.localName)}if(this.l.v(e),vr(e),this.ya.I)throw Vn();this.l.I&&(this.I=!0)}},Cs=class extends ti{constructor(e,t,n){super(new Oi({external:1}),[n],{B:!1,R:"unsorted"}),this.P=e.map((({name:e})=>e)),this.A=e.map((({type:e})=>e)),this.s=null,this.L=t,this.l=n}h(e,t){const n=new L({j:this.A,arity:this.A.length,Ya:!0,I:this.l.I,localName:"dynamic-function",namespaceURI:"",i:this.L,value:(n,i,r,...s)=>(n=qe(Ue(e,-1,null,D.empty()),this.s.reduce(((e,t,n)=>(e[t]=X(s[n]),e)),Object.create(null))),ei(this.l,n,t))});return D.m(n)}v(e){if(fr(e),this.s=this.P.map((t=>Or(e,t.namespaceURI,t.localName))),this.l.v(e),vr(e),this.l.I)throw Error("Not implemented: inline functions can not yet be updating.")}},_s=class extends ks{constructor(e,t,n){if(super(t.o.add(n.o),[t,n],{B:!1,W:n.W,R:n.ia,subtree:n.subtree},n),e.prefix||e.namespaceURI)throw Error("Not implemented: let expressions with namespace usage.");this.A=e.prefix,this.P=e.namespaceURI,this.La=e.localName,this.ma=t,this.ya=null}L(e,t,n,i){return i({next:()=>{var e=t.next(0);return e.done?x:S(e=qe(e=e.value,{[this.ya]:X(ei(this.ma,e,n))}))}})}v(e){if(this.A&&(this.P=e.$(this.A),!this.P&&this.A))throw Error(`XPST0081: Could not resolve namespace for prefix ${this.A} using in a for expression`);if(this.ma.v(e),fr(e),this.ya=Or(e,this.P,this.La),this.l.v(e),vr(e),this.I=this.l.I,this.ma.I)throw Vn()}},Es=class extends ti{constructor(e,t){let n;switch(super(new Oi({}),[],{B:!0,R:"sorted"},!1,t),t.type){case 5:n=O(parseInt(e,10),t.type);break;case 1:n=O(e,t.type);break;case 4:case 3:n=O(parseFloat(e),t.type);break;default:throw new TypeError("Type "+t+" not expected in a literal")}this.l=()=>D.m(n)}h(){return this.l()}},Ts=class extends ti{constructor(e,t){super(new Oi({external:1}),e.reduce(((e,{key:t,value:n})=>e.concat(t,n)),[]),{B:!1},!1,t),this.l=e}h(e,t){const n=this.l.map((n=>it(ei(n.key,e,t),t).X({default:()=>{throw Error("XPTY0004: A key of a map should be a single atomizable value.")},m:e=>e})));return ce(n,(n=>D.m(new pe(n.map(((n,i)=>({key:n,value:X(ei(this.l[i].value,e,t))})))))))}},Ps=class extends ti{constructor(e,t,n){super(new Oi({external:1}),[],{B:!0},!1,n),this.s=t,this.A=e,this.l=null}h(){const e=new L({j:this.l.j,I:this.l.I,arity:this.s,localName:this.l.localName,namespaceURI:this.l.namespaceURI,i:this.l.i,value:this.l.callFunction});return D.m(e)}v(e){let t=this.A.namespaceURI,n=this.A.localName;const i=this.A.prefix;if(null===t){const r=e.Sa({localName:n,prefix:i},this.s);if(!r)throw Error(`XPST0017: The function ${i?i+":":""}${n} with arity ${this.s} could not be resolved. ${Yi(n)}`);t=r.namespaceURI,n=r.localName}if(this.l=e.va(t,n,this.s)||null,!this.l)throw e=this.A,Error(`XPST0017: Function ${e.namespaceURI?`Q{${e.namespaceURI}}`:e.prefix?`${e.prefix}:`:""}${e.localName} with arity of ${this.s} not registered. ${Yi(n)}`);super.v(e)}};const $s={5:5,27:5,28:5,31:5,32:5,33:5,34:5,30:5,36:5,35:5,38:5,37:5,29:5,4:4,6:6,3:3};var Ns=class extends ti{constructor(e,t,n){super(t.o,[t],{B:!1},!1,n),this.s=t,this.l=e}h(e,t){return it(ei(this.s,e,t),t).N((e=>{if(0===e.length)return D.empty();var t=e[0];if(this.type)return e="+"===this.l?+t.value:-t.value,0===t.type&&(e=Number.NaN),D.m(O(e,this.type.type));if(1<e.length)throw Error("XPTY0004: The operand to a unary operator must be a sequence with a length less than one");return A(t.type,19)?(t=xt(t,3).value,D.m(O("+"===this.l?t:-t,3))):A(t.type,2)?"+"===this.l?D.m(t):D.m(O(-1*t.value,$s[t.type])):D.m(O(Number.NaN,3))}))}},Is=class extends ti{constructor(e,t){super(e.reduce(((e,t)=>e.add(t.o)),new Oi({})),e,{B:e.every((e=>e.B))},!1,t),this.l=e,this.s=e.reduce(((e,t)=>rs(e,t.D())),null)}h(e,t){let n=0,i=null,r=!1,s=null;if(null!==e){const t=e.M;null!==t&&A(t.type,53)&&(s=V(t.value))}return D.create({next:()=>{if(!r){for(;n<this.l.length;){if(!i){const o=this.l[n];if(null!==s&&null!==o.D()&&!s.includes(o.D()))return n++,r=!0,S(v);i=ei(o,e,t)}if(!1===i.fa())return r=!0,S(v);i=null,n++}return r=!0,S(y)}return x}})}D(){return this.s}},Qs=class extends ti{constructor(e,t){let n;for(super(e.reduce(((e,t)=>0<gi(e,t.o)?e:t.o),new Oi({})),e,{B:e.every((e=>e.B))},!1,t),t=0;t<e.length&&(void 0===n&&(n=e[t].D()),null!==n);++t)if(n!==e[t].D()){n=null;break}this.s=n,this.l=e}h(e,t){let n=0,i=null,r=!1,s=null;if(null!==e){const t=e.M;null!==t&&A(t.type,53)&&(s=V(t.value))}return D.create({next:()=>{if(!r){for(;n<this.l.length;){if(!i){const r=this.l[n];if(null!==s&&null!==r.D()&&!s.includes(r.D())){n++;continue}i=ei(r,e,t)}if(!0===i.fa())return r=!0,S(y);i=null,n++}return r=!0,S(v)}return x}})}D(){return this.s}};function Rs(e,t){let n;return D.create({next:i=>{for(;;){if(!n){var r=e.value.next(i);if(r.done)return x;n=nt(r.value,t)}if(!(r=n.value.next(i)).done)return r;n=null}}})}function Ms(e,t,n){function i(e,t){return{U:o?o(e):e,V:a?a(t):t}}function r(e){return A(t,e)&&A(n,e)}function s(e){return 0<e.filter((e=>A(t,e))).length&&0<e.filter((e=>A(n,e))).length}let o=null,a=null;if(A(t,19)&&A(n,19)?t=n=1:A(t,19)?(o=e=>xt(e,n),t=n):A(n,19)&&(a=e=>xt(e,t),n=t),A(t,23)&&A(n,23))return function(e,t){if("eqOp"===e)return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value.namespaceURI===r.value.namespaceURI&&i.value.localName===r.value.localName};if("neOp"===e)return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value.namespaceURI!==r.value.namespaceURI||i.value.localName!==r.value.localName};throw Error('XPTY0004: Only the "eq" and "ne" comparison is defined for xs:QName')}(e,i);if(r(0)||s([1,47,61])||s([2,47,61])||r(20)||r(22)||r(21)||s([1,20])){var l=function(e,t){switch(e){case"eqOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value===r.value};case"neOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value!==r.value};case"ltOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value<r.value};case"leOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value<=r.value};case"gtOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value>r.value};case"geOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value>=r.value}}}(e,i);if(void 0!==l)return l}if(r(16)&&(l=function(e,t){switch(e){case"ltOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value.ea<r.value.ea};case"leOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return fe(i.value,r.value)||i.value.ea<r.value.ea};case"gtOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value.ea>r.value.ea};case"geOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return fe(i.value,r.value)||i.value.ea>r.value.ea}}}(e,i),void 0!==l)||r(17)&&(l=function(e,t){switch(e){case"eqOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return fe(i.value,r.value)};case"ltOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value.ca<r.value.ca};case"leOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return fe(i.value,r.value)||i.value.ca<r.value.ca};case"gtOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return i.value.ca>r.value.ca};case"geOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return fe(i.value,r.value)||i.value.ca>r.value.ca}}}(e,i),void 0!==l)||r(18)&&(l=function(e,t){switch(e){case"eqOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return fe(i.value,r.value)};case"neOp":return(e,n)=>{const{U:i,V:r}=t(e,n);return!fe(i.value,r.value)}}}(e,i),void 0!==l))return l;if((r(9)||r(7)||r(8))&&(l=function(e,t){switch(e){case"eqOp":return(e,n,i)=>{const{U:r,V:s}=t(e,n);return Ne(r.value,s.value,Ze(i))};case"neOp":return(e,n,i)=>{const{U:r,V:s}=t(e,n);return!Ne(r.value,s.value,Ze(i))};case"ltOp":return(e,n,i)=>{const{U:r,V:s}=t(e,n);return e=Ze(i),0>$e(r.value,s.value,e)};case"leOp":return(e,n,i)=>{const{U:r,V:s}=t(e,n);return(e=Ne(r.value,s.value,Ze(i)))||(i=Ze(i),e=0>$e(r.value,s.value,i)),e};case"gtOp":return(e,n,i)=>{const{U:r,V:s}=t(e,n);return e=Ze(i),0<$e(r.value,s.value,e)};case"geOp":return(e,n,i)=>{const{U:r,V:s}=t(e,n);return(e=Ne(r.value,s.value,Ze(i)))||(i=Ze(i),e=0<$e(r.value,s.value,i)),e}}}(e,i),void 0!==l))return l;if((r(11)||r(12)||r(13)||r(14)||r(15))&&(l=function(e,t){switch(e){case"eqOp":return(e,n,i)=>{const{U:r,V:s}=t(e,n);return Ne(r.value,s.value,Ze(i))};case"neOp":return(e,n,i)=>{const{U:r,V:s}=t(e,n);return!Ne(r.value,s.value,Ze(i))}}}(e,i),void 0!==l))return l;throw Error(`XPTY0004: ${e} not available for ${E[t]} and ${E[n]}`)}const Bs=Object.create(null);function Ds(e,t,n){const i=`${t}~${n}~${e}`;let r=Bs[i];return r||=Bs[i]=Ms(e,t,n),r}var Xs=class extends ti{constructor(e,t,n){super(t.o.add(n.o),[t,n],{B:!1}),this.l=t,this.A=n,this.s=e}h(e,t){const n=ei(this.l,e,t),i=ei(this.A,e,t),r=Rs(n,t),s=Rs(i,t);return r.X({empty:()=>D.empty(),m:()=>s.X({empty:()=>D.empty(),m:()=>{const t=r.first(),n=s.first();return Ds(this.s,t.type,n.type)(t,n,e)?D.aa():D.T()},multiple:()=>{throw Error("XPTY0004: Sequences to compare are not singleton.")}}),multiple:()=>{throw Error("XPTY0004: Sequences to compare are not singleton.")}})}};const Fs={equalOp:"eqOp",notEqualOp:"neOp",lessThanOrEqualOp:"leOp",lessThanOp:"ltOp",greaterThanOrEqualOp:"geOp",greaterThanOp:"gtOp"};var Ls=class extends ti{constructor(e,t,n){super(t.o.add(n.o),[t,n],{B:!1}),this.l=t,this.A=n,this.s=e}h(e,t){const n=ei(this.l,e,t),i=ei(this.A,e,t);return n.X({empty:()=>D.T(),default:()=>i.X({empty:()=>D.T(),default:()=>{const r=Rs(n,t),s=Rs(i,t);return function(e,t,n,i){return e=Fs[e],n.N((n=>t.filter((t=>{for(let o=0,a=n.length;o<a;++o){let a,l,h=n[o];var r=t.type,s=h.type;(A(r,19)||A(s,19))&&(A(r,2)?a=3:A(s,2)?l=3:A(r,17)?a=17:A(s,17)?l=17:A(r,16)?a=16:A(s,16)?l=16:A(r,19)?l=s:A(s,19)&&(a=r));const[c,u]=[l,a];if(r=c,s=u,r?t=xt(t,r):s&&(h=xt(h,s)),Ds(e,t.type,h.type)(t,h,i))return!0}return!1})).X({default:()=>D.aa(),empty:()=>D.T()})))}(this.s,r,s,e)}})})}};function Us(e,t,n,i){if(!A(n,53)||!A(i,53))throw Error("XPTY0004: Sequences to compare are not nodes");switch(e){case"isOp":return function(e,t){return e!==t||47!==e&&53!==e&&54!==e&&55!==e&&56!==e&&57!==e&&58!==e?()=>!1:(e,t)=>At(e.first().value,t.first().value)}(n,i);case"nodeBeforeOp":return t?(e,n)=>0>Pt(t,e.first(),n.first()):void 0;case"nodeAfterOp":return t?(e,n)=>0<Pt(t,e.first(),n.first()):void 0;default:throw Error("Unexpected operator")}}var Vs=class extends ti{constructor(e,t,n){super(t.o.add(n.o),[t,n],{B:!1}),this.l=t,this.A=n,this.s=e}h(e,t){const n=ei(this.l,e,t),i=ei(this.A,e,t);return n.X({empty:()=>D.empty(),multiple:()=>{throw Error("XPTY0004: Sequences to compare are not singleton")},m:()=>i.X({empty:()=>D.empty(),multiple:()=>{throw Error("XPTY0004: Sequences to compare are not singleton")},m:()=>{const r=n.first(),s=i.first();return Us(this.s,t.h,r.type,s.type)(n,i,e)?D.aa():D.T()}})})}};function zs(e,t,n,i){return n.N((n=>{if(n.some((e=>!A(e.type,53))))throw Error(`XPTY0004: Sequences given to ${e} should only contain nodes.`);return"sorted"===i?D.create(n):"reverse-sorted"===i?D.create(n.reverse()):D.create($t(t,n))}))}var Zs=class extends ti{constructor(e,t,n,i){super(0<gi(t.o,n.o)?t.o:n.o,[t,n],{B:t.B&&n.B},!1,i),this.l=e,this.s=t,this.A=n}h(e,t){const n=zs(this.l,t.h,ei(this.s,e,t),this.s.ia);e=zs(this.l,t.h,ei(this.A,e,t),this.A.ia);const i=n.value,r=e.value;let s=null,o=null,a=!1,l=!1;return D.create({next:()=>{if(a)return x;for(;!l;){if(!s){var e=i.next(0);if(e.done)return a=!0,x;s=e.value}if(!o){if((e=r.next(0)).done){l=!0;break}o=e.value}if(At(s.value,o.value)){if(e=S(s),o=s=null,"intersectOp"===this.l)return e}else if(0>Pt(t.h,s,o)){if(e=S(s),s=null,"exceptOp"===this.l)return e}else o=null}return"exceptOp"===this.l?null!==s?(e=S(s),s=null,e):i.next(0):(a=!0,x)}})}},js=class extends pi{constructor(e,t){super(e.reduce(((e,t)=>e.add(t.o)),new Oi({})),e,{R:"unsorted",B:e.every((e=>e.B))},t)}A(e,t,n){return n.length?He(n.map((t=>t(e)))):D.empty()}},qs=class extends ti{constructor(e,t,n){super(new Oi({}).add(e.o),[e,t],{B:e.B&&t.B},!1,n),this.l=e,this.s=t}h(e,t){const n=Ve(e,ei(this.l,e,t));let i=null,r=null,s=!1;return D.create({next:e=>{for(;!s;){if(!i&&(i=n.next(e),i.done))return s=!0,x;r||=ei(this.s,i.value,t);const o=r.value.next(e);if(!o.done)return o;i=r=null}}})}},Gs=class extends ti{constructor(e,t,n){if(super(e.o,[e],{B:!1}),this.l=$(t.prefix?`${t.prefix}:${t.localName}`:t.localName),46===this.l||45===this.l||44===this.l)throw Error("XPST0080: Casting to xs:anyAtomicType, xs:anySimpleType or xs:NOTATION is not permitted.");if(t.namespaceURI)throw Error("Not implemented: castable as expressions with a namespace URI.");this.A=e,this.s=n}h(e,t){const n=it(ei(this.A,e,t),t);return n.X({empty:()=>this.s?D.aa():D.T(),m:()=>n.map((e=>wt(e,this.l).u?y:v)),multiple:()=>D.T()})}},Ws=class extends ti{constructor(e,t,n){if(super(e.o,[e],{B:!1}),this.l=$(t.prefix?`${t.prefix}:${t.localName}`:t.localName),46===this.l||45===this.l||44===this.l)throw Error("XPST0080: Casting to xs:anyAtomicType, xs:anySimpleType or xs:NOTATION is not permitted.");if(t.namespaceURI)throw Error("Not implemented: casting expressions with a namespace URI.");this.A=e,this.s=n}h(e,t){const n=it(ei(this.A,e,t),t);return n.X({empty:()=>{if(!this.s)throw Error("XPTY0004: Sequence to cast is empty while target type is singleton.");return D.empty()},m:()=>n.map((e=>xt(e,this.l))),multiple:()=>{throw Error("XPTY0004: Sequence to cast is not singleton or empty.")}})}};function Hs(e,t){const n=e.value;let i=null,r=!1;return D.create({next:()=>{for(;!r;){if(!i){var e=n.next(0);if(e.done)return r=!0,S(y);i=t(e.value)}if(e=i.fa(),i=null,!1===e)return r=!0,S(v)}return x}})}var Ys=class extends ti{constructor(e,t,n,i){super(e.o,[e],{B:!1},!1,i),this.A=e,this.s=t,this.l=n}h(e,t){const n=ei(this.A,e,t);return n.X({empty:()=>"?"===this.l||"*"===this.l?D.aa():D.T(),multiple:()=>"+"===this.l||"*"===this.l?Hs(n,(n=>{const i=D.m(n);return n=Ue(e,0,n,i),ei(this.s,n,t)})):D.T(),m:()=>Hs(n,(n=>{const i=D.m(n);return n=Ue(e,0,n,i),ei(this.s,n,t)}))})}};function Js(e,t){return!(null===e||null===t||!A(e.type,53)||!A(t.type,53))&&At(e.value,t.value)}function Ks(e){let t=e.next(0);if(t.done)return D.empty();let n=null,i=null;return D.create({next(r){if(t.done)return x;let s;n||(n=t.value.value);do{if(s=n.next(r),s.done){if(t=e.next(0),t.done)return s;n=t.value.value}}while(s.done||Js(s.value,i));return i=s.value,s}})}function eo(e,t){const n=[];!function(){for(var e=t.next(0);!e.done;){const i=e.value.value;e={current:i.next(0),next:e=>i.next(e)},e.current.done||n.push(e),e=t.next(0)}}();let i=null,r=!1;return D.create({[Symbol.iterator](){return this},next:()=>{let t;r||(r=!0,n.every((e=>A(e.current.value.type,53)))&&n.sort(((t,n)=>Pt(e,t.current.value,n.current.value))));do{if(!n.length)return x;const i=n.shift();if(t=i.current,i.current=i.next(0),!A(t.value.type,53))return t;if(!i.current.done){let t=0,r=n.length-1,s=0;for(;t<=r;){s=Math.floor((t+r)/2);const o=Pt(e,i.current.value,n[s].current.value);if(0===o){t=s;break}0<o?t=s+1:r=s-1}n.splice(t,0,i)}}while(Js(t.value,i));return i=t.value,t}})}var to=class extends ti{constructor(e,t){super(e.reduce(((e,t)=>0<gi(e,t.o)?e:t.o),new Oi({})),e,{B:e.every((e=>e.B))},!1,t),this.l=e}h(e,t){if(this.l.every((e=>"sorted"===e.ia))){let n=0;return eo(t.h,{next:()=>n>=this.l.length?x:S(ei(this.l[n++],e,t))}).map((e=>{if(!A(e.type,53))throw Error("XPTY0004: The sequences to union are not of type node()*");return e}))}return He(this.l.map((n=>ei(n,e,t)))).N((e=>{if(e.some((e=>!A(e.type,53))))throw Error("XPTY0004: The sequences to union are not of type node()*");return e=$t(t.h,e),D.create(e)}))}};function no(e){return e.every((e=>null===e||A(e.type,5)||A(e.type,4)))||null!==e.map((e=>e?rt(e.type):null)).reduce(((e,t)=>null===t||t===e?e:null))?e:e.every((e=>null===e||A(e.type,1)||A(e.type,20)))?e.map((e=>e?xt(e,1):null)):e.every((e=>null===e||A(e.type,4)||A(e.type,6)))?e.map((e=>e?xt(e,6):e)):e.every((e=>null===e||A(e.type,4)||A(e.type,6)||A(e.type,3)))?e.map((e=>e?xt(e,3):e)):null}var io=class extends ks{constructor(e,t){super(new Oi({}),[t,...e.map((e=>e.ba))],{B:!1,W:!1,R:"unsorted",subtree:!1},t),this.A=e}L(e,t,n,i){if(this.A[1])throw Error("More than one order spec is not supported for the order by clause.");const r=[];let s,o,a=!1,l=null;const h=this.A[0];return D.create({next:()=>{if(!a){for(var c=t.next(0);!c.done;)r.push(c.value),c=t.next(0);if(c=r.map((e=>h.ba.h(e,n))).map((e=>it(e,n))),c.find((e=>!e.F()&&!e.oa())))throw Error("XPTY0004: Order by only accepts empty or singleton sequences");if(s=c.map((e=>e.first())),s=s.map((e=>null===e?e:A(19,e.type)?xt(e,1):e)),function(e){return(e=e.find((e=>!!e)))?rt(e.type):null}(s)&&(s=no(s),!s))throw Error("XPTY0004: Could not cast values");c=s.length,o=s.map(((e,t)=>t));for(let t=0;t<c;t++)if(t+1!==c)for(let n=t;0<=n;n--){const t=n,i=n+1;if(i===c)continue;const r=s[o[t]],a=s[o[i]];if(null!==a||null!==r){if(h.bc){if(null===r)continue;if(null===a&&null!==r){[o[t],o[i]]=[o[i],o[t]];continue}if(isNaN(a.value)&&null!==r&&!isNaN(r.value)){[o[t],o[i]]=[o[i],o[t]];continue}}else{if(null===a)continue;if(null===r&&null!==a){[o[t],o[i]]=[o[i],o[t]];continue}if(isNaN(r.value)&&null!==a&&!isNaN(a.value)){[o[t],o[i]]=[o[i],o[t]];continue}}Ds("gtOp",r.type,a.type)(r,a,e)&&([o[t],o[i]]=[o[i],o[t]])}}let u=h.Bb?0:s.length-1;l=i({next:()=>h.Bb?u>=s.length?x:S(r[o[u++]]):0>u?x:S(r[o[u--]])}).value,a=!0}return l.next(0)}})}},ro=class extends ti{constructor(e){super(e?e.o:new Oi({}),e?[e]:[],{R:"sorted",subtree:!1,W:!1,B:!1}),this.l=e}h(e,t){if(null===e.M)throw Je("context is absent, it needs to be present to use paths.");var n=t.h;let i=e.M.value;for(;9!==i.node.nodeType;)if(i=ne(n,i),null===i)throw Error("XPDY0050: the root node of the context node is not a document node.");return n=D.m(he(i)),this.l?ei(this.l,Ue(e,0,n.first(),n),t):n}},so=class extends ti{constructor(e){super(new Oi({}),[],{R:"sorted"},!1,e)}h(e){if(null===e.M)throw Je('context is absent, it needs to be present to use the "." operator');return D.m(e.M)}};var oo=class extends ti{constructor(e,t){const n=e.every((e=>e.W)),i=e.every((e=>e.subtree));super(e.reduce(((e,t)=>e.add(t.o)),new Oi({})),e,{B:!1,W:n,R:t?"sorted":"unsorted",subtree:i}),this.l=e,this.s=t}h(e,t){let n=!0;return this.l.reduce(((i,r,s)=>{const o=null===i?St(e):Ve(e,i);let a;if(i={next:e=>{if((e=o.next(e)).done)return x;if(null!==e.value.M&&!A(e.value.M.type,53)&&0<s)throw Error("XPTY0019: The result of E1 in a path expression E1/E2 should not evaluate to a sequence of nodes.");return S(ei(r,e.value,t))}},this.s)switch(r.ia){case"reverse-sorted":const e=i;i={next:t=>(t=e.next(t)).done?t:S(t.value.N((e=>D.create(e.reverse()))))};case"sorted":if(r.subtree&&n){a=Ks(i);break}a=eo(t.h,i);break;case"unsorted":return Ks(i).N((e=>D.create(function(e,t){let n=!1,i=!1;if(t.forEach((e=>{A(e.type,53)?n=!0:i=!0})),i&&n)throw Error("XPTY0018: The path operator should either return nodes or non-nodes. Mixed sequences are not allowed.");return n?$t(e,t):t}(t.h,e))))}else a=Ks(i);return n=n&&r.W,a}),null)}D(){return this.l[0].D()}},ao=class extends ti{constructor(e,t){super(e.o.add(t.o),[e,t],{B:e.B&&t.B,W:e.W,R:e.ia,subtree:e.subtree}),this.s=e,this.l=t}h(e,t){const n=ei(this.s,e,t);if(this.l.B){const i=ei(this.l,e,t);if(i.F())return i;const r=i.first();if(A(r.type,2)){let e=r.value;if(!Number.isInteger(e))return D.empty();const t=n.value;let i=!1;return D.create({next:()=>{if(!i){for(let n=t.next(0);!n.done;n=t.next(0))if(1==e--)return i=!0,n;i=!0}return x}})}return i.fa()?n:D.empty()}const i=n.value;let r=null,s=0,o=null;return D.create({next:a=>{let l=!1;for(;(!r||!r.done)&&(r||(r=i.next(l?0:a),l=!0),!r.done);){o||=ei(this.l,Ue(e,s,r.value,n),t);var h=o.first();h=null!==h&&(A(h.type,2)?h.value===s+1:o.fa()),o=null;const i=r.value;if(r=null,s++,h)return S(i)}return r}})}D(){return this.s.D()}};function lo(e,t,n){if(n=[n],A(e.type,62))if("*"===t)n.push(...e.h.map((e=>e())));else{if(!A(t.type,5))throw Error("XPTY0004: The key specifier is not an integer.");{const i=t.value;if(e.h.length<i||0>=i)throw Error("FOAY0001: Array index out of bounds");n.push(e.h[i-1]())}}else{if(!A(e.type,61))throw Error("XPTY0004: The provided context item is not a map or an array.");"*"===t?n.push(...e.h.map((e=>e.value()))):(e=e.h.find((e=>ue(e.key,t))))&&n.push(e.value())}return He(n)}function ho(e,t,n,i,r){return"*"===t?lo(e,t,n):(t=X(t=ei(t,i,r))().N((t=>t.reduce(((t,n)=>lo(e,n,t)),new C))),He([n,t]))}var co=class extends ti{constructor(e,t){super(e.o,[e].concat("*"===t?[]:[t]),{B:e.B,R:e.ia,subtree:e.subtree}),this.l=e,this.s=t}h(e,t){return ei(this.l,e,t).N((n=>n.reduce(((n,i)=>ho(i,this.s,n,e,t)),new C)))}D(){return this.l.D()}},uo=class extends ti{constructor(e,t){super(new Oi({external:1}),"*"===e?[]:[e],{B:!1},!1,t),this.l=e}h(e,t){return ho(e.M,this.l,new C,e,t)}},po=class extends ti{constructor(e,t,n,i){const r=t.map((e=>e.fb));t=t.map((e=>e.name)),super(r.reduce(((e,t)=>e.add(t.o)),n.o),r.concat(n),{B:!1},!1,i),this.s=e,this.A=t,this.L=r,this.P=n,this.l=null}h(e,t){let n=e;const i=this.l.map(((i,r)=>{const s=ei(this.L[r],n,t).O();return n=qe(e,{[i]:()=>D.create(s)}),s}));if(i.some((e=>0===e.length)))return"every"===this.s?D.aa():D.T();const r=Array(i.length).fill(0);r[0]=-1;for(var s=!0;s;){s=!1;for(let n=0,a=r.length;n<a;++n){var o=i[n];if(!(++r[n]>o.length-1)){for(s=Object.create(null),o=0;o<r.length;o++){const e=i[o][r[o]];s[this.l[o]]=()=>D.m(e)}if(s=qe(e,s),(s=ei(this.P,s,t)).fa()&&"some"===this.s)return D.aa();if(!s.fa()&&"every"===this.s)return D.T();s=!0;break}r[n]=0}}return"every"===this.s?D.aa():D.T()}v(e){this.l=[];for(let n=0,i=this.A.length;n<i;++n){this.L[n].v(e),fr(e);var t=this.A[n];const i=t.prefix?e.$(t.prefix):null;t=Or(e,i,t.localName),this.l[n]=t}this.P.v(e);for(let t=0,n=this.A.length;t<n;++t)vr(e)}},fo=class extends ti{constructor(e){super(e,[],{B:!1})}h(e){return this.l(e.M)?D.aa():D.T()}},mo=class extends fo{constructor(e){super(new Oi({nodeType:1})),this.s=e}l(e){return!!A(e.type,53)&&(e=e.value.node.nodeType,3===this.s&&4===e||this.s===e)}D(){return`type-${this.s}`}},go=class extends fo{constructor(e,t={kind:null}){const n=e.prefix,i=e.namespaceURI,r={};"*"!==(e=e.localName)&&(r.nodeName=1),r.nodeType=1,super(new Oi(r)),this.s=e,this.L=i,this.A=n,this.P=t.kind}l(e){const t=A(e.type,54),n=A(e.type,47);return!(!t&&!n)&&(e=e.value,!(null!==this.P&&(1===this.P&&!t||2===this.P&&!n))&&(null===this.A&&""!==this.L&&"*"===this.s||("*"===this.A?"*"===this.s||this.s===e.node.localName:("*"===this.s||this.s===e.node.localName)&&(e.node.namespaceURI||null)===((""===this.A?t?this.L:null:this.L)||null))))}D(){return"*"===this.s?null===this.P?"type-1-or-type-2":`type-${this.P}`:`name-${this.s}`}v(e){if(null===this.L&&"*"!==this.A&&(this.L=e.$(this.A||"")||null,!this.L&&this.A))throw Error(`XPST0081: The prefix ${this.A} could not be resolved.`)}},Oo=class extends fo{constructor(e){super(new Oi({nodeName:1})),this.s=e}l(e){return A(e.type,57)&&e.value.node.target===this.s}D(){return"type-7"}},yo=class extends fo{constructor(e){super(new Oi({})),this.s=e}l(e){return A(e.type,$(this.s.prefix?this.s.prefix+":"+this.s.localName:this.s.localName))}},vo=class extends ti{constructor(e,t,n){super(new Oi({}),[],{B:!1,R:"unsorted"}),this.A=n,this.s=t,this.L=e,this.l=null}h(e,t){if(!e.ra[this.l]){if(this.P)return this.P(e,t);throw Error("XQDY0054: The variable "+this.A+" is declared but not in scope.")}return e.ra[this.l]()}v(e){if(null===this.s&&this.L&&(this.s=e.$(this.L)),this.l=e.eb(this.s||"",this.A),!this.l)throw Error("XPST0008, The variable "+this.A+" is not in scope.");(e=e.Ea[this.l])&&(this.P=e)}},bo=class extends ks{constructor(e,t){super(new Oi({}),[e,t],{B:!1,W:!1,R:"unsorted",subtree:!1},t),this.A=e}L(e,t,n,i){let r=null,s=null;return i({next:()=>{for(;;){if(!s){var e=t.next(0);if(e.done)return x;r=e.value,s=ei(this.A,r,n)}e=s.fa();const i=r;if(s=r=null,e)return S(i)}}})}},wo=class{constructor(e){this.type=e}},xo=class extends wo{constructor(e){super("delete"),this.target=e}h(e){return{type:this.type,target:Li(this.target,e,!1)}}},So=class extends wo{constructor(e,t,n){super(n),this.target=e,this.content=t}h(e){return{type:this.type,target:Li(this.target,e,!1),content:this.content.map((t=>Li(t,e,!0)))}}},ko=class extends So{constructor(e,t){super(e,t,"insertAfter")}},Ao=class extends wo{constructor(e,t){super("insertAttributes"),this.target=e,this.content=t}h(e){return{type:this.type,target:Li(this.target,e,!1),content:this.content.map((t=>Li(t,e,!0)))}}},Co=class extends So{constructor(e,t){super(e,t,"insertBefore")}},_o=class extends So{constructor(e,t){super(e,t,"insertIntoAsFirst")}},Eo=class extends So{constructor(e,t){super(e,t,"insertIntoAsLast")}},To=class extends So{constructor(e,t){super(e,t,"insertInto")}},Po=class extends wo{constructor(e,t){super("rename"),this.target=e,this.o=t.za?t:new F(t.prefix,t.namespaceURI,t.localName)}h(e){return{type:this.type,target:Li(this.target,e,!1),newName:{prefix:this.o.prefix,namespaceURI:this.o.namespaceURI,localName:this.o.localName}}}},$o=class extends wo{constructor(e,t){super("replaceElementContent"),this.target=e,this.text=t}h(e){return{type:this.type,target:Li(this.target,e,!1),text:this.text?Li(this.text,e,!0):null}}},No=class extends wo{constructor(e,t){super("replaceNode"),this.target=e,this.o=t}h(e){return{type:this.type,target:Li(this.target,e,!1),replacement:this.o.map((t=>Li(t,e,!0)))}}},Io=class extends wo{constructor(e,t){super("replaceValue"),this.target=e,this.o=t}h(e){return{type:this.type,target:Li(this.target,e,!1),"string-value":this.o}}},Qo=(e,t)=>new No(e,t),Ro=class extends ui{constructor(e){super(new Oi({}),[e],{B:!1,R:"unsorted"}),this.l=e}s(e,t){const n=ci(this.l)(e,t),i=t.h;let r,s;return{next:()=>{if(!r){const e=n.next(0);if(e.value.J.some((e=>!A(e.type,53))))throw Error("XUTY0007: The target of a delete expression must be a sequence of zero or more nodes.");r=e.value.J,s=e.value.da}return r=r.filter((e=>ne(i,e.value))),S({da:hi(r.map((e=>new xo(e.value))),s),J:[]})}}}};function Mo(e,t,n,i,r,s){const o=t.h;return e.reduce((function e(t,n){return A(n.type,62)?(n.h.forEach((n=>n().O().forEach((n=>e(t,n))))),t):(t.push(n),t)}),[]).forEach(((e,a,l)=>{if(A(e.type,47)){if(r)throw s(e.value,o);n.push(e.value.node)}else if(A(e.type,46)||A(e.type,53)&&3===e.value.node.nodeType){const n=A(e.type,46)?xt(nt(e,t).first(),1).value:K(o,e.value);0!==a&&A(l[a-1].type,46)&&A(e.type,46)?(i.push({data:" "+n,Ra:!0,nodeType:3}),r=!0):n&&(i.push({data:""+n,Ra:!0,nodeType:3}),r=!0)}else if(A(e.type,55)){const a=[];J(o,e.value).forEach((e=>a.push(he(e)))),r=Mo(a,t,n,i,r,s)}else{if(!A(e.type,53)){if(A(e.type,60))throw et(e.type);throw Error(`Atomizing ${e.type} is not implemented.`)}i.push(e.value.node),r=!0}})),r}function Bo(e,t,n){const i=[],r=[];let s=!1;return e.forEach((e=>{s=Mo(e,t,i,r,s,n)})),{attributes:i,Xa:r}}function Do(e,t,n,i,r){const s=[];switch(e){case 4:i.length&&s.push(new Ao(t,i)),r.length&&s.push(new _o(t,r));break;case 5:i.length&&s.push(new Ao(t,i)),r.length&&s.push(new Eo(t,r));break;case 3:i.length&&s.push(new Ao(t,i)),r.length&&s.push(new To(t,r));break;case 2:i.length&&s.push(new Ao(n,i)),r.length&&s.push(new Co(t,r));break;case 1:i.length&&s.push(new Ao(n,i)),r.length&&s.push(new ko(t,r))}return s}var Xo=class extends ui{constructor(e,t,n){super(new Oi({}),[e,n],{B:!1,R:"unsorted"}),this.L=e,this.l=t,this.A=n}s(e,t){const n=ci(this.L)(e,t),i=ci(this.A)(e,t),r=t.h;let s,o,a,l,h,c;return{next:()=>{if(!s){var e=n.next(0);const i=Bo([e.value.J],t,zn);s=i.attributes.map((e=>({node:e,G:null}))),o=i.Xa.map((e=>({node:e,G:null}))),a=e.value.da}if(!l){if(0===(e=i.next(0)).value.J.length)throw Kn();if(3<=this.l){if(1!==e.value.J.length)throw Zn();if(!A(e.value.J[0].type,54)&&!A(e.value.J[0].type,55))throw Zn()}else{if(1!==e.value.J.length)throw jn();if(!(A(e.value.J[0].type,54)||A(e.value.J[0].type,56)||A(e.value.J[0].type,58)||A(e.value.J[0].type,57)))throw jn();if(c=ne(r,e.value.J[0].value,null),null===c)throw Error(`XUDY0029: The target ${e.value.J[0].value.outerHTML} for inserting a node before or after must have a parent.`)}l=e.value.J[0],h=e.value.da}if(s.length){if(3<=this.l){if(!A(l.type,54))throw Error("XUTY0022: An insert expression specifies the insertion of an attribute node into a document node.")}else if(1!==c.node.nodeType)throw Error("XUDY0030: An insert expression specifies the insertion of an attribute node before or after a child of a document node.");s.reduce(((e,t)=>{const n=t.node.prefix||"";var i=t.node.prefix||"";const r=t.node.namespaceURI,s=i?l.value.node.lookupNamespaceURI(i):null;if(s&&s!==r)throw Yn(r);if((i=e[i])&&r!==i)throw Jn(r);return e[n]=t.node.namespaceURI,e}),{})}return S({J:[],da:hi(Do(this.l,l.value,c||null,s,o),a,h)})}}}};const Fo=()=>Ke("Casting not supported from given type to a single xs:string or xs:untypedAtomic or any of its derived types."),Lo=/([A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])/,Uo=new RegExp(`${Lo.source}${new RegExp(`(${Lo.source}|[-.0-9-])`).source}*`,"g"),Vo=e=>!!(e=e.match(Uo))&&1===e.length;function zo(e,t){return it(t,e).X({m:e=>{if(A((e=e.first()).type,1)||A(e.type,19)){if(!Vo(e.value))throw Error(`XQDY0041: The value "${e.value}" of a name expressions cannot be converted to a NCName.`);return D.m(e)}throw Fo()},default:()=>{throw Fo()}}).value}function Zo(e,t,n){return it(n,t).X({m:t=>{if(A((t=t.first()).type,23))return D.m(t);if(A(t.type,1)||A(t.type,19)){let n,i;if(1===(t=t.value.split(":")).length?t=t[0]:(n=t[0],i=e.$(n),t=t[1]),!Vo(t)||n&&!Vo(n))throw hr(n?`${n}:${t}`:t);if(n&&!i)throw hr(`${n}:${t}`);return D.m({type:23,value:new F(n,i,t)})}throw Fo()},default:()=>{throw Fo()}}).value}var jo=class extends ui{constructor(e,t){super(new Oi({}),[e,t],{B:!1,R:"unsorted"}),this.A=e,this.L=t,this.l=void 0}s(e,t){const n=ci(this.A)(e,t),i=ci(this.L)(e,t);return{next:()=>{const e=n.next(0);var r=e.value.J;if(0===r.length)throw Kn();if(1!==r.length)throw Gn();if(!A(r[0].type,54)&&!A(r[0].type,47)&&!A(r[0].type,57))throw Gn();r=r[0];const s=i.next(0);e:{var o=this.l,a=D.create(s.value.J);switch(r.type){case 54:if(o=Zo(o,t,a).next(0).value.value,(a=r.value.node.lookupNamespaceURI(o.prefix))&&a!==o.namespaceURI)throw Yn(o.namespaceURI);break e;case 47:if((o=Zo(o,t,a).next(0).value.value).namespaceURI&&(a=r.value.node.lookupNamespaceURI(o.prefix))&&a!==o.namespaceURI)throw Yn(o.namespaceURI);break e;case 57:o=zo(t,a).next(0).value.value,o=new F("",null,o);break e}o=void 0}return S({J:[],da:hi([new Po(r.value,o)],e.value.da,s.value.da)})}}}v(e){this.l=pr(e),super.v(e)}};var qo=class extends ui{constructor(e,t,n){super(new Oi({}),[t,n],{B:!1,R:"unsorted"}),this.L=e,this.l=t,this.A=n}s(e,t){const n=ci(this.l)(e,t);return e=ci(this.A)(e,t),this.L?function(e,t,n){let i,r,s,o,a=!1;return{next:()=>{if(a)return x;if(!s){var l=n.next(0);const t=it(D.create(l.value.J),e).map((e=>xt(e,1))).O().map((e=>e.value)).join(" ");s=0===t.length?null:{node:e.Ja.createTextNode(t),G:null},o=l.value.da}if(!i){if(0===(l=t.next(0)).value.J.length)throw Kn();if(1!==l.value.J.length)throw qn();if(!(A(l.value.J[0].type,54)||A(l.value.J[0].type,47)||A(l.value.J[0].type,56)||A(l.value.J[0].type,58)||A(l.value.J[0].type,57)))throw qn();i=l.value.J[0],r=l.value.da}if(A(i.type,54))return a=!0,S({J:[],da:hi([new $o(i.value,s)],o,r)});if(A(i.type,47)||A(i.type,56)||A(i.type,58)||A(i.type,57)){if(l=s?K(e.h,s):"",A(i.type,58)&&(l.includes("--")||l.endsWith("-")))throw Error(`XQDY0072: The content "${l}" for a comment node contains two adjacent hyphens or ends with a hyphen.`);if(A(i.type,57)&&l.includes("?>"))throw Error(`XQDY0026: The content "${l}" for a processing instruction node contains "?>".`);return a=!0,S({J:[],da:hi([new Io(i.value,l)],o,r)})}}}}(t,n,e):function(e,t,n){let i,r,s;return{next:()=>{if(!i){var o=n.next(0),a=Bo([o.value.J],e,Jn);i={attributes:a.attributes.map((e=>({node:e,G:null}))),Xa:a.Xa.map((e=>({node:e,G:null})))},r=o.value.da}if(0===(a=t.next(0)).value.J.length)throw Kn();if(1!==a.value.J.length)throw qn();if(!(A(a.value.J[0].type,54)||A(a.value.J[0].type,47)||A(a.value.J[0].type,56)||A(a.value.J[0].type,58)||A(a.value.J[0].type,57)))throw qn();if(s=ne(e.h,a.value.J[0].value,null),null===s)throw Error(`XUDY0009: The target ${a.value.J[0].value.outerHTML} for replacing a node must have a parent.`);if(o=a.value.J[0],a=a.value.da,A(o.type,47)){if(i.Xa.length)throw Error("XUTY0011: When replacing an attribute the new value must be zero or more attribute nodes.");i.attributes.reduce(((e,t)=>{const n=t.node.prefix||"";t=t.node.namespaceURI;var i=s.node.lookupNamespaceURI(n);if(i&&i!==t)throw Yn(t);if((i=e[n])&&t!==i)throw Jn(t);return e[n]=t,e}),{})}else if(i.attributes.length)throw Error("XUTY0010: When replacing an an element, text, comment, or processing instruction node the new value must be a single node.");return S({J:[],da:hi([Qo(o.value,[].concat(i.attributes,i.Xa))],r,a)})}}}(t,n,e)}};function Go(e){switch(e.type){case"delete":return new xo({node:e.target,G:null});case"insertAfter":return new ko({node:e.target,G:null},e.content.map((e=>({node:e,G:null}))));case"insertBefore":return new Co({node:e.target,G:null},e.content.map((e=>({node:e,G:null}))));case"insertInto":return new To({node:e.target,G:null},e.content.map((e=>({node:e,G:null}))));case"insertIntoAsFirst":return new _o({node:e.target,G:null},e.content.map((e=>({node:e,G:null}))));case"insertIntoAsLast":return new Eo({node:e.target,G:null},e.content.map((e=>({node:e,G:null}))));case"insertAttributes":return new Ao({node:e.target,G:null},e.content.map((e=>({node:e,G:null}))));case"rename":return new Po({node:e.target,G:null},e.newName);case"replaceNode":return new No({node:e.target,G:null},e.replacement.map((e=>({node:e,G:null}))));case"replaceValue":return new Io({node:e.target,G:null},e["string-value"]);case"replaceElementContent":return new $o({node:e.target,G:null},e.text?{node:e.text,G:null}:null);default:throw Error(`Unexpected type "${e.type}" when parsing a transferable pending update.`)}}function Wo(e,t,n){if(t.find((t=>At(t,e))))return!0;const i=ne(n,e);return!!i&&Wo(i,t,n)}var Ho=class extends ui{constructor(e,t,n){super(new Oi({}),e.reduce(((e,t)=>(e.push(t.fb),e)),[t,n]),{B:!1,R:"unsorted"}),this.l=e,this.L=t,this.A=n,this.I=null}h(e,t){return di(e=this.s(e,t),(()=>{}))}s(e,t){const n=t.h,i=t.Ja,r=t.Ma,s=[];let o,a,l;const h=[],c=[];return{next:()=>{if(h.length!==this.l.length)for(var u=h.length;u<this.l.length;u++){const n=this.l[u];var d=s[u];if(d||(s[u]=d=ci(n.fb)(e,t)),1!==(d=d.next(0)).value.J.length||!A(d.value.J[0].type,53))throw Error("XUTY0013: The source expression of a copy modify expression must return a single node.");const i=he(Xi(d.value.J[0].value,t));h.push(i.value),c.push(d.value.da),e=qe(e,{[n.fc]:()=>D.m(i)})}return l||(o||=ci(this.L)(e,t),l=o.next(0).value.da),l.forEach((e=>{if(e.target&&!Wo(e.target,h,n))throw Error(`XUDY0014: The target ${e.target.node.outerHTML} must be a node created by the copy clause.`);if("put"===e.type)throw Error("XUDY0037: The modify expression of a copy modify expression can not contain a fn:put.")})),u=l.map((e=>Go(e=e.h(t)))),ai(u,n,i,r),a||=ci(this.A)(e,t),S({J:(u=a.next(0)).value.J,da:hi(u.value.da,...c)})}}}v(e){fr(e),this.l.forEach((t=>t.fc=Or(e,t.Jb.namespaceURI,t.Jb.localName))),super.v(e),vr(e),this.I=this.l.some((e=>e.fb.I))||this.A.I}};function Yo(e,t){return{node:{nodeType:2,Ra:!0,nodeName:e.za(),namespaceURI:e.namespaceURI,prefix:e.prefix,localName:e.localName,name:e.za(),value:t},G:null}}var Jo=class extends ti{constructor(e,t){let n=t.nb||[];n=n.concat(e.Na||[]),super(new Oi({}),n,{B:!1,R:"unsorted"}),e.Na?this.s=e.Na:this.name=new F(e.prefix,e.namespaceURI,e.localName),this.l=t,this.A=void 0}h(e,t){let n,i,r,s=!1;return D.create({next:()=>{if(s)return x;if(!i){if(this.s){if(!n){var o=this.s.h(e,t);n=Zo(this.A,t,o)}i=n.next(0).value.value}else i=this.name;if(i){if("xmlns"===i.prefix)throw ir(i);if(""===i.prefix&&"xmlns"===i.localName)throw ir(i);if("http://www.w3.org/2000/xmlns/"===i.namespaceURI)throw ir(i);if("xml"===i.prefix&&"http://www.w3.org/XML/1998/namespace"!==i.namespaceURI)throw ir(i);if(""!==i.prefix&&"xml"!==i.prefix&&"http://www.w3.org/XML/1998/namespace"===i.namespaceURI)throw ir(i)}}return this.l.nb?(o=this.l.nb,r||(r=He(o.map((n=>it(n.h(e,t),t).N((e=>D.m(O(e.map((e=>e.value)).join(" "),1))))))).N((e=>D.m(he(Yo(i,e.map((e=>e.value)).join("")))))).value),r.next(0)):(s=!0,S(he(Yo(i,this.l.value))))}})}v(e){if(this.A=pr(e),this.name&&this.name.prefix&&!this.name.namespaceURI){const t=e.$(this.name.prefix);if(void 0===t&&this.name.prefix)throw tt(this.name.prefix);this.name.namespaceURI=t||null}super.v(e)}},Ko=class extends ti{constructor(e){super(e?e.o:new Oi({}),e?[e]:[],{B:!1,R:"unsorted"}),this.l=e}h(e,t){const n={data:"",Ra:!0,nodeType:8},i={node:n,G:null};return this.l?it(e=ei(this.l,e,t),t).N((e=>{if(e=e.map((e=>xt(e,1).value)).join(" "),-1!==e.indexOf("--\x3e"))throw Error('XQDY0072: The contents of the data of a comment may not include "--\x3e"');return n.data=e,D.m(he(i))})):D.m(he(i))}},ea=class extends ti{constructor(e,t,n,i){super(new Oi({}),i.concat(t).concat(e.Na||[]),{B:!1,R:"unsorted"}),e.Na?this.s=e.Na:this.l=new F(e.prefix,e.namespaceURI,e.localName),this.P=n.reduce(((e,t)=>{if(t.prefix in e)throw Error(`XQST0071: The namespace declaration with the prefix ${t.prefix} has already been declared on the constructed element.`);return e[t.prefix||""]=t.uri,e}),{}),this.L=t,this.ma=i,this.A=void 0}h(e,t){let n,i,r,s,o,a=!1,l=!1,h=!1;return D.create({next:()=>{if(h)return x;if(a||(n||=He(this.L.map((n=>ei(n,e,t)))),i=n.O(),a=!0),!l){r||=this.ma.map((n=>ei(n,e,t)));for(var c=[],u=0;u<r.length;u++){var d=r[u].O();c.push(d)}s=c,l=!0}if(this.s&&(o||(c=this.s.h(e,t),o=Zo(this.A,t,c)),this.l=o.next(0).value.value),"xmlns"===this.l.prefix||"http://www.w3.org/2000/xmlns/"===this.l.namespaceURI||"xml"===this.l.prefix&&"http://www.w3.org/XML/1998/namespace"!==this.l.namespaceURI||this.l.prefix&&"xml"!==this.l.prefix&&"http://www.w3.org/XML/1998/namespace"===this.l.namespaceURI)throw Error(`XQDY0096: The node name "${this.l.za()}" is invalid for a computed element constructor.`);const p={nodeType:1,Ra:!0,attributes:[],childNodes:[],nodeName:this.l.za(),namespaceURI:this.l.namespaceURI,prefix:this.l.prefix,localName:this.l.localName};for(c={node:p,G:null},i.forEach((e=>{p.attributes.push(e.value.node)})),(u=Bo(s,t,nr)).attributes.forEach((e=>{if(p.attributes.find((t=>t.namespaceURI===e.namespaceURI&&t.localName===e.localName)))throw Error(`XQDY0025: The attribute ${e.name} does not have an unique name in the constructed element.`);p.attributes.push(e)})),u.Xa.forEach((e=>{p.childNodes.push(e)})),u=0;u<p.childNodes.length;u++){if(!G(d=p.childNodes[u])||3!==d.nodeType)continue;const e=p.childNodes[u-1];e&&G(e)&&3===e.nodeType&&(e.data+=d.data,p.childNodes.splice(u,1),u--)}return h=!0,S(he(c))}})}v(e){if(fr(e),Object.keys(this.P).forEach((t=>gr(e,t,this.P[t]))),this.Fa.forEach((t=>t.v(e))),this.L.reduce(((t,n)=>{if(n.name){if(n=`Q{${null===n.name.namespaceURI?e.$(n.name.prefix):n.name.namespaceURI}}${n.name.localName}`,t.includes(n))throw Error(`XQST0040: The attribute ${n} does not have an unique name in the constructed element.`);t.push(n)}return t}),[]),this.l&&null===this.l.namespaceURI){const t=e.$(this.l.prefix);if(void 0===t&&this.l.prefix)throw tt(this.l.prefix);this.l.namespaceURI=t}this.A=pr(e),vr(e)}};function ta(e){if(/^xml$/i.test(e))throw Error(`XQDY0064: The target of a created PI may not be "${e}"`)}function na(e,t){return{node:{data:t,Ra:!0,nodeName:e,nodeType:7,target:e},G:null}}var ia=class extends ti{constructor(e,t){const n=e.xb?[e.xb].concat(t):[t];super(n.reduce(((e,t)=>e.add(t.o)),new Oi({})),n,{B:!1,R:"unsorted"}),this.l=e,this.s=t}h(e,t){return it(ei(this.s,e,t),t).N((n=>{const i=n.map((e=>xt(e,1).value)).join(" ");if(-1!==i.indexOf("?>"))throw Error('XQDY0026: The contents of the data of a processing instruction may not include "?>"');if(null!==this.l.Fb)return ta(n=this.l.Fb),D.m(he(na(n,i)));n=ei(this.l.xb,e,t);const r=zo(t,n);return D.create({next:()=>{var e=r.next(0);return e.done?e:(ta(e=e.value.value),S(he(na(e,i))))}})}))}},ra=class extends ti{constructor(e){super(e?e.o:new Oi({}),e?[e]:[],{B:!1,R:"unsorted"}),this.l=e}h(e,t){return this.l?it(e=ei(this.l,e,t),t).N((e=>0===e.length?D.empty():(e={node:{data:e.map((e=>xt(e,1).value)).join(" "),Ra:!0,nodeType:3},G:null},D.m(he(e))))):D.empty()}},sa=class extends pi{constructor(e,t,n,i){super(new Oi({}),[e,...t.map((e=>e.pb)),n].concat(...t.map((e=>e.Ib.map((e=>e.Hb))))),{B:!1,W:!1,R:"unsorted",subtree:!1},i),this.L=e,this.l=t.length,this.P=t.map((e=>e.Ib))}A(e,t,n){return n[0](e).N((i=>{for(let r=0;r<this.l;r++)if(this.P[r].some((n=>{switch(n.dc){case"?":if(1<i.length)return!1;break;case"*":break;case"+":if(1>i.length)return!1;break;default:if(1!==i.length)return!1}const r=D.create(i);return i.every(((i,s)=>(i=Ue(e,s,i,r),ei(n.Hb,i,t).fa())))})))return n[r+1](e);return n[this.l+1](e)}))}v(e){if(super.v(e),this.L.I)throw Vn()}},oa=class extends pi{constructor(e,t,n,i){super(new Oi({}),[e,n,...t.map((e=>e.pb))].concat(...t.map((e=>e.Gb.map((e=>e))))),{B:!1,W:!1,R:"unsorted",subtree:!1},i),this.L=e,this.l=t.length,this.P=t.map((e=>e.Gb))}A(e,t,n){const i=Rs(n[0](e),t),[,r,...s]=n;return i.X({multiple:()=>{throw Error("XPTY0004: The operand for a switch expression should result in zero or one item")},default:()=>{const n=i.first(),o=!n;for(let i=0;i<this.l;i++){var a=this.P[i].map((n=>ei(n,e,t)));for(const r of a)if(a=Rs(r,t),a.F()){if(o)return s[i](e)}else{if(!a.oa())throw Error("XPTY0004: The operand for a switch case should result in zero or one item");if(!o&&(a=a.first(),Ln(e,t,null,n,a).next(0).value))return s[i](e)}}return r(e)}})}v(e){if(super.v(e),this.L.I)throw Vn()}},aa={Z:!1,sa:!1},la={Z:!0,sa:!1},ha={Z:!0,sa:!0};function ca(e){return e.Z?e.sa?ha:la:aa}function ua(e,t){switch(e[0]){case"andOp":var n=Sr(e,"type");return new Is(pa("andOp",e,ca(t)),n);case"orOp":return n=Sr(e,"type"),new Qs(pa("orOp",e,ca(t)),n);case"unaryPlusOp":return n=wr(wr(e,"operand"),"*"),e=Sr(e,"type"),new Ns("+",ua(n,t),e);case"unaryMinusOp":return n=wr(wr(e,"operand"),"*"),e=Sr(e,"type"),new Ns("-",ua(n,t),e);case"addOp":case"subtractOp":case"multiplyOp":case"divOp":case"idivOp":case"modOp":var i=e[0],r=ua(kr(e,["firstOperand","*"]),ca(t));t=ua(kr(e,["secondOperand","*"]),ca(t));const s=Sr(e,"type"),o=Sr(kr(e,["firstOperand","*"]),"type"),a=Sr(kr(e,["secondOperand","*"]),"type");return o&&a&&Sr(e,"type")&&(n=Qr(i,o.type,a.type)),new Br(i,r,t,s,n);case"sequenceExpr":return function(e,t){var n=Ar(e,"*").map((e=>ua(e,t)));return 1===n.length?n[0]:(n=Sr(e,"type"),new js(Ar(e,"*").map((e=>ua(e,t))),n))}(e,t);case"unionOp":return n=Sr(e,"type"),new to([ua(kr(e,["firstOperand","*"]),ca(t)),ua(kr(e,["secondOperand","*"]),ca(t))],n);case"exceptOp":case"intersectOp":return n=Sr(e,"type"),new Zs(e[0],ua(kr(e,["firstOperand","*"]),ca(t)),ua(kr(e,["secondOperand","*"]),ca(t)),n);case"stringConcatenateOp":return function(e,t){const n=Sr(e,"type");return e=[kr(e,["firstOperand","*"]),kr(e,["secondOperand","*"])],new xi(new Ps({localName:"concat",namespaceURI:"http://www.w3.org/2005/xpath-functions",prefix:""},e.length,n),e.map((e=>ua(e,ca(t)))),n)}(e,t);case"rangeSequenceExpr":return function(e,t){const n=Sr(e,"type");e=[wr(wr(e,"startExpr"),"*"),wr(wr(e,"endExpr"),"*")];const i=new Ps({localName:"to",namespaceURI:"http://fontoxpath/operators",prefix:""},e.length,n);return new xi(i,e.map((e=>ua(e,ca(t)))),n)}(e,t);case"equalOp":case"notEqualOp":case"lessThanOrEqualOp":case"lessThanOp":case"greaterThanOrEqualOp":case"greaterThanOp":return ma("generalCompare",e,t);case"eqOp":case"neOp":case"ltOp":case"leOp":case"gtOp":case"geOp":return ma("valueCompare",e,t);case"isOp":case"nodeBeforeOp":case"nodeAfterOp":return ma("nodeCompare",e,t);case"pathExpr":return function(e,t){const n=Sr(e,"type");var i=Ar(e,"stepExpr");let r=!1;var s=i.map((e=>{var i=wr(e,"xpathAxis");let s;var o=Ar(e,"*");const a=[];let l=null,h=!1;for(const e of o)switch(e[0]){case"lookup":a.push(["lookup",fa(e,t)]);break;case"predicate":case"predicates":for(const n of Ar(e,"*")){if(o=ua(n,ca(t)),!h){const e=o.D();null===e?h=!0:l=rs(l,e)}a.push(["predicate",o])}}if(i)switch(r=!0,e=wr(e,"attributeTest anyElementTest piTest documentTest elementTest commentTest namespaceTest anyKindTest textTest anyFunctionTest typedFunctionTest schemaAttributeTest atomicType anyItemType parenthesizedItemType typedMapTest typedArrayTest nameTest Wildcard".split(" ")),e=da(e),xr(i)){case"ancestor":s=new ns(e,{Qa:!1});break;case"ancestor-or-self":s=new ns(e,{Qa:!0});break;case"attribute":s=new ss(e,l);break;case"child":s=new os(e,l);break;case"descendant":s=new ls(e,{Qa:!1});break;case"descendant-or-self":s=new ls(e,{Qa:!0});break;case"parent":s=new ps(e,l);break;case"following-sibling":s=new ds(e,l);break;case"preceding-sibling":s=new ms(e,l);break;case"following":s=new us(e);break;case"preceding":s=new fs(e);break;case"self":s=new gs(e,l)}else s=ua(i=kr(e,["filterExpr","*"]),ca(t));for(const e of a)switch(e[0]){case"lookup":s=new co(s,e[1]);break;case"predicate":s=new ao(s,e[1])}return s.type=n,s}));return e=wr(e,"rootExpr"),!(i=r||null!==e||1<i.length)&&1===s.length||!e&&1===s.length&&"sorted"===s[0].ia?s[0]:e&&0===s.length?new ro(null):(s=new oo(s,i),e?new ro(s):s)}(e,t);case"contextItemExpr":return new so(Sr(e,"type"));case"functionCallExpr":return function(e,t){const n=wr(e,"functionName"),i=Ar(wr(e,"arguments"),"*");return e=Sr(e,"type"),new xi(new Ps(Cr(n),i.length,e),i.map((e=>"argumentPlaceholder"===e[0]?null:ua(e,t))),e)}(e,t);case"inlineFunctionExpr":return function(e,t){const n=Ar(wr(e,"paramList"),"*"),i=kr(e,["functionBody","*"]),r=Sr(e,"type");return new Cs(n.map((e=>({name:Cr(wr(e,"varName")),type:_r(e)}))),_r(e),i?ua(i,t):new js([],r))}(e,t);case"arrowExpr":return function(e,t){const n=Sr(e,"type");var i=kr(e,["argExpr","*"]);e=Ar(e,"*").slice(1),i=[ua(i,t)];for(let s=0;s<e.length;s++)if("arguments"!==e[s][0]){if("arguments"===e[s+1][0]){var r=Ar(e[s+1],"*");i=i.concat(r.map((e=>"argumentPlaceholder"===e[0]?null:ua(e,t))))}r="EQName"===e[s][0]?new Ps(Cr(e[s]),i.length,n):ua(e[s],ca(t)),i=[new xi(r,i,n)]}return i[0]}(e,t);case"dynamicFunctionInvocationExpr":return function(e,t){const n=kr(e,["functionItem","*"]),i=Sr(e,"type");e=wr(e,"arguments");let r=[];return e&&(r=Ar(e,"*").map((e=>"argumentPlaceholder"===e[0]?null:ua(e,t)))),new xi(ua(n,t),r,i)}(e,t);case"namedFunctionRef":return t=wr(e,"functionName"),n=Sr(e,"type"),e=xr(kr(e,["integerConstantExpr","value"])),new Ps(Cr(t),parseInt(e,10),n);case"integerConstantExpr":return new Es(xr(wr(e,"value")),{type:5,g:3});case"stringConstantExpr":return new Es(xr(wr(e,"value")),{type:1,g:3});case"decimalConstantExpr":return new Es(xr(wr(e,"value")),{type:4,g:3});case"doubleConstantExpr":return new Es(xr(wr(e,"value")),{type:3,g:3});case"varRef":const{prefix:l,namespaceURI:h,localName:c}=Cr(wr(e,"name"));return new vo(l,h,c);case"flworExpr":return function(e,t){var n=Ar(e,"*");if(e=wr(n[n.length-1],"*"),1<(n=n.slice(0,-1)).length&&!t.Z)throw Error("XPST0003: Use of XQuery FLWOR expressions in XPath is no allowed");return n.reduceRight(((e,n)=>{switch(n[0]){case"forClause":for(var i=(n=Ar(n,"*")).length-1;0<=i;--i){var r=n[i],s=kr(r,["forExpr","*"]);const o=wr(r,"positionalVariableBinding");e=new As(Cr(kr(r,["typedVariableBinding","varName"])),ua(s,ca(t)),o?Cr(o):null,e)}return e;case"letClause":for(i=(n=Ar(n,"*")).length-1;0<=i;--i)s=kr(r=n[i],["letExpr","*"]),e=new _s(Cr(kr(r,["typedVariableBinding","varName"])),ua(s,ca(t)),e);return e;case"whereClause":for(i=(n=Ar(n,"*")).length-1;0<=i;--i)e=new bo(ua(n[i],t),e);return e;case"windowClause":case"groupByClause":case"countClause":throw Error(`Not implemented: ${n[0]} is not implemented yet.`);case"orderByClause":return function(e,t,n){return e=Ar(e,"*"),new io(e.filter((e=>"stable"!==e[0])).map((e=>{var n=wr(e,"orderModifier"),i=n?wr(n,"orderingKind"):null;return n=n?wr(n,"emptyOrderingMode"):null,i=!i||"ascending"===xr(i),n=!n||"empty least"===xr(n),{ba:ua(kr(e,["orderByExpr","*"]),t),Bb:i,bc:n}})),n)}(n,t,e);default:throw Error(`Not implemented: ${n[0]} is not supported in a flwor expression`)}}),ua(e,t))}(e,t);case"quantifiedExpr":return function(e,t){const n=Sr(e,"type"),i=xr(wr(e,"quantifier")),r=kr(e,["predicateExpr","*"]);return e=Ar(e,"quantifiedExprInClause").map((e=>({name:Cr(kr(e,["typedVariableBinding","varName"])),fb:ua(e=kr(e,["sourceExpr","*"]),ca(t))}))),new po(i,e,ua(r,ca(t)),n)}(e,t);case"ifThenElseExpr":return n=Sr(e,"type"),i=wr(e,"ifClause")||Ar(e,"x:stackTrace")[0],r=wr(e,"thenClause")||Ar(e,"x:stackTrace")[1],e=wr(e,"elseClause")||Ar(e,"x:stackTrace")[2],new Os(ua(i,ca(t)),ua(r,t),ua(e,t),n);case"instanceOfExpr":return n=ua(kr(e,["argExpr","*"]),t),i=kr(e,["sequenceType","*"]),r=kr(e,["sequenceType","occurrenceIndicator"]),e=Sr(e,"type"),new Ys(n,ua(i,ca(t)),r?xr(r):"",e);case"castExpr":return t=ua(wr(wr(e,"argExpr"),"*"),ca(t)),n=wr(e,"singleType"),e=Cr(wr(n,"atomicType")),n=null!==wr(n,"optional"),new Ws(t,e,n);case"castableExpr":return t=ua(wr(wr(e,"argExpr"),"*"),ca(t)),n=wr(e,"singleType"),e=Cr(wr(n,"atomicType")),n=null!==wr(n,"optional"),new Gs(t,e,n);case"simpleMapExpr":return function(e,t){const n=Sr(e,"type");return Ar(e,"*").reduce(((e,i)=>null===e?ua(i,ca(t)):new qs(e,ua(i,ca(t)),n)),null)}(e,t);case"mapConstructor":return function(e,t){const n=Sr(e,"type");return new Ts(Ar(e,"mapConstructorEntry").map((e=>({key:ua(kr(e,["mapKeyExpr","*"]),ca(t)),value:ua(kr(e,["mapValueExpr","*"]),ca(t))}))),n)}(e,t);case"arrayConstructor":return function(e,t){const n=Sr(e,"type"),i=Ar(e=wr(e,"*"),"arrayElem").map((e=>ua(wr(e,"*"),ca(t))));switch(e[0]){case"curlyArray":return new Kr(i,n);case"squareArray":return new es(i,n);default:throw Error("Unrecognized arrayType: "+e[0])}}(e,t);case"unaryLookup":return n=Sr(e,"type"),new uo(fa(e,t),n);case"typeswitchExpr":return function(e,t){if(!t.Z)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");const n=Sr(e,"type"),i=ua(wr(wr(e,"argExpr"),"*"),t),r=Ar(e,"typeswitchExprCaseClause").map((e=>{const n=0===Ar(e,"sequenceTypeUnion").length?[wr(e,"sequenceType")]:Ar(wr(e,"sequenceTypeUnion"),"sequenceType");return{pb:ua(kr(e,["resultExpr","*"]),t),Ib:n.map((e=>{const n=wr(e,"occurrenceIndicator");return{dc:n?xr(n):"",Hb:ua(wr(e,"*"),t)}}))}}));return e=ua(kr(e,["typeswitchExprDefaultClause","resultExpr","*"]),t),new sa(i,r,e,n)}(e,t);case"switchExpr":return function(e,t){if(!t.Z)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");const n=Sr(e,"type"),i=ua(wr(wr(e,"argExpr"),"*"),t),r=Ar(e,"switchExprCaseClause").map((e=>{const n=Ar(e,"switchCaseExpr");return{pb:ua(kr(e,["resultExpr","*"]),t),Gb:n.map((e=>ua(wr(e,"*"),t)))}}));return e=ua(kr(e,["switchExprDefaultClause","resultExpr","*"]),t),new oa(i,r,e,n)}(e,t);case"elementConstructor":return function(e,t){if(!t.Z)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");const n=Cr(wr(e,"tagName"));var i=wr(e,"attributeList");const r=i?Ar(i,"attributeConstructor").map((e=>ua(e,ca(t)))):[];return i=i?Ar(i,"namespaceDeclaration").map((e=>{const t=wr(e,"prefix");return{prefix:t?xr(t):"",uri:xr(wr(e,"uri"))}})):[],e=(e=wr(e,"elementContent"))?Ar(e,"*").map((e=>ua(e,ca(t)))):[],new ea(n,r,i,e)}(e,t);case"attributeConstructor":return function(e,t){if(!t.Z)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");const n=Cr(wr(e,"attributeName"));var i=wr(e,"attributeValue");return i=i?xr(i):null,e=(e=wr(e,"attributeValueExpr"))?Ar(e,"*").map((e=>ua(e,ca(t)))):null,new Jo(n,{value:i,nb:e})}(e,t);case"computedAttributeConstructor":return(n=wr(e,"tagName"))?n=Cr(n):(n=wr(e,"tagNameExpr"),n={Na:ua(wr(n,"*"),ca(t))}),t=ua(wr(wr(e,"valueExpr"),"*"),ca(t)),new Jo(n,{nb:[t]});case"computedCommentConstructor":if(!t.Z)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");return t=(e=wr(e,"argExpr"))?ua(wr(e,"*"),ca(t)):null,new Ko(t);case"computedTextConstructor":if(!t.Z)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");return t=(e=wr(e,"argExpr"))?ua(wr(e,"*"),ca(t)):null,new ra(t);case"computedElementConstructor":return function(e,t){var n=wr(e,"tagName");return n?n=Cr(n):(n=wr(e,"tagNameExpr"),n={Na:ua(wr(n,"*"),ca(t))}),e=(e=wr(e,"contentExpr"))?Ar(e,"*").map((e=>ua(e,ca(t)))):[],new ea(n,[],[],e)}(e,t);case"computedPIConstructor":if(!t.Z)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");return n=wr(e,"piTargetExpr"),i=wr(e,"piTarget"),r=wr(e,"piValueExpr"),e=Sr(e,"type"),new ia({xb:n?ua(wr(n,"*"),ca(t)):null,Fb:i?xr(i):null},r?ua(wr(r,"*"),ca(t)):new js([],e));case"CDataSection":return new Es(xr(e),{type:1,g:3});case"deleteExpr":return t=ua(kr(e,["targetExpr","*"]),t),new Ro(t);case"insertExpr":switch(n=ua(kr(e,["sourceExpr","*"]),t),(r=Ar(e,"*")[1])[0]){case"insertAfter":i=1;break;case"insertBefore":i=2;break;case"insertInto":i=(i=wr(r,"*"))?"insertAsFirst"===i[0]?4:5:3}return t=ua(kr(e,["targetExpr","*"]),t),new Xo(n,i,t);case"renameExpr":return n=ua(kr(e,["targetExpr","*"]),t),t=ua(kr(e,["newNameExpr","*"]),t),new jo(n,t);case"replaceExpr":return n=!!wr(e,"replaceValue"),i=ua(kr(e,["targetExpr","*"]),t),t=ua(kr(e,["replacementExpr","*"]),t),new qo(n,i,t);case"transformExpr":return function(e,t){const n=Ar(wr(e,"transformCopies"),"transformCopy").map((e=>{const n=Cr(wr(wr(e,"varRef"),"name"));return{fb:ua(wr(wr(e,"copySource"),"*"),t),Jb:new F(n.prefix,n.namespaceURI,n.localName)}})),i=ua(wr(wr(e,"modifyExpr"),"*"),t);return e=ua(wr(wr(e,"returnExpr"),"*"),t),new Ho(n,i,e)}(e,t);case"x:stackTrace":for(e=(n=e)[2];"x:stackTrace"===e[0];)n=e,e=e[2];return n=n[1],new ws(n,e[0],ua(e,t),n.Wa);case"ifClause":case"thenClause":case"elseClause":return ua(wr(e,"*"),t);default:return da(e)}}function da(e){switch(e[0]){case"nameTest":return new go(Cr(e));case"piTest":return(e=wr(e,"piTarget"))?new Oo(xr(e)):new mo(7);case"commentTest":return new mo(8);case"textTest":return new mo(3);case"documentTest":return new mo(9);case"attributeTest":var t=(e=wr(e,"attributeName"))&&wr(e,"star");return!e||t?new mo(2):new go(Cr(wr(e,"QName")),{kind:2});case"elementTest":return t=(e=wr(e,"elementName"))&&wr(e,"star"),!e||t?new mo(1):new go(Cr(wr(e,"QName")),{kind:1});case"anyKindTest":return new yo({prefix:"",namespaceURI:null,localName:"node()"});case"anyMapTest":return new yo({prefix:"",namespaceURI:null,localName:"map(*)"});case"anyArrayTest":return new yo({prefix:"",namespaceURI:null,localName:"array(*)"});case"Wildcard":return wr(e,"star")?(t=wr(e,"uri"))?e=new go({localName:"*",namespaceURI:xr(t),prefix:""}):(t=wr(e,"NCName"),e="star"===wr(e,"*")[0]?new go({localName:xr(t),namespaceURI:null,prefix:"*"}):new go({localName:"*",namespaceURI:null,prefix:xr(t)})):e=new go({localName:"*",namespaceURI:null,prefix:"*"}),e;case"atomicType":return new yo(Cr(e));case"anyItemType":return new yo({prefix:"",namespaceURI:null,localName:"item()"});default:throw Error("No selector counterpart for: "+e[0]+".")}}function pa(e,t,n){const i=[];return function t(r){const s=wr(wr(r,"firstOperand"),"*");r=wr(wr(r,"secondOperand"),"*"),s[0]===e?t(s):i.push(ua(s,n)),r[0]===e?t(r):i.push(ua(r,n))}(t),i}function fa(e,t){switch((e=wr(e,"*"))[0]){case"NCName":return new Es(xr(e),{type:1,g:3});case"star":return"*";default:return ua(e,ca(t))}}function ma(e,t,n){var i=kr(t,["firstOperand","*"]);const r=kr(t,["secondOperand","*"]);switch(i=ua(i,ca(n)),n=ua(r,ca(n)),e){case"valueCompare":return new Xs(t[0],i,n);case"nodeCompare":return new Vs(t[0],i,n);case"generalCompare":return new Ls(t[0],i,n)}}function ga(e,t){return ua(e,t)}const Oa=new Map;class ya{constructor(e,t,n,i,r,s){this.v=e,this.D=t,this.h=n,this.kb=i,this.o=r,this.l=s}}function va(e,t,n,i,r,s,o){let a=Oa.get(e);a||(a=Object.create(null),Oa.set(e,a)),(t=a[e=t+(s?"_DEBUG":"")])||(t=a[e]=[]),t.push(new ya(Object.values(n.h),Object.values(n.o),r,Object.keys(i).map((e=>({namespaceURI:i[e],prefix:e}))),o,n.D))}function ba(e){var t=new Z;if("http://www.w3.org/2005/XQueryX"!==e.namespaceURI&&"http://www.w3.org/2005/XQueryX"!==e.namespaceURI&&"http://fontoxml.com/fontoxpath"!==e.namespaceURI&&"http://www.w3.org/2007/xquery-update-10"!==e.namespaceURI)throw Ke("The XML structure passed as an XQueryX program was not valid XQueryX");const n=["stackTrace"===e.localName?"x:stackTrace":e.localName],i=t.getAllAttributes(e);i&&0<i.length&&n.push(Array.from(i).reduce(((t,n)=>("comment"!==n.localName&&"start"!==n.localName&&"end"!==n.localName||"stackTrace"!==e.localName?"type"===n.localName?t[n.localName]=N(n.value):t[n.localName]=n.value:t[n.localName]=JSON.parse(n.value),t)),{})),t=t.getChildNodes(e);for(const e of t)switch(e.nodeType){case 1:n.push(ba(e));break;case 3:n.push(e.data)}return n}const wa=Object.create(null);var xa=(e,t)=>{let n=wa[e];n||=wa[e]={Ia:[],Ta:[],pa:null,source:t.source};const i=n.pa||(()=>{});n.Ia=n.Ia.concat(t.Ia),n.Ta=n.Ta.concat(t.Ta),n.pa=e=>{i(e),t.pa&&t.pa(e)}},Sa=(e,t)=>{const n=wa[t];if(!n)throw Error(`XQST0051: No modules found with the namespace uri ${t}`);n.Ia.forEach((n=>{n.cb&&mr(e,t,n.localName,n.arity,n)})),n.Ta.forEach((n=>{Or(e,t,n.localName),yr(e,t,n.localName,((e,t)=>ei(n.ba,e,t)))}))},ka=()=>{Object.keys(wa).forEach((e=>{if((e=wa[e]).pa)try{e.pa(e)}catch(t){e.pa=null,Gi(e.source,t)}e.pa=null}))};function Aa(e){return e.replace(/(\x0D\x0A)|(\x0D(?!\x0A))/g,String.fromCharCode(10))}var Ca=t;function _a(e,t){return(n,i)=>t.has(i)?t.get(i):(n=e(n,i),t.set(i,n),n)}function Ea(e,t){return(0,Ca.delimited)(t,e,t)}function Ta(e,t){return e.reverse().reduce(((e,t)=>(0,Ca.preceded)(t,e)),t)}function Pa(e,t,n,i){return(0,Ca.then)((0,Ca.then)(e,t,((e,t)=>[e,t])),n,(([e,t],n)=>i(e,t,n)))}function $a(e,t,n,i,r){return(0,Ca.then)((0,Ca.then)((0,Ca.then)(e,t,((e,t)=>[e,t])),n,(([e,t],n)=>[e,t,n])),i,(([e,t,n],i)=>r(e,t,n,i)))}function Na(e){return(0,Ca.map)(e,(e=>[e]))}function Ia(e,t){return(0,Ca.map)((0,Ca.or)(e),(()=>t))}function Qa(e){return(t,n)=>(t=e.exec(t.substring(n)))&&0===t.index?(0,Ca.okWithValue)(n+t[0].length,t[0]):(0,Ca.error)(n,[e.source],!1)}var Ra=(0,Ca.or)([(0,Ca.token)(" "),(0,Ca.token)("\t"),(0,Ca.token)("\r"),(0,Ca.token)("\n")]),Ma=(0,Ca.token)("(:"),Ba=(0,Ca.token)(":)"),Da=(0,Ca.token)("(#"),Xa=(0,Ca.token)("#)"),Fa=(0,Ca.token)("("),La=(0,Ca.token)(")"),Ua=(0,Ca.token)("["),Va=(0,Ca.token)("]"),za=(0,Ca.token)("{"),Za=(0,Ca.token)("}"),ja=(0,Ca.token)("{{"),qa=(0,Ca.token)("}}"),Ga=(0,Ca.token)("'"),Wa=(0,Ca.token)("''"),Ha=(0,Ca.token)('"'),Ya=(0,Ca.token)('""'),Ja=(0,Ca.token)("<![CDATA["),Ka=(0,Ca.token)("]]>"),el=(0,Ca.token)("/>"),tl=(0,Ca.token)("</"),nl=(0,Ca.token)("\x3c!--"),il=(0,Ca.token)("--\x3e"),rl=(0,Ca.token)("<?"),sl=(0,Ca.token)("?>"),ol=(0,Ca.token)("&#x"),al=(0,Ca.token)("&#"),ll=(0,Ca.token)(":*"),hl=(0,Ca.token)("*:"),cl=(0,Ca.token)(":="),ul=(0,Ca.token)("&"),dl=(0,Ca.token)(":"),pl=(0,Ca.token)(";"),fl=(0,Ca.token)("*"),ml=(0,Ca.token)("@"),gl=(0,Ca.token)("$"),Ol=(0,Ca.token)("#"),yl=(0,Ca.token)("%"),vl=(0,Ca.token)("?"),bl=(0,Ca.token)("="),wl=(0,Ca.followed)((0,Ca.token)("!"),(0,Ca.not)((0,Ca.peek)(bl),[])),xl=(0,Ca.followed)((0,Ca.token)("|"),(0,Ca.not)((0,Ca.peek)((0,Ca.token)("|")),[])),Sl=(0,Ca.token)("||"),kl=(0,Ca.token)("!="),Al=(0,Ca.token)("<"),Cl=(0,Ca.token)("<<"),_l=(0,Ca.token)("<="),El=(0,Ca.token)(">"),Tl=(0,Ca.token)(">>"),Pl=(0,Ca.token)(">="),$l=(0,Ca.token)(","),Nl=(0,Ca.token)("."),Il=(0,Ca.token)(".."),Ql=(0,Ca.token)("+"),Rl=(0,Ca.token)("-"),Ml=(0,Ca.token)("/"),Bl=(0,Ca.token)("//"),Dl=(0,Ca.token)("=>"),Xl=(0,Ca.token)("e"),Fl=(0,Ca.token)("E");(0,Ca.token)("l"),(0,Ca.token)("L"),(0,Ca.token)("m"),(0,Ca.token)("M");var Ll=(0,Ca.token)("Q");(0,Ca.token)("x"),(0,Ca.token)("X");var Ul=(0,Ca.token)("as"),Vl=(0,Ca.token)("cast"),zl=(0,Ca.token)("castable"),Zl=(0,Ca.token)("treat"),jl=(0,Ca.token)("instance"),ql=(0,Ca.token)("of"),Gl=(0,Ca.token)("node"),Wl=(0,Ca.token)("nodes"),Hl=(0,Ca.token)("delete"),Yl=(0,Ca.token)("value"),Jl=(0,Ca.token)("function"),Kl=(0,Ca.token)("map"),eh=(0,Ca.token)("element"),th=(0,Ca.token)("attribute"),nh=(0,Ca.token)("schema-element"),ih=(0,Ca.token)("intersect"),rh=(0,Ca.token)("except"),sh=(0,Ca.token)("union"),oh=(0,Ca.token)("to"),ah=(0,Ca.token)("is"),lh=(0,Ca.token)("or"),hh=(0,Ca.token)("and"),ch=(0,Ca.token)("div"),uh=(0,Ca.token)("idiv"),dh=(0,Ca.token)("mod"),ph=(0,Ca.token)("eq"),fh=(0,Ca.token)("ne"),mh=(0,Ca.token)("lt"),gh=(0,Ca.token)("le"),Oh=(0,Ca.token)("gt"),yh=(0,Ca.token)("ge"),vh=(0,Ca.token)("amp"),bh=(0,Ca.token)("quot"),wh=(0,Ca.token)("apos"),xh=(0,Ca.token)("if"),Sh=(0,Ca.token)("then"),kh=(0,Ca.token)("else"),Ah=(0,Ca.token)("allowing"),Ch=(0,Ca.token)("empty"),_h=(0,Ca.token)("at"),Eh=(0,Ca.token)("in"),Th=(0,Ca.token)("for"),Ph=(0,Ca.token)("let"),$h=(0,Ca.token)("where"),Nh=(0,Ca.token)("collation"),Ih=(0,Ca.token)("group"),Qh=(0,Ca.token)("by"),Rh=(0,Ca.token)("order"),Mh=(0,Ca.token)("stable"),Bh=(0,Ca.token)("return"),Dh=(0,Ca.token)("array"),Xh=(0,Ca.token)("document"),Fh=(0,Ca.token)("namespace"),Lh=(0,Ca.token)("text"),Uh=(0,Ca.token)("comment"),Vh=(0,Ca.token)("processing-instruction"),zh=(0,Ca.token)("lax"),Zh=(0,Ca.token)("strict"),jh=(0,Ca.token)("validate"),qh=(0,Ca.token)("type"),Gh=(0,Ca.token)("declare"),Wh=(0,Ca.token)("default"),Hh=(0,Ca.token)("boundary-space"),Yh=(0,Ca.token)("strip"),Jh=(0,Ca.token)("preserve"),Kh=(0,Ca.token)("no-preserve"),ec=(0,Ca.token)("inherit"),tc=(0,Ca.token)("no-inherit"),nc=(0,Ca.token)("greatest"),ic=(0,Ca.token)("least"),rc=(0,Ca.token)("copy-namespaces"),sc=(0,Ca.token)("decimal-format"),oc=(0,Ca.token)("case"),ac=(0,Ca.token)("typeswitch"),lc=(0,Ca.token)("some"),hc=(0,Ca.token)("every"),cc=(0,Ca.token)("satisfies"),uc=(0,Ca.token)("replace"),dc=(0,Ca.token)("with"),pc=(0,Ca.token)("copy"),fc=(0,Ca.token)("modify"),mc=(0,Ca.token)("first"),gc=(0,Ca.token)("last"),Oc=(0,Ca.token)("before"),yc=(0,Ca.token)("after"),vc=(0,Ca.token)("into"),bc=(0,Ca.token)("insert"),wc=(0,Ca.token)("rename"),xc=(0,Ca.token)("switch"),Sc=(0,Ca.token)("variable"),kc=(0,Ca.token)("external"),Ac=(0,Ca.token)("updating"),Cc=(0,Ca.token)("import"),_c=(0,Ca.token)("schema"),Ec=(0,Ca.token)("module"),Tc=(0,Ca.token)("base-uri"),Pc=(0,Ca.token)("construction"),$c=(0,Ca.token)("ordering"),Nc=(0,Ca.token)("ordered"),Ic=(0,Ca.token)("unordered"),Qc=(0,Ca.token)("option"),Rc=(0,Ca.token)("context"),Mc=(0,Ca.token)("item"),Bc=(0,Ca.token)("xquery"),Dc=(0,Ca.token)("version"),Xc=(0,Ca.token)("encoding"),Fc=(0,Ca.token)("document-node"),Lc=(0,Ca.token)("namespace-node"),Uc=(0,Ca.token)("schema-attribute"),Vc=(0,Ca.token)("ascending"),zc=(0,Ca.token)("descending"),Zc=(0,Ca.token)("empty-sequence"),jc=(0,Ca.token)("child::"),qc=(0,Ca.token)("descendant::"),Gc=(0,Ca.token)("attribute::"),Wc=(0,Ca.token)("self::"),Hc=(0,Ca.token)("descendant-or-self::"),Yc=(0,Ca.token)("following-sibling::"),Jc=(0,Ca.token)("following::"),Kc=(0,Ca.token)("parent::"),eu=(0,Ca.token)("ancestor::"),tu=(0,Ca.token)("preceding-sibling::"),nu=(0,Ca.token)("preceding::"),iu=(0,Ca.token)("ancestor-or-self::"),ru=(0,Ca.token)("decimal-separator"),su=(0,Ca.token)("grouping-separator"),ou=(0,Ca.token)("infinity"),au=(0,Ca.token)("minus-sign"),lu=(0,Ca.token)("NaN"),hu=(0,Ca.token)("per-mille"),cu=(0,Ca.token)("zero-digit"),uu=(0,Ca.token)("digit"),du=(0,Ca.token)("pattern-separator"),pu=(0,Ca.token)("exponent-separator"),fu=(0,Ca.token)("schema-attribute("),mu=(0,Ca.token)("document-node("),gu=(0,Ca.token)("processing-instruction("),Ou=(0,Ca.token)("processing-instruction()"),yu=(0,Ca.token)("comment()"),vu=(0,Ca.token)("text()"),bu=(0,Ca.token)("namespace-node()"),wu=(0,Ca.token)("node()"),xu=(0,Ca.token)("item()"),Su=(0,Ca.token)("empty-sequence()"),ku=new Map,Au=new Map,Cu=(0,Ca.or)([Qa(/[\t\n\r -\uD7FF\uE000\uFFFD]/),Qa(/[\uD800-\uDBFF][\uDC00-\uDFFF]/)]),_u=(0,Ca.preceded)((0,Ca.peek)((0,Ca.not)((0,Ca.or)([Ma,Ba]),['comment contents cannot contain "(:" or ":)"'])),Cu),Eu=(0,Ca.map)((0,Ca.delimited)(Ma,(0,Ca.star)((0,Ca.or)([_u,function(e,t){return Eu(e,t)}])),Ba,!0),(e=>e.join(""))),Tu=(0,Ca.or)([Ra,Eu]),Pu=(0,Ca.map)((0,Ca.plus)(Ra),(e=>e.join(""))),$u=_a((0,Ca.map)((0,Ca.star)(Tu),(e=>e.join(""))),ku),Nu=_a((0,Ca.map)((0,Ca.plus)(Tu),(e=>e.join(""))),Au);const Iu=(0,Ca.or)([Qa(/[A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/),(0,Ca.then)(Qa(/[\uD800-\uDB7F]/),Qa(/[\uDC00-\uDFFF]/),((e,t)=>e+t))]),Qu=(0,Ca.or)([Iu,Qa(/[\-\.0-9\xB7\u0300-\u036F\u203F\u2040]/)]);var Ru=(0,Ca.then)(Iu,(0,Ca.star)(Qu),((e,t)=>e+t.join(""))),Mu=(0,Ca.map)(Ru,(e=>["prefix",e]));const Bu=(0,Ca.or)([Iu,dl]),Du=(0,Ca.or)([Qu,dl]);(0,Ca.then)(Bu,(0,Ca.star)(Du),((e,t)=>e+t.join("")));const Xu=(0,Ca.map)(Ru,(e=>[{prefix:"",URI:null},e])),Fu=(0,Ca.then)(Ru,(0,Ca.preceded)(dl,Ru),((e,t)=>[{prefix:e,URI:null},t]));var Lu=(0,Ca.or)([Fu,Xu]),Uu=(0,Ca.followed)(Ta([Ll,$u,za],(0,Ca.map)((0,Ca.star)(Qa(/[^{}]/)),(e=>e.join("").replace(/\s+/g," ").trim()))),Za);const Vu=(0,Ca.then)(Uu,Ru,((e,t)=>[e,t]));var zu=(0,Ca.or)([(0,Ca.map)(Vu,(e=>[{prefix:null,URI:e[0]},e[1]])),Lu]),Zu=(0,Ca.or)([(0,Ca.map)(zu,(e=>["QName",...e])),(0,Ca.map)(fl,(()=>["star"]))]),ju=(0,Ca.map)((0,Ca.preceded)(gl,zu),(e=>["varRef",["name",...e]])),qu=(0,Ca.peek)((0,Ca.or)([Fa,Ha,Ga,Tu])),Gu=(0,Ca.map)((0,Ca.or)([jc,qc,Gc,Wc,Hc,Yc,Jc]),(e=>e.substring(0,e.length-2))),Wu=(0,Ca.map)((0,Ca.or)([Kc,eu,tu,nu,iu]),(e=>e.substring(0,e.length-2))),Hu=Pa(ul,(0,Ca.or)([mh,Oh,vh,bh,wh]),pl,((e,t,n)=>e+t+n)),Yu=(0,Ca.or)([Pa(ol,Qa(/[0-9a-fA-F]+/),pl,((e,t,n)=>e+t+n)),Pa(al,Qa(/[0-9]+/),pl,((e,t,n)=>e+t+n))]),Ju=Ia([Ya],'"'),Ku=Ia([Wa],"'"),ed=Na(Ia([yu],"commentTest")),td=Na(Ia([vu],"textTest")),nd=Na(Ia([bu],"namespaceTest")),id=Na(Ia([wu],"anyKindTest"));const rd=Qa(/[0-9]+/),sd=(0,Ca.then)((0,Ca.or)([(0,Ca.then)(Nl,rd,((e,t)=>e+t)),(0,Ca.then)(rd,(0,Ca.optional)((0,Ca.preceded)(Nl,Qa(/[0-9]*/))),((e,t)=>e+(null!==t?"."+t:"")))]),Pa((0,Ca.or)([Xl,Fl]),(0,Ca.optional)((0,Ca.or)([Ql,Rl])),rd,((e,t,n)=>e+(t||"")+n)),((e,t)=>["doubleConstantExpr",["value",e+t]])),od=(0,Ca.or)([(0,Ca.map)((0,Ca.preceded)(Nl,rd),(e=>["decimalConstantExpr",["value","."+e]])),(0,Ca.then)((0,Ca.followed)(rd,Nl),(0,Ca.optional)(rd),((e,t)=>["decimalConstantExpr",["value",e+"."+(null!==t?t:"")]]))]);var ad=(0,Ca.map)(rd,(e=>["integerConstantExpr",["value",e]])),ld=(0,Ca.followed)((0,Ca.or)([sd,od,ad]),(0,Ca.peek)((0,Ca.not)(Qa(/[a-zA-Z]/),["no alphabetical characters after numeric literal"]))),hd=(0,Ca.map)((0,Ca.followed)(Nl,(0,Ca.peek)((0,Ca.not)(Nl,["context item should not be followed by another ."]))),(()=>["contextItemExpr"])),cd=(0,Ca.or)([Dh,th,Uh,Fc,eh,Zc,Jl,xh,Mc,Kl,Lc,Gl,Vh,Uc,nh,xc,Lh,ac]),ud=Na(Ia([vl],"argumentPlaceholder")),dd=(0,Ca.or)([vl,fl,Ql]),pd=(0,Ca.preceded)((0,Ca.peek)((0,Ca.not)(Qa(/[{}<&]/),["elementContentChar cannot be {, }, <, or &"])),Cu),fd=(0,Ca.map)((0,Ca.delimited)(Ja,(0,Ca.star)((0,Ca.preceded)((0,Ca.peek)((0,Ca.not)(Ka,['CDataSection content may not contain "]]>"'])),Cu)),Ka,!0),(e=>["CDataSection",e.join("")])),md=(0,Ca.preceded)((0,Ca.peek)((0,Ca.not)(Qa(/["{}<&]/),['quotAttrValueContentChar cannot be ", {, }, <, or &'])),Cu),gd=(0,Ca.preceded)((0,Ca.peek)((0,Ca.not)(Qa(/['{}<&]/),["aposAttrValueContentChar cannot be ', {, }, <, or &"])),Cu),Od=(0,Ca.map)((0,Ca.star)((0,Ca.or)([(0,Ca.preceded)((0,Ca.peek)((0,Ca.not)(Rl,[])),Cu),(0,Ca.map)(Ta([Rl,(0,Ca.peek)((0,Ca.not)(Rl,[]))],Cu),(e=>"-"+e))])),(e=>e.join(""))),yd=(0,Ca.map)((0,Ca.delimited)(nl,Od,il,!0),(e=>["computedCommentConstructor",["argExpr",["stringConstantExpr",["value",e]]]]));const vd=(0,Ca.filter)(Ru,(e=>"xml"!==e.toLowerCase()),['A processing instruction target cannot be "xml"']),bd=(0,Ca.map)((0,Ca.star)((0,Ca.preceded)((0,Ca.peek)((0,Ca.not)(sl,[])),Cu)),(e=>e.join("")));var wd=(0,Ca.then)((0,Ca.preceded)(rl,(0,Ca.cut)(vd)),(0,Ca.cut)((0,Ca.followed)((0,Ca.optional)((0,Ca.preceded)(Pu,bd)),sl)),((e,t)=>["computedPIConstructor",["piTarget",e],["piValueExpr",["stringConstantExpr",["value",t]]]])),xd=(0,Ca.map)(Bl,(()=>["stepExpr",["xpathAxis","descendant-or-self"],["anyKindTest"]])),Sd=(0,Ca.or)([zh,Zh]),kd=(0,Ca.map)((0,Ca.star)((0,Ca.followed)(Cu,(0,Ca.peek)((0,Ca.not)(Xa,["Pragma contents should not contain '#)'"])))),(e=>e.join(""))),Ad=(0,Ca.map)((0,Ca.followed)((0,Ca.or)([ph,fh,mh,gh,Oh,yh]),qu),(e=>e+"Op")),Cd=(0,Ca.or)([(0,Ca.followed)(Ia([ah],"isOp"),qu),Ia([Cl],"nodeBeforeOp"),Ia([Tl],"nodeAfterOp")]),_d=(0,Ca.or)([Ia([bl],"equalOp"),Ia([kl],"notEqualOp"),Ia([_l],"lessThanOrEqualOp"),Ia([Al],"lessThanOp"),Ia([Pl],"greaterThanOrEqualOp"),Ia([El],"greaterThanOp")]),Ed=(0,Ca.map)(Ac,(()=>["annotation",["annotationName","updating"]]));const Td=(0,Ca.or)([Jh,Kh]),Pd=(0,Ca.or)([ec,tc]);var $d=(0,Ca.or)([ru,su,ou,au,lu,yl,hu,cu,uu,du,pu]),Nd=(0,Ca.map)(Ta([Gh,Nu,Hh,Nu],(0,Ca.or)([Jh,Yh])),(e=>["boundarySpaceDecl",e])),Id=(0,Ca.map)(Ta([Gh,Nu,Pc,Nu],(0,Ca.or)([Jh,Yh])),(e=>["constructionDecl",e])),Qd=(0,Ca.map)(Ta([Gh,Nu,$c,Nu],(0,Ca.or)([Nc,Ic])),(e=>["orderingModeDecl",e])),Rd=(0,Ca.map)(Ta([Gh,Nu,Wh,Nu,Rh,Nu,Ch,Nu],(0,Ca.or)([nc,ic])),(e=>["emptyOrderDecl",e])),Md=(0,Ca.then)(Ta([Gh,Nu,rc,Nu],Td),Ta([$u,$l,$u],Pd),((e,t)=>["copyNamespacesDecl",["preserveMode",e],["inheritMode",t]]));function Bd(e){switch(e[0]){case"constantExpr":case"varRef":case"contextItemExpr":case"functionCallExpr":case"sequenceExpr":case"elementConstructor":case"computedElementConstructor":case"computedAttributeConstructor":case"computedDocumentConstructor":case"computedTextConstructor":case"computedCommentConstructor":case"computedNamespaceConstructor":case"computedPIConstructor":case"orderedExpr":case"unorderedExpr":case"namedFunctionRef":case"inlineFunctionExpr":case"dynamicFunctionInvocationExpr":case"mapConstructor":case"arrayConstructor":case"stringConstructor":case"unaryLookup":return e}return["sequenceExpr",e]}function Dd(e){if(!(1<=e&&55295>=e||57344<=e&&65533>=e||65536<=e&&1114111>=e))throw Error("XQST0090: The character reference "+e+" ("+e.toString(16)+") does not reference a valid codePoint.")}function Xd(e){return e.replace(/(&[^;]+);/g,(e=>{if(/^&#x/.test(e))return Dd(e=parseInt(e.slice(3,-1),16)),String.fromCodePoint(e);if(/^&#/.test(e))return Dd(e=parseInt(e.slice(2,-1),10)),String.fromCodePoint(e);switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&quot;":return String.fromCharCode(34);case"&apos;":return String.fromCharCode(39)}throw Error('XPST0003: Unknown character reference: "'+e+'"')}))}function Fd(e,t,n){if(!e.length)return[];let i=[e[0]];for(let t=1;t<e.length;++t){const n=i[i.length-1];"string"==typeof n&&"string"==typeof e[t]?i[i.length-1]=n+e[t]:i.push(e[t])}if("string"==typeof i[0]&&0===i.length)return[];if(i=i.reduce(((e,t,r)=>{if("string"!=typeof t)e.push(t);else if(n&&/^\s*$/.test(t)){const n=i[r+1];(n&&"CDataSection"===n[0]||(r=i[r-1])&&"CDataSection"===r[0])&&e.push(Xd(t))}else e.push(Xd(t));return e}),[]),!i.length)return i;if(1<i.length||t)for(e=0;e<i.length;e++)"string"==typeof i[e]&&(i[e]=["stringConstantExpr",["value",i[e]]]);return i}function Ld(e){return e[0].prefix?e[0].prefix+":"+e[1]:e[1]}var Ud=(0,Ca.then)(zu,(0,Ca.optional)(vl),((e,t)=>null!==t?["singleType",["atomicType",...e],["optional"]]:["singleType",["atomicType",...e]])),Vd=(0,Ca.map)(zu,(e=>["atomicType",...e]));const zd=new Map;function Zd(e){function t(e,t){return t.reduce(((e,t)=>[t[0],["firstOperand",e],["secondOperand",t[1]]]),e)}function n(e,t,n){return(0,Ca.then)(e,(0,Ca.star)((0,Ca.then)(Ea(t,$u),(0,Ca.cut)(e),((e,t)=>[e,t]))),n)}function i(e,t,n="firstOperand",i="secondOperand"){return(0,Ca.then)(e,(0,Ca.optional)((0,Ca.then)(Ea(t,$u),(0,Ca.cut)(e),((e,t)=>[e,t]))),((e,t)=>null===t?e:[t[0],[n,e],[i,t[1]]]))}function r(t){return e.mb?(e,n)=>{if(!(e=t(e,n)).success)return e;const i=h.has(n)?h.get(n):{offset:n,line:-1,ha:-1},r=h.has(e.offset)?h.get(e.offset):{offset:e.offset,line:-1,ha:-1};return h.set(n,i),h.set(e.offset,r),n=e.value.Wa,(0,Ca.okWithValue)(e.offset,["x:stackTrace",Object.assign({start:i,end:r},n?{Wa:n}:{}),e.value])}:t}function s(e,t){return W(e,t)}function o(e,t){return Be(e,t)}function a(e,t){return r((0,Ca.or)([Et,Qt,Vt,$t,lt,Ft,Rt,Lt,Mt,Dt,rt]))(e,t)}function l(e,t){return n(a,$l,((e,t)=>0===t.length?e:["sequenceExpr",e,...t.map((e=>e[1]))]))(e,t)}const h=new Map,c=(0,Ca.preceded)(Ua,(0,Ca.followed)(Ea(l,$u),Va)),u=(0,Ca.map)(e.Za?(0,Ca.or)([Ea((0,Ca.star)((0,Ca.or)([Hu,Yu,Ju,Qa(/[^"&]/)])),Ha),Ea((0,Ca.star)((0,Ca.or)([Hu,Yu,Ku,Qa(/[^'&]/)])),Ga)]):(0,Ca.or)([Ea((0,Ca.star)((0,Ca.or)([Ju,Qa(/[^"]/)])),Ha),Ea((0,Ca.star)((0,Ca.or)([Ku,Qa(/[^']/)])),Ga)]),(e=>e.join(""))),d=(0,Ca.or)([(0,Ca.map)(Ta([eh,$u],(0,Ca.delimited)((0,Ca.followed)(Fa,$u),(0,Ca.then)(Zu,Ta([$u,$l,$u],zu),((e,t)=>[["elementName",e],["typeName",...t]])),(0,Ca.preceded)($u,La))),(([e,t])=>["elementTest",e,t])),(0,Ca.map)(Ta([eh,$u],(0,Ca.delimited)(Fa,Zu,La)),(e=>["elementTest",["elementName",e]])),(0,Ca.map)(Ta([eh,$u],(0,Ca.delimited)(Fa,$u,La)),(()=>["elementTest"]))]),p=(0,Ca.or)([(0,Ca.map)(zu,(e=>["QName",...e])),(0,Ca.map)(fl,(()=>["star"]))]),f=(0,Ca.or)([(0,Ca.map)(Ta([th,$u],(0,Ca.delimited)((0,Ca.followed)(Fa,$u),(0,Ca.then)(p,Ta([$u,$l,$u],zu),((e,t)=>[["attributeName",e],["typeName",...t]])),(0,Ca.preceded)($u,La))),(([e,t])=>["attributeTest",e,t])),(0,Ca.map)(Ta([th,$u],(0,Ca.delimited)(Fa,p,La)),(e=>["attributeTest",["attributeName",e]])),(0,Ca.map)(Ta([th,$u],(0,Ca.delimited)(Fa,$u,La)),(()=>["attributeTest"]))]),m=(0,Ca.map)(Ta([nh,$u,Fa],(0,Ca.followed)(zu,La)),(e=>["schemaElementTest",...e])),g=(0,Ca.map)((0,Ca.delimited)(fu,Ea(zu,$u),La),(e=>["schemaAttributeTest",...e])),O=(0,Ca.map)((0,Ca.preceded)(mu,(0,Ca.followed)(Ea((0,Ca.optional)((0,Ca.or)([d,m])),$u),La)),(e=>["documentTest",...e?[e]:[]])),y=(0,Ca.or)([(0,Ca.map)((0,Ca.preceded)(gu,(0,Ca.followed)(Ea((0,Ca.or)([Ru,u]),$u),La)),(e=>["piTest",["piTarget",e]])),Na(Ia([Ou],"piTest"))]),v=(0,Ca.or)([O,d,f,m,g,y,ed,td,nd,id]),b=(0,Ca.or)([(0,Ca.map)((0,Ca.preceded)(hl,Ru),(e=>["Wildcard",["star"],["NCName",e]])),Na(Ia([fl],"Wildcard")),(0,Ca.map)((0,Ca.followed)(Uu,fl),(e=>["Wildcard",["uri",e],["star"]])),(0,Ca.map)((0,Ca.followed)(Ru,ll),(e=>["Wildcard",["NCName",e],["star"]]))]),w=(0,Ca.or)([b,(0,Ca.map)(zu,(e=>["nameTest",...e]))]),x=(0,Ca.or)([v,w]),S=(0,Ca.then)((0,Ca.optional)(ml),x,((e,t)=>null!==e||"attributeTest"===t[0]||"schemaAttributeTest"===t[0]?["stepExpr",["xpathAxis","attribute"],t]:["stepExpr",["xpathAxis","child"],t])),k=(0,Ca.or)([(0,Ca.then)(Gu,x,((e,t)=>["stepExpr",["xpathAxis",e],t])),S]),A=(0,Ca.map)(Il,(()=>["stepExpr",["xpathAxis","parent"],["anyKindTest"]])),C=(0,Ca.or)([(0,Ca.then)(Wu,x,((e,t)=>["stepExpr",["xpathAxis",e],t])),A]),_=(0,Ca.map)((0,Ca.star)((0,Ca.preceded)($u,c)),(e=>0<e.length?["predicates",...e]:void 0)),E=(0,Ca.then)((0,Ca.or)([C,k]),_,((e,t)=>void 0===t?e:e.concat([t]))),T=(0,Ca.or)([ld,(0,Ca.map)(u,(t=>["stringConstantExpr",["value",e.Za?Xd(t):t]]))]),P=(0,Ca.or)([(0,Ca.delimited)(Fa,Ea(l,$u),La),(0,Ca.map)((0,Ca.delimited)(Fa,$u,La),(()=>["sequenceExpr"]))]),$=(0,Ca.or)([a,ud]),N=(0,Ca.map)((0,Ca.delimited)(Fa,Ea((0,Ca.optional)((0,Ca.then)($,(0,Ca.star)((0,Ca.preceded)(Ea($l,$u),$)),((e,t)=>[e,...t]))),$u),La),(e=>null!==e?e:[])),I=(0,Ca.preceded)((0,Ca.not)(Pa(cd,$u,Fa,(()=>{})),["cannot use reserved keyword for function names"]),r((0,Ca.then)(zu,(0,Ca.preceded)($u,N),((e,t)=>{t=["functionCallExpr",["functionName",...e],null!==t?["arguments",...t]:["arguments"]];const n=e[0].prefix,i=e[0].URI;return e=e[1],t.Wa=n?`${n}:${e}`:i?`Q{${i}}${e}`:e,t})))),Q=(0,Ca.then)(zu,(0,Ca.preceded)(Ol,ad),((e,t)=>["namedFunctionRef",["functionName",...e],t])),R=(0,Ca.delimited)(za,Ea((0,Ca.optional)(l),$u),Za),M=(0,Ca.map)(R,(e=>e||["sequenceExpr"])),B=(0,Ca.or)([(0,Ca.map)(Su,(()=>[["voidSequenceType"]])),(0,Ca.then)(s,(0,Ca.optional)((0,Ca.preceded)($u,dd)),((e,t)=>[e,...null!==t?[["occurrenceIndicator",t]]:[]]))]),D=(0,Ca.then)(Ta([yl,$u],zu),(0,Ca.optional)((0,Ca.followed)((0,Ca.then)(Ta([Fa,$u],T),(0,Ca.star)(Ta([$l,$u],T)),((e,t)=>e.concat(t))),La)),((e,t)=>["annotation",["annotationName",...e],...t?["arguments",t]:[]])),X=(0,Ca.map)(Ta([Jl,$u,Fa,$u,fl,$u],La),(()=>["anyFunctionTest"])),F=(0,Ca.then)(Ta([Jl,$u,Fa,$u],(0,Ca.optional)(n(B,$l,((e,t)=>e.concat.apply(e,t.map((e=>e[1]))))))),Ta([$u,La,Nu,Ul,Nu],B),((e,t)=>["typedFunctionTest",["paramTypeList",["sequenceType",...e||[]]],["sequenceType",...t]])),L=(0,Ca.then)((0,Ca.star)(D),(0,Ca.or)([X,F]),((e,t)=>[t[0],...e,...t.slice(1)])),U=(0,Ca.map)(Ta([Kl,$u,Fa,$u,fl,$u],La),(()=>["anyMapTest"])),V=(0,Ca.then)(Ta([Kl,$u,Fa,$u],Vd),Ta([$u,$l],(0,Ca.followed)(Ea(B,$u),La)),((e,t)=>["typedMapTest",e,["sequenceType",...t]])),z=(0,Ca.or)([U,V]),Z=(0,Ca.map)(Ta([Dh,$u,Fa,$u,fl,$u],La),(()=>["anyArrayTest"])),j=(0,Ca.map)(Ta([Dh,$u,Fa],(0,Ca.followed)(Ea(B,$u),La)),(e=>["typedArrayTest",["sequenceType",...e]])),q=(0,Ca.or)([Z,j]),G=(0,Ca.map)((0,Ca.delimited)(Fa,Ea(s,$u),La),(e=>["parenthesizedItemType",e])),W=(0,Ca.or)([v,Na(Ia([xu],"anyItemType")),L,z,q,Vd,G]),H=(0,Ca.map)(Ta([Ul,Nu],B),(e=>["typeDeclaration",...e])),Y=(0,Ca.then)((0,Ca.preceded)(gl,zu),(0,Ca.optional)((0,Ca.preceded)(Nu,H)),((e,t)=>["param",["varName",...e],...t?[t]:[]])),J=n(Y,$l,((e,t)=>[e,...t.map((e=>e[1]))])),K=$a((0,Ca.star)(D),Ta([$u,Jl,$u,Fa,$u],(0,Ca.optional)(J)),Ta([$u,La,$u],(0,Ca.optional)((0,Ca.map)(Ta([Ul,$u],(0,Ca.followed)(B,$u)),(e=>["typeDeclaration",...e])))),M,((e,t,n,i)=>["inlineFunctionExpr",...e,["paramList",...t||[]],...n?[n]:[],["functionBody",i]])),ee=(0,Ca.or)([Q,K]),te=(0,Ca.map)(a,(e=>["mapKeyExpr",e])),ne=(0,Ca.map)(a,(e=>["mapValueExpr",e])),ie=(0,Ca.then)(te,(0,Ca.preceded)(Ea(dl,$u),ne),((e,t)=>["mapConstructorEntry",e,t])),re=(0,Ca.preceded)(Kl,(0,Ca.delimited)(Ea(za,$u),(0,Ca.map)((0,Ca.optional)(n(ie,Ea($l,$u),((e,t)=>[e,...t.map((e=>e[1]))]))),(e=>e?["mapConstructor",...e]:["mapConstructor"])),(0,Ca.preceded)($u,Za))),se=(0,Ca.map)((0,Ca.delimited)(Ua,Ea((0,Ca.optional)(n(a,$l,((e,t)=>[e,...t.map((e=>e[1]))].map((e=>["arrayElem",e]))))),$u),Va),(e=>["squareArray",...null!==e?e:[]])),oe=(0,Ca.map)((0,Ca.preceded)(Dh,(0,Ca.preceded)($u,R)),(e=>["curlyArray",...null!==e?[["arrayElem",e]]:[]])),ae=(0,Ca.map)((0,Ca.or)([se,oe]),(e=>["arrayConstructor",e])),le=(0,Ca.or)([Ru,ad,P,fl]),he=(0,Ca.map)((0,Ca.preceded)(vl,(0,Ca.preceded)($u,le)),(e=>"*"===e?["unaryLookup",["star"]]:"string"==typeof e?["unaryLookup",["NCName",e]]:["unaryLookup",e])),ce=(0,Ca.or)([Hu,Yu,Ia([ja],"{"),Ia([qa],"}"),(0,Ca.map)(R,(e=>e||["sequenceExpr"]))]),ue=(0,Ca.or)([fd,function(e,t){return ye(e,t)},ce,pd]),de=(0,Ca.or)([(0,Ca.map)(md,(e=>e.replace(/[\x20\x0D\x0A\x09]/g," "))),ce]),pe=(0,Ca.or)([(0,Ca.map)(gd,(e=>e.replace(/[\x20\x0D\x0A\x09]/g," "))),ce]),fe=(0,Ca.map)((0,Ca.or)([Ea((0,Ca.star)((0,Ca.or)([Ju,de])),Ha),Ea((0,Ca.star)((0,Ca.or)([Ku,pe])),Ga)]),(e=>Fd(e,!1,!1))),me=(0,Ca.then)(Lu,(0,Ca.preceded)(Ea(bl,(0,Ca.optional)(Pu)),fe),((e,t)=>{if(""===e[0].prefix&&"xmlns"===e[1]){if(t.length&&"string"!=typeof t[0])throw Error("XQST0022: A namespace declaration may not contain enclosed expressions");return["namespaceDeclaration",t.length?["uri",t[0]]:["uri"]]}if("xmlns"===e[0].prefix){if(t.length&&"string"!=typeof t[0])throw Error("XQST0022: The namespace declaration for 'xmlns:"+e[1]+"' may not contain enclosed expressions");return["namespaceDeclaration",["prefix",e[1]],t.length?["uri",t[0]]:["uri"]]}return["attributeConstructor",["attributeName"].concat(e),0===t.length?["attributeValue"]:1===t.length&&"string"==typeof t[0]?["attributeValue",t[0]]:["attributeValueExpr"].concat(t)]})),ge=(0,Ca.map)((0,Ca.star)((0,Ca.preceded)(Pu,(0,Ca.optional)(me))),(e=>e.filter(Boolean))),Oe=Pa((0,Ca.preceded)(Al,Lu),ge,(0,Ca.or)([(0,Ca.map)(el,(()=>null)),(0,Ca.then)((0,Ca.preceded)(El,(0,Ca.star)(ue)),Ta([$u,tl],(0,Ca.followed)(Lu,(0,Ca.then)((0,Ca.optional)(Pu),El,(()=>null)))),((e,t)=>[Fd(e,!0,!0),t]))]),((e,t,n)=>{var i=n;if(n&&n.length){i=Ld(e);const t=Ld(n[1]);if(i!==t)throw Error('XQST0118: The start and the end tag of an element constructor must be equal. "'+i+'" does not match "'+t+'"');i=n[0]}return["elementConstructor",["tagName",...e],...t.length?[["attributeList",...t]]:[],...i&&i.length?[["elementContent",...i]]:[]]})),ye=(0,Ca.or)([Oe,yd,wd]),ve=(0,Ca.map)(Ta([Xh,$u],R),(e=>["computedDocumentConstructor",...e?[["argExpr",e]]:[]])),be=(0,Ca.map)(R,(e=>e?[["contentExpr",e]]:[])),we=(0,Ca.then)(Ta([eh,$u],(0,Ca.or)([(0,Ca.map)(zu,(e=>["tagName",...e])),(0,Ca.map)((0,Ca.delimited)(za,Ea(l,$u),Za),(e=>["tagNameExpr",e]))])),(0,Ca.preceded)($u,be),((e,t)=>["computedElementConstructor",e,...t])),xe=(0,Ca.then)((0,Ca.preceded)(th,(0,Ca.or)([(0,Ca.map)(Ta([qu,$u],zu),(e=>["tagName",...e])),(0,Ca.map)((0,Ca.preceded)($u,(0,Ca.delimited)(za,Ea(l,$u),Za)),(e=>["tagNameExpr",e]))])),(0,Ca.preceded)($u,R),((e,t)=>["computedAttributeConstructor",e,["valueExpr",t||["sequenceExpr"]]])),Se=(0,Ca.map)(R,(e=>e?[["prefixExpr",e]]:[])),ke=(0,Ca.map)(R,(e=>e?[["URIExpr",e]]:[])),Ae=(0,Ca.then)(Ta([Fh,$u],(0,Ca.or)([Mu,Se])),(0,Ca.preceded)($u,ke),((e,t)=>["computedNamespaceConstructor",...e,...t])),Ce=(0,Ca.map)(Ta([Lh,$u],R),(e=>["computedTextConstructor",...e?[["argExpr",e]]:[]])),_e=(0,Ca.map)(Ta([Uh,$u],R),(e=>["computedCommentConstructor",...e?[["argExpr",e]]:[]])),Ee=Ta([Vh,$u],(0,Ca.then)((0,Ca.or)([(0,Ca.map)(Ru,(e=>["piTarget",e])),(0,Ca.map)((0,Ca.delimited)(za,Ea(l,$u),Za),(e=>["piTargetExpr",e]))]),(0,Ca.preceded)($u,R),((e,t)=>["computedPIConstructor",e,...t?[["piValueExpr",t]]:[]]))),Te=(0,Ca.or)([ve,we,xe,Ae,Ce,_e,Ee]),Pe=(0,Ca.or)([ye,Te]),$e=(0,Ca.or)([T,ju,P,hd,I,Pe,ee,re,ae,he]),Ne=(0,Ca.map)(Ta([vl,$u],le),(e=>"*"===e?["lookup",["star"]]:"string"==typeof e?["lookup",["NCName",e]]:["lookup",e])),Ie=(0,Ca.then)((0,Ca.map)($e,(e=>Bd(e))),(0,Ca.star)((0,Ca.or)([(0,Ca.map)((0,Ca.preceded)($u,c),(e=>["predicate",e])),(0,Ca.map)((0,Ca.preceded)($u,N),(e=>["argumentList",e])),(0,Ca.preceded)($u,Ne)])),((e,t)=>{function n(){a&&1===s.length?o.push(["predicate",s[0]]):0!==s.length&&o.push(["predicates",...s]),s.length=0}function i(e){n(),0!==o.length?("sequenceExpr"===r[0][0]&&2<r[0].length&&(r=[["sequenceExpr",...r]]),r=[["filterExpr",...r],...o],o.length=0):e&&(r=[["filterExpr",...r]])}let r=[e];const s=[],o=[];let a=!1;for(const e of t)switch(e[0]){case"predicate":s.push(e[1]);break;case"lookup":a=!0,n(),o.push(e);break;case"argumentList":i(!1),1<r.length&&(r=[["sequenceExpr",["pathExpr",["stepExpr",...r]]]]),r=[["dynamicFunctionInvocationExpr",["functionItem",...r],...e[1].length?[["arguments",...e[1]]]:[]]];break;default:throw Error("unreachable")}return i(!0),r})),Qe=(0,Ca.or)([(0,Ca.map)(Ie,(e=>["stepExpr",...e])),E]),Re=(0,Ca.followed)($e,(0,Ca.peek)((0,Ca.not)((0,Ca.preceded)($u,(0,Ca.or)([c,N,Ne])),["primary expression not followed by predicate, argumentList, or lookup"]))),Me=(0,Ca.or)([Pa(Qe,(0,Ca.preceded)($u,xd),(0,Ca.preceded)($u,o),((e,t,n)=>["pathExpr",e,t,...n])),(0,Ca.then)(Qe,(0,Ca.preceded)(Ea(Ml,$u),o),((e,t)=>["pathExpr",e,...t])),Re,(0,Ca.map)(Qe,(e=>["pathExpr",e]))]),Be=(0,Ca.or)([Pa(Qe,(0,Ca.preceded)($u,xd),(0,Ca.preceded)($u,o),((e,t,n)=>[e,t,...n])),(0,Ca.then)(Qe,(0,Ca.preceded)(Ea(Ml,$u),o),((e,t)=>[e,...t])),(0,Ca.map)(Qe,(e=>[e]))]),De=(0,Ca.or)([(0,Ca.map)(Ta([Ml,$u],Be),(e=>["pathExpr",["rootExpr"],...e])),(0,Ca.then)(xd,(0,Ca.preceded)($u,Be),((e,t)=>["pathExpr",["rootExpr"],e,...t])),(0,Ca.map)((0,Ca.followed)(Ml,(0,Ca.not)((0,Ca.preceded)($u,e.Za?Qa(/[*<a-zA-Z]/):Qa(/[*a-zA-Z]/)),["Single rootExpr cannot be by followed by something that can be interpreted as a relative path"])),(()=>["pathExpr",["rootExpr"]]))]),Xe=_a((0,Ca.or)([Me,De]),zd),Fe=(0,Ca.preceded)(jh,(0,Ca.then)((0,Ca.optional)((0,Ca.or)([(0,Ca.map)((0,Ca.preceded)($u,Sd),(e=>["validationMode",e])),(0,Ca.map)(Ta([$u,qh,$u],zu),(e=>["type",...e]))])),(0,Ca.delimited)((0,Ca.preceded)($u,za),Ea(l,$u),Za),((e,t)=>["validateExpr",...e?[e]:[],["argExpr",t]]))),Le=(0,Ca.delimited)(Da,(0,Ca.then)((0,Ca.preceded)($u,zu),(0,Ca.optional)((0,Ca.preceded)(Nu,kd)),((e,t)=>t?["pragma",["pragmaName",e],["pragmaContents",t]]:["pragma",["pragmaName",e]])),(0,Ca.preceded)($u,Xa)),Ue=(0,Ca.map)((0,Ca.followed)((0,Ca.plus)(Le),(0,Ca.preceded)($u,(0,Ca.delimited)(za,Ea((0,Ca.optional)(l),$u),Za))),(e=>["extensionExpr",...e])),Ve=r(n(Xe,wl,((e,t)=>0===t.length?e:["simpleMapExpr","pathExpr"===e[0]?e:["pathExpr",["stepExpr",["filterExpr",Bd(e)]]]].concat(t.map((e=>"pathExpr"===(e=e[1])[0]?e:["pathExpr",["stepExpr",["filterExpr",Bd(e)]]])))))),ze=(0,Ca.or)([Fe,Ue,Ve]),Ze=(0,Ca.or)([(0,Ca.then)((0,Ca.or)([Ia([Rl],"unaryMinusOp"),Ia([Ql],"unaryPlusOp")]),(0,Ca.preceded)($u,(function(e,t){return Ze(e,t)})),((e,t)=>[e,["operand",t]])),ze]),je=(0,Ca.or)([(0,Ca.map)(zu,(e=>["EQName",...e])),ju,P]),qe=(0,Ca.then)(Ze,(0,Ca.star)(Ta([$u,Dl,$u],(0,Ca.then)(je,(0,Ca.preceded)($u,N),((e,t)=>[e,t])))),((e,t)=>t.reduce(((e,t)=>["arrowExpr",["argExpr",e],t[0],["arguments",...t[1]]]),e))),Ge=(0,Ca.then)(qe,(0,Ca.optional)(Ta([$u,Vl,Nu,Ul,qu,$u],Ud)),((e,t)=>null!==t?["castExpr",["argExpr",e],t]:e)),We=(0,Ca.then)(Ge,(0,Ca.optional)(Ta([$u,zl,Nu,Ul,qu,$u],Ud)),((e,t)=>null!==t?["castableExpr",["argExpr",e],t]:e)),He=(0,Ca.then)(We,(0,Ca.optional)(Ta([$u,Zl,Nu,Ul,qu,$u],B)),((e,t)=>null!==t?["treatExpr",["argExpr",e],["sequenceType",...t]]:e)),Ye=(0,Ca.then)(He,(0,Ca.optional)(Ta([$u,jl,Nu,ql,qu,$u],B)),((e,t)=>null!==t?["instanceOfExpr",["argExpr",e],["sequenceType",...t]]:e)),Je=n(Ye,(0,Ca.followed)((0,Ca.or)([Ia([ih],"intersectOp"),Ia([rh],"exceptOp")]),qu),t),Ke=n(Je,(0,Ca.or)([Ia([xl],"unionOp"),(0,Ca.followed)(Ia([sh],"unionOp"),qu)]),t),et=n(Ke,(0,Ca.or)([Ia([fl],"multiplyOp"),(0,Ca.followed)(Ia([ch],"divOp"),qu),(0,Ca.followed)(Ia([uh],"idivOp"),qu),(0,Ca.followed)(Ia([dh],"modOp"),qu)]),t),tt=n(et,(0,Ca.or)([Ia([Rl],"subtractOp"),Ia([Ql],"addOp")]),t),nt=n(i(tt,(0,Ca.followed)(Ia([oh],"rangeSequenceExpr"),qu),"startExpr","endExpr"),Ia([Sl],"stringConcatenateOp"),t),it=n(i(nt,(0,Ca.or)([Ad,Cd,_d])),(0,Ca.followed)(Ia([hh],"andOp"),qu),t),rt=n(it,(0,Ca.followed)(Ia([lh],"orOp"),qu),t),st=r((0,Ca.map)(l,(e=>["ifClause",e]))),ot=r((0,Ca.map)(a,(e=>["thenClause",e]))),at=r((0,Ca.map)(a,(e=>["elseClause",e]))),lt=(0,Ca.then)((0,Ca.then)(Ta([xh,$u,Fa,$u],st),Ta([$u,La,$u,Sh,qu,$u],ot),((e,t)=>[e,t])),Ta([$u,kh,qu,$u],at),((e,t)=>["ifThenElseExpr",e[0],e[1],t])),ht=(0,Ca.delimited)(Ah,Nu,Ch),ct=(0,Ca.map)(Ta([_h,Nu,gl],zu),(e=>["positionalVariableBinding",...e])),ut=function(e,t,n,i,r,s){return(0,Ca.then)((0,Ca.then)((0,Ca.then)((0,Ca.then)(e,t,((e,t)=>[e,t])),n,(([e,t],n)=>[e,t,n])),i,(([e,t,n],i)=>[e,t,n,i])),r,(([e,t,n,i],r)=>s(e,t,n,i,r)))}((0,Ca.preceded)(gl,(0,Ca.cut)(zu)),(0,Ca.cut)((0,Ca.preceded)($u,(0,Ca.optional)(H))),(0,Ca.cut)((0,Ca.preceded)($u,(0,Ca.optional)(ht))),(0,Ca.cut)((0,Ca.preceded)($u,(0,Ca.optional)(ct))),(0,Ca.cut)((0,Ca.preceded)(Ea(Eh,$u),a)),((e,t,n,i,r)=>["forClauseItem",["typedVariableBinding",["varName",...e,...t?[t]:[]]],...n?[["allowingEmpty"]]:[],...i?[i]:[],["forExpr",r]])),dt=Ta([Th,Nu],n(ut,$l,((e,t)=>["forClause",e,...t.map((e=>e[1]))]))),pt=Pa((0,Ca.preceded)(gl,zu),(0,Ca.preceded)($u,(0,Ca.optional)(H)),(0,Ca.preceded)(Ea(cl,$u),a),((e,t,n)=>["letClauseItem",["typedVariableBinding",["varName",...e],...t?[t]:[]],["letExpr",n]])),ft=(0,Ca.map)(Ta([Ph,$u],n(pt,$l,((e,t)=>[e,...t.map((e=>e[1]))]))),(e=>["letClause",...e])),mt=(0,Ca.or)([dt,ft]),gt=(0,Ca.map)(Ta([$h,qu,$u],a),(e=>["whereClause",e])),Ot=(0,Ca.map)((0,Ca.preceded)(gl,zu),(e=>["varName",...e])),yt=(0,Ca.then)((0,Ca.preceded)($u,(0,Ca.optional)(H)),(0,Ca.preceded)(Ea(cl,$u),a),((e,t)=>["groupVarInitialize",...e?[["typeDeclaration",...e]]:[],["varValue",t]])),vt=Pa(Ot,(0,Ca.optional)(yt),(0,Ca.optional)((0,Ca.map)((0,Ca.preceded)(Ea(Nh,$u),u),(e=>["collation",e]))),((e,t,n)=>["groupingSpec",e,...t?[t]:[],...n?[n]:[]])),bt=n(vt,$l,((e,t)=>[e,...t.map((e=>e[1]))])),wt=(0,Ca.map)(Ta([Ih,Nu,Qh,$u],bt),(e=>["groupByClause",...e])),xt=Pa((0,Ca.optional)((0,Ca.or)([Vc,zc])),(0,Ca.optional)(Ta([$u,Ch,$u],(0,Ca.or)([nc,ic].map((e=>(0,Ca.map)(e,(e=>"empty "+e))))))),(0,Ca.preceded)($u,(0,Ca.optional)(Ta([Nh,$u],u))),((e,t,n)=>e||t||n?["orderModifier",...e?[["orderingKind",e]]:[],...t?[["emptyOrderingMode",t]]:[],...n?[["collation",n]]:[]]:null)),St=(0,Ca.then)(a,(0,Ca.preceded)($u,xt),((e,t)=>["orderBySpec",["orderByExpr",e],...t?[t]:[]])),kt=n(St,$l,((e,t)=>[e,...t.map((e=>e[1]))])),At=(0,Ca.then)((0,Ca.or)([(0,Ca.map)(Ta([Rh,Nu],Qh),(()=>!1)),(0,Ca.map)(Ta([Mh,Nu,Rh,Nu],Qh),(()=>!0))]),(0,Ca.preceded)($u,kt),((e,t)=>["orderByClause",...e?[["stable"]]:[],...t])),Ct=(0,Ca.or)([mt,gt,wt,At]),_t=(0,Ca.map)(Ta([Bh,$u],a),(e=>["returnClause",e])),Et=Pa(mt,(0,Ca.cut)((0,Ca.star)((0,Ca.preceded)($u,Ct))),(0,Ca.cut)((0,Ca.preceded)($u,_t)),((e,t,n)=>["flworExpr",e,...t,n])),Tt=n(B,xl,((e,t)=>0===t.length?["sequenceType",...e]:["sequenceTypeUnion",["sequenceType",...e],...t.map((e=>["sequenceType",...e[1]]))])),Pt=Pa(Ta([oc,$u],(0,Ca.optional)((0,Ca.preceded)(gl,(0,Ca.followed)((0,Ca.followed)(zu,Nu),Ul)))),(0,Ca.preceded)($u,Tt),Ta([Nu,Bh,Nu],a),((e,t,n)=>["typeswitchExprCaseClause"].concat(e?[["variableBinding",...e]]:[],[t],[["resultExpr",n]]))),$t=$a((0,Ca.preceded)(ac,Ea((0,Ca.delimited)(Fa,Ea(l,$u),La),$u)),(0,Ca.plus)((0,Ca.followed)(Pt,$u)),Ta([Wh,Nu],(0,Ca.optional)((0,Ca.preceded)(gl,(0,Ca.followed)(zu,Nu)))),Ta([Bh,Nu],a),((e,t,n,i)=>["typeswitchExpr",["argExpr",e],...t,["typeswitchExprDefaultClause",...n||[],["resultExpr",i]]])),Nt=Pa((0,Ca.preceded)(gl,zu),(0,Ca.optional)((0,Ca.preceded)(Nu,H)),(0,Ca.preceded)(Ea(Eh,Nu),a),((e,t,n)=>["quantifiedExprInClause",["typedVariableBinding",["varName",...e],...t?[t]:[]],["sourceExpr",n]])),It=n(Nt,$l,((e,t)=>[e,...t.map((e=>e[1]))])),Qt=Pa((0,Ca.or)([lc,hc]),(0,Ca.preceded)(Nu,It),(0,Ca.preceded)(Ea(cc,$u),a),((e,t,n)=>["quantifiedExpr",["quantifier",e],...t,["predicateExpr",n]])),Rt=(0,Ca.map)(Ta([Hl,Nu,(0,Ca.or)([Wl,Gl]),Nu],a),(e=>["deleteExpr",["targetExpr",e]])),Mt=Pa(Ta([uc,Nu],(0,Ca.optional)(Ta([Yl,Nu,ql],Nu))),Ta([Gl,Nu],a),(0,Ca.preceded)(Ea(dc,Nu),a),((e,t,n)=>e?["replaceExpr",["replaceValue"],["targetExpr",t],["replacementExpr",n]]:["replaceExpr",["targetExpr",t],["replacementExpr",n]])),Bt=(0,Ca.then)(ju,(0,Ca.preceded)(Ea(cl,$u),a),((e,t)=>["transformCopy",e,["copySource",t]])),Dt=Pa(Ta([pc,Nu],n(Bt,$l,((e,t)=>[e,...t.map((e=>e[1]))]))),Ta([$u,fc,Nu],a),(0,Ca.preceded)(Ea(Bh,Nu),a),((e,t,n)=>["transformExpr",["transformCopies",...e],["modifyExpr",t],["returnExpr",n]])),Xt=(0,Ca.or)([(0,Ca.followed)((0,Ca.map)((0,Ca.optional)((0,Ca.followed)(Ta([Ul,Nu],(0,Ca.or)([(0,Ca.map)(mc,(()=>["insertAsFirst"])),(0,Ca.map)(gc,(()=>["insertAsLast"]))])),Nu)),(e=>e?["insertInto",e]:["insertInto"])),vc),(0,Ca.map)(yc,(()=>["insertAfter"])),(0,Ca.map)(Oc,(()=>["insertBefore"]))]),Ft=Pa(Ta([bc,Nu,(0,Ca.or)([Wl,Gl]),Nu],a),(0,Ca.preceded)(Nu,Xt),(0,Ca.preceded)(Nu,a),((e,t,n)=>["insertExpr",["sourceExpr",e],t,["targetExpr",n]])),Lt=(0,Ca.then)(Ta([wc,Nu,Gl,$u],a),Ta([Nu,Ul,Nu],a),((e,t)=>["renameExpr",["targetExpr",e],["newNameExpr",t]])),Ut=(0,Ca.then)((0,Ca.plus)((0,Ca.then)((0,Ca.map)(Ta([oc,Nu],(0,Ca.cut)(a)),(e=>["switchCaseExpr",e])),(0,Ca.cut)(Nu),(e=>e))),(0,Ca.cut)(Ta([Bh,Nu],(0,Ca.cut)(a))),((e,t)=>["switchExprCaseClause",...e,["resultExpr",t]])),Vt=Pa(Ta([xc,$u,Fa],(0,Ca.cut)(l)),(0,Ca.cut)(Ta([$u,La,(0,Ca.cut)($u)],(0,Ca.plus)((0,Ca.followed)(Ut,$u)))),(0,Ca.cut)(Ta([Wh,Nu,Bh,Nu],a)),((e,t,n)=>["switchExpr",["argExpr",e],...t,["switchExprDefaultClause",["resultExpr",n]]])),zt=(0,Ca.map)(l,(e=>["queryBody",e])),Zt=Ta([Gh,Nu,Fh,Nu],(0,Ca.cut)((0,Ca.then)(Ru,(0,Ca.preceded)(Ea(bl,$u),u),((e,t)=>["namespaceDecl",["prefix",e],["uri",t]])))),jt=(0,Ca.then)(Ta([Sc,Nu,gl,$u],(0,Ca.then)(zu,(0,Ca.optional)((0,Ca.preceded)($u,H)),((e,t)=>[e,t]))),(0,Ca.cut)((0,Ca.or)([(0,Ca.map)(Ta([$u,cl,$u],a),(e=>["varValue",e])),(0,Ca.map)(Ta([Nu,kc],(0,Ca.optional)(Ta([$u,cl,$u],a))),(e=>["external",...e?[["varValue",e]]:[]]))])),(([e,t],n)=>["varDecl",["varName",...e],...null!==t?[t]:[],n])),qt=$a(Ta([Jl,Nu,(0,Ca.cut)((0,Ca.peek)((0,Ca.not)((0,Ca.followed)(cd,(0,Ca.not)(dl,[""])),["Cannot use reserved function name"])))],zu),(0,Ca.cut)(Ta([$u,Fa,$u],(0,Ca.optional)(J))),(0,Ca.cut)(Ta([$u,La],(0,Ca.optional)(Ta([Nu,Ul,Nu],B)))),(0,Ca.cut)((0,Ca.preceded)($u,(0,Ca.or)([(0,Ca.map)(M,(e=>["functionBody",e])),(0,Ca.map)(kc,(()=>["externalDefinition"]))]))),((e,t,n,i)=>["functionDecl",["functionName",...e],["paramList",...t||[]],...n?[["typeDeclaration",...n]]:[],i])),Gt=Ta([Gh,Nu],(0,Ca.then)((0,Ca.star)((0,Ca.followed)((0,Ca.or)([D,Ed]),Nu)),(0,Ca.or)([jt,qt]),((e,t)=>[t[0],...e,...t.slice(1)]))),Wt=(0,Ca.then)(Ta([Gh,Nu,Wh,Nu],(0,Ca.or)([eh,Jl])),Ta([Nu,Fh,Nu],u),((e,t)=>["defaultNamespaceDecl",["defaultNamespaceCategory",e],["uri",t]])),Ht=(0,Ca.or)([(0,Ca.map)((0,Ca.followed)(Ta([Fh,Nu],Ru),(0,Ca.preceded)($u,bl)),(e=>["namespacePrefix",e])),(0,Ca.map)(Ta([Wh,Nu,eh,Nu],Fh),(()=>["defaultElementNamespace"]))]),Yt=Ta([Cc,Nu,_c],Pa((0,Ca.optional)((0,Ca.preceded)(Nu,Ht)),(0,Ca.preceded)($u,u),(0,Ca.optional)((0,Ca.then)(Ta([Nu,_h,Nu],u),(0,Ca.star)(Ta([$u,$l,$u],u)),((e,t)=>[e,...t]))),((e,t,n)=>["schemaImport",...e?[e]:[],["targetNamespace",t],...n?[n]:[]]))),Jt=Ta([Cc,Nu,Ec],Pa((0,Ca.optional)((0,Ca.followed)(Ta([Nu,Fh,Nu],Ru),(0,Ca.preceded)($u,bl))),(0,Ca.preceded)($u,u),(0,Ca.optional)((0,Ca.then)(Ta([Nu,_h,Nu],u),(0,Ca.star)(Ta([$u,$l,$u],u)),((e,t)=>[e,...t]))),((e,t)=>["moduleImport",["namespacePrefix",e],["targetNamespace",t]]))),Kt=(0,Ca.or)([Yt,Jt]),en=(0,Ca.map)(Ta([Gh,Nu,Wh,Nu,Nh,Nu],u),(e=>["defaultCollationDecl",e])),tn=(0,Ca.map)(Ta([Gh,Nu,Tc,Nu],u),(e=>["baseUriDecl",e])),nn=(0,Ca.then)(Ta([Gh,Nu],(0,Ca.or)([(0,Ca.map)(Ta([sc,Nu],zu),(e=>["decimalFormatName",...e])),(0,Ca.map)(Ta([Wh,Nu],sc),(()=>null))])),(0,Ca.star)((0,Ca.then)((0,Ca.preceded)(Nu,$d),(0,Ca.preceded)(Ea(bl,Nu),u),((e,t)=>["decimalFormatParam",["decimalFormatParamName",e],["decimalFormatParamValue",t]]))),((e,t)=>["decimalFormatDecl",...e?[e]:[],...t])),rn=(0,Ca.or)([Nd,en,tn,Id,Qd,Rd,Md,nn]),sn=(0,Ca.then)(Ta([Gh,Nu,Qc,Nu],zu),(0,Ca.preceded)(Nu,u),((e,t)=>["optionDecl",["optionName",e],["optionContents",t]])),on=(0,Ca.then)(Ta([Gh,Nu,Rc,Nu,Mc],(0,Ca.optional)(Ta([Nu,Ul],W))),(0,Ca.or)([(0,Ca.map)((0,Ca.preceded)(Ea(cl,$u),a),(e=>["varValue",e])),(0,Ca.map)(Ta([Nu,kc],(0,Ca.optional)((0,Ca.preceded)(Ea(cl,$u),a))),(()=>["external"]))]),((e,t)=>["contextItemDecl",...e?[["contextItemType",e]]:[],t])),an=(0,Ca.then)((0,Ca.star)((0,Ca.followed)((0,Ca.or)([Wt,rn,Zt,Kt]),(0,Ca.cut)(Ea(pl,$u)))),(0,Ca.star)((0,Ca.followed)((0,Ca.or)([on,Gt,sn]),(0,Ca.cut)(Ea(pl,$u)))),((e,t)=>0===e.length&&0===t.length?null:["prolog",...e,...t])),ln=Ta([Ec,Nu,Fh,Nu],(0,Ca.then)((0,Ca.followed)(Ru,Ea(bl,$u)),(0,Ca.followed)(u,Ea(pl,$u)),((e,t)=>["moduleDecl",["prefix",e],["uri",t]]))),hn=(0,Ca.then)(ln,(0,Ca.preceded)($u,an),((e,t)=>["libraryModule",e,...t?[t]:[]])),cn=(0,Ca.then)(an,(0,Ca.preceded)($u,zt),((e,t)=>["mainModule",...e?[e]:[],t])),un=(0,Ca.map)(Ta([Bc,$u],(0,Ca.followed)((0,Ca.or)([(0,Ca.then)((0,Ca.preceded)(Xc,Nu),u,(e=>["encoding",e])),(0,Ca.then)(Ta([Dc,Nu],u),(0,Ca.optional)(Ta([Nu,Xc,Nu],u)),((e,t)=>[["version",e],...t?[["encoding",t]]:[]]))]),(0,Ca.preceded)($u,pl))),(e=>["versionDecl",...e])),dn=(0,Ca.then)((0,Ca.optional)(Ea(un,$u)),(0,Ca.or)([hn,cn]),((e,t)=>["module",...e?[e]:[],t])),pn=(0,Ca.complete)(Ea(dn,$u));return(e,t)=>{h.clear(),t=pn(e,t);let n=1,i=1;for(let t=0;t<e.length+1;t++){if(h.has(t)){const e=h.get(t);e.line=i,e.ha=n}"\n"===e[t]?(i++,n=1):n++}return t}}const jd=Zd({mb:!1,Za:!1}),qd=Zd({mb:!0,Za:!1}),Gd=Zd({mb:!1,Za:!0}),Wd=Zd({mb:!0,Za:!0});function Hd(e,t){var n=!!t.Z;if(t=!!t.debug,ku.clear(),Au.clear(),zd.clear(),!0===(n=n?t?Wd(e,0):Gd(e,0):t?qd(e,0):jd(e,0)).success)return n.value;throw t=(e=e.substring(0,n.offset).split("\n"))[e.length-1].length+1,new bs({start:{offset:n.offset,line:e.length,ha:t},end:{offset:n.offset+1,line:e.length,ha:t+1}},"","",Error(`XPST0003: Failed to parse script. Expected ${[...new Set(n.expected)]}`))}const Yd="http://www.w3.org/XML/1998/namespace http://www.w3.org/2001/XMLSchema http://www.w3.org/2001/XMLSchema-instance http://www.w3.org/2005/xpath-functions http://www.w3.org/2005/xpath-functions/math http://www.w3.org/2012/xquery http://www.w3.org/2005/xpath-functions/array http://www.w3.org/2005/xpath-functions/map".split(" ");function Jd(e,t,n,i){const r=[],s=[];Ar(e,"*").forEach((e=>{switch(e[0]){case"moduleImport":case"namespaceDecl":case"defaultNamespaceDecl":case"functionDecl":case"varDecl":break;default:throw Error("Not implemented: only module imports, namespace declarations, and function declarations are implemented in XQuery modules")}}));const o=new Set;Ar(e,"moduleImport").forEach((e=>{const n=xr(wr(e,"namespacePrefix"));if(e=xr(wr(e,"targetNamespace")),o.has(e))throw Error(`XQST0047: The namespace "${e}" is imported more than once.`);o.add(e),gr(t,n,e)})),Ar(e,"namespaceDecl").forEach((e=>{const n=xr(wr(e,"prefix"));if(e=xr(wr(e,"uri")),"xml"===n||"xmlns"===n)throw lr();if("http://www.w3.org/XML/1998/namespace"===e||"http://www.w3.org/2000/xmlns/"===e)throw lr();gr(t,n,e)}));let a=null,l=null;for(const t of Ar(e,"defaultNamespaceDecl")){const e=xr(wr(t,"defaultNamespaceCategory")),n=xr(wr(t,"uri"));if(!n)throw or();if("http://www.w3.org/XML/1998/namespace"===n||"http://www.w3.org/2000/xmlns/"===n)throw lr();if("function"===e){if(a)throw ar();a=n}else if("element"===e){if(l)throw ar();l=n}}a&&(t.v=a),l&&gr(t,"",l),Ar(e,"functionDecl").forEach((e=>{!function(e,t,n,i,r){var s=wr(e,"functionName"),o=Sr(s,"prefix")||"";let a=Sr(s,"URI");const l=xr(s);if(null===a&&(a=""===o?null===t.v?"http://www.w3.org/2005/xpath-functions":t.v:t.$(o),!a&&o))throw cr(o);if(Yd.includes(a))throw rr();if(o=Ar(e,"annotation").map((e=>wr(e,"annotationName"))),s=o.every((e=>!Sr(e,"URI")&&"private"!==xr(e))),o=o.some((e=>!Sr(e,"URI")&&"updating"===xr(e))),!a)throw or();const h=_r(e),c=Ar(wr(e,"paramList"),"param"),u=c.map((e=>wr(e,"varName"))),d=c.map((e=>_r(e)));if(e=wr(e,"functionBody")){if(t.va(a,l,d.length))throw sr(a,l);if(!r)return;const c=ga(e[1],{sa:!1,Z:!0}),p=new br(t),f=u.map((e=>{let n=Sr(e,"URI");const i=Sr(e,"prefix");return e=xr(e),i&&null===n&&(n=t.$(i||"")),Or(p,n,e)}));r=o?{j:d,arity:u.length,callFunction:(e,t,n,...i)=>(e=qe(Ue(e,-1,null,D.empty()),f.reduce(((e,t,n)=>(e[t]=X(i[n]),e)),Object.create(null))),c.s(e,t)),wb:!1,I:!0,cb:s,localName:l,namespaceURI:a,i:h}:{j:d,arity:u.length,callFunction:(e,t,n,...i)=>(e=qe(Ue(e,-1,null,D.empty()),f.reduce(((e,t,n)=>(e[t]=X(i[n]),e)),Object.create(null))),ei(c,e,t)),wb:!1,I:!1,cb:s,localName:l,namespaceURI:a,i:h},n.push({ba:c,Eb:p}),i.push({arity:u.length,ba:c,Ab:r,localName:l,namespaceURI:a,cb:s})}else{if(o)throw Error("Updating external function declarations are not supported");r={j:d,arity:u.length,callFunction:(e,t,n,...i)=>{const r=n.va(a,l,u.length,!0);if(!r)throw Error(`XPST0017: Function Q{${a}}${l} with arity of ${u.length} not registered. ${Yi(l)}`);if(r.i.type!==h.type||r.j.some(((e,t)=>e.type!==d[t].type)))throw Error("External function declaration types do not match actual function");return r.callFunction(e,t,n,...i)},wb:!0,I:!1,localName:l,namespaceURI:a,cb:s,i:h}}mr(t,a,l,u.length,r)}(e,t,r,s,n)}));const h=[];return Ar(e,"varDecl").forEach((e=>{const i=Cr(wr(e,"varName"));let s=i.namespaceURI;if(null===s&&(s=t.$(i.prefix),!s&&i.prefix))throw cr(i.prefix);if(Yd.includes(s))throw rr();var o=wr(e,"external");let a,l;if(e=wr(e,"varValue"),null!==o?null!==(o=wr(o,"varValue"))&&(a=wr(o,"*")):null!==e&&(a=wr(e,"*")),h.some((e=>e.namespaceURI===s&&e.localName===i.localName)))throw Error(`XQST0049: The variable ${s?`Q{${s}}`:""}${i.localName} has already been declared.`);if(Or(t,s||"",i.localName),n&&(a&&(l=ga(a,{sa:!1,Z:!0})),a&&!function(e,t,n){return(e=e.Ea[ur(t,n)])?e:null}(t,s||"",i.localName))){let e=null;yr(t,s,i.localName,((t,n)=>(e||(e=X(ei(l,t,n))),e()))),r.push({ba:l,Eb:new br(t)}),h.push({ba:l,localName:i.localName,namespaceURI:s})}})),s.forEach((e=>{if(!e.Ab.I&&e.ba.I)throw Vn(`The function Q{${e.namespaceURI}}${e.localName} is updating but the %updating annotation is missing.`)})),{Ia:s.map((e=>e.Ab)),Ta:h,source:i,pa:e=>{o.forEach((e=>{Sa(t,e)})),r.forEach((({ba:t,Eb:n})=>{o.forEach((e=>{Sa(n,e)})),e.Ia.forEach((e=>{n.va(e.namespaceURI,e.localName,e.arity,!0)||e.cb&&mr(n,e.namespaceURI,e.localName,e.arity,e)})),e.Ta.forEach((e=>{n.eb(e.namespaceURI,e.localName)||Or(n,e.namespaceURI,e.localName)})),t.v(n)}))}}}function Kd(e,t,n,i,r,s,o){const a=t.Z?"XQuery":"XPath";return n=t.Ha?null:function(e,t,n,i,r,s,o,a){return(e=Oa.get(e))&&(t=e[t+(s?"_DEBUG":"")])&&(t=t.find((e=>e.o===o&&e.v.every((e=>n(e.prefix)===e.namespaceURI))&&e.D.every((e=>void 0!==i[e.name]))&&e.kb.every((e=>r[e.prefix]===e.namespaceURI))&&e.l.every((e=>{const t=a(e.cc,e.arity);return t&&t.namespaceURI===e.Db.namespaceURI&&t.localName===e.Db.localName})))))?{ba:t.h,hc:!1}:null}(e,a,n,i,r,t.debug,s,o),null!==n?{state:n.hc?1:2,ba:n.ba}:{state:0,Zb:"string"==typeof e?Hd(e,t):ba(e)}}function ep(e,t,n,i,r,s,o){const a=new tr(n,i,s,o),l=new br(a);switch(0<Object.keys(r).length&&ka(),Object.keys(r).forEach((e=>{const t=r[e];Sa(l,t),gr(l,e,t)})),"string"==typeof e&&(e=Aa(e)),(n=Kd(e,t,n,i,r,s,o)).state){case 2:return{ga:l,ba:n.ba};case 1:return n.ba.v(l),va(e,t.Z?"XQuery":"XPath",a,r,n.ba,t.debug,s),{ga:l,ba:n.ba};case 0:return n=function(e,t,n,i){const r=wr(e,"mainModule");if(!r)throw Error("Can not execute a library module.");const s=wr(r,"prolog");if(s){if(!t.Z)throw Error("XPST0003: Use of XQuery functionality is not allowed in XPath context");ka(),(i=Jd(s,n,!0,i)).pa(i)}return Ur(e,new Jr(n)),ua(e=kr(r,["queryBody","*"]),t)}(n.Zb,t,l,e),n.v(l),t.Ha||va(e,t.Z?"XQuery":"XPath",a,r,n,t.debug,s),{ga:l,ba:n}}}function tp(e,t,n,i){e=e.first();const r=t.first().h.reduce(((e,t)=>(e[t.key.value]=X(t.value()),e)),Object.create(null));t=r["."]?r["."]():D.empty(),delete r["."];try{const{ba:s,ga:o}=ep(function(e){if(A(e.type,1))return e.value;if(A(e.type,54))return e.value.node;throw Ke(`Unable to convert selector argument of type ${E[e.type]} to either an ${E[1]} or an ${E[54]} representing an XQueryX program while calling 'fontoxpath:evaluate'`)}(e),{sa:!1,Z:!0,debug:i.debug,Ha:i.Ha},(e=>n.$(e)),Object.keys(r).reduce(((e,t)=>(e[t]=t,e)),{}),{},"http://www.w3.org/2005/xpath-functions",((e,t)=>n.Sa(e,t))),a=!t.F(),l=new Ge({M:a?t.first():null,Aa:a?0:-1,ta:t,ra:Object.keys(r).reduce(((e,t)=>(e[o.eb(null,t)]=r[t],e)),Object.create(null))});return{ic:s.h(l,i).value,ec:e}}catch(t){Gi(e.value,t)}}function np(e,t,n){if(1!==t.node.nodeType&&9!==t.node.nodeType)return[];const i=J(e,t).reduce(((t,i)=>{for(const r of np(e,i,n))t.push(r);return t}),[]);return n(t)&&i.unshift(t),i}const ip=(e,t,n,i,r)=>{if(!(e=r.first()))throw Je("The context is absent, it needs to be present to use id function.");if(!A(e.type,53))throw Ke("The context item is not a node, it needs to be node to use id function.");const s=t.h,o=i.O().reduce(((e,t)=>(t.value.split(/\s+/).forEach((t=>{e[t]=!0})),e)),Object.create(null));for(t=e.value;9!==t.node.nodeType;)if(null===(t=ne(s,t)))throw Error("FODC0001: the root node of the target node is not a document node.");return t=np(s,t,(e=>1===e.node.nodeType&&(!(!(e=Y(s,e,"id"))||!o[e])&&(o[e]=!1,!0)))),D.create(t.map((e=>he(e))))},rp=(e,t,n,i,r)=>{if(!(e=r.first()))throw Je("The context is absent, it needs to be present to use idref function.");if(!A(e.type,53))throw Ke("The context item is not a node, it needs to be node to use idref function.");const s=t.h,o=i.O().reduce(((e,t)=>(e[t.value]=!0,e)),Object.create(null));for(t=e.value;9!==t.node.nodeType;)if(null===(t=ne(s,t)))throw Error("FODC0001: the root node of the context node is not a document node.");return t=np(s,t,(e=>1===e.node.nodeType&&(!!(e=Y(s,e,"idref"))&&e.split(/\s+/).some((e=>o[e]))))),D.create(t.map((e=>he(e))))};function sp(e){switch(typeof e){case"object":return Array.isArray(e)?D.m(new ae(e.map((e=>X(sp(e)))))):null===e?D.empty():D.m(new pe(Object.keys(e).map((t=>({key:O(t,1),value:X(sp(e[t]))})))));case"number":return D.m(O(e,3));case"string":return D.m(O(e,1));case"boolean":return e?D.aa():D.T();default:throw Error("Unexpected type in JSON parse")}}const op=(e,t,n,i,r)=>{const s=D.m(O("duplicates",1)),o=(e=de(0,0,0,r,s)).F()?"use-first":e.first().value;return i.N((e=>D.m(new pe(e.reduce(((e,t)=>(t.h.forEach((t=>{const n=e.findIndex((e=>ue(e.key,t.key)));if(0<=n)switch(o){case"reject":throw Error("FOJS0003: Duplicate encountered when merging maps.");case"use-last":return void e.splice(n,1,t);case"combine":return void e.splice(n,1,{key:t.key,value:X(D.create(e[n].value().O().concat(t.value().O())))});default:return}e.push(t)})),e)),[])))))};function ap(e,t,n){let i=1;const r=e.value;e=e.Pa(!0);let s=null;const o=Math.max(t-1,0);return-1!==e&&(s=Math.max(0,(null===n?e:Math.max(0,Math.min(e,n+(t-1))))-o)),D.create({next:e=>{for(;i<t;)r.next(e),i++;return null!==n&&i>=t+n?x:(e=r.next(e),i++,e)}},s)}function lp(e){return e.map((e=>A(e.type,19)?xt(e,3):e))}function hp(e){if((e=lp(e)).some((e=>Number.isNaN(e.value))))return[O(NaN,3)];if(!(e=no(e)))throw Error("FORG0006: Incompatible types to be converted to a common type");return e}const cp=(e,t,n,i,r,s)=>ce([r,s],(([e,t])=>{if(1/0===e.value)return D.empty();if(-1/0===e.value)return t&&1/0===t.value?D.empty():i;if(t){if(isNaN(t.value))return D.empty();1/0===t.value&&(t=null)}return isNaN(e.value)?D.empty():ap(i,Math.round(e.value),t?Math.round(t.value):null)})),up=(e,t,n,i,r)=>{if(i.F())return r;if(!(e=no(e=lp(i.O()))))throw Error("FORG0006: Incompatible types to be converted to a common type");if(!e.every((e=>A(e.type,2))))throw Error("FORG0006: items passed to fn:sum are not all numeric.");return t=e.reduce(((e,t)=>e+t.value),0),e.every((e=>A(e.type,5)))?D.m(O(t,5)):e.every((e=>A(e.type,3)))?D.m(O(t,3)):e.every((e=>A(e.type,4)))?D.m(O(t,4)):D.m(O(t,6))};var dp=[].concat(Ei,[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"boolean",j:[{type:59,g:2}],i:{type:0,g:3},callFunction:(e,t,n,i)=>i.fa()?D.aa():D.T()},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"true",j:[],i:{type:0,g:3},callFunction:()=>D.aa()},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"not",j:[{type:59,g:2}],i:{type:0,g:3},callFunction:(e,t,n,i)=>!1===i.fa()?D.aa():D.T()},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"false",j:[],i:{type:0,g:3},callFunction:()=>D.T()}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"last",j:[],i:{type:5,g:3},callFunction:e=>{if(null===e.M)throw Je("The fn:last() function depends on dynamic context, which is absent.");let t=!1;return D.create({next:()=>{if(t)return x;const n=e.ta.Pa();return t=!0,S(O(n,5))}},1)}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"position",j:[],i:{type:5,g:3},callFunction:e=>{if(null===e.M)throw Je("The fn:position() function depends on dynamic context, which is absent.");return D.m(O(e.Aa+1,5))}},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"current-dateTime",j:[],i:{type:10,g:3},callFunction:e=>D.m(O(ze(e),10))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"current-date",j:[],i:{type:7,g:3},callFunction:e=>D.m(O(Ee(ze(e),7),7))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"current-time",j:[],i:{type:8,g:3},callFunction:e=>D.m(O(Ee(ze(e),8),8))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"implicit-timezone",j:[],i:{type:17,g:3},callFunction:e=>D.m(O(Ze(e),17))}],Pi,Di,Vi,[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"years-from-duration",j:[{type:18,g:0}],i:{type:5,g:0},callFunction:(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.bb(),5))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"months-from-duration",j:[{type:18,g:0}],i:{type:5,g:0},callFunction:(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.ab(),5))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"days-from-duration",j:[{type:18,g:0}],i:{type:5,g:0},callFunction:(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.$a(),5))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"hours-from-duration",j:[{type:18,g:0}],i:{type:5,g:0},callFunction:(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.getHours(),5))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"minutes-from-duration",j:[{type:18,g:0}],i:{type:5,g:0},callFunction:(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.getMinutes(),5))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"seconds-from-duration",j:[{type:18,g:0}],i:{type:4,g:0},callFunction:(e,t,n,i)=>i.F()?i:D.m(O(i.first().value.getSeconds(),4))}],Zi,[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"id",j:[{type:1,g:2},{type:53,g:3}],i:{type:54,g:2},callFunction:ip},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"id",j:[{type:1,g:2}],i:{type:54,g:2},callFunction:(e,t,n,i)=>ip(e,t,0,i,D.m(e.M))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"idref",j:[{type:1,g:2},{type:53,g:3}],i:{type:53,g:2},callFunction:rp},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"idref",j:[{type:1,g:2}],i:{type:53,g:2},callFunction:(e,t,n,i)=>rp(e,t,0,i,D.m(e.M))}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"parse-json",j:[{type:1,g:3}],i:{type:59,g:0},callFunction:(e,t,n,i)=>{let r;try{r=JSON.parse(i.first().value)}catch(e){throw Error("FOJS0001: parsed JSON string contains illegal JSON.")}return sp(r)}}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"contains",j:[{type:61,g:3},{type:46,g:3}],i:{type:0,g:3},callFunction:(e,t,n,i,r)=>ce([i,r],(([e,t])=>e.h.some((e=>ue(e.key,t)))?D.aa():D.T()))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"entry",j:[{type:46,g:3},{type:59,g:2}],i:{type:61,g:3},callFunction:(e,t,n,i,r)=>i.map((e=>new pe([{key:e,value:X(r)}])))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"for-each",j:[{type:61,g:3},{type:59,g:2}],i:{type:59,g:2},callFunction:(e,t,n,i,r)=>ce([i,r],(([i,r])=>He(i.h.map((i=>r.value.call(void 0,e,t,n,D.m(i.key),i.value()))))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"get",j:[{type:61,g:3},{type:46,g:3}],i:{type:59,g:2},callFunction:de},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"keys",j:[{type:61,g:3}],i:{type:46,g:2},callFunction:(e,t,n,i)=>ce([i],(([e])=>D.create(e.h.map((e=>e.key)))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"merge",j:[{type:61,g:2},{type:61,g:3}],i:{type:61,g:3},callFunction:op},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"merge",j:[{type:61,g:2}],i:{type:61,g:3},callFunction:(e,t,n,i)=>op(e,0,0,i,D.m(new pe([{key:O("duplicates",1),value:()=>D.m(O("use-first",1))}])))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"put",j:[{type:61,g:3},{type:46,g:3},{type:59,g:2}],i:{type:61,g:3},callFunction:(e,t,n,i,r,s)=>ce([i,r],(([e,t])=>{const n=(e=e.h.concat()).findIndex((e=>ue(e.key,t)));return 0<=n?e.splice(n,1,{key:t,value:X(s)}):e.push({key:t,value:X(s)}),D.m(new pe(e))}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"remove",j:[{type:61,g:3},{type:46,g:2}],i:{type:61,g:3},callFunction:(e,t,n,i,r)=>ce([i],(([e])=>{const t=e.h.concat();return r.N((e=>(e.forEach((e=>{const n=t.findIndex((t=>ue(t.key,e)));0<=n&&t.splice(n,1)})),D.m(new pe(t)))))}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/map",localName:"size",j:[{type:61,g:3}],i:{type:5,g:3},callFunction:(e,t,n,i)=>i.map((e=>O(e.h.length,5)))}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"pi",j:[],i:{type:3,g:3},callFunction:()=>D.m(O(Math.PI,3))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"exp",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.pow(Math.E,e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"exp10",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.pow(10,e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"log",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.log(e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"log10",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.log10(e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"pow",j:[{type:3,g:0},{type:2,g:3}],i:{type:3,g:0},callFunction:(e,t,n,i,r)=>r.N((([e])=>i.map((t=>1!==Math.abs(t.value)||Number.isFinite(e.value)?O(Math.pow(t.value,e.value),3):O(1,3)))))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"sqrt",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.sqrt(e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"sin",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.sin(e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"cos",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.cos(e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"tan",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.tan(e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"asin",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.asin(e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"acos",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.acos(e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"atan",j:[{type:3,g:0}],i:{type:3,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(Math.atan(e.value),3)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions/math",localName:"atan2",j:[{type:3,g:0},{type:3,g:3}],i:{type:3,g:0},callFunction:(e,t,n,i,r)=>r.N((([e])=>i.map((t=>O(Math.atan2(t.value,e.value),3)))))}],In,sn,[{namespaceURI:"http://fontoxpath/operators",localName:"to",j:[{type:5,g:0},{type:5,g:0}],i:{type:5,g:2},callFunction:(e,t,n,i,r)=>{if(e=i.first(),r=r.first(),null===e||null===r)return D.empty();let s=e.value;return r=r.value,s>r?D.empty():D.create({next:()=>S(O(s++,5))},r-s+1)}}],[{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"QName",j:[{type:1,g:0},{type:1,g:3}],i:{type:23,g:3},callFunction:(e,t,n,i,r)=>ce([i,r],(([e,t])=>{if(!ot(t=t.value,23))throw Error("FOCA0002: The provided QName is invalid.");if(null===(e=e&&e.value||null)&&t.includes(":"))throw Error("FOCA0002: The URI of a QName may not be empty if a prefix is provided.");if(i.F())return D.m(O(new F("",null,t),23));if(!t.includes(":"))return D.m(O(new F("",e,t),23));const[n,r]=t.split(":");return D.m(O(new F(n,e,r),23))}))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"prefix-from-QName",j:[{type:23,g:0}],i:{type:24,g:0},callFunction:(e,t,n,i)=>ce([i],(([e])=>null===e?D.empty():(e=e.value).prefix?D.m(O(e.prefix,24)):D.empty()))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"local-name-from-QName",j:[{type:23,g:0}],i:{type:24,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(e.value.localName,24)))},{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:"namespace-uri-from-QName",j:[{type:23,g:0}],i:{type:20,g:0},callFunction:(e,t,n,i)=>i.map((e=>O(e.value.namespaceURI||"",20)))}],[{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>i.X({empty:()=>D.aa(),multiple:()=>D.T(),m:()=>D.T()}),localName:"empty",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>i.X({empty:()=>D.T(),multiple:()=>D.aa(),m:()=>D.aa()}),localName:"exists",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>ap(i,1,1),localName:"head",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:0}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>ap(i,2,null),localName:"tail",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2},{type:5,g:3},{type:59,g:2}],callFunction:(e,t,n,i,r,s)=>i.F()?s:s.F()?i:(e=i.O(),0>(r=r.first().value-1)?r=0:r>e.length&&(r=e.length),t=e.slice(r),D.create(e.slice(0,r).concat(s.O(),t))),localName:"insert-before",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2},{type:5,g:3}],callFunction:(e,t,n,i,r)=>(e=r.first().value,!(i=i.O()).length||1>e||e>i.length||i.splice(e-1,1),D.create(i)),localName:"remove",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>i.N((e=>D.create(e.reverse()))),localName:"reverse",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2},{type:3,g:3}],callFunction:(e,t,n,i,r)=>cp(0,0,0,i,r,D.empty()),localName:"subsequence",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2},{type:3,g:3},{type:3,g:3}],callFunction:cp,localName:"subsequence",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>i,localName:"unordered",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:46,g:2}],callFunction:(e,t,n,i)=>{const r=it(i,t).O();return D.create(r).filter(((e,t)=>r.slice(0,t).every((t=>!Mn(e,t)))))},localName:"distinct-values",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:2}},{j:[{type:46,g:2},{type:1,g:3}],callFunction(){throw Error("FOCH0002: No collations are supported")},localName:"distinct-values",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:2}},{j:[{type:46,g:2},{type:46,g:3}],callFunction:(e,t,n,i,r)=>r.N((([n])=>it(i,t).map(((t,i)=>Ds("eqOp",t.type,n.type)(t,n,e)?O(i+1,5):O(-1,5))).filter((e=>-1!==e.value)))),localName:"index-of",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:2}},{j:[{type:46,g:2},{type:46,g:3},{type:1,g:3}],callFunction(){throw Error("FOCH0002: No collations are supported")},localName:"index-of",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:2}},{j:[{type:59,g:2},{type:59,g:2}],callFunction:(e,t,n,i,r)=>{let s=!1;const o=Xn(e,t,n,i,r);return D.create({next:()=>{if(s)return x;const e=o.next(0);return e.done?e:(s=!0,S(O(e.value,0)))}})},localName:"deep-equal",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{j:[{type:59,g:2},{type:59,g:2},{type:1,g:3}],callFunction(){throw Error("FOCH0002: No collations are supported")},localName:"deep-equal",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:0,g:3}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>{let r=!1;return D.create({next:()=>{if(r)return x;const e=i.Pa();return r=!0,S(O(e,5))}})},localName:"count",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:3}},{j:[{type:46,g:2}],callFunction:(e,t,n,i)=>{if(i.F())return i;if(!(e=no(e=lp(i.O()))))throw Error("FORG0006: Incompatible types to be converted to a common type");if(!e.every((e=>A(e.type,2))))throw Error("FORG0006: items passed to fn:avg are not all numeric.");return t=e.reduce(((e,t)=>e+t.value),0)/e.length,e.every((e=>A(e.type,5)||A(e.type,3)))?D.m(O(t,3)):e.every((e=>A(e.type,4)))?D.m(O(t,4)):D.m(O(t,6))},localName:"avg",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{j:[{type:46,g:2}],callFunction:(e,t,n,i)=>i.F()?i:(e=hp(i.O()),D.m(e.reduce(((e,t)=>e.value<t.value?t:e)))),localName:"max",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{j:[{type:46,g:2},{type:1,g:3}],callFunction(){throw Error("FOCH0002: No collations are supported")},localName:"max",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{j:[{type:46,g:2}],callFunction:(e,t,n,i)=>i.F()?i:(e=hp(i.O()),D.m(e.reduce(((e,t)=>e.value>t.value?t:e)))),localName:"min",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{j:[{type:46,g:2},{type:1,g:3}],callFunction(){throw Error("FOCH0002: No collations are supported")},localName:"min",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{j:[{type:46,g:2}],callFunction:(e,t,n,i)=>up(e,t,0,i,D.m(O(0,5))),localName:"sum",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:3}},{j:[{type:46,g:2},{type:46,g:0}],callFunction:up,localName:"sum",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:46,g:0}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>{if(!i.F()&&!i.oa())throw Error("FORG0003: The argument passed to fn:zero-or-one contained more than one item.");return i},localName:"zero-or-one",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:0}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>{if(i.F())throw Error("FORG0004: The argument passed to fn:one-or-more was empty.");return i},localName:"one-or-more",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:1}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>{if(!i.oa())throw Error("FORG0005: The argument passed to fn:exactly-one is empty or contained more than one item.");return i},localName:"exactly-one",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:3}},{j:[{type:59,g:2},{type:60,g:3}],callFunction:(e,t,n,i,r)=>{if(i.F())return i;const s=r.first(),o=s.o;if(1!==o.length)throw Error("XPTY0004: signature of function passed to fn:filter is incompatible.");return i.filter((i=>{if(i=Bt(o[0],D.m(i),t,"fn:filter",!1),!(i=s.value.call(void 0,e,t,n,i)).oa()||!A(i.first().type,0))throw Error("XPTY0004: signature of function passed to fn:filter is incompatible.");return i.first().value}))},localName:"filter",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2},{type:60,g:3}],callFunction:(e,t,n,i,r)=>{if(i.F())return i;const s=r.first(),o=s.o;if(1!==o.length)throw Error("XPTY0004: signature of function passed to fn:for-each is incompatible.");const a=i.value;let l;return D.create({next:i=>{for(;;){if(!l){var r=a.next(0);if(r.done)return r;r=Bt(o[0],D.m(r.value),t,"fn:for-each",!1),l=s.value.call(void 0,e,t,n,r).value}if(!(r=l.next(i)).done)return r;l=null}}})},localName:"for-each",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2},{type:59,g:2},{type:60,g:3}],callFunction:(e,t,n,i,r,s)=>{if(i.F())return i;const o=s.first(),a=o.o;if(2!==a.length)throw Error("XPTY0004: signature of function passed to fn:fold-left is incompatible.");return i.N((i=>i.reduce(((i,r)=>(i=Bt(a[0],i,t,"fn:fold-left",!1),r=Bt(a[1],D.m(r),t,"fn:fold-left",!1),o.value.call(void 0,e,t,n,i,r))),r)))},localName:"fold-left",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2},{type:59,g:2},{type:60,g:3}],callFunction:(e,t,n,i,r,s)=>{if(i.F())return i;const o=s.first(),a=o.o;if(2!==a.length)throw Error("XPTY0004: signature of function passed to fn:fold-right is incompatible.");return i.N((i=>i.reduceRight(((i,r)=>(i=Bt(a[0],i,t,"fn:fold-right",!1),r=Bt(a[1],D.m(r),t,"fn:fold-right",!1),o.value.call(void 0,e,t,n,r,i))),r)))},localName:"fold-right",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:59,g:2}},{j:[{type:59,g:2}],callFunction:(e,t,n,i)=>{if(!t.Ua)throw Error("serialize() called but no xmlSerializer set in execution parameters.");if(!(e=i.O()).every((e=>A(e.type,53))))throw Error("Expected argument to fn:serialize to resolve to a sequence of Nodes.");return D.m(O(e.map((e=>t.Ua.serializeToString(Li(e.value,t,!1)))).join(""),1))},localName:"serialize",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:1,g:3}}],On,[{j:[{type:59,g:3},{type:61,g:3}],callFunction:(e,t,n,i,r)=>{let s,o;return D.create({next:()=>{s||({ic:s,ec:o}=tp(i,r,n,t));try{return s.next(0)}catch(e){Gi(o.value,e)}}})},localName:"evaluate",namespaceURI:"http://fontoxml.com/fontoxpath",i:{type:59,g:2}},{j:[],callFunction:()=>D.m(O("3.33.0",1)),localName:"version",namespaceURI:"http://fontoxml.com/fontoxpath",i:{type:1,g:3}}],[{j:[{type:23,g:3},{type:5,g:3}],callFunction:(e,t,n,i,r)=>ce([i,r],(([e,t])=>{const i=n.va(e.value.namespaceURI,e.value.localName,t.value);return null===i?D.empty():(e=new L({j:i.j,arity:t.value,localName:e.value.localName,namespaceURI:e.value.namespaceURI,i:i.i,value:i.callFunction}),D.m(e))})),localName:"function-lookup",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{g:0,type:60}},{j:[{type:60,g:3}],callFunction:(e,t,n,i)=>ce([i],(([e])=>e.Ya()?D.empty():D.m(O(new F("",e.l,e.D),23)))),localName:"function-name",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:23,g:0}},{j:[{type:60,g:3}],callFunction:(e,t,n,i)=>ce([i],(([e])=>D.m(O(e.v,5)))),localName:"function-arity",namespaceURI:"http://www.w3.org/2005/xpath-functions",i:{type:5,g:3}}]);class pp{constructor(e){this.h=e}createAttributeNS(e,t){return this.h.createAttributeNS(e,t)}createCDATASection(e){return this.h.createCDATASection(e)}createComment(e){return this.h.createComment(e)}createDocument(){return this.h.createDocument()}createElementNS(e,t){return this.h.createElementNS(e,t)}createProcessingInstruction(e,t){return this.h.createProcessingInstruction(e,t)}createTextNode(e){return this.h.createTextNode(e)}}var fp=Symbol("IS_XPATH_VALUE_SYMBOL");function mp(e){return e&&"object"==typeof e&&"lookupNamespaceURI"in e?t=>e.lookupNamespaceURI(t||null):()=>null}function gp(e){return({prefix:t,localName:n})=>t?null:{namespaceURI:e,localName:n}}function Op(e,t,n,i,r,s){null==i&&(i=i||{});const o=r?{jb:r.logger||{trace:console.log.bind(console)},Ma:r.documentWriter,kb:r.moduleImports,Cb:r.namespaceResolver,ac:r.functionNameResolver,Ja:r.nodesFactory,Ua:r.xmlSerializer}:{jb:{trace:console.log.bind(console)},kb:{},Cb:null,Ja:null,Ma:null,Ua:null},a=new se(null===n?new Z:n);n=o.kb||Object.create(null);var l=void 0===r.defaultFunctionNamespaceURI?"http://www.w3.org/2005/xpath-functions":r.defaultFunctionNamespaceURI;const h=ep(e,s,o.Cb||mp(t),i,n,l,o.ac||gp(l));e=t?Fe(0,t):D.empty(),t=!o.Ja&&s.Z?new ii(t):new pp(o.Ja),n=o.Ma?new q(o.Ma):j,l=o.Ua;const c=Object.keys(i).reduce(((e,t)=>{const n=i[t];return e[`Q{}${t}[0]`]=n&&"object"==typeof n&&fp in n?()=>D.create(n.zb):()=>Fe(0,i[t]),e}),Object.create(null));let u;for(const e of Object.keys(h.ga.Ea))c[e]||(c[e]=()=>(0,h.ga.Ea[e])(u,d));u=new Ge({M:e.first(),Aa:0,ta:e,ra:c});const d=new We(s.debug,s.Ha,a,t,n,r.currentContext,new Map,o.jb,l);return{tb:u,ub:d,ba:h.ba}}function yp(e,t){const n={};let i=0,r=!1,s=null;return{next:()=>{if(r)return x;for(;i<e.h.length;){const r=e.h[i].key.value;if(!s){const a=e.h[i];var o=a.value().X({default:e=>e,multiple:()=>{throw Error(`Serialization error: The value of an entry in a map is expected to be a single item or an empty sequence. Use arrays when putting multiple values in a map. The value of the key ${a.key.value} holds multiple items`)}}).first();if(null===o){n[r]=null,i++;continue}s=bp(o,t)}o=s.next(0),s=null,n[r]=o.value,i++}return r=!0,S(n)}}}function vp(e,t){const n=[];let i=0,r=!1,s=null;return{next:()=>{if(r)return x;for(;i<e.h.length;){if(!s){var o=e.h[i]().X({default:e=>e,multiple:()=>{throw Error("Serialization error: The value of an entry in an array is expected to be a single item or an empty sequence. Use nested arrays when putting multiple values in an array.")}}).first();if(null===o){n[i++]=null;continue}s=bp(o,t)}o=s.next(0),s=null,n[i++]=o.value}return r=!0,S(n)}}}function bp(e,t){if(A(e.type,61))return yp(e,t);if(A(e.type,62))return vp(e,t);if(A(e.type,23)){const t=e.value;return{next:()=>S(`Q{${t.namespaceURI||""}}${t.localName}`)}}switch(e.type){case 7:case 8:case 9:case 11:case 12:case 13:case 14:case 15:const n=e.value;return{next:()=>S(Te(n))};case 47:case 53:case 54:case 55:case 56:case 57:case 58:const i=e.value;return{next:()=>S(Li(i,t,!1))};default:return{next:()=>S(e.value)}}}dp.forEach((e=>{Ki(e.namespaceURI,e.localName,e.j,e.i,e.callFunction)}));var wp={ANY:0,NUMBER:1,STRING:2,BOOLEAN:3,NODES:7,FIRST_NODE:9,STRINGS:10,MAP:11,ARRAY:12,NUMBERS:13,ALL_RESULTS:14,ASYNC_ITERATOR:99};function xp(e,t,n,i){switch(n){case 3:return t.fa();case 2:return(t=it(t,i).O()).length?t.map((e=>xt(e,1).value)).join(" "):"";case 10:return(t=it(t,i).O()).length?t.map((e=>e.value+"")):[];case 1:return null!==(t=t.first())&&A(t.type,2)?t.value:NaN;case 9:if(null===(t=t.first()))return null;if(!A(t.type,53))throw Error("Expected XPath "+ji(e)+" to resolve to Node. Got "+E[t.type]);return Li(t.value,i,!1);case 7:if(!(t=t.O()).every((e=>A(e.type,53))))throw Error("Expected XPath "+ji(e)+" to resolve to a sequence of Nodes.");return t.map((e=>Li(e.value,i,!1)));case 11:if(1!==(t=t.O()).length)throw Error("Expected XPath "+ji(e)+" to resolve to a single map.");if(!A((t=t[0]).type,61))throw Error("Expected XPath "+ji(e)+" to resolve to a map");return yp(t,i).next(0).value;case 12:if(1!==(t=t.O()).length)throw Error("Expected XPath "+ji(e)+" to resolve to a single array.");if(!A((t=t[0]).type,62))throw Error("Expected XPath "+ji(e)+" to resolve to an array");return vp(t,i).next(0).value;case 13:return t.O().map((t=>{if(!A(t.type,2))throw Error("Expected XPath "+ji(e)+" to resolve to numbers");return t.value}));case 99:const n=t.value;let r=null,s=!1;const o=()=>{for(;!s;){if(!r){var e=n.next(0);if(e.done){s=!0;break}r=bp(e.value,i)}return e=r.next(0),r=null,e}return Promise.resolve({done:!0,value:null})};return"asyncIterator"in Symbol?{[Symbol.asyncIterator](){return this},next:()=>new Promise((e=>e(o()))).catch((t=>{Gi(e,t)}))}:{next:()=>new Promise((e=>e(o())))};case 14:return t.O().map((e=>bp(e,i).next(0).value));default:return(t=t.O()).every((e=>A(e.type,53)&&!A(e.type,47)))?(t=t.map((e=>Li(e.value,i,!1))),1===t.length?t[0]:t):1===t.length?A((t=t[0]).type,62)?vp(t,i).next(0).value:A(t.type,61)?yp(t,i).next(0).value:nt(t,i).first().value:it(D.create(t),i).O().map((e=>e.value))}}wp[wp.ANY]="ANY",wp[wp.NUMBER]="NUMBER",wp[wp.STRING]="STRING",wp[wp.BOOLEAN]="BOOLEAN",wp[wp.NODES]="NODES",wp[wp.FIRST_NODE]="FIRST_NODE",wp[wp.STRINGS]="STRINGS",wp[wp.MAP]="MAP",wp[wp.ARRAY]="ARRAY",wp[wp.NUMBERS]="NUMBERS",wp[wp.ALL_RESULTS]="ALL_RESULTS",wp[wp.ASYNC_ITERATOR]="ASYNC_ITERATOR";let Sp=!1,kp=null;var Ap={getPerformanceSummary(){const e=kp.getEntriesByType("measure").filter((e=>e.name.startsWith("XPath: ")));return Array.from(e.reduce(((e,t)=>{var n=t.name.substring(7);return e.has(n)?((n=e.get(n)).times+=1,n.totalDuration+=t.duration):e.set(n,{xpath:n,times:1,totalDuration:t.duration,average:0}),e}),new Map).values()).map((e=>(e.average=e.totalDuration/e.times,e))).sort(((e,t)=>t.totalDuration-e.totalDuration))},setPerformanceImplementation(e){kp=e},startProfiling(){if(null===kp)throw Error("Performance API object must be set using `profiler.setPerformanceImplementation` before starting to profile");kp.clearMarks(),kp.clearMeasures(),Sp=!0},stopProfiling(){Sp=!1}};let Cp=0;const _p=(e,t,n,i,r,s)=>{if(r=r||0,!e||"string"!=typeof e&&!("nodeType"in e))throw new TypeError("Failed to execute 'evaluateXPath': xpathExpression must be a string or an element depicting an XQueryX DOM tree.");let o,a;s=s||{};try{const r=Op(e,t,n||null,i||{},s,{sa:"XQueryUpdate3.1"===s.language,Z:"XQuery3.1"===s.language||"XQueryUpdate3.1"===s.language,debug:!!s.debug,Ha:!!s.disableCache});var l=r.tb;o=r.ub,a=r.ba}catch(t){Gi(e,t)}if(a.I)throw Error("XUST0001: Updating expressions should be evaluated as updating expressions");if(3===r&&t&&"object"==typeof t&&"nodeType"in t&&(n=a.D(),t=z(t),null!==n&&!t.includes(n)))return!1;try{t=e,Sp&&("string"!=typeof t&&(t=ji(t)),kp.mark(`${t}${0===Cp?"":"@"+Cp}`),Cp++);const n=xp(e,ei(a,l,o),r,o);return r=e,Sp&&("string"!=typeof r&&(r=ji(r)),Cp--,l=`${r}${0===Cp?"":"@"+Cp}`,kp.measure(`XPath: ${r}`,l),kp.clearMarks(l)),n}catch(t){Gi(e,t)}};function Ep(e,t,n,i,r){return _p(e,t,n,i,_p.Mb,r)}function Tp(e,t,n,i){return{pendingUpdateList:e.da.map((e=>e.h(i))),xdmValue:xp(t,D.create(e.J),n,i)}}function Pp(e,t,n){return{code:e,ua:t,H:n,isAstAccepted:!0}}function $p(e){return{isAstAccepted:!1,reason:e}}function Np(e,t){return e.isAstAccepted?t(e):e}function Ip(e,t){return e.isAstAccepted?t(e):[e,null]}function Qp(e,t,n){return Np(e,(e=>{switch(e.ua.type){case 0:return e;case 1:return Np(mf(n,e,"nodes"),(e=>Np(mf(n,t,"contextItem"),(t=>Pp(`(function () {\n\t\t\t\t\t\t\tconst { done, value } = ${e.code}(${t.code}).next();\n\t\t\t\t\t\t\treturn done ? null : value;\n\t\t\t\t\t\t})()`,{type:0},[...e.H,...t.H])))));default:throw Error(`invalid generated code type to convert to value: ${e.ua.type}`)}}))}function Rp(e,t,n,i){return e=Qp(e,n,i),t&&0===t.type&&3===t.g?e:Np(e,(e=>Pp(`!!${e.code}`,{type:0},e.H)))}function Mp(e,t,n){return t?e.isAstAccepted&&0!==e.ua.type?$p("Atomization only implemented for single value"):A(t.type,1)?e:A(t.type,47)?Np(mf(n,e,"attr"),(e=>Pp(`(${e.code} ? domFacade.getData(${e.code}) : null)`,{type:0},e.H))):$p("Atomization only implemented for string and attribute"):$p("Can not atomize value if type was not annotated")}function Bp(e,t,n,i){return i=Mp(e=Qp(e,n,i),t,i),lt(t)?Np(i,(e=>Pp(`${e.code} ?? ''`,{type:0},e.H))):i}function Dp(e,t,n){return Np(mf(n,e,"node"),(e=>1===e.ua.type?e:t&&!A(t.type,53)?$p("Can not evaluate to node if expression does not result in nodes"):Pp(`(function () {\n\t\t\t\tif (${e.code} !== null && !${e.code}.nodeType) {\n\t\t\t\t\tthrow new Error('XPDY0050: The result of the expression was not a node');\n\t\t\t\t}\n\t\t\t\treturn ${e.code};\n\t\t\t})()`,{type:0},e.H)))}function Xp(e,t){return Np(e,(e=>Np(t,(t=>{if(0!==e.ua.type||0!==t.ua.type)throw Error("can only use emitAnd with value expressions");return Pp(`${e.code} && ${t.code}`,{type:0},[...e.H,...t.H])}))))}function Fp(e,t,n,i){return(e=kr(e,[t,"*"]))?i.h(e,n,i):[$p(`${t} expression not found`),null]}Object.assign(_p,{jc:14,ANY_TYPE:0,Lb:12,Mb:99,BOOLEAN_TYPE:3,Ob:9,Rb:11,Tb:7,Ub:13,NUMBER_TYPE:1,Vb:10,STRING_TYPE:2,kc:"XPath3.1",lc:"XQuery3.1",Yb:"XQueryUpdate3.1"}),Object.assign(_p,{ALL_RESULTS_TYPE:14,ANY_TYPE:0,ARRAY_TYPE:12,ASYNC_ITERATOR_TYPE:99,BOOLEAN_TYPE:3,FIRST_NODE_TYPE:9,MAP_TYPE:11,NODES_TYPE:7,NUMBERS_TYPE:13,NUMBER_TYPE:1,STRINGS_TYPE:10,STRING_TYPE:2,XPATH_3_1_LANGUAGE:"XPath3.1",XQUERY_3_1_LANGUAGE:"XQuery3.1",XQUERY_UPDATE_3_1_LANGUAGE:"XQueryUpdate3.1"});const Lp={equalOp:"eqOp",notEqualOp:"neOp",lessThanOrEqualOp:"leOp",lessThanOp:"ltOp",greaterThanOrEqualOp:"geOp",greaterThanOp:"gtOp"},Up={eqOp:"eqOp",neOp:"neOp",leOp:"geOp",ltOp:"gtOp",geOp:"leOp",gtOp:"ltOp"};function Vp(e,t,n,i){const r=Sr(kr(e,["firstOperand","*"]),"type"),s=Sr(kr(e,["secondOperand","*"]),"type");if(!r||!s)return $p("Can not generate code for value compare without both types");var o=[47,1];if(!o.includes(r.type)||!o.includes(s.type))return $p(`Unsupported types in compare: [${E[r.type]}, ${E[s.type]}]`);if(!(o=new Map([["eqOp","==="],["neOp","!=="]])).has(t))return $p(t+" not yet implemented");const a=o.get(t);return[t]=Fp(e,"firstOperand",n,i),t=Mp(t=Qp(t,n,i),r,i),Np(mf(i,t,"first"),(t=>{var[o]=Fp(e,"secondOperand",n,i);return o=Mp(o=Qp(o,n,i),s,i),Np(mf(i,o,"second"),(e=>{const n=[];return lt(r)&&n.push(`${t.code} === null`),lt(s)&&n.push(`${e.code} === null`),Pp(`(${n.length?`${n.join(" || ")} ? null : `:""}${t.code} ${a} ${e.code})`,{type:0},[...t.H,...e.H])}))}))}function zp(e,t,n,i,r,s){var o=Sr(kr(e,[t,"*"]),"type");const a=Sr(kr(e,[n,"*"]),"type");if(!o||!a)return $p("Can not generate code for general compare without both types");var l=[47,1];if(!l.includes(o.type)||!l.includes(a.type))return $p(`Unsupported types in compare: [${E[o.type]}, ${E[a.type]}]`);if(!(l=new Map([["eqOp","==="],["neOp","!=="]])).has(i))return $p(i+" not yet implemented");const h=l.get(i);return[t]=Fp(e,t,r,s),o=Mp(t=Qp(t,r,s),o,s),Np(mf(s,o,"single"),(t=>{const[i]=Fp(e,n,r,s);return Np(mf(s,i,"multiple"),(e=>{if(1!==e.ua.type)return $p("can only generate general compare for a single value and a generator");const n=Of(s,gf(s,"n")),i=Mp(n,a,s);return Np(r,(r=>Np(i,(i=>Pp(`(function () {\n\t\t\t\t\t\t\t\t\tfor (const ${n.code} of ${e.code}(${r.code})) {\n\t\t\t\t\t\t\t\t\t\t${i.H.join("\n")}\n\t\t\t\t\t\t\t\t\t\tif (${i.code} ${h} ${t.code}) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t})()`,{type:0},[...t.H,...n.H,...r.H,...e.H])))))}))}))}function Zp(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}const jp={"false#0":function(){return Pp("false",{type:0},[])},"local-name#0":Jp,"local-name#1":Jp,"name#0":Yp,"name#1":Yp,"not#1":function(e,t,n){var i=kr(e,["arguments","*"]);return e=Sr(i,"type"),[i]=n.h(i,t,n),Np(t=Rp(i,e,t,n),(e=>Pp(`!${e.code}`,{type:0},e.H)))},"true#0":function(){return Pp("true",{type:0},[])}},qp={"http://fontoxml.com/fontoxpath":["version#0"],"":["root#1","path#1"]};function Gp(e,t,n,i){if(e.length!==t.length||t.some((e=>4===e)))return $p("Not supported: variadic function or mismatch in argument count");if(0===e.length)return Pp("",{type:0},[]);const[r,...s]=e,[o,...a]=t;return e=mf(i,function(e,t,n,i){const[r]=i.h(e,n,i);if(e=Sr(e,"type"),!t||2===t.g||1===t.g)return $p("Not supported: sequence arguments with multiple items");if(A(t.type,53))return Dp(t=Qp(r,n,i),e,i);switch(t.type){case 59:return Qp(r,n,i);case 0:return Rp(r,e,n,i);case 1:return Bp(r,e,n,i)}return $p(`Argument types not supported: ${e?E[e.type]:"unknown"} -> ${E[t.type]}`)}(r,o,n,i),"arg"),0===s.length?e:Np(e,(e=>Np(Gp(s,a,n,i),(t=>Pp(`${e.code}, ${t.code}`,{type:0},[...e.H,...t.H])))))}function Wp(e,t,n){const{localName:i,namespaceURI:r}=Cr(wr(e,"functionName")),s=Ar(wr(e,"arguments"),"*");var o=s.length;const a=`${i}#${o}`,l=r===n.D;if(l){const i=jp[a];if(void 0!==i)return i(e,t,n)}return(e=qp[l?"":r])&&!e.includes(a)?$p(`Not supported: built-in function not on allow list: ${a}`):(o=Ji(r,i,o))?o.I?$p("Not supported: updating functions"):(t=Np(t=Gp(s,o.j,t,n),(e=>Pp(`runtimeLib.callFunction(domFacade, ${Zp(r)}, ${Zp(i)}, [${e.code}], options)`,{type:0},e.H))),function(e,t){return Np(e,(e=>t&&2!==t.g&&1!==t.g&&([0,1].includes(t.type)||A(t.type,53))?e:$p(`Function return type ${E[t.type]} not supported`)))}(t,o.i)):$p(`Unknown function / arity: ${a}`)}function Hp(e,t,n,i){if((e=kr(e,["arguments","*"]))&&"contextItemExpr"!==e[0]){const i=Sr(e,"type");if(!i||!A(i.type,53))return $p("name function only implemented if arg is a node");[e]=n.h(e,t,n)}else e=function(e,t){return Np(mf(t,e,"contextItem"),(e=>Pp(e.code,{type:0},[...e.H,`if (${e.code} === undefined || ${e.code} === null) {\n\t\t\t\t\tthrow errXPDY0002('The function which was called depends on dynamic context, which is absent.');\n\t\t\t\t}`])))}(t,n);return Np(mf(n,t=Qp(e,t,n),"arg"),(e=>Pp(`(${e.code} ? ${i(e.code)} : '')`,{type:0},e.H)))}function Yp(e,t,n){return Hp(e,t,n,(e=>`(((${e}.prefix || '').length !== 0 ? ${e}.prefix + ':' : '')\n\t\t+ (${e}.localName || ${e}.target || ''))`))}function Jp(e,t,n){return Hp(e,t,n,(e=>`(${e}.localName || ${e}.target || '')`))}function Kp(e,t,n,i){const[r,s]=Fp(e,"firstOperand",n,i);var o=Sr(kr(e,["firstOperand","*"]),"type");o=Rp(r,o,n,i);const[a,l]=Fp(e,"secondOperand",n,i);o=Np(o,(r=>{var s=Sr(kr(e,["secondOperand","*"]),"type");return Np(s=Rp(a,s,n,i),(e=>Pp(`(${r.code} ${t} ${e.code})`,{type:0},[...r.H,...e.H])))}));return[o,"&&"===t?rs(s,l):s===l?s:null]}function ef(e,t,n){return Np(e,(e=>Np(t,(t=>Np(n,(n=>Pp(`for (${e.code}) {\n\t\t\t\t\t\t${t.H.join("\n")}\n\t\t\t\t\t\tif (!(${t.code})) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t${n.H.join("\n")}\n\t\t\t\t\t\t${n.code}\n\t\t\t\t\t}`,{type:2},e.H)))))))}function tf(e,t,n,i,r){const s=t?`, "${t}"`:"";return t=Np(i,(e=>Np(r,(t=>Pp(`let ${e.code} = domFacade.getFirstChild(${t.code}${s});\n\t\t\t\t\t\t\t${e.code};\n\t\t\t\t\t\t\t${e.code} = domFacade.getNextSibling(${e.code}${s})`,{type:2},[...e.H,...t.H]))))),ef(t,e,n)}function nf(e,t,n,i,r){const s=rs(t,"type-2"),o=Np(r,(e=>Pp(`(${e.code} && ${e.code}.nodeType === /*ELEMENT_NODE*/ 1 ? domFacade.getAllAttributes(${e.code}${s?`, "${s}"`:""}) : [])`,{type:0},e.H)));return t=Np(i,(e=>Np(o,(t=>Pp(`const ${e.code} of ${t.code}`,{type:2},[...e.H,...t.H]))))),ef(t,e,n)}function rf(e,t,n,i,r){const s=t?`, "${t}"`:"";return t=Np(r,(e=>Pp(`domFacade.getParentNode(${e.code}${s})`,{type:0},e.H))),sf(i,t,e,n)}function sf(e,t,n,i){const r=Xp(e,n);return Np(e,(e=>Np(t,(t=>Np(r,(n=>Np(i,(i=>Pp(`const ${e.code} = ${t.code};\n\t\t\t\t\t\t${n.H.join("\n")}\n\t\t\t\t\t\tif (${n.code}) {\n\t\t\t\t\t\t\t${i.H.join("\n")}\n\t\t\t\t\t\t\t${i.code}\n\t\t\t\t\t\t}`,{type:2},[...e.H,...t.H])))))))))}const of={Wb:"textTest",Nb:"elementTest",Sb:"nameTest",Xb:"Wildcard",Kb:"anyKindTest"};var af=Object.values(of);function lf(e,t,n,i){!function(e,t){if(null===e.namespaceURI&&"*"!==e.prefix){if(!(t=t.$(e.prefix||"")||null)&&e.prefix)throw Error(`XPST0081: The prefix ${e.prefix} could not be resolved.`);e.namespaceURI=t}}(e,i);const r=e.prefix,s=e.namespaceURI,o=e.localName;return Ip(n,(e=>{var n=Pp(t?`${e.code}.nodeType\n\t\t\t\t\t\t&& (${e.code}.nodeType === /*ELEMENT_NODE*/ 1\n\t\t\t\t\t\t|| ${e.code}.nodeType === /*ATTRIBUTE_NODE*/ 2)`:`${e.code}.nodeType\n\t\t\t\t\t\t&& ${e.code}.nodeType === /*ELEMENT_NODE*/ 1`,{type:0},[]);if("*"===r)return"*"===o?[n,t?"type-1-or-type-2":"type-1"]:[Xp(n,Pp(`${e.code}.localName === ${Zp(o)}`,{type:0},[])),`name-${o}`];n="*"===o?n:Xp(n,Pp(`${e.code}.localName === ${Zp(o)}`,{type:0},[]));var i=Pp(Zp(s),{type:0},[]);return i=""===r&&t?Np(i,(t=>Pp(`${e.code}.nodeType === /*ELEMENT_NODE*/ 1 ? ${t.code} : null`,{type:0},t.H))):i,i=Np(i,(t=>Pp(`(${e.code}.namespaceURI || null) === ((${t.code}) || null)`,{type:0},t.H))),[Xp(n,i),`name-${o}`]}))}function hf(e,t,n,i){var r=e[0];switch(r){case of.Nb:return function(e,t,n){const i=(e=wr(e,"elementName"))&&wr(e,"star");return null===e||i?[Np(t,(e=>Pp(`${e.code}.nodeType === /*ELEMENT_NODE*/ 1`,{type:0},[]))),"type-1"]:lf(e=Cr(wr(e,"QName")),!1,t,n)}(e,n,i);case of.Wb:return function(e){return[Np(e,(e=>Pp(`(${e.code}.nodeType === /*TEXT_NODE*/ 3 ||\n\t\t\t\t${e.code}.nodeType === /* CDATA_SECTION_NODE */ 4)`,{type:0},[]))),"type-3"]}(n);case of.Sb:return lf(Cr(e),t,n,i);case of.Xb:return wr(e,"star")?null!==(r=wr(e,"uri"))?e=lf({localName:"*",namespaceURI:xr(r),prefix:""},t,n,i):(r=wr(e,"NCName"),e="star"===wr(e,"*")[0]?lf({localName:xr(r),namespaceURI:null,prefix:"*"},t,n,i):lf({localName:"*",namespaceURI:null,prefix:xr(r)},t,n,i)):e=lf({localName:"*",namespaceURI:null,prefix:"*"},t,n,i),e;case of.Kb:return function(e){return[Np(e,(e=>Pp(`!!${e.code}.nodeType`,{type:0},[]))),null]}(n);default:return[$p(`Test not implemented: '${r}`),null]}}function cf(e,t,n){const[i,r]=n.h(e,t,n);return[Rp(i,Sr(e,"type"),t,n),r]}function uf(e,t,n){e=e?Ar(e,"*"):[];const[i,r]=e.reduce((([e,i],r)=>{if(!e)return cf(r,t,n);let s=i;return Ip(e,(e=>{const[o,a]=cf(r,t,n);return s=rs(i,a),[Np(o,(t=>Pp(`${e.code} && ${t.code}`,{type:0},[...e.H,...t.H]))),s]}))}),[null,null]);return[i?Np(i,(e=>Pp(`(function () {\n\t\t\t\t\t\t\t${e.H.join("\n")}\n\t\t\t\t\t\t\treturn ${e.code};\n\t\t\t\t\t\t})()`,{type:0},[]))):null,r]}function df(e,t,n,i){if(0===e.length)return[Np(n,(e=>Pp(`yield ${e.code};`,{type:2},e.H))),null];const[r,...s]=e;if(0<Ar(r,"lookup").length)return[$p("Unsupported: lookups"),null];const o=Of(i,gf(i,"contextItem"));e=wr(r,"predicates");const[a,l]=uf(e,o,i);if(e=wr(r,"xpathAxis")){var h=wr(r,af);if(!h)return[$p("Unsupported test in step"),null];var c=xr(e);t="attribute"===c||"self"===c&&t;const[u,d]=hf(h,t,o,i);return h=null===a?u:Xp(u,a),c=rs(d,l),[t]=df(s,t,o,i),function(e,t,n,i,r,s){switch(e=xr(e)){case"attribute":return[nf(t,n,i,r,s),"type-1"];case"child":return[tf(t,n,i,r,s),null];case"parent":return[rf(t,n,i,r,s),null];case"self":return[sf(r,s,t,i),n];default:return[$p(`Unsupported: the ${e} axis`),null]}}(e,h,c,t,o,n)}if(!(e=kr(r,["filterExpr","*"])))return[$p("Unsupported: unknown step type"),null];const[u,d]=i.h(e,n,i);return[Np(u,(e=>{const t=0===s.length?Pp("",{type:2},[]):Pp(`if (${o.code} !== null && !${o.code}.nodeType) {\n\t\t\t\t\t\t\t\t\tthrow new Error('XPTY0019: The result of E1 in a path expression E1/E2 should evaluate to a sequence of nodes.');\n\t\t\t\t\t\t\t\t}`,{type:2},[]),[r]=df(s,!0,o,i),l=null===a?r:Np(a,(e=>Np(r,(t=>Pp(`if (${e.code}) {\n\t\t\t\t\t\t\t\t\t${t.H.join("\n")}\n\t\t\t\t\t\t\t\t\t${t.code}\n\t\t\t\t\t\t\t\t}`,{type:2},e.H)))));return Np(l,(i=>{switch(e.ua.type){case 1:return Np(n,(n=>Pp(`for (const ${o.code} of ${e.code}(${n.code})) {\n\t\t\t\t\t\t\t\t\t${i.H.join("\n")}\n\t\t\t\t\t\t\t\t\t${i.code}\n\t\t\t\t\t\t\t\t}`,{type:2},[...o.H,...e.H,...t.H])));case 0:return Pp(`const ${o.code} = ${e.code};\n\t\t\t\t\t\t\t${t.code}\n\t\t\t\t\t\t\tif (${o.code} !== null) {\n\t\t\t\t\t\t\t\t${i.H.join("\n")}\n\t\t\t\t\t\t\t\t${i.code}\n\t\t\t\t\t\t\t}`,{type:2},[...o.H,...e.H,...t.H]);default:return $p("Unsupported generated code type for filterExpr")}}))})),d]}function pf(e,t,n){const i=Ar(e,"stepExpr");if(1===i.length){const e=wr(i[0],"xpathAxis");if(e&&"self"===xr(e))return function(e,t,n){return Ip(t,(t=>{if(0<Ar(e,"lookup").length)return[$p("Unsupported: lookups"),null];var i=wr(e,"predicates");const[r,s]=uf(i,t,n);if(!(i=wr(e,af)))return[$p("Unsupported test in step"),null];const[o,a]=hf(i,!0,t,n);i=null===r?o:Xp(o,r);const l=rs(a,s);return[Np(i,(e=>Pp(`((${e.code}) ? ${t.code} : null)`,{type:0},[...t.H,...e.H]))),l]}))}(i[0],t,n)}const r=Of(n,gf(n,"contextItem"));t=(e=wr(e,"rootExpr"))?mf(n,function(e){return Np(e,(e=>Pp(`(function () {\n\t\t\t\tlet n = ${e.code};\n\t\t\t\twhile (n.nodeType !== /*DOCUMENT_NODE*/9) {\n\t\t\t\t\tn = domFacade.getParentNode(n);\n\t\t\t\t\tif (n === null) {\n\t\t\t\t\t\tthrow new Error('XPDY0050: the root node of the context node is not a document node.');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn n;\n\t\t\t})()`,{type:0},e.H)))}(r),"root"):r;const[s,o]=df(i,!e,t,n);return[Np(s,(e=>Pp(`(function* (${r.code}) {\n\t\t\t${e.H.join("\n")}\n\t\t\t${e.code}\n\t\t})`,{type:1},[]))),o]}function ff(e,t,n){const i=e[0];switch(i){case"contextItemExpr":return[t,null];case"pathExpr":return pf(e,t,n);case"andOp":return Kp(e,"&&",t,n);case"orOp":return Kp(e,"||",t,n);case"stringConstantExpr":return[Pp(e=Zp(e=wr(e,"value")[1]||""),{type:0},[]),null];case"equalOp":case"notEqualOp":case"lessThanOrEqualOp":case"lessThanOp":case"greaterThanOrEqualOp":case"greaterThanOp":case"eqOp":case"neOp":case"ltOp":case"leOp":case"gtOp":case"geOp":case"isOp":case"nodeBeforeOp":case"nodeAfterOp":e:switch(i){case"eqOp":case"neOp":case"ltOp":case"leOp":case"gtOp":case"geOp":case"isOp":e=Vp(e,i,t,n);break e;case"equalOp":case"notEqualOp":case"lessThanOrEqualOp":case"lessThanOp":case"greaterThanOrEqualOp":case"greaterThanOp":const r=Sr(kr(e,["firstOperand","*"]),"type"),s=Sr(kr(e,["secondOperand","*"]),"type");e=r&&s?3===r.g&&3===s.g?Vp(e,Lp[i],t,n):3===r.g?zp(e,"firstOperand","secondOperand",Lp[i],t,n):3===s.g?zp(e,"secondOperand","firstOperand",Up[Lp[i]],t,n):$p("General comparison for sequences is not implemented"):$p("types of compare are not known");break e;default:e=$p(`Unsupported compare type: ${i}`)}return[e,null];case"functionCallExpr":return[Wp(e,t,n),null];default:return[$p(`Unsupported: the base expression '${i}'.`),null]}}function mf(e,t,n){return Np(t,(t=>{var i=e.o.get(t);return i||(i=Pp(i=gf(e,n),t.ua,[...t.H,`const ${i} = ${t.code};`]),e.o.set(t,i),e.o.set(i,i)),i}))}function gf(e,t="v"){const n=e.v.get(t)||0;return e.v.set(t,n+1),`${t}${n}`}function Of(e,t){return t=Pp(t,{type:0},[]),e.o.set(t,t),t}function yf(e){const t=Ar(e,"*");if("pathExpr"===e[0])return!0;for(const e of t)if(yf(e))return!0;return!1}class vf extends Error{constructor(e,t,n){var i=e.stack;i&&(i.includes(e.message)&&(i=i.substr(i.indexOf(e.message)+e.message.length).trim()),(i=i.split("\n")).splice(10),i=i.map((e=>e.startsWith("    ")||e.startsWith("\t")?e:`    ${e}`)),i=i.join("\n")),super(`Custom XPath function Q{${n}}${t} raised:\n${e.message}\n${i}`)}}function bf(e,t,n){return 0===t.g?e.F()?null:bp(e.first(),n).next(0).value:2===t.g||1===t.g?e.O().map((e=>{if(A(e.type,47))throw Error("Cannot pass attribute nodes to custom functions");return bp(e,n).next(0).value})):bp(e.first(),n).next(0).value}var wf={callFunction(e,t,n,i,r){const s=Ji(t,n,i.length);if(!s)throw Error("function not found for codegen function call");t=new Ge({M:null,Aa:0,ta:D.empty(),ra:{}});const o=new se(e);return e=new We(!1,!1,o,null,null,r?r.currentContext:null,null),i=s.callFunction(t,e,null,...i.map(((e,t)=>Fe(0,e,s.j[t])))),bf(i,{type:59,g:0},e)},errXPDY0002:Je};const xf={"http://www.w3.org/2005/XQueryX":"xqx","http://www.w3.org/2007/xquery-update-10":"xquf","http://fontoxml.com/fontoxpath":"x"};function Sf(e,t,n,i,r){if("string"==typeof n)return 0===n.length?null:t.createTextNode(n);if(!Array.isArray(n))throw new TypeError("JsonML element should be an array or string");var s=function(e,t){switch(e){case"copySource":case"insertAfter":case"insertAsFirst":case"insertAsLast":case"insertBefore":case"insertInto":case"modifyExpr":case"newNameExpr":case"replacementExpr":case"replaceValue":case"returnExpr":case"sourceExpr":case"targetExpr":case"transformCopies":case"transformCopy":return{localName:e,lb:t||"http://www.w3.org/2005/XQueryX"};case"deleteExpr":case"insertExpr":case"renameExpr":case"replaceExpr":case"transformExpr":return{localName:e,lb:"http://www.w3.org/2007/xquery-update-10"};case"x:stackTrace":return{localName:"stackTrace",lb:"http://fontoxml.com/fontoxpath"};default:return{localName:e,lb:"http://www.w3.org/2005/XQueryX"}}}(n[0],i);i=s.localName,s=s.lb;const o=t.createElementNS(s,xf[s]+":"+i),a=n[1];var l=1;if("object"==typeof a&&!Array.isArray(a)){if(null!==a)for(var h of Object.keys(a))null!==(l=a[h])&&("type"===h?void 0!==l&&e.setAttributeNS(o,s,"fontoxpath:"+h,P(l)):("start"!==h&&"end"!==h&&"comment"!==h||"stackTrace"!==i||(l=JSON.stringify(l)),r&&"prefix"===h&&""===l||e.setAttributeNS(o,s,xf[s]+":"+h,l)));l=2}for(let i=l,a=n.length;i<a;++i)h=Sf(e,t,n[i],s,r),null!==h&&e.insertBefore(o,h,null);return o}const kf=new Map;function Af(e){var t;e:{if(t=Oa.get(e))for(const e of Object.keys(t))if(t[e]&&t[e].length){t=t[e][0].h;break e}t=null}if(t)return t;if(kf.has(e))return kf.get(e);if(null===(t=kr(t="string"==typeof e?Hd(e,{Z:!1}):ba(e),["mainModule","queryBody","*"])))throw Error("Library modules do not have a specificity");return t=ga(t,{sa:!1,Z:!1}),kf.set(e,t),t}var Cf=new Z;return void 0!==n&&(n.compareSpecificity=function(e,t){return gi(Af(e).o,Af(t).o)},n.compileXPathToJavaScript=function(e,t,n){if(n=n||{},t=t||0,"string"==typeof e){e=Aa(e);var i={Z:"XQuery3.1"===n.language||"XQueryUpdate3.1"===n.language,debug:!1};try{var r=Hd(e,i)}catch(t){Gi(e,t)}}else r=ba(e);if(!(e=wr(r,"mainModule")))return $p("Unsupported: XQuery Library modules are not supported.");if(wr(e,"prolog"))return $p("Unsupported: XQuery Prologs are not supported.");if(i=void 0===n.defaultFunctionNamespaceURI?"http://www.w3.org/2005/xpath-functions":n.defaultFunctionNamespaceURI,e=new class{constructor(e,t){this.o=new Map,this.v=new Map,this.$=e,this.D=t,this.h=ff}}(n.namespaceResolver||mp(null),i),Ur(r,n=new Jr(new br(new tr(e.$,{},i,n.functionNameResolver||gp("http://www.w3.org/2005/xpath-functions"))))),n=wr(r,"mainModule"))if(wr(n,"prolog"))e=$p("Unsupported: XQuery.");else{var s=kr(n,["queryBody","*"]);n=Of(e,"contextItem"),[i]=e.h(s,n,e);e:switch(s=Sr(s,"type"),t){case 9:e=Dp(t=Qp(i,n,e),s,e);break e;case 7:e=function(e,t,n,i){return Np(e,(e=>{switch(e.ua.type){case 1:return Np(mf(i,e,"nodes"),(e=>Np(mf(i,n,"contextItem"),(t=>Pp(`Array.from(${e.code}(${t.code}))`,{type:0},[...e.H,...t.H])))));case 0:return Np(mf(i,Dp(e,t,i),"node"),(e=>Pp(`(${e.code} === null ? [] : [${e.code}])`,{type:0},e.H)));default:return $p("Unsupported code type to evaluate to nodes")}}))}(i,s,n,e);break e;case 3:e=Rp(i,s,n,e);break e;case 2:e=Bp(i,s,n,e);break e;default:e=$p(`Unsupported: the return type '${t}'.`)}e.isAstAccepted&&(e=`\n\t\t${e.H.join("\n")}\n\t\treturn ${e.code};`,t="\n\treturn (contextItem, domFacade, runtimeLib, options) => {\n\t\tconst {\n\t\t\terrXPDY0002,\n\t\t} = runtimeLib;",yf(r)&&(t+='\n\t\tif (!contextItem) {\n\t\t\tthrow errXPDY0002("Context is needed to evaluate the given path expression.");\n\t\t}\n\n\t\tif (!contextItem.nodeType) {\n\t\t\tthrow new Error("Context item must be subtype of node().");\n\t\t}\n\t\t'),e={code:t+(e+"}\n//# sourceURL=generated.js"),isAstAccepted:!0})}else e=$p("Unsupported: Can not execute a library module.");return e},n.domFacade=Cf,n.evaluateXPath=_p,n.evaluateXPathToArray=function(e,t,n,i,r){return _p(e,t,n,i,_p.Lb,r)},n.evaluateXPathToAsyncIterator=Ep,n.evaluateXPathToBoolean=function(e,t,n,i,r){return _p(e,t,n,i,_p.BOOLEAN_TYPE,r)},n.evaluateXPathToFirstNode=function(e,t,n,i,r){return _p(e,t,n,i,_p.Ob,r)},n.evaluateXPathToMap=function(e,t,n,i,r){return _p(e,t,n,i,_p.Rb,r)},n.evaluateXPathToNodes=function(e,t,n,i,r){return _p(e,t,n,i,_p.Tb,r)},n.evaluateXPathToNumber=function(e,t,n,i,r){return _p(e,t,n,i,_p.NUMBER_TYPE,r)},n.evaluateXPathToNumbers=function(e,t,n,i,r){return _p(e,t,n,i,_p.Ub,r)},n.evaluateXPathToString=function(e,t,n,i,r){return _p(e,t,n,i,_p.STRING_TYPE,r)},n.evaluateXPathToStrings=function(e,t,n,i,r){return _p(e,t,n,i,_p.Vb,r)},n.evaluateUpdatingExpression=async function(e,t,n,i,r){let s,o,a;r=r||{},ka();try{const a=Op(e,t,n||null,i||{},r||{},{sa:!0,Z:!0,debug:!!r.debug,Ha:!!r.disableCache});var l=a.tb;s=a.ub,o=a.ba}catch(t){Gi(e,t)}if(!o.I){for(l=[],e=Ep(e,t,n,i,Object.assign(Object.assign({},r),{language:"XQueryUpdate3.1"})),t=await e.next();!t.done;t=await e.next())l.push(t.value);return Promise.resolve({pendingUpdateList:[],xdmValue:l})}try{a=o.s(l,s).next(0)}catch(t){Gi(e,t)}return Tp(a.value,e,r.returnType,s)},n.evaluateUpdatingExpressionSync=function(e,t,n,i,r){let s,o,a,l;r=r||{},ka();try{const l=Op(e,t,n||null,i||{},r||{},{sa:!0,Z:!0,debug:!!r.debug,Ha:!!r.disableCache});s=l.tb,o=l.ub,a=l.ba}catch(t){Gi(e,t)}if(!a.I)return{pendingUpdateList:[],xdmValue:_p(e,t,n,i,r.i,Object.assign(Object.assign({},r),{language:_p.Yb}))};try{l=a.s(s,o).next(0)}catch(t){Gi(e,t)}return Tp(l.value,e,r.returnType,o)},n.executeJavaScriptCompiledXPath=(e,t,n,i)=>(n=n||new Z,e()(null!=t?t:null,n,wf,i)),n.executePendingUpdateList=function(e,t,n,i){t=new se(t||new Z),i=i?new q(i):j,n=n?n=new pp(n):null,e=e.map(Go),ai(e,t,n,i)},n.getBucketForSelector=function(e){return Af(e).D()},n.getBucketsForNode=z,n.precompileXPath=function(e){return Promise.resolve(e)},n.registerXQueryModule=function(e,t={debug:!1}){try{var n=Hd(e,{Z:!0,debug:t.debug})}catch(t){Gi(e,t)}if(Lr(n,new Jr),!(t=wr(n,"libraryModule")))throw Error("XQuery module must be declared in a library module.");n=wr(t,"moduleDecl");var i=wr(n,"uri");const r=xr(i);if(i=xr(n=wr(n,"prefix")),gr(n=new br(new tr((()=>null),Object.create(null),"http://www.w3.org/2005/xpath-functions",gp("http://www.w3.org/2005/xpath-functions"))),i,r),null!==(t=wr(t,"prolog"))){let i;try{i=Jd(t,n,!0,e)}catch(t){Gi(e,t)}i.Ia.forEach((({namespaceURI:e})=>{if(r!==e)throw Error("XQST0048: Functions and variables declared in a module must reside in the module target namespace.")})),xa(r,i)}else xa(r,{Ia:[],Ta:[],pa:null,source:e});return r},n.registerCustomXPathFunction=function(e,t,n,i){const{namespaceURI:r,localName:s}=function(e){if("object"==typeof e)return e;if(2!==(e=e.split(":")).length)throw Error("Do not register custom functions in the default function namespace");const[t,n]=e;if(!(e=er[t])){if(e=`generated_namespace_uri_${t}`,er[t])throw Error("Prefix already registered: Do not register the same prefix twice.");er[t]=e}return{localName:n,namespaceURI:e}}(e);if(!r)throw or();const o=t.map((e=>N(e))),a=N(n);Ki(r,s,o,a,(function(e,t,n){var l=Array.from(arguments);l.splice(0,3),l=l.map(((e,n)=>bf(e,o[n],t)));const h={currentContext:t.o,domFacade:t.h.h};let c;try{c=i.apply(void 0,[h,...l])}catch(e){throw new vf(e,s,r)}return c&&"object"==typeof c&&Object.getOwnPropertySymbols(c).includes(fp)?D.create(c.zb):Fe(t.h,c,a)}))},n.parseScript=function(e,t,n,i=j){let r;e=Aa(e);try{r=Hd(e,{Z:"XQuery3.1"===t.language||"XQueryUpdate3.1"===t.language,debug:t.debug})}catch(t){Gi(e,t)}var s=new tr(t.namespaceResolver||(()=>null),{},void 0===t.defaultFunctionNamespaceURI?"http://www.w3.org/2005/xpath-functions":t.defaultFunctionNamespaceURI,t.functionNameResolver||(()=>null));s=new br(s);var o=wr(r,["mainModule","libraryModule"]),a=wr(o,"moduleDecl");if(a){gr(s,xr(wr(a,"prefix")),a=xr(wr(a,"uri")))}return(o=wr(o,"prolog"))&&Jd(o,s,!1,e),!1!==t.annotateAst&&Lr(r,new Jr(s)),s=new Z,t=Sf(i,n,r,null,!1===t.mc),i.insertBefore(t,n.createComment(e),s.getFirstChild(t)),t},n.profiler=Ap,n.createTypedValueFactory=function(e){return(t,n)=>(t=Xe(new se(null===n?new Z:n),t,N(e)),{[fp]:!0,zb:t})},n.finalizeModuleRegistration=ka,n.Language={XPATH_3_1_LANGUAGE:"XPath3.1",XQUERY_3_1_LANGUAGE:"XQuery3.1",XQUERY_UPDATE_3_1_LANGUAGE:"XQueryUpdate3.1"},n.ReturnType=wp),n}.call("undefined"==typeof window?void 0:window,Xo,ia);ra.compareSpecificity,ra.compileXPathToJavaScript;const sa=ra.createTypedValueFactory,oa=ra.domFacade;ra.evaluateUpdatingExpression,ra.evaluateUpdatingExpressionSync;const aa=ra.evaluateXPath;ra.evaluateXPathToArray,ra.evaluateXPathToAsyncIterator;const la=ra.evaluateXPathToBoolean,ha=ra.evaluateXPathToFirstNode;ra.evaluateXPathToMap;const ca=ra.evaluateXPathToNodes,ua=ra.evaluateXPathToNumber;ra.evaluateXPathToNumbers;const da=ra.evaluateXPathToString,pa=ra.evaluateXPathToStrings;ra.executeJavaScriptCompiledXPath,ra.executePendingUpdateList,ra.finalizeModuleRegistration,ra.getBucketForSelector;const fa=ra.getBucketsForNode;ra.Language;const ma=ra.parseScript;ra.precompileXPath,ra.profiler;const ga=ra.registerCustomXPathFunction,Oa=ra.registerXQueryModule;ra.ReturnType;class ya{constructor(e){this._onNodeTouched=e}getAllAttributes(e){return Array.from(e.attributes)}getAttribute(e,t){return e.getAttribute(t)}getChildNodes(e,t){const n=Array.from(e.childNodes).filter((e=>!t||fa(e).includes(t)));return n.forEach((e=>this._onNodeTouched(e))),n}getData(e){return e.nodeType===Node.ATTRIBUTE_NODE?(this._onNodeTouched(e),e.value):(this._onNodeTouched(e.parentNode),e.data)}getFirstChild(e,t){for(const n of e.childNodes)if(!t||fa(n).includes(t))return this._onNodeTouched(n),n;return null}getLastChild(e,t){const n=e.getChildNodes().filter((e=>!t||fa(e).includes(t))),i=n[n.length-1];return i||null}getNextSibling(e,t){for(let n=e.nextSibling;n;n=n.nextSibling)if(!t||fa(n).includes(t))return this._onNodeTouched(n),n;return null}getParentNode(e){return e.parentNode}getPreviousSibling(e,t){for(let{previousSibling:n}=e;n;n=n.previousSibling)if(!t||fa(n).includes(t))return n;return null}}class va{static createElementFromXPath(e,t,n){t||(t=document.implementation.createDocument(null,null,null));const i=e.split("/");let r=null,s=null;for(const e of i)if(e)if(e.startsWith("@")){const t=e.slice(1);if(!s)throw new Error("Cannot create an attribute without a parent element.");s.setAttribute(t,"")}else{const[i,o]=e.includes(":")?e.split(":"):[null,e],a=i?va.lookupNamespace(n,i):null,l=a?t.createElementNS(a,e):t.createElement(o);r?s.appendChild(l):r=l,s=l}if(!r)throw new Error("Invalid XPath; no root element could be created.");return r}static lookupNamespace(e,t){return e.getAttribute(`xmlns:${t}`)}static querySelectorAll(e,t){const n=[t],i=[];for(;n.length;){const t=n.shift();for(const e of Array.from(t.children).reverse())n.unshift(e);t.matches&&t.matches("template")&&n.unshift(t.content),t.matches&&t.matches(e)&&i.push(t)}return i}static contains(e,t){for(;t;){if(t===e)return!0;t=t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.host:t.parentNode}return!1}static getClosest(e,t){for(;t&&!t.matches||!t.matches(e);)if(t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE)if(t.nodeType!==Node.ATTRIBUTE_NODE){if(t.nodeType===Node.TEXT_NODE&&(t=t.parentNode),t.matches("fx-fore"))return null;if(!(t=t.parentNode))return null}else t=t.ownerElement;else t=t.host;return t}static getParentBindingElement(e){return!e.parentNode||e.parentNode.nodeType===Node.DOCUMENT_NODE&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?null:this.getClosest("[ref],fx-repeatitem",e.parentNode)}static isAbsolutePath(e){return null!=e&&(e.startsWith("/")||e.startsWith("instance(")||e.startsWith("$"))}static isSelfReference(e){return"."===e||"./text()"===e||"text()"===e||""===e||null===e}static getInstanceId(e,t){if(!e)return"default";if(e.startsWith("instance()"))return"default";if(e.startsWith("instance(")){const t=e.substring(e.indexOf("(")+1);return t.substring(1,t.indexOf(")")-1)}if(e.startsWith("$")){const n=e.match(/\$(?<variableName>[a-zA-Z0-9\-\_]+).*/)?.groups?.variableName;let i=t;for(;i&&!("inScopeVariables"in i);)i=i.nodeType===Node.ATTRIBUTE_NODE?i.ownerElement:i.parentNode;const r=i?.inScopeVariables?.get(n);return r?this.getInstanceId(r.valueQuery,r):null}return null}static resolveInstance(e,t){let n=va.getInstanceId(t,e);if(n||(n=va.getInstanceId(e.getAttribute("ref"),e)),null!==n)return n;const i=va.getParentBindingElement(e);return i?this.resolveInstance(i,t):"default"}static getDocPath(e){const t=da("path()",e),n=va.shortenPath(t);return n.startsWith("/")?`${n}`:`/${n}`}static getPath(e,t){const n=da("path()",e),i=va.shortenPath(n);return i.startsWith("/")?`$${t}${i}`:`$${t}/${i}`}static shortenPath(e){const t=e.replaceAll(/(Q{(.*?)\})/g,""),n=t.substring(1,t.length);return n.substring(n.indexOf("/"),t.length)}static getBasePath(e){return e.split(":")[0]}}function ba(e,t,n,i){const r={};return function(s){if(r[s])return;const o={},a=[],l=[];for(l.push({node:s,processed:!1});l.length>0;){const s=l[l.length-1],{processed:h}=s,{node:c}=s;if(h)l.pop(),a.pop(),o[c]=!1,r[c]=!0,t&&0!==e[c].length||n.push(c);else{if(r[c]){l.pop();continue}if(o[c]){if(i){l.pop();continue}throw a.push(c),window.dispatchEvent(new CustomEvent("compute-exception",{composed:!1,bubbles:!0,detail:{path:a,message:"cyclic graph"}})),new Error(`Cyclic at ${a}`)}o[c]=!0,a.push(c);const t=e[c];for(let e=t.length-1;e>=0;e-=1)l.push({node:t[e],processed:!1});s.processed=!0}}}}function wa(e){this.nodes={},this.outgoingEdges={},this.incomingEdges={},this.circular=e&&!!e.circular}function xa(e){const t=(new DOMParser).parseFromString(e,"application/xml"),n=(new DOMParser).parseFromString(['<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">','  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>','  <xsl:strip-space elements="*"/>','  <xsl:template match="text()">','    <xsl:value-of select="normalize-space(.)"/>',"  </xsl:template>",'  <xsl:template match="node()|@*">',"    <xsl:copy>",'        <xsl:apply-templates select="node()|@*"/>',"    </xsl:copy>","  </xsl:template>","</xsl:stylesheet>"].join("\n"),"application/xml"),i=new XSLTProcessor;i.importStylesheet(n);const r=i.transformToDocument(t);return(new XMLSerializer).serializeToString(r)}wa.prototype={size(){return Object.keys(this.nodes).length},addNode(e,t){this.hasNode(e)||(this.nodes[e]=2===arguments.length?t:e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])},removeNode(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach((t=>{Object.keys(t).forEach((n=>{const i=t[n].indexOf(e);i>=0&&t[n].splice(i,1)}),this)})))},hasNode(e){return Object.prototype.hasOwnProperty.call(this.nodes,e)},getNodeData(e){if(this.hasNode(e))return this.nodes[e];throw new Error(`Node does not exist: ${e}`)},setNodeData(e,t){if(!this.hasNode(e))throw new Error(`Node does not exist: ${e}`);this.nodes[e]=t},addDependency(e,t){if(!this.hasNode(e))throw new Error(`Node does not exist: ${e}`);if(!this.hasNode(t))throw new Error(`Node does not exist: ${t}`);return-1===this.outgoingEdges[e].indexOf(t)&&this.outgoingEdges[e].push(t),-1===this.incomingEdges[t].indexOf(e)&&this.incomingEdges[t].push(e),!0},removeDependency(e,t){let n;this.hasNode(e)&&(n=this.outgoingEdges[e].indexOf(t),n>=0&&this.outgoingEdges[e].splice(n,1)),this.hasNode(t)&&(n=this.incomingEdges[t].indexOf(e),n>=0&&this.incomingEdges[t].splice(n,1))},clone(){const e=this,t=new wa;return Object.keys(e.nodes).forEach((n=>{t.nodes[n]=e.nodes[n],t.outgoingEdges[n]=e.outgoingEdges[n].slice(0),t.incomingEdges[n]=e.incomingEdges[n].slice(0)})),t},directDependenciesOf(e){if(this.hasNode(e))return this.outgoingEdges[e].slice(0);throw new Error(`Node does not exist: ${e}`)},directDependantsOf(e){if(this.hasNode(e))return this.incomingEdges[e].slice(0);throw new Error(`Node does not exist: ${e}`)},dependenciesOf(e,t){if(this.hasNode(e)){const n=[];ba(this.outgoingEdges,t,n,this.circular)(e);const i=n.indexOf(e);return i>=0&&n.splice(i,1),n}throw new Error(`Node does not exist: ${e}`)},dependantsOf(e,t){if(this.hasNode(e)){const n=[];ba(this.incomingEdges,t,n,this.circular)(e);const i=n.indexOf(e);return i>=0&&n.splice(i,1),n}throw new Error(`Node does not exist: ${e}`)},entryNodes(){const e=this;return Object.keys(this.nodes).filter((t=>0===e.incomingEdges[t].length))},overallOrder(e){const t=this,n=[],i=Object.keys(this.nodes);if(0===i.length)return n;if(!this.circular){const e=ba(this.outgoingEdges,!1,[],this.circular);i.forEach((t=>{e(t)}))}const r=ba(this.outgoingEdges,e,n,this.circular);return i.filter((e=>0===t.incomingEdges[e].length)).forEach((e=>{r(e)})),this.circular&&i.filter((e=>-1===n.indexOf(e))).forEach((e=>r(e))),n}},wa.prototype.directDependentsOf=wa.prototype.directDependantsOf,wa.prototype.dependentsOf=wa.prototype.dependantsOf;const Sa="http://www.w3.org/2002/xforms",ka=new Map,Aa=[];function Ca(e,t,n){return ka.has(e)?ka.get(e).set(t,n):ka.set(e,new Map)}const _a=e=>{if(!e)return"http://www.w3.org/1999/xhtml"};function Ea(e,t,n=null){t.nodeType===Node.TEXT_NODE&&(t=t.parentNode),t.nodeType===Node.ATTRIBUTE_NODE&&(t=t.ownerElement),t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(t=t.parentNode.host);const i=("fx-fore"===t.localName?t:t.closest("fx-fore")).querySelectorAll(`[id='${e}']`);if(1===i.length){const e=i[0];return n&&e.localName!==n?null:e}const r=ca("outermost(ancestor-or-self::fx-fore[1]/(descendant::fx-fore|descendant::*[@id = $id]))[not(self::fx-fore)]",t,null,{id:e},{namespaceResolver:_a});if(0===r.length)return null;if(1===r.length&&la("(ancestor::fx-fore | ancestor::fx-repeat)[last()]/self::fx-fore",r[0],null,null,{namespaceResolver:_a})){const e=r[0];return n&&e.localName!==n?null:e}for(const e of ca("ancestor::fx-repeatitem => reverse()",t,null,null,{namespaceResolver:_a})){const t=r.filter((t=>va.contains(e,t)));switch(t.length){case 0:break;case 1:{const e=t[0];return n&&e.localName!==n?null:e}default:{const e=t.find((e=>ca("every $ancestor of ancestor::fx-repeatitem satisfies $ancestor is $ancestor/../child::fx-repeatitem[../@repeat-index]",e,null,{})));return e?n&&e.localName!==n?null:e:null}}}return null}const Ta=(new DOMParser).parseFromString("<xml />","text/xml"),Pa=new Map;function $a(e,t){const n=function(e,t){return ka.has(e)&&ka.get(e).get(t)||null}(e,t);if(n)return n;let i=function(e){if(!e.includes("instance"))return[];if(Pa.has(e))return Pa.get(e);const t=ma(e,{},Ta),n=pa('descendant::xqx:functionCallExpr\n\t\t\t\t[xqx:functionName = "instance"]\n\t\t\t\t/xqx:arguments\n\t\t\t\t/xqx:stringConstantExpr\n\t\t\t\t/xqx:value',t,null,{},{namespaceResolver:e=>"xqx"===e?"http://www.w3.org/2005/XQueryX":void 0});return Pa.set(e,n),n}(e);if(0===i.length){const n=t.parentNode&&t.parentNode.nodeType===t.ELEMENT_NODE&&t.parentNode.closest("[ref]");if(n){const i=$a(n.getAttribute("ref"),n);return Ca(e,t,i),i}i=["default"]}if(1===i.length){let n;if("default"===i[0]){const e=ha("ancestor-or-self::fx-fore[1]",t,null,null,{namespaceResolver:_a});n=e&&e.querySelector("fx-instance")}else n=Ea(i[0],t,"fx-instance");if(n&&n.hasAttribute("xpath-default-namespace")){const i=n.getAttribute("xpath-default-namespace"),r=e=>{if(!e)return i};return Ca(e,t,r),r}}i.length;const r=da("ancestor-or-self::*/@xpath-default-namespace[last()]",t)||"",s=function(e){return""===e?r:da('ancestor-or-self::*/@*[name() = "xmlns:" || $prefix][last()]',t,null,{prefix:e})};return Ca(e,t,s),s}function Na(e,t,n){return(t&&t.ownerDocument||t)===window.document?_a:$a(e,n)}function Ia({prefix:e,localName:t},n){switch(t){case"context":case"base64encode":case"boolean-from-string":case"current":case"depends":case"event":case"fore-attr":case"index":case"instance":case"json2xml":case"xml2Json":case"log":case"parse":case"local-date":case"local-dateTime":case"logtree":case"uri":case"uri-fragment":case"uri-host":case"uri-param":case"uri-path":case"uri-relpath":case"uri-port":case"uri-query":case"uri-scheme":case"uri-scheme-specific-part":return{namespaceURI:Sa,localName:t};default:return""===e&&Aa.includes(t)?{namespaceURI:"http://www.w3.org/2005/xquery-local-functions",localName:t}:"fn"===e||""===e?{namespaceURI:"http://www.w3.org/2005/xpath-functions",localName:t}:"local"===e?{namespaceURI:"http://www.w3.org/2005/xquery-local-functions",localName:t}:null}}function Qa(e){let t=e;for(;t&&!("inScopeVariables"in t);)t=t.nodeType===Node.ATTRIBUTE_NODE?t.ownerElement:t.parentNode;if(!t)return{};const n={};if(t.inScopeVariables)for(const e of t.inScopeVariables.keys()){const i=t.inScopeVariables.get(e);i&&(i.nodeType?n[e]=i.value:n[e]=i)}return n}function Ra(e,t,n,i={},r={}){try{const s=Na(e,t,n),o=Qa(n);return aa(e,t,null,{...o,...i},aa.ALL_RESULTS_TYPE,{debug:!0,currentContext:{formElement:n,variables:i},moduleImports:{xf:Sa},functionNameResolver:Ia,namespaceResolver:s,language:r.language||aa.XPATH_3_1_LANGUAGE})}catch(t){return n.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,detail:{origin:n,message:`Expression '${e}' failed`,expr:e,level:"Error"}})),[]}}function Ma(e,t,n){try{const i=Na(e,t,n),r=Qa(n);return ha(e,t,null,r,{defaultFunctionNamespaceURI:Sa,moduleImports:{xf:Sa},currentContext:{formElement:n},functionNameResolver:Ia,namespaceResolver:i})}catch(t){n.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,detail:{origin:n,message:`Expression '${e}' failed`,expr:e,level:"Error"}}))}}function Ba(e,t,n){try{const i=Na(e,t,n),r=Qa(n);return ca(e,t,null,r,{currentContext:{formElement:n},functionNameResolver:Ia,moduleImports:{xf:Sa},namespaceResolver:i})}catch(t){n.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,detail:{origin:n,message:`Expression '${e}' failed`,expr:e,level:"Error"}}))}}function Da(e,t,n){try{const i=Na(e,t,n),r=Qa(n);return la(e,t,null,r,{currentContext:{formElement:n},functionNameResolver:Ia,moduleImports:{xf:Sa},namespaceResolver:i})}catch(t){n.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,detail:{origin:n,message:`Expression '${e}' failed`,expr:e,level:"Error"}}))}}function Xa(e,t,n,i=null){try{const r=Na(e,t,n),s=Qa(n);return da(e,t,i,s,{currentContext:{formElement:n},functionNameResolver:Ia,moduleImports:{xf:Sa},namespaceResolver:r})}catch(t){n.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,detail:{origin:n,message:`Expression '${e}' failed`,expr:e,level:"Error"}}))}}function Fa(e,t,n,i=null){try{const r=Na(e,t,n),s=Qa(n);return ua(e,t,i,s,{currentContext:{formElement:n},functionNameResolver:Ia,moduleImports:{xf:Sa},namespaceResolver:r})}catch(t){n.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,detail:{origin:n,message:`Expression '${e}' failed`,expr:e,level:"Error"}}))}}const La=(e,t)=>{const n=e.currentContext.formElement;let i=null;if(i=t?Ea(t,n):va.getParentBindingElement(n),i){if("FX-REPEAT"===i.nodeName){const{nodeset:e}=i;for(let t=n;t;t=t.parentNode)if(t.parentNode===i){return e[Array.from(t.parentNode.children).indexOf(t)]}}return i.nodeset}return n.getInScopeContext()};function Ua(e,t){if(t&&t.nodeType===Node.ELEMENT_NODE&&t.children){const n=document.createElement("details");n.setAttribute("data-path",t.nodeName);const i=document.createElement("summary");let r,s=` <${t.nodeName}`;Array.from(t.attributes).forEach((e=>{s+=` ${e.nodeName}="${e.nodeValue}"`})),t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&""!==t.firstChild.data.trim()?(r=t.firstChild.nodeValue,s+=`>${r}</${t.nodeName}>`):s+=">",i.textContent=s,n.appendChild(i),0!==t.childElementCount?n.setAttribute("open","open"):i.setAttribute("style","list-style:none;"),e.appendChild(n),Array.from(t.children).forEach((e=>{Ua(n,e)}))}}ga({namespaceURI:Sa,localName:"context"},[],"item()?",La),ga({namespaceURI:Sa,localName:"context"},["xs:string"],"item()?",La),ga({namespaceURI:Sa,localName:"current"},["xs:string"],"item()?",((e,t)=>(e.currentContext.formElement,null))),ga({namespaceURI:Sa,localName:"element"},["xs:string"],"item()?",((e,t)=>{e.currentContext.formElement;return document.createElement(t)})),ga({namespaceURI:Sa,localName:"log"},["xs:string?"],"xs:string?",((e,t)=>{const{formElement:n}=e.currentContext,i=Ea(t,n,"fx-instance");if(i&&"json"!==i.getAttribute("type")){return xa((new XMLSerializer).serializeToString(i.getDefaultContext()))}return null})),ga({namespaceURI:Sa,localName:"fore-attr"},["xs:string?"],"xs:string?",((e,t)=>{const{formElement:n}=e.currentContext;let i=n;n.nodeType===Node.TEXT_NODE&&(i=n.parentNode);const r=i.closest("fx-fore");return r.hasAttribute(t)?r.getAttribute(t):null})),ga({namespaceURI:Sa,localName:"parse"},["xs:string?"],"element()?",((e,t)=>(new DOMParser).parseFromString(t,"application/xml").firstElementChild)),ga({namespaceURI:Sa,localName:"logtree"},["xs:string?"],"element()?",((e,t)=>{const{formElement:n}=e.currentContext,i=Ea(t,n,"fx-instance");if(i){const t=document.createElement("div");t.setAttribute("class","logtree");const n=e.currentContext.formElement,r=n.querySelector(".logtree");r&&r.parentNode.removeChild(r);const s=Ua(t,i.getDefaultContext());s&&n.appendChild(s)}return null}));const Va=(e,t)=>{const n=ha("ancestor-or-self::fx-fore[1]",e.currentContext.formElement,null,null,{namespaceResolver:_a});let i=null;null===t||"default"===t?i=n.getModel().getDefaultInstance():(i=n.getModel().getInstance(t),i||document.querySelector("fx-fore").dispatchEvent(new CustomEvent("error",{composed:!0,bubbles:!0,detail:{origin:"functions",message:`Instance not found '${t}'`,level:"Error"}})));const r=i.getDefaultContext();return r||null};ga({namespaceURI:Sa,localName:"index"},["xs:string?"],"xs:integer?",((e,t)=>{const{formElement:n}=e.currentContext;if(null===t)return 1;const i=Ea(t,n,"fx-repeat");return i?i.getAttribute("index"):Number(1)})),ga({namespaceURI:Sa,localName:"instance"},[],"item()?",(e=>Va(e,null))),ga({namespaceURI:Sa,localName:"instance"},["xs:string?"],"item()?",Va);ga({namespaceURI:Sa,localName:"json2xml"},["item()?"],"item()?",((e,t)=>{const n=(e,t)=>{const i=typeof e;if("number"===i)t.setAttribute("type","number"),t.textContent=e.toString();else if("boolean"===i)t.setAttribute("type","boolean"),t.textContent=e.toString();else if(null===e){const e=document.createElement("_");e.setAttribute("type","null"),t.appendChild(e)}else"string"===i?t.textContent=e.replace(/[^\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD]/g,(e=>`\\u${e.charCodeAt(0).toString(16).padStart(4,"0")}`)):Array.isArray(e)?(t.setAttribute("type","array"),e.forEach((e=>{const i=document.createElement("_");n(e,i),i.textContent=e,t.appendChild(i)}))):"object"===i&&(t.setAttribute("type","object"),Object.entries(e).forEach((([e,i])=>{if(i){const r=document.createElement(e.replace(/[^a-zA-Z0-9_]/g,"_"));n(i,r),t.appendChild(r)}})))},i=document.createElement("json");return Array.isArray(t)?i.setAttribute("type","array"):i.setAttribute("type","object"),n(t,i),i}));function za(e,t){const n=t.split(".");return 1==n.length?e[n[0]]:za(e[n[0]],n.slice(1).join("."))}function Za(e){return va.getClosest("fx-fore",e)}function ja(e,t){const n=va.getClosest("[ref]",e),i=va.getClosest("fx-fore",e),r=function(e){return Za(e).getModel()}(e);if(null!==n){return i===n.closest("fx-fore")?n.nodeset:r.getDefaultInstance().getDefaultContext()}if(va.isAbsolutePath(t)){const n=va.getInstanceId(t,e);return n?r.getInstance(n).getDefaultContext():r.getDefaultInstance().getDefaultContext()}return r.getDefaultInstance().getDefaultContext()}function qa(e,t){const n=function(e){return e&&e.nodeType&&e.nodeType===Node.ATTRIBUTE_NODE?e.ownerElement:e.nodeType===Node.ELEMENT_NODE?e:e.parentNode}(e);if("FX-FORE"===n.nodeName){const e=n.getModel().getDefaultInstance()?.getDefaultContext();return e||qa(n.parentNode,t)}const i=va.getClosest("[ref]",n.parentNode);if(i&&("FX-GROUP"===i.nodeName||"FX-CONTROL"===i.nodeName))return i.nodeset;const r=n.matches("[iterate]")?n:va.getClosest("[iterate]",n.parentNode);if(r&&r.currentContext)return r.currentContext;const s=va.getClosest("fx-repeatitem",n);if(s)return"context"===e.nodeName?Ma(e.nodeValue,s.nodeset,Za(n)):s.nodeset;const o=n.closest(".fx-repeatitem");if(o){const e=o.parentNode,t=Array.from(e.children).indexOf(o);return va.getClosest("fx-repeat-attributes",n).nodeset[t]}if(n.hasAttribute("context")){const e=ja(n.parentNode,t);return Ma(n.getAttribute("context"),e,Za(n))}if(e.nodeType===Node.ATTRIBUTE_NODE&&"context"===e.nodeName){const i=ja(e.ownerElement.parentNode,t);return Ma(e.ownerElement.getAttribute("context"),i,Za(n))}if(e.nodeType===Node.ATTRIBUTE_NODE&&"ref"===e.nodeName){if(e.ownerElement.hasAttribute("context")){const i=ja(e.ownerElement.parentNode,t);return Ma(e.ownerElement.getAttribute("context"),i,Za(n))}return ja(n.parentNode,t)}return ja(n,t)}ga({namespaceURI:Sa,localName:"xmltoJson"},["item()?"],"item()?",((e,t)=>{const n=e=>e.nodeType===Node.TEXT_NODE,i=e=>{if((e=>e.nodeType===Node.ELEMENT_NODE)(e)){const t={};if(e.hasAttributes()&&(t.type=e.getAttribute("type")),1===e.childNodes.length&&n(e.firstChild))return e.textContent;for(const n of e.childNodes){const e=n.nodeName,r=i(n);t[e]?(Array.isArray(t[e])||(t[e]=[t[e]]),t[e].push(r)):t[e]=r}return t}if(n(e))return e.textContent},r=(new DOMParser).parseFromString(t,"application/xml").documentElement;return i(r)})),ga({namespaceURI:Sa,localName:"depends"},["node()*"],"item()?",((e,t)=>t[0])),ga({namespaceURI:Sa,localName:"event"},["xs:string?"],"item()?",((e,t)=>{if(!t)return null;for(let n=e.currentContext.formElement;n;n=n.parentNode)if(n.currentEvent)return n.currentEvent.detail&&"object"==typeof n.currentEvent.detail&&t in n.currentEvent.detail?n.currentEvent.detail[t]:t.includes(".")?za(n.currentEvent,t):n.currentEvent[t]||null;return null})),Oa(`\n    module namespace xf="${Sa}";\n\n    declare %public function xf:boolean-from-string($str as xs:string) as xs:boolean {\n        lower-case($str) = "true" or $str = "1"\n    };\n`),ga({namespaceURI:Sa,localName:"base64encode"},["xs:string?"],"xs:string?",((e,t)=>btoa(t))),ga({namespaceURI:Sa,localName:"local-date"},[],"xs:string?",((e,t)=>(new Date).toLocaleDateString())),ga({namespaceURI:Sa,localName:"local-dateTime"},[],"xs:string?",((e,t)=>(new Date).toLocaleString())),ga({namespaceURI:Sa,localName:"uri"},[],"xs:string?",((e,t)=>window.location.href)),ga({namespaceURI:Sa,localName:"uri-fragment"},[],"xs:string?",((e,t)=>window.location.hash)),ga({namespaceURI:Sa,localName:"uri-host"},[],"xs:string?",((e,t)=>window.location.host)),ga({namespaceURI:Sa,localName:"uri-query"},[],"xs:string?",((e,t)=>window.location.search)),ga({namespaceURI:Sa,localName:"uri-relpath"},[],"xs:string?",((e,t)=>{const n=new URL(window.location.href).pathname;return n.substring(0,n.lastIndexOf("/")+1)})),ga({namespaceURI:Sa,localName:"uri-path"},[],"xs:string?",((e,t)=>new URL(window.location.href).pathname)),ga({namespaceURI:Sa,localName:"uri-port"},[],"xs:string?",((e,t)=>window.location.port)),ga({namespaceURI:Sa,localName:"uri-param"},["xs:string?"],"xs:string?",((e,t)=>{if(!t)return null;const{search:n}=window.location;return new URLSearchParams(n).get(t)||""})),ga({namespaceURI:Sa,localName:"uri-scheme"},[],"xs:string?",((e,t)=>new URL(window.location.href).protocol)),ga({namespaceURI:Sa,localName:"uri-scheme-specific-part"},[],"xs:string?",((e,t)=>{const n=window.location.href;return n.substring(n.indexOf(":")+1,n.length)}));class Ga{static async loadHtml(e){try{const t=await fetch(e,{method:"GET",mode:"cors",credentials:"same-origin",headers:{"Content-Type":"text/html"}}),n=t.headers.get("content-type").toLowerCase();if(n.startsWith("text/html"))return t.text();Ga.dispatch(this,"error",{message:`Response has wrong contentType '${n}'. Should be 'text/html'`,level:"Error"})}catch(t){Ga.dispatch(this,"error",{message:`Html couldn't be loaded from '${e}'`,level:"Error"})}}static async loadForeFromSrc(e,t,n){if(!t)return Ga.dispatch(this,"error",{detail:{message:"No 'src' attribute present"}}),null;const i=await Ga.loadHtml(t),r=(new DOMParser).parseFromString(i,"text/html").querySelector(n);if(!r)return void Ga.dispatch(this,"error",{detail:{message:`Fore element not found in '${t}'. Maybe wrapped within 'template' element?`}});r.setAttribute("from-src",t);const s=e.attributes;return Array.from(s).forEach((e=>{"src"!==e.name&&r.setAttribute(e.name,e.value)})),e.replaceWith(r),r}static buildPredicates(e){let t="";return Array.from(e.attributes).forEach((e=>{t+=`[@${e.nodeName}]`})),t}static isWidget(e){if(e?.classList.contains("widget"))return!0;let t=e.parentNode;for(;t&&"FX-CONTROL"!==t.nodeName;){if(t?.classList?.contains("widget"))return!0;t=t.parentNode}return!1}static getDomNodeIndexString(e){const t=[];let n=e;for(;n&&n.parentNode;){const e=n.parentNode;if(e.childNodes&&e.childNodes.length>0){const i=[...e.childNodes].indexOf(n);t.unshift(i)}n=e}return t.join(".")}static getExpression(e){return e.startsWith("{")&&e.endsWith("}")?e.substring(1,e.length-1):e}static getFore(e){return e.nodeType===Node.TEXT_NODE?e.parentNode.closest("fx-fore"):e.closest("fx-fore")}static get ACTION_ELEMENTS(){return["FX-ACTION","FX-DELETE","FX-DISPATCH","FX-HIDE","FX-INSERT","FX-LOAD","FX-MESSAGE","FX-REBUILD","FX-RECALCULATE","FX-REFRESH","FX-RENEW","FX-RELOAD","FX-REPLACE","FX-RESET","FX-RETAIN","FX-RETURN","FX-REVALIDATE","FX-SEND","FX-SETFOCUS","FX-SETINDEX","FX-SETVALUE","FX-SHOW","FX-TOGGLE","FX-UPDATE"]}static createUUID(){const e=[],t="0123456789abcdef";for(let n=0;n<36;n+=1)e[n]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";return e.join("")}static get XFORMS_NAMESPACE_URI(){return"http://www.w3.org/2002/xforms"}static isActionElement(e){return Ga.ACTION_ELEMENTS.includes(e)}static get UI_ELEMENTS(){return["FX-ALERT","FX-CONTROL","FX-DIALOG","FX-FILENAME","FX-MEDIATYPE","FX-GROUP","FX-HINT","FX-ITEMS","FX-OUTPUT","FX-RANGE","FX-REPEAT","FX-REPEATITEM","FX-REPEAT-ATTRIBUTES","FX-SWITCH","FX-SECRET","FX-SELECT","FX-SUBMIT","FX-TEXTAREA","FX-TRIGGER","FX-UPLOAD","FX-VAR"]}static get MODEL_ELEMENTS(){return["FX-BIND","FX-FUNCTION","FX-MODEL","FX-INSTANCE","FX-SUBMISSION"]}static isUiElement(e){return Ga.UI_ELEMENTS.includes(e),Ga.UI_ELEMENTS.includes(e)}static async refreshChildren(e,t){const n=new Promise((n=>{const{children:i}=e;if(i)for(const e of Array.from(i)){if("FX-FORE"===e.nodeName.toUpperCase())break;if(Ga.isUiElement(e.nodeName)&&"function"==typeof e.refresh){if(t&&"object"==typeof t&&"index-function"===t.reason&&e._dependencies.isInvalidatedByIndexFunction()){e.refresh(t);continue}!0===t&&e.refresh(t)}else!0!==e.inert&&Ga.refreshChildren(e,t)}n("done")}));return n}static copyDom(e){const t=(new DOMParser).parseFromString("<fx-fore></fx-fore>","text/html").querySelector("fx-fore");return this.convertFromSimple(e,t),t.removeAttribute("convert"),t}static convertFromSimple(e,t){const n=e.childNodes;n&&Array.from(n).forEach((e=>{const n=`FX-${e.nodeName.toUpperCase()}`;if(Ga.MODEL_ELEMENTS.includes(n)||Ga.UI_ELEMENTS.includes(n)||Ga.ACTION_ELEMENTS.includes(n)){const i=t.ownerDocument.createElement(n);t.appendChild(i),Ga.copyAttributes(e,i),Ga.convertFromSimple(e,i)}else{if(e.nodeType===Node.TEXT_NODE){const n=t.ownerDocument.createTextNode(e.textContent);t.appendChild(n)}if(e.nodeType===Node.ELEMENT_NODE){const n=t.ownerDocument.createElement(e.nodeName);t.appendChild(n),Ga.copyAttributes(e,t),Ga.convertFromSimple(e,n)}}}))}static copyAttributes(e,t){return Array.from(e.attributes).forEach((e=>{t.setAttribute(e.nodeName,e.nodeValue)}))}static getContentType(e,t){return"application/x-www-form-urlencoded"===t?"application/x-www-form-urlencoded; charset=UTF-8":"xml"===e.type?"application/xml; charset=UTF-8":"json"===e.type?"application/json":null}static async handleResponse(e){const{status:t}=e;if(t>=400)throw alert(`response status:  ${t} - failed to load data for '${this.src}' - stopping.`),new Error(`failed to load data - status: ${t}`);const n=e.headers.get("content-type").toLowerCase();if(n.startsWith("text/html"))return e.text().then((e=>(new DOMParser).parseFromString(e,"text/html")));if(n.startsWith("text/plain")||n.startsWith("text/markdown"))return e.text();if(n.startsWith("application/json"))return e.json();if(n.startsWith("application/xml")){const t=await e.text();return(new DOMParser).parseFromString(t,"application/xml")}return"done"}static fadeInElement(e){let t=()=>(e.getAnimations&&e.getAnimations().map((e=>e.finish())),t=e.animate({opacity:[0,1]},600),t.finished);return t()}static fadeOutElement(e,t){let n=()=>(e.getAnimations&&e.getAnimations().map((e=>e.finish())),n=e.animate({opacity:[1,0]},t),n.finished);return n()}static async dispatch(e,t,n){if(!va.contains(e?.ownerDocument,e))return;const i=new CustomEvent(t,{composed:!1,bubbles:!0,detail:n});i.listenerPromises=[],e.dispatchEvent(i),i.listenerPromises.length&&await Promise.all(i.listenerPromises)}static formatXml(e){const t=(e=e.replace(/(>)(<)(\/*)/g,"$1\n$2$3").replace(/ *(.*) +\n/g,"$1\n").replace(/(<.+>)(.+\n)/g,"$1\n$2")).split("\n");for(let e=0;e<t.length;e++){const n=t[e];Boolean(n.match(/<.+\/>/)),Boolean(n.match(/<\/.+>/)),Boolean(n.match(/<[^!].*>/))}}static stringifiedComponent(e){return`<${e.localName} ${Array.from(e.attributes).map((e=>`${e.name}="${e.value}"`)).join(" ")}></${e.localName}>`}}Ga.READONLY_DEFAULT=!1,Ga.REQUIRED_DEFAULT=!1,Ga.RELEVANT_DEFAULT=!0,Ga.CONSTRAINT_DEFAULT=!0,Ga.TYPE_DEFAULT="xs:string";class Wa extends HTMLElement{constructor(){super(),this.model=this.parentNode,this.attachShadow({mode:"open"}),this.originalInstance=null,this.partialInstance=null,this.credentials=""}connectedCallback(){this.hasAttribute("src")&&(this.src=this.getAttribute("src")),this.hasAttribute("id")?this.id=this.getAttribute("id"):this.id="default",this.credentials=this.hasAttribute("credentials")?this.getAttribute("credentials"):"same-origin",["same-origin","include","omit"].includes(this.credentials),this.hasAttribute("type")?this.type=this.getAttribute("type"):(this.type="xml",this.setAttribute("type",this.type));this.shadowRoot.innerHTML="\n            <style>\n                \n            :host {\n                display: none;\n            }\n            :host * {\n                display:none;\n            }\n            ::slotted(*){\n                display:none;\n            }\n        \n            </style>\n            \n        \n        ",this.partialInstance={}}async init(){return await this._initInstance(),this.dispatchEvent(new CustomEvent("instance-loaded",{composed:!0,bubbles:!0,detail:{instance:this}})),this}reset(){this.instanceData=this.originalInstance.cloneNode(!0)}evalXPath(e){const t=this.parentElement.parentElement;return Ma(e,this.getDefaultContext(),t)}getInstanceData(){return this.instanceData||this.createInstanceData(),this.instanceData}setInstanceData(e){e?this._setInitialData(e):this.createInstanceData()}getDefaultContext(){const e=this.getInstanceData();return"xml"===this.type?e.firstElementChild:e}async _initInstance(){if("#querystring"===this.src){const e=new URLSearchParams(location.search),t=(new DOMParser).parseFromString("<data></data>","application/xml"),n=t.firstElementChild;for(const i of e){const e=t.createElement(i[0]);e.appendChild(t.createTextNode(i[1])),n.appendChild(e)}this._setInitialData(t)}else this.src?await this._loadData():0!==this.childNodes.length&&this._useInlineData()}createInstanceData(){if("xml"===this.type){const e=(new DOMParser).parseFromString("<data></data>","application/xml");this.instanceData=e,this.originalInstance=this.instanceData.cloneNode(!0)}"json"===this.type&&(this.instanceData={},this.originalInstance=[...this.instanceData]),"text"===this.type&&(this.instanceData=this.innerText,this.originalInstance=this.innerText)}async _loadData(){const e=`${this.src}`;if(e.startsWith("localStore")){const t=e.substring(e.indexOf(":")+1),n=(new DOMParser).parseFromString("<data></data>","application/xml");if(this.instanceData=n,!t)return;const i=localStorage.getItem(t);if(!i)return void this._useInlineData();const r=(new DOMParser).parseFromString(i,"application/xml");return void n.firstElementChild.replaceWith(r.firstElementChild)}const t=Ga.getContentType(this,"get");try{const n=await fetch(e,{method:"GET",credentials:this.credentials,mode:"cors",headers:{"Content-Type":t}}),i=await async function(e,t){const{status:n}=t;if(n>=400)throw alert(`response status:  ${n} - failed to load data for '${e.src}' - stopping.`),new Error(`failed to load data - status: ${n}`);const i=t.headers.get("content-type").toLowerCase();if(i.startsWith("text/html"))return t.text().then((e=>(new DOMParser).parseFromString(e,"text/html")));if(i.startsWith("text/"))return t.text();if(i.startsWith("application/json"))return t.json();if(i.startsWith("application/xml")||i.startsWith("text/xml")){const e=await t.text();return(new DOMParser).parseFromString(e,"application/xml")}throw new Error(`unable to handle response content type: ${i}`)}(this,n);this._setInitialData(i)}catch(e){throw new Error(`failed loading data ${e}`)}}_setInitialData(e){this.instanceData=e,e.nodeType?this.originalInstance=this.instanceData.cloneNode(!0):this.originalInstance={...this.instanceData}}_getContentType(){return"xml"===this.type?"application/xml":"json"===this.type?"application/json":null}_useInlineData(){if("xml"===this.type){const e=(new DOMParser).parseFromString(this.innerHTML,"application/xml");this._setInitialData(e)}else"json"===this.type?this._setInitialData(JSON.parse(this.textContent)):"html"===this.type?this._setInitialData(this.firstElementChild.children):"text"===this.type&&this._setInitialData(this.textContent)}}customElements.get("fx-instance")||customElements.define("fx-instance",Wa);class Ha{constructor(e,t,n,i,r,s,o,a,l,h){this.path=e,this.ref=t,this.constraint=s,this.readonly=n,this.relevant=i,this.required=r,this.type=o,this.node=a,this.bind=l,this.changed=!1,this.alerts=[],this.boundControls=[],this.instanceId=h}get value(){return this.node?this.node.nodeType?this.node.nodeType===Node.ATTRIBUTE_NODE?this.node.nodeValue:this.node.textContent:this.node:null}set value(e){e.nodeType===Node.DOCUMENT_NODE?(this.node.replaceWith(e.firstElementChild),this.node=e.firstElementChild):e.nodeType===Node.ELEMENT_NODE?(this.node.replaceWith(e),this.node=e):this.node.nodeType===Node.ATTRIBUTE_NODE?this.node.nodeValue=e:this.node.textContent=e}addAlert(e){this.alerts.includes(e)||this.alerts.push(e)}cleanAlerts(){this.alerts=[]}}class Ya extends HTMLElement{constructor(){super(),this.instances=[],this.modelItems=[],this.defaultContext={},this.changed=[],this.inited=!1,this.modelConstructed=!1,this.attachShadow({mode:"open"}),this.computes=0,this.fore={}}get formElement(){return this.parentElement}connectedCallback(){this.setAttribute("inert","true"),this.shadowRoot.innerHTML="\n            <slot></slot>\n        ",this.skipUpdate=!1,this.fore=this.parentNode}static lazyCreateModelItem(e,t,n,i){const r=va.resolveInstance(i,t);if(e.parentNode.createNodes&&null==n){const n=new Ha(void 0,t,Ga.READONLY_DEFAULT,!1,Ga.REQUIRED_DEFAULT,Ga.CONSTRAINT_DEFAULT,Ga.TYPE_DEFAULT,null,this,r);return e.registerModelItem(n),n}let s,o={};if(null==n)return null;o=n.nodeType===Node.TEXT_NODE?n.parentNode:n,n.nodeType?s=va.getPath(n,r):(s=null,o=n);const a=new Ha(s,t,Ga.READONLY_DEFAULT,Ga.RELEVANT_DEFAULT,Ga.REQUIRED_DEFAULT,Ga.CONSTRAINT_DEFAULT,Ga.TYPE_DEFAULT,o,this,r);return e.registerModelItem(a),a}async modelConstruct(){Ga.dispatch(this,"model-construct",{model:this});const e=this.querySelectorAll("fx-instance");if(e.length>0){const t=[];e.forEach((e=>{t.push(e.init())})),await Promise.all(t),this.instances=Array.from(e),this.modelConstructed=!0,await Ga.dispatch(this,"model-construct-done",{model:this}),this.inited=!0,this.updateModel()}else this.modelConstructed=!0,await this.dispatchEvent(new CustomEvent("model-construct-done",{composed:!1,bubbles:!0,detail:{model:this}}));const t=Array.from(this.querySelectorAll("fx-functionlib"));await Promise.all(t.map((e=>e.readyPromise))),this.inited=!0}registerModelItem(e){this.modelItems.push(e)}updateModel(){this.rebuild(),this.recalculate(),this.revalidate()}rebuild(){this.mainGraph=new wa(!1),this.modelItems=[];const e=this.querySelectorAll("fx-model > fx-bind");0!==e.length?(e.forEach((e=>{e.init(this)})),Ga.dispatch(this,"rebuild-done",{maingraph:this.mainGraph})):this.skipUpdate=!0}recalculate(){if(this.mainGraph)if(this.computes=0,this.subgraph=new wa(!1),0!==this.changed.length){this.changed.forEach((e=>{if(this.subgraph.addNode(e.path,e.node),this.mainGraph.hasNode(e.path)){const t=this.mainGraph.dependantsOf(e.path,!1).reverse();0!==t.length&&t.forEach((t=>{const n=this.mainGraph.getNodeData(t);if(this.subgraph.addNode(t,n),t.includes(":")){const i=t.substring(0,t.indexOf(":"));this.subgraph.addNode(i,n);0!==this.mainGraph.dependentsOf(e.path,!1).indexOf(t)&&this.subgraph.addDependency(t,e.path)}}))}}));this.subgraph.overallOrder(!1).forEach((e=>{if(this.mainGraph.hasNode(e)){const t=this.mainGraph.getNodeData(e);this.compute(t,e)}}));const e=[...this.changed];this.formElement.toRefresh=e,this.changed=[],Ga.dispatch(this,"recalculate-done",{graph:this.subgraph,computes:this.computes})}else{this.mainGraph.overallOrder(!1).forEach((e=>{const t=this.mainGraph.getNodeData(e);this.compute(t,e)})),Ga.dispatch(this,"recalculate-done",{graph:this.mainGraph,computes:this.computes})}}compute(e,t){const n=this.getModelItem(e);if(n&&t.includes(":")){const e=t.split(":")[1];if(e){const t=n.bind[e];if("calculate"===e){const e=Ra(t,n.node,this);n.value=e,n.readonly=!0}else if("constraint"!==e&&"type"!==e&&t){const i=Da(t,n.node,this);n[e]=i}}this.computes+=1}}revalidate(){if(0===this.modelItems.length)return!0;let e=!0;return this.modelItems.forEach((t=>{const{bind:n}=t;if(n){if("function"==typeof n.hasAttribute&&n.hasAttribute("constraint")){const i=n.getAttribute("constraint");if(i&&t.node){const n=Da(i,t.node,this);t.constraint=n,this.formElement.addToRefresh(t),n||(e=!1)}}if("function"==typeof n.hasAttribute&&n.hasAttribute("required")){const i=n.getAttribute("required");if(i){const n=Da(i,t.node,this);t.required=n,this.formElement.addToRefresh(t),t.node.textContent||(e=!1)}}}})),e}addChanged(e){this.inited&&this.changed.push(e)}getModelItem(e){return this.modelItems.find((t=>t.node===e))}getDefaultContext(){return this.instances[0].getDefaultContext()}getDefaultInstance(){return this.instances.length?this.instances[0]:this.getInstance("default")}getDefaultInstanceData(){return this.instances[0].getInstanceData()}getInstance(e){let t;if("default"===e&&(t=this.instances[0]),!t){t=Array.from(this.instances).find((t=>t.id===e)),this.fore.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?this.fore.parentNode.host.closest("fx-fore"):this.fore.parentNode.closest("fx-fore")}if(!t){const n=this.fore.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?this.fore.parentNode.host.closest("fx-fore"):this.fore.parentNode.closest("fx-fore");if(n){t=n.getModel().instances.filter((e=>e.hasAttribute("shared"))).find((t=>t.id===e))}}return t||("default"===e?this.getDefaultInstance():(!t&&this.fore.strict&&Ga.dispatch(this,"error",{origin:this,message:`Instance '${e}' does not exist`,level:"Error"}),null))}evalBinding(e){return this.instances[0].evalXPath(e)}}Ya.dataChanged=!1,customElements.get("fx-model")||customElements.define("fx-model",Ya);class Ja{constructor(){this._xpaths=new Set,this._parentDependencies=null}isInvalidatedByIndexFunction(){for(const e of this._xpaths)if(e.includes("index("))return!0;return!!this._parentDependencies?.isInvalidatedByIndexFunction()}addXPath(e){this._xpaths.add(e)}resetDependencies(){this._xpaths.clear()}setParentDependencies(e){this._parentDependencies=e}}class Ka extends HTMLElement{static get properties(){return{context:{type:Object},model:{type:Object},modelItem:{type:Object},nodeset:{type:Object},ref:{type:String},inScopeVariables:{type:Map}}}constructor(){super(),this.context=null,this.model=null,this.modelItem=null,this.ref=this.hasAttribute("ref")?this.getAttribute("ref"):"",this.inScopeVariables=new Map,this._dependencies=new Ja,this._dependencies.setParentDependencies(this.parent?.closest("[ref]")?._dependencies)}getModel(){if(this.model)return this.model;return this.getOwnerForm().querySelector("fx-model")}getOwnerForm(){let e=this;for(;e&&e.parentNode;){if("FX-FORE"===e.nodeName.toUpperCase())return e;e=e.parentNode instanceof DocumentFragment?e.parentNode.host:e.parentNode}return e}evalInContext(){this._dependencies.resetDependencies();if(!this.getModel())return;let e;if(this.hasAttribute("context")&&(e=qa(this.getAttributeNode("context")||this,this.context)),this.hasAttribute("ref")&&(e=qa(this.getAttributeNode("ref")||this,this.ref),this._dependencies.addXPath(this.ref)),e||0===this.getModel().instances.length||(e=this.getModel().getDefaultInstance().getDefaultContext()),""===this.ref)this.nodeset=e;else if(Array.isArray(e))this.nodeset=Ra(this.ref,e[0],this);else{if(!e)return;const{nodeType:t}=e;t&&!va.isAbsolutePath(this.ref)?this.nodeset=Ma(this.ref,e,this):[this.nodeset]=Ra(this.ref,e,this)}}evaluateAttributeTemplateExpression(e,t){const n=e.match(/{[^}]*}/g);return n&&n.forEach((n=>{const i=n.substring(1,n.length-1),r=Xa(i,qa(t,i),this),s=e.replaceAll(n,r);e=s})),e}isNotBound(){return!this.hasAttribute("ref")}isBound(){return this.hasAttribute("ref")}getBindingExpr(){if(this.hasAttribute("ref"))return this.getAttribute("ref");const e=va.getClosest("[ref]",this.parentNode);return e?e.getAttribute("ref"):"instance()"}getInstance(){if(this.ref.startsWith("instance(")){const e=va.getInstanceId(this.ref);return this.getModel().getInstance(e)}return this.getModel().getInstance("default")}_getParentBindingElement(e){if(e.parentNode.host){const{host:t}=e.parentNode;if(t.hasAttribute("ref"))return t}else if(e.parentNode){if(e.parentNode.hasAttribute("ref"))return this.parentNode;this._getParentBindingElement(this.parentNode)}return null}getModelItem(){const e=this.getModel().getModelItem(this.nodeset);e&&(this.modelItem=e);const t=va.getClosest("fx-repeatitem",this);let n;if(t){const{index:e}=t;n=Array.isArray(this.nodeset)?this.getModel().getModelItem(this.nodeset[e-1]):this.getModel().getModelItem(this.nodeset)}else n=this.nodeset?this.getModel().getModelItem(this.nodeset):null;if(!n){const e=Ya.lazyCreateModelItem(this.getModel(),this.ref,this.nodeset,this);return this.modelItem=e,e}return this.modelItem=n,n}getValue(){if(this.hasAttribute("value")){const e=this.getAttribute("value");try{return Xa(e,qa(this,e),this.getOwnerForm())}catch(e){Ga.dispatch(this,"error",{message:e})}}return this.textContent?this.textContent:null}getInScopeContext(){return qa(this.getAttributeNode("ref")||this,this.ref)}setInScopeVariables(e){this.inScopeVariables=e}}class el extends Ka{constructor(){super(),this.nodeset=[],this.model={},this.contextNode={},this.inited=!1}connectedCallback(){this.constraint=this.getAttribute("constraint"),this.ref=this.getAttribute("ref"),this.readonly=this.getAttribute("readonly"),this.required=this.getAttribute("required"),this.relevant=this.getAttribute("relevant"),this.type=this.hasAttribute("type")?this.getAttribute("type"):el.TYPE_DEFAULT,this.calculate=this.getAttribute("calculate")}init(e){this.model=e,this._getInstanceId(),this.bindType=this.getModel().getInstance(this.instanceId).type,"xml"===this.bindType&&(this._evalInContext(),this._buildBindGraph(),this._createModelItems()),this._processChildren(e)}_buildBindGraph(){"xml"===this.bindType&&this.nodeset.forEach((e=>{const t=va.resolveInstance(this,this.ref),n=va.getPath(e,t);this.model.mainGraph.addNode(n,e),this.calculate&&(this.model.mainGraph.addNode(`${n}:calculate`,e),this.model.mainGraph.addDependency(n,`${n}:calculate`));const i=this._getReferencesForProperty(this.calculate,e);if(0!==i.length&&this._addDependencies(i,e,n,"calculate"),!this.calculate){const t=this._getReferencesForProperty(this.readonly,e);0!==t.length?this._addDependencies(t,e,n,"readonly"):this.readonly&&this.model.mainGraph.addNode(`${n}:readonly`,e)}const r=this._getReferencesForProperty(this.required,e);0!==r.length?this._addDependencies(r,e,n,"required"):this.required&&this.model.mainGraph.addNode(`${n}:required`,e);const s=this._getReferencesForProperty(this.relevant,e);0!==s.length?this._addDependencies(s,e,n,"relevant"):this.relevant&&this.model.mainGraph.addNode(`${n}:relevant`,e);const o=this._getReferencesForProperty(this.constraint,e);0!==o.length?this._addDependencies(o,e,n,"constraint"):this.constraint&&(this.model.mainGraph.addNode(`${n}:constraint`,e),this.model.mainGraph.addDependency(n,`${n}:constraint`))}))}_addDependencies(e,t,n,i){const r=`${n}:${i}`;0!==e.length?(this.model.mainGraph.hasNode(r)||this.model.mainGraph.addNode(r,t),e.forEach((e=>{const t=va.resolveInstance(this,n),i=va.getPath(e,t);i.endsWith("text()[1]")||(this.model.mainGraph.hasNode(i)||this.model.mainGraph.addNode(i,e),this.model.mainGraph.addDependency(r,i))}))):this.model.mainGraph.addNode(r,t)}_processChildren(e){const t=this.querySelectorAll(":scope > fx-bind");Array.from(t).forEach((t=>{t.init(e)}))}getAlert(){if(this.hasAttribute("alert"))return this.getAttribute("alert");const e=this.querySelector("fx-alert");return e?e.innerHTML:null}_evalInContext(){const e=qa(this.getAttributeNode("ref")||this,this.ref);if(this.nodeset=[],""===this.ref||null===this.ref)this.nodeset=e;else if(Array.isArray(e))e.forEach((t=>{if(va.isSelfReference(this.ref))this.nodeset=e;else if(this.ref){Ba(this.ref,t,this).forEach((e=>{this.nodeset.push(e)}))}}));else{"xml"===this.getModel().getInstance(this.instanceId).type?this.nodeset=Ba(this.ref,e,this):this.nodeset=this.ref}}_createModelItems(){Array.isArray(this.nodeset)?Array.from(this.nodeset).forEach((e=>{this._createModelItem(e)})):this._createModelItem(this.nodeset)}_createModelItem(e){if(va.isSelfReference(this.ref)){const e=va.getClosest("fx-bind[ref]",this.parentElement);return void(e&&(e.required=this.required))}const t=e,n=va.resolveInstance(this,this.ref),i=va.getPath(e,n),r=new Ha(i,this.getBindingExpr(),el.READONLY_DEFAULT,el.RELEVANT_DEFAULT,el.REQUIRED_DEFAULT,el.CONSTRAINT_DEFAULT,this.type,t,this,n),s=this.getAlert();s&&r.addAlert(s),this.getModel().registerModelItem(r)}_getReferencesForProperty(e){return e?this.getReferences(e):[]}getReferences(e){const t=new Set,n=new ya((e=>t.add(e)));return this.nodeset.forEach((t=>{Xa(e,t,this,n)})),Array.from(t.values())}_initBooleanModelItemProperty(e,t){return Da(this[e],t,this)}static shortenPath(e){const t=e.split("/");let n="";for(let e=2;e<t.length;e+=1){const i=t[e];if(-1!==i.indexOf("{}")){n+=`/${i.split("{}")[1]}`}else n+=`/${i}`}return n}_getInstanceId(){const e=this.getBindingExpr();if(e.startsWith("instance("))this.instanceId=va.getInstanceId(e);else{if(!this.instanceId&&"FX-BIND"===this.parentNode.nodeName){let e=this.parentNode;for(;e&&!this.instanceId;){const t=e.getBindingExpr();if(t.startsWith("instance("))return void(this.instanceId=va.getInstanceId(t));if("FX-BIND"!==e.parentNode.nodeName){this.instanceId="default";break}e=e.parentNode}}this.instanceId="default"}}}el.READONLY_DEFAULT=!1,el.REQUIRED_DEFAULT=!1,el.RELEVANT_DEFAULT=!0,el.CONSTRAINT_DEFAULT=!0,el.TYPE_DEFAULT="xs:string",customElements.get("fx-bind")||customElements.define("fx-bind",el);class tl extends Ka{constructor(){super(),this.attachShadow({mode:"open"}),this._url="",this._socket=null,this._heartbeatInterval=tl._defaultHeartbeatInterval,this._heartbeatTimer=null,this._messageFormat=tl._defaultMessageFormat,this._onMessage=this._onMessage.bind(this)}_render(){const e=`\n            <slot></slot>\n${"xml"===this._messageFormat?'<fx-replace id="replace" ref="."></fx-replace>':'<fx-setvalue id="setvalue" ref="."></fx-setvalue>'}\n        `;this.shadowRoot.innerHTML=`\n            <style>\n                \n            :host {\n                display: none;\n            }\n        \n            </style>\n            ${e}\n        `}static get observedAttributes(){return["url","heartbeat","message-format"]}connectedCallback(){this.hasAttribute("url")&&(this._url=this.getAttribute("url")),this.hasAttribute("heartbeat")&&(this._heartbeatInterval=parseInt(this.getAttribute("heartbeat")),this._setupHeartbeat()),this.hasAttribute("message-format")&&(this._messageFormat=this.getAttribute("message-format")),this._render(),this.getOwnerForm().addEventListener("model-construct-done",(e=>{this._connect(),this.evalInContext()}))}disconnectedCallback(){this._disconnect()}attributeChangedCallback(e,t,n){switch(e){case"url":this._url=n,this._connect();break;case"heartbeat":this._heartbeatInterval=parseInt(n),this._setupHeartbeat();break;case"messageformat":this._messageFormat=n}}send(e){if(this.evalInContext(),e=this.nodeset,!this._socket||this._socket.readyState!==WebSocket.OPEN)throw new Error("WebSocket is not connected");{let t;switch(this._messageFormat){case"json":t=JSON.stringify(e);break;case"xml":t=(new XMLSerializer).serializeToString(e);break;case"text":t=e.textContent;break;default:throw new Error(`Unsupported message format: ${this._messageFormat}`)}this._sendMessage(t)}}_connect(){this._disconnect(),this._url&&(this._socket=new WebSocket(this._url),this._socket.addEventListener("open",this._onOpen.bind(this)),this._socket.addEventListener("message",this._onMessage),this._socket.addEventListener("close",this._onClose.bind(this)))}_disconnect(){this._socket&&(this._socket.removeEventListener("open",this._onOpen.bind(this)),this._socket.removeEventListener("message",(e=>this._onMessage(e))),this._socket.removeEventListener("close",this._onClose.bind(this)),this._socket.close(),this._socket=null),this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}_onOpen(e){this.dispatchEvent(new CustomEvent("open",{detail:e}))}_onMessage(e){let t;switch(this._messageFormat){case"json":t=JSON.parse(e.data);break;case"xml":t=(new DOMParser).parseFromString(e.data,"application/xml"),this.getModelItem().value=t,Ya.dataChanged=!0,this.getModel().changed.push(this.modelItem),this.getModel().updateModel(),this.getOwnerForm().refresh(!0);break;case"text":t=e.data;break;default:throw new Error(`Unsupported message format: ${this._messageFormat}`)}Ga.dispatch(this,"channel-message",{message:t})}_onClose(e){this.dispatchEvent(new CustomEvent("close",{detail:e}))}_setupHeartbeat(){this._heartbeatInterval>0?(this._heartbeatTimer&&clearInterval(this._heartbeatTimer),this._heartbeatTimer=setInterval((()=>{this._sendMessage("")}),this._heartbeatInterval)):this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}_sendMessage(e){this._socket&&this._socket.readyState===WebSocket.OPEN&&this._socket.send(e)}static get _defaultHeartbeatInterval(){return 0}static get _defaultMessageFormat(){return"json"}get url(){return this._url}set url(e){this.setAttribute("url",e)}get heartbeat(){return this._heartbeatInterval}set heartbeat(e){this.setAttribute("heartbeat",e)}get messageformat(){return this._messageFormat}set messageformat(e){this.setAttribute("messageformat",e)}}customElements.get("fx-connection")||customElements.define("fx-connection",tl)
/*!
 * Toastify js 1.11.2
 * https://github.com/apvarun/toastify-js
 * @license MIT licensed
 *
 * Copyright (C) 2018 Varun A P
 */;class nl{constructor(e){this.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,style:{background:""}},this.version="1.11.2",this.options={},this.toastElement=null,this._rootElement=document.body,this._init(e)}showToast(){if(this.toastElement=this._buildToast(),"string"==typeof this.options.selector?this._rootElement=document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||this.options.selector instanceof ShadowRoot?this._rootElement=this.options.selector:this._rootElement=document.body,!this._rootElement)throw"Root element is not defined";return this._rootElement.insertBefore(this.toastElement,this._rootElement.firstChild),this._reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout((()=>{this._removeElement(this.toastElement)}),this.options.duration)),this}hideToast(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this._removeElement(this.toastElement)}_init(e){this.options=Object.assign(this.defaults,e),this.options.backgroundColor,this.toastElement=null,this.options.gravity="bottom"===e.gravity?"toastify-bottom":"toastify-top",this.options.stopOnFocus=void 0===e.stopOnFocus||e.stopOnFocus,e.backgroundColor&&(this.options.style.background=e.backgroundColor)}_buildToast(){if(!this.options)throw"Toastify is not initialized";let e=document.createElement("div");e.className=`toastify on ${this.options.className}`,e.className+=` toastify-${this.options.position}`,e.className+=` ${this.options.gravity}`;for(const t in this.options.style)e.style[t]=this.options.style[t];if(this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)e.appendChild(this.options.node);else if(this.options.escapeMarkup?e.innerText=this.options.text:e.innerHTML=this.options.text,""!==this.options.avatar){let t=document.createElement("img");t.src=this.options.avatar,t.className="toastify-avatar","left"==this.options.position?e.appendChild(t):e.insertAdjacentElement("afterbegin",t)}if(!0===this.options.close){let t=document.createElement("span");t.innerHTML="&#10006;",t.className="toast-close",t.addEventListener("click",(e=>{e.stopPropagation(),this._removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}));const n=window.innerWidth>0?window.innerWidth:screen.width;"left"==this.options.position&&n>360?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}if(this.options.stopOnFocus&&this.options.duration>0&&(e.addEventListener("mouseover",(t=>{window.clearTimeout(e.timeOutValue)})),e.addEventListener("mouseleave",(()=>{e.timeOutValue=window.setTimeout((()=>{this._removeElement(e)}),this.options.duration)}))),void 0!==this.options.destination&&e.addEventListener("click",(e=>{e.stopPropagation(),!0===this.options.newWindow?window.open(this.options.destination,"_blank"):window.location=this.options.destination})),"function"==typeof this.options.onClick&&void 0===this.options.destination&&e.addEventListener("click",(e=>{e.stopPropagation(),this.options.onClick()})),"object"==typeof this.options.offset){const t=this._getAxisOffsetAValue("x",this.options),n=this._getAxisOffsetAValue("y",this.options),i="left"==this.options.position?t:`-${t}`,r="toastify-top"==this.options.gravity?n:`-${n}`;e.style.transform=`translate(${i},${r})`}return e}_removeElement(e){e.className=e.className.replace(" on",""),window.setTimeout((()=>{this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),e.parentNode&&e.parentNode.removeChild(e),this.options.callback.call(e),this._reposition()}),400)}_reposition(){let e,t={top:15,bottom:15},n={top:15,bottom:15},i={top:15,bottom:15},r=this._rootElement.querySelectorAll(".toastify");for(let s=0;s<r.length;s++){e=!0===r[s].classList.contains("toastify-top")?"toastify-top":"toastify-bottom";let o=r[s].offsetHeight;e=e.substr(9,e.length-1);let a=15;(window.innerWidth>0?window.innerWidth:screen.width)<=360?(r[s].style[e]=`${i[e]}px`,i[e]+=o+a):!0===r[s].classList.contains("toastify-left")?(r[s].style[e]=`${t[e]}px`,t[e]+=o+a):(r[s].style[e]=`${n[e]}px`,n[e]+=o+a)}}_getAxisOffsetAValue(e,t){return t.offset[e]?isNaN(t.offset[e])?t.offset[e]:`${t.offset[e]}px`:"0px"}}function il(e){return new nl(e)}class rl extends HTMLElement{static get properties(){return{avatar:{type:String},backgroundColor:{type:String},callback:{type:String},classProp:{type:String},close:{type:Boolean},destination:{type:String},duration:{type:Number},escapeMarkup:{type:Boolean},gravity:{type:String},newWindow:{type:Boolean},oldestFirst:{type:Boolean},position:{type:String},selector:{type:String},stopOnFocus:{type:Boolean},text:{type:String}}}constructor(){super(),this.attachShadow({mode:"open"})}_initVar(e,t){return this.hasAttribute(e)?this.getAttribute(e):t}connectedCallback(){this.avatar=this._initVar("avatar",""),this.backgroundColor=this._initVar("backgroundColor",""),this.callback=this._initVar("callback",{}),this.classProp=this._initVar("data-class",""),this.close="true"===this._initVar("close",!1),this.destination=this._initVar("destination",void 0),this.duration=Number(this._initVar("duration",3e3)),this.escapeMarkup="true"===this._initVar("escapeMarkup","true"),this.gravity=this._initVar("gravity","top"),this.newWindow="true"===this._initVar("newWindow","false"),this.offSet=this._initVar("offSet",{}),this.oldestFirst="true"===this._initVar("oldestFirst","true"),this.position=this._initVar("position","right"),this.stopOnFocus="true"===this._initVar("stopOnFocus","true"),this.text=this._initVar("text","");this.shadowRoot.innerHTML=`\n        <style>\n            \n        :host{\n            display:none;\n        }\n    \n        </style>\n        ${this.renderHTML}\n    `,this.addEventListener("jinn-toast",(e=>{this.showToast(e.detail.text)}))}disconnectedCallback(){this.removeEventListener("jinn-toast",this.showToast)}showToast(e){new il({avatar:this.avatar,className:this.classProp,close:this.close,destination:this.destination,duration:this.duration,escapeMarkup:this.escapeMarkup,gravity:this.gravity,newWindow:!1,offset:this.offset,oldestFirst:this.oldestFirst,position:this.position,node:this.shadowRoot,stopOnFocus:this.stopOnFocus,text:e}).showToast()}renderHTML(){return"\n      <slot></slot>\n    "}}customElements.get("jinn-toast")||window.customElements.define("jinn-toast",rl);const sl=(e,t)=>class extends e{static get properties(){return{...e.properties,dnd:{type:Boolean}}}constructor(){super()}connectedCallback(){this.drop=e=>this._drop(e),this.addEventListener("drop",this.drop),this.dragOver=e=>this._dragOver(e),this.addEventListener("dragover",this.dragOver),this.dragLeave=e=>this._dragLeave(e),this.addEventListener("dragleave",this.dragLeave),this.dragEnd=e=>this._dragEnd(e),this.addEventListener("dragend",this._dragEnd)}disconnectedCallback(){this.removeEventListener("drop",this.drop),this.removeEventListener("dragover",this.dragOver),this.removeEventListener("dragleave",this.dragLeave),this.removeEventListener("dragend",this.dragEnd)}_dragOver(e){if(e.target.classList.contains("no-drop"))return!1;e.stopPropagation();const t=e.target.closest("fx-repeatitem");if(!this.getOwnerForm().draggedItem)return;if(this===this.getOwnerForm().draggedItem)return;const{draggedItem:n}=this.getOwnerForm();this.accepts(n)?this.classList.remove("no-drop"):this.classList.add("no-drop");const i=this.hasAttribute("id")?this:this.closest("[id]"),r=n.hasAttribute("id")?n:n.closest("[id]");i?.id===r?.id&&(t!==this.getOwnerForm().draggedItem&&this.classList.add("drag-over"),e.preventDefault())}_dragLeave(e){this.classList.remove("drag-over"),this.classList.remove("no-drop")}_dragEnd(e){const t=this.getOwnerForm().draggedItem;"copy"===t.getAttribute("drop-action")&&t.remove(),this.classList.remove("drag-over")}_getDataNode(){const e=this.getOwnerForm().draggedItem?.getModelItem()?.node;if(!e)return null;const{draggedItem:t}=this.getOwnerForm(),n=this.hasAttribute("id")?this:this.closest("[id]"),i=t.hasAttribute("id")?t:t.closest("[id]");return n?.id!==i?.id?null:e}accepts(e){if(!this.hasAttribute("accept"))return;const t=this.getAttribute("accept");return e.matches(t)}_drop(e){if(this.classList.remove("drag-over"),e.stopPropagation(),"fx-droptarget"===this.localName){this.children.length;let{draggedItem:t}=this.getOwnerForm();if("copy"===t.getAttribute("drop-action")&&(t=t.cloneNode(!0)),!this.accepts(t))return void this.classList.remove("no-drop");if(t===this)return;if("fx-droptarget"===t.localName){if(this.hasAttribute("drop-position"))return this.replaceChildren(t),void e.preventDefault();this.parentNode.lastElementChild===this?(this.parentNode.append(t),e.stopImmediatePropagation()):t===this.previousElementSibling?this.parentNode.insertBefore(t,this.nextElementSibling):this.parentNode.insertBefore(t,this)}else this.appendChild(t);return e.preventDefault(),this.getOwnerForm().getModel().updateModel(),void this.getOwnerForm().refresh(!0)}const t=this._getDataNode();if(t){if("fx-repeat"===this.localName){e.preventDefault();let n=this.nodeset;if(Array.isArray(n)&&!n.length){qa(this.getAttributeNode("ref")||this,this.ref).append(t)}else n=n[n.length-1],n.after(t)}else if("fx-repeatitem"===this.localName){const e=this.getModelItem().node;e.previousSibling===t?e.after(t):e.before(t)}this.getOwnerForm().getModel().updateModel(),this.getOwnerForm().refresh(!0)}}};class ol extends(sl(Ka)){static get properties(){return{...super.properties,index:{type:Number},template:{type:Object},focusOnCreate:{type:String},initDone:{type:Boolean},repeatIndex:{type:Number},repeatSize:{type:Number},nodeset:{type:Array}}}constructor(){super(),this.ref="",this.dataTemplate=[],this.isDraggable=null,this.focusOnCreate="",this.initDone=!1,this.repeatIndex=1,this.nodeset=[],this.inited=!1,this.host={},this.index=1,this.repeatSize=0,this.attachShadow({mode:"open",delegatesFocus:!0})}get repeatSize(){return this.querySelectorAll(":scope > .fx-repeatitem").length}set repeatSize(e){super.repeatSize=e}setIndex(e){this.index=e;const t=this.querySelector("[data-ref]").querySelectorAll(":scope > *");this.applyIndex(t[this.index-1])}applyIndex(e){this._removeIndexMarker(),e&&e.setAttribute("repeat-index","")}get index(){return parseInt(this.getAttribute("index"),10)}set index(e){this.setAttribute("index",e)}_getRepeatedItems(){return this.querySelector("[data-ref]").children}async connectedCallback(){this.ref=this.getAttribute("ref"),this.addEventListener("item-changed",(e=>{const{item:t}=e.detail,n=this._getRepeatedItems(),i=Array.from(n).indexOf(t);this.applyIndex(n[i]),this.index=i+1})),document.addEventListener("index-changed",(e=>{if(e.stopPropagation(),!e.target===this)return;const{index:t}=e.detail;this.index=Number(t),this.applyIndex(this.children[t-1])})),this.mutationObserver=new MutationObserver((e=>{if("childList"===e[0].type){const t=e[0].addedNodes[0];if(t){const e=va.resolveInstance(this,this.ref),n=va.getPath(t,e);Ga.dispatch(this,"path-mutated",{path:n,index:this.index})}}})),this.getOwnerForm().registerLazyElement(this);this.shadowRoot.innerHTML="\n            <style>\n                \n      :host{\n      }\n       .fade-out-bottom {\n          -webkit-animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n          animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n      }\n      .fade-out-bottom {\n          -webkit-animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n          animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n      }\n   \n            </style>\n            \n          <slot></slot>\n    \n        "}async init(){const e=new Promise((e=>{this._evalNodeset(),this._initTemplate(),this.setAttribute("index",this.index),this.inited=!0,e("done")}));return e}_getRef(){return this.getAttribute("ref")}_evalNodeset(){const e=qa(this.getAttributeNode("ref")||this,this.ref);this.mutationObserver&&e.nodeName&&this.mutationObserver.observe(e,{childList:!0,subtree:!0});const t=Ra(this.ref,e,this);1===t.length&&Array.isArray(t[0])?this.nodeset=t[0]:this.nodeset=t}async refresh(e){this.inited||this.init(),this._evalNodeset();let t=this.querySelectorAll(".fx-repeatitem"),n=t.length,i=1;Array.isArray(this.nodeset)&&(i=this.nodeset.length);const r=i;if(r<n)for(let e=n;e>r;e-=1){const n=t[e-1];n.parentNode.removeChild(n),this.getOwnerForm().unRegisterLazyElement(n),this.getOwnerForm().someInstanceDataStructureChanged=!0}if(r>n)for(let e=n+1;e<=r;e+=1){const t=this._clone();if(!t)return;this.querySelector("[data-ref]").appendChild(t),t.classList.add("fx-repeatitem"),t.setAttribute("index",e),t.addEventListener("click",this._dispatchIndexChange),t.addEventListener("focusin",this._dispatchIndexChange),this.getOwnerForm().someInstanceDataStructureChanged=!0}t=this.querySelectorAll(":scope > .fx-repeatitem"),n=t.length;for(let e=0;e<n;e+=1){const n=t[e];this.getOwnerForm().registerLazyElement(n),n.nodeset!==this.nodeset[e]&&(n.nodeset=this.nodeset[e])}this.getOwnerForm().lazyRefresh&&!e||Ga.refreshChildren(this,e),this.setIndex(this.index)}_dispatchIndexChange(){this.dispatchEvent(new CustomEvent("item-changed",{composed:!1,bubbles:!0,detail:{item:this,index:this.index}}))}_fadeOut(e){e.style.opacity=1,function t(){(e.style.opacity-=.1)<0?e.style.display="none":requestAnimationFrame(t)}()}_fadeIn(e){e&&(e.style.opacity=0,e.style.display=this.display,function t(){let n=parseFloat(e.style.opacity);(n+=.1)>1||(e.style.opacity=n,requestAnimationFrame(t))}())}async _initTemplate(){this.template=this.querySelector("template"),this.template&&this.shadowRoot.appendChild(this.template)}_initVariables(e){const t=new Map(this.inScopeVariables);e.setInScopeVariables(t),function e(n){for(const i of n.children)"setInScopeVariables"in i&&i.setInScopeVariables(t),e(i)}(e)}_clone(){if(this.template=this.shadowRoot.querySelector("template"),this.template)return this.template.content.firstElementChild.cloneNode(!0)}_removeIndexMarker(){const e=this.querySelector("[data-ref]");Array.from(e.children).forEach((e=>{e.removeAttribute("repeat-index")}))}setInScopeVariables(e){this.inScopeVariables=new Map(e)}}customElements.get("fx-repeat-attributes")||window.customElements.define("fx-repeat-attributes",ol);const al="clean",ll="dirty";class hl extends HTMLElement{static get properties(){return{createNodes:{type:Boolean},ignoreExpressions:{type:String},mergePartial:{type:Boolean},lazyRefresh:{type:Boolean},model:{type:Object},ready:{type:Boolean},strict:{type:Boolean},validateOn:{type:String},version:{type:String}}}constructor(){super(),this.version="Version: 2.5.0 - built on December 12, 2024 13:46:06",this.model={},this.inited=!1,this.addEventListener("message",this._displayMessage),this.addEventListener("error",this._logError),this.addEventListener("warn",this._displayWarning),window.addEventListener("compute-exception",(e=>{})),this.ready=!1,this.storedTemplateExpressionByNode=new Map,this.outermostHandler=null,this.copiedElements=new WeakSet,this.dirtyState=al,this.showConfirmation=!1;this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n            <style>\n                \n            :host {\n                display: block;\n            }\n            :host ::slotted(fx-model){\n                display:none;\n            }\n\n            #modalMessage .dialogActions{\n                text-align:center;\n            }\n            .overlay {\n              position: fixed;\n              top: 0;\n              bottom: 0;\n              left: 0;\n              right: 0;\n              background: rgba(0, 0, 0, 0.7);\n              transition: all 500ms;\n              visibility: hidden;\n              opacity: 0;\n              z-index:10;\n            }\n            .overlay.show {\n              visibility: visible;\n              opacity: 1;\n            }\n\n            .popup {\n              margin: 70px auto;\n              background: #fff;\n              border-radius: 5px;\n              width: 30%;\n              position: relative;\n              transition: all 5s ease-in-out;\n                            padding: 20px;\n\n            }\n            .popup h2 {\n              margin-top: 0;\n              width:100%;\n              background:#eee;\n              position:absolute;\n              top:0;\n              right:0;\n              left:0;\n              height:40px;\n             border-radius: 5px;\n\n            }\n            .popup .close {\n                position: absolute;\n                top: 3px;\n                right: 10px;\n                transition: all 200ms;\n                font-size: 30px;\n                font-weight: bold;\n                text-decoration: none;\n                color: #333;\n            }\n            .popup .close:focus{\n                outline:none;\n            }\n\n            .popup .close:hover {\n                color: #06D85F;\n            }\n            #messageContent{\n                margin-top:40px;\n            }\n            .warning{\n                background:orange;\n            }\n        \n            </style>\n            \n\x3c!--           <slot name="errors"></slot> --\x3e\n           <jinn-toast id="message" gravity="bottom" position="left"></jinn-toast>\n           <jinn-toast id="sticky" gravity="bottom" position="left" duration="-1" close="true" data-class="sticky-message"></jinn-toast>\n           <jinn-toast id="error" text="error" duration="-1" data-class="error" close="true" position="right" gravity="top" escape-markup="false"></jinn-toast>\n           <jinn-toast id="warn" text="warning" duration="5000" data-class="warning" position="left" gravity="top"></jinn-toast>\n           <slot id="default"></slot>\n           <slot name="messages"></slot>\n           <div id="modalMessage" class="overlay">\n                <div class="popup">\n                   <h2></h2>\n                    <a class="close" href="#"  onclick="event.target.parentNode.parentNode.classList.remove(\'show\')" autofocus>&times;</a>\n                    <div id="messageContent"></div>\n                </div>\n           </div>\n           <slot name="event"></slot>\n        \n        ',this.toRefresh=[],this.initialRun=!0,this._scanForNewTemplateExpressionsNextRefresh=!1,this.repeatsFromAttributesCreated=!1,this.validateOn=this.hasAttribute("validate-on")?this.getAttribute("validate-on"):"update",this.mergePartial=!1,this.createNodes=!!this.hasAttribute("create-nodes")}connectedCallback(){if(this.style.visibility="hidden",this.strict=!!this.hasAttribute("strict"),this.ignoreExpressions=this.hasAttribute("ignore-expressions")?this.getAttribute("ignore-expressions"):null,this.lazyRefresh=this.hasAttribute("refresh-on-view"),this.lazyRefresh){const e={root:null,rootMargin:"0px",threshold:.3};this.intersectionObserver=new IntersectionObserver(this.handleIntersect,e)}if(this.src=this.hasAttribute("src")?this.getAttribute("src"):null,this.src)return void this._loadFromSrc();this._injectDevtools();this.shadowRoot.querySelector("slot#default").addEventListener("slotchange",(async e=>{if(this.inited)return;if(this.hasAttribute("convert"))return void this.replaceWith(Ga.copyDom(this));this.ignoreExpressions&&(this.ignoredNodes=Array.from(this.querySelectorAll(this.ignoreExpressions)));let t=e.target.assignedElements().find((e=>"FX-MODEL"===e.nodeName.toUpperCase()));if(!t){const e=document.createElement("fx-model");return this.appendChild(e),void(t=e)}if(!t.inited){const e=new Map;!function t(n){for(const i of n.children)"setInScopeVariables"in i&&i.setInScopeVariables(e),t(i)}(this),await t.modelConstruct(),this._handleModelConstructDone()}this.model=t,this._createRepeatsFromAttributes(),this.inited=!0})),this.addEventListener("path-mutated",(()=>{this.someInstanceDataStructureChanged=!0})),this.addEventListener("refresh",(()=>{this.refresh(!0)})),this.hasAttribute("show-confirmation")&&(this.showConfirmation=!0)}_injectDevtools(){if(this.ownerDocument.querySelector("fx-devtools"))return;const{search:e}=window.location,t=new URLSearchParams(e);if(t.has("inspect")){const e=document.createElement("fx-devtools");document.body.appendChild(e)}if(t.has("lens")){const e=document.createElement("fx-lens");document.body.appendChild(e),e.setAttribute("open","open")}}addToRefresh(e){this.toRefresh.find((t=>t.path===e.path))||this.toRefresh.push(e)}scanForNewTemplateExpressionsNextRefresh(){this._scanForNewTemplateExpressionsNextRefresh=!0}markAsClean(){this.addEventListener("value-changed",(()=>{this.dirtyState=ll}),{once:!0}),this.dirtyState=al}async _loadFromSrc(){await Ga.loadForeFromSrc(this,this.src,"fx-fore")}handleIntersect(e,t){e.forEach((e=>{const{target:t}=e;Ga.getFore(t).initialRun||e.isIntersecting&&(t.classList.add("loaded"),"function"==typeof t.refresh?t.refresh(t,!0):Ga.refreshChildren(t,!0))})),e[0].target.getOwnerForm().dispatchEvent(new CustomEvent("refresh-done"))}evaluateToNodes(e,t){return Ba(e,t,this)}disconnectedCallback(){this.removeEventListener("dragstart",this.dragstart)}async forceRefresh(){Ga.refreshChildren(this,!0),this._updateTemplateExpressions(),this._scanForNewTemplateExpressionsNextRefresh=!1,this._processTemplateExpressions(),Ga.dispatch(this,"refresh-done",{})}async refresh(e){if(this.isRefreshing)return;this.isRefreshing=!0,e||this.initialRun||0===this.toRefresh.length?this.inited&&Ga.refreshChildren(this,e):(this.toRefresh.forEach((t=>{const n=t.boundControls;n&&n.forEach((t=>{t.refresh(e)}));const{mainGraph:i}=this.getModel();if(i&&i.hasNode(t.path)){const n=this.getModel().mainGraph.dependentsOf(t.path,!1);0!==n.length&&n.forEach((t=>{const n=va.getBasePath(t);this.getModel().modelItems.find((e=>e.path===n)).boundControls.forEach((t=>{t.refresh(e)}))}))}})),this.toRefresh=[]),(this.initialRun||this._scanForNewTemplateExpressionsNextRefresh)&&(this._updateTemplateExpressions(),this._scanForNewTemplateExpressionsNextRefresh=!1),this._processTemplateExpressions(),this.style.visibility="visible",Ga.dispatch(this,"refresh-done",{});const t=Array.from(this.querySelectorAll("fx-fore"));for(const n of t)n.ready&&await n.refresh(e);this.isRefreshing=!1}_updateTemplateExpressions(){const e=Ba("(descendant-or-self::*!(text(), @*))[contains(., '{')][substring-after(., '{') => contains('}')][not(ancestor-or-self::fx-model)]",this,this);this.storedTemplateExpressions||(this.storedTemplateExpressions=[]),Array.from(e).forEach((e=>{if((e.nodeType===Node.ATTRIBUTE_NODE?e.ownerElement:e.parentNode).closest("fx-fore")!==this)return;if(this.storedTemplateExpressionByNode.has(e))return;const t=this._getTemplateExpression(e);t&&this.storedTemplateExpressionByNode.set(e,t)})),this._processTemplateExpressions()}_processTemplateExpressions(){for(const e of Array.from(this.storedTemplateExpressionByNode.keys())){if(e.nodeType===Node.ATTRIBUTE_NODE){if(!va.contains(this,e.ownerElement)){this.storedTemplateExpressionByNode.delete(e);continue}}else if(!va.contains(this,e)){this.storedTemplateExpressionByNode.delete(e);continue}this._processTemplateExpression({node:e,expr:this.storedTemplateExpressionByNode.get(e)})}}_processTemplateExpression(e){const{expr:t}=e,{node:n}=e;this.evaluateTemplateExpression(t,n)}evaluateTemplateExpression(e,t){if(t.nodeType===Node.ATTRIBUTE_NODE&&t.ownerElement.closest("[nonrelevant]"))return;if(t.nodeType===Node.TEXT_NODE&&t.parentNode.closest("[nonrelevant]"))return;if(t.nodeType===Node.ELEMENT_NODE&&t.closest("[nonrelevant]"))return;const n=e.replace(/{[^}]*}/g,(e=>{if("{}"===e)return e;const n=e.substring(1,e.length-1),i=qa(t,n);if(!i)return(t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ATTRIBUTE_NODE)&&t.parentNode,e;const r=va.getInstanceId(n);r?this.getModel().getInstance(r):this.getModel().getDefaultInstance();try{return Xa(n,i,t,null)}catch(t){return e}}));if(t.nodeType===Node.ATTRIBUTE_NODE){const e=t.ownerElement;e.getAttribute(t.nodeName)!==n&&e.setAttribute(t.nodeName,n)}else t.nodeType===Node.TEXT_NODE&&t.textContent!==n&&(t.textContent=n)}_getTemplateExpression(e){if(this.ignoredNodes){e.nodeType===Node.ATTRIBUTE_NODE&&(e=e.ownerElement);const t=this.ignoredNodes.find((t=>t.contains(e)));if(t)return null}return e.nodeType===Node.ATTRIBUTE_NODE?e.value:e.nodeType===Node.TEXT_NODE?e.textContent.trim():null}_handleModelConstructDone(){this.markAsClean(),this.showConfirmation&&window.addEventListener("beforeunload",(e=>this.dirtyState===ll&&(e.preventDefault(),!0))),this._initUI()}async _lazyCreateInstance(){const e=this.querySelector("fx-model"),t=this.parentNode.nodeType!==Node.DOCUMENT_FRAGMENT_NODE?this.parentNode.closest("fx-fore"):null;if(this.parentNode.nodeType,Node.DOCUMENT_FRAGMENT_NODE,t){if(0!==t.getModel().instances.filter((e=>e.hasAttribute("shared"))).length)return}try{if(0===e.instances.length){const t=document.createElement("fx-instance");e.appendChild(t);const n=document.implementation.createDocument(null,"data",null);this._generateInstance(this,n.firstElementChild),t.instanceData=n,e.instances.push(t),Ga.dispatch(this,"instance-loaded",{instance:this})}}catch(e){}}_generateInstance(e,t){if(e.hasAttribute("ref")&&!Ga.isActionElement(e.nodeName)){const n=e.getAttribute("ref");if(n.includes("/")){n.split("/").forEach((n=>{t=this._generateNode(t,n,e)}))}else t=this._generateNode(t,n,e)}if(e.hasChildNodes()){const n=e.children;for(let e=0;e<n.length;e+=1)this._generateInstance(n[e],t)}return t}_generateNode(e,t,n){const i=e.ownerDocument.createElement(t);return 0===n.children.length&&(i.textContent=n.textContent),e.appendChild(i),e=i}async _initUI(){this.initialRun&&(this.classList.add("initialRun"),await this._lazyCreateInstance(),this.createNodes&&this.initData(),await this.refresh(!0),this.classList.add("fx-ready"),document.body.classList.add("fx-ready"),this.ready=!0,this.initialRun=!1,Ga.dispatch(this,"ready",{}),this.addEventListener("dragstart",this._handleDragStart),this.handleDrop=e=>this._handleDrop(e),this.ownerDocument.body.addEventListener("drop",this.handleDrop),this.ownerDocument.body.addEventListener("dragover",(e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="move"})))}initData(e=this){const t=Array.from(e.querySelectorAll("[ref]:not(fx-model *),fx-repeatitem"));e.matches("fx-repeatitem")&&t.unshift(e);for(let e=0;e<t.length;e++){const n=t[e];if(n.matches("fx-repeatitem")||n.evalInContext(),null!==n.nodeset)continue;const i=t[e-1];if(i.contains(n)){const e=i.nodeset,t=n.ref;if(e.querySelector(`[ref="${t}"]`))continue;const r=this._createNodes(t,e);e.insertBefore(r,e.firstChild),n.evalInContext();continue}const r=va.getParentBindingElement(n);let s=null;for(let n=e-1;n>0;--n){const e=t[n];if(va.getParentBindingElement(e)===r){s=e;break}}if(!s)throw new Error("Unexpected! there must be a sibling right?");const o=r.nodeset,a=n.ref;let l=s.nodeset;const h=this._createNodes(a,o);for(;l?.parentNode&&l?.parentNode!==o;)l=l.parentNode;o.insertBefore(h,l.nextElementSibling),n.evalInContext()}}_createNodes(e,t){let n;return e.includes("/")?(n=va.createElementFromXPath(e,t.ownerDocument,this),n):va.createElementFromXPath(e,t.ownerDocument,this)}_handleDragStart(e){const t=e.target.closest('[draggable="true"]');this.originalDraggedItem=t,"copy"===t.getAttribute("drop-action")?(e.dataTransfer.dropEffect="copy",e.dataTransfer.effectAllowed="copy",this.draggedItem=t.cloneNode(!0),this.draggedItem.setAttribute("drop-action","move"),this.copiedElements.add(this.draggedItem)):(e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",this.draggedItem=t)}_handleDrop(e){this.draggedItem&&("none"===e.dataTransfer.dropEffect&&this.copiedElements.has(this.originalDraggedItem)&&this.originalDraggedItem.remove(),this.originalDraggedItem=null,this.draggedItem=null,e.stopPropagation())}registerLazyElement(e){this.intersectionObserver&&this.intersectionObserver.observe(e)}unRegisterLazyElement(e){this.intersectionObserver&&this.intersectionObserver.unobserve(e)}getModel(){return this.querySelector("fx-model")}_displayMessage(e){const{level:t}=e.detail,n=e.detail.message;this._showMessage(t,n),e.stopPropagation()}_displayError(e){const t=e.detail.message;this.shadowRoot.querySelector("#error").showToast(t)}_displayWarning(e){const t=e.detail.message,n=va.shortenPath(Xa("path()",e.target,this));this.shadowRoot.querySelector("#warn").showToast(`WARN: ${n}:${t}`)}_logError(e){e.stopPropagation(),e.preventDefault(),e.detail.expr,this.strict&&this._displayError(e)}_copyToClipboard(e){navigator.clipboard.writeText(e.value)}_showMessage(e,t){if("modal"===e)this.shadowRoot.getElementById("messageContent").innerText=t,this.shadowRoot.getElementById("modalMessage").classList.add("show");else if("sticky"===e||"error"===e||"warn"===e)this.shadowRoot.querySelector(`#${e}`).showToast(t);else{this.shadowRoot.querySelector("#message").showToast(t)}}_createRepeatsFromAttributes(){if(this.repeatsFromAttributesCreated)return;const e=this.querySelectorAll("[data-ref]");e&&Array.from(e).forEach((e=>{if(e.closest("fx-control"))return;const t=e.parentNode.closest("table");let n;n=t?t.cloneNode(!0):e.cloneNode(!0);const i=new ol;i.setAttribute("ref",e.getAttribute("data-ref")),i.appendChild(n),t?(t.parentNode.insertBefore(i,t),t.parentNode.removeChild(t)):(e.parentNode.insertBefore(i,e),e.parentNode.removeChild(e)),e.setAttribute("insertPoint","")})),this.repeatsFromAttributesCreated=!0}}hl.outermostHandler=null,hl.draggedItem=null,customElements.get("fx-fore")||customElements.define("fx-fore",hl);class cl{static handleRelevance(e){const t=e.getModelItem();t&&t.relevant?(e.removeAttribute("nonrelevant"),e.setAttribute("relevant",""),Ga.dispatch(this,"relevant",{})):(e.removeAttribute("relevant"),e.setAttribute("nonrelevant",""),Ga.dispatch(this,"nonrelevant",{}))}static selectRelevant(e,t){return"xml"===t?cl._relevantXmlNodes(e):e.nodeset}static _relevantXmlNodes(e){if("keep"===e.getAttribute("nonrelevant"))return e.nodeset;const t=e.getModel().getModelItem(e.nodeset);if(t&&!t.relevant)return null;const n=e.nodeset.cloneNode(!1);return 0===e.nodeset.children.length&&cl._isRelevant(e,e.nodeset)?e.nodeset:cl._filterRelevant(e,e.nodeset,n)}static _filterRelevant(e,t,n){const{childNodes:i}=t;return Array.from(i).forEach((t=>{if(cl._isRelevant(e,t)){const i=t.cloneNode(!1);n.appendChild(i);const{attributes:r}=t;return r&&Array.from(r).forEach((t=>{"empty"!==e.nonrelevant||cl._isRelevant(e,t)?cl._isRelevant(e,t)?i.setAttribute(t.nodeName,t.value):i.removeAttribute(t.nodeName):i.setAttribute(t.nodeName,"")})),cl._filterRelevant(e,t,i)}return null})),n}static _isRelevant(e,t){const n=e.getModel().getModelItem(t);return(t.nodeType!==Node.ATTRIBUTE_NODE||""!==t.nodeValue)&&(!n||!!n.relevant)}}class ul extends Ka{constructor(){super(),this.attachShadow({mode:"open"}),this.credentials="",this.parameters=new Map}connectedCallback(){this.methods=["get","put","post","delete","head","urlencoded-post"],this.model=this.parentNode,this.hasAttribute("id"),this.id=this.getAttribute("id"),this.instance=this.hasAttribute("instance")?this.getAttribute("instance"):null,this.into=this.hasAttribute("into")?this.getAttribute("into"):null,this.method=this.hasAttribute("method")?this.getAttribute("method"):"get",this.nonrelevant=this.hasAttribute("nonrelevant")?this.getAttribute("nonrelevant"):"remove",this.replace=this.hasAttribute("replace")?this.getAttribute("replace"):"all",this.serialization=this.hasAttribute("serialization")?this.getAttribute("serialization"):"xml",this.mediatype=this.hasAttribute("mediatype")?this.getAttribute("mediatype"):"application/xml",this.responseMediatype=this.hasAttribute("responsemediatype")?this.getAttribute("responsemediatype"):this.mediatype,this.url=this.hasAttribute("url")?this.getAttribute("url"):null,this.targetref=this.hasAttribute("targetref")?this.getAttribute("targetref"):null,this.validate=this.getAttribute("validate")?this.getAttribute("validate"):"true",this.credentials=this.hasAttribute("credentials")?this.getAttribute("credentials"):"same-origin",["same-origin","include","omit"].includes(this.credentials),this.shadowRoot.innerHTML=this.renderHTML()}renderHTML(){return"\n      <slot></slot>\n    "}async submit(){await Ga.dispatch(this,"submit",{submission:this}),await this._submit()}async _submit(){this.evalInContext();const e=this.getModel();if(e.recalculate(),"true"===this.validate&&"get"!==this.method){if(!e.revalidate())return this.getOwnerForm().classList.add("submit-validation-failed"),Ga.dispatch(this,"submit-error",{}),void this.getModel().parentNode.refresh(!0)}await this._serializeAndSend()}_getProperty(e){return this.parameters.has(e)?this.parameters.get(e):this.getAttribute(e)}async _serializeAndSend(){const e=this._getProperty("url"),t=this.evaluateAttributeTemplateExpression(e,this),n=this.getInstance();n||Ga.dispatch(this,"warn",{message:`instance not found ${n.getAttribute("id")}`});const i=n.getAttribute("type");let r;if("none"===this.serialization)r=void 0;else{const e=cl.selectRelevant(this,i);r=this._serialize(i,e)}if("get"===this.method.toLowerCase()&&(r=void 0),t.startsWith("#echo")){const e=this._parse(r,n);return this._handleResponse(e),Ga.dispatch(this,"submit-done",{}),void this.parameters.clear()}if(t.startsWith("localStore:")){if("get"===this.method||"consume"===this.method){this.replace="instance";const e=t.substring(t.indexOf(":")+1),i=localStorage.getItem(e);if(!i)return Ga.dispatch(this,"submit-error",{message:`Error reading key ${e} from localstorage`}),void this.parameters.clear();const r=this._parse(i,n);this._handleResponse(r),"consume"===this.method&&localStorage.removeItem(e),Ga.dispatch(this,"submit-done",{})}if("post"===this.method){const e=t.substring(t.indexOf(":")+1);localStorage.setItem(e,r),this._handleResponse(n.instanceData),Ga.dispatch(this,"submit-done",{})}if("delete"===this.method){const e=t.substring(t.indexOf(":")+1);localStorage.removeItem(e);const n=(new DOMParser).parseFromString("<data></data>","application/xml");this.replace="instance",this._handleResponse(n),Ga.dispatch(this,"submit-done",{})}return}const s=this._getHeaders();if(this.methods.includes(this.method.toLowerCase()))try{const e=await fetch(t,{method:this.method,credentials:this.credentials,mode:"cors",headers:s,body:r});if(!e.ok||e.status>400)return void Ga.dispatch(this,"submit-error",{message:`Error while submitting ${this.id}`});const n=e.headers.get("content-type").toLowerCase();if(n.startsWith("text/")){const i=await e.text();this._handleResponse(i,t,n)}else if(n.startsWith("application/json")){const i=await e.json();this._handleResponse(i,t,n)}else if(n.startsWith("application/xml")){const i=await e.text(),r=(new DOMParser).parseFromString(i,"application/xml");this._handleResponse(r,t,n)}else{const i=await e.blob();this._handleResponse(i,t,n)}Ga.dispatch(this,"submit-done",{})}catch(e){Ga.dispatch(this,"submit-error",{error:e.message})}finally{this.parameters.clear();const e=document.querySelector("[download]");e&&document.body.removeChild(e)}else Ga.dispatch(this,"error",{message:`Unknown method ${this.method}`})}_parse(e,t){let n=null;return e&&"xml"===t.getAttribute("type")&&(n=(new DOMParser).parseFromString(e,"application/xml")),e&&"json"===t.getAttribute("type")&&(n=JSON.parse(e)),e&&"text"===t.getAttribute("type")&&(n=e),n}_serialize(e,t){if("application/x-www-form-urlencoded"===this.serialization){const e=new URLSearchParams;return Array.from(t.children).forEach((t=>{e.append(t.nodeName,t.textContent)})),e}if("xml"===e){return(new XMLSerializer).serializeToString(t)}if("json"===e)return JSON.stringify(t);if("text"===e)return t;throw new Error("unknown instance type ",e)}_getHeaders(){const e=new Headers,t=this.getInstance(),n=Ga.getContentType(t,this.serialization);e.append("Content-Type",n),e.has("Accept")&&e.delete("Accept");const i=this.querySelectorAll("fx-header");return Array.from(i).forEach((t=>{const{name:n}=t,i=t.getValue();e.append(n,i)})),e}_getUrlExpr(){return this.storedTemplateExpressions.find((e=>"url"===e.node.nodeName))}_getTargetInstance(){let e;if(e=this.instance?this.model.getInstance(this.instance):this.model.getInstance("default"),!e)throw new Error(`target instance not found: ${e}`);return e}_handleResponse(e,t,n){const i=this._getTargetInstance();if("instance"===this.replace){if(!i)throw new Error(`target instance not found: ${i}`);if(this.targetref){const[t]=Ra(this.targetref,i.instanceData.firstElementChild,this);if("application/xml"===this.responseMediatype||"text/html"===this.responseMediatype){const n=e.firstElementChild;t.parentNode.replaceChild(n,t)}this.responseMediatype.startsWith("text/")&&(t.textContent=e),this.responseMediatype}else if(this.into){const[t]=Ra(this.into,i.instanceData.firstElementChild,this);e.nodeType===Node.DOCUMENT_NODE?t.appendChild(e.firstElementChild):t.innerHTML=e}else{const t=e;i.instanceData=t}this.model.inited&&(this.model.updateModel(),this.getOwnerForm().refresh(!0))}if("download"===this.replace){const t=this._getProperty("target"),i=document.createElement("a");i.setAttribute("download",t),i.setAttribute("href",`data:${n},${e}`),document.body.appendChild(i),i.click()}if("all"===this.replace){const n=this._getProperty("target");if(n&&"_blank"===n){const t=window.open("","_blank");t.document.write(`<pre>${e}</pre>`),t.document.close()}else document.open(),document.write(e),document.close(),window.location.href=t}if("target"===this.replace){const t=this._getProperty("target"),i=document.querySelector(t);if(i){if(n.startsWith("text/html")&&(i.innerHTML=e),this.responseMediatype.startsWith("image/svg")){(new DOMParser).parseFromString(e,"image/svg+xml");const t=URL.createObjectURL(e);i.src=t}}else Ga.dispatch(this,"submit-error",{message:`targetNode for selector ${t} not found`})}"redirect"===this.replace&&(window.location.href=e)}_handleError(){Ga.dispatch(this,"submit-error",{})}}customElements.get("fx-submission")||customElements.define("fx-submission",ul);class dl extends Ka{constructor(){if(super(),this.style.display="none",this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML="",!this.hasAttribute("name"))throw new Error('required attribute "name" missing');this.name=this.getAttribute("name")}connectedCallback(){this.shadowRoot.innerHTML=""}}customElements.get("fx-header")||customElements.define("fx-header",dl);const pl=sa("item()*");class fl extends Ka{constructor(){super(),this.attachShadow({mode:"open"}),this.name="",this.valueQuery="",this.value=null,this.precedingVariables=[]}connectedCallback(){this.name=this.getAttribute("name"),this.valueQuery=this.getAttribute("value")}refresh(){const e=qa(this,this.valueQuery),t=Ra(this.valueQuery,e,this,this.precedingVariables);this.value=pl(t,oa)}setInScopeVariables(e){e.has(this.name)?Ga.dispatch(this,"xforms-binding-error",{}):(e.set(this.name,this),this.inScopeVariables=new Map(e))}}customElements.get("fx-var")||customElements.define("fx-var",fl);class ml extends Ka{constructor(){super(),this.value=null,this.display=this.style.display,this.required=!1,this.readonly=!1,this.widget=null,this.visited=!1,this.force=!1}getWidget(){throw new Error("You have to implement the method getWidget!")}async refresh(e){e&&(this.force=!0);const t=this.value;var n,i,r;if(!this.isNotBound()&&(this.evalInContext(),this.oldVal=this.nodeset?this.nodeset:null,this.isBound())){if(!this.nodeset){if(this.closest("[create]")){let e,t,n;if(this.ref.includes("/")){t=this.ref.substring(0,this.ref.indexOf("/"));n=Ma(t,qa(this.parentNode,this.ref),this),n&&n.nodeType===Node.ELEMENT_NODE&&(this.ref.includes("@")?(e=this.ref.substring(this.ref.indexOf("/")+2),n.setAttribute(e,"")):Ga.dispatch(this,"warn",{message:'"create" is not implemented for elements'}))}else{const t=qa(this,this.ref);this.ref.includes("@")?(e=this.ref.substring(this.ref.indexOf("@")+1),t.setAttribute(e,"")):Ga.dispatch(this,"warn",{message:'"create" is not implemented for elements'})}}else this.setAttribute("nonrelevant","");return}if(this.modelItem=this.getModelItem(),this.modelItem instanceof Ha){if(this.hasAttribute("as")&&"node"===this.getAttribute("as")?(this.modelItem.node=this.nodeset,this.value=this.modelItem.node):this.value=this.modelItem.value,this.modelItem.boundControls.includes(this)||this.modelItem.boundControls.push(this),await this.updateWidgetValue(),this.handleModelItemProperties(),this.getOwnerForm().initialRun&&Ga.dispatch(this,"init",{}),!this.getOwnerForm().ready)return;if("fx-control"!==this.localName&&"fx-upload"!==this.localName)return;n=this.oldVal,i=t,r=this.value,null!==n&&null!==i&&(r&&i&&r.nodeType&&i.nodeType?r.outerHTML!==i.outerHTML:i!==r)&&(this.getModel(),Ga.dispatch(this,"value-changed",{path:this.modelItem.path,value:this.modelItem.value,oldvalue:t,instanceId:this.modelItem.instanceId,foreId:this.getOwnerForm().id}))}}}refreshFromModelItem(e){}async updateWidgetValue(){throw new Error("You have to implement the method updateWidgetValue!")}handleModelItemProperties(){this.handleRequired(),this.handleReadonly(),this.getOwnerForm().ready&&this.handleValid(),this.handleRelevant()}_getForm(){return this.getModel().parentNode}_dispatchEvent(e){this.getOwnerForm().ready&&Ga.dispatch(this,e,{})}handleRequired(){this.widget=this.getWidget();const e=this.isRequired();if(!this.modelItem.required)return this.widget.removeAttribute("required"),this.removeAttribute("required"),void(e!==this.modelItem.required&&this._dispatchEvent("optional"));(this.visited||this.force)&&(""===this.modelItem.value?(this.classList.add("isEmpty"),this._toggleValid(!1)):(this.classList.remove("isEmpty"),this._toggleValid(!0))),this.widget.setAttribute("required",""),this.setAttribute("required",""),e!==this.modelItem.required&&this._dispatchEvent("required")}_updateRequired(){this.modelItem.required?((this.visited||this.force)&&(""===this.modelItem.value?(this.classList.add("isEmpty"),this._toggleValid(!1)):(this.classList.remove("isEmpty"),this._toggleValid(!0))),this.widget.setAttribute("required",""),this.setAttribute("required",""),this._dispatchEvent("required")):(this.widget.removeAttribute("required"),this.removeAttribute("required"),this._dispatchEvent("optional"))}_toggleValid(e){e?(this.removeAttribute("invalid"),this.setAttribute("valid","")):(this.removeAttribute("valid"),this.setAttribute("invalid",""))}handleReadonly(){this.isReadonly()!==this.modelItem.readonly&&(this.modelItem.readonly&&(this.widget.setAttribute("readonly",""),this.setAttribute("readonly",""),this._dispatchEvent("readonly")),this.modelItem.readonly||(this.widget.removeAttribute("readonly"),this.removeAttribute("readonly"),this._dispatchEvent("readwrite")))}handleValid(){if(this.isValid()!==this.modelItem.constraint)if(this.modelItem.constraint)this._dispatchEvent("valid"),this.setAttribute("valid",""),this.removeAttribute("invalid");else{if(this.setAttribute("invalid",""),this.removeAttribute("valid"),0!==this.modelItem.alerts.length){if(!this.querySelector("fx-alert")){const{alerts:e}=this.modelItem;e.forEach((e=>{const t=document.createElement("fx-alert");t.innerHTML=e,this.appendChild(t)}))}}this._dispatchEvent("invalid")}}handleRelevant(){const e=this.modelItem.node;if(this.removeAttribute("relevant"),this.removeAttribute("nonrelevant"),Array.isArray(e)&&0===e.length)return this._dispatchEvent("nonrelevant"),void this.setAttribute("nonrelevant","");this.isEnabled()!==this.modelItem.relevant&&(this.modelItem.relevant?(this._dispatchEvent("relevant"),this.setAttribute("relevant","")):(this._dispatchEvent("nonrelevant"),this.setAttribute("nonrelevant","")))}isRequired(){return this.hasAttribute("required")}isValid(){return!this.hasAttribute("invalid")}isReadonly(){return this.hasAttribute("readonly")}isEnabled(){return!this.hasAttribute("nonrelevant")}_fadeOut(e){e.style.opacity=1,function t(){(e.style.opacity-=.1)<0?e.style.display="none":requestAnimationFrame(t)}()}_fadeIn(e,t){e.style.opacity=0,e.style.display=t||"block",function t(){let n=parseFloat(e.style.opacity);(n+=.1)>1||(e.style.opacity=n,requestAnimationFrame(t))}()}}customElements.get("fx-abstract-control")||window.customElements.define("fx-abstract-control",ml);class gl extends ml{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.shadowRoot.innerHTML="\n        <style>\n            \n      :host {\n        height: auto;\n        font-size: 0.8em;\n        font-weight: 400;\n        color: red;\n      }\n    \n        </style>\n        \n      <slot></slot>\n    \n    "}getWidget(){return this}async updateWidgetValue(){this.innerHTML=this.value}}function Ol(e,t,n=300){let i;return(...r)=>{clearTimeout(i),i=setTimeout((()=>{t.apply(e,r)}),n)}}customElements.get("fx-alert")||customElements.define("fx-alert",gl);class yl extends ml{constructor(){super(),this.inited=!1,this.nodeset=null,this.attachShadow({mode:"open"})}static get properties(){return{...ml.properties,credentials:{type:String},initial:{type:Boolean},src:{type:String}}}_getValueFromHtmlDom(){return"selectedOptions"===this.valueProp?[...this.widget.selectedOptions].map((e=>e.value)).join(" "):this.widget[this.valueProp]}connectedCallback(){this.initial=this.hasAttribute("initial")?this.getAttribute("initial"):null,this.src=this.hasAttribute("src")?this.getAttribute("src"):null,this.loaded=!1,this.initialNode=null,this.debounceDelay=this.hasAttribute("debounce")?this.getAttribute("debounce"):null,this.updateEvent=this.hasAttribute("update-event")?this.getAttribute("update-event"):"blur",this.label=this.hasAttribute("label")?this.getAttribute("label"):null;this.credentials=this.hasAttribute("credentials")?this.getAttribute("credentials"):"same-origin",["same-origin","include","omit"].includes(this.credentials),this.shadowRoot.innerHTML=`\n            <style>\n                \n            :host{\n                display:inline-block;\n            }\n        \n            </style>\n            ${this.renderHTML(this.ref)}\n        `,this.widget=this.getWidget(),this.addEventListener("mousedown",(e=>{Ga.isWidget(e.target)||e.target?.classList.contains("fx-hint")||e.preventDefault(),this.widget.focus()}));const e=this.widget.hasAttribute("multiple")?"selectedOptions":"value";this.valueProp=this.hasAttribute("value-prop")?this.getAttribute("value-prop"):e;let t=this.widget;if(this.hasAttribute("listen-on")){const e=this.getAttribute("listen-on"),n=this.querySelector(e);n&&(t=n)}this.addEventListener("keyup",(()=>{Ya.dataChanged=!0})),"enter"===this.updateEvent&&(this.widget.addEventListener("keyup",(e=>{13===e.keyCode&&(e.preventDefault(),this.setValue(this._getValueFromHtmlDom()))})),this.updateEvent="blur"),this.debounceDelay?t.addEventListener(this.updateEvent,Ol(this,(()=>{this.setValue(this._getValueFromHtmlDom())}),this.debounceDelay)):(t.addEventListener(this.updateEvent,(e=>{this.setValue(this._getValueFromHtmlDom())})),t.addEventListener("blur",(e=>{this.setValue(this._getValueFromHtmlDom())}),{once:!0})),this.addEventListener("return",(e=>{const t=e.detail.nodeset;e.stopPropagation(),this._replaceNode(t)})),this.widget.addEventListener("focus",(()=>{})),this.template=this.querySelector("template"),this.boundInitialized=!1,this.static=!!this.widget.hasAttribute("static")}_debounce(e,t=300){let n;return(...i)=>{const r=this;clearTimeout(n),n=setTimeout((()=>{e.apply(r,i)}),t)}}setValue(e){const t=this.getModelItem();if(this.getAttribute("class")?this.classList.add("visited"):this.setAttribute("class","visited"),t?.readonly)return;if("node"===this.getAttribute("as")){const e=this.shadowRoot.getElementById("replace"),n=this.getWidget()[this.valueProp];return e.replace(this.nodeset,n),void(t&&n&&n!==t.value&&(t.value=n,Ya.dataChanged=!0,e.actionPerformed()))}const n=this.shadowRoot.getElementById("setvalue");n.setValue(t,e),this.modelItem instanceof Ha&&!this.modelItem?.boundControls.includes(this)&&this.modelItem.boundControls.push(this),n.actionPerformed()}_replaceNode(e){e.nodeType===Node.ATTRIBUTE_NODE?this.modelItem.node.nodeValue=e.nodeValue:e.nodeType===Node.ELEMENT_NODE?this.modelItem.node.replaceWith(e.cloneNode(!0)):e.nodeType===Node.TEXT_NODE?this.modelItem.node.nodeValue=e.textContent:Ga.dispatch(this,"warn",{message:"trying to replace a node that is neither an Attribute, Elemment or Text node"})}renderHTML(e){return`\n            ${this.label?`${this.label}`:""}\n            <slot></slot>\n            ${this.hasAttribute("as")&&"node"===this.getAttribute("as")?'<fx-replace id="replace" ref=".">':`<fx-setvalue id="setvalue" ref="${e}"></fx-setvalue>`}\n\n        `}getWidget(){if(this.widget)return this.widget;let e=this.querySelector(".widget");if(e||(e=this.querySelector("input"),e&&!e.classList.contains("widget")&&e.classList.add("widget")),!e){const e=document.createElement("input");return e.classList.add("widget"),e.setAttribute("type","text"),this.appendChild(e),e}return e}async updateWidgetValue(){let{widget:e}=this;if(e||(e=this),"checked"!==this.valueProp)if("radio"!==this.widget.type)if("selectedOptions"!==this.valueProp)if(this.hasAttribute("as")){const t=this.getAttribute("as");if("text"===t){const t=new XMLSerializer,n=Ga.prettifyXml(t.serializeToString(this.nodeset));e.value=n}if("node"===t&&this.nodeset!==e.value){const t=this.nodeset;if(e.value&&t!==this.widget.value)return void(e.value=this.nodeset.cloneNode(!0));e.value=this.nodeset.cloneNode(!0)}}else{if(this.src&&!this.loaded&&this.modelItem.relevant)return this.initial&&(this.initialNode=Ma(this.initial,this.nodeset,this)),await this._loadForeFromSrc(),void(this.loaded=!0);e.value!==this.value&&(e.value=this.value)}else{const e=new Set(this.value.split(" "));for(const t of[...this.widget.querySelectorAll("option")])e.has(t.value)?t.selected=!0:t.selected=!1}else{const e=this.querySelector(`input[value=${this.value}]`);e&&(e.checked=!0)}else"true"===this.value?e.checked=!0:e.checked=!1}async _loadForeFromSrc(){try{const e=await fetch(this.src,{method:"GET",credentials:this.credentials,mode:"cors",headers:{"Content-Type":"text/html"}});let t;t=e.headers.get("content-type").toLowerCase().startsWith("text/html")?await e.text().then((e=>(new DOMParser).parseFromString(e,"text/html"))):"done";const n=t.querySelector("fx-fore"),i=document.importNode(n,!0);i.classList.add("widget"),i.addEventListener("model-construct-done",(e=>{const t=i.querySelector("fx-instance");if(this.initial){const e=(new DOMParser).parseFromString("<data></data>","application/xml");this.initialNode=Ma(this.initial,this.nodeset,this),e.firstElementChild.appendChild(this.initialNode.cloneNode(!0)),t.instanceData=e}i.model=i.querySelector("fx-model"),i.model.updateModel(),i.refresh(!0)}),{once:!0});const r=this.querySelector("input");this.hasAttribute("shadow")?(r.parentNode.removeChild(r),this.shadowRoot.appendChild(i)):this.loaded||r.replaceWith(i),n||Ga.dispatch("error",{detail:{message:`Fore element not found in '${this.src}'. Maybe wrapped within 'template' element?`}}),Ga.dispatch("loaded",{detail:{fore:n}})}catch(e){Ga.dispatch(this,"error",{origin:this,message:`control couldn't be loaded from src '${this.src}'`,level:"Error"})}}getTemplate(){return this.querySelector("template")}async refresh(e){super.refresh(e);const t=this.getWidget();this._handleBoundWidget(t),this._handleDataAttributeBinding(),Ga.refreshChildren(this,e)}_handleDataAttributeBinding(){const e=this.querySelector("[data-ref]");e&&e.closest("fx-control")===this&&(this.boundList=e,e.getAttribute("data-ref"),this._handleBoundWidget(e))}_handleBoundWidget(e){if(this.boundInitialized&&this.static)return;const t=e.hasAttribute("ref")?e.getAttribute("ref"):e.getAttribute("data-ref");if(e&&t){const n=Ra(t,qa(this,t),this),{children:i}=e;if(Array.from(i).forEach((e=>{"template"!==e.nodeName.toLowerCase()&&e.parentNode.removeChild(e)})),Array.isArray(n)&&0===n.length)return;const{template:r}=this;if(r){if("SELECT"===this.widget.nodeName&&this.widget.hasAttribute("selection")&&"open"===this.widget.getAttribute("selection")){const e=this.template.firstElementChild,t=document.createElement("option");this.widget.insertBefore(t,e)}if(0!==n.length){const e=document.createDocumentFragment();Array.from(n).forEach((t=>{const n=this.createEntry();e.appendChild(n),this.updateEntry(n,t)})),this.template.parentNode.appendChild(e)}else{const e=this.createEntry();this.template.parentNode.appendChild(e),this.updateEntry(e,n)}this.boundInitialized=!0}if("selectedOptions"===this.valueProp){const e=new Set(this.value.split(" ")),t=this.getWidget().querySelectorAll("option");for(const n of[...t])e.has(n.value)?n.selected=!0:n.selected=!1}}}updateEntry(e,t){const n=this._getValueAttribute(e);if(!n)return;const i=n.value,r=Xa(i.substring(1,i.length-1),t,e);n.value=r,this.value===r&&e.setAttribute("selected","selected");const s=e.textContent;this.evalLabel(s,t,e)}evalLabel(e,t,n){const i=e.substring(1,e.length-1);if(!i)return;const r=Xa(i,t,this);n.textContent=r}createEntry(){return this.template.content.firstElementChild.cloneNode(!0)}_getValueAttribute(e){let t;return Array.from(e.attributes).forEach((e=>{-1!==e.value.indexOf("{")&&(t=e)})),t}}customElements.get("fx-control")||window.customElements.define("fx-control",yl);class vl extends Ka{static get properties(){return{...super.properties}}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.src=this.hasAttribute("src")?this.getAttribute("src"):null;this.shadowRoot.innerHTML="\n            <style>\n                \n        :host {\n            display: block;\n        }\n    \n            </style>\n            \n      <slot></slot>\n    \n    ",""!==this.ref&&this.getOwnerForm().registerLazyElement(this)}async refresh(e){!e&&this.hasAttribute("refresh-on-view")||this.isBound()&&(this.evalInContext(),this.modelItem=this.getModelItem(),this.modelItem&&!this.modelItem.boundControls.includes(this)&&this.modelItem.boundControls.push(this),this.handleModelItemProperties())}handleModelItemProperties(){this.handleRelevant()}_getForm(){return this.getModel().parentNode}handleRelevant(){if(!this.modelItem)return this.removeAttribute("relevant",""),this.setAttribute("nonrelevant",""),void this.dispatchEvent(new CustomEvent("disabled",{}));this.isEnabled()!==this.modelItem.enabled&&(this.modelItem.relevant?(this.removeAttribute("nonrelevant",""),this.setAttribute("relevant",""),this.dispatchEvent(new CustomEvent("enabled",{}))):(this.removeAttribute("relevant",""),this.setAttribute("nonrelevant",""),this.dispatchEvent(new CustomEvent("disabled",{}))))}isReadonly(){return!!this.hasAttribute("readonly")}isEnabled(){return"none"!==this.style.display}}customElements.get("fx-container")||window.customElements.define("fx-container",vl);class bl extends vl{static get properties(){return{...super.properties,collapse:{type:Boolean,reflect:!0}}}constructor(){super(),this.collapse=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","group")}render(){return"\n      <slot></slot>\n    "}handleModelItemProperties(){this.handleRelevant()}initializeChildren(e){Array.from(e.children).forEach((e=>{if(Ga.isUiElement(e.nodeName))e.init(this.model);else if(0!==e.children.length){Array.from(e.children).forEach((e=>{this.initializeChildren(e)}))}}))}async refresh(e){super.refresh(e),Ga.refreshChildren(this,!!e)}}customElements.get("fx-group")||window.customElements.define("fx-group",bl);class wl extends ml{static get styles(){return"\n      :host {\n        display: block;\n        height: auto;\n        font-size: 0.8em;\n        font-weight: 400;\n        font-style: italic;\n      }\n    "}static get properties(){return{...super.properties}}render(){return"\n      <slot></slot>\n    "}}customElements.get("fx-hint")||customElements.define("fx-hint",wl);class xl extends ml{constructor(){super(),this.attachShadow({mode:"open"}),this.valueAttr=this.hasAttribute("value")?this.getAttribute("value"):null,this.readonly=!0}connectedCallback(){this.shadowRoot.innerHTML='\n            <style>\n                \n          :host {\n            display: inline-block;\n            max-width:100%;\n          }\n          #widget {\n            display: inline-block;\n          }\n          .label{\n            display: inline-block;\n          }\n          #value{\n            max-width:100%;\n          }\n        \n            </style>\n            \n            <slot name="label"></slot>\n            \n            <span id="value">\n                <slot name="default"></slot>\n            </span>\n        \n        ',this.mediatype=this.hasAttribute("mediatype")?this.getAttribute("mediatype"):null}async refresh(){this.ref&&await super.refresh(),this.valueAttr&&(this.value=this.getValue(),await this.updateWidgetValue())}getValue(){try{const e=qa(this,this.valueAttr);return this.hasAttribute("html")?Ra(this.valueAttr,e,this)[0]:function(e,t,n,i=null){try{const r=Na(e,t,n);return pa(e,t,i,{},{currentContext:{formElement:n},functionNameResolver:Ia,moduleImports:{xf:Sa},namespaceResolver:r})}catch(t){n.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,detail:{origin:n,message:`Expression '${e}' failed`,expr:e,level:"Error"}}))}}(this.valueAttr,e,this)[0]}catch(e){Ga.dispatch(this,"error",{message:e})}return null}getWidget(){return this.shadowRoot.getElementById("value")}handleReadonly(){this.setAttribute("readonly","readonly")}async updateWidgetValue(){const e=this.shadowRoot.getElementById("value");if(e.innerHTML="","html"!==this.mediatype){if("image"===this.mediatype){const t=document.createElement("img");return t.setAttribute("src",this.value),this.innerHTML="",void e.appendChild(t)}e.innerHTML=this.value}else if(this.modelItem.node){this.shadowRoot.querySelector("#default");const{node:t}=this.modelItem;if(t.nodeType)return void e.append(t);const n=(new DOMParser).parseFromString(t,"text/html").body.childNodes;return void Array.from(n).forEach((t=>{e.append(t)}))}}isReadonly(){return!0}}customElements.get("fx-output")||customElements.define("fx-output",xl);class Sl extends(sl(Ka)){static get properties(){return{...super.properties,inited:{type:Boolean}}}constructor(){super(),this.inited=!1,this.addEventListener("click",this._dispatchIndexChange),this.addEventListener("focusin",this._dispatchIndexChange),this.attachShadow({mode:"open",delegatesFocus:!0}),this.dropTarget=null}connectedCallback(){super.connectedCallback(),this.display=this.style.display;this.shadowRoot.innerHTML="\n            \n           <slot></slot>\n        \n        ",this.getOwnerForm().registerLazyElement(this),this.ref=`${this.parentNode.ref}`,this.tabindex=0}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this._dispatchIndexChange),this.removeEventListener("focusin",this._handleFocus)}init(){this.inited=!0}_dispatchIndexChange(){this.parentNode.index!==this.index&&this.dispatchEvent(new CustomEvent("item-changed",{composed:!1,bubbles:!0,detail:{item:this,index:this.index}}))}refresh(e){this.modelItem=this.getModelItem(),this.modelItem.boundControls.includes(this)||(this.modelItem.boundControls.push(this),this.modelItem&&!this.modelItem.relevant?(this.removeAttribute("relevant"),this.setAttribute("nonrelevant","")):(this.removeAttribute("nonrelevant"),this.setAttribute("relevant",""))),Ga.refreshChildren(this,e)}}customElements.get("fx-repeatitem")||window.customElements.define("fx-repeatitem",Sl);class kl extends(sl(Ka)){static get properties(){return{...super.properties,index:{type:Number},template:{type:Object},focusOnCreate:{type:String},initDone:{type:Boolean},repeatIndex:{type:Number},nodeset:{type:Array}}}constructor(){super(),this.ref="",this.dataTemplate=[],this.isDraggable=null,this.dropTarget=null,this.focusOnCreate="",this.initDone=!1,this.repeatIndex=1,this.nodeset=[],this.inited=!1,this.index=1,this.repeatSize=0,this.attachShadow({mode:"open",delegatesFocus:!0})}get repeatSize(){return this.querySelectorAll(":scope > fx-repeatitem").length}set repeatSize(e){this.size=e}setIndex(e){this.index=e;const t=this.querySelectorAll(":scope > fx-repeatitem");this.applyIndex(t[this.index-1]),this.getOwnerForm().refresh({reason:"index-function"})}applyIndex(e){this._removeIndexMarker(),e&&e.setAttribute("repeat-index","")}get index(){return parseInt(this.getAttribute("index"),10)}set index(e){this.setAttribute("index",e)}_getRef(){return this.getAttribute("ref")}connectedCallback(){super.connectedCallback(),this.ref=this.getAttribute("ref"),this.addEventListener("item-changed",(e=>{const{item:t}=e.detail,n=Array.from(this.children).indexOf(t);this.setIndex(n+1)})),document.addEventListener("index-changed",(e=>{if(e.stopPropagation(),!e.target===this)return;const{index:t}=e.detail;this.index=parseInt(t,10),this.applyIndex(this.children[t-1])})),this.mutationObserver=new MutationObserver((e=>{if("childList"===e[0].type){const t=e[0].addedNodes[0];if(t){const e=va.resolveInstance(this,this.ref),n=va.getPath(t,e);Ga.dispatch(this,"path-mutated",{path:n,index:this.index})}}})),this.getOwnerForm().registerLazyElement(this);this.shadowRoot.innerHTML='\n            <style>\n                \n      :host{\n      }\n       .fade-out-bottom {\n          -webkit-animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n          animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n      }\n      .fade-out-bottom {\n          -webkit-animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n          animation: fade-out-bottom 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n      }\n   \n            </style>\n            \n          <slot name="header"></slot>\n          <slot></slot>\n        \n        '}_createNewRepeatItem(){const e=document.createElement("fx-repeatitem");this.isDraggable&&(e.setAttribute("draggable","true"),e.setAttribute("tabindex",0));const t=this._clone();return e.appendChild(t),e}init(){this._evalNodeset(),this._initTemplate(),this._initRepeatItems(),this.setAttribute("index",this.index),this.inited=!0}_evalNodeset(){const e=qa(this.getAttributeNode("ref")||this,this.ref);this.mutationObserver&&e.nodeName&&this.mutationObserver.observe(e,{childList:!0,subtree:!0});const t=Ra(this.ref,e,this);1===t.length&&Array.isArray(t[0])?this.nodeset=t[0]:this.nodeset=t}async refresh(e){this.inited||this.init(),this._evalNodeset();const t=this.querySelectorAll(":scope > fx-repeatitem"),n=t.length;let i=1;Array.isArray(this.nodeset)&&(i=this.nodeset.length);const r=i;if(r<n)for(let e=n;e>r;e-=1){const n=t[e-1];n.parentNode.removeChild(n),this.getOwnerForm().unRegisterLazyElement(n)}if(r>n)for(let e=n+1;e<=r;e+=1){const t=this._createNewRepeatItem();this.appendChild(t),this._initVariables(t),t.nodeset=this.nodeset[e-1],t.index=e,this.getOwnerForm().createNodes&&this.getOwnerForm().initData(t),this.getOwnerForm().scanForNewTemplateExpressionsNextRefresh()}for(let e=0;e<n;e+=1){const n=t[e];this.getOwnerForm().registerLazyElement(n),n.nodeset!==this.nodeset[e]&&(n.nodeset=this.nodeset[e])}this.getOwnerForm().lazyRefresh&&!e||Ga.refreshChildren(this,e),this.setIndex(this.index)}_fadeOut(e){e.style.opacity=1,function t(){(e.style.opacity-=.1)<0?e.style.display="none":requestAnimationFrame(t)}()}_fadeIn(e){e&&(e.style.opacity=0,e.style.display=this.display,function t(){let n=parseFloat(e.style.opacity);(n+=.1)>1||(e.style.opacity=n,requestAnimationFrame(t))}())}_initTemplate(){this.template=this.querySelector("template"),this.dropTarget=this.template.getAttribute("drop-target"),this.isDraggable=this.template.hasAttribute("draggable")?this.template.getAttribute("draggable"):null,null===this.template&&this.dispatchEvent(new CustomEvent("no-template-error",{composed:!0,bubbles:!0,detail:{message:`no template found for repeat:${this.id}`}})),this.shadowRoot.appendChild(this.template)}_initRepeatItems(){this.nodeset.forEach(((e,t)=>{const n=this._createNewRepeatItem();n.nodeset=this.nodeset[t],n.index=t+1,this.appendChild(n),this.getOwnerForm().createNodes&&this.getOwnerForm().initData(n),1===n.index&&this.applyIndex(n),Ga.dispatch(this,"item-created",{nodeset:n.nodeset,pos:t+1}),this._initVariables(n)}))}_initVariables(e){const t=new Map(this.inScopeVariables);e.setInScopeVariables(t),function e(n){for(const i of n.children)"setInScopeVariables"in i&&i.setInScopeVariables(t),e(i)}(e)}_clone(){this.template=this.shadowRoot.querySelector("template");const e=this.template.content.cloneNode(!0);return document.importNode(e,!0)}_removeIndexMarker(){Array.from(this.children).forEach((e=>{e.removeAttribute("repeat-index")}))}setInScopeVariables(e){this.inScopeVariables=new Map(e)}}customElements.get("fx-repeat")||window.customElements.define("fx-repeat",kl);class Al extends vl{constructor(){super(),this.formerCase={},this.selectedCase=null,this.cases=null,this.visitedResetted=!1}connectedCallback(){super.connectedCallback&&super.connectedCallback();this.shadowRoot.innerHTML="\n        <style>\n            \n       :host ::slotted(fx-case.selected-case){\n        display: block;\n    }\n    \n        </style>\n        \n       <slot></slot>\n    \n    ",this.cases=[],this.formerCase=null,this.selectedCase=null}async refresh(e){super.refresh(e),0===this.cases.length&&(this.cases=Array.from(this.querySelectorAll(":scope > fx-case"))),this.isBound()&&this._handleBoundSwitch(),this.selectedCase||(this.selectedCase=this.cases[0],this.toggle(this.selectedCase)),Ga.refreshChildren(this.selectedCase,e)}_dispatchEvents(){this.selectedCase!==this.formerCase&&(this.formerCase&&this.formerCase!==this.selectedCase&&Ga.dispatch(this.formerCase,"deselect",{}),this.selectedCase.classList.contains("selected-case")&&Ga.dispatch(this.selectedCase,"select",{}))}_resetVisited(){if(this.visitedResetted)return;const e=this.selectedCase.querySelectorAll(".visited");Array.from(e).forEach((e=>{e.classList.remove("visited")})),this.visitedResetted=!0}_handleBoundSwitch(){Array.from(this.cases).forEach((e=>{e.getAttribute("name")===this.modelItem?.value&&this.toggle(e)}))}async replaceCase(e,t){this.cases.splice(this.cases.indexOf(e),1,t),e===this.selectedCase?(this.selectedCase=t,this.formerCase=t,t.classList.add("selected-case"),t.classList.remove("deselected-case"),t.inert=!1,this.getOwnerForm().scanForNewTemplateExpressionsNextRefresh()):(t.classList.add("deselected-case"),t.classList.remove("selected-case"),t.inert=!0)}toggle(e){this.selectedCase=e,Array.from(this.cases).forEach((e=>{e===this.selectedCase?(e.classList.remove("deselected-case"),e.classList.add("selected-case"),e.inert=!1):(e.classList.remove("selected-case"),e.classList.add("deselected-case"),e.inert=!0,this._resetVisited())})),this.selectedCase!==e&&(this.selectedCase=e),this._dispatchEvents(),this.formerCase=this.selectedCase,this.getOwnerForm().scanForNewTemplateExpressionsNextRefresh(),this.getOwnerForm().getModel().updateModel()}}customElements.get("fx-switch")||window.customElements.define("fx-switch",Al);class Cl extends ml{connectedCallback(){this.attachShadow({mode:"open"}),this.ref=this.hasAttribute("ref")?this.getAttribute("ref"):null,this.debounceDelay=this.hasAttribute("debounce")?this.getAttribute("debounce"):null;this.shadowRoot.innerHTML=`\n                <style>\n                    \n          :host {\n            cursor:pointer;\n          }\n        \n                </style>\n                ${this.renderHTML()}\n        `;const e=this.shadowRoot.querySelector("slot");e.addEventListener("slotchange",(()=>{const t=e.assignedElements({flatten:!0});t[0].getAttribute("tabindex")||t[0].setAttribute("tabindex","0"),"BUTTON"!==t[0].nodeName&&t[0].setAttribute("role","button");const n=t[0];this.addEventListener("mousedown",(e=>{e.target.focus()})),this.debounceDelay?this.addEventListener("click",function(e,t,n=300){let i;return(...r)=>{i||t.apply(e,r),clearTimeout(i),i=setTimeout((()=>(i=void 0,null)),n)}}(this,(e=>{this.performActions(e)}),this.debounceDelay)):n.addEventListener("click",(e=>this.performActions(e))),this.widget=n,"BUTTON"!==n.nodeName&&n.addEventListener("keypress",(e=>{"Space"!==e.code&&"Enter"!==e.code||this.performActions(e)}))}))}renderHTML(){return"\n            <slot></slot>\n    "}getWidget(){return this.widget}async updateWidgetValue(){return null}handleReadonly(){super.handleReadonly(),this.widget.hasAttribute("readonly")?this.widget.setAttribute("disabled","disabled"):this.widget.removeAttribute("disabled")}async performActions(e){const t=this.closest("fx-repeatitem");t&&t.click(),this.querySelectorAll("fx-var").forEach((e=>e.refresh()));for(let t=0;t<this.children.length;t+=1){const n=this.children[t];if("function"==typeof n.execute){if(e&&(e.preventDefault(),e.stopPropagation(),e.type&&n.event&&e.type!==n.event))return;await n.execute(e)}}}async refresh(){super.refresh()}}customElements.get("fx-trigger")||customElements.define("fx-trigger",Cl);class _l extends vl{static get properties(){return{...super.properties,label:{type:String},name:{type:String},selected:{type:String},selector:{type:String},src:{type:String}}}connectedCallback(){this.hasAttribute("label")&&(this.label=this.getAttribute("label")),this.hasAttribute("name")&&(this.name=this.getAttribute("name")),this.hasAttribute("selected")&&(this.selected=this.getAttribute("selected")),this.selector=this.hasAttribute("selector")?this.getAttribute("selector"):"fx-case",this.hasAttribute("src")&&(this.src=this.getAttribute("src"));const e=`\n           ${this.label?`<span>${this.label}</span>`:""}\n           <slot></slot>\n        `;this.shadowRoot.innerHTML=`\n            <style>\n                \n            :host {\n                visibility: none;\n            }\n        \n            </style>\n            ${e}\n        `,this.addEventListener("select",(async()=>{const e=this.getOwnerForm();if(this.src){const{parentNode:e}=this,t=await this._loadFromSrc();if(!t)return void Ga.dispatch(this,"error",{detail:{message:"HTML page couldn't be loaded"}});await e.replaceCase(this,t)}e.getModel().updateModel(),e.refresh(!0)}))}async _loadFromSrc(){return Ga.loadForeFromSrc(this,this.src,this.selector)}}customElements.get("fx-case")||window.customElements.define("fx-case",_l);class El extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const e=this.closest("fx-fore");this.render("\n          :host {\n            position:absolute;\n            display: block;\n            width:var(--inspector-handle-width);\n            background:var(--inspector-bg);\n            top:0;\n            right:0;\n            bottom:0;\n            height: 100%;\n            background: var(--inspector-bg);\n            color: white;\n            /*max-height: 33%;*/\n            overflow: scroll;\n            transition:width 0.3s ease;\n            z-index:100;\n          }\n          :host([open]){\n            width: 30%;\n          }\n          details{\n            margin:1rem;\n          }\n          .main{\n            padding-left:var(--inspector-handle-width);\n            color:var(--inspector-color);\n            overflow:scroll;\n            height:100%;\n          }\n          pre{\n            background:var(--inspector-pre-bg);\n            color:var(--inspector-color);\n            overflow:scroll;\n            padding:0.2rem;\n          }\n          .handle{\n            display:block;\n            height:100%;\n            width:var(--inspector-handle-width);\n            background:var(--inspector-handle-bg);\n            opacity:0.7;\n            position:absolute;\n            left:0;\n            color:white;\n            cursor:pointer;\n          }\n          .handle:hover{\n            opacity:1;\n          }\n          .handle::before{\n            content: 'Data Inspector';\n            white-space: nowrap;\n            transform: rotate(-90deg);\n            display: inline-block;\n            position: absolute;\n            left: -85px;\n            width: 200px;\n            top: 40px;\n          }\n          summary{\n            cursor:pointer;\n          }\n        "),e.addEventListener("refresh-done",(()=>{this.update()}))}update(){try{const e=this.shadowRoot.querySelectorAll("pre"),t=this.closest("fx-fore");Array.from(e).forEach((e=>{const n=t.getModel().getInstance(e.getAttribute("id"));"xml"===n.getAttribute("type")&&(e.innerText=this.serializeDOM(n.instanceData)),"json"===n.getAttribute("type")&&(e.innerText=JSON.stringify(n.instanceData,void 0,2))}))}catch(e){}}render(e){const t=this.closest("fx-fore"),n=Array.from(t.querySelectorAll("fx-instance"));this.shadowRoot.innerHTML=`\n            <style>\n                ${e}\n            </style>\n            <div class="main">\n            <slot></slot>\n            <span class="handle"></span>\n                ${n.map((e=>`\n                  <details>\n                      <summary>${e.id}</summary>\n                      <pre id="${e.id}"></pre>\n                  </details>\n                `))}\n            </div>\n        `;this.shadowRoot.querySelector(".handle").addEventListener("click",(e=>{this.hasAttribute("open")?this.removeAttribute("open"):this.setAttribute("open","open")}))}serializeDOM(e){if(!e)return;return xa((new XMLSerializer).serializeToString(e))}}customElements.get("fx-inspector")||customElements.define("fx-inspector",El);class Tl extends HTMLElement{static get properties(){return{id:String}}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.shadowRoot.innerHTML=this.render("\n          :host {\n            display:none;\n            height: 100vh;\n            width:100vw;\n            position:fixed;\n            left:0;\n            top:0;\n            right:0;\n            bottom:0;\n            transition:opacity 0.4s linear;\n          }\n\n        "),this.id=this.getAttribute("id");const e=this.querySelector(".close-dialog");e&&e.addEventListener("click",(()=>{this.classList.remove("show")})),this.setAttribute("role","dialog"),this.setAttribute("aria-modal","false"),this.focus()}render(e){return`\n      <style>\n          ${e}\n      </style>\n      <slot></slot>\n    `}open(){window.addEventListener("keyup",(e=>{"Escape"===e.key&&this.hide()}),{once:!0}),this.classList.add("show")}async hide(){await Ga.fadeOutElement(this,400),this.classList.remove("show")}}customElements.get("fx-dialog")||customElements.define("fx-dialog",Tl);class Pl extends yl{static get properties(){return{...super.properties,valueAttr:{type:String}}}constructor(){super(),this.valueAttr=this.hasAttribute("value")?this.getAttribute("value"):null}connectedCallback(){super.connectedCallback(),this.addEventListener("mousedown",(e=>{if(Ga.isWidget(e.target)||(e.preventDefault(),e.stopImmediatePropagation()),"LABEL"===e.target.nodeName){Ea(e.target.getAttribute("for"),this).focus()}})),this.addEventListener("mousedown",(e=>{if(this.querySelectorAll("[value]"),"LABEL"===e.target.nodeName){Ea(e.target.getAttribute("for"),this).focus()}})),this.addEventListener("click",(e=>{e.preventDefault,e.stopPropagation();const t=this.querySelectorAll("[value]");let n;"LABEL"===e.target.nodeName&&(n=Ea(e.target.getAttribute("for"),this),n.checked=!n.checked);let i="";Array.from(t).forEach((e=>{e.checked&&(i+=` ${e.getAttribute("value")}`)})),this.setAttribute("value",i.trim());const r=va.getClosest("[ref]",this.parentNode);if(!r)return;const s=r.getModelItem(),o=this.shadowRoot.getElementById("setvalue");o.setValue(s,i.trim()),o.actionPerformed()}))}getWidget(){return this}async updateWidgetValue(){const e=va.getClosest("[ref]",this.parentNode);e&&(this.value=e.value),this.setAttribute("value",this.value)}updateEntry(e,t){const n=Ga.createUUID(),i=e.querySelector("label"),r=Ga.getExpression(i.textContent);if(t.nodeType){const e=Xa(r,t,this);i.textContent=e}else{const e=Ga.getExpression(r);i.textContent=t[e]}i.setAttribute("for",n);const s=e.querySelector("[value]"),o=s.value,a=Ga.getExpression(o);let l;l=t.nodeType?Xa(a,t,e):t[a];const h=` ${l} `,c=` ${this.getAttribute("value")} `;s.value=l,s.setAttribute("id",n),-1!==c.indexOf(h)&&(s.checked=!0)}}customElements.get("fx-items")||customElements.define("fx-items",Pl);class $l extends(sl(Ka)){}customElements.get("fx-droptarget")||window.customElements.define("fx-droptarget",$l);class Nl extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.eventName="",this.shortName="",this.shortInfo="",this.shortPath="",this.xpath=""}connectedCallback(){this.eventName=this.getAttribute("event-name"),this.shortName=this.getAttribute("short-name"),this.shortInfo=this.hasAttribute("short-info")?this.getAttribute("short-info"):"",this.xpath=this.getAttribute("xpath");const e=`\n       <details class="info send">\n              <summary>\n                <span class="log-name"><a href="#" title="${`/${this.xpath.substring(this.xpath.indexOf("/fx-fore"),this.xpath.length)}`.replaceAll("fx-","")}" data-path="${this.xpath}">${this.shortName}</a></span>\n                <span class="short-info">${this.shortInfo}</span>\n                <span class="event-name">${this.eventName}</span>                    \n              </summary>\n            <slot></slot>\n        </details>\n    `;this.shadowRoot.innerHTML=`\n        <style>\n            \n      :host {\n        height: auto;\n        font-size: 0.8em;\n        font-weight: 400;\n\n      }\n\n      a,a:link,a:visited{\n        color:black;\n      }\n      a{\n        position:relative;\n      }\n      a[alt]:hover::after {\n        content:attr(alt);\n        position:absolute; \n        left:0;\n        top:1em;\n        border.thin solid;\n        padding:0.5em;\n        background:white;\n        z-index:1;\n        min-width:5em;\n        border:thin solid;\n        white-space:nowrap;\n        overflow-wrap:break-word;\n      }\n\n     .info{\n        padding:0 0.5em;\n        margin:0.1rem 0;\n        background:white;\n        position:relative;\n        border:1px solid #ddd;\n        border-radius:1em;       \n        box-shadow: 1px 1px 5px 0px rgba(79, 136, 183, 0.8);\n      }\n      :host(.action) .info{\n        border-radius:0;\n        border-color:steelblue;\n      }\n\n      .info label{\n        grid-area:left;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .info a{\n        grid-area:right;\n        justify-self:end;\n      }\n      .info:hover{\n        outline:3px solid lightblue;       \n        transition:height 0.4s;\n      }\n\n       summary{\n        padding:1em;\n        display:flex;\n        flex-wrap:wrap;\n        padding:0.5em 0;\n        cursor:pointer;\n        gap:0.25em;\n      }\n/*\n      .log-name{\n        font-size:1.2em;\n      }\n      .log-name, .short-info{\n        width:10em;\n      }\n*/\n      .event-name{\n        width:12em;\n        text-align:right;\n        }\n      .short-info{\n        flex:3;\n        overflow:hidden;\n        white-space:nowrap;\n        text-overflow:ellipsis;\n      }\n    \n        </style>\n        ${e}\n    `}}customElements.get("fx-log-item")||customElements.define("fx-log-item",Nl);class Il extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.listenTo=[],this.listeners=[]}connectedCallback(){localStorage.getItem("fx-log-settings")?this.listenTo=JSON.parse(localStorage.getItem("fx-log-settings")):this.listenTo=Il.defaultSettings();this.shadowRoot.innerHTML='\n        <style>\n            \n      :host {\n        display:block;\n        position:relative;\n        width:100%;\n        border:thin solid #efefef;\n        font-family: Verdana, Sans;\n\n        margin:0;\n        border:thin solid #ddd;\n      }\n      .boxes{\n        column-width:14rem;\n        overflow:auto;\n        margin-bottom:5em;\n        padding:1em;\n      }\n      .boxes > span{\n        display:inline-block;\n        width:14rem;\n      }\n      \n      .buttons{\n        position:absolute;\n        top:0;\n        right:0;\n      }\n      .buttons button{\n        padding:0;\n      }\n      button{\n        float:right;\n      }\n      button{\n        border:none;\n        background:transparent;\n        width:2.25rem;\n        height:2.25rem;\n        cursor:pointer;\n      }\n      button#reset{\n        padding:0;\n        height:1rem;\n      }\n      header{\n        padding:0.5rem;\n        margin:0;\n        border-bottom:2px solid #ddd;\n      }\n      #settings{\n        padding:1em;\n      }\n      \n    \n        </style>\n        \n        <section id="settings">\n            <header>log settings <button id="reset">reset</button></header>\n            <div class="boxes"></div>\n        </section>\n    \n    ',window.document.querySelector("fx-fore");const e=this.shadowRoot.querySelector(".boxes");this.listenTo.forEach((t=>{const n=document.createElement("span");e.append(n);const i=document.createElement("label");i.setAttribute("title",t.description),i.setAttribute("for",t.name),i.innerText=t.name;const r=document.createElement("input");r.setAttribute("type","checkbox"),r.setAttribute("name",t.name),r.setAttribute("id",t.name),t.show&&r.setAttribute("checked",""),n.append(r),n.append(i),r.addEventListener("click",(e=>{if(!e.target.checked){document.querySelector("fx-fore").removeEventListener(t.name,this._log)}const n=this.listenTo.find((e=>e.name===t.name));e.target.checked?n.show=!0:n.show=!1,localStorage.setItem("fx-log-settings",JSON.stringify(this.listenTo))}))}));this.shadowRoot.querySelector("#reset").addEventListener("click",(e=>{localStorage.removeItem("fx-log-settings"),window.location.reload()}))}static defaultSettings(){return[{name:"action-performed",show:!1,description:"fires after an action has been performed"},{name:"click",show:!1,description:""},{name:"deleted",show:!1,description:"fires after a delete action has been executed"},{name:"deselect",show:!1,description:"fires when fx-case is deselected"},{name:"dialog-hidden",show:!1,description:"fires after fx-dialog has been hidden"},{name:"dialog-shown",show:!1,description:"fired when a dialog has been shown"},{name:"error",show:!1,description:"fires after an error occurred"},{name:"execute-action",show:!0,description:"fires when an action executes"},{name:"init",show:!1,description:"fires when a control initializes"},{name:"index-changed",show:!1,description:"fires when the repeat index changes"},{name:"insert",show:!1,description:"fires when an fx-insert is executed"},{name:"instance-loaded",show:!1,description:"fires after an fx-instance has been loaded"},{name:"invalid",show:!1,description:"fires after a control became invalid"},{name:"item-changed",show:!1,description:"fires when a repeat item was changed"},{name:"item-created",show:!1,description:"fires when a repeat item was created"},{name:"loaded",show:!1,description:"fires after a fx-load has loaded"},{name:"model-construct",show:!1,description:"fires when a model gets constructed"},{name:"model-construct-done",show:!1,description:"fires after model initialization"},{name:"nonrelevant",show:!1,description:"fires after an fx-control became nonrelevant"},{name:"optional",show:!1,description:"fires after an fx-control became optional"},{name:"outermost-action-end",show:!1,description:"fires when an outermost action block is finished"},{name:"outermost-action-start",show:!1,description:"fires when an outermost action block is started"},{name:"path-mutated",show:!1,description:"fires when a path in a repeat has been mutated"},{name:"readonly",show:!1,description:"fires after an fx-control became readonly"},{name:"readwrite",show:!1,description:"fires after an fx-control became readwrite"},{name:"ready",show:!1,description:"fires after a fx-fore page has been completely initialized"},{name:"rebuild-done",show:!1,description:"fires after a rebuild has taken place"},{name:"recalculate-done",show:!1,description:"fires after a recalculate has taken place"},{name:"refresh-done",show:!1,description:"fires after a refresh has been done"},{name:"relevant",show:!1,description:"fires after a fx-control has become relevant"},{name:"reload",show:!1,description:"fires when a fx-reload action executes"},{name:"required",show:!1,description:"fires after an fx-control has become required"},{name:"return",show:!1,description:"fires after a fx-return returned"},{name:"select",show:!1,description:"fires when an fx-case has been selected"},{name:"submit",show:!1,description:"fires before a submission takes place"},{name:"submit-done",show:!1,description:"fires after a submission has successfully been executed"},{name:"submit-error",show:!1,description:"fires when a submission returned an error"},{name:"valid",show:!1,description:"fires after a fx-control has become valid"},{name:"value-changed",show:!1,description:"fires after a fx-control has changed its value"}]}_log(e,t){const n=e.target.nodeName;if("FX-ACTION-LOG"===n)return;const i=document.createElement("div");i.classList.add("log-row");const r=this._logDetails(e);if(e.detail&&0===Object.keys(e.detail).length&&Object.getPrototypeOf(e.detail)===Object.prototype&&i.classList.add("no-detail"),i.innerHTML=r,this.outermost){if("outermost-action-start"===e.type)return;this.outermostAppender||(this.outermostAppender=document.createElement("ul"),t.append(this.outermostAppender));const n=document.createElement("li");n.append(i),this.outermostAppender.append(n)}else t.append(i);this.parentPath&&"FX-ACTION"!==n&&i.classList.add("nested");const s=e.target;i.addEventListener("click",(e=>{this._highlight(s)}));const o=i.querySelector(".event-target");o&&o.addEventListener("click",(e=>{document.querySelectorAll(".fx-action-log-debug").forEach((e=>{e.classList.remove("fx-action-log-debug")})),s.dispatchEvent(new CustomEvent("log-action",{composed:!1,bubbles:!0,cancelable:!0,detail:{target:s}})),s.classList.add("fx-action-log-debug"),s.setAttribute("data-name",s.nodeName),this._highlight(s)}))}_logDetails(e){const t=e.type,n=va.getPath(e.target),i=n.substring(n.indexOf("/fx-fore"),n.length),r=`/${i}`,s=i.replaceAll("fx-","");switch(this.parentPath&&!r.startsWith(this.parentPath)&&(this.parentPath=null),t){case"deleted":const{deletedNodes:n}=e.detail,i=new XMLSerializer;let o="";return n.forEach((e=>{o+=i.serializeToString(e)})),`\n                <fx-log-item event-name="${t}"\n                             xpath="${r}"\n                             short-info="${e.detail.ref}"\n                             short-name="${e.target.nodeName.toLowerCase()}">\n                    <section class="details">\n                        <header>Details</header>\n                        <section>\n                            <span class="key">Deleted Nodes</span>\n                            <textarea class="value" rows="5">${o.trim()}</textarea>\n                        </section>\n                    </section>\n                </fx-log-item>\n                `;case"outermost-action-start":return"start";case"outermost-action-end":return"";case"execute-action":const a=e.detail.action;return this._renderAction(a,r,s,e);default:return`\n                <fx-log-item event-name="${t}"\n                             xpath="${r}"\n                             short-name="${e.target.nodeName.toLowerCase()}">\n                             \n                    <section class="details">\n                      ${this._listEventDetails(e)}\n                    </section>\n                </fx-log-item>\n            `}}_renderAction(e,t,n,i){switch(e.nodeName.split("-")[1],e.nodeName){case"FX-ACTION":return this.parentPath=t,`\n                <fx-log-item event-name="${i.detail.event}"\n                             xpath="${t}"\n                             short-name="ACTION" class="action">\n                    <section class="details">\n                      <header>Attributes</header>\n                      <section>\n                      ${Array.from(e.attributes).map((e=>`\n                        <span class="key">${e.nodeName}</span>\n                        <span class="value">${e.nodeValue}</span>\n                      `)).join("")}                 \n                      </section>\n                    </section>\n                </fx-log-item>  \n            `;case"FX-MESSAGE":const n=i.detail.action.messageTextContent;return`\n                    <fx-log-item event-name="${i.detail.event}"\n                                 xpath="${t}"\n                                 short-name="MESSAGE"\n                                 short-info="${n}" class="action">\n                        <section class="details">\n                            <span>${n}</span>\n                        </section>\n                    </fx-log-item>\n                `;case"FX-SEND":const r=document.querySelector(`#${i.detail.action.getAttribute("submission")}`);return`\n                <fx-log-item short-name="SEND"\n                             short-info="${r.id}"\n                             event-name="${i.detail.event}"\n                             xpath="${t}" class="action">\n                        <section class="details">\n                          <header>Submission</header>\n                          <section class="attributes">\n                          ${Array.from(r.attributes).map((e=>`\n                            <span class="key">${e.nodeName}</span>\n                            <span class="value">${e.nodeValue}</span>\n                          `)).join("")}                 \n                          </section>  \n                        </section>\n               </fx-log-item>\n                `;case"FX-SETVALUE":return`\n                <fx-log-item short-name="SETVALUE"\n                             short-info="${va.getPath(i.target.nodeset)}"\n                             event-name="${"FX-CONTROL"===i.target.nodeName?i.target.updateEvent:i.detail.event}"\n                             xpath="${t}" class="action">\n                      <section class="details">\n                          <span class="key">value</span>\n                          <span class="value">${i.detail.value}</span>\n                      </section>\n                </fx-log-item>\n                `;default:return`\n                    <fx-log-item event-name="${i.detail.event}" \n                                short-name="${i.target.nodeName}"\n                                xpath="${t}"\n                                class="action">\n                          <section class="details">\n                          </section>\n                    </fx-log-item>\n                    `}}_listEventDetails(e){return e.detail&&0===Object.keys(e.detail).length&&Object.getPrototypeOf(e.detail)===Object.prototype?"":`${Object.keys(e.detail).map((e=>`<span>${e}</span>`))}`}_listAttributes(e){return""}_highlight(e){const t=e.style.backgroundColor,n=e.style.transition;e.style.transition="background 1s",e.style.backgroundColor="#FFA500",setTimeout((()=>{e.style.backgroundColor=t,setTimeout((()=>{e.style.transition=n}),400)}),400),window.document.dispatchEvent(new CustomEvent("log-active-element",{detail:{target:e}}))}}customElements.get("fx-log-settings")||customElements.define("fx-log-settings",Il);class Ql extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.listenTo=[],this.listeners=[]}connectedCallback(){localStorage.getItem("fx-action-log-filters")?this.listenTo=JSON.parse(localStorage.getItem("fx-action-log-filters")):this.listenTo=Il.defaultSettings(),localStorage.getItem("fx-log-settings")?this.listenTo=JSON.parse(localStorage.getItem("fx-log-settings")):this.listenTo=Il.defaultSettings();this.shadowRoot.innerHTML='\n        <style>\n            \n      :host {\n        display:block;\n        position:relative;\n        width:100%;\n        border:thin solid #efefef;\n        background:transparent;\n        font-family: Verdana, Sans;\n        margin:0;\n        padding:0.25rem;\n      }\n      a,a:link,a:visited{\n        color:black;\n      }\n      a{\n        position:relative;\n      }\n      a[alt]:hover::after {\n        content:attr(alt);\n        position:absolute; \n        left:0;\n        bottom:-0.5em;\n        border:thin solid;\n        padding:0.5em;\n        background:white;\n        z-index:1;\n        min-width:5em;\n        border:thin solid;\n        max-width:90%;\n      }\n     .details{\n        padding:0.25em 0;\n      }\n\n      .key{\n        width:20%;\n        display:inline-block;\n        min-width:5rem;\n        border-bottom:1px solid #ddd;\n        background:#efefef;\n        vertical-align:top;\n      }\n      .value{\n        display:inline-block;\n        width:60%;\n        \n      }\n      \n      .buttons{\n        position:absolute;\n        top:0;\n        right:0;\n      }\n      .buttons button{\n        padding:0;\n      }\n      button{\n        float:right;\n      }\n      button{\n        border:none;\n        background:transparent;\n        width:2.25rem;\n        height:2.25rem;\n        cursor:pointer;\n      }\n      button#reset{\n        padding:0;\n        height:1rem;\n      }\n     .info{\n        padding:0 0.5em;\n        margin:0.1rem 0;\n        background:white;\n        position:relative;\n        display:grid;\n        grid-template-areas: "left right"\n                    "bottom .";\n        grid-template-columns: 75% 25%;\n      }\n      .info a{\n        grid-area:right;\n        justify-self:end;\n      }\n      .details > section{\n        display:flex;\n        flex-wrap:wrap;\n        padding:0.5em 0;\n      }\n      fx-log-item{\n      }\n      header{\n        padding:0.5rem;\n        margin:0;\n        border-bottom:2px solid #ddd;\n      }\n      \n      .info:hover{\n        outline:3px solid lightblue;       \n        transition:height 0.4s;\n      }\n\n      ol{\n        background: #efefef;\n        padding: 0.5em 0 0 2em;\n        border-left:3px solid red;\n      }\n     \n      .event-name{\n        display:inline-block;\n      }\n      #log{\n        margin-bottom:10em;\n        margin-right:2em;\n      }\n      .log-row{\n        margin:0;\n        padding:0;\n        position:relative;\n        font-size:0.8em;\n        border-left:4px solid transparent;\n        padding-left:5px;\n        width:calc(100% - 2em);\n        margin-bottom:0.25em;\n      }\n      .log-row summary{\n        display:flex;\n        flex-wrap:wrap;\n        padding:0.5em 0;\n        cursor:pointer;\n      }\n      .log-row summary > span {\n        width:calc(90% div 3);\n      }\n\n      .log-name{\n        position:relative;\n      }\n      .short-info{\n        flex:3;\n        overflow:hidden;\n        white-space:nowrap;\n        text-overflow:ellipsis;\n      }\n      .log-row.no-detail summary{\n        position:relative;\n      }\n      .log-row.no-detail summary{\n        list-style:none;\n        padding-left:1rem;\n      }\n      .log-row.no-detail summary::-webkit-details-marker {\n        display: none;\n      }\n      .log-row.nested{\n        margin-left:1em;\n      }\n      .nested .event-name{\n        display:none;\n      }\n      \n      .setvalue .value{\n        background:lightyellow;\n      }\n       summary{\n        padding:1em;\n        border-bottom:2px solid #ddd;\n      }\n      .outer-details{\n        height:100%;\n        overflow:auto;\n        margin-top:2rem;\n        background:rgba(250, 250, 250, 0.9);\n      }\n      \n      .outer-details > header{\n        position:absolute;\n        top:-1px;\n        width:calc(100% - 2rem);\n        border-bottom:2px solid #ddd;\n        font-size:1rem;\n        height:1rem;\n     }\n      .outer-details > summary{\n        font-size:1em;\n      }\n      ul{\n        list-style:none;\n        padding:0;\n        margin:0.1em 0;\n        border-left:3px solid steelblue;\n        padding:0.1em 0;\n      }\n      ul .log-row{\n        padding-left:3px;\n        width:calc(100% - 1em);\n      }\n    \n        </style>\n        \n      <section open class="outer-details">\n        <header>Log \n            <span class="buttons">\n                <button id="del"" title="empty log - Ctrl+d">\n                    <svg viewBox="0 0 24 24" style="width:24px;height:24px;" preserveAspectRatio="xMidYMid meet" focusable="true"><g><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"></path></g></svg></a>\n                </button>\n            </span>\n        </header>\n        <div id="log"></div>\n      </section>\n    \n    ',window.document.querySelector("fx-fore");const e=this.shadowRoot.querySelector("#log");this.listenTo.forEach((t=>{t.show&&document.addEventListener(t.name,(t=>{this._log(t,e)}))})),document.addEventListener("outermost-action-start",(e=>{this.outermost=!0}),{capture:!0}),document.addEventListener("outermost-action-end",(e=>{this.outermost=!1,this.outermostAppender=null}),{capture:!0});this.shadowRoot.querySelector("#del").addEventListener("click",(e=>{this.shadowRoot.querySelector("#log").innerHTML=""})),document.addEventListener("keydown",(e=>{e.ctrlKey&&"d"===e.key&&(this.shadowRoot.querySelector("#log").innerHTML="")}))}_defaultSettings(){this.listenTo=[{name:"action-performed",show:!1,description:"fires after an action has been performed"},{name:"click",show:!1,description:""},{name:"deleted",show:!1,description:"fires after a delete action has been executed"},{name:"deselect",show:!1,description:"fires when fx-case is deselected"},{name:"dialog-hidden",show:!1,description:"fires after fx-dialog has been hidden"},{name:"dialog-shown",show:!1,description:"fired when a dialog has been shown"},{name:"error",show:!1,description:"fires after an error occurred"},{name:"execute-action",show:!0,description:"fires when an action executes"},{name:"init",show:!1,description:"fires when a control initializes"},{name:"index-changed",show:!1,description:"fires when the repeat index changes"},{name:"insert",show:!1,description:"fires when an fx-insert is executed"},{name:"instance-loaded",show:!1,description:"fires after an fx-instance has been loaded"},{name:"invalid",show:!1,description:"fires after a control became invalid"},{name:"item-changed",show:!1,description:"fires when a repeat item was changed"},{name:"item-created",show:!1,description:"fires when a repeat item was created"},{name:"loaded",show:!1,description:"fires after a fx-load has loaded"},{name:"model-construct",show:!1,description:"fires when a model gets constructed"},{name:"model-construct-done",show:!1,description:"fires after model initialization"},{name:"nonrelevant",show:!1,description:"fires after an fx-control became nonrelevant"},{name:"optional",show:!1,description:"fires after an fx-control became optional"},{name:"outermost-action-end",show:!1,description:"fires when an outermost action block is finished"},{name:"outermost-action-start",show:!1,description:"fires when an outermost action block is started"},{name:"path-mutated",show:!1,description:"fires when a path in a repeat has been mutated"},{name:"readonly",show:!1,description:"fires after an fx-control became readonly"},{name:"readwrite",show:!1,description:"fires after an fx-control became readwrite"},{name:"ready",show:!1,description:"fires after a fx-fore page has been completely initialized"},{name:"rebuild-done",show:!1,description:"fires after a rebuild has taken place"},{name:"recalculate-done",show:!1,description:"fires after a recalculate has taken place"},{name:"refresh-done",show:!1,description:"fires after a refresh has been done"},{name:"relevant",show:!1,description:"fires after a fx-control has become relevant"},{name:"reload",show:!1,description:"fires when a fx-reload action executes"},{name:"required",show:!1,description:"fires after an fx-control has become required"},{name:"return",show:!1,description:"fired by embedded Fore controls to return their bound value"},{name:"select",show:!1,description:"fires when an fx-case has been selected"},{name:"submit",show:!1,description:"fires before a submission takes place"},{name:"submit-done",show:!1,description:"fires after a submission has successfully been executed"},{name:"submit-error",show:!1,description:"fires when a submission returned an error"},{name:"valid",show:!1,description:"fires after a fx-control has become valid"},{name:"value-changed",show:!1,description:"fires after a fx-control has changed its value"}]}_log(e,t){const n=e.target.nodeName;if("FX-ACTION-LOG"===n)return;const i=document.createElement("div");i.classList.add("log-row");const r=this._logDetails(e);if(e.detail&&0===Object.keys(e.detail).length&&Object.getPrototypeOf(e.detail)===Object.prototype&&i.classList.add("no-detail"),i.innerHTML=r,this.outermost){if("outermost-action-start"===e.type)return;this.outermostAppender||(this.outermostAppender=document.createElement("ul"),t.append(this.outermostAppender));const n=document.createElement("li");n.append(i),this.outermostAppender.append(n)}else t.append(i);this.parentPath&&"FX-ACTION"!==n&&i.classList.add("nested");const s=e.target;i.addEventListener("click",(e=>{this._highlight(s)}));const o=i.querySelector(".event-target");o&&o.addEventListener("click",(e=>{document.querySelectorAll(".fx-action-log-debug").forEach((e=>{e.classList.remove("fx-action-log-debug")})),s.dispatchEvent(new CustomEvent("log-action",{composed:!1,bubbles:!0,cancelable:!0,detail:{target:s}})),s.classList.add("fx-action-log-debug"),s.setAttribute("data-name",s.nodeName),this._highlight(s)}))}_logDetails(e){const t=e.type,n=va.getDocPath(e.target),i=n.substring(n.indexOf("/fx-fore"),n.length),r=`/${i}`,s=i.replaceAll("fx-","");switch(this.parentPath&&!r.startsWith(this.parentPath)&&(this.parentPath=null),t){case"deleted":const{deletedNodes:n}=e.detail,i=new XMLSerializer;let o="";return n.forEach((e=>{o+=i.serializeToString(e)})),`\n                <fx-log-item event-name="${t}"\n                             xpath="${r}"\n                             short-info="${e.detail.ref}"\n                             short-name="${e.target.nodeName.toLowerCase()}">\n                    <section class="details">\n                        <header>Details</header>\n                        <section>\n                            <span class="key">Deleted Nodes</span>\n                            <textarea class="value" rows="5">${o.trim()}</textarea>\n                        </section>\n                    </section>\n                </fx-log-item>\n                `;case"outermost-action-start":return"start";case"outermost-action-end":return"";case"execute-action":const a=e.detail.action;return this._renderAction(a,r,s,e);default:return`\n                <fx-log-item event-name="${t}"\n                             xpath="${r}"\n                             short-name="${e.target.nodeName.toLowerCase()}">\n                             \n                    <section class="details">\n                      ${this._listEventDetails(e)}\n                    </section>\n                </fx-log-item>\n            `}}_renderAction(e,t,n,i){let r;switch(e.nodeName.split("-")[1],e.nodeName){case"FX-ACTION":return this.parentPath=t,r=i.target.currentEvent?i.target.currentEvent.type:i.detail.event?i.detail.event:"",`\n                <fx-log-item event-name="${r}"\n                             xpath="${t}"\n                             short-name="ACTION"\n                              data-path="${i.detail.path}" \n                              class="action">\n                    <section class="details">\n                      <header>Attributes</header>\n                      <section>\n                      ${Array.from(e.attributes).map((e=>`\n                        <span class="key">${e.nodeName}</span>\n                        <span class="value">${e.nodeValue}</span>\n                      `)).join("")}                 \n                      </section>\n                    </section>\n                </fx-log-item>  \n            `;case"FX-MESSAGE":const n=i.detail.action.messageTextContent;return`\n                    <fx-log-item event-name="${i.detail.event}"\n                                 xpath="${t}"\n                                 short-name="MESSAGE"\n                                 short-info="${n}" class="action">\n                        <section class="details">\n                            <span>${n}</span>\n                        </section>\n                    </fx-log-item>\n                `;case"FX-SEND":const s=document.querySelector(`#${i.detail.action.getAttribute("submission")}`),o=i.detail.event?i.detail.event:"";return`\n                <fx-log-item short-name="SEND"\n                             short-info="${s.getAttribute("id")}"\n                             event-name="${o}"\n                             xpath="${t}" class="action"\n                             data-path="${i.detail.path}" >\n                        <section class="details">\n                          <header>Submission</header>\n                          <section class="attributes">\n                          ${Array.from(s.attributes).map((e=>`\n                            <span class="key">${e.nodeName}</span>\n                            <span class="value">${e.nodeValue}</span>\n                          `)).join("")}                 \n                          </section>  \n                        </section>\n               </fx-log-item>\n                `;case"FX-SETVALUE":return`\n                <fx-log-item short-name="SETVALUE"\n                             short-info="${va.getPath(i.target.nodeset)}"\n                             event-name="${"FX-CONTROL"===i.target.nodeName?i.target.updateEvent:i.detail.event?i.detail.event:""}"\n                             xpath="${t}"\n                             data-path="${i.detail.path}" class="action">\n                      <section class="details">\n                          <span class="key">value</span>\n                          <span class="value">${i.detail.value}</span>\n                      </section>\n                </fx-log-item>\n                `;default:return r=i.target.currentEvent?i.target.currentEvent.type:i.detail.event?i.detail.event:"",`\n                    <fx-log-item event-name="${r}" \n                                short-name="${i.target.nodeName}"\n                                xpath="${t}"\n                                data-path="${i.detail.path}" \n                                class="action">\n                          <section class="details">\n                          </section>\n                    </fx-log-item>\n                    `}}_listEventDetails(e){return e.detail&&0===Object.keys(e.detail).length&&Object.getPrototypeOf(e.detail)===Object.prototype?"":`${Object.keys(e.detail).map((e=>`<span>${e}</span>`))}`}_listAttributes(e){return""}_highlight(e){const t=e.style.backgroundColor,n=e.style.transition;e.style.transition="background 1s",e.style.backgroundColor="#FFA500",setTimeout((()=>{e.style.backgroundColor=t,setTimeout((()=>{e.style.transition=n}),400)}),400),window.document.dispatchEvent(new CustomEvent("log-active-element",{detail:{target:e}}))}}function Rl(e,t){e.classList.add(t)}function Ml(e,t){e.classList.remove(t)}function Bl(e,t){if("object"!=typeof e)throw new Error(`containsOnlyText: Expected argument node of type object, ${typeof e} given.`);let n=!1,i=null;if(t=t||!1)for(let t=0,r=e.childNodes.length;t<r&&(i=e.childNodes[t],n=i.nodeType===Node.TEXT_NODE||i.nodeType===Node.COMMENT_NODE||i.nodeType===Node.CDATA_SECTION_NODE,n);t+=1);else n=e.nodeType===Node.TEXT_NODE||e.nodeType===Node.COMMENT_NODE||e.nodeType===Node.CDATA_SECTION_NODE;return n}function Dl(e,t){const n=document.createElement(e);t=t||{};for(const e of Object.keys(t))n.setAttribute(e,t[e]);return n}function Xl(e,t){const n=Dl("span",{class:"adi-opt"});return n.innerHTML=`<label><input type="checkbox" data-opt="${e}">${t}</label>`,n}customElements.get("fx-action-log")||customElements.define("fx-action-log",Ql);class Fl{constructor(e,t){this.sourceNodeByInspectorNodeLookup=new Map,this.uiView=null,this.menuView=null,this.domView=null,this.attrView=null,this.optsView=null,this.activeElement=null,this.vertResizing=!1,this.horizResizing=!1,this.pathScrolling=null,this.elemLookup=!1,this.styleBackup="",this.xPos=0,this.delegatedEvents=[],this.options={align:"right",split:50,minSplit:30,visible:!0,saving:!1,transparent:!0,omitEmptyText:!0,makeVisible:!0,foldText:!0,nodeTypes:[Node.ELEMENT_NODE,Node.TEXT_NODE,Node.COMMENT_NODE,Node.DOCUMENT_NODE]},"#document"===t?(this.instanceId="#document",this.document=window.document,this.isInstanceViewer=!1):(this.instanceId=t.id,!t||t.localName,this.document=t.getInstanceData(),this.isInstanceViewer=!0,this.options.foldText=!1),this.drawUI(e),this.registerEvents(),this.drawDOM(this.document,this.domView.querySelector(".adi-tree-view"),!0),document.addEventListener("execute-action",(e=>this.processExecuteAction))}getSelected(){if(!this.activeElement)return null;let e=document;return e=this.sourceNodeByInspectorNodeLookup.get(this.activeElement),e}loadOptions(){let e={};e=JSON.parse(window.localStorage.getItem("ADI.options"))||{};for(const t of Object.keys(e))this.options[t]=e[t]}saveOptions(){this.options.saving&&window.localStorage.setItem("ADI.options",JSON.stringify(this.options))}hasRequiredNodes(e){if("object"!=typeof e)throw new Error(`hasRequiredNodes: Expected argument node of type object, ${typeof e} given.`);if(e.hasChildNodes())for(let t=0,n=e.childNodes.length;t<n;t+=1){const n=e.childNodes[t];if(this.options.nodeTypes.includes(n.nodeType))return!0}return!1}newTreeNode(e){if("object"!=typeof e)throw new Error(`newTreeNode: Expected argument node of type object, ${typeof e} given.`);const t=this.hasRequiredNodes(e);let n=!1,i=e.nodeName.startsWith("FX-")?`adi-node ${e.nodeName.toLowerCase()}`:"";e.nodeName.startsWith("FX-")&&(i=`adi-node ${e.nodeName.toLowerCase()}`,i+=Ga.isActionElement(e.nodeName)?" action":"");const r=Dl("li",{class:i});if(e===this.uiView)return null;if(t&&r.appendChild(Dl("span",{class:"adi-trigger"})),this.options.omitEmptyText&&e.nodeType===Node.TEXT_NODE&&(n=function(e){if("object"!=typeof e)throw new Error(`isEmptyTextNode: Expected argument node of type object, ${typeof e} given.`);return/^\s*$/.test(e.textContent)}(e)),!n){const n=Dl("span");this.sourceNodeByInspectorNodeLookup.set(n,e),this.sourceNodeByInspectorNodeLookup.set(e,n);let i=null;if(Bl(e))e.nodeType===Node.COMMENT_NODE?(Rl(n,"adi-comment-node"),"string"==typeof n.innerText&&(n.innerText=`\x3c!-- ${e.textContent} --\x3e`)):(Rl(n,"adi-text-node"),n.textContent=e.textContent);else if(Rl(n,"adi-normal-node"),e.nodeType!==Node.DOCUMENT_NODE){const r=Array.from(e.attributes).filter((e=>!!this.isInstanceViewer||"style"!==e.name)).map((e=>`${e.name}="${e.value}"`)).join(" ");n.textContent=`<${e.nodeName.toLowerCase()}${r?` ${r}`:""}>`,t&&(i=Dl("span"),Rl(i,"adi-end-node"),i.textContent=`</${e.nodeName.toLowerCase()}>`)}else n.textContent=e.nodeName.toLowerCase();return r.appendChild(n),e.nodeName.startsWith("FX-")&&(n.classList.add("fore-node"),n.classList.add(e.nodeName.toLowerCase())),i&&(r.appendChild(i),e.nodeName.startsWith("FX-")&&i.classList.add("fore-node")),r}return null}drawDOM(e,t,n){if("object"!=typeof e)throw new Error(`drawDOM: Expected argument root of type object, ${typeof e} given.`);let i=null,r=!0;const s=t.nodeName.startsWith("FX-")?`adi-node ${node.nodeName.toLowerCase()}`:"";n&&-1!==this.options.nodeTypes.indexOf(e.nodeType)&&(t.innerHTML="",i=this.newTreeNode(e),this.hasRequiredNodes(e)&&(i.appendChild(Dl("ul",{"data-open":!0,class:s})),Rl(i.querySelector(".adi-trigger"),"opened")),t.appendChild(i),t=t.querySelector("ul"));for(let n=0,o=e.childNodes.length;n<o;n+=1){const o=e.childNodes[n],a=this.hasRequiredNodes(o);if(-1!==this.options.nodeTypes.indexOf(o.nodeType)&&(i=this.newTreeNode(o),i)){if(a&&(r=!this.options.foldText||!Bl(o,!0),"HEAD"===o.nodeName&&(r=!1),"SELECT"===o.nodeName&&(r=!1),"FX-INSTANCE"===o.nodeName&&(r=!1),o.nodeType===Node.DOCUMENT_NODE?i.appendChild(Dl("ul",{"data-open":r,class:s})):i.insertBefore(Dl("ul",{"data-open":r,class:s}),i.lastChild),Rl(i.querySelector(".adi-trigger"),r?"opened":"closed")),t.appendChild(i),this.getSelected()===o){const e=i.querySelector("span.adi-normal-node");e?.classList?.add("adi-active-node"),this.activeElement=e,i.scrollIntoView({block:"nearest",behavior:"instant"})}a&&this.drawDOM(o,i.querySelector("ul"),!1)}}}toggleOptions(){-1!==this.optsView.className.indexOf("adi-hidden")?Ml(this.optsView,"adi-hidden"):(Rl(this.optsView,"adi-hidden"),this.attrView.querySelector(".adi-content").innerHTML="",this.refreshUI(),this.drawDOM(document,this.domView.querySelector(".adi-tree-view"),!0),this.options.saving?this.saveOptions():window.localStorage.removeItem("ADI.options"))}drawUI(e){this.uiView=Dl("div",{id:"adi-wrapper",class:this.options.transparent?"transparent":""}),this.domView=Dl("div",{id:"adi-dom-view"});const t=Dl("div",{class:"adi-content",id:"detailsView"}),n=Dl("ul",{class:"adi-tree-view"}),i=Dl("div",{class:"adi-path-wrap"}),r=Dl("span",{class:"adi-path-left"}),s=Dl("span",{class:"adi-path-right"});this.menuView=Dl("div",{id:"adi-panel"});const o=Dl("div",{class:"adi-menu-wrap"}),a=Dl("a",{class:"adi-menu-config",title:"Settings"}),l=Dl("a",{class:"adi-menu-lookup",title:"Lookup tool"});if(this.optsView=function(){const e=Dl("div",{id:"adi-opts-view",class:"adi-hidden"}),t=Dl("span",{class:"adi-opt-heading"}),n=Dl("span",{class:"adi-opt-heading"}),i=Dl("span",{class:"adi-opt-close"});return t.textContent="General options",n.textContent="Observed nodes",e.appendChild(t),e.appendChild(Xl("saving","Enable saving of settings")),e.appendChild(Xl("makeVisible","Scroll to the active element in DOM View")),e.appendChild(Xl("omitEmptyText","Hide empty text nodes")),e.appendChild(Xl("foldText","Fold the text nodes")),e.appendChild(Xl("transparent","Enable transparent background")),e.appendChild(n),e.appendChild(Xl("nodeTypes-3","Text node")),e.appendChild(Xl("nodeTypes-8","Comment node")),e.appendChild(i),e}(),t.appendChild(n),this.domView.appendChild(this.menuView),this.domView.appendChild(t),i.appendChild(r),i.appendChild(s),o.appendChild(l),o.appendChild(a),this.menuView.appendChild(i),this.menuView.appendChild(o),this.uiView.appendChild(this.optsView),this.uiView.appendChild(this.domView),!this.isInstanceViewer){this.attrView=Dl("div",{id:"adi-attr-view"});const e=Dl("div",{class:"adi-content"});this.attrView.appendChild(e),this.uiView.appendChild(this.attrView)}e.appendChild(this.uiView),this.refreshUI(!0)}refreshUI(e){null!==this.uiView&&(e&&this.loadOptions(),e&&(this.optsView.querySelector('[data-opt="transparent"]').checked=this.options.transparent,this.optsView.querySelector('[data-opt="saving"]').checked=this.options.saving,this.optsView.querySelector('[data-opt="omitEmptyText"]').checked=this.options.omitEmptyText,this.optsView.querySelector('[data-opt="makeVisible"]').checked=this.options.makeVisible,this.optsView.querySelector('[data-opt="foldText"]').checked=this.options.foldText,this.optsView.querySelector('[data-opt="nodeTypes-3"]').checked=-1!==this.options.nodeTypes.indexOf(3),this.optsView.querySelector('[data-opt="nodeTypes-8"]').checked=-1!==this.options.nodeTypes.indexOf(8)),this.uiView.className=this.options.transparent?"transparent":"",this.domView.querySelector(".adi-content").style.height=`${this.domView.clientHeight}px`,this.isInstanceViewer||(this.attrView.querySelector(".adi-content").style.height=this.attrView.clientHeight-this.menuView.clientHeight+"px"),Rl(this.uiView,this.options.align))}toggleVisibilityUI(){null!==this.uiView&&(this.uiView.style.display=this.options.visible?"none":"block",this.options.visible=!this.options.visible,this.saveOptions())}drawAttrs(e){if(this.isInstanceViewer)return;const t=this.attrView.querySelector(".adi-content");t.innerHTML="";const n=document.createElement("header");n.innerText="Attributes",t.appendChild(n),[...e.attributes].forEach((e=>{"style"!==e.name&&t.appendChild(function(e,t){const n=Dl("span",{class:"adi-attr"});switch(e.toLowerCase()){case"defaultaction":n.innerHTML=`<label>${e}: <select data-attr="${e}" value="${t}"><option>perform</option><option>cancel</option></label>`;break;case"delay":n.innerHTML=`<label>${e}: <input type="number" data-attr="${e}" value="${t}" readonly="readonly"></label>`;break;default:n.innerHTML=`<label>${e}: <input type="text" data-attr="${e}" value="${t}" readonly="readonly"></label>`}return n}(e.name,e.value))}))}changeAttribute(e){const t=e?e.target:window.event.srcElement,n=t.getAttribute("data-attr"),i=t.value,r=this.getSelected();""===i?r.removeAttribute(n):r.setAttribute(n,i)}changeOption(e){const t=e?e.target:window.event.srcElement,n=t.getAttribute("data-opt"),i=t.checked;if(-1!==n.indexOf("nodeTypes")){const e=parseInt(n.match(/\d+/)[0],10);i?this.options.nodeTypes.push(e):this.options.nodeTypes.splice(this.options.nodeTypes.indexOf(e),1)}else this.options[n]=i}processKey(e){if(272===((e=e||window.event).keyCode||e.which))this.toggleVisibilityUI()}verticalResize(e){if(!this.vertResizing)return;e=e||window.event,document.documentElement.style.cursor="e-resize";const t=this.options.width+this.xPos-e.clientX;t>=this.options.minWidth&&(this.options.width=t,this.xPos=e.clientX,this.refreshUI(),this.saveOptions())}horizontalResize(e){if(!this.horizResizing)return;e=e||window.event,document.documentElement.style.cursor="n-resize";const t=Math.floor(e.clientY/this.uiView.clientHeight*100);t>=this.options.minSplit&&t<=100-this.options.minSplit&&(this.options.split=t,this.refreshUI(),this.saveOptions())}processExecuteAction(e){this.refreshUI()}handleActive(e){let t=e?e.detail?.target||e.target:window.event.srcElement;const n=this.domView.querySelector(".adi-active-node");if(n&&Ml(n,"adi-active-node"),!t||t.nodeType===Node.DOCUMENT_NODE)return;if(t&&t.classList&&t.classList.contains("adi-end-node")&&(t=t.parentNode.querySelector(".adi-normal-node")),this.activeElement=t,Rl(t,"adi-active-node"),this.options.makeVisible){this.domView.querySelector(".adi-content").scrollIntoView({block:"center",behavior:"instant"})}const i=this.getSelected();if(this.drawAttrs(i),i&&"function"==typeof i.getModelItem&&i.getModelItem()?.node){let e=i.modelItem.node;e?.nodeType===Node.ATTRIBUTE_NODE&&(e=e.ownerElement),window.document.dispatchEvent(new CustomEvent("log-active-element",{detail:{target:e}}))}}highlightElement(e){let t=e?e.target:window.event.srcElement;t.classList.contains("adi-end-node")&&(t=t.parentNode.querySelector(".adi-normal-node"));const n=this.sourceNodeByInspectorNodeLookup.get(t);n&&n.ownerDocument===window.document&&n&&("mouseover"===e.type?(this.styleBackup=n.getAttribute("style")||"",n.setAttribute("style",`outline: 2px solid blue; ${this.styleBackup}`)):""===this.styleBackup?n.removeAttribute("style"):n.setAttribute("style",this.styleBackup))}handleLookup(e){const t=e?e.detail?.target||e.target:window.event.srcElement;if(!this.document.contains(t))return;if(t.nodeType===Node.DOCUMENT_NODE)return;if(-1!==t.className.indexOf("adi-menu-lookup"))return this.elemLookup?(Ml(t,"adi-active"),this.elemLookup=!1,this.removeEvent(document.body,"mouseover",this.handleLookup,!0),this.removeEvent(document.body,"mouseout",this.handleLookup,!0),void this.removeEvent(document.body,"click",this.handleLookup,!0)):(Rl(t,"adi-active"),this.elemLookup=!0,this.addEventDelegate(document.body,"mouseover",this.handleLookup,!1,"*",!0,"adi-wrapper"),this.addEventDelegate(document.body,"mouseout",this.handleLookup,!1,"*",!0,"adi-wrapper"),void this.addEventDelegate(document.body,"click",this.handleLookup,!1,"*",!0,"adi-wrapper"));if("mouseover"===e.type)return this.styleBackup=t.getAttribute("style")||"",void t.setAttribute("style",`outline: 1px dashed red; ${this.styleBackup}`);if("mouseout"===e.type)return void t.setAttribute("style",this.styleBackup);this.elemLookup=!1,Ml(this.menuView.querySelector(".adi-menu-lookup"),"adi-active"),t.setAttribute("style",this.styleBackup),this.removeEvent(document.body,"mouseover",this.handleLookup,!0),this.removeEvent(document.body,"mouseout",this.handleLookup,!0),this.removeEvent(document.body,"click",this.handleLookup,!0),function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1}(e);const n=this.sourceNodeByInspectorNodeLookup.get(t);if(!n)return;if(n&&n.click(),!n.parentNode)return;let i,r=n.parentNode;for(r.querySelector("ul")&&r.querySelector("ul").setAttribute("data-open","true");r!==this.domView.querySelector(".adi-content");)-1!==r.className.indexOf("adi-node")&&(i=r.querySelector(".adi-trigger"),i&&(Ml(i,"closed"),Rl(i,"opened")),r=r.parentNode,r.setAttribute("data-open","true")),r=r.parentNode;this.options.makeVisible&&n.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"}),t.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"})}addEventDelegate(e,t,n,i,r,s,o){const a=e=>{const t=e?e.target:window.event.srcElement,i=r.substr(1);let s=!1;if(o){let e=t;for(;e!==document;){if(e.id===o)return;e=e.parentNode}}s=0===r.indexOf("#")?t.id===i:0===r.indexOf(".")?-1!==t.className.indexOf(i):"*"===r||t.nodeName.toLowerCase()===r,s&&n(e)};s&&this.delegatedEvents.push({handle:a,elem:e,fn:n,evt:t}),e.addEventListener(t,a,i)}removeEvent(e,t,n,i){if("object"!=typeof e)throw new Error(`addEvent: Expected argument elem of type object, ${typeof e} given.`);let r=null;if(i)for(let i=0,s=this.delegatedEvents.length;i<s;i+=1)if(r=this.delegatedEvents[i],r.elem===e&&r.evt===t&&r.fn===n){n=r.handle,this.delegatedEvents.splice(i,1);break}}registerEvents(){const e=()=>{if("#document"!==this.instanceId){const e=window.document.querySelector(`#${this.instanceId}`);this.document=e.getInstanceData()}this.drawDOM(this.document,this.domView.querySelector(".adi-tree-view"),!0)};document.addEventListener("instance-loaded",e),document.addEventListener("value-changed",e),document.addEventListener("ready",e),document.addEventListener("mouseup",(()=>{document.documentElement.style.cursor="default",this.vertResizing=!1,this.horizResizing=!1}),!1),document.addEventListener("mousemove",(e=>this.verticalResize(e)),!1),document.addEventListener("mousemove",(e=>this.horizontalResize(e)),!1),window.addEventListener("resize",(e=>this.refreshUI(e)),!1),document.addEventListener("keypress",(e=>this.processKey(e)),!1),document.addEventListener("log-active-element",(e=>this.handleLookup(e)),!1);this.addEventDelegate(this.domView,"click",(e=>{const t=e?e.target:window.event.srcElement,n=t.parentNode.querySelector("ul");"true"===n.getAttribute("data-open")?(Ml(t,"opened"),Rl(t,"closed"),n.setAttribute("data-open","false")):(Ml(t,"closed"),Rl(t,"opened"),n.setAttribute("data-open","true"))}),!1,".adi-trigger"),this.addEventDelegate(this.domView,"click",(e=>this.handleActive(e)),!1,".adi-normal-node"),this.addEventDelegate(this.domView,"click",(e=>this.handleActive(e)),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseover",(e=>{Rl((e?e.target:window.event.srcElement).parentNode.querySelector(".adi-normal-node"),"hover")}),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseout",(e=>{Ml((e?e.target:window.event.srcElement).parentNode.querySelector(".adi-normal-node"),"hover")}),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseover",(e=>this.highlightElement(e)),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseover",(e=>this.highlightElement(e)),!1,".adi-normal-node"),this.addEventDelegate(this.domView,"mouseout",(e=>this.highlightElement(e)),!1,".adi-end-node"),this.addEventDelegate(this.domView,"mouseout",(e=>this.highlightElement(e)),!1,".adi-normal-node"),this.menuView.querySelector(".adi-menu-lookup").addEventListener("click",(e=>this.handleLookup(e)),!1),document.addEventListener("handle-active",(e=>{if(e.detail.selected===this.getSelected())return;const{selected:t}=e.detail,n=this.sourceNodeByInspectorNodeLookup.get(t);if(this.options.makeVisible){const e=this.domView.querySelector(".adi-content");(n.offsetTop>=e.clientHeight||n.offsetTop<=e.scrollTop)&&(e.scrollTop=n.offsetTop-Math.floor(e.clientHeight/2))}this.drawAttrs(this.getSelected())})),document.addEventListener("execute-action",(e=>this.processExecuteAction(event)),{capture:!0}),this.addEventDelegate(this.optsView,"change",(e=>this.changeOption(e)),!1,"input"),this.addEventDelegate(this.optsView,"click",(e=>this.toggleOptions(e)),!1,".adi-opt-close"),this.menuView.querySelector(".adi-menu-config").addEventListener("click",(e=>this.toggleOptions(e)),!1),this.isInstanceViewer||this.addEventDelegate(this.attrView,"change",this.changeAttribute,!1,"input")}}class Ll extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.instanceName=null,this.instance=null}connectedCallback(){this.render(),this.instance?this.shadowRoot.querySelector("#focus-button").style="display: none":this.setupFocusButton()}setInstance(e){this.instance=e}disconnectedCallback(){this.adiInstance=null}setupFocusButton(){let e="",t=null;const n=()=>{""===e?t.removeAttribute("style"):t.setAttribute("style",e),t=null},i=i=>{const{target:r}=i;if("mouseover"===i.type)return e=r.getAttribute("style")||"",r.setAttribute("style",`outline: 2px solid blue; ${e}`),void(t=r);t&&n()},r=this.shadowRoot.querySelector("#focus-button");let s=!1;const o=window.document.head.appendChild(document.createElement("style")),a=()=>{s=!1,window.document.body.removeEventListener("click",l),r.classList.remove("selected-btn"),o.innerHTML="",document.body.style.cursor="auto",window.document.body.removeEventListener("mouseover",i),window.document.body.removeEventListener("mouseout",i),t&&n()},l=e=>{a(),e.preventDefault(),e.stopPropagation(),e.target!==r&&window.document.dispatchEvent(new CustomEvent("log-active-element",{detail:{target:e.target}}))},h=()=>{s=!0,r.classList.add("selected-btn"),document.body.style.cursor="crosshair",window.document.body.removeEventListener("click",l),o.innerHTML='fx-fore::before { color:blue; content: "Sub fore!" } fx-fore {border: solid 1px blue}',window.document.body.addEventListener("click",l),window.document.body.addEventListener("mouseover",i),window.document.body.addEventListener("mouseout",i)};window.document.addEventListener("keyup",(e=>{s&&"Escape"===e.code?a():!s&&"KeyI"===e.code&&e.ctrlKey&&h()})),r.addEventListener("click",(e=>{s?a():h(),e.preventDefault(),e.stopPropagation()}))}render(){this.shadowRoot.innerHTML="\n          <style>\n              \n      @import '../../resources/fore.css';\n      \n        :host {\n          display:block;\n          background:transparent;\n        }\n        body {\n            -webkit-animation: bugfix infinite 1s;\n            font-size:1rem;\n        }\n        \n        @-webkit-keyframes bugfix {\n            from {\n                padding: 0\n            }\n            to {\n                padding: 0\n            }\n        }\n        .adi-content {\n            position: relative;\n            overflow: auto;\n            box-sizing: border-box;\n            -moz-box-sizing: border-box;\n            height: 100% !important;\n            padding:0;\n            font-size:0.8em;\n        }\n        .adi-content header{\n            padding:0.5rem;\n            // background:rgba(255, 255, 255, 0.2);\n            border-bottom:2px solid #ddd;\n            border-collapse:collapse;\n        }\n        .adi-content > * {\n            padding:0 0.25em;\n        }\n        \n        #adi-wrapper {\n            top: 0;\n            font-family: \"Segoe UI\", Arial;\n            font-size: 1.1rem;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n            position:relative;\n            height:calc(100% - 8rem);\n            display:flex;\n        }\n        \n        #adi-wrapper.left {\n            left: 0\n        }\n        \n        #adi-wrapper.right {\n            right: 0\n        }\n        \n        #adi-wrapper.transparent {\n            background: rgba(250, 250, 250, 0.9)\n        }\n        \n        #adi-panel {\n            position:fixed;\n            top:0;\n            /*bottom: 0;*/\n            right: 0;\n            height: 24px;\n            background: #d4d4d4;\n            border-top: 1px solid #bbc5c9\n        }\n        \n        #adi-panel .adi-path-wrap {\n            position:absolute;\n            bottom: 0;\n            left: 0;\n            width: 80%;\n            height: 24px;\n            padding: 0 13px 0 18px;\n            line-height: 24px;\n            overflow: hidden;\n            box-sizing: border-box;\n            -moz-box-sizing: border-box\n        }\n        \n        #adi-panel .adi-path-wrap.adi-overflowing .adi-path-left, \n        #adi-panel .adi-path-wrap.adi-overflowing .adi-path-right {\n            display: block\n        }\n        \n        #adi-panel .adi-path {\n            height: 24px;\n            overflow: hidden;\n            white-space: nowrap\n        }\n        \n        #adi-panel .adi-path-left, #adi-panel .adi-path-right {\n            display: none;\n            position: absolute;\n            top: 0;\n            width: 8px;\n            height: 24px;\n            background-repeat: no-repeat;\n            background-position: center center;\n            opacity: .7\n        }\n        \n        #adi-panel .adi-path-left:hover, #adi-panel .adi-path-right:hover {\n            opacity: 1\n        }\n        \n        #adi-panel .adi-path-left {\n            left: 7px;\n            background-image: url('img/left_shift.png')\n        }\n        \n        #adi-panel .adi-path-right {\n            position:absolute;\n            right: 2px;\n            background-image: url('/resources/scripts/dom-inspector/img/right_shift.png')\n        }\n        \n        #adi-panel .adi-menu-wrap {\n            bottom: 0;\n            right: 24px;\n            width: 50px;\n            height: 24px\n        }\n        \n        #adi-panel .adi-menu-lookup, #adi-panel .adi-menu-config {\n            display: block;\n            float: left;\n            width: 24px;\n            height: 24px;\n            border-left: 1px solid #bbc5c9;\n            background-position: center center;\n            background-repeat: no-repeat;\n            opacity: .7;\n            border-radius: 0\n        }\n        \n        #adi-panel .adi-menu-lookup:hover, #adi-panel .adi-menu-config:hover {\n            background-color: #c5d9d8;\n            opacity: 1\n        }\n        \n        #adi-panel .adi-menu-lookup.adi-active, #adi-panel .adi-menu-config.adi-active {\n            background-color: #fafafa;\n            opacity: 1\n        }\n        \n        #adi-panel .adi-menu-lookup {\n            background-image: url('/resources/scripts/dom-inspector/img/lookup.png')\n        }\n        \n        #adi-panel .adi-menu-config {\n            background-image: url('/resources/scripts/dom-inspector/img/config.png')\n        }\n        \n        \n        \n        #adi-vert-split {\n            position: fixed;\n            top: 0;\n            width: 4px;\n            height: 100%;\n            cursor: e-resize;\n            border-width: 0 1px 0 0;\n            background: #bbc5c9;\n            border-color: #768285;\n            border-style: solid;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n        }\n        \n        #adi-vert-split:hover {\n            background: #c5d9d8;\n        }\n        \n        \n        #adi-dom-view {\n            border-right:2px solid #ddd;\n            overflow:auto;\n            flex-grow:3;\n        }\n        \n        #adi-dom-view ul {\n            margin: 0;\n            padding: 0;\n            list-style: none\n        }\n        \n        #adi-dom-view ul[data-open=true] {\n            display: block\n        }\n        \n        #adi-dom-view ul[data-open=false] {\n            display: none\n        }\n        \n        #adi-dom-view ul ul {\n            margin: 4px 0\n        }\n        \n        #adi-dom-view ul li {\n            padding-left: 1em;\n            padding-bottom: 0.125em;\n            margin: 0;\n            padding-top: 0.125em;        \n        }\n        \n        \n        \n        \n        \n        \n        \n        #adi-dom-view .adi-normal-node, \n        #adi-dom-view .adi-end-node {\n            margin-right: 5px;\n            padding: 0 6px 0px;\n            background: #d2e8ff;\n            border-radius: 8px;\n            cursor: default;\n            font-size:0.8rem;\n        }\n        #adi-dom-view .adi-text-node:after, #adi-dom-view .adi-comment-node:after {\n            content: '\"'\n        }\n        \n        #adi-dom-view .adi-text-node:before, #adi-dom-view .adi-comment-node:before {\n            content: '\"'\n        }\n        \n        #adi-dom-view .adi-comment-node {\n            color: #999;\n            font-style: italic\n        }\n        \n        #adi-dom-view .adi-text-node, #adi-dom-view .adi-comment-node {\n            display: block;\n            padding: 3px 8px;\n            color: #444;\n            background: #fff;\n            border-radius: 8px\n        }\n        \n        #adi-dom-view .adi-normal-node:hover, \n        #adi-dom-view .adi-normal-node.hover, \n        #adi-dom-view .adi-end-node:hover, \n        #adi-dom-view .adi-end-node.hover {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n       #adi-dom-view .adi-normal-node:hover ~ span,\n       #adi-dom-view .adi-normal-node.hover ~ span,\n       #adi-dom-view .adi-end-node:hover ~ span,\n       #adi-dom-view .adi-end-node.hover ~ span {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n        #adi-dom-view .adi-normal-node.adi-active-node, \n        #adi-dom-view .adi-end-node.adi-active-node {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n        #adi-dom-view .adi-normal-node.adi-active-node ~ span,\n        #adi-dom-view .adi-end-node.adi-active-node ~ span {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n        \n        \n        \n        \n        \n        #adi-dom-view .adi-trigger {\n            display: inline-block;\n            width: 10px;\n            height: 10px;\n            margin: 0 5px 0 -13px;\n            opacity: .7\n        }\n        \n        #adi-dom-view .adi-trigger.closed {\n            // background: url('/resources/scripts/dom-inspector/img/node_closed.png') no-repeat;\n        }   \n        #adi-dom-view .adi-trigger.closed::before {\n            content:'\\25B8';\n        }\n        \n        #adi-dom-view .adi-trigger.opened {\n            // background: url('/resources/scripts/dom-inspector/img/node_opened.png') no-repeat\n        }\n        #adi-dom-view .adi-trigger.opened::before{\n            content:'\\25BE';\n        }\n        \n        #adi-dom-view .adi-trigger:hover {\n            opacity: 1\n        }\n        \n        #adi-opts-view {\n            position: relative;\n            height: 100%;\n            padding: 0 15px;\n            background: #fff\n        }\n        \n        #adi-opts-view.adi-hidden {\n            display: none\n        }\n        \n        #adi-opts-view .adi-opt-heading, #adi-opts-view .adi-opt {\n            display: block;\n            padding: 5px 0\n        }\n        \n        #adi-opts-view .adi-opt-heading {\n            padding: 20px 0 10px;\n            font-size: 1rem;\n        }\n        \n        #adi-opts-view .adi-opt-heading:first-child {\n            padding-top: 10px\n        }\n        \n        #adi-opts-view .adi-opt input {\n            margin-right: 6px\n        }\n        \n        #adi-opts-view .adi-opt-close {\n            position: absolute;\n            top: 5px;\n            right: 28px;\n            width: 16px;\n            height: 16px;\n            background: url('/resources/scripts/dom-inspector/img/options_close.png') no-repeat;\n            opacity: .7;\n        }\n        \n        #adi-opts-view .adi-opt-close:hover {\n            opacity: 1;\n        }\n        \n        #adi-attr-view {\n            top: 0.5rem;\n            border: 1px solid #ddd;\n            overflow: auto;\n            padding: 0.25em;\n            height: calc(90% - 1em);\n            min-width: 10rem;\n            position: absolute;\n            z-index: 10;\n            right: 0.5rem;\n            background:rgba(255,255,255,0.85);\n        }\n        #adi-attr-view > .adi-content{\n            height:calc(100% - 5em);\n            overflow:auto;\n        }\n        \n        #adi-attr-view .adi-attr {\n            display: block;\n            padding: 0.25em;\n        }\n        \n        #adi-attr-view hr {\n            height: 1px;\n            border: none\n        }\n        \n        #adi-attr-view input[type=text] {\n            width: calc(100% - 0.5em);\n            margin-top: 3px;\n            padding: 2px;\n        }\n        \n        #adi-horiz-split {\n            height: 4px;\n            cursor: n-resize;\n            border-width: 0 0 1px 0;\n            background: #bbc5c9;\n            border-color: #768285;\n            border-style: solid;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n        }\n        \n        #adi-horiz-split:hover {\n            background: #c5d9d8;\n        }\n        \n        #adi-dom-view .fore-node{\n            background: var(--paper-blue-700);\n            font-size:1.1em;\n             color:white;\n        }\n        #adi-dom-view .adi-normal-node.fore-node:hover {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        #adi-dom-view .adi-end-node.fore-node{\n            background: var(--paper-blue-700);\n            font-size:1em;\n            color:white;\n       }\n\n        #adi-dom-view .adi-node .adi-active-node.fore-node,\n        #adi-dom-view .adi-node.action .adi-active-node.fore-node,\n        #adi-dom-view .adi-node.action .adi-active-node.fore-node ~ .adi-end-node\n         {\n            background: var(--paper-grey-700);\n            color:white;\n        }\n        \n        #adi-dom-view .adi-node.fx-fore{\n            background:var(--paper-blue-grey-50); \n        }\n        #adi-dom-view .adi-node.fx-model{\n            background:var(--paper-blue-grey-100); \n            padding:0.25em 0;\n        }       \n               \n        #adi-dom-view .adi-node.action .fore-node {\n            background:var(--paper-blue-grey-100);\n            color:black;\n            font-family:monospace;\n        }\n                    \n        .toggleView{\n            /*width:20px;*/\n            /*height: 20px;*/\n        }\n        input, select{\n            display: block;\n        }\n        header{\n            background:rgba(255, 255, 255, 0.2);\n        }\n\n        .selected-btn { color: orange }\n      \n          </style>\n          \n        <slot name=\"header\"></slot>\n        <button id=\"focus-button\">Focus</button>\n        <slot></slot>\n      \n      ",!this.hasAttribute("instance")||this.getAttribute("instance"),this.adiInstance=new Fl(this.shadowRoot,this.hasAttribute("instance")?this.instance:"#document")}verticalResize(e){if(!this.vertResizing)return;e=e||window.event,document.documentElement.style.cursor="e-resize";const t=this.options.width+this.xPos-e.clientX;t>=this.options.minWidth&&(this.options.width=t,this.xPos=e.clientX,this.refreshUI(),this.saveOptions())}}customElements.get("fx-dom-inspector")||customElements.define("fx-dom-inspector",Ll);class Ul extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.instanceElement=null,this.foreSelector=null}connectedCallback(){this.container=this.querySelector(".json-path-picker-container"),this.foreSelector=this.hasAttribute("fore")?this.getAttribute("fore"):"fx-fore",this.render()}render(){const e=this.hasAttribute("instance")?this.getAttribute("instance"):"default";if(!document.querySelector(this.foreSelector))throw new Error(`this '${this.foreSelector}' does not match a fx-fore element`);this.shadowRoot.innerHTML=`\n          <style>\n              \n        @import '../../resources/fore.css';\n      \n        :host {\n          display:block;\n          font-size:0.8em;\n          background:rgba(250, 250, 250, 0.9);\n        }\n        .container{\n            margin-left:1em;\n        }\n        .header{\n            margin-left:0;\n        }\n\n        ::slot[name='header']{\n            margin-left:-1em;\n        }\n        /* Syntax highlighting for JSON objects */\n        ul.json-dict, ol.json-array {\n          list-style-type: none;\n          margin: 0 0 0 1px;\n          border-left: 1px dotted #ccc;\n          padding-left: 2em;\n        }\n        .json-string {\n          // color: #0B7500;\n        }\n        .json-literal {\n          color: #1A01CC;\n          font-weight: bold;\n        }\n        \n        /* Toggle button */\n        a.json-toggle {\n          position: relative;\n          color: inherit;\n          text-decoration: none;\n        }\n        a.json-toggle:focus {\n          outline: none;\n        }\n        a.json-toggle:before {\n          content: "\\25BC"; /* down arrow */\n          position: absolute;\n          display: inline-block;\n          width: 1em;\n          left: -1.2em;\n          font-size:0.8em;\n        }\n        a.json-toggle.collapsed:before {\n          content: "\\25B6"; /* left arrow */\n        }\n        \n        /* Collapsable placeholder links */\n        a.json-placeholder {\n          color: #aaa;\n          padding: 0 1em;\n          text-decoration: none;\n        }\n        a.json-placeholder:hover {\n          text-decoration: underline;\n        }\n        \n        /* Copy path icon */\n        .pick-path {\n          color: lightgray;\n          cursor: pointer;\n          margin-left: 3px;\n        }\n        \n        .pick-path:hover {\n          color: darkgray;\n        }\n        \n      \n          </style>\n          <slot name="header">\n            <header class="header">${e}</header>\n          </slot>\n          <slot></slot>\n          \n          <div class="container"></div>\n      \n      `;const t=document.querySelector(`#${e}`);if(!t||"FX-INSTANCE"!==t.nodeName||"json"!==t.getAttribute("type"))throw new Error(`this '${e}' does not match an fx-instance element or is not of type JSON`);const n=this.shadowRoot.querySelector(".container"),i=t.instanceData;let r=this.json2html(i,{outputWithQuotes:!0});this.isCollapsable(i)&&(r="<a href='#' class=\"json-toggle\"></a>".concat(r)),n.innerHTML=r;this.shadowRoot.querySelectorAll(".json-toggle").forEach((e=>{e.addEventListener("click",this._handleToggleEvent.bind(this))}))}disconnectedCallback(){}_isHidden(e){const t=e.offsetWidth,n=e.offsetHeight;return 0===t&&0===n||"none"===window.getComputedStyle(e).display}_handleToggleEvent(e){const t=e.target;t.classList.toggle("collapsed");const n=this._siblings(t,"ul.json-dict, ol.json-array",(e=>{e.style.display=""===e.style.display||"block"===e.style.display?"none":"block"}));for(let e=0;e<n.length;e+=1)if(this._isHidden(n[e])){const t=n[e].children;let i=0;for(let e=0;e<t.length;e+=1)"LI"===t[e].tagName&&(i+=1);const r=i+(i>1?" items":" item");n[e].insertAdjacentHTML("afterend",'<a href class="json-placeholder">'.concat(r,"</a>"))}else this._siblings(n[e],".json-placeholder",(e=>e.parentNode.removeChild(e)));e.stopPropagation(),e.preventDefault()}_siblings(e,t,n){const i=[];for(let n=0;n<e.parentNode.children.length;n+=1){const r=e.parentNode.children[n];r!==e&&"string"==typeof t&&r.matches(t)&&i.push(r)}if(n&&"function"==typeof n)for(let e=0;e<i.length;e+=1)n(i[e]);return i}json2html(e,t){let n="";if("string"==typeof e){const t=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");this.isUrl(t)?n+='<a href="'.concat(t,'" class="json-string">').concat(t,"</a>"):n+='<span class="json-string">"'.concat(t,'"</span>')}else if("number"==typeof e)n+='<span class="json-literal">'.concat(e,"</span>");else if("boolean"==typeof e)n+='<span class="json-literal">'.concat(e,"</span>");else if(null===e)n+='<span class="json-literal">null</span>';else if(e instanceof Array)if(e.length>0){n+='[<ol class="json-array">';for(let i=0;i<e.length;i+=1)n+='<li data-key-type="array" data-key="'.concat(i,'">'),this.isCollapsable(e[i])&&(n+='<a href="#" class="json-toggle"></a>'),n+=this.json2html(e[i],t),i<e.length-1&&(n+=","),n+="</li>";n+="</ol>]"}else n+="[]";else if("object"===this._typeof(e)){let i=Object.keys(e).length;if(i>0){n+='{<ul class="json-dict">';for(const r in e)if(e.hasOwnProperty(r)){n+='<li data-key-type="object" data-key="'.concat(r,'">');const s=t.outputWithQuotes?'<span class="json-string">"'.concat(r,'"</span>'):r;this.isCollapsable(e[r])?n+="<a href='#' class=\"json-toggle\">".concat(s,"</a>"):n+=s,n+=": ".concat(this.json2html(e[r],t)),i-=1,i>0&&(n+=","),n+="</li>"}n+="</ul>}"}else n+="{}"}return n}isUrl(e){return/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#:.?+=&%@!\-/]))?/.test(e)}_typeof(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?this._typeof=function(e){return typeof e}:this._typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},this._typeof(e)}isCollapsable(e){return e instanceof Object&&Object.keys(e).length>0}static get observedAttributes(){return["data"]}attributeChangedCallback(e,t,n){"data"===e&&(this.jsonTextarea.value=n,this.updateTree(n))}updateTree(e){try{this.data=JSON.parse(e),this.treeView.innerHTML="",this.treeView.appendChild(this.createTreeView(this.data,""))}catch(e){alert("Invalid JSON")}}createTreeView(e,t){const n=document.createElement("ul");if(n.classList.add("jp-ul"),Array.isArray(e))e.forEach(((e,i)=>{const r=document.createElement("li");r.classList.add("jp-li");const s=`${t}[${i}]`;r.appendChild(this.createItemView(s,e)),n.appendChild(r)}));else if("object"==typeof e&&null!==e)Object.keys(e).forEach((i=>{const r=document.createElement("li");r.classList.add("jp-li");const s=`${t}.${i}`;r.appendChild(this.createItemView(s,e[i])),n.appendChild(r)}));else{const i=document.createElement("li");i.classList.add("jp-li"),i.appendChild(this.createItemView(t,e)),n.appendChild(i)}return n}}customElements.get("fx-json-instance")||customElements.define("fx-json-instance",Ul);class Vl extends HTMLElement{static get properties(){return{fore:{type:Object,description:"The fx-fore element the devtools are attached to"},instances:{type:Array,description:"Instances of selected Fore element"},selector:{type:String,description:"optional selector to attach to a certain fx-fore element with given id"}}}constructor(){super(),this.attachShadow({mode:"open"}),Object.keys(this.constructor.properties).forEach((e=>{const t=this.constructor.properties[e],n=t.attribute||e,i=this.getAttribute(n)||t.default,r=t.type(i);this[e]=r})),this.isResizing=!1,this.lastY=0,this.defaultHeight="40vh",this.buttonByInstanceId=new Map;const e=e=>{this.fore=e,this.instances=[...this.fore.getModel().instances];const t=this.shadowRoot.querySelector(".instances header");t.textContent="Data ",this.instances.forEach((e=>{const n=document.createElement("button");n.setAttribute("type","button"),n.textContent=e.id,t.appendChild(n),this.buttonByInstanceId.set(e.id,n),n.addEventListener("click",(()=>this.selectInstance(e.id)))})),this.instances.length&&this.selectInstance(this.instances[0].id)},t=document.querySelector("fx-fore");t&&(t.inited?e(t):t.addEventListener("model-construct-done",(()=>e(t)))),window.document.addEventListener("log-active-element",(t=>{const n=t?t.detail?.target||t.target:window.event.srcElement,i=n.nodeType===Node.DOCUMENT_NODE?null:n.closest("fx-fore");i&&e(i);const r=this.instances.find((e=>"xml"===e.type&&e.instanceData.contains(n)));r&&this.selectInstance(r.id)}))}_getInstanceForTarget(e){this.instances.forEach((t=>"xml"===t.type&&t.instanceData.contains(e)||"json"===t.type?t:void 0))}selectInstance(e){const t=this.buttonByInstanceId.get(e);if(!t)return;if(t.classList.contains("selected-btn"))return;const n=this.shadowRoot.querySelector(".selected-btn");n&&n.classList.remove("selected-btn"),t.classList.add("selected-btn");const i=this.shadowRoot.querySelector(".instance-panel");i.innerHTML="",this.instances=[...this.fore.querySelectorAll("fx-instance")];const r=Array.from(this.instances).find((t=>t.id===e)),s=this._renderInstancePanel(r);i.append(s)}connectedCallback(){this.render()}_startResize(e){this.isResizing=!0,this.lastY=e.clientY}_resizePanel(e){if(!this.isResizing)return;const t=e.clientY-this.lastY;this.style.height=this.offsetHeight-t+"px",this.lastHeight=this.style.height,this.lastY=e.clientY}_stopResize(e){e.preventDefault(),e.stopPropagation(),this.isResizing=!1,document.body.style.height="inherit",document.body.style.width="inherit";const t=document.body.scrollHeight+this.offsetHeight;document.body.style.height=`${t}px`}render(){const e=`\n        <section class="wrapper">\n            <slot></slot>\n            <details class="fx-devtools" open>\n                <div class="resizer"></div>\n                <summary>Fore Glass \n                    <div>\n                        <svg preserveAspectRatio="xMidYMid meet" focusable="true" style="width: 24px;height: 24px; margin-bottom:-1px;" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n                            <g role="button" id="find-in-page"><path d="M20 19.59V8l-6-6H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c.45 0 .85-.15 1.19-.4l-4.43-4.43c-.8.52-1.74.83-2.76.83-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5c0 1.02-.31 1.96-.83 2.75L20 19.59zM9 13c0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3-3 1.34-3 3z"></path></g>\n                        </svg>\n                        <button class="optionsBtn" id="optionsTrigger">&#9881;</button>                    \n                    </div>\n                </summary>\n                <section class="panels">\n                    <section class="log">\n                        <fx-action-log selector="${this.selector}"></fx-action-log>\n                    </section>\n                    <section class="dom">\n                        <fx-dom-inspector>\n                            <header slot="header">Document</header>\n                        </fx-dom-inspector>\n                    </section>\n                    <section class="instances">\n                        <header></header>\n                        <div class="instance-panel">\n                        </div>\n                    </section>\n                    <section id="options">\n                        <fx-log-settings></fx-log-settings>\n                    </section>\n                </section>\n            </details>\n        </section>\n      `;this.shadowRoot.innerHTML=`\n          <style>\n              \n      @import '../../resources/fore.css';\n      \n        :host {\n          display:block;\n          position:fixed;\n          bottom:0;\n          left:0;\n          width:100vw;\n          height:var(--fx-devtools-height);\n          font-style:inherit;\n          font-family: 'Verdana' , 'Sans';\n          font-size:1em;\n          max-width:100vw;\n          height:3em;\n        }\n        :host(.open){\n            height:40vh;\n        }\n        \n        fx-action-log{\n            height:100%;\n        }\n        fx-dom-inspector{\n            max-height:100%;\n            height:100%;\n            position:relative;\n        }\n        body {\n        }\n        details{\n            height:100%;\n            background:#ebf6ff;\n        }\n        .dom{\n            width:45%;\n            border-left:1px solid #999;\n            position:relative\n        }\n        .dom fx-minimap{\n            position:absolute;\n            right:0;\n            top:0;\n            width:5rem;\n            height:6rem;\n        }\n        header{\n            padding:0.5rem;\n            border-bottom:2px solid #ddd;\n            font-size:1rem;\n        }\n        header button{\n            margin:0 0.5em;\n            border:thin solid #999;\n            padding:0 0.5em;\n            cursor:pointer;\n        }\n        header button:hover{\n            background:white;\n        }\n        \n        header button.selected-btn{\n            background:steelblue;\n            color:white;\n        }\n        .instances{\n            width:35%;\n            border-left:1px solid #999;\n        }\n        .instance-panel{\n            height:100%;\n            overflow:auto;\n        }\n        .panels{\n            display:grid;\n            grid-template-columns:20% 50% 30%;\n            height:100%;\n            width:100%;\n            max-height:100%;\n            border-top:thin solid #ddd;\n        }\n        .panels > section {\n            min-height:20rem;\n/*\n            background:#efefef;\n*/\n            position:relative;\n            display:inline-block;\n            height:100%;\n            width:auto;\n        }\n        #options{\n            display:none;\n        }\n        #options.open{\n            position:absolute;\n            z-index:10;\n            left:0;\n            top:3em;\n            height:100%;\n            display:block;\n            padding:0;\n            background:rgba(255,255,255,0.95);\n            width:100%;\n        }\n        .optionsBtn{\n            font-size:2rem;\n        }\n        details[open] .optionsBtn{\n            display:inline;\n        }\n        .resizer{\n            width:100vw;\n            height:6px;\n            background:rgba(215,220,235,0.3);\n            cursor: ns-resize;\n            position:absolute;\n            top:0;\n            \n        }\n        summary{\n            height:3rem;\n            padding:0 1em;\n            border-bottom:2px solid #ddd;\n            display:flex;\n            justify-content:space-between;\n            align-items:center;\n            color:rgba(0,0,0,0.7);\n            background: rgba(235, 255, 255, 0.2);\n            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);\n            backdrop-filter: blur(5px);\n            -webkit-backdrop-filter: blur(5px);\n            border: 1px solid rgba(255, 255, 255, 0.3);\n            \n            color:white;\n            font-weight:300;\n                      background: rgb(119,119,119);\n          background: linear-gradient(90deg, rgba(0,85,159,0.75) 0%, rgba(56,154,252,0.5) 50%, rgba(255,255,255,0.1) 100%);\n\n        }\n        summary button{\n            padding:0;\n            border:0;\n            background:transparent;\n        }\n        .wrapper{\n            height:100%;\n        }\n        .vertDevider{\n            background:#ddd;\n            width:4px;\n            height:100%;\n            cursor: ew-resize;\n        }\n      \n          </style>\n          ${e}\n      `,this.resizer=this.shadowRoot.querySelector(".resizer"),this.resizer.addEventListener("mousedown",this._startResize.bind(this)),document.addEventListener("mousemove",this._resizePanel.bind(this)),document.addEventListener("mouseup",this._stopResize.bind(this));const t=this.shadowRoot.querySelector("#optionsTrigger");t.addEventListener("click",(()=>{const e=this.shadowRoot.querySelector("#options");e.classList.toggle("open"),e.classList.contains("open")?t.style.background="lightsteelblue":t.style.background="transparent"}));this.shadowRoot.querySelector(".fx-devtools").addEventListener("click",(e=>{"DIV"===e.target.nodeName&&e.target.classList.contains("resizer")||(e.target.parentNode.open?(this.removeAttribute("open"),this.lastHeight=this.style.height,this.style.height="3em"):(this.setAttribute("open",""),this.style.height=this.lastHeight?this.lastHeight:"40vh"))})),this.classList.add("open")}_handleOpen(e){document.body.style.height=""}_renderInstancePanel(e){if("xml"===e.type){const t=document.createElement("fx-dom-inspector");return t.setInstance(e),t.setAttribute("instance",e.id),t}if("json"===e.type){const t=document.createElement("fx-json-instance");t.setAttribute("instance",e.id);const n=document.createElement("span");return n.setAttribute("slot","header"),t.append(n),t}}}customElements.get("fx-devtools")||customElements.define("fx-devtools",Vl);class zl extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.src=""}connectedCallback(){this.src=this.getAttribute("src");const e=`\n          <fx-fore src="${this.src}">\n          </fx-fore>\n          <slot id="default"></slot>\n        `;this.shadowRoot.innerHTML=`\n            <style>\n                \n          :host {\n            display:block;\n          }\n        \n            </style>\n            ${e}\n        `;this.shadowRoot.querySelector("#default").addEventListener("slotchange",(async e=>{const t=e.target.assignedElements().filter((e=>"LINK"===e.nodeName.toUpperCase()));if(!t)return;const n=[...document.styleSheets].map((e=>{if(t.find((t=>t.href===e.href)))try{return[...e.cssRules].map((e=>e.cssText)).join("")}catch(e){}})).filter(Boolean).join("\n"),i=new CSSStyleSheet;i.replaceSync(n),this.shadowRoot.adoptedStyleSheets=[i]}));const t=this.querySelector("fx-action");if(t){const e=t.cloneNode(!0);this.removeChild(t);this.shadowRoot.querySelector("fx-fore").appendChild(e)}}}customElements.get("fore-component")||customElements.define("fore-component",zl),(()=>{var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,r=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,o=((e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports))(((e,t)=>{!function(n,i){"object"==typeof e&&typeof t<"u"?t.exports=i():"function"==typeof define&&define.amd?define(i):(n=typeof globalThis<"u"?globalThis:n||self).TomSelect=i()}(e,(function(){function e(e,t){e.split(/\s+/).forEach((e=>{t(e)}))}class t{constructor(){this._events=void 0,this._events={}}on(t,n){e(t,(e=>{let t=this._events[e]||[];t.push(n),this._events[e]=t}))}off(t,n){var i=arguments.length;0!==i?e(t,(e=>{if(1===i)return void delete this._events[e];let t=this._events[e];void 0!==t&&(t.splice(t.indexOf(n),1),this._events[e]=t)})):this._events={}}trigger(t,...n){var i=this;e(t,(e=>{let t=i._events[e];void 0!==t&&t.forEach((e=>{e.apply(i,n)}))}))}}let n,i,r=e=>(e=e.filter(Boolean)).length<2?e[0]||"":1==h(e)?"["+e.join("")+"]":"(?:"+e.join("|")+")",s=e=>{if(!a(e))return e.join("");let t="",n=0,i=()=>{n>1&&(t+="{"+n+"}")};return e.forEach(((r,s)=>{r!==e[s-1]?(i(),t+=r,n=1):n++})),i(),t},o=e=>{let t=u(e);return r(t)},a=e=>new Set(e).size!==e.length,l=e=>(e+"").replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu,"\\$1"),h=e=>e.reduce(((e,t)=>Math.max(e,c(t))),0),c=e=>u(e).length,u=e=>Array.from(e),d=e=>{if(1===e.length)return[[e]];let t=[],n=e.substring(1);return d(n).forEach((function(n){let i=n.slice(0);i[0]=e.charAt(0)+i[0],t.push(i),i=n.slice(0),i.unshift(e.charAt(0)),t.push(i)})),t},p=[[0,65535]],f={},m={"/":"",0:"",a:"",aa:"",ae:"",ao:"",au:"",av:"",ay:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",oe:"",oi:"",oo:"",ou:"",p:"",q:"",r:"",s:"",t:"",th:"",tz:"",u:"",v:"",vy:"",w:"",y:"",z:"",hv:""};for(let e in m){let t=m[e]||"";for(let n=0;n<t.length;n++){let i=t.substring(n,n+1);f[i]=e}}let g=new RegExp(Object.keys(f).join("|")+"|[-]","gu"),O=(e,t="NFKD")=>e.normalize(t),y=e=>u(e).reduce(((e,t)=>e+v(t)),""),v=e=>(e=O(e).toLowerCase().replace(g,(e=>f[e]||"")),O(e,"NFC"));let b=e=>{let t={},n=(e,n)=>{let i=t[e]||new Set,r=new RegExp("^"+o(i)+"$","iu");n.match(r)||(i.add(l(n)),t[e]=i)};for(let t of function*(e){for(let[t,n]of e)for(let e=t;e<=n;e++){let t=String.fromCharCode(e),n=y(t);n!=t.toLowerCase()&&(n.length>3||0!=n.length&&(yield{folded:n,composed:t,code_point:e}))}}(e))n(t.folded,t.folded),n(t.folded,t.composed);return t},w=e=>{let t=b(e),n={},s=[];for(let e in t){let i=t[e];i&&(n[e]=o(i)),e.length>1&&s.push(l(e))}s.sort(((e,t)=>t.length-e.length));let a=r(s);return i=new RegExp("^"+a,"u"),n},x=(e,t=1)=>(t=Math.max(t,e.length-1),r(d(e).map((e=>((e,t=1)=>{let i=0;return e=e.map((e=>(n[e]&&(i+=e.length),n[e]||e))),i>=t?s(e):""})(e,t))))),S=(e,t=!0)=>{let n=e.length>1?1:0;return r(e.map((e=>{let i=[],r=t?e.length():e.length()-1;for(let t=0;t<r;t++)i.push(x(e.substrs[t]||"",n));return s(i)})))},k=(e,t)=>{for(let n of t){if(n.start!=e.start||n.end!=e.end||n.substrs.join("")!==e.substrs.join(""))continue;let t=e.parts,i=e=>{for(let n of t){if(n.start===e.start&&n.substr===e.substr)return!1;if(1!=e.length&&1!=n.length&&(e.start<n.start&&e.end>n.start||n.start<e.start&&n.end>e.start))return!0}return!1};if(!(n.parts.filter(i).length>0))return!0}return!1};class A{constructor(){this.parts=[],this.substrs=[],this.start=0,this.end=0}add(e){e&&(this.parts.push(e),this.substrs.push(e.substr),this.start=Math.min(e.start,this.start),this.end=Math.max(e.end,this.end))}last(){return this.parts[this.parts.length-1]}length(){return this.parts.length}clone(e,t){let n=new A,i=JSON.parse(JSON.stringify(this.parts)),r=i.pop();for(let e of i)n.add(e);let s=t.substr.substring(0,e-r.start),o=s.length;return n.add({start:r.start,end:r.start+o,length:o,substr:s}),n}}let C=e=>{(e=>{void 0===n&&(n=w(e||p))})(),e=y(e);let t="",r=[new A];for(let n=0;n<e.length;n++){let s=e.substring(n).match(i),o=e.substring(n,n+1),a=s?s[0]:null,l=[],h=new Set;for(let e of r){let t=e.last();if(!t||1==t.length||t.end<=n)if(a){let t=a.length;e.add({start:n,end:n+t,length:t,substr:a}),h.add("1")}else e.add({start:n,end:n+1,length:1,substr:o}),h.add("2");else if(a){let i=e.clone(n,t),r=a.length;i.add({start:n,end:n+r,length:r,substr:a}),l.push(i)}else h.add("3")}if(l.length>0){l=l.sort(((e,t)=>e.length()-t.length()));for(let e of l)k(e,r)||r.push(e)}else if(n>0&&1==h.size&&!h.has("3")){t+=S(r,!1);let e=new A,n=r[0];n&&e.add(n.last()),r=[e]}}return t+=S(r,!0),t},_=(e,t)=>{if(e)return e[t]},E=(e,t)=>{if(e){for(var n,i=t.split(".");(n=i.shift())&&(e=e[n]););return e}},T=(e,t,n)=>{var i,r;return e&&(e+="",null!=t.regex)&&-1!==(r=e.search(t.regex))?(i=t.string.length/e.length,0===r&&(i+=.5),i*n):0},P=(e,t)=>{var n=e[t];if("function"==typeof n)return n;n&&!Array.isArray(n)&&(e[t]=[n])},$=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},N=(e,t)=>"number"==typeof e&&"number"==typeof t?e>t?1:e<t?-1:0:(e=y(e+"").toLowerCase())>(t=y(t+"").toLowerCase())?1:t>e?-1:0;class I{constructor(e,t){this.items=void 0,this.settings=void 0,this.items=e,this.settings=t||{diacritics:!0}}tokenize(e,t,n){if(!e||!e.length)return[];let i=[],r=e.split(/\s+/);var s;return n&&(s=new RegExp("^("+Object.keys(n).map(l).join("|")+"):(.*)$")),r.forEach((e=>{let n,r=null,o=null;s&&(n=e.match(s))&&(r=n[1],e=n[2]),e.length>0&&(o=this.settings.diacritics?C(e)||null:l(e),o&&t&&(o="\\b"+o)),i.push({string:e,regex:o?new RegExp(o,"iu"):null,field:r})})),i}getScoreFunction(e,t){var n=this.prepareSearch(e,t);return this._getScoreFunction(n)}_getScoreFunction(e){let t=e.tokens,n=t.length;if(!n)return function(){return 0};let i=e.options.fields,r=e.weights,s=i.length,o=e.getAttrFn;if(!s)return function(){return 1};let a=1===s?function(e,t){let n=i[0].field;return T(o(t,n),e,r[n]||1)}:function(e,t){var n=0;if(e.field){let i=o(t,e.field);!e.regex&&i?n+=1/s:n+=T(i,e,1)}else $(r,((i,r)=>{n+=T(o(t,r),e,i)}));return n/s};return 1===n?function(e){return a(t[0],e)}:"and"===e.options.conjunction?function(e){var i,r=0;for(let n of t){if(i=a(n,e),i<=0)return 0;r+=i}return r/n}:function(e){var i=0;return $(t,(t=>{i+=a(t,e)})),i/n}}getSortFunction(e,t){var n=this.prepareSearch(e,t);return this._getSortFunction(n)}_getSortFunction(e){var t,n=[];let i=this,r=e.options,s=!e.query&&r.sort_empty?r.sort_empty:r.sort;if("function"==typeof s)return s.bind(this);let o=function(t,n){return"$score"===t?n.score:e.getAttrFn(i.items[n.id],t)};if(s)for(let t of s)(e.query||"$score"!==t.field)&&n.push(t);if(e.query){t=!0;for(let e of n)if("$score"===e.field){t=!1;break}t&&n.unshift({field:"$score",direction:"desc"})}else n=n.filter((e=>"$score"!==e.field));return n.length?function(e,t){var i,r;for(let s of n)if(r=s.field,i=("desc"===s.direction?-1:1)*N(o(r,e),o(r,t)))return i;return 0}:null}prepareSearch(e,t){let n={};var i=Object.assign({},t);if(P(i,"sort"),P(i,"sort_empty"),i.fields){P(i,"fields");let e=[];i.fields.forEach((t=>{"string"==typeof t&&(t={field:t,weight:1}),e.push(t),n[t.field]="weight"in t?t.weight:1})),i.fields=e}return{options:i,query:e.toLowerCase().trim(),tokens:this.tokenize(e,i.respect_word_boundaries,n),total:0,items:[],weights:n,getAttrFn:i.nesting?E:_}}search(e,t){var n,i,r=this;i=this.prepareSearch(e,t),t=i.options,e=i.query;let s=t.score||r._getScoreFunction(i);e.length?$(r.items,((e,r)=>{n=s(e),(!1===t.filter||n>0)&&i.items.push({score:n,id:r})})):$(r.items,((e,t)=>{i.items.push({score:1,id:t})}));let o=r._getSortFunction(i);return o&&i.items.sort(o),i.total=i.items.length,"number"==typeof t.limit&&(i.items=i.items.slice(0,t.limit)),i}}let Q=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},R=e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(M(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)},M=e=>"string"==typeof e&&e.indexOf("<")>-1,B=(e,t)=>{var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!1),e.dispatchEvent(n)},D=(e,t)=>{Object.assign(e.style,t)},X=(e,...t)=>{var n=L(t);(e=U(e)).map((e=>{n.map((t=>{e.classList.add(t)}))}))},F=(e,...t)=>{var n=L(t);(e=U(e)).map((e=>{n.map((t=>{e.classList.remove(t)}))}))},L=e=>{var t=[];return Q(e,(e=>{"string"==typeof e&&(e=e.trim().split(/[\11\12\14\15\40]/)),Array.isArray(e)&&(t=t.concat(e))})),t.filter(Boolean)},U=e=>(Array.isArray(e)||(e=[e]),e),V=(e,t,n)=>{if(!n||n.contains(e))for(;e&&e.matches;){if(e.matches(t))return e;e=e.parentNode}},z=(e,t=0)=>t>0?e[e.length-1]:e[0],Z=(e,t)=>{if(!e)return-1;t=t||e.nodeName;for(var n=0;e=e.previousElementSibling;)e.matches(t)&&n++;return n},j=(e,t)=>{Q(t,((t,n)=>{null==t?e.removeAttribute(n):e.setAttribute(n,""+t)}))},q=(e,t)=>{e.parentNode&&e.parentNode.replaceChild(t,e)},G=(e,t)=>{if(null===t)return;if("string"==typeof t){if(!t.length)return;t=new RegExp(t,"i")}let n=e=>3===e.nodeType?(e=>{var n=e.data.match(t);if(n&&e.data.length>0){var i=document.createElement("span");i.className="highlight";var r=e.splitText(n.index);r.splitText(n[0].length);var s=r.cloneNode(!0);return i.appendChild(s),q(r,i),1}return 0})(e):((e=>{1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&("highlight"!==e.className||"SPAN"!==e.tagName)&&Array.from(e.childNodes).forEach((e=>{n(e)}))})(e),0);n(e)},W=typeof navigator>"u"||!/Mac/.test(navigator.userAgent)?"ctrlKey":"metaKey";var H={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,refreshThrottle:300,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(e){return e.length>0},render:{}};let Y=e=>typeof e>"u"||null===e?null:J(e),J=e=>"boolean"==typeof e?e?"1":"0":e+"",K=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),ee=(e,t)=>{var n;return function(i,r){var s=this;n&&(s.loading=Math.max(s.loading-1,0),clearTimeout(n)),n=setTimeout((function(){n=null,s.loadedSearches[i]=!0,e.call(s,i,r)}),t)}},te=(e,t,n)=>{var i,r=e.trigger,s={};for(i of(e.trigger=function(){var n=arguments[0];if(-1===t.indexOf(n))return r.apply(e,arguments);s[n]=arguments},n.apply(e,[]),e.trigger=r,t))i in s&&r.apply(e,s[i])},ne=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},ie=(e,t,n,i)=>{e.addEventListener(t,n,i)},re=(e,t)=>!(!t||!t[e])&&1===(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0),se=(e,t)=>e.getAttribute("id")||(e.setAttribute("id",t),t),oe=e=>e.replace(/[\\"']/g,"\\$&"),ae=(e,t)=>{t&&e.append(t)};function le(e,t){var n=Object.assign({},H,t),i=n.dataAttr,r=n.labelField,s=n.valueField,o=n.disabledField,a=n.optgroupField,l=n.optgroupLabelField,h=n.optgroupValueField,c=e.tagName.toLowerCase(),u=e.getAttribute("placeholder")||e.getAttribute("data-placeholder");if(!u&&!n.allowEmptyOption){let t=e.querySelector('option[value=""]');t&&(u=t.textContent)}var d={placeholder:u,options:[],optgroups:[],items:[],maxItems:null};return"select"===c?(()=>{var t,c=d.options,u={},p=1;let f=0;var m=e=>{var t=Object.assign({},e.dataset),n=i&&t[i];return"string"==typeof n&&n.length&&(t=Object.assign(t,JSON.parse(n))),t},g=(e,t)=>{var i=Y(e.value);if(null!=i&&(i||n.allowEmptyOption)){if(u.hasOwnProperty(i)){if(t){var l=u[i][a];l?Array.isArray(l)?l.push(t):u[i][a]=[l,t]:u[i][a]=t}}else{var h=m(e);h[r]=h[r]||e.textContent,h[s]=h[s]||i,h[o]=h[o]||e.disabled,h[a]=h[a]||t,h.$option=e,h.$order=h.$order||++f,u[i]=h,c.push(h)}e.selected&&d.items.push(i)}};d.maxItems=e.hasAttribute("multiple")?null:1,Q(e.children,(e=>{"optgroup"===(t=e.tagName.toLowerCase())?(e=>{var t,n;(n=m(e))[l]=n[l]||e.getAttribute("label")||"",n[h]=n[h]||p++,n[o]=n[o]||e.disabled,n.$order=n.$order||++f,d.optgroups.push(n),t=n[h],Q(e.children,(e=>{g(e,t)}))})(e):"option"===t&&g(e)}))})():(()=>{let t=e.getAttribute(i);if(t)d.options=JSON.parse(t),Q(d.options,(e=>{d.items.push(e[s])}));else{var o=e.value.trim()||"";if(!n.allowEmptyOption&&!o.length)return;let t=o.split(n.delimiter);Q(t,(e=>{let t={};t[r]=e,t[s]=e,d.options.push(t)})),d.items=t}})(),Object.assign({},H,d,t)}var he=0;class ce extends(function(e){return e.plugins={},class extends e{constructor(...e){super(...e),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(t,n){e.plugins[t]={name:t,fn:n}}initializePlugins(e){var t,n;let i=this,r=[];if(Array.isArray(e))e.forEach((e=>{"string"==typeof e?r.push(e):(i.plugins.settings[e.name]=e.options,r.push(e.name))}));else if(e)for(t in e)e.hasOwnProperty(t)&&(i.plugins.settings[t]=e[t],r.push(t));for(;n=r.shift();)i.require(n)}loadPlugin(t){var n=this,i=n.plugins,r=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');i.requested[t]=!0,i.loaded[t]=r.fn.apply(n,[n.plugins.settings[t]||{}]),i.names.push(t)}require(e){var t=this,n=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(n.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return n.loaded[e]}}}(t)){constructor(e,t){super(),this.control_input=void 0,this.wrapper=void 0,this.dropdown=void 0,this.control=void 0,this.dropdown_content=void 0,this.focus_node=void 0,this.order=0,this.settings=void 0,this.input=void 0,this.tabIndex=void 0,this.is_select_tag=void 0,this.rtl=void 0,this.inputId=void 0,this._destroy=void 0,this.sifter=void 0,this.isOpen=!1,this.isDisabled=!1,this.isReadOnly=!1,this.isRequired=void 0,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.ignoreHover=!1,this.hasOptions=!1,this.currentResults=void 0,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],this.refreshTimeout=null,he++;var n,i=R(e);if(i.tomselect)throw new Error("Tom Select already initialized on this element");i.tomselect=this,n=(window.getComputedStyle&&window.getComputedStyle(i,null)).getPropertyValue("direction");let r=le(i,t);this.settings=r,this.input=i,this.tabIndex=i.tabIndex||0,this.is_select_tag="select"===i.tagName.toLowerCase(),this.rtl=/rtl/i.test(n),this.inputId=se(i,"tomselect-"+he),this.isRequired=i.required,this.sifter=new I(this.options,{diacritics:r.diacritics}),r.mode=r.mode||(1===r.maxItems?"single":"multi"),"boolean"!=typeof r.hideSelected&&(r.hideSelected="multi"===r.mode),"boolean"!=typeof r.hidePlaceholder&&(r.hidePlaceholder="multi"!==r.mode);var s=r.createFilter;"function"!=typeof s&&("string"==typeof s&&(s=new RegExp(s)),s instanceof RegExp?r.createFilter=e=>s.test(e):r.createFilter=e=>this.settings.duplicates||!this.options[e]),this.initializePlugins(r.plugins),this.setupCallbacks(),this.setupTemplates();let o=R("<div>"),a=R("<div>"),l=this._render("dropdown"),h=R('<div role="listbox" tabindex="-1">'),c=this.input.getAttribute("class")||"",u=r.mode;var d;if(X(o,r.wrapperClass,c,u),X(a,r.controlClass),ae(o,a),X(l,r.dropdownClass,u),r.copyClassesToDropdown&&X(l,c),X(h,r.dropdownContentClass),ae(l,h),R(r.dropdownParent||o).appendChild(l),M(r.controlInput)){d=R(r.controlInput);$(["autocorrect","autocapitalize","autocomplete","spellcheck"],(e=>{i.getAttribute(e)&&j(d,{[e]:i.getAttribute(e)})})),d.tabIndex=-1,a.appendChild(d),this.focus_node=d}else r.controlInput?(d=R(r.controlInput),this.focus_node=d):(d=R("<input/>"),this.focus_node=a);this.wrapper=o,this.dropdown=l,this.dropdown_content=h,this.control=a,this.control_input=d,this.setup()}setup(){let e=this,t=e.settings,n=e.control_input,i=e.dropdown,r=e.dropdown_content,s=e.wrapper,o=e.control,a=e.input,h=e.focus_node,c={passive:!0},u=e.inputId+"-ts-dropdown";j(r,{id:u}),j(h,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":u});let d=se(h,e.inputId+"-ts-control"),p="label[for='"+(e=>e.replace(/['"\\]/g,"\\$&"))(e.inputId)+"']",f=document.querySelector(p),m=e.focus.bind(e);if(f){ie(f,"click",m),j(f,{for:d});let t=se(f,e.inputId+"-ts-label");j(h,{"aria-labelledby":t}),j(r,{"aria-labelledby":t})}if(s.style.width=a.style.width,e.plugins.names.length){let t="plugin-"+e.plugins.names.join(" plugin-");X([s,i],t)}(null===t.maxItems||t.maxItems>1)&&e.is_select_tag&&j(a,{multiple:"multiple"}),t.placeholder&&j(n,{placeholder:t.placeholder}),!t.splitOn&&t.delimiter&&(t.splitOn=new RegExp("\\s*"+l(t.delimiter)+"+\\s*")),t.load&&t.loadThrottle&&(t.load=ee(t.load,t.loadThrottle)),ie(i,"mousemove",(()=>{e.ignoreHover=!1})),ie(i,"mouseenter",(t=>{var n=V(t.target,"[data-selectable]",i);n&&e.onOptionHover(t,n)}),{capture:!0}),ie(i,"click",(t=>{let n=V(t.target,"[data-selectable]");n&&(e.onOptionSelect(t,n),ne(t,!0))})),ie(o,"click",(t=>{var i=V(t.target,"[data-ts-item]",o);i&&e.onItemSelect(t,i)?ne(t,!0):""==n.value&&(e.onClick(),ne(t,!0))})),ie(h,"keydown",(t=>e.onKeyDown(t))),ie(n,"keypress",(t=>e.onKeyPress(t))),ie(n,"input",(t=>e.onInput(t))),ie(h,"blur",(t=>e.onBlur(t))),ie(h,"focus",(t=>e.onFocus(t))),ie(n,"paste",(t=>e.onPaste(t)));let g=t=>{let r=t.composedPath()[0];if(!s.contains(r)&&!i.contains(r))return e.isFocused&&e.blur(),void e.inputState();r==n&&e.isOpen?t.stopPropagation():ne(t,!0)},O=()=>{e.isOpen&&e.positionDropdown()};ie(document,"mousedown",g),ie(window,"scroll",O,c),ie(window,"resize",O,c),this._destroy=()=>{document.removeEventListener("mousedown",g),window.removeEventListener("scroll",O),window.removeEventListener("resize",O),f&&f.removeEventListener("click",m)},this.revertSettings={innerHTML:a.innerHTML,tabIndex:a.tabIndex},a.tabIndex=-1,a.insertAdjacentElement("afterend",e.wrapper),e.sync(!1),t.items=[],delete t.optgroups,delete t.options,ie(a,"invalid",(()=>{e.isValid&&(e.isValid=!1,e.isInvalid=!0,e.refreshState())})),e.updateOriginalInput(),e.refreshItems(),e.close(!1),e.inputState(),e.isSetup=!0,a.disabled?e.disable():a.readOnly?e.setReadOnly(!0):e.enable(),e.on("change",this.onChange),X(a,"tomselected","ts-hidden-accessible"),e.trigger("initialize"),!0===t.preload&&e.preload()}setupOptions(e=[],t=[]){this.addOptions(e),$(t,(e=>{this.registerOptionGroup(e)}))}setupTemplates(){var e=this,t=e.settings.labelField,n=e.settings.optgroupLabelField,i={optgroup:e=>{let t=document.createElement("div");return t.className="optgroup",t.appendChild(e.options),t},optgroup_header:(e,t)=>'<div class="optgroup-header">'+t(e[n])+"</div>",option:(e,n)=>"<div>"+n(e[t])+"</div>",item:(e,n)=>"<div>"+n(e[t])+"</div>",option_create:(e,t)=>'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};e.settings.render=Object.assign({},i,e.settings.render)}setupCallbacks(){var e,t,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in n)(t=this.settings[n[e]])&&this.on(e,t)}sync(e=!0){let t=this,n=e?le(t.input,{delimiter:t.settings.delimiter}):t.settings;t.setupOptions(n.options,n.optgroups),t.setValue(n.items||[],!0),t.lastQuery=null}onClick(){var e=this;if(e.activeItems.length>0)return e.clearActiveItems(),void e.focus();e.isFocused&&e.isOpen?e.blur():e.focus()}onMouseDown(){}onChange(){B(this.input,"input"),B(this.input,"change")}onPaste(e){var t=this;t.isInputHidden||t.isLocked?ne(e):t.settings.splitOn&&setTimeout((()=>{var e=t.inputValue();if(e.match(t.settings.splitOn)){var n=e.trim().split(t.settings.splitOn);$(n,(e=>{Y(e)&&(this.options[e]?t.addItem(e):t.createItem(e))}))}}),0)}onKeyPress(e){var t=this;if(!t.isLocked){var n=String.fromCharCode(e.keyCode||e.which);return t.settings.create&&"multi"===t.settings.mode&&n===t.settings.delimiter?(t.createItem(),void ne(e)):void 0}ne(e)}onKeyDown(e){var t=this;if(t.ignoreHover=!0,t.isLocked)9!==e.keyCode&&ne(e);else{switch(e.keyCode){case 65:if(re(W,e)&&""==t.control_input.value)return ne(e),void t.selectAll();break;case 27:return t.isOpen&&(ne(e,!0),t.close()),void t.clearActiveItems();case 40:if(!t.isOpen&&t.hasOptions)t.open();else if(t.activeOption){let e=t.getAdjacent(t.activeOption,1);e&&t.setActiveOption(e)}return void ne(e);case 38:if(t.activeOption){let e=t.getAdjacent(t.activeOption,-1);e&&t.setActiveOption(e)}return void ne(e);case 13:return void(t.canSelect(t.activeOption)?(t.onOptionSelect(e,t.activeOption),ne(e)):(t.settings.create&&t.createItem()||document.activeElement==t.control_input&&t.isOpen)&&ne(e));case 37:return void t.advanceSelection(-1,e);case 39:return void t.advanceSelection(1,e);case 9:return void(t.settings.selectOnTab&&(t.canSelect(t.activeOption)&&(t.onOptionSelect(e,t.activeOption),ne(e)),t.settings.create&&t.createItem()&&ne(e)));case 8:case 46:return void t.deleteSelection(e)}t.isInputHidden&&!re(W,e)&&ne(e)}}onInput(e){if(this.isLocked)return;let t=this.inputValue();if(this.lastValue!==t){if(this.lastValue=t,""==t)return void this._onInput();this.refreshTimeout&&clearTimeout(this.refreshTimeout),this.refreshTimeout=((e,t)=>t>0?setTimeout(e,t):(e.call(null),null))((()=>{this.refreshTimeout=null,this._onInput()}),this.settings.refreshThrottle)}}_onInput(){let e=this.lastValue;this.settings.shouldLoad.call(this,e)&&this.load(e),this.refreshOptions(),this.trigger("type",e)}onOptionHover(e,t){this.ignoreHover||this.setActiveOption(t,!1)}onFocus(e){var t=this,n=t.isFocused;if(t.isDisabled||t.isReadOnly)return t.blur(),void ne(e);t.ignoreFocus||(t.isFocused=!0,"focus"===t.settings.preload&&t.preload(),n||t.trigger("focus"),t.activeItems.length||(t.inputState(),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState())}onBlur(e){if(!1!==document.hasFocus()){var t=this;if(t.isFocused){t.isFocused=!1,t.ignoreFocus=!1;var n=()=>{t.close(),t.setActiveItem(),t.setCaret(t.items.length),t.trigger("blur")};t.settings.create&&t.settings.createOnBlur?t.createItem(null,n):n()}}}onOptionSelect(e,t){var n,i=this;t.parentElement&&t.parentElement.matches("[data-disabled]")||(t.classList.contains("create")?i.createItem(null,(()=>{i.settings.closeAfterSelect&&i.close()})):typeof(n=t.dataset.value)<"u"&&(i.lastQuery=null,i.addItem(n),i.settings.closeAfterSelect&&i.close(),!i.settings.hideSelected&&e.type&&/click/.test(e.type)&&i.setActiveOption(t)))}canSelect(e){return!!(this.isOpen&&e&&this.dropdown_content.contains(e))}onItemSelect(e,t){var n=this;return!n.isLocked&&"multi"===n.settings.mode&&(ne(e),n.setActiveItem(t,e),!0)}canLoad(e){return!(!this.settings.load||this.loadedSearches.hasOwnProperty(e))}load(e){let t=this;if(!t.canLoad(e))return;X(t.wrapper,t.settings.loadingClass),t.loading++;let n=t.loadCallback.bind(t);t.settings.load.call(t,e,n)}loadCallback(e,t){let n=this;n.loading=Math.max(n.loading-1,0),n.lastQuery=null,n.clearActiveOption(),n.setupOptions(e,t),n.refreshOptions(n.isFocused&&!n.isInputHidden),n.loading||F(n.wrapper,n.settings.loadingClass),n.trigger("load",e,t)}preload(){var e=this.wrapper.classList;e.contains("preloaded")||(e.add("preloaded"),this.load(""))}setTextboxValue(e=""){var t=this.control_input;t.value!==e&&(t.value=e,B(t,"update"),this.lastValue=e)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,t){te(this,t?[]:["change"],(()=>{this.clear(t),this.addItems(e,t)}))}setMaxItems(e){0===e&&(e=null),this.settings.maxItems=e,this.refreshState()}setActiveItem(e,t){var n,i,r,s,o,a,l=this;if("single"!==l.settings.mode){if(!e)return l.clearActiveItems(),void(l.isFocused&&l.inputState());if("click"===(n=t&&t.type.toLowerCase())&&re("shiftKey",t)&&l.activeItems.length){for(a=l.getLastActive(),(r=Array.prototype.indexOf.call(l.control.children,a))>(s=Array.prototype.indexOf.call(l.control.children,e))&&(o=r,r=s,s=o),i=r;i<=s;i++)e=l.control.children[i],-1===l.activeItems.indexOf(e)&&l.setActiveItemClass(e);ne(t)}else"click"===n&&re(W,t)||"keydown"===n&&re("shiftKey",t)?e.classList.contains("active")?l.removeActiveItem(e):l.setActiveItemClass(e):(l.clearActiveItems(),l.setActiveItemClass(e));l.inputState(),l.isFocused||l.focus()}}setActiveItemClass(e){let t=this,n=t.control.querySelector(".last-active");n&&F(n,"last-active"),X(e,"active last-active"),t.trigger("item_select",e),-1==t.activeItems.indexOf(e)&&t.activeItems.push(e)}removeActiveItem(e){var t=this.activeItems.indexOf(e);this.activeItems.splice(t,1),F(e,"active")}clearActiveItems(){F(this.activeItems,"active"),this.activeItems=[]}setActiveOption(e,t=!0){e!==this.activeOption&&(this.clearActiveOption(),e&&(this.activeOption=e,j(this.focus_node,{"aria-activedescendant":e.getAttribute("id")}),j(e,{"aria-selected":"true"}),X(e,"active"),t&&this.scrollToOption(e)))}scrollToOption(e,t){if(!e)return;let n=this.dropdown_content,i=n.clientHeight,r=n.scrollTop||0,s=e.offsetHeight,o=e.getBoundingClientRect().top-n.getBoundingClientRect().top+r;o+s>i+r?this.scroll(o-i+s,t):o<r&&this.scroll(o,t)}scroll(e,t){let n=this.dropdown_content;t&&(n.style.scrollBehavior=t),n.scrollTop=e,n.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(F(this.activeOption,"active"),j(this.activeOption,{"aria-selected":null})),this.activeOption=null,j(this.focus_node,{"aria-activedescendant":null})}selectAll(){let e=this;if("single"===e.settings.mode)return;let t=e.controlChildren();t.length&&(e.inputState(),e.close(),e.activeItems=t,$(t,(t=>{e.setActiveItemClass(t)})))}inputState(){var e=this;e.control.contains(e.control_input)&&(j(e.control_input,{placeholder:e.settings.placeholder}),e.activeItems.length>0||!e.isFocused&&e.settings.hidePlaceholder&&e.items.length>0?(e.setTextboxValue(),e.isInputHidden=!0):(e.settings.hidePlaceholder&&e.items.length>0&&j(e.control_input,{placeholder:""}),e.isInputHidden=!1),e.wrapper.classList.toggle("input-hidden",e.isInputHidden))}inputValue(){return this.control_input.value.trim()}focus(){var e=this;e.isDisabled||e.isReadOnly||(e.ignoreFocus=!0,e.control_input.offsetWidth?e.control_input.focus():e.focus_node.focus(),setTimeout((()=>{e.ignoreFocus=!1,e.onFocus()}),0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings,t=e.sortField;return"string"==typeof e.sortField&&(t=[{field:e.sortField}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}search(e){var t,n,i=this,r=this.getSearchOptions();if(i.settings.score&&"function"!=typeof(n=i.settings.score.call(i,e)))throw new Error('Tom Select "score" setting must be a function that returns a function');return e!==i.lastQuery?(i.lastQuery=e,t=i.sifter.search(e,Object.assign(r,{score:n})),i.currentResults=t):t=Object.assign({},i.currentResults),i.settings.hideSelected&&(t.items=t.items.filter((e=>{let t=Y(e.id);return!(t&&-1!==i.items.indexOf(t))}))),t}refreshOptions(e=!0){var t,n,i,r,s,o,a,l,h,c;let u={},d=[];var p=this,f=p.inputValue();let m=f===p.lastQuery||""==f&&null==p.lastQuery;var g=p.search(f),O=null,y=p.settings.shouldOpen||!1,v=p.dropdown_content;m&&((O=p.activeOption)&&(h=O.closest("[data-group]"))),r=g.items.length,"number"==typeof p.settings.maxOptions&&(r=Math.min(r,p.settings.maxOptions)),r>0&&(y=!0);let b=(e,t)=>{let n=u[e];if(void 0!==n){let e=d[n];if(void 0!==e)return[n,e.fragment]}let i=document.createDocumentFragment();return n=d.length,d.push({fragment:i,order:t,optgroup:e}),[n,i]};for(t=0;t<r;t++){let e=g.items[t];if(!e)continue;let r=e.id,a=p.options[r];if(void 0===a)continue;let l=J(r),c=p.getOption(l,!0);for(p.settings.hideSelected||c.classList.toggle("selected",p.items.includes(l)),s=a[p.settings.optgroupField]||"",n=0,i=(o=Array.isArray(s)?s:[s])&&o.length;n<i;n++){s=o[n];let e=a.$order,t=p.optgroups[s];void 0===t?s="":e=t.$order;let[i,l]=b(s,e);n>0&&(c=c.cloneNode(!0),j(c,{id:a.$id+"-clone-"+n,"aria-selected":null}),c.classList.add("ts-cloned"),F(c,"active"),p.activeOption&&p.activeOption.dataset.value==r&&h&&h.dataset.group===s.toString()&&(O=c)),l.appendChild(c),""!=s&&(u[s]=i)}}p.settings.lockOptgroupOrder&&d.sort(((e,t)=>e.order-t.order)),a=document.createDocumentFragment(),$(d,(e=>{let t=e.fragment,n=e.optgroup;if(!t||!t.children.length)return;let i=p.optgroups[n];if(void 0!==i){let e=document.createDocumentFragment(),n=p.render("optgroup_header",i);ae(e,n),ae(e,t);let r=p.render("optgroup",{group:i,options:e});ae(a,r)}else ae(a,t)})),v.innerHTML="",ae(v,a),p.settings.highlight&&((e=>{var t=e.querySelectorAll("span.highlight");Array.prototype.forEach.call(t,(function(e){var t=e.parentNode;t.replaceChild(e.firstChild,e),t.normalize()}))})(v),g.query.length&&g.tokens.length&&$(g.tokens,(e=>{G(v,e.regex)})));var w=e=>{let t=p.render(e,{input:f});return t&&(y=!0,v.insertBefore(t,v.firstChild)),t};if(p.loading?w("loading"):p.settings.shouldLoad.call(p,f)?0===g.items.length&&w("no_results"):w("not_loading"),(l=p.canCreate(f))&&(c=w("option_create")),p.hasOptions=g.items.length>0||l,y){if(g.items.length>0){if(!O&&"single"===p.settings.mode&&null!=p.items[0]&&(O=p.getOption(p.items[0])),!v.contains(O)){let e=0;c&&!p.settings.addPrecedence&&(e=1),O=p.selectable()[e]}}else c&&(O=c);e&&!p.isOpen&&(p.open(),p.scrollToOption(O,"auto")),p.setActiveOption(O)}else p.clearActiveOption(),e&&p.isOpen&&p.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e,t=!1){let n=this;if(Array.isArray(e))return n.addOptions(e,t),!1;let i=Y(e[n.settings.valueField]);return null!==i&&!n.options.hasOwnProperty(i)&&(e.$order=e.$order||++n.order,e.$id=n.inputId+"-opt-"+e.$order,n.options[i]=e,n.lastQuery=null,t&&(n.userOptions[i]=t,n.trigger("option_add",i,e)),i)}addOptions(e,t=!1){$(e,(e=>{this.addOption(e,t)}))}registerOption(e){return this.addOption(e)}registerOptionGroup(e){var t=Y(e[this.settings.optgroupValueField]);return null!==t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)}addOptionGroup(e,t){var n;t[this.settings.optgroupValueField]=e,(n=this.registerOptionGroup(t))&&this.trigger("optgroup_add",n,t)}removeOptionGroup(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.clearCache(),this.trigger("optgroup_remove",e))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(e,t){let n=this;var i,r;let s=Y(e),o=Y(t[n.settings.valueField]);if(null===s)return;let a=n.options[s];if(null==a)return;if("string"!=typeof o)throw new Error("Value must be set in option data");let l=n.getOption(s),h=n.getItem(s);if(t.$order=t.$order||a.$order,delete n.options[s],n.uncacheValue(o),n.options[o]=t,l){if(n.dropdown_content.contains(l)){let e=n._render("option",t);q(l,e),n.activeOption===l&&n.setActiveOption(e)}l.remove()}h&&(-1!==(r=n.items.indexOf(s))&&n.items.splice(r,1,o),i=n._render("item",t),h.classList.contains("active")&&X(i,"active"),q(h,i)),n.lastQuery=null}removeOption(e,t){let n=this;e=J(e),n.uncacheValue(e),delete n.userOptions[e],delete n.options[e],n.lastQuery=null,n.trigger("option_remove",e),n.removeItem(e,t)}clearOptions(e){let t=(e||this.clearFilter).bind(this);this.loadedSearches={},this.userOptions={},this.clearCache();let n={};$(this.options,((e,i)=>{t(e,i)&&(n[i]=e)})),this.options=this.sifter.items=n,this.lastQuery=null,this.trigger("option_clear")}clearFilter(e,t){return this.items.indexOf(t)>=0}getOption(e,t=!1){let n=Y(e);if(null===n)return null;let i=this.options[n];if(null!=i){if(i.$div)return i.$div;if(t)return this._render("option",i)}return null}getAdjacent(e,t,n="option"){var i;if(!e)return null;i="item"==n?this.controlChildren():this.dropdown_content.querySelectorAll("[data-selectable]");for(let n=0;n<i.length;n++)if(i[n]==e)return t>0?i[n+1]:i[n-1];return null}getItem(e){if("object"==typeof e)return e;var t=Y(e);return null!==t?this.control.querySelector(`[data-value="${oe(t)}"]`):null}addItems(e,t){var n=this,i=Array.isArray(e)?e:[e];i=i.filter((e=>-1===n.items.indexOf(e)));let r=i[i.length-1];i.forEach((e=>{n.isPending=e!==r,n.addItem(e,t)}))}addItem(e,t){te(this,t?[]:["change","dropdown_close"],(()=>{var n,i;let r=this,s=r.settings.mode,o=Y(e);if((!o||-1===r.items.indexOf(o)||("single"===s&&r.close(),"single"!==s&&r.settings.duplicates))&&null!==o&&r.options.hasOwnProperty(o)&&("single"===s&&r.clear(t),"multi"!==s||!r.isFull())){if(n=r._render("item",r.options[o]),r.control.contains(n)&&(n=n.cloneNode(!0)),i=r.isFull(),r.items.splice(r.caretPos,0,o),r.insertAtCaret(n),r.isSetup){if(!r.isPending&&r.settings.hideSelected){let e=r.getOption(o),t=r.getAdjacent(e,1);t&&r.setActiveOption(t)}!r.isPending&&!r.settings.closeAfterSelect&&r.refreshOptions(r.isFocused&&"single"!==s),0!=r.settings.closeAfterSelect&&r.isFull()?r.close():r.isPending||r.positionDropdown(),r.trigger("item_add",o,n),r.isPending||r.updateOriginalInput({silent:t})}(!r.isPending||!i&&r.isFull())&&(r.inputState(),r.refreshState())}}))}removeItem(e=null,t){let n=this;if(!(e=n.getItem(e)))return;var i,r;let s=e.dataset.value;i=Z(e),e.remove(),e.classList.contains("active")&&(r=n.activeItems.indexOf(e),n.activeItems.splice(r,1),F(e,"active")),n.items.splice(i,1),n.lastQuery=null,!n.settings.persist&&n.userOptions.hasOwnProperty(s)&&n.removeOption(s,t),i<n.caretPos&&n.setCaret(n.caretPos-1),n.updateOriginalInput({silent:t}),n.refreshState(),n.positionDropdown(),n.trigger("item_remove",s,e)}createItem(e=null,t=(()=>{})){3===arguments.length&&(t=arguments[2]),"function"!=typeof t&&(t=()=>{});var n,i=this,r=i.caretPos;if(e=e||i.inputValue(),!i.canCreate(e))return t(),!1;i.lock();var s=!1,o=e=>{if(i.unlock(),!e||"object"!=typeof e)return t();var n=Y(e[i.settings.valueField]);if("string"!=typeof n)return t();i.setTextboxValue(),i.addOption(e,!0),i.setCaret(r),i.addItem(n),t(e),s=!0};return n="function"==typeof i.settings.create?i.settings.create.call(this,e,o):{[i.settings.labelField]:e,[i.settings.valueField]:e},s||o(n),!0}refreshItems(){var e=this;e.lastQuery=null,e.isSetup&&e.addItems(e.items),e.updateOriginalInput(),e.refreshState()}refreshState(){let e=this;e.refreshValidityState();let t=e.isFull(),n=e.isLocked;e.wrapper.classList.toggle("rtl",e.rtl);let i=e.wrapper.classList;i.toggle("focus",e.isFocused),i.toggle("disabled",e.isDisabled),i.toggle("readonly",e.isReadOnly),i.toggle("required",e.isRequired),i.toggle("invalid",!e.isValid),i.toggle("locked",n),i.toggle("full",t),i.toggle("input-active",e.isFocused&&!e.isInputHidden),i.toggle("dropdown-active",e.isOpen),i.toggle("has-options",(e=>0===Object.keys(e).length)(e.options)),i.toggle("has-items",e.items.length>0)}refreshValidityState(){var e=this;e.input.validity&&(e.isValid=e.input.validity.valid,e.isInvalid=!e.isValid)}isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){let t=this;var n,i;let r=t.input.querySelector('option[value=""]');if(t.is_select_tag){let e=function(e,n,i){return e||(e=R('<option value="'+K(n)+'">'+K(i)+"</option>")),e!=r&&t.input.append(e),s.push(e),(e!=r||o>0)&&(e.selected=!0),e},s=[],o=t.input.querySelectorAll("option:checked").length;t.input.querySelectorAll("option:checked").forEach((e=>{e.selected=!1})),0==t.items.length&&"single"==t.settings.mode?e(r,"",""):t.items.forEach((r=>{if(n=t.options[r],i=n[t.settings.labelField]||"",s.includes(n.$option)){let n=t.input.querySelector(`option[value="${oe(r)}"]:not(:checked)`);e(n,r,i)}else n.$option=e(n.$option,r,i)}))}else t.input.value=t.getValue();t.isSetup&&(e.silent||t.trigger("change",t.getValue()))}open(){var e=this;e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull()||(e.isOpen=!0,j(e.focus_node,{"aria-expanded":"true"}),e.refreshState(),D(e.dropdown,{visibility:"hidden",display:"block"}),e.positionDropdown(),D(e.dropdown,{visibility:"visible",display:"block"}),e.focus(),e.trigger("dropdown_open",e.dropdown))}close(e=!0){var t=this,n=t.isOpen;e&&(t.setTextboxValue(),"single"===t.settings.mode&&t.items.length&&t.inputState()),t.isOpen=!1,j(t.focus_node,{"aria-expanded":"false"}),D(t.dropdown,{display:"none"}),t.settings.hideSelected&&t.clearActiveOption(),t.refreshState(),n&&t.trigger("dropdown_close",t.dropdown)}positionDropdown(){if("body"===this.settings.dropdownParent){var e=this.control,t=e.getBoundingClientRect(),n=e.offsetHeight+t.top+window.scrollY,i=t.left+window.scrollX;D(this.dropdown,{width:t.width+"px",top:n+"px",left:i+"px"})}}clear(e){var t=this;if(t.items.length){var n=t.controlChildren();$(n,(e=>{t.removeItem(e,!0)})),t.inputState(),e||t.updateOriginalInput(),t.trigger("clear")}}insertAtCaret(e){let t=this,n=t.caretPos,i=t.control;i.insertBefore(e,i.children[n]||null),t.setCaret(n+1)}deleteSelection(e){var t,n,i,r,s=this;t=e&&8===e.keyCode?-1:1,n=(e=>({start:e.selectionStart||0,length:(e.selectionEnd||0)-(e.selectionStart||0)}))(s.control_input);let o=[];if(s.activeItems.length)r=z(s.activeItems,t),i=Z(r),t>0&&i++,$(s.activeItems,(e=>o.push(e)));else if((s.isFocused||"single"===s.settings.mode)&&s.items.length){let e,i=s.controlChildren();t<0&&0===n.start&&0===n.length?e=i[s.caretPos-1]:t>0&&n.start===s.inputValue().length&&(e=i[s.caretPos]),void 0!==e&&o.push(e)}if(!s.shouldDelete(o,e))return!1;for(ne(e,!0),typeof i<"u"&&s.setCaret(i);o.length;)s.removeItem(o.pop());return s.inputState(),s.positionDropdown(),s.refreshOptions(!1),!0}shouldDelete(e,t){let n=e.map((e=>e.dataset.value));return!(!n.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete(n,t))}advanceSelection(e,t){var n,i,r=this;r.rtl&&(e*=-1),!r.inputValue().length&&(re(W,t)||re("shiftKey",t)?(i=(n=r.getLastActive(e))?n.classList.contains("active")?r.getAdjacent(n,e,"item"):n:e>0?r.control_input.nextElementSibling:r.control_input.previousElementSibling)&&(i.classList.contains("active")&&r.removeActiveItem(n),r.setActiveItemClass(i)):r.moveCaret(e))}moveCaret(e){}getLastActive(e){let t=this.control.querySelector(".last-active");if(t)return t;var n=this.control.querySelectorAll(".active");return n?z(n,e):void 0}setCaret(e){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.setLocked(!0)}unlock(){this.setLocked(!1)}setLocked(e=this.isReadOnly||this.isDisabled){this.isLocked=e,this.refreshState()}disable(){this.setDisabled(!0),this.close()}enable(){this.setDisabled(!1)}setDisabled(e){this.focus_node.tabIndex=e?-1:this.tabIndex,this.isDisabled=e,this.input.disabled=e,this.control_input.disabled=e,this.setLocked()}setReadOnly(e){this.isReadOnly=e,this.input.readOnly=e,this.control_input.readOnly=e,this.setLocked()}destroy(){var e=this,t=e.revertSettings;e.trigger("destroy"),e.off(),e.wrapper.remove(),e.dropdown.remove(),e.input.innerHTML=t.innerHTML,e.input.tabIndex=t.tabIndex,F(e.input,"tomselected","ts-hidden-accessible"),e._destroy(),delete e.input.tomselect}render(e,t){var n,i;let r=this;if("function"!=typeof this.settings.render[e]||!(i=r.settings.render[e].call(this,t,K)))return null;if(i=R(i),"option"===e||"option_create"===e?t[r.settings.disabledField]?j(i,{"aria-disabled":"true"}):j(i,{"data-selectable":""}):"optgroup"===e&&(n=t.group[r.settings.optgroupValueField],j(i,{"data-group":n}),t.group[r.settings.disabledField]&&j(i,{"data-disabled":""})),"option"===e||"item"===e){let n=J(t[r.settings.valueField]);j(i,{"data-value":n}),"item"===e?(X(i,r.settings.itemClass),j(i,{"data-ts-item":""})):(X(i,r.settings.optionClass),j(i,{role:"option",id:t.$id}),t.$div=i,r.options[n]=t)}return i}_render(e,t){let n=this.render(e,t);if(null==n)throw"HTMLElement expected";return n}clearCache(){$(this.options,(e=>{e.$div&&(e.$div.remove(),delete e.$div)}))}uncacheValue(e){let t=this.getOption(e);t&&t.remove()}canCreate(e){return this.settings.create&&e.length>0&&this.settings.createFilter.call(this,e)}hook(e,t,n){var i=this,r=i[t];i[t]=function(){var t,s;return"after"===e&&(t=r.apply(i,arguments)),s=n.apply(i,arguments),"instead"===e?s:("before"===e&&(t=r.apply(i,arguments)),t)}}}return ce.define("change_listener",(function(){ie(this.input,"change",(()=>{this.sync()}))})),ce.define("checkbox_options",(function(e){var t=this,n=t.onOptionSelect;t.settings.hideSelected=!1;let i=Object.assign({className:"tomselect-checkbox",checkedClassNames:void 0,uncheckedClassNames:void 0},e);var r=function(e,t){t?(e.checked=!0,i.uncheckedClassNames&&e.classList.remove(...i.uncheckedClassNames),i.checkedClassNames&&e.classList.add(...i.checkedClassNames)):(e.checked=!1,i.checkedClassNames&&e.classList.remove(...i.checkedClassNames),i.uncheckedClassNames&&e.classList.add(...i.uncheckedClassNames))},s=function(e){setTimeout((()=>{var t=e.querySelector("input."+i.className);t instanceof HTMLInputElement&&r(t,e.classList.contains("selected"))}),1)};t.hook("after","setupTemplates",(()=>{var e=t.settings.render.option;t.settings.render.option=(n,s)=>{var o=R(e.call(t,n,s)),a=document.createElement("input");i.className&&a.classList.add(i.className),a.addEventListener("click",(function(e){ne(e)})),a.type="checkbox";let l=Y(n[t.settings.valueField]);return r(a,!!(l&&t.items.indexOf(l)>-1)),o.prepend(a),o}})),t.on("item_remove",(e=>{var n=t.getOption(e);n&&(n.classList.remove("selected"),s(n))})),t.on("item_add",(e=>{var n=t.getOption(e);n&&s(n)})),t.hook("instead","onOptionSelect",((e,i)=>{if(i.classList.contains("selected"))return i.classList.remove("selected"),t.removeItem(i.dataset.value),t.refreshOptions(),void ne(e,!0);n.call(t,e,i),s(i)}))})),ce.define("clear_button",(function(e){let t=this,n=Object.assign({className:"clear-button",title:"Clear All",html:e=>`<div class="${e.className}" title="${e.title}">&#10799;</div>`},e);t.on("initialize",(()=>{var e=R(n.html(n));e.addEventListener("click",(e=>{t.isLocked||(t.clear(),"single"===t.settings.mode&&t.settings.allowEmptyOption&&t.addItem(""),e.preventDefault(),e.stopPropagation())})),t.control.appendChild(e)}))})),ce.define("drag_drop",(function(){var e=this;if("multi"!==e.settings.mode)return;var t=e.lock,n=e.unlock;let i,r=!0;e.hook("after","setupTemplates",(()=>{var t=e.settings.render.item;e.settings.render.item=(n,s)=>{let o=R(t.call(e,n,s));j(o,{draggable:"true"});let a=e=>{e.preventDefault(),o.classList.add("ts-drag-over"),l(o,i)},l=(e,t)=>{void 0!==t&&(((e,t)=>{do{var n;if(e==(t=null==(n=t)?void 0:n.previousElementSibling))return!0}while(t&&t.previousElementSibling);return!1})(t,o)?((e,t)=>{var n;null==(n=e.parentNode)||n.insertBefore(t,e.nextSibling)})(e,t):((e,t)=>{var n;null==(n=e.parentNode)||n.insertBefore(t,e)})(e,t))};return ie(o,"mousedown",(e=>{r||ne(e),e.stopPropagation()})),ie(o,"dragstart",(e=>{i=o,setTimeout((()=>{o.classList.add("ts-dragging")}),0)})),ie(o,"dragenter",a),ie(o,"dragover",a),ie(o,"dragleave",(()=>{o.classList.remove("ts-drag-over")})),ie(o,"dragend",(()=>{var t;document.querySelectorAll(".ts-drag-over").forEach((e=>e.classList.remove("ts-drag-over"))),null==(t=i)||t.classList.remove("ts-dragging"),i=void 0;var n=[];e.control.querySelectorAll("[data-value]").forEach((e=>{if(e.dataset.value){let t=e.dataset.value;t&&n.push(t)}})),e.setValue(n)})),o}})),e.hook("instead","lock",(()=>(r=!1,t.call(e)))),e.hook("instead","unlock",(()=>(r=!0,n.call(e))))})),ce.define("dropdown_header",(function(e){let t=this,n=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:e=>'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a class="'+e.closeClass+'">&times;</a></div></div>'},e);t.on("initialize",(()=>{var e=R(n.html(n)),i=e.querySelector("."+n.closeClass);i&&i.addEventListener("click",(e=>{ne(e,!0),t.close()})),t.dropdown.insertBefore(e,t.dropdown.firstChild)}))})),ce.define("caret_position",(function(){var e=this;e.hook("instead","setCaret",(t=>{"single"!==e.settings.mode&&e.control.contains(e.control_input)?(t=Math.max(0,Math.min(e.items.length,t)))!=e.caretPos&&!e.isPending&&e.controlChildren().forEach(((n,i)=>{i<t?e.control_input.insertAdjacentElement("beforebegin",n):e.control.appendChild(n)})):t=e.items.length,e.caretPos=t})),e.hook("instead","moveCaret",(t=>{if(!e.isFocused)return;let n=e.getLastActive(t);if(n){let i=Z(n);e.setCaret(t>0?i+1:i),e.setActiveItem(),F(n,"last-active")}else e.setCaret(e.caretPos+t)}))})),ce.define("dropdown_input",(function(){let e=this;e.settings.shouldOpen=!0,e.hook("before","setup",(()=>{e.focus_node=e.control,X(e.control_input,"dropdown-input");let t=R('<div class="dropdown-input-wrap">');t.append(e.control_input),e.dropdown.insertBefore(t,e.dropdown.firstChild);let n=R('<input class="items-placeholder" tabindex="-1" />');n.placeholder=e.settings.placeholder||"",e.control.append(n)})),e.on("initialize",(()=>{e.control_input.addEventListener("keydown",(t=>{switch(t.keyCode){case 27:return e.isOpen&&(ne(t,!0),e.close()),void e.clearActiveItems();case 9:e.focus_node.tabIndex=-1}return e.onKeyDown.call(e,t)})),e.on("blur",(()=>{e.focus_node.tabIndex=e.isDisabled?-1:e.tabIndex})),e.on("dropdown_open",(()=>{e.control_input.focus()}));let t=e.onBlur;e.hook("instead","onBlur",(n=>{if(!n||n.relatedTarget!=e.control_input)return t.call(e)})),ie(e.control_input,"blur",(()=>e.onBlur())),e.hook("before","close",(()=>{e.isOpen&&e.focus_node.focus({preventScroll:!0})}))}))})),ce.define("input_autogrow",(function(){var e=this;e.on("initialize",(()=>{var t=document.createElement("span"),n=e.control_input;t.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ",e.wrapper.appendChild(t);for(let e of["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"])t.style[e]=n.style[e];var i=()=>{t.textContent=n.value,n.style.width=t.clientWidth+"px"};i(),e.on("update item_add item_remove",i),ie(n,"input",i),ie(n,"keyup",i),ie(n,"blur",i),ie(n,"update",i)}))})),ce.define("no_backspace_delete",(function(){var e=this,t=e.deleteSelection;this.hook("instead","deleteSelection",(n=>!!e.activeItems.length&&t.call(e,n)))})),ce.define("no_active_items",(function(){this.hook("instead","setActiveItem",(()=>{})),this.hook("instead","selectAll",(()=>{}))})),ce.define("optgroup_columns",(function(){var e=this,t=e.onKeyDown;e.hook("instead","onKeyDown",(n=>{var i,r,s,o;if(!e.isOpen||37!==n.keyCode&&39!==n.keyCode)return t.call(e,n);e.ignoreHover=!0,o=V(e.activeOption,"[data-group]"),i=Z(e.activeOption,"[data-selectable]"),o&&((o=37===n.keyCode?o.previousSibling:o.nextSibling)&&((r=(s=o.querySelectorAll("[data-selectable]"))[Math.min(s.length-1,i)])&&e.setActiveOption(r)))}))})),ce.define("remove_button",(function(e){let t=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},e);var n=this;if(t.append){var i='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+K(t.title)+'">'+t.label+"</a>";n.hook("after","setupTemplates",(()=>{var e=n.settings.render.item;n.settings.render.item=(t,r)=>{var s=R(e.call(n,t,r)),o=R(i);return s.appendChild(o),ie(o,"mousedown",(e=>{ne(e,!0)})),ie(o,"click",(e=>{n.isLocked||(ne(e,!0),!n.isLocked&&n.shouldDelete([s],e)&&(n.removeItem(s),n.refreshOptions(!1),n.inputState()))})),s}}))}})),ce.define("restore_on_backspace",(function(e){let t=this,n=Object.assign({text:e=>e[t.settings.labelField]},e);t.on("item_remove",(function(e){if(t.isFocused&&""===t.control_input.value.trim()){var i=t.options[e];i&&t.setTextboxValue(n.text.call(t,i))}}))})),ce.define("virtual_scroll",(function(){let e=this,t=e.canLoad,n=e.clearActiveOption,i=e.loadCallback;var r,s,o={},a=!1,l=[];if(e.settings.shouldLoadMore||(e.settings.shouldLoadMore=()=>{if(r.clientHeight/(r.scrollHeight-r.scrollTop)>.9)return!0;if(e.activeOption){var t=e.selectable();if(Array.from(t).indexOf(e.activeOption)>=t.length-2)return!0}return!1}),!e.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";e.settings.sortField=[{field:"$order"},{field:"$score"}];let h=t=>!("number"==typeof e.settings.maxOptions&&r.children.length>=e.settings.maxOptions)&&!(!(t in o)||!o[t]),c=(t,n)=>e.items.indexOf(n)>=0||l.indexOf(n)>=0;e.setNextUrl=(e,t)=>{o[e]=t},e.getUrl=t=>{if(t in o){let e=o[t];return o[t]=!1,e}return e.clearPagination(),e.settings.firstUrl.call(e,t)},e.clearPagination=()=>{o={}},e.hook("instead","clearActiveOption",(()=>{if(!a)return n.call(e)})),e.hook("instead","canLoad",(n=>n in o?h(n):t.call(e,n))),e.hook("instead","loadCallback",((t,n)=>{if(a){if(s){let n=t[0];void 0!==n&&(s.dataset.value=n[e.settings.valueField])}}else e.clearOptions(c);i.call(e,t,n),a=!1})),e.hook("after","refreshOptions",(()=>{let t=e.lastValue;var n;h(t)?(n=e.render("loading_more",{query:t}))&&(n.setAttribute("data-selectable",""),s=n):t in o&&!r.querySelector(".no-results")&&(n=e.render("no_more_results",{query:t})),n&&(X(n,e.settings.optionClass),r.append(n))})),e.on("initialize",(()=>{l=Object.keys(e.options),r=e.dropdown_content,e.settings.render=Object.assign({},{loading_more:()=>'<div class="loading-more-results">Loading more results ... </div>',no_more_results:()=>'<div class="no-more-results">No more results</div>'},e.settings.render),r.addEventListener("scroll",(()=>{e.settings.shouldLoadMore.call(e)&&h(e.lastValue)&&(a||(a=!0,e.load.call(e,e.lastValue)))}))}))})),ce}))})),a=class e{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=g(this,e,t);let i=[];return this.decompose(0,e,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(t,this.length,i,1),h.from(i,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=g(this,e,t);let n=[];return this.decompose(e,t,n,0),h.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),i=new d(this),r=new d(e);for(let e=t,s=t;;){if(i.next(e),r.next(e),e=0,i.lineBreak!=r.lineBreak||i.done!=r.done||i.value!=r.value)return!1;if(s+=i.value.length,i.done||s>=n)return!0}}iter(e=1){return new d(this,e)}iterRange(e,t=this.length){return new p(this,e,t)}iterLines(e,t){let n;if(null==e)n=this.iter();else{null==t&&(t=this.lines+1);let i=this.line(e).from;n=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new f(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(t){if(0==t.length)throw new RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new l(t):h.from(l.split(t,[])):e.empty}},l=class e extends a{constructor(e,t=function(e){let t=-1;for(let n of e)t+=n.length+1;return t}(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,i){for(let r=0;;r++){let s=this.text[r],o=i+s.length;if((t?n:o)>=e)return new m(i,o,n,s);i=o+1,n++}}decompose(t,n,i,r){let s=t<=0&&n>=this.length?this:new e(u(this.text,t,n),Math.min(n,this.length)-Math.max(0,t));if(1&r){let t=i.pop(),n=c(s.text,t.text.slice(),0,s.length);if(n.length<=32)i.push(new e(n,t.length+s.length));else{let t=n.length>>1;i.push(new e(n.slice(0,t)),new e(n.slice(t)))}}else i.push(s)}replace(t,n,i){if(!(i instanceof e))return super.replace(t,n,i);[t,n]=g(this,t,n);let r=c(this.text,c(i.text,u(this.text,0,t)),n),s=this.length+i.length-(n-t);return r.length<=32?new e(r,s):h.from(e.split(r,[]),s)}sliceString(e,t=this.length,n="\n"){[e,t]=g(this,e,t);let i="";for(let r=0,s=0;r<=t&&s<this.text.length;s++){let o=this.text[s],a=r+o.length;r>e&&s&&(i+=n),e<a&&t>r&&(i+=o.slice(Math.max(0,e-r),t-r)),r=a+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(t,n){let i=[],r=-1;for(let s of t)i.push(s),r+=s.length+1,32==i.length&&(n.push(new e(i,r)),i=[],r=-1);return r>-1&&n.push(new e(i,r)),n}},h=class e extends a{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let t of e)this.lines+=t.lines}lineInner(e,t,n,i){for(let r=0;;r++){let s=this.children[r],o=i+s.length,a=n+s.lines-1;if((t?a:o)>=e)return s.lineInner(e,t,n,i);i=o+1,n=a+1}}decompose(e,t,n,i){for(let r=0,s=0;s<=t&&r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(e<=a&&t>=s){let r=i&((s<=e?1:0)|(a>=t?2:0));s>=e&&a<=t&&!r?n.push(o):o.decompose(e-s,t-s,n,r)}s=a+1}}replace(t,n,i){if([t,n]=g(this,t,n),i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(t>=s&&n<=a){let l=o.replace(t-s,n-s,i),h=this.lines-o.lines+l.lines;if(l.lines<h>>4&&l.lines>h>>6){let s=this.children.slice();return s[r]=l,new e(s,this.length-(n-t)+i.length)}return super.replace(s,a,l)}s=a+1}return super.replace(t,n,i)}sliceString(e,t=this.length,n="\n"){[e,t]=g(this,e,t);let i="";for(let r=0,s=0;r<this.children.length&&s<=t;r++){let o=this.children[r],a=s+o.length;s>e&&r&&(i+=n),e<a&&t>s&&(i+=o.sliceString(e-s,t-s,n)),s=a+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(t,n){if(!(t instanceof e))return 0;let i=0,[r,s,o,a]=n>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;r+=n,s+=n){if(r==o||s==a)return i;let e=this.children[r],l=t.children[s];if(e!=l)return i+e.scanIdentical(l,n);i+=e.length+1}}static from(t,n=t.reduce(((e,t)=>e+t.length+1),-1)){let i=0;for(let e of t)i+=e.lines;if(i<32){let e=[];for(let n of t)n.flatten(e);return new l(e,n)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,a=[],h=0,c=-1,u=[];function d(t){let n;if(t.lines>s&&t instanceof e)for(let e of t.children)d(e);else t.lines>o&&(h>o||!h)?(p(),a.push(t)):t instanceof l&&h&&(n=u[u.length-1])instanceof l&&t.lines+n.lines<=32?(h+=t.lines,c+=t.length+1,u[u.length-1]=new l(n.text.concat(t.text),n.length+1+t.length)):(h+t.lines>r&&p(),h+=t.lines,c+=t.length+1,u.push(t))}function p(){0!=h&&(a.push(1==u.length?u[0]:e.from(u,c)),c=-1,h=u.length=0)}for(let e of t)d(e);return p(),1==a.length?a[0]:new e(a,n)}};function c(e,t,n=0,i=1e9){for(let r=0,s=0,o=!0;s<e.length&&r<=i;s++){let a=e[s],l=r+a.length;l>=n&&(l>i&&(a=a.slice(0,i-r)),r<n&&(a=a.slice(n-r)),o?(t[t.length-1]+=a,o=!1):t.push(a)),r=l+1}return t}function u(e,t,n){return c(e,[""],t,n)}a.empty=new l([""],0);var d=class{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof l?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],r=this.offsets[n],s=r>>1,o=i instanceof l?i.text.length:i.children.length;if(s==(t>0?o:0)){if(0==n)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(t>0?0:1)){if(this.offsets[n]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--}else if(i instanceof l){let r=i.text[s+(t<0?-1:0)];if(this.offsets[n]+=t,r.length>Math.max(0,e))return this.value=0==e?r:t>0?r.slice(e):r.slice(0,r.length-e),this;e-=r.length}else{let r=i.children[s+(t<0?-1:0)];e>r.length?(e-=r.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(r),this.offsets.push(t>0?1:(r instanceof l?r.text.length:r.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}},p=class{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new d(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=n?i:t<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}},f=class{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}};typeof Symbol<"u"&&(a.prototype[Symbol.iterator]=function(){return this.iter()},d.prototype[Symbol.iterator]=p.prototype[Symbol.iterator]=f.prototype[Symbol.iterator]=function(){return this});var m=class{constructor(e,t,n,i){this.from=e,this.to=t,this.number=n,this.text=i}get length(){return this.to-this.from}};function g(e,t,n){return[t=Math.max(0,Math.min(e.length,t)),Math.max(t,Math.min(e.length,n))]}var O="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((e=>e?parseInt(e,36):1));for(let e=1;e<O.length;e++)O[e]+=O[e-1];function y(e){for(let t=1;t<O.length;t+=2)if(O[t]>e)return O[t-1]<=e;return!1}function v(e){return e>=127462&&e<=127487}function b(e,t,n=!0,i=!0){return(n?w:x)(e,t,i)}function w(e,t,n){if(t==e.length)return t;t&&S(e.charCodeAt(t))&&k(e.charCodeAt(t-1))&&t--;let i=A(e,t);for(t+=_(i);t<e.length;){let r=A(e,t);if(8205==i||8205==r||n&&y(r))t+=_(r),i=r;else{if(!v(r))break;{let n=0,i=t-2;for(;i>=0&&v(A(e,i));)n++,i-=2;if(n%2==0)break;t+=2}}}return t}function x(e,t,n){for(;t>0;){let i=w(e,t-2,n);if(i<t)return i;t--}return 0}function S(e){return e>=56320&&e<57344}function k(e){return e>=55296&&e<56320}function A(e,t){let n=e.charCodeAt(t);if(!k(n)||t+1==e.length)return n;let i=e.charCodeAt(t+1);return S(i)?i-56320+(n-55296<<10)+65536:n}function C(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function _(e){return e<65536?1:2}var E=/\r\n?|\n/,T=function(e){return e[e.Simple=0]="Simple",e[e.TrackDel=1]="TrackDel",e[e.TrackBefore=2]="TrackBefore",e[e.TrackAfter=3]="TrackAfter",e}(T||(T={})),P=class e{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,i=0;t<this.sections.length;){let r=this.sections[t++],s=this.sections[t++];s<0?(e(n,i,r),i+=r):i+=s,n+=r}}iterChangedRanges(e,t=!1){Q(this,e,t)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let n=this.sections[e++],i=this.sections[e++];i<0?t.push(n,i):t.push(i,n)}return new e(t)}composeDesc(e){return this.empty?e:e.empty?this:M(this,e)}mapDesc(e,t=!1){return e.empty?this:R(this,e,t)}mapPos(e,t=-1,n=T.Simple){let i=0,r=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],a=this.sections[s++],l=i+o;if(a<0){if(l>e)return r+(e-i);r+=o}else{if(n!=T.Simple&&l>=e&&(n==T.TrackDel&&i<e&&l>e||n==T.TrackBefore&&i<e||n==T.TrackAfter&&l>e))return null;if(l>e||l==e&&t<0&&!o)return e==i||t<0?r:r+a;r+=a}i=l}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return r}touchesRange(e,t=e){for(let n=0,i=0;n<this.sections.length&&i<=t;){let r=i+this.sections[n++];if(this.sections[n++]>=0&&i<=t&&r>=e)return!(i<e&&r>t)||"cover";i=r}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+n+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some((e=>"number"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new e(t)}static create(t){return new e(t)}},$=class e extends P{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Q(this,((t,n,i,r,s)=>e=e.replace(i,i+(n-t),s)),!1),e}mapDesc(e,t=!1){return R(this,e,t,!0)}invert(t){let n=this.sections.slice(),i=[];for(let e=0,r=0;e<n.length;e+=2){let s=n[e],o=n[e+1];if(o>=0){n[e]=o,n[e+1]=s;let l=e>>1;for(;i.length<l;)i.push(a.empty);i.push(s?t.slice(r,r+s):a.empty)}r+=s}return new e(n,i)}compose(e){return this.empty?e:e.empty?this:M(this,e,!0)}map(e,t=!1){return e.empty?this:R(this,e,t,!0)}iterChanges(e,t=!1){Q(this,e,t)}get desc(){return P.create(this.sections)}filter(t){let n=[],i=[],r=[],s=new B(this);e:for(let e=0,o=0;;){let a=e==t.length?1e9:t[e++];for(;o<a||o==a&&0==s.len;){if(s.done)break e;let e=Math.min(s.len,a-o);N(r,e,-1);let t=-1==s.ins?-1:0==s.off?s.ins:0;N(n,e,t),t>0&&I(i,n,s.text),s.forward(e),o+=e}let l=t[e++];for(;o<l;){if(s.done)break e;let e=Math.min(s.len,l-o);N(n,e,-1),N(r,e,-1==s.ins?-1:0==s.off?s.ins:0),s.forward(e),o+=e}}return{changes:new e(n,i),filtered:P.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],i=this.sections[t+1];i<0?e.push(n):0==i?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(t,n,i){let r=[],s=[],o=0,l=null;function h(t=!1){if(!t&&!r.length)return;o<n&&N(r,n-o,-1);let i=new e(r,s);l=l?l.compose(i.map(l)):i,r=[],s=[],o=0}return function t(c){if(Array.isArray(c))for(let e of c)t(e);else if(c instanceof e){if(c.length!=n)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${n})`);h(),l=l?l.compose(c.map(l)):c}else{let{from:e,to:t=e,insert:l}=c;if(e>t||e<0||t>n)throw new RangeError(`Invalid change range ${e} to ${t} (in doc of length ${n})`);let u=l?"string"==typeof l?a.of(l.split(i||E)):l:a.empty,d=u.length;if(e==t&&0==d)return;e<o&&h(),e>o&&N(r,e-o,-1),N(r,t-e,d),I(s,r,u),o=t}}(t),h(!l),l}static empty(t){return new e(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let n=[],i=[];for(let e=0;e<t.length;e++){let r=t[e];if("number"==typeof r)n.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some(((e,t)=>t&&"string"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)n.push(r[0],0);else{for(;i.length<e;)i.push(a.empty);i[e]=a.of(r.slice(1)),n.push(r[0],i[e].length)}}}return new e(n,i)}static createSet(t,n){return new e(t,n)}};function N(e,t,n,i=!1){if(0==t&&n<=0)return;let r=e.length-2;r>=0&&n<=0&&n==e[r+1]?e[r]+=t:0==t&&0==e[r]?e[r+1]+=n:i?(e[r]+=t,e[r+1]+=n):e.push(t,n)}function I(e,t,n){if(0==n.length)return;let i=t.length-2>>1;if(i<e.length)e[e.length-1]=e[e.length-1].append(n);else{for(;e.length<i;)e.push(a.empty);e.push(n)}}function Q(e,t,n){let i=e.inserted;for(let r=0,s=0,o=0;o<e.sections.length;){let l=e.sections[o++],h=e.sections[o++];if(h<0)r+=l,s+=l;else{let c=r,u=s,d=a.empty;for(;c+=l,u+=h,h&&i&&(d=d.append(i[o-2>>1])),!(n||o==e.sections.length||e.sections[o+1]<0);)l=e.sections[o++],h=e.sections[o++];t(r,c,s,u,d),r=c,s=u}}}function R(e,t,n,i=!1){let r=[],s=i?[]:null,o=new B(e),a=new B(t);for(let e=-1;;)if(-1==o.ins&&-1==a.ins){let e=Math.min(o.len,a.len);N(r,e,-1),o.forward(e),a.forward(e)}else if(a.ins>=0&&(o.ins<0||e==o.i||0==o.off&&(a.len<o.len||a.len==o.len&&!n))){let t=a.len;for(N(r,a.ins,-1);t;){let n=Math.min(o.len,t);o.ins>=0&&e<o.i&&o.len<=n&&(N(r,0,o.ins),s&&I(s,r,o.text),e=o.i),o.forward(n),t-=n}a.next()}else{if(!(o.ins>=0)){if(o.done&&a.done)return s?$.createSet(r,s):P.create(r);throw new Error("Mismatched change set lengths")}{let t=0,n=o.len;for(;n;)if(-1==a.ins){let e=Math.min(n,a.len);t+=e,n-=e,a.forward(e)}else{if(!(0==a.ins&&a.len<n))break;n-=a.len,a.next()}N(r,t,e<o.i?o.ins:0),s&&e<o.i&&I(s,r,o.text),e=o.i,o.forward(o.len-n)}}}function M(e,t,n=!1){let i=[],r=n?[]:null,s=new B(e),o=new B(t);for(let e=!1;;){if(s.done&&o.done)return r?$.createSet(i,r):P.create(i);if(0==s.ins)N(i,s.len,0,e),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let t=Math.min(s.len2,o.len),n=i.length;if(-1==s.ins){let n=-1==o.ins?-1:o.off?0:o.ins;N(i,t,n,e),r&&n&&I(r,i,o.text)}else-1==o.ins?(N(i,s.off?0:s.len,t,e),r&&I(r,i,s.textBit(t))):(N(i,s.off?0:s.len,o.off?0:o.ins,e),r&&!o.off&&I(r,i,o.text));e=(s.ins>t||o.ins>=0&&o.len>t)&&(e||i.length>n),s.forward2(t),o.forward(t)}}else N(i,0,o.ins,e),r&&I(r,i,o.text),o.next()}}var B=class{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?a.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?a.empty:t[n].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}},D=class e{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let e=7&this.flags;return 7==e?null:e}get goalColumn(){let e=this.flags>>6;return 16777215==e?void 0:e}map(t,n=-1){let i,r;return this.empty?i=r=t.mapPos(this.from,n):(i=t.mapPos(this.from,1),r=t.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new e(i,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return X.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return X.range(this.anchor,n)}eq(e,t=!1){return!(this.anchor!=e.anchor||this.head!=e.head||t&&this.empty&&this.assoc!=e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid JSON representation for SelectionRange");return X.range(e.anchor,e.head)}static create(t,n,i){return new e(t,n,i)}},X=class e{constructor(e,t){this.ranges=e,this.mainIndex=t}map(t,n=-1){return t.empty?this:e.create(this.ranges.map((e=>e.map(t,n))),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new e([this.main],0)}addRange(t,n=!0){return e.create([t].concat(this.ranges),n?0:this.mainIndex+1)}replaceRange(t,n=this.mainIndex){let i=this.ranges.slice();return i[n]=t,e.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((e=>e.toJSON())),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new e(t.ranges.map((e=>D.fromJSON(e))),t.main)}static single(t,n=t){return new e([e.range(t,n)],0)}static create(t,n=0){if(0==t.length)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<t.length;r++){let s=t[r];if(s.empty?s.from<=i:s.from<i)return e.normalized(t.slice(),n);i=s.to}return new e(t,n)}static cursor(e,t=0,n,i){return D.create(e,e,(0==t?0:t<0?8:16)|(null==n?7:Math.min(6,n))|(i??16777215)<<6)}static range(e,t,n,i){let r=(n??16777215)<<6|(null==i?7:Math.min(6,i));return t<e?D.create(t,e,48|r):D.create(e,t,(t>e?8:0)|r)}static normalized(t,n=0){let i=t[n];t.sort(((e,t)=>e.from-t.from)),n=t.indexOf(i);for(let i=1;i<t.length;i++){let r=t[i],s=t[i-1];if(r.empty?r.from<=s.to:r.from<s.to){let o=s.from,a=Math.max(r.to,s.to);i<=n&&n--,t.splice(--i,2,r.anchor>r.head?e.range(a,o):e.range(o,a))}}return new e(t,n)}};function F(e,t){for(let n of e.ranges)if(n.to>t)throw new RangeError("Selection points outside of document")}var L=0,U=class e{constructor(e,t,n,i,r){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=i,this.id=L++,this.default=e([]),this.extensions="function"==typeof r?r(this):r}get reader(){return this}static define(t={}){return new e(t.combine||(e=>e),t.compareInput||((e,t)=>e===t),t.compare||(t.combine?(e,t)=>e===t:V),!!t.static,t.enables)}of(e){return new z([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new z(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new z(e,this,2,t)}from(e,t){return t||(t=e=>e),this.compute([e],(n=>t(n.field(e))))}};function V(e,t){return e==t||e.length==t.length&&e.every(((e,n)=>e===t[n]))}var z=class{constructor(e,t,n,i){this.dependencies=e,this.facet=t,this.type=n,this.value=i,this.id=L++}dynamicSlot(e){var t;let n=this.value,i=this.facet.compareInput,r=this.id,s=e[r]>>1,o=2==this.type,a=!1,l=!1,h=[];for(let n of this.dependencies)"doc"==n?a=!0:"selection"==n?l=!0:1&(null!==(t=e[n.id])&&void 0!==t?t:1)||h.push(e[n.id]);return{create:e=>(e.values[s]=n(e),1),update(e,t){if(a&&t.docChanged||l&&(t.docChanged||t.selection)||j(e,h)){let t=n(e);if(o?!Z(t,e.values[s],i):!i(t,e.values[s]))return e.values[s]=t,1}return 0},reconfigure:(e,t)=>{let a,l=t.config.address[r];if(null!=l){let r=ae(t,l);if(this.dependencies.every((n=>n instanceof U?t.facet(n)===e.facet(n):!(n instanceof W)||t.field(n,!1)==e.field(n,!1)))||(o?Z(a=n(e),r,i):i(a=n(e),r)))return e.values[s]=r,0}else a=n(e);return e.values[s]=a,1}}}};function Z(e,t,n){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function j(e,t){let n=!1;for(let i of t)1&oe(e,i)&&(n=!0);return n}function q(e,t,n){let i=n.map((t=>e[t.id])),r=n.map((e=>e.type)),s=i.filter((e=>!(1&e))),o=e[t.id]>>1;function a(e){let n=[];for(let t=0;t<i.length;t++){let s=ae(e,i[t]);if(2==r[t])for(let e of s)n.push(e);else n.push(s)}return t.combine(n)}return{create(e){for(let t of i)oe(e,t);return e.values[o]=a(e),1},update(e,n){if(!j(e,s))return 0;let i=a(e);return t.compare(i,e.values[o])?0:(e.values[o]=i,1)},reconfigure(e,r){let s=j(e,i),l=r.config.facets[t.id],h=r.facet(t);if(l&&!s&&V(n,l))return e.values[o]=h,0;let c=a(e);return t.compare(c,h)?(e.values[o]=h,0):(e.values[o]=c,1)}}}var G=U.define({static:!0}),W=class e{constructor(e,t,n,i,r){this.id=e,this.createF=t,this.updateF=n,this.compareF=i,this.spec=r,this.provides=void 0}static define(t){let n=new e(L++,t.create,t.update,t.compare||((e,t)=>e===t),t);return t.provide&&(n.provides=t.provide(n)),n}create(e){let t=e.facet(G).find((e=>e.field==this));return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:e=>(e.values[t]=this.create(e),1),update:(e,n)=>{let i=e.values[t],r=this.updateF(i,n);return this.compareF(i,r)?0:(e.values[t]=r,1)},reconfigure:(e,n)=>null!=n.config.address[this.id]?(e.values[t]=n.field(this),0):(e.values[t]=this.create(e),1)}}init(e){return[this,G.of({field:this,create:e})]}get extension(){return this}},H=4,Y=3,J=2,K=1;function ee(e){return t=>new ne(t,e)}var te={highest:ee(0),high:ee(K),default:ee(J),low:ee(Y),lowest:ee(H)},ne=class{constructor(e,t){this.inner=e,this.prec=t}},ie=class e{of(e){return new re(this,e)}reconfigure(t){return e.reconfigure.of({compartment:this,extension:t})}get(e){return e.config.compartments.get(this)}},re=class{constructor(e,t){this.compartment=e,this.inner=t}},se=class e{constructor(e,t,n,i,r,s){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=i,this.staticValues=r,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(t,n,i){let r=[],s=Object.create(null),o=new Map;for(let e of function(e,t,n){let i=[[],[],[],[],[]],r=new Map;function s(e,o){let a=r.get(e);if(null!=a){if(a<=o)return;let t=i[a].indexOf(e);t>-1&&i[a].splice(t,1),e instanceof re&&n.delete(e.compartment)}if(r.set(e,o),Array.isArray(e))for(let t of e)s(t,o);else if(e instanceof re){if(n.has(e.compartment))throw new RangeError("Duplicate use of compartment in extensions");let i=t.get(e.compartment)||e.inner;n.set(e.compartment,i),s(i,o)}else if(e instanceof ne)s(e.inner,e.prec);else if(e instanceof W)i[o].push(e),e.provides&&s(e.provides,o);else if(e instanceof z)i[o].push(e),e.facet.extensions&&s(e.facet.extensions,J);else{let t=e.extension;if(!t)throw new Error(`Unrecognized extension value in extension set (${e}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(t,o)}}return s(e,J),i.reduce(((e,t)=>e.concat(t)))}(t,n,o))e instanceof W?r.push(e):(s[e.facet.id]||(s[e.facet.id]=[])).push(e);let a=Object.create(null),l=[],h=[];for(let e of r)a[e.id]=h.length<<1,h.push((t=>e.slot(t)));let c=i?.config.facets;for(let e in s){let t=s[e],n=t[0].facet,r=c&&c[e]||[];if(t.every((e=>0==e.type)))if(a[n.id]=l.length<<1|1,V(r,t))l.push(i.facet(n));else{let e=n.combine(t.map((e=>e.value)));l.push(i&&n.compare(e,i.facet(n))?i.facet(n):e)}else{for(let e of t)0==e.type?(a[e.id]=l.length<<1|1,l.push(e.value)):(a[e.id]=h.length<<1,h.push((t=>e.dynamicSlot(t))));a[n.id]=h.length<<1,h.push((e=>q(e,n,t)))}}let u=h.map((e=>e(a)));return new e(t,o,u,a,l,s)}};function oe(e,t){if(1&t)return 2;let n=t>>1,i=e.status[n];if(4==i)throw new Error("Cyclic dependency between fields and/or facets");if(2&i)return i;e.status[n]=4;let r=e.computeSlot(e,e.config.dynamicSlots[n]);return e.status[n]=2|r}function ae(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}var le=U.define(),he=U.define({combine:e=>e.some((e=>e)),static:!0}),ce=U.define({combine:e=>e.length?e[0]:void 0,static:!0}),ue=U.define(),de=U.define(),pe=U.define(),fe=U.define({combine:e=>!!e.length&&e[0]}),me=class{constructor(e,t){this.type=e,this.value=t}static define(){return new ge}},ge=class{of(e){return new me(this,e)}},Oe=class e{constructor(e,t){this.type=e,this.value=t}map(t){let n=this.type.map(this.value,t);return void 0===n?void 0:n==this.value?this:new e(this.type,n)}is(e){return this.type==e}static define(e={}){return new class{constructor(e){this.map=e}of(e){return new Oe(this,e)}}(e.map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let i of e){let e=i.map(t);e&&n.push(e)}return n}};Oe.reconfigure=Oe.define(),Oe.appendConfig=Oe.define();var ye=class e{constructor(t,n,i,r,s,o){this.startState=t,this.changes=n,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&F(i,n.newLength),s.some((t=>t.type==e.time))||(this.annotations=s.concat(e.time.of(Date.now())))}static create(t,n,i,r,s,o){return new e(t,n,i,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let n=this.annotation(e.userEvent);return!(!n||!(n==t||n.length>t.length&&n.slice(0,t.length)==t&&"."==n[t.length]))}};function ve(e,t){let n=[];for(let i=0,r=0;;){let s,o;if(i<e.length&&(r==t.length||t[r]>=e[i]))s=e[i++],o=e[i++];else{if(!(r<t.length))return n;s=t[r++],o=t[r++]}!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function be(e,t,n){var i;let r,s,o;return n?(r=t.changes,s=$.empty(t.changes.length),o=e.changes.compose(t.changes)):(r=t.changes.map(e.changes),s=e.changes.mapDesc(t.changes,!0),o=e.changes.compose(r)),{changes:o,selection:t.selection?t.selection.map(s):null===(i=e.selection)||void 0===i?void 0:i.map(r),effects:Oe.mapEffects(e.effects,r).concat(Oe.mapEffects(t.effects,s)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function we(e,t,n){let i=t.selection,r=ke(t.annotations);return t.userEvent&&(r=r.concat(ye.userEvent.of(t.userEvent))),{changes:t.changes instanceof $?t.changes:$.of(t.changes||[],n,e.facet(ce)),selection:i&&(i instanceof X?i:X.single(i.anchor,i.head)),effects:ke(t.effects),annotations:r,scrollIntoView:!!t.scrollIntoView}}function xe(e,t,n){let i=we(e,t.length?t[0]:{},e.doc.length);t.length&&!1===t[0].filter&&(n=!1);for(let r=1;r<t.length;r++){!1===t[r].filter&&(n=!1);let s=!!t[r].sequential;i=be(i,we(e,t[r],s?i.changes.newLength:e.doc.length),s)}let r=ye.create(e,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return function(e){let t=e.startState,n=t.facet(pe),i=e;for(let r=n.length-1;r>=0;r--){let s=n[r](e);s&&Object.keys(s).length&&(i=be(i,we(t,s,e.changes.newLength),!0))}return i==e?e:ye.create(t,e.changes,e.selection,i.effects,i.annotations,i.scrollIntoView)}(n?function(e){let t=e.startState,n=!0;for(let i of t.facet(ue)){let t=i(e);if(!1===t){n=!1;break}Array.isArray(t)&&(n=!0===n?t:ve(n,t))}if(!0!==n){let i,r;if(!1===n)r=e.changes.invertedDesc,i=$.empty(t.doc.length);else{let t=e.changes.filter(n);i=t.changes,r=t.filtered.mapDesc(t.changes).invertedDesc}e=ye.create(t,i,e.selection&&e.selection.map(r),Oe.mapEffects(e.effects,r),e.annotations,e.scrollIntoView)}let i=t.facet(de);for(let n=i.length-1;n>=0;n--){let r=i[n](e);e=r instanceof ye?r:Array.isArray(r)&&1==r.length&&r[0]instanceof ye?r[0]:xe(t,ke(r),!1)}return e}(r):r)}ye.time=me.define(),ye.userEvent=me.define(),ye.addToHistory=me.define(),ye.remote=me.define();var Se=[];function ke(e){return null==e?Se:Array.isArray(e)?e:[e]}var Ae,Ce=function(e){return e[e.Word=0]="Word",e[e.Space=1]="Space",e[e.Other=2]="Other",e}(Ce||(Ce={})),_e=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{Ae=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Ee(e){return t=>{if(!/\S/.test(t))return Ce.Space;if(function(e){if(Ae)return Ae.test(e);for(let t=0;t<e.length;t++){let n=e[t];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||_e.test(n)))return!0}return!1}(t))return Ce.Word;for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return Ce.Word;return Ce.Other}}var Te=class e{constructor(e,t,n,i,r,s){this.config=e,this.doc=t,this.selection=n,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=r,s&&(s._state=this);for(let e=0;e<this.config.dynamicSlots.length;e++)oe(this,e<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(null!=n)return oe(this,n),ae(this,n);if(t)throw new RangeError("Field is not present in this state")}update(...e){return xe(this,e,!0)}applyTransaction(t){let n,i=this.config,{base:r,compartments:s}=i;for(let e of t.effects)e.is(ie.reconfigure)?(i&&(s=new Map,i.compartments.forEach(((e,t)=>s.set(t,e))),i=null),s.set(e.value.compartment,e.value.extension)):e.is(Oe.reconfigure)?(i=null,r=e.value):e.is(Oe.appendConfig)&&(i=null,r=ke(r).concat(e.value));i?n=t.startState.values.slice():(i=se.resolve(r,s,this),n=new e(i,this.doc,this.selection,i.dynamicSlots.map((()=>null)),((e,t)=>t.reconfigure(e,this)),null).values);let o=t.startState.facet(he)?t.newSelection:t.newSelection.asSingle();new e(i,t.newDoc,o,n,((e,n)=>n.update(e,t)),t)}replaceSelection(e){return"string"==typeof e&&(e=this.toText(e)),this.changeByRange((t=>({changes:{from:t.from,to:t.to,insert:e},range:X.cursor(t.from+e.length)})))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),i=this.changes(n.changes),r=[n.range],s=ke(n.effects);for(let n=1;n<t.ranges.length;n++){let o=e(t.ranges[n]),a=this.changes(o.changes),l=a.map(i);for(let e=0;e<n;e++)r[e]=r[e].map(l);let h=i.mapDesc(a,!0);r.push(o.range.map(h)),i=i.compose(l),s=Oe.mapEffects(s,l).concat(Oe.mapEffects(ke(o.effects),h))}return{changes:i,selection:X.create(r,t.mainIndex),effects:s}}changes(t=[]){return t instanceof $?t:$.of(t,this.doc.length,this.facet(e.lineSeparator))}toText(t){return a.of(t.split(this.facet(e.lineSeparator)||E))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return null==t?e.default:(oe(this,t),ae(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let i=e[n];i instanceof W&&null!=this.config.address[i.id]&&(t[n]=i.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(t,n={},i){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i)for(let e in i)if(Object.prototype.hasOwnProperty.call(t,e)){let n=i[e],s=t[e];r.push(n.init((e=>n.spec.fromJSON(s,e))))}return e.create({doc:t.doc,selection:X.fromJSON(t.selection),extensions:n.extensions?r.concat([n.extensions]):r})}static create(t={}){let n=se.resolve(t.extensions||[],new Map),i=t.doc instanceof a?t.doc:a.of((t.doc||"").split(n.staticFacet(e.lineSeparator)||E)),r=t.selection?t.selection instanceof X?t.selection:X.single(t.selection.anchor,t.selection.head):X.single(0);return F(r,i.length),n.staticFacet(he)||(r=r.asSingle()),new e(n,i,r,n.dynamicSlots.map((()=>null)),((e,t)=>t.create(e)),null)}get tabSize(){return this.facet(e.tabSize)}get lineBreak(){return this.facet(e.lineSeparator)||"\n"}get readOnly(){return this.facet(fe)}phrase(t,...n){for(let n of this.facet(e.phrases))if(Object.prototype.hasOwnProperty.call(n,t)){t=n[t];break}return n.length&&(t=t.replace(/\$(\$|\d*)/g,((e,t)=>{if("$"==t)return"$";let i=+(t||1);return!i||i>n.length?e:n[i-1]}))),t}languageDataAt(e,t,n=-1){let i=[];for(let r of this.facet(le))for(let s of r(this,t,n))Object.prototype.hasOwnProperty.call(s,e)&&i.push(s[e]);return i}charCategorizer(e){return Ee(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:i}=this.doc.lineAt(e),r=this.charCategorizer(e),s=e-n,o=e-n;for(;s>0;){let e=b(t,s,!1);if(r(t.slice(e,s))!=Ce.Word)break;s=e}for(;o<i;){let e=b(t,o);if(r(t.slice(o,e))!=Ce.Word)break;o=e}return s==o?null:X.range(s+n,o+n)}};function Pe(e,t,n={}){let i={};for(let t of e)for(let e of Object.keys(t)){let r=t[e],s=i[e];if(void 0===s)i[e]=r;else if(s!==r&&void 0!==r){if(!Object.hasOwnProperty.call(n,e))throw new Error("Config merge conflict for field "+e);i[e]=n[e](s,r)}}for(let e in t)void 0===i[e]&&(i[e]=t[e]);return i}Te.allowMultipleSelections=he,Te.tabSize=U.define({combine:e=>e.length?e[0]:4}),Te.lineSeparator=ce,Te.readOnly=fe,Te.phrases=U.define({compare(e,t){let n=Object.keys(e),i=Object.keys(t);return n.length==i.length&&n.every((n=>e[n]==t[n]))}}),Te.languageData=le,Te.changeFilter=ue,Te.transactionFilter=de,Te.transactionExtender=pe,ie.reconfigure=Oe.define();var $e=class{eq(e){return this==e}range(e,t=e){return Ne.create(e,t,this)}};$e.prototype.startSide=$e.prototype.endSide=0,$e.prototype.point=!1,$e.prototype.mapMode=T.TrackDel;var Ne=class e{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(t,n,i){return new e(t,n,i)}};function Ie(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}var Qe=class e{constructor(e,t,n,i){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=i}static create(t,n,i,r){return new e(t,n,i,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(t){let{add:n=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=t,o=t.filter;if(0==n.length&&!o)return this;if(i&&(n=n.slice().sort(Ie)),this.isEmpty)return n.length?e.of(n):this;let a=new Be(this,null,-1).goto(0),l=0,h=[],c=new Re;for(;a.value||l<n.length;)if(l<n.length&&(a.from-n[l].from||a.startSide-n[l].value.startSide)>=0){let e=n[l++];c.addInner(e.from,e.to,e.value)||h.push(e)}else 1==a.rangeIndex&&a.chunkIndex<this.chunk.length&&(l==n.length||this.chunkEnd(a.chunkIndex)<n[l].from)&&(!o||r>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&c.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||r>a.to||s<a.from||o(a.from,a.to,a.value))&&(c.addInner(a.from,a.to,a.value)||h.push(Ne.create(a.from,a.to,a.value))),a.next());return c.finishInner(this.nextLayer.isEmpty&&!h.length?e.empty:this.nextLayer.update({add:h,filter:o,filterFrom:r,filterTo:s}))}map(t){if(t.empty||this.isEmpty)return this;let n=[],i=[],r=-1;for(let e=0;e<this.chunk.length;e++){let s=this.chunkPos[e],o=this.chunk[e],a=t.touchesRange(s,s+o.length);if(!1===a)r=Math.max(r,o.maxPoint),n.push(o),i.push(t.mapPos(s));else if(!0===a){let{mapped:e,pos:a}=o.map(s,t);e&&(r=Math.max(r,e.maxPoint),n.push(e),i.push(a))}}let s=this.nextLayer.map(t);return 0==n.length?s:new e(i,n,s||e.empty,r)}between(e,t,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let r=this.chunkPos[i],s=this.chunk[i];if(t>=r&&e<=r+s.length&&!1===s.between(r,e-r,t-r,n))return}this.nextLayer.between(e,t,n)}}iter(e=0){return De.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return De.from(e).goto(t)}static compare(e,t,n,i,r=-1){let s=e.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=r)),o=t.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=r)),a=Me(s,o,n),l=new Fe(s,a,r),h=new Fe(o,a,r);n.iterGaps(((e,t,n)=>Le(l,e,h,t,n,i))),n.empty&&0==n.length&&Le(l,0,h,0,0,i)}static eq(e,t,n=0,i){null==i&&(i=999999999);let r=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0)),s=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0));if(r.length!=s.length)return!1;if(!r.length)return!0;let o=Me(r,s),a=new Fe(r,o,0).goto(n),l=new Fe(s,o,0).goto(n);for(;;){if(a.to!=l.to||!Ue(a.active,l.active)||a.point&&(!l.point||!a.point.eq(l.point)))return!1;if(a.to>i)return!0;a.next(),l.next()}}static spans(e,t,n,i,r=-1){let s=new Fe(e,null,r).goto(t),o=t,a=s.openStart;for(;;){let e=Math.min(s.to,n);if(s.point){let n=s.activeForPoint(s.to),r=s.pointFrom<t?n.length+1:s.point.startSide<0?n.length:Math.min(n.length,a);i.point(o,e,s.point,n,r,s.pointRank),a=Math.min(s.openEnd(e),n.length)}else e>o&&(i.span(o,e,s.active,a),a=s.openEnd(e));if(s.to>n)return a+(s.point&&s.to>n?1:0);o=s.to,s.next()}}static of(e,t=!1){let n=new Re;for(let i of e instanceof Ne?[e]:t?function(e){if(e.length>1)for(let t=e[0],n=1;n<e.length;n++){let i=e[n];if(Ie(t,i)>0)return e.slice().sort(Ie);t=i}return e}(e):e)n.add(i.from,i.to,i.value);return n.finish()}static join(t){if(!t.length)return e.empty;let n=t[t.length-1];for(let i=t.length-2;i>=0;i--)for(let r=t[i];r!=e.empty;r=r.nextLayer)n=new e(r.chunkPos,r.chunk,n,Math.max(r.maxPoint,n.maxPoint));return n}};Qe.empty=new Qe([],[],null,-1),Qe.empty.nextLayer=Qe.empty;var Re=class e{finishChunk(e){this.chunks.push(new class e{constructor(e,t,n,i){this.from=e,this.to=t,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,i=0){let r=n?this.to:this.from;for(let s=i,o=r.length;;){if(s==o)return s;let i=s+o>>1,a=r[i]-e||(n?this.value[i].endSide:this.value[i].startSide)-t;if(i==s)return a>=0?s:o;a>=0?o=i:s=i+1}}between(e,t,n,i){for(let r=this.findIndex(t,-1e9,!0),s=this.findIndex(n,1e9,!1,r);r<s;r++)if(!1===i(this.from[r]+e,this.to[r]+e,this.value[r]))return!1}map(t,n){let i=[],r=[],s=[],o=-1,a=-1;for(let e=0;e<this.value.length;e++){let l,h,c=this.value[e],u=this.from[e]+t,d=this.to[e]+t;if(u==d){let e=n.mapPos(u,c.startSide,c.mapMode);if(null==e||(l=h=e,c.startSide!=c.endSide&&(h=n.mapPos(u,c.endSide),h<l)))continue}else if(l=n.mapPos(u,c.startSide),h=n.mapPos(d,c.endSide),l>h||l==h&&c.startSide>0&&c.endSide<=0)continue;(h-l||c.endSide-c.startSide)<0||(o<0&&(o=l),c.point&&(a=Math.max(a,h-l)),i.push(c),r.push(l-o),s.push(h-o))}return{mapped:i.length?new e(r,s,i,a):null,pos:o}}}(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,n,i){this.addInner(t,n,i)||(this.nextLayer||(this.nextLayer=new e)).add(t,n,i)}addInner(e,t,n){let i=e-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(i<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(Qe.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;let t=Qe.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}};function Me(e,t,n){let i=new Map;for(let t of e)for(let e=0;e<t.chunk.length;e++)t.chunk[e].maxPoint<=0&&i.set(t.chunk[e],t.chunkPos[e]);let r=new Set;for(let e of t)for(let t=0;t<e.chunk.length;t++){let s=i.get(e.chunk[t]);null!=s&&(n?n.mapPos(s):s)==e.chunkPos[t]&&!n?.touchesRange(s,s+e.chunk[t].length)&&r.add(e.chunk[t])}return r}var Be=class{constructor(e,t,n,i=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let t=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(t)||this.layer.chunkEnd(this.chunkIndex)<e||t.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}},De=class e{constructor(e){this.heap=e}static from(t,n=null,i=-1){let r=[];for(let e=0;e<t.length;e++)for(let s=t[e];!s.isEmpty;s=s.nextLayer)s.maxPoint>=i&&r.push(new Be(s,n,i,e));return 1==r.length?r[0]:new e(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let e=this.heap.length>>1;e>=0;e--)Xe(this.heap,e);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let e=this.heap.length>>1;e>=0;e--)Xe(this.heap,e);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Xe(this.heap,0)}}};function Xe(e,t){for(let n=e[t];;){let i=1+(t<<1);if(i>=e.length)break;let r=e[i];if(i+1<e.length&&r.compare(e[i+1])>=0&&(r=e[i+1],i++),n.compare(r)<0)break;e[i]=n,e[t]=r,t=i}}var Fe=class{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=De.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Ve(this.active,e),Ve(this.activeTo,e),Ve(this.activeRank,e),this.minActive=Ze(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:i,rank:r}=this.cursor;for(;t<this.activeRank.length&&(r-this.activeRank[t]||i-this.activeTo[t])>0;)t++;ze(this.active,t,n),ze(this.activeTo,t,i),ze(this.activeRank,t,r),e&&ze(e,t,this.cursor.from),this.minActive=Ze(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&Ve(n,i)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let e=this.cursor.value;if(e.point){if(!(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=e,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=e.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(n),this.cursor.next()}}}if(n){this.openStart=0;for(let t=n.length-1;t>=0&&n[t]<e;t--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}};function Le(e,t,n,i,r,s){e.goto(t),n.goto(i);let o=i+r,a=i,l=i-t;for(;;){let t=e.to+l-n.to||e.endSide-n.endSide,i=t<0?e.to+l:n.to,r=Math.min(i,o);if(e.point||n.point?e.point&&n.point&&(e.point==n.point||e.point.eq(n.point))&&Ue(e.activeForPoint(e.to),n.activeForPoint(n.to))||s.comparePoint(a,r,e.point,n.point):r>a&&!Ue(e.active,n.active)&&s.compareRange(a,r,e.active,n.active),i>o)break;a=i,t<=0&&e.next(),t>=0&&n.next()}}function Ue(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n]&&!e[n].eq(t[n]))return!1;return!0}function Ve(e,t){for(let n=t,i=e.length-1;n<i;n++)e[n]=e[n+1];e.pop()}function ze(e,t,n){for(let n=e.length-1;n>=t;n--)e[n+1]=e[n];e[t]=n}function Ze(e,t){let n=-1,i=1e9;for(let r=0;r<t.length;r++)(t[r]-i||e[r].endSide-e[n].endSide)<0&&(n=r,i=t[r]);return n}function je(e,t,n=e.length){let i=0;for(let r=0;r<n;)9==e.charCodeAt(r)?(i+=t-i%t,r++):(i++,r=b(e,r));return i}function qe(e,t,n,i){for(let i=0,r=0;;){if(r>=t)return i;if(i==e.length)break;r+=9==e.charCodeAt(i)?n-r%n:1,i=b(e,i)}return!0===i?-1:e.length}var Ge,We,He=typeof Symbol>"u"?"__":Symbol.for(""),Ye=typeof Symbol>"u"?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),Je=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{},Ke=class{constructor(e,t){this.rules=[];let{finish:n}=t||{};function i(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}function r(e,t,s,o){let a=[],l=/^@(\w+)\b/.exec(e[0]),h=l&&"keyframes"==l[1];if(l&&null==t)return s.push(e[0]+";");for(let n in t){let o=t[n];if(/&/.test(n))r(n.split(/,\s*/).map((t=>e.map((e=>t.replace(/&/,e))))).reduce(((e,t)=>e.concat(t))),o,s);else if(o&&"object"==typeof o){if(!l)throw new RangeError("The value of a property ("+n+") should be a primitive value.");r(i(n),o,a,h)}else null!=o&&a.push(n.replace(/_.*/,"").replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))+": "+o+";")}(a.length||h)&&s.push((!n||l||o?e:e.map(n)).join(", ")+" {"+a.join(" ")+"}")}for(let t in e)r(i(t),e[t],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let e=Je[He]||1;return Je[He]=e+1,""+e.toString(36)}static mount(e,t,n){let i=e[Ye],r=n&&n.nonce;i?r&&i.setNonce(r):i=new tt(e,r),i.mount(Array.isArray(t)?t:[t],e)}},et=new Map,tt=class{constructor(e,t){let n=e.ownerDocument||e,i=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let t=et.get(n);if(t)return e[Ye]=t;this.sheet=new i.CSSStyleSheet,et.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[Ye]=this}mount(e,t){let n=this.sheet,i=0,r=0;for(let t=0;t<e.length;t++){let s=e[t],o=this.modules.indexOf(s);if(o<r&&o>-1&&(this.modules.splice(o,1),r--,o=-1),-1==o){if(this.modules.splice(r++,0,s),n)for(let e=0;e<s.rules.length;e++)n.insertRule(s.rules[e],i++)}else{for(;r<o;)i+=this.modules[r++].rules.length;i+=s.rules.length,r++}}if(n)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let e="";for(let t=0;t<this.modules.length;t++)e+=this.modules[t].getRules()+"\n";this.styleTag.textContent=e;let n=t.head||t;this.styleTag.parentNode!=n&&n.insertBefore(this.styleTag,n.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}},nt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},it={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},rt=typeof navigator<"u"&&/Mac/.test(navigator.platform),st=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(Ge=0;Ge<10;Ge++)nt[48+Ge]=nt[96+Ge]=String(Ge);for(Ge=1;Ge<=24;Ge++)nt[Ge+111]="F"+Ge;for(Ge=65;Ge<=90;Ge++)nt[Ge]=String.fromCharCode(Ge+32),it[Ge]=String.fromCharCode(Ge);for(We in nt)it.hasOwnProperty(We)||(it[We]=nt[We]);function ot(e){let t;return t=11==e.nodeType?e.getSelection?e:e.ownerDocument:e,t.getSelection()}function at(e,t){return!!t&&(e==t||e.contains(1!=t.nodeType?t.parentNode:t))}function lt(e,t){if(!t.anchorNode)return!1;try{return at(e,t.anchorNode)}catch{return!1}}function ht(e){return 3==e.nodeType?wt(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function ct(e,t,n,i){return!!n&&(pt(e,t,n,i,-1)||pt(e,t,n,i,1))}function ut(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function dt(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}function pt(e,t,n,i,r){for(;;){if(e==n&&t==i)return!0;if(t==(r<0?0:ft(e))){if("DIV"==e.nodeName)return!1;let n=e.parentNode;if(!n||1!=n.nodeType)return!1;t=ut(e)+(r<0?0:1),e=n}else{if(1!=e.nodeType)return!1;if(1==(e=e.childNodes[t+(r<0?-1:0)]).nodeType&&"false"==e.contentEditable)return!1;t=r<0?ft(e):0}}}function ft(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function mt(e,t){let n=t?e.left:e.right;return{left:n,right:n,top:e.top,bottom:e.bottom}}function gt(e){let t=e.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}function Ot(e,t){let n=t.width/e.offsetWidth,i=t.height/e.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(t.width-e.offsetWidth)<1)&&(n=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.height-e.offsetHeight)<1)&&(i=1),{scaleX:n,scaleY:i}}var yt,vt=null;function bt(e){if(e.setActive)return e.setActive();if(vt)return e.focus(vt);let t=[];for(let n=e;n&&(t.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(e.focus(null==vt?{get preventScroll(){return vt={preventScroll:!0},!0}}:void 0),!vt){vt=!1;for(let e=0;e<t.length;){let n=t[e++],i=t[e++],r=t[e++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=r&&(n.scrollLeft=r)}}}function wt(e,t,n=t){let i=yt||(yt=document.createRange());return i.setEnd(e,n),i.setStart(e,t),i}function xt(e,t,n,i){let r={key:t,code:t,keyCode:n,which:n,cancelable:!0};i&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=i);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,e.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,e.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function St(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0])}function kt(e){return e.scrollTop>Math.max(1,e.scrollHeight-e.clientHeight-4)}function At(e,t){for(let n=e,i=t;;){if(3==n.nodeType&&i>0)return{node:n,offset:i};if(1==n.nodeType&&i>0){if("false"==n.contentEditable)return null;n=n.childNodes[i-1],i=ft(n)}else{if(!n.parentNode||dt(n))return null;i=ut(n),n=n.parentNode}}}function Ct(e,t){for(let n=e,i=t;;){if(3==n.nodeType&&i<n.nodeValue.length)return{node:n,offset:i};if(1==n.nodeType&&i<n.childNodes.length){if("false"==n.contentEditable)return null;n=n.childNodes[i],i=0}else{if(!n.parentNode||dt(n))return null;i=ut(n)+1,n=n.parentNode}}}var _t=class e{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(t,n){return new e(t.parentNode,ut(t),n)}static after(t,n){return new e(t.parentNode,ut(t)+1,n)}},Et=[],Tt=class e{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(t,n){if(2&this.flags){let i,r=this.dom,s=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=s?s.nextSibling:r.firstChild)){let t=e.get(i);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(t,n),o.flags&=-8}if(i=s?s.nextSibling:r.firstChild,n&&!n.written&&n.node==r&&i!=o.dom&&(n.written=!0),o.dom.parentNode==r)for(;i&&i!=o.dom;)i=Pt(i);else r.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:r.firstChild,i&&n&&n.node==r&&(n.written=!0);i;)i=Pt(i)}else if(1&this.flags)for(let e of this.children)7&e.flags&&(e.sync(t,n),e.flags&=-8)}reuseDOM(e){}localPosFromDOM(t,n){let i;if(t==this.dom)i=this.dom.childNodes[n];else{let e=0==ft(t)?0:0==n?-1:1;for(;;){let n=t.parentNode;if(n==this.dom)break;0==e&&n.firstChild!=n.lastChild&&(e=t==n.firstChild?-1:1),t=n}i=e<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!e.get(i);)i=i.nextSibling;if(!i)return this.length;for(let e=0,t=0;;e++){let n=this.children[e];if(n.dom==i)return t;t+=n.length+n.breakAfter}}domBoundsAround(e,t,n=0){let i=-1,r=-1,s=-1,o=-1;for(let a=0,l=n,h=n;a<this.children.length;a++){let n=this.children[a],c=l+n.length;if(l<e&&c>t)return n.domBoundsAround(e,t,l);if(c>=e&&-1==i&&(i=a,r=l),l>t&&n.dom.parentNode==this.dom){s=a,o=h;break}h=c,l=c+n.breakAfter}return{from:r,to:o<0?n+this.length:o,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),1&t.flags)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,7&this.flags&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=Et){this.markDirty();for(let i=e;i<t;i++){let e=this.children[i];e.parent==this&&n.indexOf(e)<0&&e.destroy()}this.children.splice(e,t-e,...n);for(let e=0;e<n.length;e++)n[e].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new $t(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,i,r,s){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!(8&(this.flags|e.flags))}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}};function Pt(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}Tt.prototype.breakAfter=0;var $t=class{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}};function Nt(e,t,n,i,r,s,o,a,l){let{children:h}=e,c=h.length?h[t]:null,u=s.length?s[s.length-1]:null,d=u?u.breakAfter:o;if(!(t==i&&c&&!o&&!d&&s.length<2&&c.merge(n,r,s.length?u:null,0==n,a,l))){if(i<h.length){let e=h[i];e&&(r<e.length||e.breakAfter&&u?.breakAfter)?(t==i&&(e=e.split(r),r=0),!d&&u&&e.merge(0,r,u,!0,0,l)?s[s.length-1]=e:((r||e.children.length&&!e.children[0].length)&&e.merge(0,r,null,!1,0,l),s.push(e))):e?.breakAfter&&(u?u.breakAfter=1:o=1),i++}for(c&&(c.breakAfter=o,n>0&&(!o&&s.length&&c.merge(n,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(n<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(n,c.length,null,!1,a,0),t++));t<i&&s.length;)if(h[i-1].become(s[s.length-1]))i--,s.pop(),l=s.length?0:a;else{if(!h[t].become(s[0]))break;t++,s.shift(),a=s.length?0:l}!s.length&&t&&i<h.length&&!h[t-1].breakAfter&&h[i].merge(0,0,h[t-1],!1,a,l)&&t--,(t<i||s.length)&&e.replaceChildren(t,i,s)}}function It(e,t,n,i,r,s){let o=e.childCursor(),{i:a,off:l}=o.findPos(n,1),{i:h,off:c}=o.findPos(t,-1),u=t-n;for(let e of i)u+=e.length;e.length+=u,Nt(e,h,c,a,l,i,0,r,s)}var Qt=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Rt=typeof document<"u"?document:{documentElement:{style:{}}},Mt=/Edge\/(\d+)/.exec(Qt.userAgent),Bt=/MSIE \d/.test(Qt.userAgent),Dt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Qt.userAgent),Xt=!!(Bt||Dt||Mt),Ft=!Xt&&/gecko\/(\d+)/i.test(Qt.userAgent),Lt=!Xt&&/Chrome\/(\d+)/.exec(Qt.userAgent),Ut="webkitFontSmoothing"in Rt.documentElement.style,Vt=!Xt&&/Apple Computer/.test(Qt.vendor),zt=Vt&&(/Mobile\/\w+/.test(Qt.userAgent)||Qt.maxTouchPoints>2),Zt={mac:zt||/Mac/.test(Qt.platform),windows:/Win/.test(Qt.platform),linux:/Linux|X11/.test(Qt.platform),ie:Xt,ie_version:Bt?Rt.documentMode||6:Dt?+Dt[1]:Mt?+Mt[1]:0,gecko:Ft,gecko_version:Ft?+(/Firefox\/(\d+)/.exec(Qt.userAgent)||[0,0])[1]:0,chrome:!!Lt,chrome_version:Lt?+Lt[1]:0,ios:zt,android:/Android\b/.test(Qt.userAgent),webkit:Ut,safari:Vt,webkit_version:Ut?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=Rt.documentElement.style.tabSize?"tab-size":"-moz-tab-size"},jt=class e extends Tt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){3==e.nodeType&&this.createDOM(e)}merge(t,n,i){return!(8&this.flags||i&&(!(i instanceof e)||this.length-(n-t)+i.length>256||8&i.flags))&&(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(n),this.markDirty(),!0)}split(t){let n=new e(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),n.flags|=8&this.flags,n}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new _t(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return function(e,t,n){let i=e.nodeValue.length;t>i&&(t=i);let r=t,s=t,o=0;0==t&&n<0||t==i&&n>=0?Zt.chrome||Zt.gecko||(t?(r--,o=1):s<i&&(s++,o=-1)):n<0?r--:s<i&&s++;let a=wt(e,r,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:n>=0)?0:a.length-1];return Zt.safari&&!o&&0==l.width&&(l=Array.prototype.find.call(a,(e=>e.width))||l),o?mt(l,o<0):l||null}(this.dom,e,t)}},qt=class e extends Tt{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let e of t)e.setParent(this)}setAttrs(e){if(St(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!(8&(this.flags|e.flags))}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(t,n,i,r,s,o){return(!i||!(!(i instanceof e&&i.mark.eq(this.mark))||t&&s<=0||n<this.length&&o<=0))&&(It(this,t,n,i?i.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(t){let n=[],i=0,r=-1,s=0;for(let e of this.children){let o=i+e.length;o>t&&n.push(i<t?e.split(t-i):e),r<0&&i>=t&&(r=s),i=o,s++}let o=this.length-t;return this.length=t,r>-1&&(this.children.length=r,this.markDirty()),new e(this.mark,n,o)}domAtPos(e){return Ht(this,e)}coordsAt(e,t){return Jt(this,e,t)}};var Gt=class e extends Tt{static create(t,n,i){return new e(t,n,i)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(t){let n=e.create(this.widget,this.length-t,this.side);return this.length-=t,n}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,n,i,r,s,o){return!(i&&(!(i instanceof e&&this.widget.compare(i.widget))||t>0&&s<=0||n<this.length&&o<=0))&&(this.length=t+(i?i.length:0)+(this.length-n),!0)}become(t){return t instanceof e&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return a.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,i=this.posAtStart;return n?n.slice(i,i+this.length):a.empty}domAtPos(e){return(this.length?0==e:this.side>0)?_t.before(this.dom):_t.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let i=this.dom.getClientRects(),r=null;if(!i.length)return null;let s=this.side?this.side<0:e>0;for(let t=s?i.length-1:0;r=i[t],!(e>0?0==t:t==i.length-1||r.top<r.bottom);t+=s?-1:1);return mt(r,!s)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},Wt=class e extends Tt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(t){return t instanceof e&&t.side==this.side}split(){return new e(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?_t.before(this.dom):_t.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return a.empty}get isHidden(){return!0}};function Ht(e,t){let n=e.dom,{children:i}=e,r=0;for(let e=0;r<i.length;r++){let s=i[r],o=e+s.length;if(!(o==e&&s.getSide()<=0)){if(t>e&&t<o&&s.dom.parentNode==n)return s.domAtPos(t-e);if(t<=e)break;e=o}}for(let e=r;e>0;e--){let t=i[e-1];if(t.dom.parentNode==n)return t.domAtPos(t.length)}for(let e=r;e<i.length;e++){let t=i[e];if(t.dom.parentNode==n)return t.domAtPos(0)}return new _t(n,0)}function Yt(e,t,n){let i,{children:r}=e;n>0&&t instanceof qt&&r.length&&(i=r[r.length-1])instanceof qt&&i.mark.eq(t.mark)?Yt(i,t.children[0],n-1):(r.push(t),t.setParent(e)),e.length+=t.length}function Jt(e,t,n){let i=null,r=-1,s=null,o=-1;!function e(t,a){for(let l=0,h=0;l<t.children.length&&h<=a;l++){let c=t.children[l],u=h+c.length;u>=a&&(c.children.length?e(c,a-h):(!s||s.isHidden&&n>0)&&(u>a||h==u&&c.getSide()>0)?(s=c,o=a-h):(h<a||h==u&&c.getSide()<0&&!c.isHidden)&&(i=c,r=a-h)),h=u}}(e,t);let a=(n<0?i:s)||i||s;return a?a.coordsAt(Math.max(0,a==i?r:o),n):function(e){let t=e.dom.lastChild;if(!t)return e.dom.getBoundingClientRect();let n=ht(t);return n[n.length-1]||null}(e)}function Kt(e,t){for(let n in e)"class"==n&&t.class?t.class+=" "+e.class:"style"==n&&t.style?t.style+=";"+e.style:t[n]=e[n];return t}jt.prototype.children=Gt.prototype.children=Wt.prototype.children=Et;var en=Object.create(null);function tn(e,t,n){if(e==t)return!0;e||(e=en),t||(t=en);let i=Object.keys(e),r=Object.keys(t);if(i.length-(n&&i.indexOf(n)>-1?1:0)!=r.length-(n&&r.indexOf(n)>-1?1:0))return!1;for(let s of i)if(s!=n&&(-1==r.indexOf(s)||e[s]!==t[s]))return!1;return!0}function nn(e,t,n){let i=!1;if(t)for(let r in t)n&&r in n||(i=!0,"style"==r?e.style.cssText="":e.removeAttribute(r));if(n)for(let r in n)t&&t[r]==n[r]||(i=!0,"style"==r?e.style.cssText=n[r]:e.setAttribute(r,n[r]));return i}function rn(e){let t=Object.create(null);for(let n=0;n<e.attributes.length;n++){let i=e.attributes[n];t[i.name]=i.value}return t}var sn=class e extends Tt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,n,i,r,s,o){if(i){if(!(i instanceof e))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),It(this,t,n,i?i.children.slice():[],s,o),!0}split(t){let n=new e;if(n.breakAfter=this.breakAfter,0==this.length)return n;let{i:i,off:r}=this.childPos(t);r&&(n.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let e=i;e<this.children.length;e++)n.append(this.children[e],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){tn(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Yt(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=Kt(t,this.attrs||{})),n&&(this.attrs=Kt({class:n},this.attrs||{}))}domAtPos(e){return Ht(this,e)}reuseDOM(e){"DIV"==e.nodeName&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?4&this.flags&&(St(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(nn(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let i=this.dom.lastChild;for(;i&&Tt.get(i)instanceof qt;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(n=Tt.get(i))||void 0===n?void 0:n.isEditable)||Zt.ios&&this.children.some((e=>e instanceof jt))))){let e=document.createElement("BR");e.cmIgnore=!0,this.dom.appendChild(e)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let e,t=0;for(let n of this.children){if(!(n instanceof jt)||/[^ -~]/.test(n.text))return null;let i=ht(n.dom);if(1!=i.length)return null;t+=i[0].width,e=i[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(e,t){let n=Jt(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:e}=this.parent.view.viewState,t=n.bottom-n.top;if(Math.abs(t-e.lineHeight)<2&&e.textHeight<t){let i=(t-e.textHeight)/2;return{top:n.top+i,bottom:n.bottom-i,left:n.left,right:n.left}}}return n}become(e){return!1}covers(){return!0}static find(t,n){for(let i=0,r=0;i<t.children.length;i++){let s=t.children[i],o=r+s.length;if(o>=n){if(s instanceof e)return s;if(o>n)break}r=o+s.breakAfter}return null}},on=class e extends Tt{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(t,n,i,r,s,o){return!(i&&(!(i instanceof e&&this.widget.compare(i.widget))||t>0&&s<=0||n<this.length&&o<=0))&&(this.length=t+(i?i.length:0)+(this.length-n),!0)}domAtPos(e){return 0==e?_t.before(this.dom):_t.after(this.dom,e==this.length)}split(t){let n=this.length-t;this.length=t;let i=new e(this.widget,n,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return Et}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):a.empty}domBoundsAround(){return null}become(t){return t instanceof e&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t!=n&&(e<0?t<0:n>0)}},an=class{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}},ln=function(e){return e[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange",e}(ln||(ln={})),hn=class extends $e{constructor(e,t,n,i){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(e){return new cn(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new dn(e,t,t,n,e.widget||null,!1)}static replace(e){let t,n,i=!!e.block;if(e.isBlockGap)t=-5e8,n=4e8;else{let{start:r,end:s}=pn(e,i);t=(r?i?-3e8:-1:5e8)-1,n=1+(s?i?2e8:1:-6e8)}return new dn(e,t,n,i,e.widget||null,!0)}static line(e){return new un(e)}static set(e,t=!1){return Qe.of(e,t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}};hn.none=Qe.empty;var cn=class e extends hn{constructor(e){let{start:t,end:n}=pn(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(t){var n,i;return this==t||t instanceof e&&this.tagName==t.tagName&&(this.class||(null===(n=this.attrs)||void 0===n?void 0:n.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&tn(this.attrs,t.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}};cn.prototype.point=!1;var un=class e extends hn{constructor(e){super(-2e8,-2e8,null,e)}eq(t){return t instanceof e&&this.spec.class==t.spec.class&&tn(this.spec.attributes,t.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}};un.prototype.mapMode=T.TrackBefore,un.prototype.point=!0;var dn=class e extends hn{constructor(e,t,n,i,r,s){super(t,n,r,e),this.block=i,this.isReplace=s,this.mapMode=i?t<=0?T.TrackBefore:T.TrackAfter:T.TrackDel}get type(){return this.startSide!=this.endSide?ln.WidgetRange:this.startSide<=0?ln.WidgetBefore:ln.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof e&&function(e,t){return e==t||!!(e&&t&&e.compare(t))}(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}};function pn(e,t=!1){let{inclusiveStart:n,inclusiveEnd:i}=e;return null==n&&(n=e.inclusive),null==i&&(i=e.inclusive),{start:n??t,end:i??t}}function fn(e,t,n,i=0){let r=n.length-1;r>=0&&n[r]+i>=e?n[r]=Math.max(n[r],t):n.push(e,t)}dn.prototype.point=!0;var mn=class e{constructor(e,t,n,i){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof on&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new sn),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(gn(new Wt(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof on)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:t,lineBreak:n,done:i}=this.cursor.next(this.skip);if(this.skip=0,i)throw new Error("Ran out of text content when drawing inline views");if(n){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}this.text=t,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(gn(new jt(this.text.slice(this.textOff,this.textOff+i)),t),n),this.atCursorPos=!0,this.textOff+=i,e-=i,n=0}}span(e,t,n,i){this.buildText(t-e,n,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,n,i,r,s){if(this.disallowBlockEffectsFor[s]&&n instanceof dn){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(n instanceof dn)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new on(n.widget||On.block,o,n));else{let s=Gt.create(n.widget||On.inline,o,o?0:n.startSide),a=this.atCursorPos&&!s.isEditable&&r<=i.length&&(e<t||n.startSide>0),l=!s.isEditable&&(e<t||r>i.length||n.startSide<=0),h=this.getLine();2==this.pendingBuffer&&!a&&!s.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),a&&(h.append(gn(new Wt(1),i),r),r=i.length+Math.max(0,r-i.length)),h.append(gn(s,i),r),this.atCursorPos=l,this.pendingBuffer=l?e<t||r>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=r)}static build(t,n,i,r,s){let o=new e(t,n,i,s);return o.openEnd=Qe.spans(r,n,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}};function gn(e,t){for(let n of t)e=new qt(n,[e],e.length);return e}var On=class extends an{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}};On.inline=new On("span"),On.block=new On("div");var yn=function(e){return e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e}(yn||(yn={})),vn=yn.LTR,bn=yn.RTL;function wn(e){let t=[];for(let n=0;n<e.length;n++)t.push(1<<+e[n]);return t}var xn=wn("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Sn=wn("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),kn=Object.create(null),An=[];for(let e of["()","[]","{}"]){let t=e.charCodeAt(0),n=e.charCodeAt(1);kn[t]=n,kn[n]=-t}function Cn(e){return e<=247?xn[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?Sn[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8204?256:64336<=e&&e<=65023?4:1}var _n=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/,En=class{get dir(){return this.level%2?bn:vn}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,i){let r=-1;for(let s=0;s<e.length;s++){let o=e[s];if(o.from<=t&&o.to>=t){if(o.level==n)return s;(r<0||(0!=i?i<0?o.from<t:o.to>t:e[r].level>o.level))&&(r=s)}}if(r<0)throw new RangeError("Index out of range");return r}};function Tn(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],r=t[n];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!Tn(i.inner,r.inner))return!1}return!0}var Pn=[];function $n(e,t,n,i,r,s,o){let a=i%2?2:1;if(i%2==r%2)for(let l=t,h=0;l<n;){let t=!0,c=!1;if(h==s.length||l<s[h].from){let e=Pn[l];e!=a&&(t=!1,c=16==e)}let u=t||1!=a?null:[],d=t?i:i+1,p=l;e:for(;;)if(h<s.length&&p==s[h].from){if(c)break e;let f=s[h];if(!t)for(let e=f.to,t=h+1;;){if(e==n)break e;if(!(t<s.length&&s[t].from==e)){if(Pn[e]==a)break e;break}e=s[t++].to}if(h++,u)u.push(f);else{f.from>l&&o.push(new En(l,f.from,d)),Nn(e,f.direction==vn!=!(d%2)?i+1:i,r,f.inner,f.from,f.to,o),l=f.to}p=f.to}else{if(p==n||(t?Pn[p]!=a:Pn[p]==a))break;p++}u?$n(e,l,p,i+1,r,u,o):l<p&&o.push(new En(l,p,d)),l=p}else for(let l=n,h=s.length;l>t;){let n=!0,c=!1;if(!h||l>s[h-1].to){let e=Pn[l-1];e!=a&&(n=!1,c=16==e)}let u=n||1!=a?null:[],d=n?i:i+1,p=l;e:for(;;)if(h&&p==s[h-1].to){if(c)break e;let f=s[--h];if(!n)for(let e=f.from,n=h;;){if(e==t)break e;if(!n||s[n-1].to!=e){if(Pn[e-1]==a)break e;break}e=s[--n].from}if(u)u.push(f);else{f.to<l&&o.push(new En(f.to,l,d)),Nn(e,f.direction==vn!=!(d%2)?i+1:i,r,f.inner,f.from,f.to,o),l=f.from}p=f.from}else{if(p==t||(n?Pn[p-1]!=a:Pn[p-1]==a))break;p--}u?$n(e,p,l,i+1,r,u,o):p<l&&o.push(new En(p,l,d)),l=p}}function Nn(e,t,n,i,r,s,o){let a=t%2?2:1;(function(e,t,n,i,r){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:t,a=s<i.length?i[s].from:n,l=s?256:r;for(let t=o,n=l,i=l;t<a;t++){let r=Cn(e.charCodeAt(t));512==r?r=n:8==r&&4==i&&(r=16),Pn[t]=4==r?2:r,7&r&&(i=r),n=r}for(let e=o,t=l,i=l;e<a;e++){let r=Pn[e];if(128==r)e<a-1&&t==Pn[e+1]&&24&t?r=Pn[e]=t:Pn[e]=256;else if(64==r){let r=e+1;for(;r<a&&64==Pn[r];)r++;let s=e&&8==t||r<n&&8==Pn[r]?1==i?1:8:256;for(let t=e;t<r;t++)Pn[t]=s;e=r-1}else 8==r&&1==i&&(Pn[e]=1);t=r,7&r&&(i=r)}}})(e,r,s,i,a),function(e,t,n,i,r){let s=1==r?2:1;for(let o=0,a=0,l=0;o<=i.length;o++){let h=o?i[o-1].to:t,c=o<i.length?i[o].from:n;for(let t,n,i,o=h;o<c;o++)if(n=kn[t=e.charCodeAt(o)])if(n<0){for(let e=a-3;e>=0;e-=3)if(An[e+1]==-n){let t=An[e+2],n=2&t?r:4&t?1&t?s:r:0;n&&(Pn[o]=Pn[An[e]]=n),a=e;break}}else{if(189==An.length)break;An[a++]=o,An[a++]=t,An[a++]=l}else if(2==(i=Pn[o])||1==i){let e=i==r;l=e?0:1;for(let t=a-3;t>=0;t-=3){let n=An[t+2];if(2&n)break;if(e)An[t+2]|=2;else{if(4&n)break;An[t+2]|=4}}}}}(e,r,s,i,a),function(e,t,n,i){for(let r=0,s=i;r<=n.length;r++){let o=r?n[r-1].to:e,a=r<n.length?n[r].from:t;for(let l=o;l<a;){let o=Pn[l];if(256==o){let o=l+1;for(;;)if(o==a){if(r==n.length)break;o=n[r++].to,a=r<n.length?n[r].from:t}else{if(256!=Pn[o])break;o++}let h=1==s,c=h==(1==(o<t?Pn[o]:i))?h?1:2:i;for(let t=o,i=r,s=i?n[i-1].to:e;t>l;)t==s&&(t=n[--i].from,s=i?n[i-1].to:e),Pn[--t]=c;l=o}else s=o,l++}}}(r,s,i,a),$n(e,r,s,t,n,i,o)}function In(e){return[new En(0,e,0)]}var Qn="";function Rn(e,t,n,i,r){var s;let o=i.head-e.from,a=En.find(t,o,null!==(s=i.bidiLevel)&&void 0!==s?s:-1,i.assoc),l=t[a],h=l.side(r,n);if(o==h){let e=a+=r?1:-1;if(e<0||e>=t.length)return null;l=t[a=e],o=l.side(!r,n),h=l.side(r,n)}let c=b(e.text,o,l.forward(r,n));(c<l.from||c>l.to)&&(c=h),Qn=e.text.slice(Math.min(o,c),Math.max(o,c));let u=a==(r?t.length-1:0)?null:t[a+(r?1:-1)];return u&&c==h&&u.level+(r?0:1)<l.level?X.cursor(u.side(!r,n)+e.from,u.forward(r,n)?1:-1,u.level):X.cursor(c+e.from,l.forward(r,n)?-1:1,l.level)}function Mn(e,t,n){for(let i=t;i<n;i++){let t=Cn(e.charCodeAt(i));if(1==t)return vn;if(2==t||4==t)return bn}return vn}var Bn=U.define(),Dn=U.define(),Xn=U.define(),Fn=U.define(),Ln=U.define(),Un=U.define(),Vn=U.define(),zn=U.define({combine:e=>e.some((e=>e))}),Zn=U.define({combine:e=>e.some((e=>e))}),jn=U.define(),qn=class e{constructor(e,t="nearest",n="nearest",i=5,r=5,s=!1){this.range=e,this.y=t,this.x=n,this.yMargin=i,this.xMargin=r,this.isSnapshot=s}map(t){return t.empty?this:new e(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new e(X.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}},Gn=Oe.define({map:(e,t)=>e.map(t)});function Wn(e,t,n){let i=e.facet(Fn);i.length?i[0](t):window.onerror&&window.onerror(String(t),n,void 0,void 0,t)}var Hn=U.define({combine:e=>!e.length||e[0]}),Yn=0,Jn=U.define(),Kn=class e{constructor(e,t,n,i,r){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=i,this.extension=r(this)}static define(t,n){let{eventHandlers:i,eventObservers:r,provide:s,decorations:o}=n||{};return new e(Yn++,t,i,r,(e=>{let t=[Jn.of(e)];return o&&t.push(ii.of((t=>{let n=t.plugin(e);return n?o(n):hn.none}))),s&&t.push(s(e)),t}))}static fromClass(t,n){return e.define((e=>new t(e)),n)}},ei=class{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(t){if(Wn(e.state,t,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Wn(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(null!==(t=this.value)&&void 0!==t&&t.destroy)try{this.value.destroy()}catch(t){Wn(e.state,t,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}},ti=U.define(),ni=U.define(),ii=U.define(),ri=U.define(),si=U.define(),oi=U.define();function ai(e,t){let n=e.state.facet(oi);if(!n.length)return n;let i=n.map((t=>t instanceof Function?t(e):t)),r=[];return Qe.spans(i,t.from,t.to,{point(){},span(e,n,i,s){let o=e-t.from,a=n-t.from,l=r;for(let e=i.length-1;e>=0;e--,s--){let n,r=i[e].spec.bidiIsolate;if(null==r&&(r=Mn(t.text,o,a)),s>0&&l.length&&(n=l[l.length-1]).to==o&&n.direction==r)n.to=a,l=n.inner;else{let e={from:o,to:a,direction:r,inner:[]};l.push(e),l=e.inner}}}}),r}var li=U.define();function hi(e){let t=0,n=0,i=0,r=0;for(let s of e.state.facet(li)){let o=s(e);o&&(null!=o.left&&(t=Math.max(t,o.left)),null!=o.right&&(n=Math.max(n,o.right)),null!=o.top&&(i=Math.max(i,o.top)),null!=o.bottom&&(r=Math.max(r,o.bottom)))}return{left:t,right:n,top:i,bottom:r}}var ci=U.define(),ui=class e{constructor(e,t,n,i){this.fromA=e,this.toA=t,this.fromB=n,this.toB=i}join(t){return new e(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(t,n){if(0==n.length)return t;let i=[];for(let r=0,s=0,o=0,a=0;;r++){let l=r==t.length?null:t[r],h=o-a,c=l?l.fromB:1e9;for(;s<n.length&&n[s]<c;){let t=n[s],r=n[s+1],o=Math.max(a,t),l=Math.min(c,r);if(o<=l&&new e(o+h,l+h,o,l).addToSet(i),r>c)break;s+=2}if(!l)return i;new e(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,a=l.toB}}},di=class e{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=$.empty(this.startState.doc.length);for(let e of n)this.changes=this.changes.compose(e.changes);let i=[];this.changes.iterChangedRanges(((e,t,n,r)=>i.push(new ui(e,t,n,r)))),this.changedRanges=i}static create(t,n,i){return new e(t,n,i)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((e=>e.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}},pi=class extends Tt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.compositionBarrier=hn.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new sn],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ui(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every((({fromA:e,toA:t})=>t<this.minWidthFrom||e>this.minWidthTo))?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let i=-1;this.view.inputState.composing>=0&&(null!==(t=this.domChanged)&&void 0!==t&&t.newSel?i=this.domChanged.newSel.head:!function(e,t){let n=!1;return t&&e.iterChangedRanges(((e,i)=>{e<t.to&&i>t.from&&(n=!0)})),n}(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let r=i>-1?function(e,t,n){let i=gi(e,n);if(!i)return null;let{node:r,from:s,to:o}=i,a=r.nodeValue;if(/[\n\r]/.test(a)||e.state.doc.sliceString(i.from,i.to)!=a)return null;let l=t.invertedDesc,h=new ui(l.mapPos(s),l.mapPos(o),s,o),c=[];for(let t=r.parentNode;;t=t.parentNode){let n=Tt.get(t);if(n instanceof qt)c.push({node:t,deco:n.mark});else{if(n instanceof sn||"DIV"==t.nodeName&&t.parentNode==e.contentDOM)return{range:h,text:r,marks:c,line:t};if(t==e.contentDOM)return null;c.push({node:t,deco:new cn({inclusive:!0,attributes:rn(t),tagName:t.tagName.toLowerCase()})})}}}(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:t,to:i}=this.hasComposition;n=new ui(t,i,e.changes.mapPos(t,-1),e.changes.mapPos(i,1)).addToSet(n.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(Zt.ie||Zt.chrome)&&!r&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let s=function(e,t,n){let i=new class{constructor(){this.changes=[]}compareRange(e,t){fn(e,t,this.changes)}comparePoint(e,t){fn(e,t,this.changes)}};return Qe.compare(e,t,n,i),i.changes}(this.decorations,this.updateDeco(),e.changes);return n=ui.extendWithRanges(n,s),!!(7&this.flags||0!=n.length)&&(this.updateInner(n,e.startState.doc.length,r),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:i}=this.view;i.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let e=Zt.chrome||Zt.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,e),this.flags&=-8,e&&(e.written||i.selectionRange.focusNode!=e.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((e=>e.flags&=-9));let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let e of this.children)e instanceof on&&e.widget instanceof mi&&r.push(e.dom);i.updateGaps(r)}updateChildren(e,t,n){let i=n?n.range.addToSet(e.slice()):e,r=this.childCursor(t);for(let e=i.length-1;;e--){let t=e>=0?i[e]:null;if(!t)break;let s,o,a,l,{fromA:h,toA:c,fromB:u,toB:d}=t;if(n&&n.range.fromB<d&&n.range.toB>u){let e=mn.build(this.view.state.doc,u,n.range.fromB,this.decorations,this.dynamicDecorationMap),t=mn.build(this.view.state.doc,n.range.toB,d,this.decorations,this.dynamicDecorationMap);o=e.breakAtStart,a=e.openStart,l=t.openEnd;let i=this.compositionView(n);t.breakAtStart?i.breakAfter=1:t.content.length&&i.merge(i.length,i.length,t.content[0],!1,t.openStart,0)&&(i.breakAfter=t.content[0].breakAfter,t.content.shift()),e.content.length&&i.merge(0,0,e.content[e.content.length-1],!0,0,e.openEnd)&&e.content.pop(),s=e.content.concat(i).concat(t.content)}else({content:s,breakAtStart:o,openStart:a,openEnd:l}=mn.build(this.view.state.doc,u,d,this.decorations,this.dynamicDecorationMap));let{i:p,off:f}=r.findPos(c,1),{i:m,off:g}=r.findPos(h,-1);Nt(this,m,g,p,f,s,o,a,l)}n&&this.fixCompositionDOM(n)}compositionView(e){let t=new jt(e.text.nodeValue);t.flags|=8;for(let{deco:n}of e.marks)t=new qt(n,[t],t.length);let n=new sn;return n.append(t,0),n}fixCompositionDOM(e){let t=(e,t)=>{t.flags|=8|(t.children.some((e=>7&e.flags))?1:0),this.markedForComposition.add(t);let n=Tt.get(e);n&&n!=t&&(n.dom=null),t.setDOM(e)},n=this.childPos(e.range.fromB,1),i=this.children[n.i];t(e.line,i);for(let r=e.marks.length-1;r>=-1;r--)n=i.childPos(n.off,1),i=i.children[n.i],t(r>=0?e.marks[r].node:e.text,i)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,i=n==this.dom,r=!i&&lt(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(i||t||r))return;let s=this.forceSelection;this.forceSelection=!1;let o=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(o.anchor)),l=o.empty?a:this.moveToLine(this.domAtPos(o.head));if(Zt.gecko&&o.empty&&!this.hasComposition&&function(e){return 1==e.node.nodeType&&e.node.firstChild&&(0==e.offset||"false"==e.node.childNodes[e.offset-1].contentEditable)&&(e.offset==e.node.childNodes.length||"false"==e.node.childNodes[e.offset].contentEditable)}(a)){let e=document.createTextNode("");this.view.observer.ignore((()=>a.node.insertBefore(e,a.node.childNodes[a.offset]||null))),a=l=new _t(e,0),s=!0}let h=this.view.observer.selectionRange;(s||!h.focusNode||(!ct(a.node,a.offset,h.anchorNode,h.anchorOffset)||!ct(l.node,l.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,o))&&(this.view.observer.ignore((()=>{Zt.android&&Zt.chrome&&this.dom.contains(h.focusNode)&&function(e,t){for(let n=e;n&&n!=t;n=n.assignedSlot||n.parentNode)if(1==n.nodeType&&"false"==n.contentEditable)return!0;return!1}(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let e=ot(this.view.root);if(e)if(o.empty){if(Zt.gecko){let e=function(e,t){return 1!=e.nodeType?0:(t&&"false"==e.childNodes[t-1].contentEditable?1:0)|(t<e.childNodes.length&&"false"==e.childNodes[t].contentEditable?2:0)}(a.node,a.offset);if(e&&3!=e){let t=(1==e?At:Ct)(a.node,a.offset);t&&(a=new _t(t.node,t.offset))}}e.collapse(a.node,a.offset),null!=o.bidiLevel&&void 0!==e.caretBidiLevel&&(e.caretBidiLevel=o.bidiLevel)}else if(e.extend){e.collapse(a.node,a.offset);try{e.extend(l.node,l.offset)}catch{}}else{let t=document.createRange();o.anchor>o.head&&([a,l]=[l,a]),t.setEnd(l.node,l.offset),t.setStart(a.node,a.offset),e.removeAllRanges(),e.addRange(t)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())})),this.view.observer.setSelectionRange(a,l)),this.impreciseAnchor=a.precise?null:new _t(h.anchorNode,h.anchorOffset),this.impreciseHead=l.precise?null:new _t(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&!this.compositionBarrier.size&&ct(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=ot(e.root),{anchorNode:i,anchorOffset:r}=e.observer.selectionRange;if(!(n&&t.empty&&t.assoc&&n.modify))return;let s=sn.find(this,t.head);if(!s)return;let o=s.posAtStart;if(t.head==o||t.head==o+s.length)return;let a=this.coordsAt(t.head,-1),l=this.coordsAt(t.head,1);if(!a||!l||a.bottom>l.top)return;let h=this.domAtPos(t.head+t.assoc);n.collapse(h.node,h.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let c=e.observer.selectionRange;e.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=t.from&&n.collapse(i,r)}moveToLine(e){let t,n=this.dom;if(e.node!=n)return e;for(let i=e.offset;!t&&i<n.childNodes.length;i++){let e=Tt.get(n.childNodes[i]);e instanceof sn&&(t=e.domAtPos(0))}for(let i=e.offset-1;!t&&i>=0;i--){let e=Tt.get(n.childNodes[i]);e instanceof sn&&(t=e.domAtPos(e.length))}return t?new _t(t.node,t.offset,!0):e}nearest(e){for(let t=e;t;){let e=Tt.get(t);if(e&&e.rootView==this)return e;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let e=this.children[t];if(n<e.length||e instanceof sn)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,i=0;for(let r=this.length,s=this.children.length-1;s>=0;s--){let o=this.children[s],a=r-o.breakAfter,l=a-o.length;if(a<e)break;l<=e&&(l<e||o.covers(-1))&&(a>e||o.covers(1))&&(!n||o instanceof sn&&!(n instanceof sn&&t>=0))&&(n=o,i=l),r=l}return n?n.coordsAt(e-i,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),i=this.children[t];if(!(i instanceof sn))return null;for(;i.children.length;){let{i:e,off:t}=i.childPos(n,1);for(;;e++){if(e==i.children.length)return null;if((i=i.children[e]).length)break}n=t}if(!(i instanceof jt))return null;let r=b(i.text,n);if(r==n)return null;let s=wt(i.dom,n,r).getClientRects();for(let e=0;e<s.length;e++){let t=s[e];if(e==s.length-1||t.top<t.bottom&&t.left<t.right)return t}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:i}=e,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,a=this.view.textDirection==yn.LTR;for(let e=0,l=0;l<this.children.length;l++){let h=this.children[l],c=e+h.length;if(c>i)break;if(e>=n){let n=h.dom.getBoundingClientRect();if(t.push(n.height),s){let t=h.dom.lastChild,i=t?ht(t):[];if(i.length){let t=i[i.length-1],s=a?t.right-n.left:n.right-t.left;s>o&&(o=s,this.minWidth=r,this.minWidthFrom=e,this.minWidthTo=c)}}}e=c+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return"rtl"==getComputedStyle(this.children[t].dom).direction?yn.RTL:yn.LTR}measureTextSize(){for(let e of this.children)if(e instanceof sn){let t=e.measureTextSize();if(t)return t}let e,t,n,i=document.createElement("div");return i.className="cm-line",i.style.width="99999px",i.style.position="absolute",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(i);let r=ht(i.firstChild)[0];e=i.getBoundingClientRect().height,t=r?r.width/27:7,n=r?r.height:e,i.remove()})),{lineHeight:e,charWidth:t,textHeight:n}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new $t(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,i=0;;i++){let r=i==t.viewports.length?null:t.viewports[i],s=r?r.from-1:this.length;if(s>n){let i=(t.lineBlockAt(s).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(hn.replace({widget:new mi(i),block:!0,inclusive:!0,isBlockGap:!0}).range(n,s))}if(!r)break;n=r.to+1}return hn.set(e)}updateDeco(){let e=1,t=this.view.state.facet(ii).map((t=>(this.dynamicDecorationMap[e++]="function"==typeof t)?t(this.view):t)),n=!1,i=this.view.state.facet(ri).map(((e,t)=>{let i="function"==typeof e;return i&&(n=!0),i?e(this.view):e}));for(i.length&&(this.dynamicDecorationMap[e++]=n,t.push(Qe.join(i))),this.decorations=[this.compositionBarrier,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}maybeCreateCompositionBarrier(){let{main:{head:e,empty:t}}=this.view.state.selection;if(!t)return!1;let n=null;for(let t of this.decorations)if(t.between(e,e,((t,i,r)=>{r.point?n=!1:r.endSide<0&&t<e&&i==e&&(n=!0)})),!1===n)break;return this.compositionBarrier=n?hn.set(fi.range(e)):hn.none,!!n}clearCompositionBarrier(){this.compositionBarrier=hn.none}scrollIntoView(e){if(e.isSnapshot){let t=this.view.viewState.lineBlockAt(e.range.head);return this.view.scrollDOM.scrollTop=t.top-e.yMargin,void(this.view.scrollDOM.scrollLeft=e.xMargin)}for(let t of this.view.state.facet(jn))try{if(t(this.view,e.range,e))return!0}catch(e){Wn(this.view.state,e,"scroll handler")}let t,{range:n}=e,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1);if(!i)return;!n.empty&&(t=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,t.left),top:Math.min(i.top,t.top),right:Math.max(i.right,t.right),bottom:Math.max(i.bottom,t.bottom)});let r=hi(this.view),s={left:i.left-r.left,top:i.top-r.top,right:i.right+r.right,bottom:i.bottom+r.bottom},{offsetWidth:o,offsetHeight:a}=this.view.scrollDOM;!function(e,t,n,i,r,s,o,a){let l=e.ownerDocument,h=l.defaultView||window;for(let c=e,u=!1;c&&!u;)if(1==c.nodeType){let e,d=c==l.body,p=1,f=1;if(d)e=gt(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(u=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let t=c.getBoundingClientRect();({scaleX:p,scaleY:f}=Ot(c,t)),e={left:t.left,right:t.left+c.clientWidth*p,top:t.top,bottom:t.top+c.clientHeight*f}}let m=0,g=0;if("nearest"==r)t.top<e.top?(g=-(e.top-t.top+o),n>0&&t.bottom>e.bottom+g&&(g=t.bottom-e.bottom+g+o)):t.bottom>e.bottom&&(g=t.bottom-e.bottom+o,n<0&&t.top-g<e.top&&(g=-(e.top+g-t.top+o)));else{let i=t.bottom-t.top,s=e.bottom-e.top;g=("center"==r&&i<=s?t.top+i/2-s/2:"start"==r||"center"==r&&n<0?t.top-o:t.bottom-s+o)-e.top}if("nearest"==i?t.left<e.left?(m=-(e.left-t.left+s),n>0&&t.right>e.right+m&&(m=t.right-e.right+m+s)):t.right>e.right&&(m=t.right-e.right+s,n<0&&t.left<e.left+m&&(m=-(e.left+m-t.left+s))):m=("center"==i?t.left+(t.right-t.left)/2-(e.right-e.left)/2:"start"==i==a?t.left-s:t.right-(e.right-e.left)+s)-e.left,m||g)if(d)h.scrollBy(m,g);else{let e=0,n=0;if(g){let e=c.scrollTop;c.scrollTop+=g/f,n=(c.scrollTop-e)*f}if(m){let t=c.scrollLeft;c.scrollLeft+=m/p,e=(c.scrollLeft-t)*p}t={left:t.left-e,top:t.top-n,right:t.right-e,bottom:t.bottom-n},e&&Math.abs(e-m)<1&&(i="nearest"),n&&Math.abs(n-g)<1&&(r="nearest")}if(d)break;c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,s,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==yn.LTR)}},fi=hn.widget({side:-1,widget:On.inline});var mi=class extends an{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}};function gi(e,t){let n=e.observer.selectionRange;if(!n.focusNode)return null;let i=At(n.focusNode,n.focusOffset),r=Ct(n.focusNode,n.focusOffset),s=i||r;if(r&&i&&r.node!=i.node){let t=Tt.get(r.node);if(!t||t instanceof jt&&t.text!=r.node.nodeValue)s=r;else if(e.docView.lastCompositionAfterCursor){let e=Tt.get(i.node);!e||e instanceof jt&&e.text!=i.node.nodeValue||(s=r)}}if(e.docView.lastCompositionAfterCursor=s!=i,!s)return null;let o=t-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function Oi(e,t){return t.left>e?t.left-e:Math.max(0,e-t.right)}function yi(e,t){return t.top>e?t.top-e:Math.max(0,e-t.bottom)}function vi(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function bi(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function wi(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function xi(e,t,n){let i,r,s,o,a,l,h,c,u=!1;for(let d=e.firstChild;d;d=d.nextSibling){let e=ht(d);for(let p=0;p<e.length;p++){let f=e[p];r&&vi(r,f)&&(f=bi(wi(f,r.bottom),r.top));let m=Oi(t,f),g=yi(n,f);if(0==m&&0==g)return 3==d.nodeType?Si(d,t,n):xi(d,t,n);if(!i||o>g||o==g&&s>m){i=d,r=f,s=m,o=g;let a=g?n<f.top?-1:1:m?t<f.left?-1:1:0;u=!a||(a>0?p<e.length-1:p>0)}0==m?n>f.bottom&&(!h||h.bottom<f.bottom)?(a=d,h=f):n<f.top&&(!c||c.top>f.top)&&(l=d,c=f):h&&vi(h,f)?h=wi(h,f.bottom):c&&vi(c,f)&&(c=bi(c,f.top))}}if(h&&h.bottom>=n?(i=a,r=h):c&&c.top<=n&&(i=l,r=c),!i)return{node:e,offset:0};let d=Math.max(r.left,Math.min(r.right,t));return 3==i.nodeType?Si(i,d,n):u&&"false"!=i.contentEditable?xi(i,d,n):{node:e,offset:Array.prototype.indexOf.call(e.childNodes,i)+(t>=(r.left+r.right)/2?1:0)}}function Si(e,t,n){let i=e.nodeValue.length,r=-1,s=1e9,o=0;for(let a=0;a<i;a++){let i=wt(e,a,a+1).getClientRects();for(let l=0;l<i.length;l++){let h=i[l];if(h.top==h.bottom)continue;o||(o=t-h.left);let c=(h.top>n?h.top-n:n-h.bottom)-1;if(h.left-1<=t&&h.right+1>=t&&c<s){let n=t>=(h.left+h.right)/2,i=n;if((Zt.chrome||Zt.gecko)&&wt(e,a).getBoundingClientRect().left==h.right&&(i=!n),c<=0)return{node:e,offset:a+(i?1:0)};r=a+(i?1:0),s=c}}}return{node:e,offset:r>-1?r:o>0?e.nodeValue.length:0}}function ki(e,t,n,i=-1){var r,s;let o,a=e.contentDOM.getBoundingClientRect(),l=a.top+e.viewState.paddingTop,{docHeight:h}=e.viewState,{x:c,y:u}=t,d=u-l;if(d<0)return 0;if(d>h)return e.state.doc.length;for(let t=e.viewState.heightOracle.textHeight/2,r=!1;o=e.elementAtHeight(d),o.type!=ln.Text;)for(;d=i>0?o.bottom+t:o.top-t,!(d>=0&&d<=h);){if(r)return n?null:0;r=!0,i=-i}u=l+d;let p=o.from;if(p<e.viewport.from)return 0==e.viewport.from?0:n?null:Ai(e,a,o,c,u);if(p>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:n?null:Ai(e,a,o,c,u);let f=e.dom.ownerDocument,m=e.root.elementFromPoint?e.root:f,g=m.elementFromPoint(c,u);g&&!e.contentDOM.contains(g)&&(g=null),g||(c=Math.max(a.left+1,Math.min(a.right-1,c)),g=m.elementFromPoint(c,u),g&&!e.contentDOM.contains(g)&&(g=null));let O,y=-1;if(g&&0!=(null===(r=e.docView.nearest(g))||void 0===r?void 0:r.isEditable))if(f.caretPositionFromPoint){let e=f.caretPositionFromPoint(c,u);e&&({offsetNode:O,offset:y}=e)}else if(f.caretRangeFromPoint){let t=f.caretRangeFromPoint(c,u);t&&(({startContainer:O,startOffset:y}=t),(!e.contentDOM.contains(O)||Zt.safari&&function(e,t,n){let i;if(3!=e.nodeType||t!=(i=e.nodeValue.length))return!1;for(let t=e.nextSibling;t;t=t.nextSibling)if(1!=t.nodeType||"BR"!=t.nodeName)return!1;return wt(e,i-1,i).getBoundingClientRect().left>n}(O,y,c)||Zt.chrome&&function(e,t,n){if(0!=t)return!1;for(let t=e;;){let e=t.parentNode;if(!e||1!=e.nodeType||e.firstChild!=t)return!1;if(e.classList.contains("cm-line"))break;t=e}let i=1==e.nodeType?e.getBoundingClientRect():wt(e,0,Math.max(e.nodeValue.length,1)).getBoundingClientRect();return n-i.left>5}(O,y,c))&&(O=void 0))}if(!O||!e.docView.dom.contains(O)){let t=sn.find(e.docView,p);if(!t)return d>o.top+o.height/2?o.to:o.from;({node:O,offset:y}=xi(t.dom,c,u))}let v=e.docView.nearest(O);if(!v)return null;if(v.isWidget&&1==(null===(s=v.dom)||void 0===s?void 0:s.nodeType)){let e=v.dom.getBoundingClientRect();return t.y<e.top||t.y<=e.bottom&&t.x<=(e.left+e.right)/2?v.posAtStart:v.posAtEnd}return v.localPosFromDOM(O,y)+v.posAtStart}function Ai(e,t,n,i,r){let s=Math.round((i-t.left)*e.defaultCharacterWidth);if(e.lineWrapping&&n.height>1.5*e.defaultLineHeight){let t=e.viewState.heightOracle.textHeight;s+=Math.floor((r-n.top-.5*(e.defaultLineHeight-t))/t)*e.viewState.heightOracle.lineLength}let o=e.state.sliceDoc(n.from,n.to);return n.from+qe(o,s,e.state.tabSize)}function Ci(e,t){let n=e.lineBlockAt(t);if(Array.isArray(n.type))for(let e of n.type)if(e.to>t||e.to==t&&(e.to==n.to||e.type==ln.Text))return e;return n}function _i(e,t,n,i){let r=e.state.doc.lineAt(t.head),s=e.bidiSpans(r),o=e.textDirectionAt(r.from);for(let a=t,l=null;;){let t=Rn(r,s,o,a,n),h=Qn;if(!t){if(r.number==(n?e.state.doc.lines:1))return a;h="\n",r=e.state.doc.line(r.number+(n?1:-1)),s=e.bidiSpans(r),t=e.visualLineSide(r,!n)}if(l){if(!l(h))return a}else{if(!i)return t;l=i(h)}a=t}}function Ei(e,t,n){for(;;){let i=0;for(let r of e)r.between(t-1,t+1,((e,r,s)=>{if(t>e&&t<r){let s=i||n||(t-e<r-t?-1:1);t=s<0?e:r,i=s}}));if(!i)return t}}function Ti(e,t,n){let i=Ei(e.state.facet(si).map((t=>t(e))),n.from,t.head>n.from?-1:1);return i==n.from?n:X.cursor(i,i<n.from?1:-1)}function Pi(e,t){return(n,i)=>{try{return t.call(e,i,n)}catch(e){Wn(n.state,e)}}}var $i=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ni="dthko",Ii=[16,17,18,20,91,92,224,225];function Qi(e){return.7*Math.max(0,e)+8}var Ri=Object.create(null),Mi=Object.create(null),Bi=Zt.ie&&Zt.ie_version<15||Zt.ios&&Zt.webkit_version<604;function Di(e,t){let n,{state:i}=e,r=1,s=i.toText(t),o=s.lines==i.selection.ranges.length;if(null!=Hi&&i.selection.ranges.every((e=>e.empty))&&Hi==s.toString()){let e=-1;n=i.changeByRange((n=>{let a=i.doc.lineAt(n.from);if(a.from==e)return{range:n};e=a.from;let l=i.toText((o?s.line(r++).text:t)+i.lineBreak);return{changes:{from:a.from,insert:l},range:X.cursor(n.from+l.length)}}))}else n=o?i.changeByRange((e=>{let t=s.line(r++);return{changes:{from:e.from,to:e.to,insert:t.text},range:X.cursor(e.from+t.length)}})):i.replaceSelection(s);e.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}function Xi(e,t,n,i){if(1==i)return X.cursor(t,n);if(2==i)return function(e,t,n=1){let i=e.charCategorizer(t),r=e.doc.lineAt(t),s=t-r.from;if(0==r.length)return X.cursor(t);0==s?n=1:s==r.length&&(n=-1);let o=s,a=s;n<0?o=b(r.text,s,!1):a=b(r.text,s);let l=i(r.text.slice(o,a));for(;o>0;){let e=b(r.text,o,!1);if(i(r.text.slice(e,o))!=l)break;o=e}for(;a<r.length;){let e=b(r.text,a);if(i(r.text.slice(a,e))!=l)break;a=e}return X.range(o+r.from,a+r.from)}(e.state,t,n);{let n=sn.find(e.docView,t),i=e.state.doc.lineAt(n?n.posAtEnd:t),r=n?n.posAtStart:i.from,s=n?n.posAtEnd:i.to;return s<e.state.doc.length&&s==i.to&&s++,X.range(r,s)}}Mi.scroll=e=>{e.inputState.lastScrollTop=e.scrollDOM.scrollTop,e.inputState.lastScrollLeft=e.scrollDOM.scrollLeft},Ri.keydown=(e,t)=>(e.inputState.setSelectionOrigin("select"),27==t.keyCode&&(e.inputState.lastEscPress=Date.now()),!1),Mi.touchstart=(e,t)=>{e.inputState.lastTouchTime=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},Mi.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},Ri.mousedown=(e,t)=>{if(e.observer.flush(),e.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let i of e.state.facet(Xn))if(n=i(e,t),n)break;if(!n&&0==t.button&&(n=function(e,t){let n=Vi(e,t),i=Gi(t),r=e.state.selection;return{update(e){e.docChanged&&(n.pos=e.changes.mapPos(n.pos),r=r.map(e.changes))},get(t,s,o){let a,l=Vi(e,t),h=Xi(e,l.pos,l.bias,i);if(n.pos!=l.pos&&!s){let t=Xi(e,n.pos,n.bias,i),r=Math.min(t.from,h.from),s=Math.max(t.to,h.to);h=r<h.from?X.range(r,s):X.range(s,r)}return s?r.replaceRange(r.main.extend(h.from,h.to)):o&&1==i&&r.ranges.length>1&&(a=function(e,t){for(let n=0;n<e.ranges.length;n++){let{from:i,to:r}=e.ranges[n];if(i<=t&&r>=t)return X.create(e.ranges.slice(0,n).concat(e.ranges.slice(n+1)),e.mainIndex==n?0:e.mainIndex-(e.mainIndex>n?1:0))}return null}(r,l.pos))?a:o?r.addRange(h):X.create([h])}}}(e,t)),n){let i=!e.hasFocus;e.inputState.startMouseSelection(new class{constructor(e,t,n,i){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=function(e){let t=e.ownerDocument;for(let n=e.parentNode;n&&n!=t.body;)if(1==n.nodeType){if(n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)return n;n=n.assignedSlot||n.parentNode}else{if(11!=n.nodeType)break;n=n.host}return null}(e.contentDOM),this.atoms=e.state.facet(si).map((t=>t(e)));let r=e.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Te.allowMultipleSelections)&&function(e,t){let n=e.state.facet(Bn);return n.length?n[0](t):Zt.mac?t.metaKey:t.ctrlKey}(e,t),this.dragging=!(!function(e,t){let{main:n}=e.state.selection;if(n.empty)return!1;let i=ot(e.root);if(!i||0==i.rangeCount)return!0;let r=i.getRangeAt(0).getClientRects();for(let e=0;e<r.length;e++){let n=r[e];if(n.left<=t.clientX&&n.right>=t.clientX&&n.top<=t.clientY&&n.bottom>=t.clientY)return!0}return!1}(e,t)||1!=Gi(t))&&null}start(e){!1===this.dragging&&this.select(e)}move(e){var t;if(0==e.buttons)return this.destroy();if(this.dragging||null==this.dragging&&function(e,t){return Math.max(Math.abs(e.clientX-t.clientX),Math.abs(e.clientY-t.clientY))}(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,i=0,r=(null===(t=this.scrollParent)||void 0===t?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},s=hi(this.view);e.clientX-s.left<=r.left+6?n=-Qi(r.left-e.clientX):e.clientX+s.right>=r.right-6&&(n=Qi(e.clientX-r.right)),e.clientY-s.top<=r.top+6?i=-Qi(r.top-e.clientY):e.clientY+s.bottom>=r.bottom-6&&(i=Qi(e.clientY-r.bottom)),this.setScrollSpeed(n,i)}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let i=e.ranges[n],r=null;if(i.empty){let e=Ei(this.atoms,i.from,0);e!=i.from&&(r=X.cursor(e,-1))}else{let e=Ei(this.atoms,i.from,-1),t=Ei(this.atoms,i.to,1);(e!=i.from||t!=i.to)&&(r=X.range(i.from==i.anchor?e:t,i.from==i.head?e:t))}r&&(t||(t=e.ranges.slice()),t[n]=r)}return t?X.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection,!1===this.dragging))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){this.style.update(e)&&setTimeout((()=>this.select(this.lastEvent)),20)}}(e,t,n,i)),i&&e.observer.ignore((()=>bt(e.contentDOM)));let r=e.inputState.mouseSelection;if(r)return r.start(t),!1===r.dragging}return!1};var Fi=(e,t)=>e>=t.top&&e<=t.bottom,Li=(e,t,n)=>Fi(t,n)&&e>=n.left&&e<=n.right;function Ui(e,t,n,i){let r=sn.find(e.docView,t);if(!r)return 1;let s=t-r.posAtStart;if(0==s)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&Li(n,i,o))return-1;let a=r.coordsAt(s,1);return a&&Li(n,i,a)?1:o&&Fi(i,o)?-1:1}function Vi(e,t){let n=e.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:n,bias:Ui(e,n,t.clientX,t.clientY)}}var zi=Zt.ie&&Zt.ie_version<=11,Zi=null,ji=0,qi=0;function Gi(e){if(!zi)return e.detail;let t=Zi,n=qi;return Zi=e,qi=Date.now(),ji=!t||n>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(ji+1)%3:1}function Wi(e,t,n,i){if(!n)return;let r=e.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:s}=e.inputState,o=i&&s&&function(e,t){let n=e.state.facet(Dn);return n.length?n[0](t):Zt.mac?!t.altKey:!t.ctrlKey}(e,t)?{from:s.from,to:s.to}:null,a={from:r,insert:n},l=e.state.changes(o?[o,a]:a);e.focus(),e.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),e.inputState.draggedContent=null}Ri.dragstart=(e,t)=>{let{selection:{main:n}}=e.state;if(t.target.draggable){let i=e.docView.nearest(t.target);if(i&&i.isWidget){let e=i.posAtStart,t=e+i.length;(e>=n.to||t<=n.from)&&(n=X.range(e,t))}}let{inputState:i}=e;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=n,t.dataTransfer&&(t.dataTransfer.setData("Text",e.state.sliceDoc(n.from,n.to)),t.dataTransfer.effectAllowed="copyMove"),!1},Ri.dragend=e=>(e.inputState.draggedContent=null,!1),Ri.drop=(e,t)=>{if(!t.dataTransfer)return!1;if(e.state.readOnly)return!0;let n=t.dataTransfer.files;if(n&&n.length){let i=Array(n.length),r=0,s=()=>{++r==n.length&&Wi(e,t,i.filter((e=>null!=e)).join(e.state.lineBreak),!1)};for(let e=0;e<n.length;e++){let t=new FileReader;t.onerror=s,t.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(t.result)||(i[e]=t.result),s()},t.readAsText(n[e])}return!0}{let n=t.dataTransfer.getData("Text");if(n)return Wi(e,t,n,!0),!0}return!1},Ri.paste=(e,t)=>{if(e.state.readOnly)return!0;e.observer.flush();let n=Bi?null:t.clipboardData;return n?(Di(e,n.getData("text/plain")||n.getData("text/uri-list")),!0):(function(e){let t=e.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout((()=>{e.focus(),n.remove(),Di(e,n.value)}),50)}(e),!1)};var Hi=null;Ri.copy=Ri.cut=(e,t)=>{let{text:n,ranges:i,linewise:r}=function(e){let t=[],n=[],i=!1;for(let i of e.selection.ranges)i.empty||(t.push(e.sliceDoc(i.from,i.to)),n.push(i));if(!t.length){let r=-1;for(let{from:i}of e.selection.ranges){let s=e.doc.lineAt(i);s.number>r&&(t.push(s.text),n.push({from:s.from,to:Math.min(e.doc.length,s.to+1)})),r=s.number}i=!0}return{text:t.join(e.lineBreak),ranges:n,linewise:i}}(e.state);if(!n&&!r)return!1;Hi=r?n:null,"cut"==t.type&&!e.state.readOnly&&e.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=Bi?null:t.clipboardData;return s?(s.clearData(),s.setData("text/plain",n),!0):(function(e,t){let n=e.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout((()=>{i.remove(),e.focus()}),50)}(e,n),!1)};var Yi=me.define();function Ji(e,t){let n=[];for(let i of e.facet(Vn)){let r=i(e,t);r&&n.push(r)}return n?e.update({effects:n,annotations:Yi.of(!0)}):null}function Ki(e){setTimeout((()=>{let t=e.hasFocus;if(t!=e.inputState.notifiedFocused){let n=Ji(e.state,t);n?e.dispatch(n):e.update([])}}),10)}Mi.focus=e=>{e.inputState.lastFocusTime=Date.now(),!e.scrollDOM.scrollTop&&(e.inputState.lastScrollTop||e.inputState.lastScrollLeft)&&(e.scrollDOM.scrollTop=e.inputState.lastScrollTop,e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft),Ki(e)},Mi.blur=e=>{e.observer.clearSelectionRange(),Ki(e)},Mi.compositionstart=Mi.compositionupdate=e=>{null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0,e.docView.maybeCreateCompositionBarrier()&&(e.update([]),e.docView.clearCompositionBarrier()))},Mi.compositionend=e=>{e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionPendingKey=!0,e.inputState.compositionPendingChange=e.observer.pendingRecords().length>0,e.inputState.compositionFirstChange=null,Zt.chrome&&Zt.android?e.observer.flushSoon():e.inputState.compositionPendingChange?Promise.resolve().then((()=>e.observer.flush())):setTimeout((()=>{e.inputState.composing<0&&e.docView.hasComposition&&e.update([])}),50)},Mi.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},Ri.beforeinput=(e,t)=>{var n;let i;if(Zt.chrome&&Zt.android&&(i=$i.find((e=>e.inputType==t.inputType)))&&(e.observer.delayAndroidKey(i.key,i.keyCode),"Backspace"==i.key||"Delete"==i.key)){let t=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var n;((null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0)>t+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus())}),100)}return Zt.ios&&"deleteContentForward"==t.inputType&&e.observer.flushSoon(),Zt.safari&&"insertText"==t.inputType&&e.inputState.composing>=0&&setTimeout((()=>Mi.compositionend(e,t)),20),!1};var er=new Set;var tr=["pre-wrap","normal","pre-line","break-spaces"],nr=class{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}},ir=class e{constructor(e,t,n,i,r){this.from=e,this.length=t,this.top=n,this.height=i,this._content=r}get type(){return"number"==typeof this._content?ln.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof dn?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let n=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new e(this.from,this.length+t.length,this.top,this.height+t.height,n)}},rr=function(e){return e[e.ByPos=0]="ByPos",e[e.ByHeight=1]="ByHeight",e[e.ByPosNoHeight=2]="ByPosNoHeight",e}(rr||(rr={})),sr=.001,or=class e{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=(e?2:0)|-3&this.flags}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>sr&&(e.heightChanged=!0),this.height=t)}replace(t,n,i){return e.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,i){let r=this,s=n.doc;for(let o=i.length-1;o>=0;o--){let{fromA:a,toA:l,fromB:h,toB:c}=i[o],u=r.lineAt(a,rr.ByPosNoHeight,n.setDoc(t),0,0),d=u.to>=l?u:r.lineAt(l,rr.ByPosNoHeight,n,0,0);for(c+=d.to-l,l=d.to;o>0&&u.from<=i[o-1].toA;)a=i[o-1].fromA,h=i[o-1].fromB,o--,a<u.from&&(u=r.lineAt(a,rr.ByPosNoHeight,n,0,0));h+=u.from-a,a=u.from;let p=dr.build(n.setDoc(s),e,h,c);r=r.replace(a,l,p)}return r.updateHeight(n,0)}static empty(){return new lr(0,0)}static of(t){if(1==t.length)return t[0];let n=0,i=t.length,r=0,s=0;for(;;)if(n==i)if(r>2*s){let e=t[n-1];e.break?t.splice(--n,1,e.left,null,e.right):t.splice(--n,1,e.left,e.right),i+=1+e.break,r-=e.size}else{if(!(s>2*r))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(r<s){let e=t[n++];e&&(r+=e.size)}else{let e=t[--i];e&&(s+=e.size)}let o=0;return null==t[n-1]?(o=1,n--):null==t[n]&&(o=1,i++),new cr(e.of(t.slice(0,n)),o,e.of(t.slice(i)))}};or.prototype.size=1;var ar=class extends or{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,i){return new ir(i,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,i,r){return this.blockAt(0,n,i,r)}forEachLine(e,t,n,i,r,s){e<=r+this.length&&t>=r&&s(this.blockAt(0,n,i,r))}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(e,i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}},lr=class e extends ar{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,i){return new ir(i,this.length,n,this.height,this.breaks)}replace(t,n,i){let r=i[0];return 1==i.length&&(r instanceof e||r instanceof hr&&4&r.flags)&&Math.abs(this.length-r.length)<10?(r instanceof hr?r=new e(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):or.of(i)}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more?this.setHeight(e,i.heights[i.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},hr=class e extends or{constructor(e){super(e,0)}heightMetrics(e,t){let n,i=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,s=r-i+1,o=0;if(e.lineWrapping){let t=Math.min(this.height,e.lineHeight*s);n=t/s,this.length>s+1&&(o=(this.height-t)/(this.length-s-1))}else n=this.height/s;return{firstLine:i,lastLine:r,perLine:n,perChar:o}}blockAt(e,t,n,i){let{firstLine:r,lastLine:s,perLine:o,perChar:a}=this.heightMetrics(t,i);if(t.lineWrapping){let r=i+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),s=t.doc.lineAt(r),l=o+s.length*a,h=Math.max(n,e-l/2);return new ir(s.from,s.length,h,l,0)}{let i=Math.max(0,Math.min(s-r,Math.floor((e-n)/o))),{from:a,length:l}=t.doc.line(r+i);return new ir(a,l,n+o*i,o,0)}}lineAt(e,t,n,i,r){if(t==rr.ByHeight)return this.blockAt(e,n,i,r);if(t==rr.ByPosNoHeight){let{from:t,to:i}=n.doc.lineAt(e);return new ir(t,i-t,0,0,0)}let{firstLine:s,perLine:o,perChar:a}=this.heightMetrics(n,r),l=n.doc.lineAt(e),h=o+l.length*a,c=l.number-s,u=i+o*c+a*(l.from-r-c);return new ir(l.from,l.length,Math.max(i,Math.min(u,i+this.height-h)),h,0)}forEachLine(e,t,n,i,r,s){e=Math.max(e,r),t=Math.min(t,r+this.length);let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(n,r);for(let h=e,c=i;h<=t;){let t=n.doc.lineAt(h);if(h==e){let n=t.number-o;c+=a*n+l*(e-r-n)}let i=a+l*t.length;s(new ir(t.from,t.length,c,i,0)),c+=i,h=t.to+1}}replace(t,n,i){let r=this.length-n;if(r>0){let t=i[i.length-1];t instanceof e?i[i.length-1]=new e(t.length+r):i.push(null,new e(r-1))}if(t>0){let n=i[0];n instanceof e?i[0]=new e(t+n.length):i.unshift(new e(t-1),null)}return or.of(i)}decomposeLeft(t,n){n.push(new e(t-1),null)}decomposeRight(t,n){n.push(null,new e(this.length-t-1))}updateHeight(t,n=0,i=!1,r){let s=n+this.length;if(r&&r.from<=n+this.length&&r.more){let i=[],o=Math.max(n,r.from),a=-1;for(r.from>n&&i.push(new e(r.from-n-1).updateHeight(t,n));o<=s&&r.more;){let e=t.doc.lineAt(o).length;i.length&&i.push(null);let n=r.heights[r.index++];-1==a?a=n:Math.abs(n-a)>=sr&&(a=-2);let s=new lr(e,n);s.outdated=!1,i.push(s),o+=e+1}o<=s&&i.push(null,new e(s-o).updateHeight(t,o));let l=or.of(i);return(a<0||Math.abs(l.height-this.height)>=sr||Math.abs(a-this.heightMetrics(t,n).perLine)>=sr)&&(t.heightChanged=!0),l}return(i||this.outdated)&&(this.setHeight(t,t.heightForGap(n,n+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}},cr=class extends or{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return 1&this.flags}blockAt(e,t,n,i){let r=n+this.left.height;return e<r?this.left.blockAt(e,t,n,i):this.right.blockAt(e,t,r,i+this.left.length+this.break)}lineAt(e,t,n,i,r){let s=i+this.left.height,o=r+this.left.length+this.break,a=t==rr.ByHeight?e<s:e<o,l=a?this.left.lineAt(e,t,n,i,r):this.right.lineAt(e,t,n,s,o);if(this.break||(a?l.to<o:l.from>o))return l;let h=t==rr.ByPosNoHeight?rr.ByPosNoHeight:rr.ByPos;return a?l.join(this.right.lineAt(o,h,n,s,o)):this.left.lineAt(o,h,n,i,r).join(l)}forEachLine(e,t,n,i,r,s){let o=i+this.left.height,a=r+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,n,i,r,s),t>=a&&this.right.forEachLine(e,t,n,o,a,s);else{let l=this.lineAt(a,rr.ByPos,n,i,r);e<l.from&&this.left.forEachLine(e,l.from-1,n,i,r,s),l.to>=e&&l.from<=t&&s(l),t>l.to&&this.right.forEachLine(l.to+1,t,n,o,a,s)}}replace(e,t,n){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,n));let r=[];e>0&&this.decomposeLeft(e,r);let s=r.length;for(let e of n)r.push(e);if(e>0&&ur(r,s-1),t<this.length){let e=r.length;this.decomposeRight(t,r),ur(r,e)}return or.of(r)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,i=n+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?or.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,i){let{left:r,right:s}=this,o=t+r.length+this.break,a=null;return i&&i.from<=t+r.length&&i.more?a=r=r.updateHeight(e,t,n,i):r.updateHeight(e,t,n),i&&i.from<=o+s.length&&i.more?a=s=s.updateHeight(e,o,n,i):s.updateHeight(e,o,n),a?this.balanced(r,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}};function ur(e,t){let n,i;null==e[t]&&(n=e[t-1])instanceof hr&&(i=e[t+1])instanceof hr&&e.splice(t-1,3,new hr(n.length+1+i.length))}var dr=class e{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let e=Math.min(t,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof lr?n.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new lr(e-this.pos,-1)),this.writtenTo=e,t>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0,r=n.widget?n.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let s=t-e;n.block?this.addBlock(new ar(s,i,n)):(s||r||i>=5)&&this.addLineDeco(i,r,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new lr(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new hr(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof lr)return e;let t=new lr(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let i=this.ensureLine();i.length+=n,i.collapsed+=n,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof lr||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new lr(0,-1));let n=e;for(let e of this.nodes)e instanceof lr&&e.updateHeight(this.oracle,n),n+=e?e.length:1;return this.nodes}static build(t,n,i,r){let s=new e(i,t);return Qe.spans(n,i,r,s,0),s.finish(i)}};var pr=class{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,i){(e<t||n&&n.heightRelevant||i&&i.heightRelevant)&&fn(e,t,this.changes,5)}};function fr(e,t){let n=e.getBoundingClientRect(),i=e.ownerDocument,r=i.defaultView||window,s=Math.max(0,n.left),o=Math.min(r.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(r.innerHeight,n.bottom);for(let t=e.parentNode;t&&t!=i.body;)if(1==t.nodeType){let n=t,i=window.getComputedStyle(n);if((n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)&&"visible"!=i.overflow){let i=n.getBoundingClientRect();s=Math.max(s,i.left),o=Math.min(o,i.right),a=Math.max(a,i.top),l=t==e.parentNode?i.bottom:Math.min(l,i.bottom)}t="absolute"==i.position||"fixed"==i.position?n.offsetParent:n.parentNode}else{if(11!=t.nodeType)break;t=t.host}return{left:s-n.left,right:Math.max(s,o)-n.left,top:a-(n.top+t),bottom:Math.max(a,l)-(n.top+t)}}function mr(e,t){let n=e.getBoundingClientRect();return{left:0,right:n.right-n.left,top:t,bottom:n.bottom-(n.top+t)}}var gr=class{constructor(e,t,n){this.from=e,this.to=t,this.size=n}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],r=t[n];if(i.from!=r.from||i.to!=r.to||i.size!=r.size)return!1}return!0}draw(e,t){return hn.replace({widget:new Or(this.size*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}},Or=class extends an{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}},yr=class{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Sr,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=yn.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(ni).some((e=>"function"!=typeof e&&"cm-lineWrapping"==e.class));this.heightOracle=new class{constructor(e){this.lineWrapping=e,this.doc=a.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return tr.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let i=e[n];i<0?n++:this.heightSamples[Math.floor(10*i)]||(t=!0,this.heightSamples[Math.floor(10*i)]=!0)}return t}refresh(e,t,n,i,r,s){let o=tr.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=n,this.textHeight=i,this.lineLength=r,a){this.heightSamples={};for(let e=0;e<s.length;e++){let t=s[e];t<0?e++:this.heightSamples[Math.floor(10*t)]=!0}}return a}}(t),this.stateDeco=e.facet(ii).filter((e=>"function"!=typeof e)),this.heightMap=or.empty().applyChanges(this.stateDeco,a.empty,this.heightOracle.setDoc(e.doc),[new ui(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=hn.set(this.lineGaps.map((e=>e.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let i=n?t.head:t.anchor;if(!e.some((({from:e,to:t})=>i>=e&&i<=t))){let{from:t,to:n}=this.lineBlockAt(i);e.push(new vr(t,n))}}this.viewports=e.sort(((e,t)=>e.from-t.from)),this.scaler=this.heightMap.height<=7e6?Sr:new kr(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(e=>{this.viewportLines.push(1==this.scaler.scale?e:Ar(e,this.scaler))}))}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(ii).filter((e=>"function"!=typeof e));let i=e.changedRanges,r=ui.extendWithRanges(i,function(e,t,n){let i=new pr;return Qe.compare(e,t,n,i,0),i.changes}(n,this.stateDeco,e?e.changes:$.empty(this.state.doc.length))),s=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=s&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let a=r.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let l=!e.changes.empty||2&e.flags||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Zn)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),i=this.heightOracle,r=n.whiteSpace;this.defaultTextDirection="rtl"==n.direction?yn.RTL:yn.LTR;let s=this.heightOracle.mustRefreshForWrapping(r),o=t.getBoundingClientRect(),l=s||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let h=0,c=0;if(o.width&&o.height){let{scaleX:e,scaleY:n}=Ot(t,o);(e>.005&&Math.abs(this.scaleX-e)>.005||n>.005&&Math.abs(this.scaleY-n)>.005)&&(this.scaleX=e,this.scaleY=n,h|=8,s=l=!0)}let u=(parseInt(n.paddingTop)||0)*this.scaleY,d=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=u||this.paddingBottom!=d)&&(this.paddingTop=u,this.paddingBottom=d,h|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,h|=8);let p=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=p&&(this.scrollAnchorHeight=-1,this.scrollTop=p),this.scrolledToBottom=kt(e.scrollDOM);let f=(this.printing?mr:fr)(t,this.paddingTop),m=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let O=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(O!=this.inView&&(this.inView=O,O&&(l=!0)),!this.inView&&!this.scrollTarget)return 0;let y=o.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,h|=8),l){let t=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(t)&&(s=!0),s||i.lineWrapping&&Math.abs(y-this.contentDOMWidth)>i.charWidth){let{lineHeight:n,charWidth:o,textHeight:a}=e.docView.measureTextSize();s=n>0&&i.refresh(r,n,o,a,y/o,t),s&&(e.docView.minWidth=0,h|=8)}m>0&&g>0?c=Math.max(m,g):m<0&&g<0&&(c=Math.min(m,g)),i.heightChanged=!1;for(let n of this.viewports){let r=n.from==this.viewport.from?t:e.docView.measureVisibleLineHeights(n);this.heightMap=(s?or.empty().applyChanges(this.stateDeco,a.empty,this.heightOracle,[new ui(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,s,new nr(n.from,r))}i.heightChanged&&(h|=2)}let v=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(this.viewport=this.getViewport(c,this.scrollTarget)),this.updateForViewport(),(2&h||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps,e)),h|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),h}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,r=this.heightOracle,{visibleTop:s,visibleBottom:o}=this,a=new vr(i.lineAt(s-1e3*n,rr.ByHeight,r,0,0).from,i.lineAt(o+1e3*(1-n),rr.ByHeight,r,0,0).to);if(t){let{head:e}=t.range;if(e<a.from||e>a.to){let n,s=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=i.lineAt(e,rr.ByPos,r,0,0);n="center"==t.y?(o.top+o.bottom)/2-s/2:"start"==t.y||"nearest"==t.y&&e<a.from?o.top:o.bottom-s,a=new vr(i.lineAt(n-500,rr.ByHeight,r,0,0).from,i.lineAt(n+s+500,rr.ByHeight,r,0,0).to)}}return a}mapViewport(e,t){let n=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new vr(this.heightMap.lineAt(n,rr.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,rr.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,rr.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(t,rr.ByPos,this.heightOracle,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==e||i<=s-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||r>=o+Math.max(10,Math.min(n,250)))&&i>s-2e3&&r<o+2e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let i of e)t.touchesRange(i.from,i.to)||n.push(new gr(t.mapPos(i.from),t.mapPos(i.to),i.size));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,i=n?1e4:2e3,r=i>>1,s=i<<1;if(this.defaultTextDirection!=yn.LTR&&!n)return[];let o=[],a=(i,s,l,h)=>{if(s-i<r)return;let c=this.state.selection.main,u=[c.from];c.empty||u.push(c.to);for(let e of u)if(e>i&&e<s)return a(i,e-10,l,h),void a(e+10,s,l,h);let d=function(e,t){for(let n of e)if(t(n))return n}(e,(e=>e.from>=l.from&&e.to<=l.to&&Math.abs(e.from-i)<r&&Math.abs(e.to-s)<r&&!u.some((t=>e.from<t&&e.to>t))));if(!d){if(s<l.to&&t&&n&&t.visibleRanges.some((e=>e.from<=s&&e.to>=s))){let e=t.moveToLineBoundary(X.cursor(s),!1,!0).head;e>i&&(s=e)}d=new gr(i,s,this.gapSize(l,i,s,h))}o.push(d)};for(let e of this.viewportLines){if(e.length<s)continue;let t=br(e.from,e.to,this.stateDeco);if(t.total<s)continue;let r,o,l=this.scrollTarget?this.scrollTarget.range.head:null;if(n){let n,s,a=i/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=l){let i=xr(t,l),r=((this.visibleBottom-this.visibleTop)/2+a)/e.height;n=i-r,s=i+r}else n=(this.visibleTop-e.top-a)/e.height,s=(this.visibleBottom-e.top+a)/e.height;r=wr(t,n),o=wr(t,s)}else{let e,n,s=t.total*this.heightOracle.charWidth,a=i*this.heightOracle.charWidth;if(null!=l){let i=xr(t,l),r=((this.pixelViewport.right-this.pixelViewport.left)/2+a)/s;e=i-r,n=i+r}else e=(this.pixelViewport.left-a)/s,n=(this.pixelViewport.right+a)/s;r=wr(t,e),o=wr(t,n)}r>e.from&&a(e.from,r,e,t),o<e.to&&a(o,e.to,e,t)}return o}gapSize(e,t,n,i){let r=xr(i,n)-xr(i,t);return this.heightOracle.lineWrapping?e.height*r:i.total*this.heightOracle.charWidth*r}updateLineGaps(e){gr.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=hn.set(e.map((e=>e.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];Qe.spans(e,this.viewport.from,this.viewport.to,{span(e,n){t.push({from:e,to:n})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some(((e,n)=>e.from!=t[n].from||e.to!=t[n].to));return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find((t=>t.from<=e&&t.to>=e))||Ar(this.heightMap.lineAt(e,rr.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return Ar(this.heightMap.lineAt(this.scaler.fromDOM(e),rr.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Ar(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}},vr=class{constructor(e,t){this.from=e,this.to=t}};function br(e,t,n){let i=[],r=e,s=0;return Qe.spans(n,e,t,{span(){},point(e,t){e>r&&(i.push({from:r,to:e}),s+=e-r),r=t}},20),r<t&&(i.push({from:r,to:t}),s+=t-r),{total:s,ranges:i}}function wr({total:e,ranges:t},n){if(n<=0)return t[0].from;if(n>=1)return t[t.length-1].to;let i=Math.floor(e*n);for(let e=0;;e++){let{from:n,to:r}=t[e],s=r-n;if(i<=s)return n+i;i-=s}}function xr(e,t){let n=0;for(let{from:i,to:r}of e.ranges){if(t<=r){n+=t-i;break}n+=r-i}return n/e.total}var Sr={toDOM:e=>e,fromDOM:e=>e,scale:1},kr=class{constructor(e,t,n){let i=0,r=0,s=0;this.viewports=n.map((({from:n,to:r})=>{let s=t.lineAt(n,rr.ByPos,e,0,0).top,o=t.lineAt(r,rr.ByPos,e,0,0).bottom;return i+=o-s,{from:n,to:r,top:s,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-i)/(t.height-i);for(let e of this.viewports)e.domTop=s+(e.top-r)*this.scale,s=e.domBottom=e.domTop+(e.bottom-e.top),r=e.bottom}toDOM(e){for(let t=0,n=0,i=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.top)return i+(e-n)*this.scale;if(e<=r.bottom)return r.domTop+(e-r.top);n=r.bottom,i=r.domBottom}}fromDOM(e){for(let t=0,n=0,i=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.domTop)return n+(e-i)/this.scale;if(e<=r.domBottom)return r.top+(e-r.domTop);n=r.bottom,i=r.domBottom}}};function Ar(e,t){if(1==t.scale)return e;let n=t.toDOM(e.top),i=t.toDOM(e.bottom);return new ir(e.from,e.length,n,i-n,Array.isArray(e._content)?e._content.map((e=>Ar(e,t))):e._content)}var Cr=U.define({combine:e=>e.join(" ")}),_r=U.define({combine:e=>e.indexOf(!0)>-1}),Er=Ke.newName(),Tr=Ke.newName(),Pr=Ke.newName(),$r={"&light":"."+Tr,"&dark":"."+Pr};function Nr(e,t,n){return new Ke(t,{finish:t=>/&/.test(t)?t.replace(/&\w*/,(t=>{if("&"==t)return e;if(!n||!n[t])throw new RangeError(`Unsupported selector: ${t}`);return n[t]})):e+" "+t})}var Ir=Nr("."+Er,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},$r),Qr="";function Rr(e,t,n){for(;;){if(!t||n<ft(t))return!1;if(t==e)return!0;n=ut(t)+1,t=t.parentNode}}var Mr=class{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}};function Br(e,t){let n,{newSel:i}=t,r=e.state.selection.main,s=e.inputState.lastKeyTime>Date.now()-100?e.inputState.lastKeyCode:-1;if(t.bounds){let{from:i,to:o}=t.bounds,l=r.from,h=null;(8===s||Zt.android&&t.text.length<o-i)&&(l=r.to,h="end");let c=function(e,t,n,i){let r=Math.min(e.length,t.length),s=0;for(;s<r&&e.charCodeAt(s)==t.charCodeAt(s);)s++;if(s==r&&e.length==t.length)return null;let o=e.length,a=t.length;for(;o>0&&a>0&&e.charCodeAt(o-1)==t.charCodeAt(a-1);)o--,a--;if("end"==i){n-=o+Math.max(0,s-Math.min(o,a))-s}if(o<s&&e.length<t.length){s-=n<=s&&n>=o?s-n:0,a=s+(a-o),o=s}else if(a<s){s-=n<=s&&n>=a?s-n:0,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}(e.state.doc.sliceString(i,o,Qr),t.text,l-i,h);c&&(Zt.chrome&&13==s&&c.toB==c.from+2&&""==t.text.slice(c.from,c.toB)&&c.toB--,n={from:i+c.from,to:i+c.toA,insert:a.of(t.text.slice(c.from,c.toB).split(Qr))})}else i&&(!e.hasFocus&&e.state.facet(Hn)||i.main.eq(r))&&(i=null);if(!n&&!i)return!1;if(!n&&t.typeOver&&!r.empty&&i&&i.main.empty?n={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,r.to)}:n&&n.from>=r.from&&n.to<=r.to&&(n.from!=r.from||n.to!=r.to)&&r.to-r.from-(n.to-n.from)<=4?n={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,n.from).append(n.insert).append(e.state.doc.slice(n.to,r.to))}:(Zt.mac||Zt.android)&&n&&n.from==n.to&&n.from==r.head-1&&/^\. ?$/.test(n.insert.toString())&&"off"==e.contentDOM.getAttribute("autocorrect")?(i&&2==n.insert.length&&(i=X.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:a.of([" "])}):Zt.chrome&&n&&n.from==n.to&&n.from==r.head&&"\n "==n.insert.toString()&&e.lineWrapping&&(i&&(i=X.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:a.of([" "])}),n){if(Zt.ios&&e.inputState.flushIOSKey(n)||Zt.android&&(n.to==r.to&&(n.from==r.from||n.from==r.from-1&&" "==e.state.sliceDoc(n.from,r.from))&&1==n.insert.length&&2==n.insert.lines&&xt(e.contentDOM,"Enter",13)||(n.from==r.from-1&&n.to==r.to&&0==n.insert.length||8==s&&n.insert.length<n.to-n.from&&n.to>r.head)&&xt(e.contentDOM,"Backspace",8)||n.from==r.from&&n.to==r.to+1&&0==n.insert.length&&xt(e.contentDOM,"Delete",46)))return!0;let t=n.insert.toString();e.inputState.composing>=0&&e.inputState.composing++;let o,a=()=>o||(o=function(e,t,n){let i,r=e.state,s=r.selection.main;if(t.from>=s.from&&t.to<=s.to&&t.to-t.from>=(s.to-s.from)/3&&(!n||n.main.empty&&n.main.from==t.from+t.insert.length)&&e.inputState.composing<0){let n=s.from<t.from?r.sliceDoc(s.from,t.from):"",o=s.to>t.to?r.sliceDoc(t.to,s.to):"";i=r.replaceSelection(e.state.toText(n+t.insert.sliceString(0,void 0,e.state.lineBreak)+o))}else{let o=r.changes(t),a=n&&n.main.to<=o.newLength?n.main:void 0;if(r.selection.ranges.length>1&&e.inputState.composing>=0&&t.to<=s.to&&t.to>=s.to-10){let l,h=e.state.sliceDoc(t.from,t.to),c=n&&gi(e,n.main.head);if(c){let e=t.insert.length-(t.to-t.from);l={from:c.from,to:c.to-e}}else l=e.state.doc.lineAt(s.head);let u=s.to-t.to,d=s.to-s.from;i=r.changeByRange((n=>{if(n.from==s.from&&n.to==s.to)return{changes:o,range:a||n.map(o)};let i=n.to-u,c=i-h.length;if(n.to-n.from!=d||e.state.sliceDoc(c,i)!=h||n.to>=l.from&&n.from<=l.to)return{range:n};let p=r.changes({from:c,to:i,insert:t.insert}),f=n.to-s.to;return{changes:p,range:a?X.range(Math.max(0,a.anchor+f),Math.max(0,a.head+f)):n.map(p)}}))}else i={changes:o,selection:a&&r.selection.replaceRange(a)}}let o="input.type";return(e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,o+=".compose",e.inputState.compositionFirstChange&&(o+=".start",e.inputState.compositionFirstChange=!1)),r.update(i,{userEvent:o,scrollIntoView:!0})}(e,n,i));return e.state.facet(Un).some((i=>i(e,n.from,n.to,t,a)))||e.dispatch(a()),!0}if(i&&!i.main.eq(r)){let t=!1,n="select";return e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),n=e.inputState.lastSelectionOrigin),e.dispatch({selection:i,scrollIntoView:t,userEvent:n}),!0}return!1}var Dr={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Xr=Zt.ie&&Zt.ie_version<=11;function Fr(e,t,n){for(;t;){let i=Tt.get(t);if(i&&i.parent==e)return i;let r=t.parentNode;t=r!=e.dom?r:n>0?t.nextSibling:t.previousSibling}return null}var Lr=class e{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:t}=e;this.dispatchTransactions=e.dispatchTransactions||t&&(e=>e.forEach((e=>t(e,this))))||(e=>this.update(e)),this.dispatch=this.dispatch.bind(this),this._root=e.root||function(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}(e.parent)||document,this.viewState=new yr(e.state||Te.create(e)),e.scrollTo&&e.scrollTo.is(Gn)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Jn).map((e=>new ei(e)));for(let e of this.plugins)e.update(this);this.observer=new class{constructor(e){this.view=e,this.active=!1,this.selectionRange=new class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?ft(t):0),n,Math.min(e.focusOffset,n?ft(n):0))}set(e,t,n,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=i}},this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver((t=>{for(let e of t)this.queue.push(e);(Zt.ie&&Zt.ie_version<=11||Zt.ios&&e.composing)&&t.some((e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length))?this.flushSoon():this.flush()})),Xr&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var e;(null===(e=this.view.docView)||void 0===e?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(e){"change"==e.type&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some(((t,n)=>t!=e[n])))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,i=this.selectionRange;if(n.state.facet(Hn)?n.root.activeElement!=this.dom:!lt(n.dom,i))return;let r=i.anchorNode&&n.docView.nearest(i.anchorNode);r&&r.ignoreEvent(e)?t||(this.selectionChanged=!1):(Zt.ie&&Zt.ie_version<=11||Zt.android&&Zt.chrome)&&!n.state.selection.main.empty&&i.focusNode&&ct(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Zt.safari&&11==e.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e){let t=null;function n(e){e.preventDefault(),e.stopImmediatePropagation(),t=e.getTargetRanges()[0]}if(e.contentDOM.addEventListener("beforeinput",n,!0),e.dom.ownerDocument.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",n,!0),!t)return null;let i=t.startContainer,r=t.startOffset,s=t.endContainer,o=t.endOffset,a=e.docView.domAtPos(e.state.selection.main.anchor);return ct(a.node,a.offset,s,o)&&([i,r,s,o]=[s,o,i,r]),{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:o}}(this.view)||ot(e.root);if(!t||this.selectionRange.eq(t))return!1;let n=lt(this.dom,t);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&function(e,t){let n=t.focusNode,i=t.focusOffset;if(!n||t.anchorNode!=n||t.anchorOffset!=i)return!1;for(i=Math.min(i,ft(n));;)if(i){if(1!=n.nodeType)return!1;let e=n.childNodes[i-1];"false"==e.contentEditable?i--:(n=e,i=ft(n))}else{if(n==e)return!0;i=ut(n),n=n.parentNode}}(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(1==n.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else{if(11!=n.nodeType)break;n=n.host}if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(let e of this.scrollTargets=t)e.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Dr),Xr&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Xr&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let e=()=>{let e=this.delayedAndroidKey;e&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=e.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&e.force&&xt(this.dom,e.key,e.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(e)}(!this.delayedAndroidKey||"Enter"==e)&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!(null===(n=this.delayedAndroidKey)||void 0===n||!n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,i=!1;for(let r of e){let e=this.readMutation(r);e&&(e.typeOver&&(i=!0),-1==t?({from:t,to:n}=e):(t=Math.min(e.from,t),n=Math.max(e.to,n)))}return{from:t,to:n,typeOver:i}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),i=this.selectionChanged&&lt(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new class{constructor(e,t,n,i){this.typeOver=i,this.bounds=null,this.text="";let{impreciseHead:r,impreciseAnchor:s}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let t=r||s?[]:function(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}=e.observer.selectionRange;return n&&(t.push(new Mr(n,i)),(r!=n||s!=i)&&t.push(new Mr(r,s))),t}(e),n=new class{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(Te.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Qr}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let i=e;;){this.findPointBefore(n,i);let e=this.text.length;this.readNode(i);let r=i.nextSibling;if(r==t)break;let s=Tt.get(i),o=Tt.get(r);(s&&o?s.breakAfter:(s?s.breakAfter:dt(i))||dt(r)&&("BR"!=i.nodeName||i.cmIgnore)&&this.text.length>e)&&this.lineBreak(),i=r}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let r,s=-1,o=1;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(r=i.exec(t))&&(s=r.index,o=r[0].length),this.append(t.slice(n,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let t of this.points)t.node==e&&t.pos>this.text.length&&(t.pos-=o-1);n=s+o}}readNode(e){if(e.cmIgnore)return;let t=Tt.get(e),n=t&&t.overrideDOMText;if(null!=n){this.findPointInside(e,n.length);for(let e=n.iter();!e.next().done;)e.lineBreak?this.lineBreak():this.append(e.value)}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(3==e.nodeType?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(Rr(e,n.node,n.offset)?t:0))}}(t,e.state);n.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=n.text,this.newSel=function(e,t){if(0==e.length)return null;let n=e[0].pos,i=2==e.length?e[1].pos:n;return n>-1&&i>-1?X.single(n+t,i+t):null}(t,this.bounds.from)}else{let t=e.observer.selectionRange,n=r&&r.node==t.focusNode&&r.offset==t.focusOffset||!at(e.contentDOM,t.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(t.focusNode,t.focusOffset),i=s&&s.node==t.anchorNode&&s.offset==t.anchorOffset||!at(e.contentDOM,t.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(t.anchorNode,t.anchorOffset),o=e.viewport;if((Zt.ios||Zt.chrome)&&e.state.selection.main.empty&&n!=i&&(o.from>0||o.to<e.state.doc.length)){let t=Math.min(n,i),r=Math.max(n,i),s=o.from-t,a=o.to-r;(0==s||1==s||0==t)&&(0==a||-1==a||r==e.state.doc.length)&&(n=0,i=e.state.doc.length)}this.newSel=X.single(i,n)}}}(this.view,e,t,n);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,i=Br(this.view,t);return this.view.state==n&&this.view.update([]),i}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty("attributes"==e.type),"attributes"==e.type&&(t.flags|=4),"childList"==e.type){let n=Fr(t,e.previousSibling||e.target.previousSibling,-1),i=Fr(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}return"characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener("change",this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener("change",this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,n;this.stop(),null===(e=this.intersection)||void 0===e||e.disconnect(),null===(t=this.gapIntersection)||void 0===t||t.disconnect(),null===(n=this.resizeScroll)||void 0===n||n.disconnect();for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}(this),this.inputState=new class{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Zt.safari&&e.contentDOM.addEventListener("input",(()=>null)),Zt.gecko&&function(e){er.has(e)||(er.add(e),e.addEventListener("copy",(()=>{})),e.addEventListener("cut",(()=>{})))}(e.contentDOM.ownerDocument)}handleEvent(e){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n,i=t.target;i!=e.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||(n=Tt.get(i))&&n.ignoreEvent(t))return!1;return!0}(this.view,e)||this.ignoreDuringComposition(e)||"keydown"==e.type&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let n=this.handlers[e];if(n){for(let e of n.observers)e(this.view,t);for(let e of n.handlers){if(t.defaultPrevented)break;if(e(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=function(e){let t=Object.create(null);function n(e){return t[e]||(t[e]={observers:[],handlers:[]})}for(let t of e){let e=t.spec;if(e&&e.domEventHandlers)for(let i in e.domEventHandlers){let r=e.domEventHandlers[i];r&&n(i).handlers.push(Pi(t.value,r))}if(e&&e.domEventObservers)for(let i in e.domEventObservers){let r=e.domEventObservers[i];r&&n(i).observers.push(Pi(t.value,r))}}for(let e in Ri)n(e).handlers.push(Ri[e]);for(let e in Mi)n(e).observers.push(Mi[e]);return t}(e),n=this.handlers,i=this.view.contentDOM;for(let e in t)if("scroll"!=e){let r=!t[e].handlers.length,s=n[e];s&&r!=!s.handlers.length&&(i.removeEventListener(e,this.handleEvent),s=null),s||i.addEventListener(e,this.handleEvent,{passive:r})}for(let e in n)"scroll"!=e&&!t[e]&&i.removeEventListener(e,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(27!=e.keyCode&&Ii.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),Zt.android&&Zt.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return!Zt.ios||e.synthetic||e.altKey||e.metaKey||!((t=$i.find((t=>t.keyCode==e.keyCode)))&&!e.ctrlKey||Ni.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(229!=e.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=t||e,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(e){let t=this.pendingIOSKey;return!(!t||"Enter"==t.key&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString()))&&(this.pendingIOSKey=void 0,xt(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!!/^key/.test(e.type)&&(this.composing>0||!!(Zt.safari&&!Zt.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}(this),this.inputState.ensureHandlers(this.plugins),this.docView=new pi(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){let t=1==e.length&&e[0]instanceof ye?e:1==e.length&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t,n=!1,i=!1,r=this.state;for(let t of e){if(t.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=t.state}if(this.destroyed)return void(this.viewState.state=r);let s=this.hasFocus,o=0,a=null;e.some((e=>e.annotation(Yi)))?(this.inputState.notifiedFocused=s,o=1):s!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=s,a=Ji(r,s),a||(o=1));let l=this.observer.delayedAndroidKey,h=null;if(l?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(h=null)):this.observer.clear(),r.facet(Te.phrases)!=this.state.facet(Te.phrases))return this.setState(r);t=di.create(this,r,e),t.flags|=o;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let t of e){if(c&&(c=c.map(t.changes)),t.scrollIntoView){let{main:e}=t.state.selection;c=new qn(e.empty?e:X.cursor(e.head,e.head>e.anchor?-1:1))}for(let e of t.effects)e.is(Gn)&&(c=e.value.clip(this.state))}this.viewState.update(t,c),this.bidiCache=zr.update(this.bidiCache,t.changes),t.empty||(this.updatePlugins(t),this.inputState.update(t)),n=this.docView.update(t),this.state.facet(ci)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some((e=>e.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(t.startState.facet(Cr)!=t.state.facet(Cr)&&(this.viewState.mustMeasureContent=!0),(n||i||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),n&&this.docViewUpdate(),!t.empty)for(let e of this.state.facet(Ln))try{e(t)}catch(e){Wn(this.state,e,"update listener")}(a||h)&&Promise.resolve().then((()=>{a&&this.state==a.startState&&this.dispatch(a),h&&!Br(this,h)&&l.force&&xt(this.contentDOM,l.key,l.keyCode)}))}setState(e){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=e);this.updateState=2;let t=this.hasFocus;try{for(let e of this.plugins)e.destroy(this);this.viewState=new yr(e),this.plugins=e.facet(Jn).map((e=>new ei(e))),this.pluginMap.clear();for(let e of this.plugins)e.update(this);this.docView.destroy(),this.docView=new pi(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Jn),n=e.state.facet(Jn);if(t!=n){let i=[];for(let r of n){let n=t.indexOf(r);if(n<0)i.push(new ei(r));else{let t=this.plugins[n];t.mustUpdate=e,i.push(t)}}for(let t of this.plugins)t.mustUpdate!=e&&t.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let t of this.plugins)t.mustUpdate=e;for(let e=0;e<this.plugins.length;e++)this.plugins[e].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(e){Wn(this.state,e,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,i=n.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:s}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(s=-1),this.viewState.scrollAnchorHeight=-1;try{for(let e=0;;e++){if(s<0)if(kt(n))r=-1,s=this.viewState.heightMap.height;else{let e=this.viewState.scrollAnchorAt(i);r=e.from,s=e.top}this.updateState=1;let o=this.viewState.measure(this);if(!o&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(e>5)break;let a=[];4&o||([this.measureRequests,a]=[a,this.measureRequests]);let l=a.map((e=>{try{return e.read(this)}catch(e){return Wn(this.state,e),Vr}})),h=di.create(this,this.state,[]),c=!1;h.flags|=o,t?t.flags|=o:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),c=this.docView.update(h),c&&this.docViewUpdate());for(let e=0;e<a.length;e++)if(l[e]!=Vr)try{let t=a[e];t.write&&t.write(l[e],this)}catch(e){Wn(this.state,e)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,s=-1;continue}{let e=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-s;if(e>1||e<-1){i+=e,n.scrollTop=i/this.scaleY,s=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let e of this.state.facet(Ln))e(t)}get themeClasses(){return Er+" "+(this.state.facet(_r)?Pr:Tr)+" "+this.state.facet(Cr)}updateAttrs(){let e=Zr(this,ti,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Hn)?"true":"false",class:"cm-content",style:`${Zt.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Zr(this,ni,t);let n=this.observer.ignore((()=>{let n=nn(this.contentDOM,this.contentAttrs,t),i=nn(this.dom,this.editorAttrs,e);return n||i}));return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(t){let n=!0;for(let i of t)for(let t of i.effects)if(t.is(e.announce)){n&&(this.announceDOM.textContent=""),n=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value}}mountStyles(){this.styleModules=this.state.facet(ci);let t=this.state.facet(e.cspNonce);Ke.mount(this.root,this.styleModules.concat(Ir).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),e){if(this.measureRequests.indexOf(e)>-1)return;if(null!=e.key)for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key)return void(this.measureRequests[t]=e);this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(void 0===t||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find((t=>t.spec==e))||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Ti(this,e,_i(this,e,t,n))}moveByGroup(e,t){return Ti(this,e,_i(this,e,t,(t=>function(e,t,n){let i=e.state.charCategorizer(t),r=i(n);return e=>{let t=i(e);return r==Ce.Space&&(r=t),r==t}}(this,e.head,t))))}visualLineSide(e,t){let n=this.bidiSpans(e),i=this.textDirectionAt(e.from),r=n[t?n.length-1:0];return X.cursor(r.side(t,i)+e.from,r.forward(!t,i)?1:-1)}moveToLineBoundary(e,t,n=!0){return function(e,t,n,i){let r=Ci(e,t.head),s=i&&r.type==ln.Text&&(e.lineWrapping||r.widgetLineBreaks)?e.coordsAtPos(t.assoc<0&&t.head>r.from?t.head-1:t.head):null;if(s){let t=e.dom.getBoundingClientRect(),i=e.textDirectionAt(r.from),o=e.posAtCoords({x:n==(i==yn.LTR)?t.right-1:t.left+1,y:(s.top+s.bottom)/2});if(null!=o)return X.cursor(o,n?-1:1)}return X.cursor(n?r.to:r.from,n?-1:1)}(this,e,t,n)}moveVertically(e,t,n){return Ti(this,e,function(e,t,n,i){let r=t.head,s=n?1:-1;if(r==(n?e.state.doc.length:0))return X.cursor(r,t.assoc);let o,a=t.goalColumn,l=e.contentDOM.getBoundingClientRect(),h=e.coordsAtPos(r,t.assoc||-1),c=e.documentTop;if(h)null==a&&(a=h.left-l.left),o=s<0?h.top:h.bottom;else{let t=e.viewState.lineBlockAt(r);null==a&&(a=Math.min(l.right-l.left,e.defaultCharacterWidth*(r-t.from))),o=(s<0?t.top:t.bottom)+c}let u=l.left+a,d=i??e.viewState.heightOracle.textHeight>>1;for(let t=0;;t+=10){let n=o+(d+t)*s,i=ki(e,{x:u,y:n},!1,s);if(n<l.top||n>l.bottom||(s<0?i<r:i>r)){let t=e.docView.coordsForChar(i),r=!t||n<t.top?-1:1;return X.cursor(i,r,void 0,a)}}}(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),ki(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(e),r=this.bidiSpans(i);return mt(n,r[En.find(r,e-i.from,-1,t)].dir==yn.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(zn)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Ur)return In(e.length);let t,n=this.textDirectionAt(e.from);for(let i of this.bidiCache)if(i.from==e.from&&i.dir==n&&(i.fresh||Tn(i.isolates,t=ai(this,e))))return i.order;t||(t=ai(this,e));let i=function(e,t,n){if(!e)return[new En(0,0,t==bn?1:0)];if(t==vn&&!n.length&&!_n.test(e))return In(e.length);if(n.length)for(;e.length>Pn.length;)Pn[Pn.length]=256;let i=[],r=t==vn?0:1;return Nn(e,r,r,n,0,e.length,i),i}(e.text,n,t);return this.bidiCache.push(new zr(e.from,e.to,n,t,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Zt.safari&&(null===(e=this.inputState)||void 0===e?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{bt(this.contentDOM),this.docView.updateSelection()}))}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Gn.of(new qn("number"==typeof e?X.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Gn.of(new qn(X.cursor(n.from),"start","start",n.top-e,t,!0))}static domEventHandlers(e){return Kn.define((()=>({})),{eventHandlers:e})}static domEventObservers(e){return Kn.define((()=>({})),{eventObservers:e})}static theme(e,t){let n=Ke.newName(),i=[Cr.of(n),ci.of(Nr(`.${n}`,e))];return t&&t.dark&&i.push(_r.of(!0)),i}static baseTheme(e){return te.lowest(ci.of(Nr("."+Er,e,$r)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content");return(null===(t=(n&&Tt.get(n)||Tt.get(e))?.rootView)||void 0===t?void 0:t.view)||null}};Lr.styleModule=ci,Lr.inputHandler=Un,Lr.scrollHandler=jn,Lr.focusChangeEffect=Vn,Lr.perLineTextDirection=zn,Lr.exceptionSink=Fn,Lr.updateListener=Ln,Lr.editable=Hn,Lr.mouseSelectionStyle=Xn,Lr.dragMovesSelection=Dn,Lr.clickAddsSelectionRange=Bn,Lr.decorations=ii,Lr.outerDecorations=ri,Lr.atomicRanges=si,Lr.bidiIsolatedRanges=oi,Lr.scrollMargins=li,Lr.darkTheme=_r,Lr.cspNonce=U.define({combine:e=>e.length?e[0]:""}),Lr.contentAttributes=ni,Lr.editorAttributes=ti,Lr.lineWrapping=Lr.contentAttributes.of({class:"cm-lineWrapping"}),Lr.announce=Oe.define();var Ur=4096,Vr={},zr=class e{constructor(e,t,n,i,r,s){this.from=e,this.to=t,this.dir=n,this.isolates=i,this.fresh=r,this.order=s}static update(t,n){if(n.empty&&!t.some((e=>e.fresh)))return t;let i=[],r=t.length?t[t.length-1].dir:yn.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let o=t[s];o.dir==r&&!n.touchesRange(o.from,o.to)&&i.push(new e(n.mapPos(o.from,1),n.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}};function Zr(e,t,n){for(let i=e.state.facet(t),r=i.length-1;r>=0;r--){let t=i[r],s="function"==typeof t?t(e):t;s&&Kt(s,n)}return n}var jr=Zt.mac?"mac":Zt.windows?"win":Zt.linux?"linux":"key";function qr(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}var Gr=te.default(Lr.domEventHandlers({keydown:(e,t)=>Kr(Yr(t.state),e,t,"editor")})),Wr=U.define({enables:Gr}),Hr=new WeakMap;function Yr(e){let t=e.facet(Wr),n=Hr.get(t);return n||Hr.set(t,n=function(e,t=jr){let n=Object.create(null),i=Object.create(null),r=(e,t)=>{let n=i[e];if(null==n)i[e]=t;else if(n!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},s=(e,i,s,o,a)=>{var l,h;let c=n[e]||(n[e]=Object.create(null)),u=i.split(/ (?!$)/).map((e=>function(e,t){let n,i,r,s,o=e.split(/-(?!$)/),a=o[o.length-1];"Space"==a&&(a=" ");for(let e=0;e<o.length-1;++e){let a=o[e];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))r=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);"mac"==t?s=!0:i=!0}}return n&&(a="Alt-"+a),i&&(a="Ctrl-"+a),s&&(a="Meta-"+a),r&&(a="Shift-"+a),a}(e,t)));for(let t=1;t<u.length;t++){let n=u.slice(0,t).join(" ");r(n,!0),c[n]||(c[n]={preventDefault:!0,stopPropagation:!1,run:[t=>{let i=Jr={view:t,prefix:n,scope:e};return setTimeout((()=>{Jr==i&&(Jr=null)}),4e3),!0}]})}let d=u.join(" ");r(d,!1);let p=c[d]||(c[d]={preventDefault:!1,stopPropagation:!1,run:(null===(h=null===(l=c._any)||void 0===l?void 0:l.run)||void 0===h?void 0:h.slice())||[]});s&&p.run.push(s),o&&(p.preventDefault=!0),a&&(p.stopPropagation=!0)};for(let i of e){let e=i.scope?i.scope.split(" "):["editor"];if(i.any)for(let t of e){let e=n[t]||(n[t]=Object.create(null));e._any||(e._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let t in e)e[t].run.push(i.any)}let r=i[t]||i.key;if(r)for(let t of e)s(t,r,i.run,i.preventDefault,i.stopPropagation),i.shift&&s(t,"Shift-"+r,i.shift,i.preventDefault,i.stopPropagation)}return n}(t.reduce(((e,t)=>e.concat(t)),[]))),n}var Jr=null;function Kr(e,t,n,i){let r=function(e){var t=!(rt&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||st&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?it:nt)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(t),s=_(A(r,0))==r.length&&" "!=r,o="",a=!1,l=!1,h=!1;Jr&&Jr.view==n&&Jr.scope==i&&(o=Jr.prefix+" ",Ii.indexOf(t.keyCode)<0&&(l=!0,Jr=null));let c,u,d=new Set,p=e=>{if(e){for(let i of e.run)if(!d.has(i)&&(d.add(i),i(n,t)))return e.stopPropagation&&(h=!0),!0;e.preventDefault&&(e.stopPropagation&&(h=!0),l=!0)}return!1},f=e[i];return f&&(p(f[o+qr(r,t,!s)])?a=!0:s&&(t.altKey||t.metaKey||t.ctrlKey)&&!(Zt.windows&&t.ctrlKey&&t.altKey)&&(c=nt[t.keyCode])&&c!=r?(p(f[o+qr(c,t,!0)])||t.shiftKey&&(u=it[t.keyCode])!=r&&u!=c&&p(f[o+qr(u,t,!1)]))&&(a=!0):s&&t.shiftKey&&p(f[o+qr(r,t,!0)])&&(a=!0),!a&&p(f._any)&&(a=!0)),l&&(a=!0),a&&h&&t.stopPropagation(),a}var es=class e{constructor(e,t,n,i,r){this.className=e,this.left=t,this.top=n,this.width=i,this.height=r}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className==this.className&&(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",null!=this.width&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(t,n,i){if(i.empty){let r=t.coordsAtPos(i.head,i.assoc||1);if(!r)return[];let s=ts(t);return[new e(n,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}return function(e,t,n){if(n.to<=e.viewport.from||n.from>=e.viewport.to)return[];let i=Math.max(n.from,e.viewport.from),r=Math.min(n.to,e.viewport.to),s=e.textDirection==yn.LTR,o=e.contentDOM,a=o.getBoundingClientRect(),l=ts(e),h=o.querySelector(".cm-line"),c=h&&window.getComputedStyle(h),u=a.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),d=a.right-(c?parseInt(c.paddingRight):0),p=Ci(e,i),f=Ci(e,r),m=p.type==ln.Text?p:null,g=f.type==ln.Text?f:null;if(m&&(e.lineWrapping||p.widgetLineBreaks)&&(m=ns(e,i,m)),g&&(e.lineWrapping||f.widgetLineBreaks)&&(g=ns(e,r,g)),m&&g&&m.from==g.from)return y(v(n.from,n.to,m));{let t=m?v(n.from,null,m):b(p,!1),i=g?v(null,n.to,g):b(f,!0),r=[];return(m||p).to<(g||f).from-(m&&g?1:0)||p.widgetLineBreaks>1&&t.bottom+e.defaultLineHeight/2<i.top?r.push(O(u,t.bottom,d,i.top)):t.bottom<i.top&&e.elementAtHeight((t.bottom+i.top)/2).type==ln.Text&&(t.bottom=i.top=(t.bottom+i.top)/2),y(t).concat(r).concat(y(i))}function O(e,n,i,r){return new es(t,e-l.left,n-l.top-.01,i-e,r-n+.01)}function y({top:e,bottom:t,horizontal:n}){let i=[];for(let r=0;r<n.length;r+=2)i.push(O(n[r],e,n[r+1],t));return i}function v(t,n,i){let r=1e9,o=-1e9,a=[];function l(t,n,l,h,c){let p=e.coordsAtPos(t,t==i.to?-2:2),f=e.coordsAtPos(l,l==i.from?2:-2);!p||!f||(r=Math.min(p.top,f.top,r),o=Math.max(p.bottom,f.bottom,o),c==yn.LTR?a.push(s&&n?u:p.left,s&&h?d:f.right):a.push(!s&&h?u:f.left,!s&&n?d:p.right))}let h=t??i.from,c=n??i.to;for(let i of e.visibleRanges)if(i.to>h&&i.from<c)for(let r=Math.max(i.from,h),s=Math.min(i.to,c);;){let i=e.state.doc.lineAt(r);for(let o of e.bidiSpans(i)){let e=o.from+i.from,a=o.to+i.from;if(e>=s)break;a>r&&l(Math.max(e,r),null==t&&e<=h,Math.min(a,s),null==n&&a>=c,o.dir)}if(r=i.to+1,r>=s)break}return 0==a.length&&l(h,null==t,c,null==n,e.textDirection),{top:r,bottom:o,horizontal:a}}function b(e,t){let n=a.top+(t?e.top:e.bottom);return{top:n,bottom:n,horizontal:[]}}}(t,n,i)}};function ts(e){let t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==yn.LTR?t.left:t.right-e.scrollDOM.clientWidth*e.scaleX)-e.scrollDOM.scrollLeft*e.scaleX,top:t.top-e.scrollDOM.scrollTop*e.scaleY}}function ns(e,t,n){let i=X.cursor(t);return{from:Math.max(n.from,e.moveToLineBoundary(i,!1,!0).from),to:Math.min(n.to,e.moveToLineBoundary(i,!0,!0).from),type:ln.Text}}var is=U.define();function rs(e){return[Kn.define((t=>new class{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(is)!=e.state.facet(is)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){!1!==this.layer.updateOnDocViewUpdate&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(is);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some(((e,t)=>!function(e,t){return e.constructor==t.constructor&&e.eq(t)}(e,this.drawn[t])))){let t=this.dom.firstChild,n=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[n].constructor&&i.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(i.draw(),t);for(;t;){let e=t.nextSibling;t.remove(),t=e}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}(t,e))),is.of(e)]}var ss=!Zt.ios,os=U.define({combine:e=>Pe(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})});function as(e){return e.startState.facet(os)!=e.state.facet(os)}var ls=rs({above:!0,markers(e){let{state:t}=e,n=t.facet(os),i=[];for(let r of t.selection.ranges){let s=r==t.selection.main;if(r.empty?!s||ss:n.drawRangeCursor){let t=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",n=r.empty?r:X.cursor(r.head,r.head>r.anchor?-1:1);for(let r of es.forRange(e,t,n))i.push(r)}}return i},update(e,t){e.transactions.some((e=>e.selection))&&(t.style.animationName="cm-blink"==t.style.animationName?"cm-blink2":"cm-blink");let n=as(e);return n&&hs(e.state,t),e.docChanged||e.selectionSet||n},mount(e,t){hs(t.state,e)},class:"cm-cursorLayer"});function hs(e,t){t.style.animationDuration=e.facet(os).cursorBlinkRate+"ms"}var cs=rs({above:!1,markers:e=>e.state.selection.ranges.map((t=>t.empty?[]:es.forRange(e,"cm-selectionBackground",t))).reduce(((e,t)=>e.concat(t))),update:(e,t)=>e.docChanged||e.selectionSet||e.viewportChanged||as(e),class:"cm-selectionLayer"}),us={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};ss&&(us[".cm-line"].caretColor="transparent !important",us[".cm-content"]={caretColor:"transparent !important"});var ds=te.highest(Lr.theme(us)),ps=Oe.define({map:(e,t)=>null==e?null:t.mapPos(e)}),fs=W.define({create:()=>null,update:(e,t)=>(null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce(((e,t)=>t.is(ps)?t.value:e),e))}),ms=Kn.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let n=e.state.field(fs);null==n?null!=this.cursor&&(null===(t=this.cursor)||void 0===t||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(fs)!=n||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:e}=this,t=e.state.field(fs),n=null!=t&&e.coordsAtPos(t);if(!n)return null;let i=e.scrollDOM.getBoundingClientRect();return{left:n.left-i.left+e.scrollDOM.scrollLeft*e.scaleX,top:n.top-i.top+e.scrollDOM.scrollTop*e.scaleY,height:n.bottom-n.top}}drawCursor(e){if(this.cursor){let{scaleX:t,scaleY:n}=this.view;e?(this.cursor.style.left=e.left/t+"px",this.cursor.style.top=e.top/n+"px",this.cursor.style.height=e.height/n+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(fs)!=e&&this.view.dispatch({effects:ps.of(e)})}},{eventObservers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){(e.target==this.view.contentDOM||!this.view.contentDOM.contains(e.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function gs(e,t,n,i,r){t.lastIndex=0;for(let s,o=e.iterRange(n,i),a=n;!o.next().done;a+=o.value.length)if(!o.lineBreak)for(;s=t.exec(o.value);)r(a+s.index,s)}var Os=null!=/x/.unicode?"gu":"g",ys=new RegExp("[\0-\b\n--\u2028\u2029\ufeff-]",Os),vs={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},bs=null;var ws=U.define({combine(e){let t=Pe(e,{render:null,specialChars:ys,addSpecialChars:null});return(t.replaceTabs=!function(){var e;if(null==bs&&typeof document<"u"&&document.body){let t=document.body.style;bs=null!=(null!==(e=t.tabSize)&&void 0!==e?e:t.MozTabSize)}return bs||!1}())&&(t.specialChars=new RegExp("\t|"+t.specialChars.source,Os)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Os)),t}});var xs=null;var Ss=class extends an{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=function(e){return e>=32?"":10==e?"":String.fromCharCode(9216+e)}(this.code),n=e.state.phrase("Control character")+" "+(vs[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,t);if(i)return i;let r=document.createElement("span");return r.textContent=t,r.title=n,r.setAttribute("aria-label",n),r.className="cm-specialChar",r}ignoreEvent(){return!1}},ks=class extends an{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="\t",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}};var As=hn.line({class:"cm-activeLine"}),Cs=Kn.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,n=[];for(let i of e.state.selection.ranges){let r=e.lineBlockAt(i.head);r.from>t&&(n.push(As.range(r.from)),t=r.from)}return hn.set(n)}},{decorations:e=>e.decorations}),_s=class extends an{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild("string"==typeof this.content?document.createTextNode(this.content):this.content),"string"==typeof this.content?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(e){let t=e.firstChild?ht(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),i=mt(t[0],"rtl"!=n.direction),r=parseInt(n.lineHeight);return i.bottom-i.top>1.5*r?{left:i.left,right:i.right,top:i.top,bottom:i.top+r}:i}ignoreEvent(){return!1}};function Es(e){return Kn.fromClass(class{constructor(t){this.view=t,this.placeholder=e?hn.set([hn.widget({widget:new _s(e),side:1}).range(0)]):hn.none}get decorations(){return this.view.state.doc.length?hn.none:this.placeholder}},{decorations:e=>e.decorations})}var Ts=2e3;function Ps(e,t){let n=e.posAtCoords({x:t.clientX,y:t.clientY},!1),i=e.state.doc.lineAt(n),r=n-i.from,s=r>Ts?-1:r==i.length?function(e,t){let n=e.coordsAtPos(e.viewport.from);return n?Math.round(Math.abs((n.left-t)/e.defaultCharacterWidth)):-1}(e,t.clientX):je(i.text,e.state.tabSize,n-i.from);return{line:i.number,col:s,off:r}}function $s(e,t){let n=Ps(e,t),i=e.state.selection;return n?{update(e){if(e.docChanged){let t=e.changes.mapPos(e.startState.doc.line(n.line).from),r=e.state.doc.lineAt(t);n={line:r.number,col:n.col,off:Math.min(n.off,r.length)},i=i.map(e.changes)}},get(t,r,s){let o=Ps(e,t);if(!o)return i;let a=function(e,t,n){let i=Math.min(t.line,n.line),r=Math.max(t.line,n.line),s=[];if(t.off>Ts||n.off>Ts||t.col<0||n.col<0){let o=Math.min(t.off,n.off),a=Math.max(t.off,n.off);for(let t=i;t<=r;t++){let n=e.doc.line(t);n.length<=a&&s.push(X.range(n.from+o,n.to+a))}}else{let o=Math.min(t.col,n.col),a=Math.max(t.col,n.col);for(let t=i;t<=r;t++){let n=e.doc.line(t),i=qe(n.text,o,e.tabSize,!0);if(i<0)s.push(X.cursor(n.to));else{let t=qe(n.text,a,e.tabSize);s.push(X.range(n.from+i,n.from+t))}}}return s}(e.state,n,o);return a.length?s?X.create(a.concat(i.ranges)):X.create(a):i}}:null}var Ns={Alt:[18,e=>!!e.altKey],Control:[17,e=>!!e.ctrlKey],Shift:[16,e=>!!e.shiftKey],Meta:[91,e=>!!e.metaKey]},Is={style:"cursor: crosshair"};var Qs="-10000px",Rs=class{constructor(e,t,n,i){this.facet=t,this.createTooltipView=n,this.removeTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter((e=>e));let r=null;this.tooltipViews=this.tooltips.map((e=>r=n(e,r)))}update(e,t){var n;let i=e.state.facet(this.facet),r=i.filter((e=>e));if(i===this.input){for(let t of this.tooltipViews)t.update&&t.update(e);return!1}let s=[],o=t?[]:null;for(let n=0;n<r.length;n++){let i=r[n],a=-1;if(i){for(let e=0;e<this.tooltips.length;e++){let t=this.tooltips[e];t&&t.create==i.create&&(a=e)}if(a<0)s[n]=this.createTooltipView(i,n?s[n-1]:null),o&&(o[n]=!!i.above);else{let i=s[n]=this.tooltipViews[a];o&&(o[n]=t[a]),i.update&&i.update(e)}}}for(let e of this.tooltipViews)s.indexOf(e)<0&&(this.removeTooltipView(e),null===(n=e.destroy)||void 0===n||n.call(e));return t&&(o.forEach(((e,n)=>t[n]=e)),t.length=o.length),this.input=i,this.tooltips=r,this.tooltipViews=s,!0}};function Ms(e){let{win:t}=e;return{top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}var Bs=U.define({combine:e=>{var t,n,i;return{position:Zt.ios?"absolute":(null===(t=e.find((e=>e.position)))||void 0===t?void 0:t.position)||"fixed",parent:(null===(n=e.find((e=>e.parent)))||void 0===n?void 0:n.parent)||null,tooltipSpace:(null===(i=e.find((e=>e.tooltipSpace)))||void 0===i?void 0:i.tooltipSpace)||Ms}}}),Ds=new WeakMap,Xs=Kn.fromClass(class{constructor(e){this.view=e,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=e.state.facet(Bs);this.position=t.position,this.parent=t.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver((()=>this.measureSoon())):null,this.manager=new Rs(e,Us,((e,t)=>this.createTooltip(e,t)),(e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()})),this.above=this.manager.tooltips.map((e=>!!e.above)),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),e.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let e of this.manager.tooltipViews)this.intersectionObserver.observe(e.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(e){e.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(e,this.above);t&&this.observeIntersection();let n=t||e.geometryChanged,i=e.state.facet(Bs);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let e of this.manager.tooltipViews)e.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let e of this.manager.tooltipViews)this.container.appendChild(e.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(e,t){let n=e.create(this.view),i=t?t.dom:null;if(n.dom.classList.add("cm-tooltip"),e.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",n.dom.insertBefore(e,i)}return n.dom.style.position=this.position,n.dom.style.top=Qs,n.dom.style.left="0px",this.container.insertBefore(n.dom,i),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var e,t,n;this.view.win.removeEventListener("resize",this.measureSoon);for(let t of this.manager.tooltipViews)t.dom.remove(),null===(e=t.destroy)||void 0===e||e.call(t);this.parent&&this.container.remove(),null===(t=this.resizeObserver)||void 0===t||t.disconnect(),null===(n=this.intersectionObserver)||void 0===n||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let e=this.view.dom.getBoundingClientRect(),t=1,n=1,i=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:e}=this.manager.tooltipViews[0];if(Zt.gecko)i=e.offsetParent!=this.container.ownerDocument.body;else if(e.style.top==Qs&&"0px"==e.style.left){let t=e.getBoundingClientRect();i=Math.abs(t.top+1e4)>1||Math.abs(t.left)>1}}if(i||"absolute"==this.position)if(this.parent){let e=this.parent.getBoundingClientRect();e.width&&e.height&&(t=e.width/this.parent.offsetWidth,n=e.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:n}=this.view.viewState);return{editor:e,parent:this.parent?this.container.getBoundingClientRect():e,pos:this.manager.tooltips.map(((e,t)=>{let n=this.manager.tooltipViews[t];return n.getCoords?n.getCoords(e.pos):this.view.coordsAtPos(e.pos)})),size:this.manager.tooltipViews.map((({dom:e})=>e.getBoundingClientRect())),space:this.view.state.facet(Bs).tooltipSpace(this.view),scaleX:t,scaleY:n,makeAbsolute:i}}writeMeasure(e){var t;if(e.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let e of this.manager.tooltipViews)e.dom.style.position="absolute"}let{editor:n,space:i,scaleX:r,scaleY:s}=e,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],h=this.manager.tooltipViews[a],{dom:c}=h,u=e.pos[a],d=e.size[a];if(!u||u.bottom<=Math.max(n.top,i.top)||u.top>=Math.min(n.bottom,i.bottom)||u.right<Math.max(n.left,i.left)-.1||u.left>Math.min(n.right,i.right)+.1){c.style.top=Qs;continue}let p=l.arrow?h.dom.querySelector(".cm-tooltip-arrow"):null,f=p?7:0,m=d.right-d.left,g=null!==(t=Ds.get(h))&&void 0!==t?t:d.bottom-d.top,O=h.offset||Ls,y=this.view.textDirection==yn.LTR,v=d.width>i.right-i.left?y?i.left:i.right-d.width:y?Math.min(u.left-(p?14:0)+O.x,i.right-m):Math.max(i.left,u.left-m+(p?14:0)-O.x),b=this.above[a];!l.strictSide&&(b?u.top-(d.bottom-d.top)-O.y<i.top:u.bottom+(d.bottom-d.top)+O.y>i.bottom)&&b==i.bottom-u.bottom>u.top-i.top&&(b=this.above[a]=!b);let w=(b?u.top-i.top:i.bottom-u.bottom)-f;if(w<g&&!1!==h.resize){if(w<this.view.defaultLineHeight){c.style.top=Qs;continue}Ds.set(h,g),c.style.height=(g=w)/s+"px"}else c.style.height&&(c.style.height="");let x=b?u.top-g-f-O.y:u.bottom+f+O.y,S=v+m;if(!0!==h.overlap)for(let e of o)e.left<S&&e.right>v&&e.top<x+g&&e.bottom>x&&(x=b?e.top-g-2-f:e.bottom+f+2);if("absolute"==this.position?(c.style.top=(x-e.parent.top)/s+"px",c.style.left=(v-e.parent.left)/r+"px"):(c.style.top=x/s+"px",c.style.left=v/r+"px"),p){let e=u.left+(y?O.x:-O.x)-(v+14-7);p.style.left=e/r+"px"}!0!==h.overlap&&o.push({left:v,top:x,right:S,bottom:x+g}),c.classList.toggle("cm-tooltip-above",b),c.classList.toggle("cm-tooltip-below",!b),h.positioned&&h.positioned(e.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let e of this.manager.tooltipViews)e.dom.style.top=Qs}},{eventObservers:{scroll(){this.maybeMeasure()}}}),Fs=Lr.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Ls={x:0,y:0},Us=U.define({enables:[Xs,Fs]}),Vs=U.define({combine:e=>e.reduce(((e,t)=>e.concat(t)),[])}),zs=class e{static create(t){return new e(t)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Rs(e,Vs,((e,t)=>this.createHostedView(e,t)),(e=>e.dom.remove()))}createHostedView(e,t){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)null===(e=t.destroy)||void 0===e||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let i=n[e];if(void 0!==i)if(void 0===t)t=i;else if(t!==i)return}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}},Zs=Us.compute([Vs],(e=>{let t=e.facet(Vs);return 0===t.length?null:{pos:Math.min(...t.map((e=>e.pos))),end:Math.max(...t.map((e=>{var t;return null!==(t=e.end)&&void 0!==t?t:e.pos}))),create:zs.create,above:t[0].above,arrow:t.some((e=>e.arrow))}}));function js(e,t){let n=e.plugin(Xs);if(!n)return null;let i=n.manager.tooltips.indexOf(t);return i<0?null:n.manager.tooltipViews[i]}var qs=Oe.define(),Gs=U.define({combine(e){let t,n;for(let i of e)t=t||i.topContainer,n=n||i.bottomContainer;return{topContainer:t,bottomContainer:n}}});function Ws(e,t){let n=e.plugin(Hs),i=n?n.specs.indexOf(t):-1;return i>-1?n.panels[i]:null}var Hs=Kn.fromClass(class{constructor(e){this.input=e.state.facet(Ks),this.specs=this.input.filter((e=>e)),this.panels=this.specs.map((t=>t(e)));let t=e.state.facet(Gs);this.top=new Ys(e,!0,t.topContainer),this.bottom=new Ys(e,!1,t.bottomContainer),this.top.sync(this.panels.filter((e=>e.top))),this.bottom.sync(this.panels.filter((e=>!e.top)));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(e){let t=e.state.facet(Gs);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Ys(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Ys(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=e.state.facet(Ks);if(n!=this.input){let t=n.filter((e=>e)),i=[],r=[],s=[],o=[];for(let n of t){let t,a=this.specs.indexOf(n);a<0?(t=n(e.view),o.push(t)):(t=this.panels[a],t.update&&t.update(e)),i.push(t),(t.top?r:s).push(t)}this.specs=t,this.panels=i,this.top.sync(r),this.bottom.sync(s);for(let e of o)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}else for(let t of this.panels)t.update&&t.update(e)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:e=>Lr.scrollMargins.of((t=>{let n=t.plugin(e);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}}))}),Ys=class{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Js(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Js(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}};function Js(e){let t=e.nextSibling;return e.remove(),t}var Ks=U.define({enables:Hs}),eo=class extends $e{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}};eo.prototype.elementClass="",eo.prototype.toDOM=void 0,eo.prototype.mapMode=T.TrackBefore,eo.prototype.startSide=eo.prototype.endSide=-1,eo.prototype.point=!0;var to=U.define(),no={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Qe.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},io=U.define();function ro(e){return[oo(),io.of(Object.assign(Object.assign({},no),e))]}var so=U.define({combine:e=>e.some((e=>e))});function oo(e){let t=[ao];return e&&!1===e.fixed&&t.push(so.of(!0)),t}var ao=Kn.fromClass(class{constructor(e){this.view=e,this.prevViewport=e.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=e.state.facet(io).map((t=>new uo(e,t)));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!e.state.facet(so),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),e.scrollDOM.insertBefore(this.dom,e.contentDOM)}update(e){if(this.updateGutters(e)){let t=this.prevViewport,n=e.view.viewport,i=Math.min(t.to,n.to)-Math.max(t.from,n.from);this.syncGutters(i<.8*(n.to-n.from))}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(so)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;e&&this.dom.remove();let n=Qe.iter(this.view.state.facet(to),this.view.viewport.from),i=[],r=this.gutters.map((e=>new co(e,this.view.viewport,-this.view.documentPadding.top)));for(let e of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(e.type)){let t=!0;for(let s of e.type)if(s.type==ln.Text&&t){ho(n,i,s.from);for(let e of r)e.line(this.view,s,i);t=!1}else if(s.widget)for(let e of r)e.widget(this.view,s)}else if(e.type==ln.Text){ho(n,i,e.from);for(let t of r)t.line(this.view,e,i)}else if(e.widget)for(let t of r)t.widget(this.view,e);for(let e of r)e.finish();e&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(e){let t=e.startState.facet(io),n=e.state.facet(io),i=e.docChanged||e.heightChanged||e.viewportChanged||!Qe.eq(e.startState.facet(to),e.state.facet(to),e.view.viewport.from,e.view.viewport.to);if(t==n)for(let t of this.gutters)t.update(e)&&(i=!0);else{i=!0;let r=[];for(let i of n){let n=t.indexOf(i);n<0?r.push(new uo(this.view,i)):(this.gutters[n].update(e),r.push(this.gutters[n]))}for(let e of this.gutters)e.dom.remove(),r.indexOf(e)<0&&e.destroy();for(let e of r)this.dom.appendChild(e.dom);this.gutters=r}return i}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove()}},{provide:e=>Lr.scrollMargins.of((t=>{let n=t.plugin(e);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==yn.LTR?{left:n.dom.offsetWidth*t.scaleX}:{right:n.dom.offsetWidth*t.scaleX}:null}))});function lo(e){return Array.isArray(e)?e:[e]}function ho(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next()}var co=class{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=Qe.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:i}=this,r=(t.top-this.height)/e.scaleY,s=t.height/e.scaleY;if(this.i==i.elements.length){let t=new po(e,s,r,n);i.elements.push(t),i.dom.appendChild(t.dom)}else i.elements[this.i].update(e,s,r,n);this.height=t.bottom,this.i++}line(e,t,n){let i=[];ho(this.cursor,i,t.from),n.length&&(i=i.concat(n));let r=this.gutter.config.lineMarker(e,t,i);r&&i.unshift(r);let s=this.gutter;0==i.length&&!s.config.renderEmptyElements||this.addElement(e,t,i)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t);n&&this.addElement(e,t,[n])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}},uo=class{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,(i=>{let r,s=i.target;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let e=s.getBoundingClientRect();r=(e.top+e.bottom)/2}else r=i.clientY;let o=e.lineBlockAtHeight(r-e.documentTop);t.domEventHandlers[n](e,o,i)&&i.preventDefault()}));this.markers=lo(t.markers(e)),t.initialSpacer&&(this.spacer=new po(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=lo(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let t=this.config.updateSpacer(this.spacer.markers[0],e);t!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[t])}let n=e.view.viewport;return!Qe.eq(this.markers,t,n.from,n.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}destroy(){for(let e of this.elements)e.destroy()}},po=class{constructor(e,t,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,i)}update(e,t,n,i){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),function(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0}(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let n="cm-gutterElement",i=this.dom.firstChild;for(let r=0,s=0;;){let o=s,a=r<t.length?t[r++]:null,l=!1;if(a){let e=a.elementClass;e&&(n+=" "+e);for(let e=s;e<this.markers.length;e++)if(this.markers[e].compare(a)){o=e,l=!0;break}}else o=this.markers.length;for(;s<o;){let e=this.markers[s++];if(e.toDOM){e.destroy(i);let t=i.nextSibling;i.remove(),i=t}}if(!a)break;a.toDOM&&(l?i=i.nextSibling:this.dom.insertBefore(a.toDOM(e),i)),l&&s++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}};var fo=U.define(),mo=U.define({combine:e=>Pe(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let e in t){let i=n[e],r=t[e];n[e]=i?(e,t,n)=>i(e,t,n)||r(e,t,n):r}return n}})}),go=class extends eo{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}};function Oo(e,t){return e.state.facet(mo).formatNumber(t,e.state)}var yo=io.compute([mo],(e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:e=>e.state.facet(fo),lineMarker:(e,t,n)=>n.some((e=>e.toDOM))?null:new go(Oo(e,e.state.doc.lineAt(t.from).number)),widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(mo)!=e.state.facet(mo),initialSpacer:e=>new go(Oo(e,vo(e.state.doc.lines))),updateSpacer(e,t){let n=Oo(t.view,vo(t.view.state.doc.lines));return n==e.number?e:new go(n)},domEventHandlers:e.facet(mo).domEventHandlers})));function vo(e){let t=9;for(;t<e;)t=10*t+9;return t}var bo=new class extends eo{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},wo=to.compute(["selection"],(e=>{let t=[],n=-1;for(let i of e.selection.ranges){let r=e.doc.lineAt(i.head).from;r>n&&(n=r,t.push(bo.range(r)))}return Qe.of(t)}));var xo=0,So=class{constructor(e,t){this.from=e,this.to=t}},ko=class{constructor(e={}){this.id=xo++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=_o.match(e)),t=>{let n=e(t);return void 0===n?null:[this,n]}}};ko.closedBy=new ko({deserialize:e=>e.split(" ")}),ko.openedBy=new ko({deserialize:e=>e.split(" ")}),ko.group=new ko({deserialize:e=>e.split(" ")}),ko.isolate=new ko({deserialize:e=>{if(e&&"rtl"!=e&&"ltr"!=e&&"auto"!=e)throw new RangeError("Invalid value for isolate: "+e);return e||"auto"}}),ko.contextHash=new ko({perNode:!0}),ko.lookAhead=new ko({perNode:!0}),ko.mounted=new ko({perNode:!0});var Ao=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[ko.mounted.id]}},Co=Object.create(null),_o=class e{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(t){let n=t.props&&t.props.length?Object.create(null):Co,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),r=new e(t.name||"",n,t.id,i);if(t.props)for(let e of t.props)if(Array.isArray(e)||(e=e(r)),e){if(e[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[e[0].id]=e[1]}return r}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(ko.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return e=>{for(let n=e.prop(ko.group),i=-1;i<(n?n.length:0);i++){let r=t[i<0?e.name:n[i]];if(r)return r}}}};_o.none=new _o("",Object.create(null),0,8);var Eo,To=class e{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let n=[];for(let e of this.types){let i=null;for(let n of t){let t=n(e);t&&(i||(i=Object.assign({},e.props)),i[t[0].id]=t[1])}n.push(i?new _o(e.name,i,e.id,e.flags):e)}return new e(n)}},Po=new WeakMap,$o=new WeakMap;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"}(Eo||(Eo={}));var No=class e{constructor(e,t,n,i,r){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,r&&r.length){this.props=Object.create(null);for(let[e,t]of r)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=Ao.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let n=e.toString();n&&(t&&(t+=","),t+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new zo(this.topNode,e)}cursorAt(e,t=0,n=0){let i=Po.get(this)||this.topNode,r=new zo(i);return r.moveTo(e,t),Po.set(this,r._tree),r}get topNode(){return new Bo(this,0,0,null)}resolve(e,t=0){let n=Ro(Po.get(this)||this.topNode,e,t,!1);return Po.set(this,n),n}resolveInner(e,t=0){let n=Ro($o.get(this)||this.topNode,e,t,!0);return $o.set(this,n),n}resolveStack(e,t=0){return function(e,t,n){let i=e.resolveInner(t,n),r=null;for(let e=i instanceof Bo?i:i.context.parent;e;e=e.parent)if(e.index<0){let s=e.parent;(r||(r=[i])).push(s.resolve(t,n)),e=s}else{let s=Ao.get(e.tree);if(s&&s.overlay&&s.overlay[0].from<=t&&s.overlay[s.overlay.length-1].to>=t){let o=new Bo(s.tree,s.overlay[0].from+e.from,-1,e);(r||(r=[i])).push(Ro(o,t,n,!1))}}return r?Uo(r):i}(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:r=this.length}=e,s=e.mode||0,o=(s&Eo.IncludeAnonymous)>0;for(let e=this.cursor(s|Eo.IncludeAnonymous);;){let s=!1;if(e.from<=r&&e.to>=i&&(!o&&e.type.isAnonymous||!1!==t(e))){if(e.firstChild())continue;s=!0}for(;s&&n&&(o||!e.type.isAnonymous)&&n(e),!e.nextSibling();){if(!e.parent())return;s=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(t={}){return this.children.length<=8?this:Go(_o.none,this.children,this.positions,0,this.children.length,0,this.length,((t,n,i)=>new e(this.type,t,n,i,this.propValues)),t.makeTree||((t,n,i)=>new e(_o.none,t,n,i)))}static build(e){return function(e){var t;let{buffer:n,nodeSet:i,maxBufferLength:r=1024,reused:s=[],minRepeatType:o=i.types.length}=e,a=Array.isArray(n)?new class e{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new e(this.buffer,this.index)}}(n,n.length):n,l=i.types,h=0,c=0;function u(e,t,n,y,v,b){let{id:w,start:x,end:S,size:k}=a,A=c;for(;k<0;){if(a.next(),-1==k){let t=s[w];return n.push(t),void y.push(x-e)}if(-3==k)return void(h=w);if(-4==k)return void(c=w);throw new RangeError(`Unrecognized record size: ${k}`)}let C,_,E=l[w],T=x-e;if(S-x<=r&&(_=g(a.pos-t,v))){let t=new Uint16Array(_.size-_.skip),n=a.pos-_.size,r=t.length;for(;a.pos>n;)r=O(_.start,t,r);C=new Io(t,S-_.start,i),T=_.start-e}else{let e=a.pos-k;a.next();let t=[],n=[],i=w>=o?w:-1,s=0,l=S;for(;a.pos>e;)i>=0&&a.id==i&&a.size>=0?(a.end<=l-r&&(f(t,n,x,s,a.end,l,i,A),s=t.length,l=a.end),a.next()):b>2500?d(x,e,t,n):u(x,e,t,n,i,b+1);if(i>=0&&s>0&&s<t.length&&f(t,n,x,s,x,l,i,A),t.reverse(),n.reverse(),i>-1&&s>0){let e=p(E);C=Go(E,t,n,0,t.length,0,S-x,e,e)}else C=m(E,t,n,S-x,A-S)}n.push(C),y.push(T)}function d(e,t,n,s){let o=[],l=0,h=-1;for(;a.pos>t;){let{id:e,start:t,end:n,size:i}=a;if(i>4)a.next();else{if(h>-1&&t<h)break;h<0&&(h=n-r),o.push(e,t,n),l++,a.next()}}if(l){let t=new Uint16Array(4*l),r=o[o.length-2];for(let e=o.length-3,n=0;e>=0;e-=3)t[n++]=o[e],t[n++]=o[e+1]-r,t[n++]=o[e+2]-r,t[n++]=n;n.push(new Io(t,o[2]-r,i)),s.push(r-e)}}function p(e){return(t,n,i)=>{let r,s,o=0,a=t.length-1;if(a>=0&&(r=t[a])instanceof No){if(!a&&r.type==e&&r.length==i)return r;(s=r.prop(ko.lookAhead))&&(o=n[a]+r.length+s)}return m(e,t,n,i,o)}}function f(e,t,n,r,s,o,a,l){let h=[],c=[];for(;e.length>r;)h.push(e.pop()),c.push(t.pop()+n-s);e.push(m(i.types[a],h,c,o-s,l-o)),t.push(s-n)}function m(e,t,n,i,r=0,s){if(h){let e=[ko.contextHash,h];s=s?[e].concat(s):[e]}if(r>25){let e=[ko.lookAhead,r];s=s?[e].concat(s):[e]}return new No(e,t,n,i,s)}function g(e,t){let n=a.fork(),i=0,s=0,l=0,h=n.end-r,c={size:0,start:0,skip:0};e:for(let r=n.pos-e;n.pos>r;){let e=n.size;if(n.id==t&&e>=0){c.size=i,c.start=s,c.skip=l,l+=4,i+=4,n.next();continue}let a=n.pos-e;if(e<0||a<r||n.start<h)break;let u=n.id>=o?4:0,d=n.start;for(n.next();n.pos>a;){if(n.size<0){if(-3!=n.size)break e;u+=4}else n.id>=o&&(u+=4);n.next()}s=d,i+=e,l+=u}return(t<0||i==e)&&(c.size=i,c.start=s,c.skip=l),c.size>4?c:void 0}function O(e,t,n){let{id:i,start:r,end:s,size:l}=a;if(a.next(),l>=0&&i<o){let o=n;if(l>4){let i=a.pos-(l-4);for(;a.pos>i;)n=O(e,t,n)}t[--n]=o,t[--n]=s-e,t[--n]=r-e,t[--n]=i}else-3==l?h=i:-4==l&&(c=i);return n}let y=[],v=[];for(;a.pos>0;)u(e.start||0,e.bufferStart||0,y,v,-1,0);let b=null!==(t=e.length)&&void 0!==t?t:y.length?v[0]+y[0].length:0;return new No(l[e.topID],y.reverse(),v.reverse(),b)}(e)}};No.empty=new No(_o.none,[],[],0);var Io=class e{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return _o.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],r=i.name;if(/\W/.test(r)&&!i.isError&&(r=JSON.stringify(r)),n==(e+=4))return r;let s=[];for(;e<n;)s.push(this.childString(e)),e=this.buffer[e+3];return r+"("+s.join(",")+")"}findChild(e,t,n,i,r){let{buffer:s}=this,o=-1;for(let a=e;a!=t&&!(Qo(r,i,s[a+1],s[a+2])&&(o=a,n>0));a=s[a+3]);return o}slice(t,n,i){let r=this.buffer,s=new Uint16Array(n-t),o=0;for(let e=t,a=0;e<n;){s[a++]=r[e++],s[a++]=r[e++]-i;let n=s[a++]=r[e++]-i;s[a++]=r[e++]-t,o=Math.max(o,n)}return new e(s,o,this.set)}};function Qo(e,t,n,i){switch(e){case-2:return n<t;case-1:return i>=t&&n<t;case 0:return n<t&&i>t;case 1:return n<=t&&i>t;case 2:return i>t;case 4:return!0}}function Ro(e,t,n,i){for(var r;e.from==e.to||(n<1?e.from>=t:e.from>t)||(n>-1?e.to<=t:e.to<t);){let t=!i&&e instanceof Bo&&e.index<0?null:e.parent;if(!t)return e;e=t}let s=i?0:Eo.IgnoreOverlays;if(i)for(let i=e,o=i.parent;o;i=o,o=i.parent)i instanceof Bo&&i.index<0&&(null===(r=o.enter(t,n,s))||void 0===r?void 0:r.from)!=i.from&&(e=o);for(;;){let i=e.enter(t,n,s);if(!i)return e;e=i}}var Mo=class{cursor(e=0){return new zo(this,e)}getChild(e,t=null,n=null){let i=Do(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return Do(this,e,t,n)}resolve(e,t=0){return Ro(this,e,t,!1)}resolveInner(e,t=0){return Ro(this,e,t,!0)}matchContext(e){return Xo(this,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let e=t.lastChild;if(!e||e.to!=t.to)break;e.type.isError&&e.from==e.to?(n=t,t=e.prevSibling):t=e}return n}get node(){return this}get next(){return this.parent}},Bo=class e extends Mo{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,n,i,r,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,h=n>0?a.length:-1;t!=h;t+=n){let h=a[t],c=l[t]+o.from;if(Qo(r,i,c,c+h.length))if(h instanceof Io){if(s&Eo.ExcludeBuffers)continue;let e=h.findChild(0,h.buffer.length,n,i-c,r);if(e>-1)return new Lo(new Fo(o,h,t,c),null,e)}else if(s&Eo.IncludeAnonymous||!h.type.isAnonymous||Zo(h)){let a;if(!(s&Eo.IgnoreMounts)&&(a=Ao.get(h))&&!a.overlay)return new e(a.tree,c,t,o);let l=new e(h,c,t,o);return s&Eo.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(n<0?h.children.length-1:0,n,i,r)}}if(s&Eo.IncludeAnonymous||!o.type.isAnonymous||(t=o.index>=0?o.index+n:n<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(t,n,i=0){let r;if(!(i&Eo.IgnoreOverlays)&&(r=Ao.get(this._tree))&&r.overlay){let i=t-this.from;for(let{from:t,to:s}of r.overlay)if((n>0?t<=i:t<i)&&(n<0?s>=i:s>i))return new e(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,n,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function Do(e,t,n,i){let r=e.cursor(),s=[];if(!r.firstChild())return s;if(null!=n)for(let e=!1;!e;)if(e=r.type.is(n),!r.nextSibling())return s;for(;;){if(null!=i&&r.type.is(i))return s;if(r.type.is(t)&&s.push(r.node),!r.nextSibling())return null==i?s:[]}}function Xo(e,t,n=t.length-1){for(let i=e.parent;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[n]&&t[n]!=i.name)return!1;n--}}return!0}var Fo=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},Lo=class e extends Mo{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(t,n,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t,n-this.context.start,i);return s<0?null:new e(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(t,n,i=0){if(i&Eo.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],n>0?1:-1,t-this.context.start,n);return s<0?null:new e(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:t}=this.context,n=t.buffer[this.index+3];return n<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new e(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new e(this.context,this._parent,t.findChild(n,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,r=n.buffer[this.index+3];if(r>i){let s=n.buffer[this.index+1];e.push(n.slice(i,r,s)),t.push(0)}return new No(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function Uo(e){if(!e.length)return null;let t=0,n=e[0];for(let i=1;i<e.length;i++){let r=e[i];(r.from>n.from||r.to<n.to)&&(n=r,t=i)}let i=n instanceof Bo&&n.index<0?null:n.parent,r=e.slice();return i?r[t]=i:r.splice(t,1),new Vo(r,n)}var Vo=class{constructor(e,t){this.heads=e,this.node=t}get next(){return Uo(this.heads)}};var zo=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Bo)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return!!e&&(e instanceof Bo?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,r=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?!(n&Eo.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Eo.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Eo.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let e=n<0?0:this.stack[n]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(e)}return n<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(i.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;({index:t,_parent:n}=n))if(t>-1)for(let i=t+e,r=e<0?-1:n._tree.children.length;i!=r;i+=e){let e=n._tree.children[i];if(this.mode&Eo.IncludeAnonymous||e instanceof Io||!e.type.isAnonymous||Zo(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,r=this.stack.length;r>=0;){for(let s=e;s;s=s._parent)if(s.index==i){if(i==this.index)return s;t=s,n=r+1;break e}i=this.stack[--r]}for(let e=n;e<this.stack.length;e++)t=new Lo(this.buffer,t,this.stack[e]);return this.bufferNode=new Lo(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;i&&t&&t(this),i=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return Xo(this.node,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,r=this.stack.length-1;i>=0;r--){if(r<0)return Xo(this.node,e,i);let s=n[t.buffer[this.stack[r]]];if(!s.isAnonymous){if(e[i]&&e[i]!=s.name)return!1;i--}}return!0}};function Zo(e){return e.children.some((e=>e instanceof Io||!e.type.isAnonymous||Zo(e)))}var jo=new WeakMap;function qo(e,t){if(!e.isAnonymous||t instanceof Io||t.type!=e)return 1;let n=jo.get(t);if(null==n){n=1;for(let i of t.children){if(i.type!=e||!(i instanceof No)){n=1;break}n+=qo(e,i)}jo.set(t,n)}return n}function Go(e,t,n,i,r,s,o,a,l){let h=0;for(let n=i;n<r;n++)h+=qo(e,t[n]);let c=Math.ceil(1.5*h/8),u=[],d=[];return function t(n,i,r,o,a){for(let h=r;h<o;){let r=h,p=i[h],f=qo(e,n[h]);for(h++;h<o;h++){let t=qo(e,n[h]);if(f+t>=c)break;f+=t}if(h==r+1){if(f>c){let e=n[r];t(e.children,e.positions,0,e.children.length,i[r]+a);continue}u.push(n[r])}else{let t=i[h-1]+n[h-1].length-p;u.push(Go(e,n,i,r,h,p,t,null,l))}d.push(p+a-s)}}(t,n,i,r,0),(a||l)(u,d,o)}var Wo=class{constructor(){this.map=new WeakMap}setBuffer(e,t,n){let i=this.map.get(e);i||this.map.set(e,i=new Map),i.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof Lo?this.setBuffer(e.context.buffer,e.index,t):e instanceof Bo&&this.map.set(e.tree,t)}get(e){return e instanceof Lo?this.getBuffer(e.context.buffer,e.index):e instanceof Bo?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}},Ho=class e{constructor(e,t,n,i,r=!1,s=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,n=[],i=!1){let r=[new e(0,t.length,t,0,!1,i)];for(let e of n)e.to>t.length&&r.push(e);return r}static applyChanges(t,n,i=128){if(!n.length)return t;let r=[],s=1,o=t.length?t[0]:null;for(let a=0,l=0,h=0;;a++){let c=a<n.length?n[a]:null,u=c?c.fromA:1e9;if(u-l>=i)for(;o&&o.from<u;){let n=o;if(l>=n.from||u<=n.to||h){let t=Math.max(n.from,l)-h,i=Math.min(n.to,u)-h;n=t>=i?null:new e(t,i,n.tree,n.offset+h,a>0,!!c)}if(n&&r.push(n),o.to>u)break;o=s<t.length?t[s++]:null}if(!c)break;l=c.toA,h=c.toA-c.toB}return r}},Yo=class{startParse(e,t,n){return"string"==typeof e&&(e=new Jo(e)),n=n?n.length?n.map((e=>new So(e.from,e.to))):[new So(0,0)]:[new So(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let e=i.advance();if(e)return e}}},Jo=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};function Ko(e){return(t,n,i,r)=>new ra(t,e,n,i,r)}var ea=class{constructor(e,t,n,i,r){this.parser=e,this.parse=t,this.overlay=n,this.target=i,this.from=r}};function ta(e){if(!e.length||e.some((e=>e.from>=e.to)))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(e))}var na=class{constructor(e,t,n,i,r,s,o){this.parser=e,this.predicate=t,this.mounts=n,this.index=i,this.start=r,this.target=s,this.prev=o,this.depth=0,this.ranges=[]}},ia=new ko({perNode:!0}),ra=class{constructor(e,t,n,i,r){this.nest=t,this.input=n,this.fragments=i,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let e=this.baseParse.advance();if(!e)return null;if(this.baseParse=null,this.baseTree=e,this.startInner(),null!=this.stoppedAt)for(let e of this.inner)e.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let e=this.baseTree;return null!=this.stoppedAt&&(e=new No(e.type,e.children,e.positions,e.length,e.propValues.concat([[ia,this.stoppedAt]]))),e}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[ko.mounted.id]=new Ao(t,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new ha(this.fragments),t=null,n=null,i=new zo(new Bo(this.baseTree,this.ranges[0].from,0,null),Eo.IncludeAnonymous|Eo.IgnoreMounts);e:for(let r,s;;){let o,a=!0;if(null!=this.stoppedAt&&i.from>=this.stoppedAt)a=!1;else if(e.hasNode(i)){if(t){let e=t.mounts.find((e=>e.frag.from<=i.from&&e.frag.to>=i.to&&e.mount.overlay));if(e)for(let n of e.mount.overlay){let r=n.from+e.pos,s=n.to+e.pos;r>=i.from&&s<=i.to&&!t.ranges.some((e=>e.from<s&&e.to>r))&&t.ranges.push({from:r,to:s})}}a=!1}else if(n&&(s=sa(n.ranges,i.from,i.to)))a=2!=s;else if(!i.type.isAnonymous&&(r=this.nest(i,this.input))&&(i.from<i.to||!r.overlay)){i.tree||aa(i);let s=e.findMounts(i.from,r.parser);if("function"==typeof r.overlay)t=new na(r.parser,r.overlay,s,this.inner.length,i.from,i.tree,t);else{let e=ca(this.ranges,r.overlay||(i.from<i.to?[new So(i.from,i.to)]:[]));e.length&&ta(e),(e.length||!r.overlay)&&this.inner.push(new ea(r.parser,e.length?r.parser.startParse(this.input,da(s,e),e):r.parser.startParse(""),r.overlay?r.overlay.map((e=>new So(e.from-i.from,e.to-i.from))):null,i.tree,e.length?e[0].from:i.from)),r.overlay?e.length&&(n={ranges:e,depth:0,prev:n}):a=!1}}else t&&(o=t.predicate(i))&&(!0===o&&(o=new So(i.from,i.to)),o.from<o.to&&t.ranges.push(o));if(a&&i.firstChild())t&&t.depth++,n&&n.depth++;else for(;!i.nextSibling();){if(!i.parent())break e;if(t&&!--t.depth){let e=ca(this.ranges,t.ranges);e.length&&(ta(e),this.inner.splice(t.index,0,new ea(t.parser,t.parser.startParse(this.input,da(t.mounts,e),e),t.ranges.map((e=>new So(e.from-t.start,e.to-t.start))),t.target,e[0].from))),t=t.prev}n&&!--n.depth&&(n=n.prev)}}}};function sa(e,t,n){for(let i of e){if(i.from>=n)break;if(i.to>t)return i.from<=t&&i.to>=n?2:1}return 0}function oa(e,t,n,i,r,s){if(t<n){let o=e.buffer[t+1];i.push(e.slice(t,n,o)),r.push(o-s)}}function aa(e){let{node:t}=e,n=[],i=t.context.buffer;do{n.push(e.index),e.parent()}while(!e.tree);let r=e.tree,s=r.children.indexOf(i),o=r.children[s],a=o.buffer,l=[s];r.children[s]=function e(i,r,s,h,c,u){let d=n[u],p=[],f=[];oa(o,i,d,p,f,h);let m=a[d+1],g=a[d+2];l.push(p.length);let O=u?e(d+4,a[d+3],o.set.types[a[d]],m,g-m,u-1):t.toTree();return p.push(O),f.push(m-h),oa(o,a[d+3],r,p,f,h),new No(s,p,f,c)}(0,a.length,_o.none,0,o.length,n.length-1);for(let t of l){let n=e.tree.children[t],i=e.tree.positions[t];e.yield(new Bo(n,i+e.from,t,e._tree))}}var la=class{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(Eo.IncludeAnonymous|Eo.IgnoreMounts)}moveTo(e){let{cursor:t}=this,n=e-this.offset;for(;!this.done&&t.from<n;)t.to>=e&&t.enter(n,1,Eo.IgnoreOverlays|Eo.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(!(t.children.length&&0==t.positions[0]&&t.children[0]instanceof No))break;t=t.children[0]}return!1}},ha=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=null!==(t=n.tree.prop(ia))&&void 0!==t?t:n.to,this.inner=new la(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=null!==(e=t.tree.prop(ia))&&void 0!==e?e:t.to,this.inner=new la(t.tree,-t.offset)}}findMounts(e,t){var n;let i=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let e=this.inner.cursor.node;e;e=e.parent){let r=null===(n=e.tree)||void 0===n?void 0:n.prop(ko.mounted);if(r&&r.parser==t)for(let t=this.fragI;t<this.fragments.length;t++){let n=this.fragments[t];if(n.from>=e.to)break;n.tree==this.curFrag.tree&&i.push({frag:n,pos:e.from-n.offset,mount:r})}}}return i}};function ca(e,t){let n=null,i=t;for(let r=1,s=0;r<e.length;r++){let o=e[r-1].to,a=e[r].from;for(;s<i.length;s++){let e=i[s];if(e.from>=a)break;e.to<=o||(n||(i=n=t.slice()),e.from<o?(n[s]=new So(e.from,o),e.to>a&&n.splice(s+1,0,new So(a,e.to))):e.to>a?n[s--]=new So(a,e.to):n.splice(s--,1))}}return i}function ua(e,t,n,i){let r=0,s=0,o=!1,a=!1,l=-1e9,h=[];for(;;){let c=r==e.length?1e9:o?e[r].to:e[r].from,u=s==t.length?1e9:a?t[s].to:t[s].from;if(o!=a){let e=Math.max(l,n),t=Math.min(c,u,i);e<t&&h.push(new So(e,t))}if(l=Math.min(c,u),1e9==l)break;c==l&&(o?(o=!1,r++):o=!0),u==l&&(a?(a=!1,s++):a=!0)}return h}function da(e,t){let n=[];for(let{pos:i,mount:r,frag:s}of e){let e=i+(r.overlay?r.overlay[0].from:0),o=e+r.tree.length,a=Math.max(s.from,e),l=Math.min(s.to,o);if(r.overlay){let o=r.overlay.map((e=>new So(e.from+i,e.to+i))),h=ua(t,o,a,l);for(let t=0,i=a;;t++){let o=t==h.length,a=o?l:h[t].from;if(a>i&&n.push(new Ho(i,a,r.tree,-e,s.from>=i||s.openStart,s.to<=a||s.openEnd)),o)break;i=h[t].to}}else n.push(new Ho(a,l,r.tree,-e,s.from>=e||s.openStart,s.to<=o||s.openEnd))}return n}var pa,fa=class e{constructor(e,t,n,i,r,s,o,a,l,h=0,c){this.p=e,this.stack=t,this.state=n,this.reducePos=i,this.pos=r,this.score=s,this.buffer=o,this.bufferBase=a,this.curContext=l,this.lookAhead=h,this.parent=c}toString(){return`[${this.stack.filter(((e,t)=>t%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,n,i=0){let r=t.parser.context;return new e(t,[],n,i,i,0,[],0,r?new ma(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,i=65535&e,{parser:r}=this.p,s=r.dynamicPrecedence(i);if(s&&(this.score+=s),0==n)return this.pushState(r.getGoto(this.state,i,!0),this.reducePos),i<r.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),void this.reduceContext(i,this.reducePos);let o=this.stack.length-3*(n-1)-(262144&e?6:0),a=o?this.stack[o-2]:this.p.ranges[0].from,l=this.reducePos-a;l>=2e3&&(null===(t=this.p.parser.nodeSet.types[i])||void 0===t||!t.isAnonymous)&&(a==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=l):this.p.lastBigReductionSize<l&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=a,this.p.lastBigReductionSize=l));let h=o?this.stack[o-1]:0,c=this.bufferBase+this.buffer.length-h;if(i<r.minRepeatTerm||131072&e){let e=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,a,e,c+4,!0)}if(262144&e)this.state=this.stack[o];else{let e=this.stack[o-3];this.state=r.getGoto(e,i,!0)}for(;this.stack.length>o;)this.stack.pop();this.reduceContext(i,a)}storeNode(e,t,n,i=4,r=!1){if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let e=this,i=this.buffer.length;if(0==i&&e.parent&&(i=e.bufferBase-e.parent.bufferBase,e=e.parent),i>0&&0==e.buffer[i-4]&&e.buffer[i-1]>-1){if(t==n)return;if(e.buffer[i-2]>=t)return void(e.buffer[i-2]=n)}}if(r&&this.pos!=n){let r=this.buffer.length;if(r>0&&0!=this.buffer[r-4])for(;r>0&&this.buffer[r-2]>n;)this.buffer[r]=this.buffer[r-4],this.buffer[r+1]=this.buffer[r-3],this.buffer[r+2]=this.buffer[r-2],this.buffer[r+3]=this.buffer[r-1],r-=4,i>4&&(i-=4);this.buffer[r]=e,this.buffer[r+1]=t,this.buffer[r+2]=n,this.buffer[r+3]=i}else this.buffer.push(e,t,n,i)}shift(e,t,n){let i=this.pos;if(131072&e)this.pushState(65535&e,this.pos);else if(262144&e)this.pos=n,this.shiftContext(t,i),t<=this.p.parser.maxNode&&this.buffer.push(t,i,n,4);else{let r=e,{parser:s}=this.p;(n>this.pos||t<=s.maxNode)&&(this.pos=n,s.stateFlag(r,1)||(this.reducePos=n)),this.pushState(r,i),this.shiftContext(t,i),t<=s.maxNode&&this.buffer.push(t,i,n,4)}}apply(e,t,n){65536&e?this.reduce(e):this.shift(e,t,n)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(t,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let t=this,n=t.buffer.length;for(;n>0&&t.buffer[n-2]>t.reducePos;)n-=4;let i=t.buffer.slice(n),r=t.bufferBase+n;for(;t&&r==t.bufferBase;)t=t.parent;return new e(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,r,this.curContext,this.lookAhead,t)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new ga(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==n)return!1;if(!(65536&n))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let n=[];for(let i,r=0;r<t.length;r+=2)(i=t[r+1])!=this.state&&this.p.parser.hasAction(i,e)&&n.push(t[r],i);if(this.stack.length<120)for(let e=0;n.length<8&&e<t.length;e+=2){let i=t[e+1];n.some(((e,t)=>1&t&&e==i))||n.push(t[e],i)}t=n}let n=[];for(let e=0;e<t.length&&n.length<4;e+=2){let i=t[e+1];if(i==this.state)continue;let r=this.split();r.pushState(i,this.pos),r.storeNode(0,r.pos,r.pos,4,!0),r.shiftContext(t[e],this.pos),r.score-=200,n.push(r)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(65536&t))return!1;if(!e.validAction(this.state,t)){let n=t>>19,i=65535&t,r=this.stack.length-3*n;if(r<0||e.getGoto(this.stack[r],i,!1)<0){let e=this.findForcedReduction();if(null==e)return!1;t=e}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(i,r)=>{if(!t.includes(i))return t.push(i),e.allActions(i,(t=>{if(!(393216&t))if(65536&t){let n=(t>>19)-r;if(n>1){let i=65535&t,r=this.stack.length-3*n;if(r>=0&&e.getGoto(this.stack[r],i,!1)>=0)return n<<19|65536|i}}else{let e=n(t,r+1);if(null!=e)return e}}))};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new ma(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}},ma=class{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}};!function(e){e[e.Insert=200]="Insert",e[e.Delete=190]="Delete",e[e.Reduce=100]="Reduce",e[e.MaxNext=4]="MaxNext",e[e.MaxInsertStackDepth=300]="MaxInsertStackDepth",e[e.DampenInsertStackDepth=120]="DampenInsertStackDepth",e[e.MinBigReduction=2e3]="MinBigReduction"}(pa||(pa={}));var ga=class{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=65535&e,n=e>>19;0==n?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(n-1);let i=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=i}},Oa=class e{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(t,n=t.bufferBase+t.buffer.length){return new e(t,n,n-t.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new e(this.stack,this.pos,this.index)}};function ya(e,t=Uint16Array){if("string"!=typeof e)return e;let n=null;for(let i=0,r=0;i<e.length;){let s=0;for(;;){let t=e.charCodeAt(i++),n=!1;if(126==t){s=65535;break}t>=92&&t--,t>=34&&t--;let r=t-32;if(r>=46&&(r-=46,n=!0),s+=r,n)break;s*=46}n?n[r++]=s:n=new t(s)}return n}var va=class{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}},ba=new va,wa=class{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;ka(this.data,e,t,this.id,n.data,n.tokenPrecTable)}};wa.prototype.contextual=wa.prototype.fallback=wa.prototype.extend=!1;var xa=class{constructor(e,t,n){this.precTable=t,this.elseToken=n,this.data="string"==typeof e?ya(e):e}token(e,t){let n=e.pos,i=0;for(;;){let n=e.next<0,r=e.resolveOffset(1,1);if(ka(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(null==this.elseToken)return;if(n||i++,null==r)break;e.reset(r,e.token)}i&&(e.reset(n,e.token),e.acceptToken(this.elseToken,i))}};xa.prototype.contextual=wa.prototype.fallback=wa.prototype.extend=!1;var Sa=class{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}};function ka(e,t,n,i,r,s){let o=0,a=1<<i,{dialect:l}=n.p.parser;e:for(;a&e[o];){let n=e[o+1];for(let i=o+3;i<n;i+=2)if((e[i+1]&a)>0){let n=e[i];if(l.allows(n)&&(-1==t.token.value||t.token.value==n||Ca(n,t.token.value,r,s))){t.acceptToken(n);break}}let i=t.next,h=0,c=e[o+2];if(!(t.next<0&&c>h&&65535==e[n+3*c-3]&&65535==e[n+3*c-3])){for(;h<c;){let r=h+c>>1,s=n+r+(r<<1),a=e[s],l=e[s+1]||65536;if(i<a)c=r;else{if(!(i>=l)){o=e[s+2],t.advance();continue e}h=r+1}}break}o=e[n+3*c-1]}}function Aa(e,t,n){for(let i,r=t;65535!=(i=e[r]);r++)if(i==n)return r-t;return-1}function Ca(e,t,n,i){let r=Aa(n,i,t);return r<0||Aa(n,i,e)<r}var _a,Ea=typeof process<"u"&&process.env&&/\bparse\b/.test(process.env.LOG),Ta=null;function Pa(e,t,n){let i=e.cursor(Eo.IncludeAnonymous);for(i.moveTo(t);;)if(!(n<0?i.childBefore(t):i.childAfter(t)))for(;;){if((n<0?i.to<t:i.from>t)&&!i.type.isError)return n<0?Math.max(0,Math.min(i.to-1,t-25)):Math.min(e.length,Math.max(i.from+1,t+25));if(n<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return n<0?0:e.length}}!function(e){e[e.Margin=25]="Margin"}(_a||(_a={}));var $a;!function(e){e[e.Distance=5]="Distance",e[e.MaxRemainingPerStep=3]="MaxRemainingPerStep",e[e.MinBufferLengthPrune=500]="MinBufferLengthPrune",e[e.ForceReduceLimit=10]="ForceReduceLimit",e[e.CutDepth=15e3]="CutDepth",e[e.CutTo=9e3]="CutTo",e[e.MaxLeftAssociativeReductionCount=300]="MaxLeftAssociativeReductionCount",e[e.MaxStackCount=12]="MaxStackCount"}($a||($a={}));function Na(e,t){for(let n=0;n<t.length;n++){let i=t[n];if(i.pos==e.pos&&i.sameState(e))return void(t[n].score<e.score&&(t[n]=e))}t.push(e)}var Ia=e=>e,Qa=class{constructor(e){this.start=e.start,this.shift=e.shift||Ia,this.reduce=e.reduce||Ia,this.reuse=e.reuse||Ia,this.hash=e.hash||(()=>0),this.strict=!1!==e.strict}},Ra=class e extends Yo{constructor(e){if(super(),this.wrappers=[],14!=e.version)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let n=0;n<e.repeatNodeCount;n++)t.push("");let n=Object.keys(e.topRules).map((t=>e.topRules[t][1])),i=[];for(let e=0;e<t.length;e++)i.push([]);function r(e,t,n){i[e].push([t,t.deserialize(String(n))])}if(e.nodeProps)for(let t of e.nodeProps){let e=t[0];"string"==typeof e&&(e=ko[e]);for(let n=1;n<t.length;){let i=t[n++];if(i>=0)r(i,e,t[n++]);else{let s=t[n+-i];for(let o=-i;o>0;o--)r(t[n++],e,s);n++}}}this.nodeSet=new To(t.map(((t,r)=>_o.define({name:r>=this.minRepeatTerm?void 0:t,id:r,props:i[r],top:n.indexOf(r)>-1,error:0==r,skipped:e.skippedNodes&&e.skippedNodes.indexOf(r)>-1})))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=1024;let s=ya(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let e=0;e<this.specializerSpecs.length;e++)this.specialized[e]=this.specializerSpecs[e].term;this.specializers=this.specializerSpecs.map(Ba),this.states=ya(e.states,Uint32Array),this.data=ya(e.stateData),this.goto=ya(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((e=>"number"==typeof e?new wa(s,e):e)),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let i=new class{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new class{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=ba,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,i=this.rangeIndex,r=this.pos+e;for(;r<n.from;){if(!i)return null;let e=this.ranges[--i];r-=n.from-e.to,n=e}for(;t<0?r>n.to:r>=n.to;){if(i==this.ranges.length-1)return null;let e=this.ranges[++i];r+=e.from-n.to,n=e}return r}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t,n,i=this.chunkOff+e;if(i>=0&&i<this.chunk.length)t=this.pos+e,n=this.chunk.charCodeAt(i);else{let i=this.resolveOffset(e,1);if(null==i)return-1;if(t=i,t>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(t-this.chunk2Pos);else{let e=this.rangeIndex,i=this.range;for(;i.to<=t;)i=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>i.to&&(this.chunk2=this.chunk2.slice(0,i.to-t)),n=this.chunk2.charCodeAt(0)}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),n}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(null==n||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=ba,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let i of this.ranges){if(i.from>=t)break;i.to>e&&(n+=this.input.read(Math.max(i.from,e),Math.min(i.to,t)))}return n}}(t,i),this.tokens=new class{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map((e=>new va))}getActions(e){let t=0,n=null,{parser:i}=e.p,{tokenizers:r}=i,s=i.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,a=0;for(let i=0;i<r.length;i++){if(!(1<<i&s))continue;let l=r[i],h=this.tokens[i];if((!n||l.fallback)&&((l.contextual||h.start!=e.pos||h.mask!=s||h.context!=o)&&(this.updateCachedToken(h,l,e),h.mask=s,h.context=o),h.lookAhead>h.end+25&&(a=Math.max(h.lookAhead,a)),0!=h.value)){let i=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!l.extend&&(n=h,t>i))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),!n&&e.pos==this.stream.end&&(n=new va,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new va,{pos:n,p:i}=e;return t.start=n,t.end=Math.min(n+1,i.stream.end),t.value=n==i.stream.end?i.parser.eofTerm:0,t}updateCachedToken(e,t,n){let i=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(i,e),n),e.value>-1){let{parser:t}=n.p;for(let i=0;i<t.specialized.length;i++)if(t.specialized[i]==e.value){let r=t.specializers[i](this.stream.read(e.start,e.end),n);if(r>=0&&n.p.parser.dialect.allows(r>>1)){1&r?e.extended=r>>1:e.value=r>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,t,n,i){for(let t=0;t<i;t+=3)if(this.actions[t]==e)return i;return this.actions[i++]=e,this.actions[i++]=t,this.actions[i++]=n,i}addActions(e,t,n,i){let{state:r}=e,{parser:s}=e.p,{data:o}=s;for(let e=0;e<2;e++)for(let a=s.stateSlot(r,e?2:1);;a+=3){if(65535==o[a]){if(1!=o[a+1]){0==i&&2==o[a+1]&&(i=this.putAction(Ma(o,a+2),t,n,i));break}a=Ma(o,a+2)}o[a]==t&&(i=this.putAction(Ma(o,a+1),t,n,i))}return i}}(e,this.stream),this.topTerm=e.top[1];let{from:r}=i[0];this.stacks=[fa.start(this,e.top[0],r)],this.fragments=n.length&&this.stream.end-r>4*e.bufferLength?new class{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?Pa(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?Pa(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],i=this.index[t];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=n.children[i],s=this.start[t]+n.positions[i];if(s>e)return this.nextStart=s,null;if(r instanceof No){if(s==e){if(s<this.safeFrom)return null;let e=s+r.length;if(e<=this.safeTo){let t=r.prop(ko.lookAhead);if(!t||e+t<this.fragment.to)return r}}this.index[t]++,s+r.length>=Math.max(this.safeFrom,e)&&(this.trees.push(r),this.start.push(s),this.index.push(0))}else this.index[t]++,this.nextStart=s+r.length}}}(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e,t,n=this.stacks,i=this.minStackPos,r=this.stacks=[];if(this.bigReductionCount>300&&1==n.length){let[e]=n;for(;e.forceReduce()&&e.stack.length&&e.stack[e.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let s=0;s<n.length;s++){let o=n[s];for(;;){if(this.tokens.mainToken=null,o.pos>i)r.push(o);else{if(this.advanceStack(o,r,n))continue;{e||(e=[],t=[]),e.push(o);let n=this.tokens.getMainToken(o);t.push(n.value,n.end)}}break}}if(!r.length){let t=e&&function(e){let t=null;for(let n of e){let e=n.p.stoppedAt;(n.pos==n.p.stream.end||null!=e&&n.pos>e)&&n.p.parser.stateFlag(n.state,2)&&(!t||t.score<n.score)&&(t=n)}return t}(e);if(t)return this.stackToTree(t);if(this.parser.strict)throw new SyntaxError("No parse at "+i);this.recovering||(this.recovering=5)}if(this.recovering&&e){let n=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,r);if(n)return this.stackToTree(n.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(r.length>e)for(r.sort(((e,t)=>t.score-e.score));r.length>e;)r.pop();r.some((e=>e.reducePos>i))&&this.recovering--}else if(r.length>1){e:for(let e=0;e<r.length-1;e++){let t=r[e];for(let n=e+1;n<r.length;n++){let i=r[n];if(t.sameState(i)||t.buffer.length>500&&i.buffer.length>500){if(!((t.score-i.score||t.buffer.length-i.buffer.length)>0)){r.splice(e--,1);continue e}r.splice(n--,1)}}}r.length>12&&r.splice(12,r.length-12)}this.minStackPos=r[0].pos;for(let e=1;e<r.length;e++)r[e].pos<this.minStackPos&&(this.minStackPos=r[e].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let i=e.pos,{parser:r}=this;if(Ea&&this.stackID(e),null!=this.stoppedAt&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,n=t?e.curContext.hash:0;for(let s=this.fragments.nodeAt(i);s;){let i=this.parser.nodeSet.types[s.type.id]==s.type?r.getGoto(e.state,s.type.id):-1;if(i>-1&&s.length&&(!t||(s.prop(ko.contextHash)||0)==n))return e.useNode(s,i),!0;if(!(s instanceof No)||0==s.children.length||s.positions[0]>0)break;let o=s.children[0];if(!(o instanceof No&&0==s.positions[0]))break;s=o}}let s=r.stateSlot(e.state,4);if(s>0)return e.reduce(s),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let o=this.tokens.getActions(e);for(let r=0;r<o.length;){let s=o[r++],a=o[r++],l=o[r++],h=r==o.length||!n,c=h?e:e.split();if(c.apply(s,a,l),h)return!0;c.pos>i?t.push(c):n.push(c)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return Na(e,t),!0}}runRecovery(e,t,n){let i=null,r=!1;for(let s=0;s<e.length;s++){let o=e[s],a=t[s<<1],l=t[1+(s<<1)];if(Ea&&this.stackID(o),o.deadEnd&&(r||(r=!0,o.restart(),this.advanceFully(o,n))))continue;let h=o.split();for(let e=0;h.forceReduce()&&e<10&&!this.advanceFully(h,n);e++)Ea&&this.stackID(h);for(let e of o.recoverByInsert(a))this.advanceFully(e,n);this.stream.end>o.pos?(l==o.pos&&(l++,a=0),o.recoverByDelete(a,l),Na(o,n)):(!i||i.score<o.score)&&(i=o)}return i}stackToTree(e){return e.close(),No.build({buffer:Oa.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(Ta||(Ta=new WeakMap)).get(e);return t||Ta.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}(this,e,t,n);for(let r of this.wrappers)i=r(i,e,t,n);return i}getGoto(e,t,n=!1){let i=this.goto;if(t>=i[0])return-1;for(let r=i[t+1];;){let t=i[r++],s=1&t,o=i[r++];if(s&&n)return o;for(let n=r+(t>>1);r<n;r++)if(i[r]==e)return o;if(s)return-1}}hasAction(e,t){let n=this.data;for(let i=0;i<2;i++)for(let r,s=this.stateSlot(e,i?2:1);;s+=3){if(65535==(r=n[s])){if(1!=n[s+1]){if(2==n[s+1])return Ma(n,s+2);break}r=n[s=Ma(n,s+2)]}if(r==t||0==r)return Ma(n,s+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,(e=>e==t||null))}allActions(e,t){let n=this.stateSlot(e,4),i=n?t(n):void 0;for(let n=this.stateSlot(e,1);null==i;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=Ma(this.data,n+2)}i=t(Ma(this.data,n+1))}return i}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=Ma(this.data,n+2)}if(!(1&this.data[n+2])){let e=this.data[n+1];t.some(((t,n)=>1&n&&t==e))||t.push(this.data[n],e)}}return t}configure(t){let n=Object.assign(Object.create(e.prototype),this);if(t.props&&(n.nodeSet=this.nodeSet.extend(...t.props)),t.top){let e=this.topRules[t.top];if(!e)throw new RangeError(`Invalid top rule name ${t.top}`);n.top=e}return t.tokenizers&&(n.tokenizers=this.tokenizers.map((e=>{let n=t.tokenizers.find((t=>t.from==e));return n?n.to:e}))),t.specializers&&(n.specializers=this.specializers.slice(),n.specializerSpecs=this.specializerSpecs.map(((e,i)=>{let r=t.specializers.find((t=>t.from==e.external));if(!r)return e;let s=Object.assign(Object.assign({},e),{external:r.to});return n.specializers[i]=Ba(s),s}))),t.contextTracker&&(n.context=t.contextTracker),t.dialect&&(n.dialect=this.parseDialect(t.dialect)),null!=t.strict&&(n.strict=t.strict),t.wrap&&(n.wrappers=n.wrappers.concat(t.wrap)),null!=t.bufferLength&&(n.bufferLength=t.bufferLength),n}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map((()=>!1));if(e)for(let i of e.split(" ")){let e=t.indexOf(i);e>=0&&(n[e]=!0)}let i=null;for(let e=0;e<t.length;e++)if(!n[e])for(let n,r=this.dialects[t[e]];65535!=(n=this.data[r++]);)(i||(i=new Uint8Array(this.maxTerm+1)))[n]=1;return new class{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||0==this.disabled[e]}}(e,n,i)}static deserialize(t){return new e(t)}};function Ma(e,t){return e[t]|e[t+1]<<16}function Ba(e){if(e.external){let t=e.extend?1:0;return(n,i)=>e.external(n,i)<<1|t}return e.get}var Da=0,Xa=class e{constructor(e,t,n){this.set=e,this.base=t,this.modified=n,this.id=Da++}static define(t){if(t?.base)throw new Error("Can not derive from a modified tag");let n=new e([],null,[]);if(n.set.push(n),t)for(let e of t.set)n.set.push(e);return n}static defineModifier(){let e=new La;return t=>t.modified.indexOf(e)>-1?t:La.get(t.base||t,t.modified.concat(e).sort(((e,t)=>e.id-t.id)))}},Fa=0,La=class e{constructor(){this.instances=[],this.id=Fa++}static get(t,n){if(!n.length)return t;let i=n[0].instances.find((e=>e.base==t&&function(e,t){return e.length==t.length&&e.every(((e,n)=>e==t[n]))}(n,e.modified)));if(i)return i;let r=[],s=new Xa(r,t,n);for(let e of n)e.instances.push(s);let o=function(e){let t=[[]];for(let n=0;n<e.length;n++)for(let i=0,r=t.length;i<r;i++)t.push(t[i].concat(e[n]));return t.sort(((e,t)=>t.length-e.length))}(n);for(let n of t.set)if(!n.modified.length)for(let t of o)r.push(e.get(n,t));return s}};function Ua(e){let t=Object.create(null);for(let n in e){let i=e[n];Array.isArray(i)||(i=[i]);for(let e of n.split(" "))if(e){let n=[],r=2,s=e;for(let t=0;;){if("..."==s&&t>0&&t+3==e.length){r=1;break}let i=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!i)throw new RangeError("Invalid path: "+e);if(n.push("*"==i[0]?"":'"'==i[0][0]?JSON.parse(i[0]):i[0]),t+=i[0].length,t==e.length)break;let o=e[t++];if(t==e.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+e);s=e.slice(t)}let o=n.length-1,a=n[o];if(!a)throw new RangeError("Invalid path: "+e);let l=new za(i,r,o>0?n.slice(0,o):null);t[a]=l.sort(t[a])}}return Va.add(t)}var Va=new ko,za=class{constructor(e,t,n,i){this.tags=e,this.mode=t,this.context=n,this.next=i}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};function Za(e,t){let n=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)n[e.id]=t.class;else n[t.tag.id]=t.class;let{scope:i,all:r=null}=t||{};return{style:e=>{let t=r;for(let i of e)for(let e of i.set){let i=n[e.id];if(i){t=t?t+" "+i:i;break}}return t},scope:i}}function ja(e,t,n,i=0,r=e.length){let s=new qa(i,Array.isArray(t)?t:[t],n);s.highlightRange(e.cursor(),i,r,"",s.highlighters),s.flush(r)}za.empty=new za([],2,null);var qa=class{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,i,r){let{type:s,from:o,to:a}=e;if(o>=n||a<=t)return;s.isTop&&(r=this.highlighters.filter((e=>!e.scope||e.scope(s))));let l=i,h=function(e){let t=e.type.prop(Va);for(;t&&t.context&&!e.matchContext(t.context);)t=t.next;return t||null}(e)||za.empty,c=function(e,t){let n=null;for(let i of e){let e=i.style(t);e&&(n=n?n+" "+e:e)}return n}(r,h.tags);if(c&&(l&&(l+=" "),l+=c,1==h.mode&&(i+=(i?" ":"")+c)),this.startSpan(Math.max(t,o),l),h.opaque)return;let u=e.tree&&e.tree.prop(ko.mounted);if(u&&u.overlay){let s=e.node.enter(u.overlay[0].from+o,1),h=this.highlighters.filter((e=>!e.scope||e.scope(u.tree.type))),c=e.firstChild();for(let d=0,p=o;;d++){let f=d<u.overlay.length?u.overlay[d]:null,m=f?f.from+o:a,g=Math.max(t,p),O=Math.min(n,m);if(g<O&&c)for(;e.from<O&&(this.highlightRange(e,g,O,i,r),this.startSpan(Math.min(O,e.to),l),!(e.to>=m)&&e.nextSibling()););if(!f||m>n)break;p=f.to+o,p>t&&(this.highlightRange(s.cursor(),Math.max(t,f.from+o),Math.min(n,p),"",h),this.startSpan(Math.min(n,p),l))}c&&e.parent()}else if(e.firstChild()){u&&(i="");do{if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,i,r),this.startSpan(Math.min(n,e.to),l)}}while(e.nextSibling());e.parent()}}};var Ga=Xa.define,Wa=Ga(),Ha=Ga(),Ya=Ga(Ha),Ja=Ga(Ha),Ka=Ga(),el=Ga(Ka),tl=Ga(Ka),nl=Ga(),il=Ga(nl),rl=Ga(),sl=Ga(),ol=Ga(),al=Ga(ol),ll=Ga(),hl={comment:Wa,lineComment:Ga(Wa),blockComment:Ga(Wa),docComment:Ga(Wa),name:Ha,variableName:Ga(Ha),typeName:Ya,tagName:Ga(Ya),propertyName:Ja,attributeName:Ga(Ja),className:Ga(Ha),labelName:Ga(Ha),namespace:Ga(Ha),macroName:Ga(Ha),literal:Ka,string:el,docString:Ga(el),character:Ga(el),attributeValue:Ga(el),number:tl,integer:Ga(tl),float:Ga(tl),bool:Ga(Ka),regexp:Ga(Ka),escape:Ga(Ka),color:Ga(Ka),url:Ga(Ka),keyword:rl,self:Ga(rl),null:Ga(rl),atom:Ga(rl),unit:Ga(rl),modifier:Ga(rl),operatorKeyword:Ga(rl),controlKeyword:Ga(rl),definitionKeyword:Ga(rl),moduleKeyword:Ga(rl),operator:sl,derefOperator:Ga(sl),arithmeticOperator:Ga(sl),logicOperator:Ga(sl),bitwiseOperator:Ga(sl),compareOperator:Ga(sl),updateOperator:Ga(sl),definitionOperator:Ga(sl),typeOperator:Ga(sl),controlOperator:Ga(sl),punctuation:ol,separator:Ga(ol),bracket:al,angleBracket:Ga(al),squareBracket:Ga(al),paren:Ga(al),brace:Ga(al),content:nl,heading:il,heading1:Ga(il),heading2:Ga(il),heading3:Ga(il),heading4:Ga(il),heading5:Ga(il),heading6:Ga(il),contentSeparator:Ga(nl),list:Ga(nl),quote:Ga(nl),emphasis:Ga(nl),strong:Ga(nl),link:Ga(nl),monospace:Ga(nl),strikethrough:Ga(nl),inserted:Ga(),deleted:Ga(),changed:Ga(),invalid:Ga(),meta:ll,documentMeta:Ga(ll),annotation:Ga(ll),processingInstruction:Ga(ll),definition:Xa.defineModifier(),constant:Xa.defineModifier(),function:Xa.defineModifier(),standard:Xa.defineModifier(),local:Xa.defineModifier(),special:Xa.defineModifier()};Za([{tag:hl.link,class:"tok-link"},{tag:hl.heading,class:"tok-heading"},{tag:hl.emphasis,class:"tok-emphasis"},{tag:hl.strong,class:"tok-strong"},{tag:hl.keyword,class:"tok-keyword"},{tag:hl.atom,class:"tok-atom"},{tag:hl.bool,class:"tok-bool"},{tag:hl.url,class:"tok-url"},{tag:hl.labelName,class:"tok-labelName"},{tag:hl.inserted,class:"tok-inserted"},{tag:hl.deleted,class:"tok-deleted"},{tag:hl.literal,class:"tok-literal"},{tag:hl.string,class:"tok-string"},{tag:hl.number,class:"tok-number"},{tag:[hl.regexp,hl.escape,hl.special(hl.string)],class:"tok-string2"},{tag:hl.variableName,class:"tok-variableName"},{tag:hl.local(hl.variableName),class:"tok-variableName tok-local"},{tag:hl.definition(hl.variableName),class:"tok-variableName tok-definition"},{tag:hl.special(hl.variableName),class:"tok-variableName2"},{tag:hl.definition(hl.propertyName),class:"tok-propertyName tok-definition"},{tag:hl.typeName,class:"tok-typeName"},{tag:hl.namespace,class:"tok-namespace"},{tag:hl.className,class:"tok-className"},{tag:hl.macroName,class:"tok-macroName"},{tag:hl.propertyName,class:"tok-propertyName"},{tag:hl.operator,class:"tok-operator"},{tag:hl.comment,class:"tok-comment"},{tag:hl.meta,class:"tok-meta"},{tag:hl.invalid,class:"tok-invalid"},{tag:hl.punctuation,class:"tok-punctuation"}]);function cl(e){return 45==e||46==e||58==e||e>=65&&e<=90||95==e||e>=97&&e<=122||e>=161}function ul(e){return 9==e||10==e||13==e||32==e}var dl=null,pl=null,fl=0;function ml(e,t){let n=e.pos+t;if(pl==e&&fl==n)return dl;for(;ul(e.peek(t));)t++;let i="";for(;;){let n=e.peek(t);if(!cl(n))break;i+=String.fromCharCode(n),t++}return pl=e,fl=n,dl=i||null}function gl(e,t){this.name=e,this.parent=t,this.hash=t?t.hash:0;for(let t=0;t<e.length;t++)this.hash+=(this.hash<<4)+e.charCodeAt(t)+(e.charCodeAt(t)<<8)}var Ol=new Qa({start:null,shift:(e,t,n,i)=>1==t?new gl(ml(i,1)||"",e):e,reduce:(e,t)=>11==t&&e?e.parent:e,reuse(e,t,n,i){let r=t.type.id;return 1==r||13==r?new gl(ml(i,1)||"",e):e},hash:e=>e?e.hash:0,strict:!1}),yl=new Sa(((e,t)=>{if(60==e.next)if(e.advance(),47==e.next){e.advance();let n=ml(e,0);if(!n)return e.acceptToken(5);if(t.context&&n==t.context.name)return e.acceptToken(2);for(let i=t.context;i;i=i.parent)if(i.name==n)return e.acceptToken(3,-2);e.acceptToken(4)}else if(33!=e.next&&63!=e.next)return e.acceptToken(1)}),{contextual:!0});function vl(e,t){return new Sa((n=>{for(let i=0,r=0;;r++){if(n.next<0){r&&n.acceptToken(e);break}if(n.next==t.charCodeAt(i)){if(i++,i==t.length){r>=t.length&&n.acceptToken(e,1-t.length);break}}else i=n.next==t.charCodeAt(0)?1:0;n.advance()}}))}var bl,wl=vl(35,"--\x3e"),xl=vl(36,"?>"),Sl=vl(37,"]]>"),kl=Ua({Text:hl.content,"StartTag StartCloseTag EndTag SelfCloseEndTag":hl.angleBracket,TagName:hl.tagName,"MismatchedCloseTag/Tagname":[hl.tagName,hl.invalid],AttributeName:hl.attributeName,AttributeValue:hl.attributeValue,Is:hl.definitionOperator,"EntityReference CharacterReference":hl.character,Comment:hl.blockComment,ProcessingInst:hl.processingInstruction,DoctypeDecl:hl.documentMeta,Cdata:hl.special(hl.string)}),Al=Ra.deserialize({version:14,states:",SOQOaOOOrOxO'#CfOzOpO'#CiO!tOaO'#CgOOOP'#Cg'#CgO!{OrO'#CrO#TOtO'#CsO#]OpO'#CtOOOP'#DS'#DSOOOP'#Cv'#CvQQOaOOOOOW'#Cw'#CwO#eOxO,59QOOOP,59Q,59QOOOO'#Cx'#CxO#mOpO,59TO#uO!bO,59TOOOP'#C{'#C{O$TOaO,59RO$[OpO'#CoOOOP,59R,59ROOOQ'#C|'#C|O$dOrO,59^OOOP,59^,59^OOOS'#C}'#C}O$lOtO,59_OOOP,59_,59_O$tOpO,59`O$|OpO,59`OOOP-E6t-E6tOOOW-E6u-E6uOOOP1G.l1G.lOOOO-E6v-E6vO%UO!bO1G.oO%UO!bO1G.oO%dOpO'#CkO%lO!bO'#CyO%zO!bO1G.oOOOP1G.o1G.oOOOP1G.w1G.wOOOP-E6y-E6yOOOP1G.m1G.mO&VOpO,59ZO&_OpO,59ZOOOQ-E6z-E6zOOOP1G.x1G.xOOOS-E6{-E6{OOOP1G.y1G.yO&gOpO1G.zO&gOpO1G.zOOOP1G.z1G.zO&oO!bO7+$ZO&}O!bO7+$ZOOOP7+$Z7+$ZOOOP7+$c7+$cO'YOpO,59VO'bOpO,59VO'jO!bO,59eOOOO-E6w-E6wO'xOpO1G.uO'xOpO1G.uOOOP1G.u1G.uO(QOpO7+$fOOOP7+$f7+$fO(YO!bO<<GuOOOP<<Gu<<GuOOOP<<G}<<G}O'bOpO1G.qO'bOpO1G.qO(eO#tO'#CnOOOO1G.q1G.qO(sOpO7+$aOOOP7+$a7+$aOOOP<<HQ<<HQOOOPAN=aAN=aOOOPAN=iAN=iO'bOpO7+$]OOOO7+$]7+$]OOOO'#Cz'#CzO({O#tO,59YOOOO,59Y,59YOOOP<<G{<<G{OOOO<<Gw<<GwOOOO-E6x-E6xOOOO1G.t1G.t",stateData:")Z~OPQOSVOTWOVWOWWOXWOiXOxPO}TO!PUO~OuZOw]O~O^`Oy^O~OPQOQcOSVOTWOVWOWWOXWOxPO}TO!PUO~ORdO~P!SOseO|gO~OthO!OjO~O^lOy^O~OuZOwoO~O^qOy^O~O[vO`sOdwOy^O~ORyO~P!SO^{Oy^O~OseO|}O~OthO!O!PO~O^!QOy^O~O[!SOy^O~O[!VO`sOd!WOy^O~Oa!YOy^O~Oy^O[mX`mXdmX~O[!VO`sOd!WO~O^!]Oy^O~O[!_Oy^O~O[!aOy^O~O[!cO`sOd!dOy^O~O[!cO`sOd!dO~Oa!eOy^O~Oy^Oz!gO~Oy^O[ma`madma~O[!jOy^O~O[!kOy^O~O[!lO`sOd!mO~OW!pOX!pOz!rO{!pO~O[!sOy^O~OW!pOX!pOz!vO{!pO~O",goto:"%[wPPPPPPPPPPxxP!OP!UPP!_!iP!oxxxP!u!{#R$Z$j$p$v$|PPPP%SXWORYbXRORYb_t`qru!T!U!bQ!h!YS!o!e!fR!t!nQdRRybXSORYbQYORmYQ[PRn[Q_QQkVjp_krz!R!T!X!Z!^!`!f!i!nQr`QzcQ!RlQ!TqQ!XsQ!ZtQ!^{Q!`!QQ!f!YQ!i!]R!n!eQu`S!UqrU![u!U!bR!b!TQ!q!gR!u!qQbRRxbQfTR|fQiUR!OiSXOYTaRb",nodeNames:" StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Text EntityReference CharacterReference Cdata Element EndTag OpenTag TagName Attribute AttributeName Is AttributeValue CloseTag SelfCloseEndTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag DoctypeDecl",maxTerm:47,context:Ol,nodeProps:[["closedBy",1,"SelfCloseEndTag EndTag",13,"CloseTag MissingCloseTag"],["openedBy",12,"StartTag StartCloseTag",19,"OpenTag",20,"StartTag"]],propSources:[kl],skippedNodes:[0],repeatNodeCount:8,tokenData:"IX~R!XOX$nXY&kYZ&kZ]$n]^&k^p$npq&kqr$nrs'ssv$nvw(Zw}$n}!O*l!O!P$n!P!Q,{!Q![$n![!].e!]!^$n!^!_1v!_!`Cz!`!aDm!a!bE`!b!c$n!c!}.e!}#P$n#P#QFx#Q#R$n#R#S.e#S#T$n#T#o.e#o%W$n%W%o.e%o%p$n%p&a.e&a&b$n&b1p.e1p4U$n4U4d.e4d4e$n4e$IS.e$IS$I`$n$I`$Ib.e$Ib$Kh$n$Kh%#t.e%#t&/x$n&/x&Et.e&Et&FV$n&FV;'S.e;'S;:j1p;:j;=`&e<%l?&r$n?&r?Ah.e?Ah?BY$n?BY?Mn.e?MnO$nX$uWVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nP%dTVPOv%_w!^%_!_;'S%_;'S;=`%s<%lO%_P%vP;=`<%l%_W&OT{WOr%ysv%yw;'S%y;'S;=`&_<%lO%yW&bP;=`<%l%yX&hP;=`<%l$n_&t_VP{WyUOX$nXY&kYZ&kZ]$n]^&k^p$npq&kqr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nZ'zTzYVPOv%_w!^%_!_;'S%_;'S;=`%s<%lO%_~(^VOp(sqs(sst)ht!](s!^;'S(s;'S;=`)b<%lO(s~(vVOp(sqs(st!](s!]!^)]!^;'S(s;'S;=`)b<%lO(s~)bOW~~)eP;=`<%l(s~)kTOp)zq!])z!^;'S)z;'S;=`*f<%lO)z~)}UOp)zq!])z!]!^*a!^;'S)z;'S;=`*f<%lO)z~*fOX~~*iP;=`<%l)zZ*sYVP{WOr$nrs%_sv$nw}$n}!O+c!O!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nZ+jYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_!`$n!`!a,Y!a;'S$n;'S;=`&e<%lO$nZ,cW|QVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$n]-SYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_!`$n!`!a-r!a;'S$n;'S;=`&e<%lO$n]-{WdSVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$n_.p!O`S^QVP{WOr$nrs%_sv$nw}$n}!O.e!O!P.e!P!Q$n!Q![.e![!].e!]!^$n!^!_%y!_!c$n!c!}.e!}#R$n#R#S.e#S#T$n#T#o.e#o$}$n$}%O.e%O%W$n%W%o.e%o%p$n%p&a.e&a&b$n&b1p.e1p4U.e4U4d.e4d4e$n4e$IS.e$IS$I`$n$I`$Ib.e$Ib$Je$n$Je$Jg.e$Jg$Kh$n$Kh%#t.e%#t&/x$n&/x&Et.e&Et&FV$n&FV;'S.e;'S;:j1p;:j;=`&e<%l?&r$n?&r?Ah.e?Ah?BY$n?BY?Mn.e?MnO$n_1sP;=`<%l.eX1{W{WOq%yqr2esv%yw!a%y!a!bCd!b;'S%y;'S;=`&_<%lO%yX2j]{WOr%ysv%yw}%y}!O3c!O!f%y!f!g4e!g!}%y!}#O9t#O#W%y#W#X@Q#X;'S%y;'S;=`&_<%lO%yX3hV{WOr%ysv%yw}%y}!O3}!O;'S%y;'S;=`&_<%lO%yX4UT}P{WOr%ysv%yw;'S%y;'S;=`&_<%lO%yX4jV{WOr%ysv%yw!q%y!q!r5P!r;'S%y;'S;=`&_<%lO%yX5UV{WOr%ysv%yw!e%y!e!f5k!f;'S%y;'S;=`&_<%lO%yX5pV{WOr%ysv%yw!v%y!v!w6V!w;'S%y;'S;=`&_<%lO%yX6[V{WOr%ysv%yw!{%y!{!|6q!|;'S%y;'S;=`&_<%lO%yX6vV{WOr%ysv%yw!r%y!r!s7]!s;'S%y;'S;=`&_<%lO%yX7bV{WOr%ysv%yw!g%y!g!h7w!h;'S%y;'S;=`&_<%lO%yX7|X{WOr7wrs8isv7wvw8iw!`7w!`!a9W!a;'S7w;'S;=`9n<%lO7wP8lTO!`8i!`!a8{!a;'S8i;'S;=`9Q<%lO8iP9QOiPP9TP;=`<%l8iX9_TiP{WOr%ysv%yw;'S%y;'S;=`&_<%lO%yX9qP;=`<%l7wX9yX{WOr%ysv%yw!e%y!e!f:f!f#V%y#V#W=t#W;'S%y;'S;=`&_<%lO%yX:kV{WOr%ysv%yw!f%y!f!g;Q!g;'S%y;'S;=`&_<%lO%yX;VV{WOr%ysv%yw!c%y!c!d;l!d;'S%y;'S;=`&_<%lO%yX;qV{WOr%ysv%yw!v%y!v!w<W!w;'S%y;'S;=`&_<%lO%yX<]V{WOr%ysv%yw!c%y!c!d<r!d;'S%y;'S;=`&_<%lO%yX<wV{WOr%ysv%yw!}%y!}#O=^#O;'S%y;'S;=`&_<%lO%yX=eT{WxPOr%ysv%yw;'S%y;'S;=`&_<%lO%yX=yV{WOr%ysv%yw#W%y#W#X>`#X;'S%y;'S;=`&_<%lO%yX>eV{WOr%ysv%yw#T%y#T#U>z#U;'S%y;'S;=`&_<%lO%yX?PV{WOr%ysv%yw#h%y#h#i?f#i;'S%y;'S;=`&_<%lO%yX?kV{WOr%ysv%yw#T%y#T#U<r#U;'S%y;'S;=`&_<%lO%yX@VV{WOr%ysv%yw#c%y#c#d@l#d;'S%y;'S;=`&_<%lO%yX@qV{WOr%ysv%yw#V%y#V#WAW#W;'S%y;'S;=`&_<%lO%yXA]V{WOr%ysv%yw#h%y#h#iAr#i;'S%y;'S;=`&_<%lO%yXAwV{WOr%ysv%yw#m%y#m#nB^#n;'S%y;'S;=`&_<%lO%yXBcV{WOr%ysv%yw#d%y#d#eBx#e;'S%y;'S;=`&_<%lO%yXB}V{WOr%ysv%yw#X%y#X#Y7w#Y;'S%y;'S;=`&_<%lO%yXCkT!PP{WOr%ysv%yw;'S%y;'S;=`&_<%lO%yZDTWaQVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$n_DvW[UVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nZEgYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_!`$n!`!aFV!a;'S$n;'S;=`&e<%lO$nZF`W!OQVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nZGPYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_#P$n#P#QGo#Q;'S$n;'S;=`&e<%lO$nZGvYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_!`$n!`!aHf!a;'S$n;'S;=`&e<%lO$nZHoWwQVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$n",tokenizers:[yl,wl,xl,Sl,0,1,2,3],topRules:{Document:[0,6]},tokenPrec:0}),Cl=new ko;function _l(e){return U.define({combine:e?t=>t.concat(e):void 0})}var El=new ko,Tl=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,Te.prototype.hasOwnProperty("tree")||Object.defineProperty(Te.prototype,"tree",{get(){return Nl(this)}}),this.parser=t,this.extension=[Fl.of(this),Te.languageData.of(((e,t,n)=>{let i=Pl(e,t,n),r=i.type.prop(Cl);if(!r)return[];let s=e.facet(r),o=i.type.prop(El);if(o){let r=i.resolve(t-i.from,n);for(let t of o)if(t.test(r,e)){let n=e.facet(t.facet);return"replace"==t.type?n:n.concat(s)}}return s}))].concat(n)}isActiveAt(e,t,n=-1){return Pl(e,t,n).type.prop(Cl)==this.data}findRegions(e){let t=e.facet(Fl);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(e,t)=>{if(e.prop(Cl)==this.data)return void n.push({from:t,to:t+e.length});let r=e.prop(ko.mounted);if(r){if(r.tree.prop(Cl)==this.data){if(r.overlay)for(let e of r.overlay)n.push({from:e.from+t,to:e.to+t});else n.push({from:t,to:t+e.length});return}if(r.overlay){let e=n.length;if(i(r.tree,r.overlay[0].from+t),n.length>e)return}}for(let n=0;n<e.children.length;n++){let r=e.children[n];r instanceof No&&i(r,e.positions[n]+t)}};return i(Nl(e),0),n}get allowsNesting(){return!0}};function Pl(e,t,n){let i=e.facet(Fl),r=Nl(e).topNode;if(!i||i.allowsNesting)for(let e=r;e;e=e.enter(t,n,Eo.ExcludeBuffers))e.type.isTop&&(r=e);return r}Tl.setState=Oe.define();var $l=class e extends Tl{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(t){let n=_l(t.languageData);return new e(n,t.parser.configure({props:[Cl.add((e=>e.isTop?n:void 0))]}),t.name)}configure(t,n){return new e(this.data,this.parser.configure(t),n||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function Nl(e){let t=e.field(Tl.state,!1);return t?t.tree:No.empty}var Il=null,Ql=class e{constructor(e,t,n=[],i,r,s,o,a){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(t,n,i){return new e(t,n,[],No.empty,0,i,[],null)}startParse(){return this.parser.startParse(new class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}(this.state.doc),this.fragments)}work(e,t){return null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=No.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var n;if("number"==typeof e){let t=Date.now()+e;e=()=>Date.now()>t}for(this.parse||(this.parse=this.startParse()),null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i){if(this.fragments=this.withoutTempSkipped(Ho.addTree(i,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(n=this.parse.stoppedAt)&&void 0!==n?n:this.state.doc.length,this.tree=i,this.parse=null,!(this.treeLen<(t??this.state.doc.length)))return!0;this.parse=this.startParse()}if(e())return!1}}))}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext((()=>{for(;!(t=this.parse.advance()););})),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Ho.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Il;Il=this;try{return e()}finally{Il=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Rl(e,t.from,t.to);return e}changes(t,n){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,n,i,r)=>e.push({fromA:t,toA:n,fromB:i,toB:r}))),i=Ho.applyChanges(i,e),r=No.empty,s=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){a=[];for(let e of this.skipped){let n=t.mapPos(e.from,1),i=t.mapPos(e.to,-1);n<i&&a.push({from:n,to:i})}}}return new e(this.parser,n,i,r,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let t=0;t<this.skipped.length;t++){let{from:n,to:i}=this.skipped[t];n<e.to&&i>e.from&&(this.fragments=Rl(this.fragments,n,i),this.skipped.splice(t--,1))}return!(this.skipped.length>=t)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Yo{createParse(t,n,i){let r=i[0].from,s=i[i.length-1].to;return{parsedPos:r,advance(){let t=Il;if(t){for(let e of i)t.tempSkipped.push(e);e&&(t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e)}return this.parsedPos=s,new No(_o.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return Il}};function Rl(e,t,n){return Ho.applyChanges(e,[{fromA:t,toA:n,fromB:t,toB:n}])}var Ml=class e{constructor(e){this.context=e,this.tree=e.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,i)||n.takeTree(),new e(n)}static init(t){let n=Math.min(3e3,t.doc.length),i=Ql.create(t.facet(Fl).parser,t,{from:0,to:n});return i.work(20,n)||i.takeTree(),new e(i)}};Tl.state=W.define({create:Ml.init,update(e,t){for(let e of t.effects)if(e.is(Tl.setState))return e.value;return t.startState.facet(Fl)!=t.state.facet(Fl)?Ml.init(t.state):e.apply(t)}});var Bl=e=>{let t=setTimeout((()=>e()),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(Bl=e=>{let t=-1,n=setTimeout((()=>{t=requestIdleCallback(e,{timeout:400})}),100);return()=>t<0?clearTimeout(n):cancelIdleCallback(t)});var Dl=typeof navigator<"u"&&null!==(bl=navigator.scheduling)&&void 0!==bl&&bl.isInputPending?()=>navigator.scheduling.isInputPending():null,Xl=Kn.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Tl.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Tl.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=Bl(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,r=n.field(Tl.state);if(r.tree==r.context.tree&&r.context.isDone(i+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,e&&!Dl?Math.max(25,e.timeRemaining()-5):1e9),o=r.context.treeLen<i&&n.doc.length>i+1e3,a=r.context.work((()=>Dl&&Dl()||Date.now()>s),i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Tl.setState.of(new Ml(r.context))})),this.chunkBudget>0&&!(a&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then((()=>this.scheduleWork())).catch((e=>Wn(this.view.state,e))).then((()=>this.workScheduled--)),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Fl=U.define({combine:e=>e.length?e[0]:null,enables:e=>[Tl.state,Xl,Lr.contentAttributes.compute([e],(t=>{let n=t.facet(e);return n&&n.name?{"data-language":n.name}:{}}))]}),Ll=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}},Ul=class e{constructor(e,t,n,i,r,s){this.name=e,this.alias=t,this.extensions=n,this.filename=i,this.loadFunc=r,this.support=s,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then((e=>this.support=e),(e=>{throw this.loading=null,e})))}static of(t){let{load:n,support:i}=t;if(!n){if(!i)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");n=()=>Promise.resolve(i)}return new e(t.name,(t.alias||[]).concat(t.name).map((e=>e.toLowerCase())),t.extensions||[],t.filename,n,i)}static matchFilename(e,t){for(let n of e)if(n.filename&&n.filename.test(t))return n;let n=/\.([^.]+)$/.exec(t);if(n)for(let t of e)if(t.extensions.indexOf(n[1])>-1)return t;return null}static matchLanguageName(e,t,n=!0){t=t.toLowerCase();for(let n of e)if(n.alias.some((e=>e==t)))return n;if(n)for(let n of e)for(let e of n.alias){let i=t.indexOf(e);if(i>-1&&(e.length>2||!/\w/.test(t[i-1])&&!/\w/.test(t[i+e.length])))return n}return null}},Vl=U.define(),zl=U.define({combine:e=>{if(!e.length)return"  ";let t=e[0];if(!t||/\S/.test(t)||Array.from(t).some((e=>e!=t[0])))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return t}});function Zl(e){let t=e.facet(zl);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function jl(e,t){let n="",i=e.tabSize,r=e.facet(zl)[0];if("\t"==r){for(;t>=i;)n+="\t",t-=i;r=" "}for(let e=0;e<t;e++)n+=r;return n}function ql(e,t){e instanceof Te&&(e=new Gl(e));for(let n of e.state.facet(Vl)){let i=n(e,t);if(void 0!==i)return i}let n=Nl(e.state);return n.length>=t?function(e,t,n){let i=t.resolveStack(n),r=i.node.enterUnfinishedNodesBefore(n);if(r!=i.node){let e=[];for(let t=r;t!=i.node;t=t.parent)e.push(t);for(let t=e.length-1;t>=0;t--)i={node:e[t],next:i}}return Hl(i,e,n)}(e,n,t):null}var Gl=class{constructor(e,t={}){this.state=e,this.options=t,this.unit=Zl(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:r}=this.options;return null!=i&&i>=n.from&&i<=n.to?r&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(e,t);return n.slice(e-i,Math.min(n.length,e+100-i))}column(e,t=1){let{text:n,from:i}=this.lineAt(e,t),r=this.countColumn(n,e-i),s=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return s>-1&&(r+=s-this.countColumn(n,n.search(/\S|$/))),r}countColumn(e,t=e.length){return je(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:i}=this.lineAt(e,t),r=this.options.overrideIndentation;if(r){let e=r(i);if(e>-1)return e}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}},Wl=new ko;function Hl(e,t,n){for(let i=e;i;i=i.next){let e=Yl(i.node);if(e)return e(Kl.create(t,n,i))}return 0}function Yl(e){let t=e.type.prop(Wl);if(t)return t;let n,i=e.firstChild;if(i&&(n=i.type.prop(ko.closedBy))){let t=e.lastChild,i=t&&n.indexOf(t.name)>-1;return e=>th(e,!0,1,void 0,i&&!function(e){return e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak}(e)?t.from:void 0)}return null==e.parent?Jl:null}function Jl(){return 0}var Kl=class e extends Gl{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(t,n,i){return new e(t,n,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(eh(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return Hl(this.context.next,this.base,this.pos)}};function eh(e,t){for(let n=t;n;n=n.parent)if(e==n)return!0;return!1}function th(e,t,n,i,r){let s=e.textAfter,o=s.match(/^\s*/)[0].length,a=i&&s.slice(o,o+i.length)==i||r==e.pos+o,l=t?function(e){let t=e.node,n=t.childAfter(t.from),i=t.lastChild;if(!n)return null;let r=e.options.simulateBreak,s=e.state.doc.lineAt(n.from),o=null==r||r<=s.from?s.to:Math.min(s.to,r);for(let e=n.to;;){let r=t.childAfter(e);if(!r||r==i)return null;if(!r.type.isSkipped)return r.from<o?n:null;e=r.to}}(e):null;return l?a?e.column(l.from):e.column(l.to):e.baseIndent+(a?0:e.unit*n)}function nh({except:e,units:t=1}={}){return n=>{let i=e&&e.test(n.textAfter);return n.baseIndent+(i?0:t*n.unit)}}var ih=U.define(),rh=new ko;function sh(e){let t=e.firstChild,n=e.lastChild;return t&&t.to<n.from?{from:t.to,to:n.type.isError?e.to:n.from}:null}function oh(e){let t=e.lastChild;return t&&t.to==e.to&&t.type.isError}function ah(e,t,n){for(let i of e.facet(ih)){let r=i(e,t,n);if(r)return r}return function(e,t,n){let i=Nl(e);if(i.length<n)return null;let r=null;for(let s=i.resolveStack(n,1);s;s=s.next){let o=s.node;if(o.to<=n||o.from>n)continue;if(r&&o.from<t)break;let a=o.type.prop(rh);if(a&&(o.to<i.length-50||i.length==e.doc.length||!oh(o))){let i=a(o,e);i&&i.from<=n&&i.from>=t&&i.to>n&&(r=i)}}return r}(e,t,n)}function lh(e,t){let n=t.mapPos(e.from,1),i=t.mapPos(e.to,-1);return n>=i?void 0:{from:n,to:i}}var hh=Oe.define({map:lh}),ch=Oe.define({map:lh});function uh(e){let t=[];for(let{head:n}of e.state.selection.ranges)t.some((e=>e.from<=n&&e.to>=n))||t.push(e.lineBlockAt(n));return t}var dh=W.define({create:()=>hn.none,update(e,t){e=e.map(t.changes);for(let n of t.effects)if(n.is(hh)&&!fh(e,n.value.from,n.value.to)){let{preparePlaceholder:i}=t.state.facet(vh),r=i?hn.replace({widget:new Sh(i(t.state,n.value))}):xh;e=e.update({add:[r.range(n.value.from,n.value.to)]})}else n.is(ch)&&(e=e.update({filter:(e,t)=>n.value.from!=e||n.value.to!=t,filterFrom:n.value.from,filterTo:n.value.to}));if(t.selection){let n=!1,{head:i}=t.selection.main;e.between(i,i,((e,t)=>{e<i&&t>i&&(n=!0)})),n&&(e=e.update({filterFrom:i,filterTo:i,filter:(e,t)=>t<=i||e>=i}))}return e},provide:e=>Lr.decorations.from(e),toJSON(e,t){let n=[];return e.between(0,t.doc.length,((e,t)=>{n.push(e,t)})),n},fromJSON(e){if(!Array.isArray(e)||e.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let n=0;n<e.length;){let i=e[n++],r=e[n++];if("number"!=typeof i||"number"!=typeof r)throw new RangeError("Invalid JSON for fold state");t.push(xh.range(i,r))}return hn.set(t,!0)}});function ph(e,t,n){var i;let r=null;return null===(i=e.field(dh,!1))||void 0===i||i.between(t,n,((e,t)=>{(!r||r.from>e)&&(r={from:e,to:t})})),r}function fh(e,t,n){let i=!1;return e.between(t,t,((e,r)=>{e==t&&r==n&&(i=!0)})),i}function mh(e,t){return e.field(dh,!1)?t:t.concat(Oe.appendConfig.of(bh()))}function gh(e,t,n=!0){let i=e.state.doc.lineAt(t.from).number,r=e.state.doc.lineAt(t.to).number;return Lr.announce.of(`${e.state.phrase(n?"Folded lines":"Unfolded lines")} ${i} ${e.state.phrase("to")} ${r}.`)}var Oh=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:e=>{for(let t of uh(e)){let n=ah(e.state,t.from,t.to);if(n)return e.dispatch({effects:mh(e.state,[hh.of(n),gh(e,n)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e=>{if(!e.state.field(dh,!1))return!1;let t=[];for(let n of uh(e)){let i=ph(e.state,n.from,n.to);i&&t.push(ch.of(i),gh(e,i,!1))}return t.length&&e.dispatch({effects:t}),t.length>0}},{key:"Ctrl-Alt-[",run:e=>{let{state:t}=e,n=[];for(let i=0;i<t.doc.length;){let r=e.lineBlockAt(i),s=ah(t,r.from,r.to);s&&n.push(hh.of(s)),i=(s?e.lineBlockAt(s.to):r).to+1}return n.length&&e.dispatch({effects:mh(e.state,n)}),!!n.length}},{key:"Ctrl-Alt-]",run:e=>{let t=e.state.field(dh,!1);if(!t||!t.size)return!1;let n=[];return t.between(0,e.state.doc.length,((e,t)=>{n.push(ch.of({from:e,to:t}))})),e.dispatch({effects:n}),!0}}],yh={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},vh=U.define({combine:e=>Pe(e,yh)});function bh(e){let t=[dh,Ch];return e&&t.push(vh.of(e)),t}function wh(e,t){let{state:n}=e,i=n.facet(vh),r=t=>{let n=e.lineBlockAt(e.posAtDOM(t.target)),i=ph(e.state,n.from,n.to);i&&e.dispatch({effects:ch.of(i)}),t.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(e,r,t);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",n.phrase("folded code")),s.title=n.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}var xh=hn.replace({widget:new class extends an{toDOM(e){return wh(e,null)}}}),Sh=class extends an{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return wh(e,this.value)}},kh={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1},Ah=class extends eo{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}};var Ch=Lr.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),_h=class e{constructor(e,t){let n;function i(e){let t=Ke.newName();return(n||(n=Object.create(null)))["."+t]=e,t}this.specs=e;let r="string"==typeof t.all?t.all:t.all?i(t.all):void 0,s=t.scope;this.scope=s instanceof Tl?e=>e.prop(Cl)==s.data:s?e=>e==s:void 0,this.style=Za(e.map((e=>({tag:e.tag,class:e.class||i(Object.assign({},e,{tag:null}))}))),{all:r}).style,this.module=n?new Ke(n):null,this.themeType=t.themeType}static define(t,n){return new e(t,n||{})}},Eh=U.define(),Th=U.define({combine:e=>e.length?[e[0]]:null});function Ph(e){let t=e.facet(Eh);return t.length?t:e.facet(Th)}function $h(e,t){let n,i=[Nh];return e instanceof _h&&(e.module&&i.push(Lr.styleModule.of(e.module)),n=e.themeType),t?.fallback?i.push(Th.of(e)):n?i.push(Eh.computeN([Lr.darkTheme],(t=>t.facet(Lr.darkTheme)==("dark"==n)?[e]:[]))):i.push(Eh.of(e)),i}var Nh=te.high(Kn.fromClass(class{constructor(e){this.markCache=Object.create(null),this.tree=Nl(e.state),this.decorations=this.buildDeco(e,Ph(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Nl(e.state),n=Ph(e.state),i=n!=Ph(e.startState),{viewport:r}=e.view,s=e.changes.mapPos(this.decoratedTo,1);t.length<r.to&&!i&&t.type==this.tree.type&&s>=r.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=s):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=r.to)}buildDeco(e,t){if(!t||!this.tree.length)return hn.none;let n=new Re;for(let{from:i,to:r}of e.visibleRanges)ja(this.tree,t,((e,t,i)=>{n.add(e,t,this.markCache[i]||(this.markCache[i]=hn.mark({class:i})))}),i,r);return n.finish()}},{decorations:e=>e.decorations})),Ih=_h.define([{tag:hl.meta,color:"#404740"},{tag:hl.link,textDecoration:"underline"},{tag:hl.heading,textDecoration:"underline",fontWeight:"bold"},{tag:hl.emphasis,fontStyle:"italic"},{tag:hl.strong,fontWeight:"bold"},{tag:hl.strikethrough,textDecoration:"line-through"},{tag:hl.keyword,color:"#708"},{tag:[hl.atom,hl.bool,hl.url,hl.contentSeparator,hl.labelName],color:"#219"},{tag:[hl.literal,hl.inserted],color:"#164"},{tag:[hl.string,hl.deleted],color:"#a11"},{tag:[hl.regexp,hl.escape,hl.special(hl.string)],color:"#e40"},{tag:hl.definition(hl.variableName),color:"#00f"},{tag:hl.local(hl.variableName),color:"#30a"},{tag:[hl.typeName,hl.namespace],color:"#085"},{tag:hl.className,color:"#167"},{tag:[hl.special(hl.variableName),hl.macroName],color:"#256"},{tag:hl.definition(hl.propertyName),color:"#00c"},{tag:hl.comment,color:"#940"},{tag:hl.invalid,color:"#f00"}]),Qh=Lr.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Rh="()[]{}",Mh=U.define({combine:e=>Pe(e,{afterCursor:!0,brackets:Rh,maxScanDistance:1e4,renderMatch:Xh})}),Bh=hn.mark({class:"cm-matchingBracket"}),Dh=hn.mark({class:"cm-nonmatchingBracket"});function Xh(e){let t=[],n=e.matched?Bh:Dh;return t.push(n.range(e.start.from,e.start.to)),e.end&&t.push(n.range(e.end.from,e.end.to)),t}var Fh=W.define({create:()=>hn.none,update(e,t){if(!t.docChanged&&!t.selection)return e;let n=[],i=t.state.facet(Mh);for(let e of t.state.selection.ranges){if(!e.empty)continue;let r=Zh(t.state,e.head,-1,i)||e.head>0&&Zh(t.state,e.head-1,1,i)||i.afterCursor&&(Zh(t.state,e.head,1,i)||e.head<t.state.doc.length&&Zh(t.state,e.head+1,-1,i));r&&(n=n.concat(i.renderMatch(r,t.state)))}return hn.set(n,!0)},provide:e=>Lr.decorations.from(e)}),Lh=[Fh,Qh];var Uh=new ko;function Vh(e,t,n){let i=e.prop(t<0?ko.openedBy:ko.closedBy);if(i)return i;if(1==e.name.length){let i=n.indexOf(e.name);if(i>-1&&i%2==(t<0?1:0))return[n[i+t]]}return null}function zh(e){let t=e.type.prop(Uh);return t?t(e.node):e}function Zh(e,t,n,i={}){let r=i.maxScanDistance||1e4,s=i.brackets||Rh,o=Nl(e),a=o.resolveInner(t,n);for(let i=a;i;i=i.parent){let r=Vh(i.type,n,s);if(r&&i.from<i.to){let o=zh(i);if(o&&(n>0?t>=o.from&&t<o.to:t>o.from&&t<=o.to))return jh(e,t,n,i,o,r,s)}}return function(e,t,n,i,r,s,o){let a=n<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),l=o.indexOf(a);if(l<0||l%2==0!=n>0)return null;let h={from:n<0?t-1:t,to:n>0?t+1:t},c=e.doc.iterRange(t,n>0?e.doc.length:0),u=0;for(let e=0;!c.next().done&&e<=s;){let s=c.value;n<0&&(e+=s.length);let a=t+e*n;for(let e=n>0?0:s.length-1,t=n>0?s.length:-1;e!=t;e+=n){let t=o.indexOf(s[e]);if(!(t<0||i.resolveInner(a+e,1).type!=r))if(t%2==0==n>0)u++;else{if(1==u)return{start:h,end:{from:a+e,to:a+e+1},matched:t>>1==l>>1};u--}}n>0&&(e+=s.length)}return c.done?{start:h,matched:!1}:null}(e,t,n,o,a.type,r,s)}function jh(e,t,n,i,r,s,o){let a=i.parent,l={from:r.from,to:r.to},h=0,c=a?.cursor();if(c&&(n<0?c.childBefore(i.from):c.childAfter(i.to)))do{if(n<0?c.to<=i.from:c.from>=i.to){if(0==h&&s.indexOf(c.type.name)>-1&&c.from<c.to){let e=zh(c);return{start:l,end:e?{from:e.from,to:e.to}:void 0,matched:!0}}if(Vh(c.type,n,o))h++;else if(Vh(c.type,-n,o)){if(0==h){let e=zh(c);return{start:l,end:e&&e.from<e.to?{from:e.from,to:e.to}:void 0,matched:!1}}h--}}}while(n<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function qh(e,t,n,i=0,r=0){null==t&&(-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length));let s=r;for(let r=i;r<t;r++)9==e.charCodeAt(r)?s+=n-s%n:s++;return s}var Gh=class{constructor(e,t,n,i){this.string=e,this.tabSize=t,this.indentUnit=n,this.overrideIndent=i,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t,n=this.string.charAt(this.pos);if(t="string"==typeof e?n==e:n&&(e instanceof RegExp?e.test(n):e(n)),t)return++this.pos,n}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=qh(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return null!==(e=this.overrideIndent)&&void 0!==e?e:qh(this.string,null,this.tabSize)}match(e,t,n){if("string"==typeof e){let i=e=>n?e.toLowerCase():e;return i(this.string.substr(this.pos,e.length))==i(e)?(!1!==t&&(this.pos+=e.length),!0):null}{let n=this.string.slice(this.pos).match(e);return n&&n.index>0?null:(n&&!1!==t&&(this.pos+=n[0].length),n)}}current(){return this.string.slice(this.start,this.pos)}};function Wh(e){if("object"!=typeof e)return e;let t={};for(let n in e){let i=e[n];t[n]=i instanceof Array?i.slice():i}return t}var Hh=new WeakMap,Yh=class e extends Tl{constructor(e){let t,n=_l(e.languageData),i=function(e){return{name:e.name||"",token:e.token,blankLine:e.blankLine||(()=>{}),startState:e.startState||(()=>!0),copyState:e.copyState||Wh,indent:e.indent||(()=>null),languageData:e.languageData||{},tokenTable:e.tokenTable||nc}}(e),r=new class extends Yo{createParse(e,n,i){return new ec(t,e,n,i)}};super(n,r,[Vl.of(((e,t)=>this.getIndent(e,t)))],e.name),this.topNode=function(e){let t=_o.define({id:ic.length,name:"Document",props:[Cl.add((()=>e))],top:!0});return ic.push(t),t}(n),t=this,this.streamParser=i,this.stateAfter=new ko({perNode:!0}),this.tokenTable=e.tokenTable?new ac(i.tokenTable):lc}static define(t){return new e(t)}getIndent(e,t){let n=Nl(e.state),i=n.resolve(t);for(;i&&i.type!=this.topNode;)i=i.parent;if(!i)return null;let r,{overrideIndentation:s}=e.options;s&&(r=Hh.get(e.state),null!=r&&r<t-1e4&&(r=void 0));let o,a,l=Jh(this,n,0,i.from,r??t);if(l?(a=l.state,o=l.pos+1):(a=this.streamParser.startState(e.unit),o=0),t-o>1e4)return null;for(;o<t;){let n=e.state.doc.lineAt(o),i=Math.min(t,n.to);if(n.length){let t=s?s(n.from):-1,r=new Gh(n.text,e.state.tabSize,e.unit,t<0?void 0:t);for(;r.pos<i-n.from;)tc(this.streamParser.token,r,a)}else this.streamParser.blankLine(a,e.unit);if(i==t)break;o=n.to+1}let h=e.lineAt(t);return s&&null==r&&Hh.set(e.state,h.from),this.streamParser.indent(a,/^\s*(.*)/.exec(h.text)[1],e)}get allowsNesting(){return!1}};function Jh(e,t,n,i,r){let s=n>=i&&n+t.length<=r&&t.prop(e.stateAfter);if(s)return{state:e.streamParser.copyState(s),pos:n+t.length};for(let s=t.children.length-1;s>=0;s--){let o=t.children[s],a=n+t.positions[s],l=o instanceof No&&a<r&&Jh(e,o,a,i,r);if(l)return l}return null}function Kh(e,t,n,i,r){if(r&&n<=0&&i>=t.length)return t;!r&&t.type==e.topNode&&(r=!0);for(let s=t.children.length-1;s>=0;s--){let o,a=t.positions[s],l=t.children[s];if(a<i&&l instanceof No){if(!(o=Kh(e,l,n-a,i-a,r)))break;return r?new No(t.type,t.children.slice(0,s).concat(o),t.positions.slice(0,s+1),a+o.length):o}}return null}var ec=class{constructor(e,t,n,i){this.lang=e,this.input=t,this.fragments=n,this.ranges=i,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=i[i.length-1].to;let r=Ql.get(),s=i[0].from,{state:o,tree:a}=function(e,t,n,i){for(let i of t){let t,r=i.from+(i.openStart?25:0),s=i.to-(i.openEnd?25:0),o=r<=n&&s>n&&Jh(e,i.tree,0-i.offset,n,s);if(o&&(t=Kh(e,i.tree,n+i.offset,o.pos+i.offset,!1)))return{state:o.state,tree:t}}return{state:e.streamParser.startState(i?Zl(i):4),tree:No.empty}}(e,n,s,r?.state);this.state=o,this.parsedPos=this.chunkStart=s+a.length;for(let e=0;e<a.children.length;e++)this.chunks.push(a.children[e]),this.chunkPos.push(a.positions[e]);r&&this.parsedPos<r.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(Zl(r.state)),r.skipUntilInView(this.parsedPos,r.viewport.from),this.parsedPos=r.viewport.from),this.moveRangeIndex()}advance(){let e=Ql.get(),t=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(t,this.chunkStart+2048);for(e&&(n=Math.min(n,e.viewport.to));this.parsedPos<n;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)"\n"==t&&(t="");else{let e=t.indexOf("\n");e>-1&&(t=t.slice(0,e))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),n=e+t.length;for(let e=this.rangeIndex;;){let i=this.ranges[e].to;if(i>=n||(t=t.slice(0,i-(n-t.length)),e++,e==this.ranges.length))break;let r=this.ranges[e].from,s=this.lineAfter(r);t+=s,n=r+s.length}return{line:t,end:n}}skipGapsTo(e,t,n){for(;;){let i=this.ranges[this.rangeIndex].to,r=e+t;if(n>0?i>r:i>=r)break;t+=this.ranges[++this.rangeIndex].from-i}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,n,i,r){if(this.ranges.length>1){t+=r=this.skipGapsTo(t,r,1);let e=this.chunk.length;n+=r=this.skipGapsTo(n,r,-1),i+=this.chunk.length-e}return this.chunk.push(e,t,n,i),r}parseLine(e){let{line:t,end:n}=this.nextLine(),i=0,{streamParser:r}=this.lang,s=new Gh(t,e?e.state.tabSize:4,e?Zl(e.state):2);if(s.eol())r.blankLine(this.state,s.indentUnit);else for(;!s.eol();){let e=tc(r.token,s,this.state);if(e&&(i=this.emitToken(this.lang.tokenTable.resolve(e),this.parsedPos+s.start,this.parsedPos+s.pos,4,i)),s.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=No.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:rc,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new No(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new No(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function tc(e,t,n){t.start=t.pos;for(let i=0;i<10;i++){let i=e(t,n);if(t.pos>t.start)return i}throw new Error("Stream parser failed to advance stream.")}var nc=Object.create(null),ic=[_o.none],rc=new To(ic),sc=Object.create(null),oc=Object.create(null);for(let[e,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])oc[e]=hc(nc,t);var ac=class{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),oc)}resolve(e){return e?this.table[e]||(this.table[e]=hc(this.extra,e)):0}},lc=new ac(nc);function hc(e,t){let n=[];for(let i of t.split(" ")){let t=[];for(let n of i.split(".")){let i=e[n]||hl[n];i&&("function"==typeof i?t.length&&(t=t.map(i)):t.length||(t=Array.isArray(i)?i:[i]))}for(let e of t)n.push(e)}if(!n.length)return 0;let i=t.replace(/ /g,"_"),r=i+" "+n.map((e=>e.id)),s=sc[r];if(s)return s.id;let o=sc[r]=_o.define({id:ic.length,name:i,props:[Ua({[i]:n})]});return ic.push(o),o.id}function cc(e,t){let n=t&&t.getChild("TagName");return n?e.sliceString(n.from,n.to):""}function uc(e,t){let n=t&&t.firstChild;return n&&"OpenTag"==n.name?cc(e,n):""}function dc(e){for(let t=e&&e.parent;t;t=t.parent)if("Element"==t.name)return t;return null}hn.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:yn.RTL}),hn.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:yn.LTR}),hn.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null});var pc=class{constructor(e,t,n){this.attrs=t,this.attrValues=n,this.children=[],this.name=e.name,this.completion=Object.assign(Object.assign({type:"type"},e.completion||{}),{label:this.name}),this.openCompletion=Object.assign(Object.assign({},this.completion),{label:"<"+this.name}),this.closeCompletion=Object.assign(Object.assign({},this.completion),{label:"</"+this.name+">",boost:2}),this.closeNameCompletion=Object.assign(Object.assign({},this.completion),{label:this.name+">"}),this.text=e.textContent?e.textContent.map((e=>({label:e,type:"text"}))):[]}},fc=/^[:\-\.\w\u00b7-\uffff]*$/;function mc(e){return Object.assign(Object.assign({type:"property"},e.completion||{}),{label:e.name})}function gc(e){return"string"==typeof e?{label:`"${e}"`,type:"constant"}:/^"/.test(e.label)?e:Object.assign(Object.assign({},e),{label:`"${e.label}"`})}function Oc(e,t){let n=[],i=[],r=Object.create(null);for(let e of t){let t=mc(e);n.push(t),e.global&&i.push(t),e.values&&(r[e.name]=e.values.map(gc))}let s=[],o=[],a=Object.create(null);for(let t of e){let e=i,l=r;t.attributes&&(e=e.concat(t.attributes.map((e=>"string"==typeof e?n.find((t=>t.label==e))||{label:e,type:"property"}:(e.values&&(l==r&&(l=Object.create(l)),l[e.name]=e.values.map(gc)),mc(e))))));let h=new pc(t,e,l);a[h.name]=h,s.push(h),t.top&&o.push(h)}o.length||(o=s);for(let t=0;t<s.length;t++){let n=e[t],i=s[t];if(n.children)for(let e of n.children)a[e]&&i.children.push(a[e]);else i.children=s}return e=>{var t;let{doc:n}=e.state,l=function(e,t){var n;let i=Nl(e).resolveInner(t,-1),r=null;for(let e=i;!r&&e.parent;e=e.parent)("OpenTag"==e.name||"CloseTag"==e.name||"SelfClosingTag"==e.name||"MismatchedCloseTag"==e.name)&&(r=e);if(r&&(r.to>t||r.lastChild.type.isError)){let e=r.parent;if("TagName"==i.name)return"CloseTag"==r.name||"MismatchedCloseTag"==r.name?{type:"closeTag",from:i.from,context:e}:{type:"openTag",from:i.from,context:dc(e)};if("AttributeName"==i.name)return{type:"attrName",from:i.from,context:r};if("AttributeValue"==i.name)return{type:"attrValue",from:i.from,context:r};let n=i==r||"Attribute"==i.name?i.childBefore(t):i;return"StartTag"==n?.name?{type:"openTag",from:t,context:dc(e)}:"StartCloseTag"==n?.name&&n.to<=t?{type:"closeTag",from:t,context:e}:"Is"==n?.name?{type:"attrValue",from:t,context:r}:n?{type:"attrName",from:t,context:r}:null}if("StartCloseTag"==i.name)return{type:"closeTag",from:t,context:i.parent};for(;i.parent&&i.to==t&&(null===(n=i.lastChild)||void 0===n||!n.type.isError);)i=i.parent;return"Element"==i.name||"Text"==i.name||"Document"==i.name?{type:"tag",from:t,context:"Element"==i.name?i:dc(i)}:null}(e.state,e.pos);if(!l||"tag"==l.type&&!e.explicit)return null;let{type:h,from:c,context:u}=l;if("openTag"==h){let e=o,t=uc(n,u);if(t){e=a[t]?.children||s}return{from:c,options:e.map((e=>e.completion)),validFor:fc}}if("closeTag"==h){let i=uc(n,u);return i?{from:c,to:e.pos+(">"==n.sliceString(e.pos,e.pos+1)?1:0),options:[(null===(t=a[i])||void 0===t?void 0:t.closeNameCompletion)||{label:i+">",type:"type"}],validFor:fc}:null}if("attrName"==h){return{from:c,options:a[cc(n,u)]?.attrs||i,validFor:fc}}if("attrValue"==h){let t=function(e,t,n){let i=t&&t.getChildren("Attribute").find((e=>e.from<=n&&e.to>=n)),r=i&&i.getChild("AttributeName");return r?e.sliceString(r.from,r.to):""}(n,u,c);if(!t)return null;let i=(a[cc(n,u)]?.attrValues||r)[t];return i&&i.length?{from:c,to:e.pos+('"'==n.sliceString(e.pos,e.pos+1)?1:0),options:i,validFor:/^"[^"]*"?$/}:null}if("tag"==h){let t=uc(n,u),i=a[t],r=[],l=u&&u.lastChild;t&&(!l||"CloseTag"!=l.name||cc(n,l)!=t)&&r.push(i?i.closeCompletion:{label:"</"+t+">",type:"type",boost:2});let h=r.concat((i?.children||(u?s:o)).map((e=>e.openCompletion)));if(u&&i?.text.length){let t=u.firstChild;t.to>e.pos-20&&!/\S/.test(e.state.sliceDoc(t.to,e.pos))&&(h=h.concat(i.text))}return{from:c,options:h,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}return null}}var yc=$l.define({name:"xml",parser:Al.configure({props:[Wl.add({Element(e){let t=/^\s*<\//.test(e.textAfter);return e.lineIndent(e.node.from)+(t?0:e.unit)},"OpenTag CloseTag SelfClosingTag":e=>e.column(e.node.from)+e.unit}),rh.add({Element(e){let t=e.firstChild,n=e.lastChild;return t&&"OpenTag"==t.name?{from:t.to,to:"CloseTag"==n.name?n.from:e.to}:null}}),Uh.add({"OpenTag CloseTag":e=>e.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}},indentOnInput:/^\s*<\/$/}});function vc(e={}){let t=[yc.data.of({autocomplete:Oc(e.elements||[],e.attributes||[])})];return!1!==e.autoCloseTags&&t.push(wc),new Ll(yc,t)}function bc(e,t,n=e.length){if(!t)return"";let i=t.firstChild,r=i&&i.getChild("TagName");return r?e.sliceString(r.from,Math.min(r.to,n)):""}var wc=Lr.inputHandler.of(((e,t,n,i,r)=>{if(e.composing||e.state.readOnly||t!=n||">"!=i&&"/"!=i||!yc.isActiveAt(e.state,t,-1))return!1;let s=r(),{state:o}=s,a=o.changeByRange((e=>{var t,n,r;let s,{head:a}=e,l=o.doc.sliceString(a-1,a)==i,h=Nl(o).resolveInner(a,-1);if(l&&">"==i&&"EndTag"==h.name){let i=h.parent;if("CloseTag"!=(null===(n=null===(t=i.parent)||void 0===t?void 0:t.lastChild)||void 0===n?void 0:n.name)&&(s=bc(o.doc,i.parent,a))){return{range:e,changes:{from:a,to:a+(">"===o.doc.sliceString(a,a+1)?1:0),insert:`</${s}>`}}}}else if(l&&"/"==i&&"StartCloseTag"==h.name){let e=h.parent;if(h.from==a-2&&"CloseTag"!=(null===(r=e.lastChild)||void 0===r?void 0:r.name)&&(s=bc(o.doc,e,a))){let e=a+(">"===o.doc.sliceString(a,a+1)?1:0),t=`${s}>`;return{range:X.cursor(a+t.length,-1),changes:{from:a,to:e,insert:t}}}}return{range:e}}));return!a.changes.empty&&(e.dispatch([s,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}));function xc(e,t){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let r=e(t,n);return!!r&&(i(n.update(r)),!0)}}var Sc=xc((function(e,t,n=t.selection.ranges){let i=[],r=-1;for(let{from:e,to:s}of n){let n=i.length,o=1e9,a=Cc(t,e).line;if(a){for(let n=e;n<=s;){let l=t.doc.lineAt(n);if(l.from>r&&(e==s||s>l.from)){r=l.from;let e=/^\s*/.exec(l.text)[0].length,t=e==l.length,n=l.text.slice(e,e+a.length)==a?e:-1;e<l.text.length&&e<o&&(o=e),i.push({line:l,comment:n,token:a,indent:e,empty:t,single:!1})}n=l.to+1}if(o<1e9)for(let e=n;e<i.length;e++)i[e].indent<i[e].line.text.length&&(i[e].indent=o);i.length==n+1&&(i[n].single=!0)}}if(2!=e&&i.some((e=>e.comment<0&&(!e.empty||e.single)))){let e=[];for(let{line:t,token:n,indent:r,empty:s,single:o}of i)(o||!s)&&e.push({from:t.from+r,insert:n+" "});let n=t.changes(e);return{changes:n,selection:t.selection.map(n,1)}}if(1!=e&&i.some((e=>e.comment>=0))){let e=[];for(let{line:t,comment:n,token:r}of i)if(n>=0){let i=t.from+n,s=i+r.length;" "==t.text[s-t.from]&&s++,e.push({from:i,to:s})}return{changes:e}}return null}),0),kc=xc(_c,0),Ac=xc(((e,t)=>_c(e,t,function(e){let t=[];for(let n of e.selection.ranges){let i=e.doc.lineAt(n.from),r=n.to<=i.to?i:e.doc.lineAt(n.to),s=t.length-1;s>=0&&t[s].to>i.from?t[s].to=r.to:t.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return t}(t))),0);function Cc(e,t){let n=e.languageDataAt("commentTokens",t);return n.length?n[0]:{}}function _c(e,t,n=t.selection.ranges){let i=n.map((e=>Cc(t,e.from).block));if(!i.every((e=>e)))return null;let r=n.map(((e,n)=>function(e,{open:t,close:n},i,r){let s,o,a=e.sliceDoc(i-50,i),l=e.sliceDoc(r,r+50),h=/\s*$/.exec(a)[0].length,c=/^\s*/.exec(l)[0].length,u=a.length-h;if(a.slice(u-t.length,u)==t&&l.slice(c,c+n.length)==n)return{open:{pos:i-h,margin:h&&1},close:{pos:r+c,margin:c&&1}};r-i<=100?s=o=e.sliceDoc(i,r):(s=e.sliceDoc(i,i+50),o=e.sliceDoc(r-50,r));let d=/^\s*/.exec(s)[0].length,p=/\s*$/.exec(o)[0].length,f=o.length-p-n.length;return s.slice(d,d+t.length)==t&&o.slice(f,f+n.length)==n?{open:{pos:i+d+t.length,margin:/\s/.test(s.charAt(d+t.length))?1:0},close:{pos:r-p-n.length,margin:/\s/.test(o.charAt(f-1))?1:0}}:null}(t,i[n],e.from,e.to)));if(2!=e&&!r.every((e=>e)))return{changes:t.changes(n.map(((e,t)=>r[t]?[]:[{from:e.from,insert:i[t].open+" "},{from:e.to,insert:" "+i[t].close}])))};if(1!=e&&r.some((e=>e))){let e=[];for(let t,n=0;n<r.length;n++)if(t=r[n]){let r=i[n],{open:s,close:o}=t;e.push({from:s.pos-r.open.length,to:s.pos+s.margin},{from:o.pos-o.margin,to:o.pos+r.close.length})}return{changes:e}}return null}var Ec=me.define(),Tc=me.define(),Pc=U.define(),$c=U.define({combine:e=>Pe(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,i)=>e(n,i)||t(n,i)})});var Nc=W.define({create:()=>qc.empty,update(e,t){let n=t.state.facet($c),i=t.annotation(Ec);if(i){let r=t.docChanged?X.single(function(e){let t=0;return e.iterChangedRanges(((e,n)=>t=n)),t}(t.changes)):void 0,s=Dc.fromTransaction(t,r),o=i.side,a=0==o?e.undone:e.done;return a=s?Xc(a,a.length,n.minDepth,s):Uc(a,t.startState.selection),new qc(0==o?i.rest:a,0==o?a:i.rest)}let r=t.annotation(Tc);if(("full"==r||"before"==r)&&(e=e.isolate()),!1===t.annotation(ye.addToHistory))return t.changes.empty?e:e.addMapping(t.changes.desc);let s=Dc.fromTransaction(t),o=t.annotation(ye.time),a=t.annotation(ye.userEvent);return s?e=e.addChanges(s,o,a,n,t):t.selection&&(e=e.addSelection(t.startState.selection,o,a,n.newGroupDelay)),("full"==r||"after"==r)&&(e=e.isolate()),e},toJSON:e=>({done:e.done.map((e=>e.toJSON())),undone:e.undone.map((e=>e.toJSON()))}),fromJSON:e=>new qc(e.done.map(Dc.fromJSON),e.undone.map(Dc.fromJSON))});function Ic(e,t){return function({state:n,dispatch:i}){if(!t&&n.readOnly)return!1;let r=n.field(Nc,!1);if(!r)return!1;let s=r.pop(e,n,t);return!!s&&(i(s),!0)}}var Qc=Ic(0,!1),Rc=Ic(1,!1),Mc=Ic(0,!0),Bc=Ic(1,!0),Dc=class e{constructor(e,t,n,i,r){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=i,this.selectionsAfter=r}setSelAfter(t){return new e(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var e,t,n;return{changes:null===(e=this.changes)||void 0===e?void 0:e.toJSON(),mapped:null===(t=this.mapped)||void 0===t?void 0:t.toJSON(),startSelection:null===(n=this.startSelection)||void 0===n?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map((e=>e.toJSON()))}}static fromJSON(t){return new e(t.changes&&$.fromJSON(t.changes),[],t.mapped&&P.fromJSON(t.mapped),t.startSelection&&X.fromJSON(t.startSelection),t.selectionsAfter.map(X.fromJSON))}static fromTransaction(t,n){let i=Lc;for(let e of t.startState.facet(Pc)){let n=e(t);n.length&&(i=i.concat(n))}return!i.length&&t.changes.empty?null:new e(t.changes.invert(t.startState.doc),i,void 0,n||t.startState.selection,Lc)}static selection(t){return new e(void 0,Lc,void 0,void 0,t)}};function Xc(e,t,n,i){let r=t+1>n+20?t-n-1:0,s=e.slice(r,t);return s.push(i),s}function Fc(e,t){return e.length?t.length?e.concat(t):e:t}var Lc=[];function Uc(e,t){if(e.length){let n=e[e.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-200));return i.length&&i[i.length-1].eq(t)?e:(i.push(t),Xc(e,e.length-1,1e9,n.setSelAfter(i)))}return[Dc.selection([t])]}function Vc(e){let t=e[e.length-1],n=e.slice();return n[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),n}function zc(e,t){if(!e.length)return e;let n=e.length,i=Lc;for(;n;){let r=Zc(e[n-1],t,i);if(r.changes&&!r.changes.empty||r.effects.length){let t=e.slice(0,n);return t[n-1]=r,t}t=r.mapped,n--,i=r.selectionsAfter}return i.length?[Dc.selection(i)]:Lc}function Zc(e,t,n){let i=Fc(e.selectionsAfter.length?e.selectionsAfter.map((e=>e.map(t))):Lc,n);if(!e.changes)return Dc.selection(i);let r=e.changes.map(t),s=t.mapDesc(e.changes,!0),o=e.mapped?e.mapped.composeDesc(s):s;return new Dc(r,Oe.mapEffects(e.effects,t),o,e.startSelection.map(s),i)}var jc=/^(input\.type|delete)($|\.)/,qc=class e{constructor(e,t,n=0,i){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=i}isolate(){return this.prevTime?new e(this.done,this.undone):this}addChanges(t,n,i,r,s){let o=this.done,a=o[o.length-1];return o=a&&a.changes&&!a.changes.empty&&t.changes&&(!i||jc.test(i))&&(!a.selectionsAfter.length&&n-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,function(e,t){let n=[],i=!1;return e.iterChangedRanges(((e,t)=>n.push(e,t))),t.iterChangedRanges(((e,t,r,s)=>{for(let e=0;e<n.length;){let t=n[e++],o=n[e++];s>=t&&r<=o&&(i=!0)}})),i}(a.changes,t.changes))||"input.type.compose"==i)?Xc(o,o.length-1,r.minDepth,new Dc(t.changes.compose(a.changes),Fc(t.effects,a.effects),a.mapped,a.startSelection,Lc)):Xc(o,o.length,r.minDepth,t),new e(o,Lc,n,i)}addSelection(t,n,i,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Lc;return s.length>0&&n-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&function(e,t){return e.ranges.length==t.ranges.length&&0===e.ranges.filter(((e,n)=>e.empty!=t.ranges[n].empty)).length}(s[s.length-1],t)?this:new e(Uc(this.done,t),this.undone,n,i)}addMapping(t){return new e(zc(this.done,t),zc(this.undone,t),this.prevTime,this.prevUserEvent)}pop(e,t,n){let i=0==e?this.done:this.undone;if(0==i.length)return null;let r=i[i.length-1];if(n&&r.selectionsAfter.length)return t.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:Ec.of({side:e,rest:Vc(i)}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let n=1==i.length?Lc:i.slice(0,i.length-1);return r.mapped&&(n=zc(n,r.mapped)),t.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:Ec.of({side:e,rest:n}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}return null}};qc.empty=new qc(Lc,Lc);var Gc=[{key:"Mod-z",run:Qc,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Rc,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Rc,preventDefault:!0},{key:"Mod-u",run:Mc,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Bc,preventDefault:!0}];function Wc(e,t){return X.create(e.ranges.map(t),e.mainIndex)}function Hc(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function Yc({state:e,dispatch:t},n){let i=Wc(e.selection,n);return!i.eq(e.selection)&&(t(Hc(e,i)),!0)}function Jc(e,t){return X.cursor(t?e.to:e.from)}function Kc(e,t){return Yc(e,(n=>n.empty?e.moveByChar(n,t):Jc(n,t)))}function eu(e){return e.textDirectionAt(e.state.selection.main.head)==yn.LTR}var tu=e=>Kc(e,!eu(e)),nu=e=>Kc(e,eu(e));function iu(e,t){return Yc(e,(n=>n.empty?e.moveByGroup(n,t):Jc(n,t)))}function ru(e,t,n){if(t.type.prop(n))return!0;let i=t.to-t.from;return i&&(i>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function su(e,t,n){let i,r,s=Nl(e).resolveInner(t.head),o=n?ko.closedBy:ko.openedBy;for(let i=t.head;;){let t=n?s.childAfter(i):s.childBefore(i);if(!t)break;ru(e,t,o)?s=t:i=n?t.to:t.from}return r=s.type.prop(o)&&(i=n?Zh(e,s.from,1):Zh(e,s.to,-1))&&i.matched?n?i.end.to:i.end.from:n?s.to:s.from,X.cursor(r,n?-1:1)}function ou(e,t){return Yc(e,(n=>{if(!n.empty)return Jc(n,t);let i=e.moveVertically(n,t);return i.head!=n.head?i:e.moveToLineBoundary(n,t)}))}var au=e=>ou(e,!1),lu=e=>ou(e,!0);function hu(e){let t,n=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,i=0,r=0;if(n){for(let t of e.state.facet(Lr.scrollMargins)){let n=t(e);n?.top&&(i=Math.max(n?.top,i)),n?.bottom&&(r=Math.max(n?.bottom,r))}t=e.scrollDOM.clientHeight-i-r}else t=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:i,marginBottom:r,selfScroll:n,height:Math.max(e.defaultLineHeight,t-5)}}function cu(e,t){let n,i=hu(e),{state:r}=e,s=Wc(r.selection,(n=>n.empty?e.moveVertically(n,t,i.height):Jc(n,t)));if(s.eq(r.selection))return!1;if(i.selfScroll){let t=e.coordsAtPos(r.selection.main.head),o=e.scrollDOM.getBoundingClientRect(),a=o.top+i.marginTop,l=o.bottom-i.marginBottom;t&&t.top>a&&t.bottom<l&&(n=Lr.scrollIntoView(s.main.head,{y:"start",yMargin:t.top-a}))}return e.dispatch(Hc(r,s),{effects:n}),!0}var uu=e=>cu(e,!1),du=e=>cu(e,!0);function pu(e,t,n){let i=e.lineBlockAt(t.head),r=e.moveToLineBoundary(t,n);if(r.head==t.head&&r.head!=(n?i.to:i.from)&&(r=e.moveToLineBoundary(t,n,!1)),!n&&r.head==i.from&&i.length){let n=/^\s*/.exec(e.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;n&&t.head!=i.from+n&&(r=X.cursor(i.from+n))}return r}function fu(e,t){let n=Wc(e.state.selection,(e=>{let n=t(e);return X.range(e.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)}));return!n.eq(e.state.selection)&&(e.dispatch(Hc(e.state,n)),!0)}function mu(e,t){return fu(e,(n=>e.moveByChar(n,t)))}var gu=e=>mu(e,!eu(e)),Ou=e=>mu(e,eu(e));function yu(e,t){return fu(e,(n=>e.moveByGroup(n,t)))}function vu(e,t){return fu(e,(n=>e.moveVertically(n,t)))}var bu=e=>vu(e,!1),wu=e=>vu(e,!0);function xu(e,t){return fu(e,(n=>e.moveVertically(n,t,hu(e).height)))}var Su=e=>xu(e,!1),ku=e=>xu(e,!0),Au=({state:e,dispatch:t})=>(t(Hc(e,{anchor:0})),!0),Cu=({state:e,dispatch:t})=>(t(Hc(e,{anchor:e.doc.length})),!0),_u=({state:e,dispatch:t})=>(t(Hc(e,{anchor:e.selection.main.anchor,head:0})),!0),Eu=({state:e,dispatch:t})=>(t(Hc(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0);function Tu(e,t){if(e.state.readOnly)return!1;let n="delete.selection",{state:i}=e,r=i.changeByRange((i=>{let{from:r,to:s}=i;if(r==s){let i=t(r);i<r?(n="delete.backward",i=Pu(e,i,!1)):i>r&&(n="delete.forward",i=Pu(e,i,!0)),r=Math.min(r,i),s=Math.max(s,i)}else r=Pu(e,r,!1),s=Pu(e,s,!0);return r==s?{range:i}:{changes:{from:r,to:s},range:X.cursor(r)}}));return!r.changes.empty&&(e.dispatch(i.update(r,{scrollIntoView:!0,userEvent:n,effects:"delete.selection"==n?Lr.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function Pu(e,t,n){if(e instanceof Lr)for(let i of e.state.facet(Lr.atomicRanges).map((t=>t(e))))i.between(t,t,((e,i)=>{e<t&&i>t&&(t=n?i:e)}));return t}var $u=(e,t)=>Tu(e,(n=>{let i,r,{state:s}=e,o=s.doc.lineAt(n);if(!t&&n>o.from&&n<o.from+200&&!/[^ \t]/.test(i=o.text.slice(0,n-o.from))){if("\t"==i[i.length-1])return n-1;let e=je(i,s.tabSize)%Zl(s)||Zl(s);for(let t=0;t<e&&" "==i[i.length-1-t];t++)n--;r=n}else r=b(o.text,n-o.from,t,t)+o.from,r==n&&o.number!=(t?s.doc.lines:1)&&(r+=t?1:-1);return r})),Nu=e=>$u(e,!1),Iu=e=>$u(e,!0),Qu=(e,t)=>Tu(e,(n=>{let i=n,{state:r}=e,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let e=null;;){if(i==(t?s.to:s.from)){i==n&&s.number!=(t?r.doc.lines:1)&&(i+=t?1:-1);break}let a=b(s.text,i-s.from,t)+s.from,l=s.text.slice(Math.min(i,a)-s.from,Math.max(i,a)-s.from),h=o(l);if(null!=e&&h!=e)break;(" "!=l||i!=n)&&(e=h),i=a}return i})),Ru=e=>Qu(e,!1),Mu=e=>Tu(e,(t=>{let n=e.lineBlockAt(t).to;return t<n?n:Math.min(e.state.doc.length,t+1)}));function Bu(e){let t=[],n=-1;for(let i of e.selection.ranges){let r=e.doc.lineAt(i.from),s=e.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=e.doc.lineAt(i.to-1)),n>=r.number){let e=t[t.length-1];e.to=s.to,e.ranges.push(i)}else t.push({from:r.from,to:s.to,ranges:[i]});n=s.number+1}return t}function Du(e,t,n){if(e.readOnly)return!1;let i=[],r=[];for(let t of Bu(e)){if(n?t.to==e.doc.length:0==t.from)continue;let s=e.doc.lineAt(n?t.to+1:t.from-1),o=s.length+1;if(n){i.push({from:t.to,to:s.to},{from:t.from,insert:s.text+e.lineBreak});for(let n of t.ranges)r.push(X.range(Math.min(e.doc.length,n.anchor+o),Math.min(e.doc.length,n.head+o)))}else{i.push({from:s.from,to:t.from},{from:t.to,insert:e.lineBreak+s.text});for(let e of t.ranges)r.push(X.range(e.anchor-o,e.head-o))}}return!!i.length&&(t(e.update({changes:i,scrollIntoView:!0,selection:X.create(r,e.selection.mainIndex),userEvent:"move.line"})),!0)}function Xu(e,t,n){if(e.readOnly)return!1;let i=[];for(let t of Bu(e))n?i.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):i.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});return t(e.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}var Fu=Uu(!1),Lu=Uu(!0);function Uu(e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let i=t.changeByRange((n=>{let{from:i,to:r}=n,s=t.doc.lineAt(i),o=!e&&i==r&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let n,i=Nl(e).resolveInner(t),r=i.childBefore(t),s=i.childAfter(t);return r&&s&&r.to<=t&&s.from>=t&&(n=r.type.prop(ko.closedBy))&&n.indexOf(s.name)>-1&&e.doc.lineAt(r.to).from==e.doc.lineAt(s.from).from?{from:r.to,to:s.from}:null}(t,i);e&&(i=r=(r<=s.to?s:t.doc.lineAt(r)).to);let l=new Gl(t,{simulateBreak:i,simulateDoubleBreak:!!o}),h=ql(l,i);for(null==h&&(h=/^\s*/.exec(t.doc.lineAt(i).text)[0].length);r<s.to&&/\s/.test(s.text[r-s.from]);)r++;o?({from:i,to:r}=o):i>s.from&&i<s.from+100&&!/\S/.test(s.text.slice(0,i))&&(i=s.from);let c=["",jl(t,h)];return o&&c.push(jl(t,l.lineIndent(s.from,-1))),{changes:{from:i,to:r,insert:a.of(c)},range:X.cursor(i+1+c[1].length)}}));return n(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function Vu(e,t){let n=-1;return e.changeByRange((i=>{let r=[];for(let s=i.from;s<=i.to;){let o=e.doc.lineAt(s);o.number>n&&(i.empty||i.to>o.from)&&(t(o,r,i),n=o.number),s=o.to+1}let s=e.changes(r);return{changes:r,range:X.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}}))}var zu=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(Vu(e,((t,n)=>{n.push({from:t.from,insert:e.facet(zl)})})),{userEvent:"input.indent"})),!0),Zu=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(Vu(e,((t,n)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let r=je(i,e.tabSize),s=0,o=jl(e,Math.max(0,r-Zl(e)));for(;s<i.length&&s<o.length&&i.charCodeAt(s)==o.charCodeAt(s);)s++;n.push({from:t.from+s,to:t.from+i.length,insert:o.slice(s)})})),{userEvent:"delete.dedent"})),!0),ju=[{key:"Ctrl-b",run:tu,shift:gu,preventDefault:!0},{key:"Ctrl-f",run:nu,shift:Ou},{key:"Ctrl-p",run:au,shift:bu},{key:"Ctrl-n",run:lu,shift:wu},{key:"Ctrl-a",run:e=>Yc(e,(t=>X.cursor(e.lineBlockAt(t.head).from,1))),shift:e=>fu(e,(t=>X.cursor(e.lineBlockAt(t.head).from)))},{key:"Ctrl-e",run:e=>Yc(e,(t=>X.cursor(e.lineBlockAt(t.head).to,-1))),shift:e=>fu(e,(t=>X.cursor(e.lineBlockAt(t.head).to)))},{key:"Ctrl-d",run:Iu},{key:"Ctrl-h",run:Nu},{key:"Ctrl-k",run:Mu},{key:"Ctrl-Alt-h",run:Ru},{key:"Ctrl-o",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:a.of(["",""])},range:X.cursor(e.from)})));return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange((t=>{if(!t.empty||0==t.from||t.from==e.doc.length)return{range:t};let n=t.from,i=e.doc.lineAt(n),r=n==i.from?n-1:b(i.text,n-i.from,!1)+i.from,s=n==i.to?n+1:b(i.text,n-i.from,!0)+i.from;return{changes:{from:r,to:s,insert:e.doc.slice(n,s).append(e.doc.slice(r,n))},range:X.cursor(s)}}));return!n.changes.empty&&(t(e.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:du}],qu=[{key:"ArrowLeft",run:tu,shift:gu,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>iu(e,!eu(e)),shift:e=>yu(e,!eu(e)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:e=>Yc(e,(t=>pu(e,t,!eu(e)))),shift:e=>fu(e,(t=>pu(e,t,!eu(e)))),preventDefault:!0},{key:"ArrowRight",run:nu,shift:Ou,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>iu(e,eu(e)),shift:e=>yu(e,eu(e)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:e=>Yc(e,(t=>pu(e,t,eu(e)))),shift:e=>fu(e,(t=>pu(e,t,eu(e)))),preventDefault:!0},{key:"ArrowUp",run:au,shift:bu,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Au,shift:_u},{mac:"Ctrl-ArrowUp",run:uu,shift:Su},{key:"ArrowDown",run:lu,shift:wu,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Cu,shift:Eu},{mac:"Ctrl-ArrowDown",run:du,shift:ku},{key:"PageUp",run:uu,shift:Su},{key:"PageDown",run:du,shift:ku},{key:"Home",run:e=>Yc(e,(t=>pu(e,t,!1))),shift:e=>fu(e,(t=>pu(e,t,!1))),preventDefault:!0},{key:"Mod-Home",run:Au,shift:_u},{key:"End",run:e=>Yc(e,(t=>pu(e,t,!0))),shift:e=>fu(e,(t=>pu(e,t,!0))),preventDefault:!0},{key:"Mod-End",run:Cu,shift:Eu},{key:"Enter",run:Fu},{key:"Mod-a",run:({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:Nu,shift:Nu},{key:"Delete",run:Iu},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Ru},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>Qu(e,!0)},{mac:"Mod-Backspace",run:e=>Tu(e,(t=>{let n=e.lineBlockAt(t).from;return t>n?n:Math.max(0,t-1)}))},{mac:"Mod-Delete",run:Mu}].concat(ju.map((e=>({mac:e.key,run:e.run,shift:e.shift})))),Gu=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>Yc(e,(t=>su(e.state,t,!eu(e)))),shift:e=>fu(e,(t=>su(e.state,t,!eu(e))))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>Yc(e,(t=>su(e.state,t,eu(e)))),shift:e=>fu(e,(t=>su(e.state,t,eu(e))))},{key:"Alt-ArrowUp",run:({state:e,dispatch:t})=>Du(e,t,!1)},{key:"Shift-Alt-ArrowUp",run:({state:e,dispatch:t})=>Xu(e,t,!1)},{key:"Alt-ArrowDown",run:({state:e,dispatch:t})=>Du(e,t,!0)},{key:"Shift-Alt-ArrowDown",run:({state:e,dispatch:t})=>Xu(e,t,!0)},{key:"Escape",run:({state:e,dispatch:t})=>{let n=e.selection,i=null;return n.ranges.length>1?i=X.create([n.main]):n.main.empty||(i=X.create([X.cursor(n.main.head)])),!!i&&(t(Hc(e,i)),!0)}},{key:"Mod-Enter",run:Lu},{key:"Alt-l",mac:"Ctrl-l",run:({state:e,dispatch:t})=>{let n=Bu(e).map((({from:t,to:n})=>X.range(t,Math.min(n+1,e.doc.length))));return t(e.update({selection:X.create(n),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:e,dispatch:t})=>{let n=Wc(e.selection,(t=>{var n;let i=Nl(e).resolveInner(t.head,1);for(;!(i.from<t.from&&i.to>=t.to||i.to>t.to&&i.from<=t.from||null===(n=i.parent)||void 0===n)&&n.parent;)i=i.parent;return X.range(i.to,i.from)}));return t(Hc(e,n)),!0},preventDefault:!0},{key:"Mod-[",run:Zu},{key:"Mod-]",run:zu},{key:"Mod-Alt-\\",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=Object.create(null),i=new Gl(e,{overrideIndentation:e=>n[e]??-1}),r=Vu(e,((t,r,s)=>{let o=ql(i,t.from);if(null==o)return;/\S/.test(t.text)||(o=0);let a=/^\s*/.exec(t.text)[0],l=jl(e,o);(a!=l||s.from<t.from+a.length)&&(n[t.from]=o,r.push({from:t.from,to:t.from+a.length,insert:l}))}));return r.changes.empty||t(e.update(r,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:e=>{if(e.state.readOnly)return!1;let{state:t}=e,n=t.changes(Bu(t).map((({from:e,to:n})=>(e>0?e--:n<t.doc.length&&n++,{from:e,to:n})))),i=Wc(t.selection,(t=>e.moveVertically(t,!0))).map(n);return e.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:e,dispatch:t})=>function(e,t,n){let i=!1,r=Wc(e.selection,(t=>{let r=Zh(e,t.head,-1)||Zh(e,t.head,1)||t.head>0&&Zh(e,t.head-1,1)||t.head<e.doc.length&&Zh(e,t.head+1,-1);if(!r||!r.end)return t;i=!0;let s=r.start.from==t.head?r.end.to:r.end.from;return n?X.range(t.anchor,s):X.cursor(s)}));return!!i&&(t(Hc(e,r)),!0)}(e,t,!1)},{key:"Mod-/",run:e=>{let{state:t}=e,n=t.doc.lineAt(t.selection.main.from),i=Cc(e.state,n.from);return i.line?Sc(e):!!i.block&&Ac(e)}},{key:"Alt-A",run:kc}].concat(qu),Wu={key:"Tab",run:zu,shift:Zu};function Hu(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,n=arguments[1];if(n&&"object"==typeof n&&null==n.nodeType&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];"string"==typeof r?e.setAttribute(i,r):null!=r&&(e[i]=r)}t++}for(;t<arguments.length;t++)Yu(e,arguments[t]);return e}function Yu(e,t){if("string"==typeof t)e.appendChild(document.createTextNode(t));else if(null!=t)if(null!=t.nodeType)e.appendChild(t);else{if(!Array.isArray(t))throw new RangeError("Unsupported child node: "+t);for(var n=0;n<t.length;n++)Yu(e,t[n])}}var Ju="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e,Ku=class{constructor(e,t,n=0,i=e.length,r,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=r?e=>r(Ju(e)):Ju,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return A(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=C(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=_(e);let i=this.normalize(t);for(let e=0,r=n;;e++){let s=i.charCodeAt(e),o=this.match(s,r);if(o)return this.value=o,this;if(e==i.length-1)break;r==n&&e<t.length&&t.charCodeAt(e)==s&&r++}}}match(e,t){let n=null;for(let i=0;i<this.matches.length;i+=2){let r=this.matches[i],s=!1;this.query.charCodeAt(r)==e&&(r==this.query.length-1?n={from:this.matches[i+1],to:t+1}:(this.matches[i]++,s=!0)),s||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?n={from:t,to:t+1}:this.matches.push(1,t)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferPos)&&(n=null),n}};typeof Symbol<"u"&&(Ku.prototype[Symbol.iterator]=function(){return this});var ed={from:-1,to:-1,match:/.*/.exec("")},td="gm"+(null==/x/.unicode?"":"u"),nd=class{constructor(e,t,n,i=0,r=e.length){if(this.text=e,this.to=r,this.curLine="",this.done=!1,this.value=ed,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new sd(e,t,n,i,r);this.re=new RegExp(t,td+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=e.iter();let s=e.lineAt(i);this.curLineStart=s.from,this.matchPos=od(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,i=n+t[0].length;if(this.matchPos=od(this.text,i+(n==i?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<i||n>this.value.to)&&(!this.test||this.test(n,i,t)))return this.value={from:n,to:i,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}},id=new WeakMap,rd=class e{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(t,n,i){let r=id.get(t);if(!r||r.from>=i||r.to<=n){let r=new e(n,t.sliceString(n,i));return id.set(t,r),r}if(r.from==n&&r.to==i)return r;let{text:s,from:o}=r;return o>n&&(s=t.sliceString(n,o)+s,o=n),r.to<i&&(s+=t.sliceString(r.to,i)),id.set(t,new e(o,s)),new e(n,s.slice(n-o,i-o))}},sd=class{constructor(e,t,n,i,r){this.text=e,this.to=r,this.done=!1,this.value=ed,this.matchPos=od(e,i),this.re=new RegExp(t,td+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=rd.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let e=this.flat.from+t.index,n=e+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,n,t)))return this.value={from:e,to:n,match:t},this.matchPos=od(this.text,n+(e==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=rd.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}};function od(e,t){if(t>=e.length)return t;let n,i=e.lineAt(t);for(;t<i.to&&(n=i.text.charCodeAt(t-i.from))>=56320&&n<57344;)t++;return t}function ad(e){let t=Hu("input",{class:"cm-textfield",name:"line"}),n=Hu("form",{class:"cm-gotoLine",onkeydown:t=>{27==t.keyCode?(t.preventDefault(),e.dispatch({effects:ld.of(!1)}),e.focus()):13==t.keyCode&&(t.preventDefault(),i())},onsubmit:e=>{e.preventDefault(),i()}},Hu("label",e.state.phrase("Go to line"),": ",t)," ",Hu("button",{class:"cm-button",type:"submit"},e.state.phrase("go")));function i(){let n=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!n)return;let{state:i}=e,r=i.doc.lineAt(i.selection.main.head),[,s,o,a,l]=n,h=a?+a.slice(1):0,c=o?+o:r.number;if(o&&l){let e=c/100;s&&(e=e*("-"==s?-1:1)+r.number/i.doc.lines),c=Math.round(i.doc.lines*e)}else o&&s&&(c=c*("-"==s?-1:1)+r.number);let u=i.doc.line(Math.max(1,Math.min(i.doc.lines,c)));e.dispatch({effects:ld.of(!1),selection:X.cursor(u.from+Math.max(0,Math.min(h,u.length))),scrollIntoView:!0}),e.focus()}return{dom:n}}typeof Symbol<"u"&&(nd.prototype[Symbol.iterator]=sd.prototype[Symbol.iterator]=function(){return this});var ld=Oe.define(),hd=W.define({create:()=>!0,update(e,t){for(let n of t.effects)n.is(ld)&&(e=n.value);return e},provide:e=>Ks.from(e,(e=>e?ad:null))}),cd=Lr.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),ud={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},dd=U.define({combine:e=>Pe(e,ud,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})});var pd=hn.mark({class:"cm-selectionMatch"}),fd=hn.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function md(e,t,n,i){return!(0!=n&&e(t.sliceDoc(n-1,n))==Ce.Word||i!=t.doc.length&&e(t.sliceDoc(i,i+1))==Ce.Word)}var gd=Kn.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=e.state.facet(dd),{state:n}=e,i=n.selection;if(i.ranges.length>1)return hn.none;let r,s=i.main,o=null;if(s.empty){if(!t.highlightWordAroundCursor)return hn.none;let e=n.wordAt(s.head);if(!e)return hn.none;o=n.charCategorizer(s.head),r=n.sliceDoc(e.from,e.to)}else{let e=s.to-s.from;if(e<t.minSelectionLength||e>200)return hn.none;if(t.wholeWords){if(r=n.sliceDoc(s.from,s.to),o=n.charCategorizer(s.head),!md(o,n,s.from,s.to)||!function(e,t,n,i){return e(t.sliceDoc(n,n+1))==Ce.Word&&e(t.sliceDoc(i-1,i))==Ce.Word}(o,n,s.from,s.to))return hn.none}else if(r=n.sliceDoc(s.from,s.to).trim(),!r)return hn.none}let a=[];for(let i of e.visibleRanges){let e=new Ku(n.doc,r,i.from,i.to);for(;!e.next().done;){let{from:i,to:r}=e.value;if((!o||md(o,n,i,r))&&(s.empty&&i<=s.from&&r>=s.to?a.push(fd.range(i,r)):(i>=s.to||r<=s.from)&&a.push(pd.range(i,r)),a.length>t.maxMatches))return hn.none}}return hn.set(a)}},{decorations:e=>e.decorations}),Od=Lr.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});var yd=U.define({combine:e=>Pe(e,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Gd(e),scrollToMatch:e=>Lr.scrollIntoView(e)})}),vd=class{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||function(e){try{return new RegExp(e,td),!0}catch{return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,((e,t)=>"n"==t?"\n":"r"==t?"\r":"t"==t?"\t":"\\"))}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new _d(this):new xd(this)}getCursor(e,t=0,n){let i=e.doc?e:Te.create({doc:e});return null==n&&(n=i.doc.length),this.regexp?Sd(this,i,t,n):wd(this,i,t,n)}},bd=class{constructor(e){this.spec=e}};function wd(e,t,n,i){return new Ku(t.doc,e.unquoted,n,i,e.caseSensitive?void 0:e=>e.toLowerCase(),e.wholeWord?function(e,t){return(n,i,r,s)=>((s>n||s+r.length<i)&&(s=Math.max(0,n-2),r=e.sliceString(s,Math.min(e.length,i+2))),!(t(kd(r,n-s))==Ce.Word&&t(Ad(r,n-s))==Ce.Word||t(Ad(r,i-s))==Ce.Word&&t(kd(r,i-s))==Ce.Word))}(t.doc,t.charCategorizer(t.selection.main.head)):void 0)}var xd=class extends bd{constructor(e){super(e)}nextMatch(e,t,n){let i=wd(this.spec,e,n,e.doc.length).nextOverlapping();return i.done&&(i=wd(this.spec,e,0,t).nextOverlapping()),i.done?null:i.value}prevMatchInRange(e,t,n){for(let i=n;;){let n=Math.max(t,i-1e4-this.spec.unquoted.length),r=wd(this.spec,e,n,i),s=null;for(;!r.nextOverlapping().done;)s=r.value;if(s)return s;if(n==t)return null;i-=1e4}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=wd(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let r=wd(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!r.next().done;)i(r.value.from,r.value.to)}};function Sd(e,t,n,i){return new nd(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?Cd(t.charCategorizer(t.selection.main.head)):void 0},n,i)}function kd(e,t){return e.slice(b(e,t,!1),t)}function Ad(e,t){return e.slice(t,b(e,t))}function Cd(e){return(t,n,i)=>!i[0].length||(e(kd(i.input,i.index))!=Ce.Word||e(Ad(i.input,i.index))!=Ce.Word)&&(e(Ad(i.input,i.index+i[0].length))!=Ce.Word||e(kd(i.input,i.index+i[0].length))!=Ce.Word)}var _d=class extends bd{nextMatch(e,t,n){let i=Sd(this.spec,e,n,e.doc.length).next();return i.done&&(i=Sd(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,n){for(let i=1;;i++){let r=Math.max(t,n-1e4*i),s=Sd(this.spec,e,r,n),o=null;for(;!s.next().done;)o=s.value;if(o&&(r==t||o.from>r+10))return o;if(r==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,((t,n)=>"$"==n?"$":"&"==n?e.match[0]:"0"!=n&&+n<e.match.length?e.match[n]:t)))}matchAll(e,t){let n=Sd(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let r=Sd(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!r.next().done;)i(r.value.from,r.value.to)}},Ed=Oe.define(),Td=Oe.define(),Pd=W.define({create:e=>new $d(Ud(e).create(),null),update(e,t){for(let n of t.effects)n.is(Ed)?e=new $d(n.value.create(),e.panel):n.is(Td)&&(e=new $d(e.query,n.value?Ld:null));return e},provide:e=>Ks.from(e,(e=>e.panel))}),$d=class{constructor(e,t){this.query=e,this.panel=t}},Nd=hn.mark({class:"cm-searchMatch"}),Id=hn.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Qd=Kn.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(Pd))}update(e){let t=e.state.field(Pd);(t!=e.startState.field(Pd)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return hn.none;let{view:n}=this,i=new Re;for(let t=0,r=n.visibleRanges,s=r.length;t<s;t++){let{from:o,to:a}=r[t];for(;t<s-1&&a>r[t+1].from-500;)a=r[++t].to;e.highlight(n.state,o,a,((e,t)=>{let r=n.state.selection.ranges.some((n=>n.from==e&&n.to==t));i.add(e,t,r?Id:Nd)}))}return i.finish()}},{decorations:e=>e.decorations});function Rd(e){return t=>{let n=t.state.field(Pd,!1);return n&&n.query.spec.valid?e(t,n):Zd(t)}}var Md=Rd(((e,{query:t})=>{let{to:n}=e.state.selection.main,i=t.nextMatch(e.state,n,n);if(!i)return!1;let r=X.single(i.from,i.to),s=e.state.facet(yd);return e.dispatch({selection:r,effects:[Yd(e,i),s.scrollToMatch(r.main,e)],userEvent:"select.search"}),zd(e),!0})),Bd=Rd(((e,{query:t})=>{let{state:n}=e,{from:i}=n.selection.main,r=t.prevMatch(n,i,i);if(!r)return!1;let s=X.single(r.from,r.to),o=e.state.facet(yd);return e.dispatch({selection:s,effects:[Yd(e,r),o.scrollToMatch(s.main,e)],userEvent:"select.search"}),zd(e),!0})),Dd=Rd(((e,{query:t})=>{let n=t.matchAll(e.state,1e3);return!(!n||!n.length)&&(e.dispatch({selection:X.create(n.map((e=>X.range(e.from,e.to)))),userEvent:"select.search.matches"}),!0)})),Xd=Rd(((e,{query:t})=>{let{state:n}=e,{from:i,to:r}=n.selection.main;if(n.readOnly)return!1;let s=t.nextMatch(n,i,i);if(!s)return!1;let o,a,l=[],h=[];if(s.from==i&&s.to==r&&(a=n.toText(t.getReplacement(s)),l.push({from:s.from,to:s.to,insert:a}),s=t.nextMatch(n,s.from,s.to),h.push(Lr.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(i).number)+"."))),s){let t=0==l.length||l[0].from>=s.to?0:s.to-s.from-a.length;o=X.single(s.from-t,s.to-t),h.push(Yd(e,s)),h.push(n.facet(yd).scrollToMatch(o.main,e))}return e.dispatch({changes:l,selection:o,effects:h,userEvent:"input.replace"}),!0})),Fd=Rd(((e,{query:t})=>{if(e.state.readOnly)return!1;let n=t.matchAll(e.state,1e9).map((e=>{let{from:n,to:i}=e;return{from:n,to:i,insert:t.getReplacement(e)}}));if(!n.length)return!1;let i=e.state.phrase("replaced $ matches",n.length)+".";return e.dispatch({changes:n,effects:Lr.announce.of(i),userEvent:"input.replace.all"}),!0}));function Ld(e){return e.state.facet(yd).createPanel(e)}function Ud(e,t){var n,i,r,s,o;let a=e.selection.main,l=a.empty||a.to>a.from+100?"":e.sliceDoc(a.from,a.to);if(t&&!l)return t;let h=e.facet(yd);return new vd({search:(null!==(n=t?.literal)&&void 0!==n?n:h.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:null!==(i=t?.caseSensitive)&&void 0!==i?i:h.caseSensitive,literal:null!==(r=t?.literal)&&void 0!==r?r:h.literal,regexp:null!==(s=t?.regexp)&&void 0!==s?s:h.regexp,wholeWord:null!==(o=t?.wholeWord)&&void 0!==o?o:h.wholeWord})}function Vd(e){let t=Ws(e,Ld);return t&&t.dom.querySelector("[main-field]")}function zd(e){let t=Vd(e);t&&t==e.root.activeElement&&t.select()}var Zd=e=>{let t=e.state.field(Pd,!1);if(t&&t.panel){let n=Vd(e);if(n&&n!=e.root.activeElement){let i=Ud(e.state,t.query.spec);i.valid&&e.dispatch({effects:Ed.of(i)}),n.focus(),n.select()}}else e.dispatch({effects:[Td.of(!0),t?Ed.of(Ud(e.state,t.query.spec)):Oe.appendConfig.of(Kd)]});return!0},jd=e=>{let t=e.state.field(Pd,!1);if(!t||!t.panel)return!1;let n=Ws(e,Ld);return n&&n.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:Td.of(!1)}),!0},qd=[{key:"Mod-f",run:Zd,scope:"editor search-panel"},{key:"F3",run:Md,shift:Bd,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Md,shift:Bd,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:jd,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:e,dispatch:t})=>{let n=e.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:i,to:r}=n.main,s=[],o=0;for(let t=new Ku(e.doc,e.sliceDoc(i,r));!t.next().done;){if(s.length>1e3)return!1;t.value.from==i&&(o=s.length),s.push(X.range(t.value.from,t.value.to))}return t(e.update({selection:X.create(s,o),userEvent:"select.search.matches"})),!0}},{key:"Alt-g",run:e=>{let t=Ws(e,ad);if(!t){let n=[ld.of(!0)];null==e.state.field(hd,!1)&&n.push(Oe.appendConfig.of([hd,cd])),e.dispatch({effects:n}),t=Ws(e,ad)}return t&&t.dom.querySelector("input").focus(),!0}},{key:"Mod-d",run:({state:e,dispatch:t})=>{let{ranges:n}=e.selection;if(n.some((e=>e.from===e.to)))return(({state:e,dispatch:t})=>{let{selection:n}=e,i=X.create(n.ranges.map((t=>e.wordAt(t.head)||X.cursor(t.head))),n.mainIndex);return!i.eq(n)&&(t(e.update({selection:i})),!0)})({state:e,dispatch:t});let i=e.sliceDoc(n[0].from,n[0].to);if(e.selection.ranges.some((t=>e.sliceDoc(t.from,t.to)!=i)))return!1;let r=function(e,t){let{main:n,ranges:i}=e.selection,r=e.wordAt(n.head),s=r&&r.from==n.from&&r.to==n.to;for(let n=!1,r=new Ku(e.doc,t,i[i.length-1].to);;){if(r.next(),!r.done){if(n&&i.some((e=>e.from==r.value.from)))continue;if(s){let t=e.wordAt(r.value.from);if(!t||t.from!=r.value.from||t.to!=r.value.to)continue}return r.value}if(n)return null;r=new Ku(e.doc,t,0,Math.max(0,i[i.length-1].from-1)),n=!0}}(e,i);return!!r&&(t(e.update({selection:e.selection.addRange(X.range(r.from,r.to),!1),effects:Lr.scrollIntoView(r.to)})),!0)},preventDefault:!0}],Gd=class{constructor(e){this.view=e;let t=this.query=e.state.field(Pd).query.spec;function n(e,t,n){return Hu("button",{class:"cm-button",name:e,onclick:t,type:"button"},n)}this.commit=this.commit.bind(this),this.searchField=Hu("input",{value:t.search,placeholder:Wd(e,"Find"),"aria-label":Wd(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Hu("input",{value:t.replace,placeholder:Wd(e,"Replace"),"aria-label":Wd(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Hu("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Hu("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Hu("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit}),this.dom=Hu("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,n("next",(()=>Md(e)),[Wd(e,"next")]),n("prev",(()=>Bd(e)),[Wd(e,"previous")]),n("select",(()=>Dd(e)),[Wd(e,"all")]),Hu("label",null,[this.caseField,Wd(e,"match case")]),Hu("label",null,[this.reField,Wd(e,"regexp")]),Hu("label",null,[this.wordField,Wd(e,"by word")]),...e.state.readOnly?[]:[Hu("br"),this.replaceField,n("replace",(()=>Xd(e)),[Wd(e,"replace")]),n("replaceAll",(()=>Fd(e)),[Wd(e,"replace all")])],Hu("button",{name:"close",onclick:()=>jd(e),"aria-label":Wd(e,"close"),type:"button"},[""])])}commit(){let e=new vd({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ed.of(e)}))}keydown(e){!function(e,t,n){return Kr(Yr(e.state),t,e,n)}(this.view,e,"search-panel")?13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Bd:Md)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),Xd(this.view)):e.preventDefault()}update(e){for(let t of e.transactions)for(let e of t.effects)e.is(Ed)&&!e.value.eq(this.query)&&this.setQuery(e.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(yd).top}};function Wd(e,t){return e.state.phrase(t)}var Hd=/[\s\.,:;?!]/;function Yd(e,{from:t,to:n}){let i=e.state.doc.lineAt(t),r=e.state.doc.lineAt(n).to,s=Math.max(i.from,t-30),o=Math.min(r,n+30),a=e.state.sliceDoc(s,o);if(s!=i.from)for(let e=0;e<30;e++)if(!Hd.test(a[e+1])&&Hd.test(a[e])){a=a.slice(e);break}if(o!=r)for(let e=a.length-1;e>a.length-30;e--)if(!Hd.test(a[e-1])&&Hd.test(a[e])){a=a.slice(0,e);break}return Lr.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${i.number}.`)}var Jd=Lr.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Kd=[Pd,te.lowest(Qd),Jd],ep=class{constructor(e,t,n,i){this.state=e,this.pos=t,this.explicit=n,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Nl(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),i=t.text.slice(n-t.from,this.pos-t.from),r=i.search(op(e,!1));return r<0?null:{from:n+r,to:this.pos,text:i.slice(r)}}get aborted(){return null==this.abortListeners}addEventListener(e,t,n){"abort"==e&&this.abortListeners&&(this.abortListeners.push(t),n&&n.onDocChange&&(this.abortOnDocChange=!0))}};function tp(e){let t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),`[${n?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function np(e){let t=e.map((e=>"string"==typeof e?{label:e}:e)),[n,i]=t.every((e=>/^\w+$/.test(e.label)))?[/\w*$/,/\w+$/]:function(e){let t=Object.create(null),n=Object.create(null);for(let{label:i}of e){t[i[0]]=!0;for(let e=1;e<i.length;e++)n[i[e]]=!0}let i=tp(t)+tp(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}(t);return e=>{let r=e.matchBefore(i);return r||e.explicit?{from:r?r.from:e.pos,options:t,validFor:n}:null}}function ip(e,t){return n=>{for(let t=Nl(n.state).resolveInner(n.pos,-1);t;t=t.parent){if(e.indexOf(t.name)>-1)return null;if(t.type.isTop)break}return t(n)}}var rp=class{constructor(e,t,n,i){this.completion=e,this.source=t,this.match=n,this.score=i}};function sp(e){return e.selection.main.from}function op(e,t){var n;let{source:i}=e,r=t&&"^"!=i[0],s="$"!=i[i.length-1];return r||s?new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,null!==(n=e.flags)&&void 0!==n?n:e.ignoreCase?"i":""):e}var ap=me.define();var lp=new WeakMap;function hp(e){if(!Array.isArray(e))return e;let t=lp.get(e);return t||lp.set(e,t=np(e)),t}var cp=Oe.define(),up=Oe.define(),dp=class{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=A(e,t),i=_(n);this.chars.push(n);let r=e.slice(t,t+i),s=r.toUpperCase();this.folded.push(A(s==r?r.toLowerCase():s,0)),t+=i}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(0==this.pattern.length)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:i,precise:r,byWord:s}=this;if(1==t.length){let i=A(e,0),r=_(i),s=r==e.length?0:-100;if(i!=t[0]){if(i!=n[0])return null;s+=-200}return this.ret(s,[0,r])}let o=e.indexOf(this.pattern);if(0==o)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,l=0;if(o<0){for(let r=0,s=Math.min(e.length,200);r<s&&l<a;){let s=A(e,r);(s==t[l]||s==n[l])&&(i[l++]=r),r+=_(s)}if(l<a)return null}let h=0,c=0,u=!1,d=0,p=-1,f=-1,m=/[a-z]/.test(e),g=!0;for(let i=0,l=Math.min(e.length,200),O=0;i<l&&c<a;){let l=A(e,i);o<0&&(h<a&&l==t[h]&&(r[h++]=i),d<a&&(l==t[d]||l==n[d]?(0==d&&(p=i),f=i+1,d++):d=0));let y,v=l<255?l>=48&&l<=57||l>=97&&l<=122?2:l>=65&&l<=90?1:0:(y=C(l))!=y.toLowerCase()?1:y!=y.toUpperCase()?2:0;(!i||1==v&&m||0==O&&0!=v)&&(t[c]==l||n[c]==l&&(u=!0)?s[c++]=i:s.length&&(g=!1)),O=v,i+=_(l)}return c==a&&0==s[0]&&g?this.result((u?-200:0)-100,s,e):d==a&&0==p?this.ret(-200-e.length+(f==e.length?0:-100),[0,f]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):d==a?this.ret(-900-e.length,[p,f]):c==a?this.result((u?-200:0)-100-700+(g?0:-1100),s,e):2==t.length?null:this.result((i[0]?-700:0)-200-1100,i,e)}result(e,t,n){let i=[],r=0;for(let e of t){let t=e+(this.astral?_(A(n,e)):1);r&&i[r-1]==e?i[r-1]=t:(i[r++]=e,i[r++]=t)}return this.ret(e-n.length,i)}},pp=class{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return null==n?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}},fp=U.define({combine:e=>Pe(e,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:gp,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>mp(e(n),t(n)),optionClass:(e,t)=>n=>mp(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})});function mp(e,t){return e?t?e+" "+t:e:t}function gp(e,t,n,i,r,s){let o,a,l=e.textDirection==yn.RTL,h=l,c=!1,u="top",d=t.left-r.left,p=r.right-t.right,f=i.right-i.left,m=i.bottom-i.top;if(h&&d<Math.min(f,p)?h=!1:!h&&p<Math.min(f,d)&&(h=!0),f<=(h?d:p))o=Math.max(r.top,Math.min(n.top,r.bottom-m))-t.top,a=Math.min(400,h?d:p);else{c=!0,a=Math.min(400,(l?t.right:r.right-t.left)-30);let e=r.bottom-t.bottom;e>=m||e>t.top?o=n.bottom-t.top:(u="bottom",o=t.bottom-n.top)}return{style:`${u}: ${o/((t.bottom-t.top)/s.offsetHeight)}px; max-width: ${a/((t.right-t.left)/s.offsetWidth)}px`,class:"cm-completionInfo-"+(c?l?"left-narrow":"right-narrow":h?"left":"right")}}function Op(e,t,n){if(e<=n)return{from:0,to:e};if(t<0&&(t=0),t<=e>>1){let e=Math.floor(t/n);return{from:e*n,to:(e+1)*n}}let i=Math.floor((e-t)/n);return{from:e-(i+1)*n,to:e-i*n}}function yp(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}var vp=class e{constructor(e,t,n,i,r,s){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=i,this.selected=r,this.disabled=s}setSelected(t,n){return t==this.selected||t>=this.options.length?this:new e(this.options,Sp(n,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,n,i,r,s){let o=function(e,t){let n=[],i=null,r=e=>{n.push(e);let{section:t}=e.completion;if(t){i||(i=[]);let e="string"==typeof t?t:t.name;i.some((t=>t.name==e))||i.push("string"==typeof t?{name:e}:t)}},s=t.facet(fp);for(let i of e)if(i.hasResult()){let e=i.result.getMatch;if(!1===i.result.filter)for(let t of i.result.options)r(new rp(t,i.source,e?e(t):[],1e9-n.length));else{let n,o=t.sliceDoc(i.from,i.to),a=s.filterStrict?new pp(o):new dp(o);for(let t of i.result.options)if(n=a.match(t.label)){let s=t.displayLabel?e?e(t,n.matched):[]:n.matched;r(new rp(t,i.source,s,n.score+(t.boost||0)))}}}if(i){let e=Object.create(null),t=0,r=(e,t)=>{var n,i;return(null!==(n=e.rank)&&void 0!==n?n:1e9)-(null!==(i=t.rank)&&void 0!==i?i:1e9)||(e.name<t.name?-1:1)};for(let n of i.sort(r))t-=1e5,e[n.name]=t;for(let t of n){let{section:n}=t.completion;n&&(t.score+=e["string"==typeof n?n:n.name])}}let o=[],a=null,l=s.compareCompletions;for(let e of n.sort(((e,t)=>t.score-e.score||l(e.completion,t.completion)))){let t=e.completion;!a||a.label!=t.label||a.detail!=t.detail||null!=a.type&&null!=t.type&&a.type!=t.type||a.apply!=t.apply||a.boost!=t.boost?o.push(e):yp(e.completion)>yp(a)&&(o[o.length-1]=e),a=e.completion}return o}(t,n);if(!o.length)return r&&t.some((e=>1==e.state))?new e(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let a=n.facet(fp).selectOnOpen?0:-1;if(r&&r.selected!=a&&-1!=r.selected){let e=r.options[r.selected].completion;for(let t=0;t<o.length;t++)if(o[t].completion==e){a=t;break}}return new e(o,Sp(i,a),{pos:t.reduce(((e,t)=>t.hasResult()?Math.min(e,t.from):e),1e8),create:Np,above:s.aboveCursor},r?r.timestamp:Date.now(),a,!1)}map(t){return new e(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}},bp=class e{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new e(kp,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(t){let{state:n}=t,i=n.facet(fp),r=(i.override||n.languageDataAt("autocomplete",sp(n)).map(hp)).map((e=>(this.active.find((t=>t.source==e))||new Cp(e,this.active.some((e=>0!=e.state))?1:0)).update(t,i)));r.length==this.active.length&&r.every(((e,t)=>e==this.active[t]))&&(r=this.active);let s=this.open;s&&t.docChanged&&(s=s.map(t.changes)),t.selection||r.some((e=>e.hasResult()&&t.changes.touchesRange(e.from,e.to)))||!function(e,t){if(e==t)return!0;for(let n=0,i=0;;){for(;n<e.length&&!e[n].hasResult;)n++;for(;i<t.length&&!t[i].hasResult;)i++;let r=n==e.length,s=i==t.length;if(r||s)return r==s;if(e[n++].result!=t[i++].result)return!1}}(r,this.active)?s=vp.build(r,n,this.id,s,i):s&&s.disabled&&!r.some((e=>1==e.state))&&(s=null),!s&&r.every((e=>1!=e.state))&&r.some((e=>e.hasResult()))&&(r=r.map((e=>e.hasResult()?new Cp(e.source,0):e)));for(let e of t.effects)e.is(Tp)&&(s=s&&s.setSelected(e.value,this.id));return r==this.active&&s==this.open?this:new e(r,this.id,s)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?wp:xp}};var wp={"aria-autocomplete":"list"},xp={};function Sp(e,t){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return t>-1&&(n["aria-activedescendant"]=e+"-"+t),n}var kp=[];function Ap(e,t){if(e.isUserEvent("input.complete")){let n=e.annotation(ap);if(n&&t.activateOnCompletion(n))return 12}let n=e.isUserEvent("input.type");return n&&t.activateOnTyping?5:n?1:e.isUserEvent("delete.backward")?2:e.selection?8:e.docChanged?16:0}var Cp=class e{constructor(e,t,n=-1){this.source=e,this.state=t,this.explicitPos=n}hasResult(){return!1}update(t,n){let i=Ap(t,n),r=this;(8&i||16&i&&this.touches(t))&&(r=new e(r.source,0)),4&i&&0==r.state&&(r=new e(this.source,1)),r=r.updateFor(t,i);for(let n of t.effects)if(n.is(cp))r=new e(r.source,1,n.value?sp(t.state):-1);else if(n.is(up))r=new e(r.source,0);else if(n.is(Ep))for(let e of n.value)e.source==r.source&&(r=e);return r}updateFor(e,t){return this.map(e.changes)}map(t){return t.empty||this.explicitPos<0?this:new e(this.source,this.state,t.mapPos(this.explicitPos))}touches(e){return e.changes.touchesRange(sp(e.state))}},_p=class e extends Cp{constructor(e,t,n,i,r){super(e,2,t),this.result=n,this.from=i,this.to=r}hasResult(){return!0}updateFor(t,n){var i;if(!(3&n))return this.map(t.changes);let r=this.result;r.map&&!t.changes.empty&&(r=r.map(r,t.changes));let s=t.changes.mapPos(this.from),o=t.changes.mapPos(this.to,1),a=sp(t.state);if((this.explicitPos<0?a<=s:a<this.from)||a>o||!r||2&n&&sp(t.startState)==this.from)return new Cp(this.source,4&n?1:0);let l=this.explicitPos<0?-1:t.changes.mapPos(this.explicitPos);return function(e,t,n,i){if(!e)return!1;let r=t.sliceDoc(n,i);return"function"==typeof e?e(r,n,i,t):op(e,!0).test(r)}(r.validFor,t.state,s,o)?new e(this.source,l,r,s,o):r.update&&(r=r.update(r,s,o,new ep(t.state,a,l>=0)))?new e(this.source,l,r,r.from,null!==(i=r.to)&&void 0!==i?i:sp(t.state)):new Cp(this.source,1,l)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new e(this.source,this.explicitPos<0?-1:t.mapPos(this.explicitPos),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new Cp(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}};var Ep=Oe.define({map:(e,t)=>e.map((e=>e.map(t)))}),Tp=Oe.define(),Pp=W.define({create:()=>bp.start(),update:(e,t)=>e.update(t),provide:e=>[Us.from(e,(e=>e.tooltip)),Lr.contentAttributes.from(e,(e=>e.attrs))]});function $p(e,t){let n=t.completion.apply||t.completion.label,i=e.state.field(Pp).active.find((e=>e.source==t.source));return i instanceof _p&&("string"==typeof n?e.dispatch(Object.assign(Object.assign({},function(e,t,n,i){let{main:r}=e.selection,s=n-r.from,o=i-r.from;return Object.assign(Object.assign({},e.changeByRange((a=>a!=r&&n!=i&&e.sliceDoc(a.from+s,a.from+o)!=e.sliceDoc(n,i)?{range:a}:{changes:{from:a.from+s,to:i==r.from?a.to:a.from+o,insert:t},range:X.cursor(a.from+s+t.length)}))),{scrollIntoView:!0,userEvent:"input.complete"})}(e.state,n,i.from,i.to)),{annotations:ap.of(t.completion)})):n(e,t.completion,i.from,i.to),!0)}var Np=function(e,t){return n=>new class{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:e=>this.placeInfo(e),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:r,selected:s}=i.open,o=e.state.facet(fp);this.optionContent=function(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(e){let t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map((e=>"cm-completionIcon-"+e))),t.setAttribute("aria-hidden","true"),t},position:20}),t.push({render(e,t,n,i){let r=document.createElement("span");r.className="cm-completionLabel";let s=e.displayLabel||e.label,o=0;for(let e=0;e<i.length;){let t=i[e++],n=i[e++];t>o&&r.appendChild(document.createTextNode(s.slice(o,t)));let a=r.appendChild(document.createElement("span"));a.appendChild(document.createTextNode(s.slice(t,n))),a.className="cm-completionMatchedText",o=n}return o<s.length&&r.appendChild(document.createTextNode(s.slice(o))),r},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort(((e,t)=>e.position-t.position)).map((e=>e.render))}(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=Op(r.length,s,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",(n=>{let{options:i}=e.state.field(t).open;for(let t,r=n.target;r&&r!=this.dom;r=r.parentNode)if("LI"==r.nodeName&&(t=/-(\d+)$/.exec(r.id))&&+t[1]<i.length)return this.applyCompletion(e,i[+t[1]]),void n.preventDefault()})),this.dom.addEventListener("focusout",(t=>{let n=e.state.field(this.stateField,!1);n&&n.tooltip&&e.state.facet(fp).closeOnBlur&&t.relatedTarget!=e.contentDOM&&e.dispatch({effects:up.of(null)})})),this.showOptions(r,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)}))}update(e){var t;let n=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=i){let{options:r,selected:s,disabled:o}=n.open;(!i.open||i.open.options!=r)&&(this.range=Op(r.length,s,e.state.facet(fp).maxRenderedOptions),this.showOptions(r,n.id)),this.updateSel(),o!=(null===(t=i.open)||void 0===t?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let e of this.currentClass.split(" "))e&&this.dom.classList.remove(e);for(let e of t.split(" "))e&&this.dom.classList.add(e);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Op(t.options.length,t.selected,this.view.state.facet(fp).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:i}=n;if(!i)return;let r="string"==typeof i?document.createTextNode(i):i(n);if(!r)return;"then"in r?r.then((t=>{t&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(t,n)})).catch((e=>Wn(this.view.state,e,"completion info"))):this.addInfoPane(r,n)}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",null!=e.nodeType)n.appendChild(e),this.infoDestroy=null;else{let{dom:t,destroy:i}=e;n.appendChild(t),this.infoDestroy=i||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)"LI"==n.nodeName&&n.id?i==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected"):i--;return t&&function(e,t){let n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=n.height/e.offsetHeight;i.top<n.top?e.scrollTop-=(n.top-i.top)/r:i.bottom>n.bottom&&(e.scrollTop+=(i.bottom-n.bottom)/r)}(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),r=this.space;if(!r){let e=this.dom.ownerDocument.defaultView||window;r={left:0,top:0,right:e.innerWidth,bottom:e.innerHeight}}return i.top>Math.min(r.bottom,t.bottom)-10||i.bottom<Math.max(r.top,t.top)+10?null:this.view.state.facet(fp).positionInfo(this.view,t,i,n,r,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){let i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions"));let r=null;for(let s=n.from;s<n.to;s++){let{completion:o,match:a}=e[s],{section:l}=o;if(l){let e="string"==typeof l?l:l.name;e!=r&&(s>n.from||0==n.from)&&(r=e,"string"!=typeof l&&l.header?i.appendChild(l.header(l)):i.appendChild(document.createElement("completion-section")).textContent=e)}let h=i.appendChild(document.createElement("li"));h.id=t+"-"+s,h.setAttribute("role","option");let c=this.optionClass(o);c&&(h.className=c);for(let e of this.optionContent){let t=e(o,this.view.state,this.view,a);t&&h.appendChild(t)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}(n,e,t)}(Pp,$p);function Ip(e,t="option"){return n=>{let i=n.state.field(Pp,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(fp).interactionDelay)return!1;let r,s=1;"page"==t&&(r=js(n,i.open.tooltip))&&(s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,a=i.open.selected>-1?i.open.selected+s*(e?1:-1):e?0:o-1;return a<0?a="page"==t?0:o-1:a>=o&&(a="page"==t?o-1:0),n.dispatch({effects:Tp.of(a)}),!0}}var Qp=Kn.fromClass(class{constructor(e){this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of e.state.field(Pp).active)1==t.state&&this.startQuery(t)}update(e){let t=e.state.field(Pp),n=e.state.facet(fp);if(!e.selectionSet&&!e.docChanged&&e.startState.field(Pp)==t)return;let i=e.transactions.some((e=>{let t=Ap(e,n);return 8&t||(e.selection||e.docChanged)&&!(3&t)}));for(let t=0;t<this.running.length;t++){let n=this.running[t];if(i||n.context.abortOnDocChange&&e.docChanged||n.updates.length+e.transactions.length>50&&Date.now()-n.time>1e3){for(let e of n.context.abortListeners)try{e()}catch(e){Wn(this.view.state,e)}n.context.abortListeners=null,this.running.splice(t--,1)}else n.updates.push(...e.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),e.transactions.some((e=>e.effects.some((e=>e.is(cp)))))&&(this.pendingStart=!0);let r=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=t.active.some((e=>1==e.state&&!this.running.some((t=>t.active.source==e.source))))?setTimeout((()=>this.startUpdate()),r):-1,0!=this.composing)for(let t of e.transactions)t.isUserEvent("input.type")?this.composing=2:2==this.composing&&t.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:e}=this.view,t=e.field(Pp);for(let e of t.active)1==e.state&&!this.running.some((t=>t.active.source==e.source))&&this.startQuery(e)}startQuery(e){let{state:t}=this.view,n=sp(t),i=new ep(t,n,e.explicitPos==n,this.view),r=new class{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}(e,i);this.running.push(r),Promise.resolve(e.source(i)).then((e=>{r.context.aborted||(r.done=e||null,this.scheduleAccept())}),(e=>{this.view.dispatch({effects:up.of(null)}),Wn(this.view.state,e)}))}scheduleAccept(){this.running.every((e=>void 0!==e.done))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((()=>this.accept()),this.view.state.facet(fp).updateSyncTime))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],n=this.view.state.facet(fp);for(let i=0;i<this.running.length;i++){let r=this.running[i];if(void 0===r.done)continue;if(this.running.splice(i--,1),r.done){let i=new _p(r.active.source,r.active.explicitPos,r.done,r.done.from,null!==(e=r.done.to)&&void 0!==e?e:sp(r.updates.length?r.updates[0].startState:this.view.state));for(let e of r.updates)i=i.update(e,n);if(i.hasResult()){t.push(i);continue}}let s=this.view.state.field(Pp).active.find((e=>e.source==r.active.source));if(s&&1==s.state)if(null==r.done){let e=new Cp(r.active.source,0);for(let t of r.updates)e=e.update(t,n);1!=e.state&&t.push(e)}else this.startQuery(s)}t.length&&this.view.dispatch({effects:Ep.of(t)})}},{eventHandlers:{blur(e){let t=this.view.state.field(Pp,!1);if(t&&t.tooltip&&this.view.state.facet(fp).closeOnBlur){let n=t.open&&js(this.view,t.open.tooltip);(!n||!n.dom.contains(e.relatedTarget))&&setTimeout((()=>this.view.dispatch({effects:up.of(null)})),10)}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout((()=>this.view.dispatch({effects:cp.of(!1)})),20),this.composing=0}}}),Rp="object"==typeof navigator&&/Win/.test(navigator.platform),Mp=te.highest(Lr.domEventHandlers({keydown(e,t){let n=t.state.field(Pp,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||e.key.length>1||e.ctrlKey&&(!Rp||!e.altKey)||e.metaKey)return!1;let i=n.open.options[n.open.selected],r=n.active.find((e=>e.source==i.source)),s=i.completion.commitCharacters||r.result.commitCharacters;return s&&s.indexOf(e.key)>-1&&$p(t,i),!1}})),Bp=Lr.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Dp=class{constructor(e,t,n,i){this.field=e,this.line=t,this.from=n,this.to=i}},Xp=class e{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],i=[t],r=e.doc.lineAt(t),s=/^\s*/.exec(r.text)[0];for(let r of this.lines){if(n.length){let n=s,o=/^\t*/.exec(r)[0].length;for(let t=0;t<o;t++)n+=e.facet(zl);i.push(t+n.length-o),r=n+r.slice(o)}n.push(r),t+=r.length+1}let o=this.fieldPositions.map((e=>new class e{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(t){let n=t.mapPos(this.from,-1,T.TrackDel),i=t.mapPos(this.to,1,T.TrackDel);return null==n||null==i?null:new e(this.field,n,i)}}(e.field,i[e.line]+e.from,i[e.line]+e.to)));return{text:n,ranges:o}}static parse(t){let n,i=[],r=[],s=[];for(let e of t.split(/\r\n?|\n/)){for(;n=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(e);){let t=n[1]?+n[1]:null,o=n[2]||n[3]||"",a=-1,l=o.replace(/\\[{}]/g,(e=>e[1]));for(let e=0;e<i.length;e++)(null!=t?i[e].seq==t:l&&i[e].name==l)&&(a=e);if(a<0){let e=0;for(;e<i.length&&(null==t||null!=i[e].seq&&i[e].seq<t);)e++;i.splice(e,0,{seq:t,name:l}),a=e;for(let e of s)e.field>=a&&e.field++}s.push(new Dp(a,r.length,n.index,n.index+l.length)),e=e.slice(0,n.index)+o+e.slice(n.index+n[0].length)}e=e.replace(/\\([{}])/g,((e,t,n)=>{for(let e of s)e.line==r.length&&e.from>n&&(e.from--,e.to--);return t})),r.push(e)}return new e(r,s)}},Fp=hn.widget({widget:new class extends an{toDOM(){let e=document.createElement("span");return e.className="cm-snippetFieldPosition",e}ignoreEvent(){return!1}}}),Lp=hn.mark({class:"cm-snippetField"}),Up=class e{constructor(e,t){this.ranges=e,this.active=t,this.deco=hn.set(e.map((e=>(e.from==e.to?Fp:Lp).range(e.from,e.to))))}map(t){let n=[];for(let e of this.ranges){let i=e.map(t);if(!i)return null;n.push(i)}return new e(n,this.active)}selectionInsideField(e){return e.ranges.every((e=>this.ranges.some((t=>t.field==this.active&&t.from<=e.from&&t.to>=e.to))))}},Vp=Oe.define({map:(e,t)=>e&&e.map(t)}),zp=Oe.define(),Zp=W.define({create:()=>null,update(e,t){for(let n of t.effects){if(n.is(Vp))return n.value;if(n.is(zp)&&e)return new Up(e.ranges,n.value)}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.selectionInsideField(t.selection)&&(e=null),e},provide:e=>Lr.decorations.from(e,(e=>e?e.deco:hn.none))});function jp(e,t){return X.create(e.filter((e=>e.field==t)).map((e=>X.range(e.from,e.to))))}function qp(e){let t=Xp.parse(e);return(e,n,i,r)=>{let{text:s,ranges:o}=t.instantiate(e.state,i),l={changes:{from:i,to:r,insert:a.of(s)},scrollIntoView:!0,annotations:n?[ap.of(n),ye.userEvent.of("input.complete")]:void 0};if(o.length&&(l.selection=jp(o,0)),o.some((e=>e.field>0))){let t=new Up(o,0),n=l.effects=[Vp.of(t)];void 0===e.state.field(Zp,!1)&&n.push(Oe.appendConfig.of([Zp,Yp,Kp,Bp]))}e.dispatch(e.state.update(l))}}function Gp(e){return({state:t,dispatch:n})=>{let i=t.field(Zp,!1);if(!i||e<0&&0==i.active)return!1;let r=i.active+e,s=e>0&&!i.ranges.some((t=>t.field==r+e));return n(t.update({selection:jp(i.ranges,r),effects:Vp.of(s?null:new Up(i.ranges,r)),scrollIntoView:!0})),!0}}var Wp=[{key:"Tab",run:Gp(1),shift:Gp(-1)},{key:"Escape",run:({state:e,dispatch:t})=>!!e.field(Zp,!1)&&(t(e.update({effects:Vp.of(null)})),!0)}],Hp=U.define({combine:e=>e.length?e[0]:Wp}),Yp=te.highest(Wr.compute([Hp],(e=>e.facet(Hp))));function Jp(e,t){return Object.assign(Object.assign({},t),{apply:qp(e)})}var Kp=Lr.domEventHandlers({mousedown(e,t){let n,i=t.state.field(Zp,!1);if(!i||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;let r=i.ranges.find((e=>e.from<=n&&e.to>=n));return!(!r||r.field==i.active)&&(t.dispatch({selection:jp(i.ranges,r.field),effects:Vp.of(i.ranges.some((e=>e.field>r.field))?new Up(i.ranges,r.field):null),scrollIntoView:!0}),!0)}}),ef={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},tf=Oe.define({map:(e,t)=>t.mapPos(e,-1,T.TrackAfter)??void 0}),nf=new class extends $e{};nf.startSide=1,nf.endSide=-1;var rf=W.define({create:()=>Qe.empty,update(e,t){if(e=e.map(t.changes),t.selection){let n=t.state.doc.lineAt(t.selection.main.head);e=e.update({filter:e=>e>=n.from&&e<=n.to})}for(let n of t.effects)n.is(tf)&&(e=e.update({add:[nf.range(n.value,n.value+1)]}));return e}});var sf="()[]{}<>";function of(e){for(let t=0;t<sf.length;t+=2)if(sf.charCodeAt(t)==e)return sf.charAt(t+1);return C(e<128?e:e+1)}function af(e,t){return e.languageDataAt("closeBrackets",t)[0]||ef}var lf="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),hf=Lr.inputHandler.of(((e,t,n,i)=>{if((lf?e.composing:e.compositionStarted)||e.state.readOnly)return!1;let r=e.state.selection.main;if(i.length>2||2==i.length&&1==_(A(i,0))||t!=r.from||n!=r.to)return!1;let s=function(e,t){let n=af(e,e.selection.main.head),i=n.brackets||ef.brackets;for(let r of i){let s=of(A(r,0));if(t==r)return s==r?mf(e,r,i.indexOf(r+r+r)>-1,n):pf(e,r,s,n.before||ef.before);if(t==s&&uf(e,e.selection.main.from))return ff(e,r,s)}return null}(e.state,i);return!!s&&(e.dispatch(s),!0)})),cf=[{key:"Backspace",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=af(e,e.selection.main.head).brackets||ef.brackets,i=null,r=e.changeByRange((t=>{if(t.empty){let i=function(e,t){let n=e.sliceString(t-2,t);return _(A(n,0))==n.length?n:n.slice(1)}(e.doc,t.head);for(let r of n)if(r==i&&df(e.doc,t.head)==of(A(r,0)))return{changes:{from:t.head-r.length,to:t.head+r.length},range:X.cursor(t.head-r.length)}}return{range:i=t}}));return i||t(e.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!i}}];function uf(e,t){let n=!1;return e.field(rf).between(0,e.doc.length,(e=>{e==t&&(n=!0)})),n}function df(e,t){let n=e.sliceString(t,t+2);return n.slice(0,_(A(n,0)))}function pf(e,t,n,i){let r=null,s=e.changeByRange((s=>{if(!s.empty)return{changes:[{insert:t,from:s.from},{insert:n,from:s.to}],effects:tf.of(s.to+t.length),range:X.range(s.anchor+t.length,s.head+t.length)};let o=df(e.doc,s.head);return!o||/\s/.test(o)||i.indexOf(o)>-1?{changes:{insert:t+n,from:s.head},effects:tf.of(s.head+t.length),range:X.cursor(s.head+t.length)}:{range:r=s}}));return r?null:e.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function ff(e,t,n){let i=null,r=e.changeByRange((t=>t.empty&&df(e.doc,t.head)==n?{changes:{from:t.head,to:t.head+n.length,insert:n},range:X.cursor(t.head+n.length)}:i={range:t}));return i?null:e.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function mf(e,t,n,i){let r=i.stringPrefixes||ef.stringPrefixes,s=null,o=e.changeByRange((i=>{if(!i.empty)return{changes:[{insert:t,from:i.from},{insert:t,from:i.to}],effects:tf.of(i.to+t.length),range:X.range(i.anchor+t.length,i.head+t.length)};let o,a=i.head,l=df(e.doc,a);if(l==t){if(gf(e,a))return{changes:{insert:t+t,from:a},effects:tf.of(a+t.length),range:X.cursor(a+t.length)};if(uf(e,a)){let i=n&&e.sliceDoc(a,a+3*t.length)==t+t+t?t+t+t:t;return{changes:{from:a,to:a+i.length,insert:i},range:X.cursor(a+i.length)}}}else{if(n&&e.sliceDoc(a-2*t.length,a)==t+t&&(o=Of(e,a-2*t.length,r))>-1&&gf(e,o))return{changes:{insert:t+t+t+t,from:a},effects:tf.of(a+t.length),range:X.cursor(a+t.length)};if(e.charCategorizer(a)(l)!=Ce.Word&&Of(e,a,r)>-1&&!function(e,t,n,i){let r=Nl(e).resolveInner(t,-1),s=i.reduce(((e,t)=>Math.max(e,t.length)),0);for(let o=0;o<5;o++){let o=e.sliceDoc(r.from,Math.min(r.to,r.from+n.length+s)),a=o.indexOf(n);if(!a||a>-1&&i.indexOf(o.slice(0,a))>-1){let t=r.firstChild;for(;t&&t.from==r.from&&t.to-t.from>n.length+a;){if(e.sliceDoc(t.to-n.length,t.to)==n)return!1;t=t.firstChild}return!0}let l=r.to==t&&r.parent;if(!l)break;r=l}return!1}(e,a,t,r))return{changes:{insert:t+t,from:a},effects:tf.of(a+t.length),range:X.cursor(a+t.length)}}return{range:s=i}}));return s?null:e.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function gf(e,t){let n=Nl(e).resolveInner(t+1);return n.parent&&n.from==t}function Of(e,t,n){let i=e.charCategorizer(t);if(i(e.sliceDoc(t-1,t))!=Ce.Word)return t;for(let r of n){let n=t-r.length;if(e.sliceDoc(n,t)==r&&i(e.sliceDoc(n-1,n))!=Ce.Word)return n}return-1}var yf=[{key:"Ctrl-Space",run:e=>!!e.state.field(Pp,!1)&&(e.dispatch({effects:cp.of(!0)}),!0)},{key:"Escape",run:e=>{let t=e.state.field(Pp,!1);return!(!t||!t.active.some((e=>0!=e.state)))&&(e.dispatch({effects:up.of(null)}),!0)}},{key:"ArrowDown",run:Ip(!0)},{key:"ArrowUp",run:Ip(!1)},{key:"PageDown",run:Ip(!0,"page")},{key:"PageUp",run:Ip(!1,"page")},{key:"Enter",run:e=>{let t=e.state.field(Pp,!1);return!(e.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(fp).interactionDelay)&&$p(e,t.open.options[t.open.selected])}}],vf=te.highest(Wr.computeN([fp],(e=>e.facet(fp).defaultKeymap?[yf]:[]))),bf=class e{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(t,n,i){let r=t,s=i.facet(If).markerFilter;s&&(r=s(r));let o=hn.set(r.map((e=>e.from==e.to||e.from==e.to-1&&i.doc.lineAt(e.from).to==e.from?hn.widget({widget:new Bf(e),diagnostic:e}).range(e.from):hn.mark({attributes:{class:"cm-lintRange cm-lintRange-"+e.severity+(e.markClass?" "+e.markClass:"")},diagnostic:e}).range(e.from,e.to))),!0);return new e(o,n,wf(o))}};function wf(e,t=null,n=0){let i=null;return e.between(n,1e9,((e,n,{spec:r})=>{if(!t||r.diagnostic==t)return i=new class{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}(e,n,r.diagnostic),!1})),i}function xf(e,t){let n=e.startState.doc.lineAt(t.pos);return!(!e.effects.some((e=>e.is(kf)))&&!e.changes.touchesRange(n.from,n.to))}function Sf(e,t){return e.field(_f,!1)?t:t.concat(Oe.appendConfig.of(Yf))}var kf=Oe.define(),Af=Oe.define(),Cf=Oe.define(),_f=W.define({create:()=>new bf(hn.none,null,null),update(e,t){if(t.docChanged){let n=e.diagnostics.map(t.changes),i=null;if(e.selected){let r=t.changes.mapPos(e.selected.from,1);i=wf(n,e.selected.diagnostic,r)||wf(n,null,r)}e=new bf(n,e.panel,i)}for(let n of t.effects)n.is(kf)?e=bf.init(n.value,e.panel,t.state):n.is(Af)?e=new bf(e.diagnostics,n.value?Xf.open:null,e.selected):n.is(Cf)&&(e=new bf(e.diagnostics,e.panel,n.value));return e},provide:e=>[Ks.from(e,(e=>e.panel)),Lr.decorations.from(e,(e=>e.diagnostics))]}),Ef=hn.mark({class:"cm-lintRange cm-lintRange-active"});function Tf(e,t){return Hu("ul",{class:"cm-tooltip-lint"},t.map((t=>Mf(e,t,!1))))}var Pf=e=>{let t=e.state.field(_f,!1);return!(!t||!t.panel)&&(e.dispatch({effects:Af.of(!1)}),!0)},$f=[{key:"Mod-Shift-m",run:e=>{let t=e.state.field(_f,!1);(!t||!t.panel)&&e.dispatch({effects:Sf(e.state,[Af.of(!0)])});let n=Ws(e,Xf.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:e=>{let t=e.state.field(_f,!1);if(!t)return!1;let n=e.state.selection.main,i=t.diagnostics.iter(n.to+1);return!(!i.value&&(i=t.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to))&&(e.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)}}],Nf=Kn.fromClass(class{constructor(e){this.view=e,this.timeout=-1,this.set=!0;let{delay:t}=e.state.facet(If);this.lintTime=Date.now()+t,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,t)}run(){let e=Date.now();if(e<this.lintTime-10)setTimeout(this.run,this.lintTime-e);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(If);Promise.all(t.map((e=>Promise.resolve(e(this.view))))).then((t=>{let n=t.reduce(((e,t)=>e.concat(t)));this.view.state.doc==e.doc&&this.view.dispatch(function(e,t){return{effects:Sf(e,[kf.of(t)])}}(this.view.state,n))}),(e=>{Wn(this.view.state,e)}))}}update(e){let t=e.state.facet(If);(e.docChanged||t!=e.startState.facet(If)||t.needsRefresh&&t.needsRefresh(e))&&(this.lintTime=Date.now()+t.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,t.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),If=U.define({combine:e=>Object.assign({sources:e.map((e=>e.source))},Pe(e.map((e=>e.config)),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))});function Qf(e,t={}){return[If.of({source:e,config:t}),Nf,Yf]}function Rf(e){let t=[];if(e)e:for(let{name:n}of e){for(let e=0;e<n.length;e++){let i=n[e];if(/[a-zA-Z]/.test(i)&&!t.some((e=>e.toLowerCase()==i.toLowerCase()))){t.push(i);continue e}}t.push("")}return t}function Mf(e,t,n){var i;let r=n?Rf(t.actions):[];return Hu("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},Hu("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage():t.message),null===(i=t.actions)||void 0===i?void 0:i.map(((n,i)=>{let s=!1,o=i=>{if(i.preventDefault(),s)return;s=!0;let r=wf(e.state.field(_f).diagnostics,t);r&&n.apply(e,r.from,r.to)},{name:a}=n,l=r[i]?a.indexOf(r[i]):-1,h=l<0?a:[a.slice(0,l),Hu("u",a.slice(l,l+1)),a.slice(l+1)];return Hu("button",{type:"button",class:"cm-diagnosticAction",onclick:o,onmousedown:o,"aria-label":` Action: ${a}${l<0?"":` (access key "${r[i]})"`}.`},h)})),t.source&&Hu("div",{class:"cm-diagnosticSource"},t.source))}var Bf=class extends an{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return Hu("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}},Df=class{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=Mf(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}},Xf=class e{constructor(e){this.view=e,this.items=[];this.list=Hu("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t=>{if(27==t.keyCode)Pf(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65&&t.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:n}=this.items[this.selectedIndex],i=Rf(n.actions);for(let r=0;r<i.length;r++)if(i[r].toUpperCase().charCodeAt(0)==t.keyCode){let t=wf(this.view.state.field(_f).diagnostics,n);t&&n.actions[r].apply(e,t.from,t.to)}}}t.preventDefault()},onclick:e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)}}),this.dom=Hu("div",{class:"cm-panel-lint"},this.list,Hu("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Pf(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(_f).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(_f),n=0,i=!1,r=null;for(e.between(0,this.view.state.doc.length,((e,s,{spec:o})=>{let a,l=-1;for(let e=n;e<this.items.length;e++)if(this.items[e].diagnostic==o.diagnostic){l=e;break}l<0?(a=new Df(this.view,o.diagnostic),this.items.splice(n,0,a),i=!0):(a=this.items[l],l>n&&(this.items.splice(n,l-n),i=!0)),t&&a.diagnostic==t.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),r=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),n++}));n<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();0==this.items.length&&(this.items.push(new Df(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{e.top<t.top?this.list.scrollTop-=t.top-e.top:e.bottom>t.bottom&&(this.list.scrollTop+=e.bottom-t.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=wf(this.view.state.field(_f).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:Cf.of(t)})}static open(t){return new e(t)}};function Ff(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}function Lf(e){return Ff(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}var Uf=Lr.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Lf("#d11")},".cm-lintRange-warning":{backgroundImage:Lf("orange")},".cm-lintRange-info":{backgroundImage:Lf("#999")},".cm-lintRange-hint":{backgroundImage:Lf("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function Vf(e){return"error"==e?4:"warning"==e?3:"info"==e?2:1}var zf=class extends eo{constructor(e){super(),this.diagnostics=e,this.severity=e.reduce(((e,t)=>Vf(e)<Vf(t.severity)?t.severity:e),"hint")}toDOM(e){let t=document.createElement("div");t.className="cm-lint-marker cm-lint-marker-"+this.severity;let n=this.diagnostics,i=e.state.facet(Jf).tooltipFilter;return i&&(n=i(n)),n.length&&(t.onmouseover=()=>function(e,t,n){function i(){let i=e.elementAtHeight(t.getBoundingClientRect().top+5-e.documentTop);e.coordsAtPos(i.from)&&e.dispatch({effects:Gf.of({pos:i.from,above:!1,create:()=>({dom:Tf(e,n),getCoords:()=>t.getBoundingClientRect()})})}),t.onmouseout=t.onmousemove=null,function(e,t){let n=i=>{let r=t.getBoundingClientRect();if(!(i.clientX>r.left-10&&i.clientX<r.right+10&&i.clientY>r.top-10&&i.clientY<r.bottom+10)){for(let e=i.target;e;e=e.parentNode)if(1==e.nodeType&&e.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",n),e.state.field(Wf)&&e.dispatch({effects:Gf.of(null)})}};window.addEventListener("mousemove",n)}(e,t)}let{hoverTime:r}=e.state.facet(Jf),s=setTimeout(i,r);t.onmouseout=()=>{clearTimeout(s),t.onmouseout=t.onmousemove=null},t.onmousemove=()=>{clearTimeout(s),s=setTimeout(i,r)}}(e,t,n)),t}};function Zf(e,t){let n=Object.create(null);for(let i of t){let t=e.lineAt(i.from);(n[t.from]||(n[t.from]=[])).push(i)}let i=[];for(let e in n)i.push(new zf(n[e]).range(+e));return Qe.of(i,!0)}var jf=ro({class:"cm-gutter-lint",markers:e=>e.state.field(qf)}),qf=W.define({create:()=>Qe.empty,update(e,t){e=e.map(t.changes);let n=t.state.facet(Jf).markerFilter;for(let i of t.effects)if(i.is(kf)){let r=i.value;n&&(r=n(r||[])),e=Zf(t.state.doc,r.slice(0))}return e}}),Gf=Oe.define(),Wf=W.define({create:()=>null,update:(e,t)=>(e&&t.docChanged&&(e=xf(t,e)?null:Object.assign(Object.assign({},e),{pos:t.changes.mapPos(e.pos)})),t.effects.reduce(((e,t)=>t.is(Gf)?t.value:e),e)),provide:e=>Us.from(e)}),Hf=Lr.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Ff('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Ff('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Ff('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),Yf=[_f,Lr.decorations.compute([_f],(e=>{let{selected:t,panel:n}=e.field(_f);return t&&n&&t.from!=t.to?hn.set([Ef.range(t.from,t.to)]):hn.none})),function(e,t={}){let n=Oe.define(),i=W.define({create:()=>[],update(e,i){if(e.length&&(t.hideOnChange&&(i.docChanged||i.selection)?e=[]:t.hideOn&&(e=e.filter((e=>!t.hideOn(i,e)))),i.docChanged)){let t=[];for(let n of e){let e=i.changes.mapPos(n.pos,-1,T.TrackDel);if(null!=e){let r=Object.assign(Object.create(null),n);r.pos=e,null!=r.end&&(r.end=i.changes.mapPos(r.end)),t.push(r)}}e=t}for(let t of i.effects)t.is(n)&&(e=t.value),t.is(qs)&&(e=[]);return e},provide:e=>Vs.from(e)});return[i,Kn.define((r=>new class{constructor(e,t,n,i,r){this.view=e,this.source=t,this.field=n,this.setHover=i,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((()=>this.startHover()),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let i,r=1;if(n instanceof Gt)i=n.posAtStart;else{if(i=e.posAtCoords(t),null==i)return;let n=e.coordsAtPos(i);if(!n||t.y<n.top||t.y>n.bottom||t.x<n.left-e.defaultCharacterWidth||t.x>n.right+e.defaultCharacterWidth)return;let s=e.bidiSpans(e.state.doc.lineAt(i)).find((e=>e.from<=i&&e.to>=i)),o=s&&s.dir==yn.RTL?-1:1;r=t.x<n.left?-o:o}let s=this.source(e,i,r);if(s?.then){let t=this.pending={pos:i};s.then((n=>{this.pending==t&&(this.pending=null,n&&(!Array.isArray(n)||n.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(n)?n:[n])}))}),(t=>Wn(e.state,t,"hover tooltip")))}else s&&(!Array.isArray(s)||s.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(s)?s:[s])})}get tooltip(){let e=this.view.plugin(Xs),t=e?e.manager.tooltips.findIndex((e=>e.create==zs.create)):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:r}=this;if(i.length&&r&&!function(e,t){let n=e.getBoundingClientRect();return t.clientX>=n.left-4&&t.clientX<=n.right+4&&t.clientY>=n.top-4&&t.clientY<=n.bottom+4}(r.dom,e)||this.pending){let{pos:r}=i[0]||this.pending,s=null!==(n=null===(t=i[0])||void 0===t?void 0:t.end)&&void 0!==n?n:r;(r==s?this.view.posAtCoords(this.lastMove)!=r:!function(e,t,n,i,r,s){let o=e.scrollDOM.getBoundingClientRect(),a=e.documentTop+e.documentPadding.top+e.contentHeight;if(o.left>i||o.right<i||o.top>r||Math.min(o.bottom,a)<r)return!1;let l=e.posAtCoords({x:i,y:r},!1);return l>=t&&l<=n}(this.view,r,s,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:t}=this;t&&t.dom.contains(e.relatedTarget)?this.watchTooltipLeave(t.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}(r,e,i,n,t.hoverTime||300))),Zs]}((function(e,t,n){let{diagnostics:i}=e.state.field(_f),r=[],s=2e8,o=0;i.between(t-(n<0?1:0),t+(n>0?1:0),((e,i,{spec:a})=>{t>=e&&t<=i&&(e==i||(t>e||n>0)&&(t<i||n<0))&&(r.push(a.diagnostic),s=Math.min(e,s),o=Math.max(i,o))}));let a=e.state.facet(If).tooltipFilter;return a&&(r=a(r)),r.length?{pos:s,end:o,above:e.state.doc.lineAt(s).to<o,create:()=>({dom:Tf(e,r)})}:null}),{hideOn:xf}),Uf],Jf=U.define({combine:e=>Pe(e,{hoverTime:300,markerFilter:null,tooltipFilter:null})});function Kf(e={}){return[Jf.of(e),qf,jf,Hf,Wf]}var em=[function(e={}){return[mo.of(e),oo(),yo]}(),wo,function(e={}){return[ws.of(e),xs||(xs=Kn.fromClass(class{constructor(e){this.view=e,this.decorations=hn.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(ws)),this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new class{constructor(e){let{regexp:t,decoration:n,decorate:i,boundary:r,maxLength:s=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(e,t,n,r)=>i(r,n,n+e[0].length,e,t);else if("function"==typeof n)this.addMatch=(e,t,i,r)=>{let s=n(e,t,i);s&&r(i,i+e[0].length,s)};else{if(!n)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=(e,t,i,r)=>r(i,i+e[0].length,n)}this.boundary=r,this.maxLength=s}createDeco(e){let t=new Re,n=t.add.bind(t);for(let{from:t,to:i}of function(e,t){let n=e.visibleRanges;if(1==n.length&&n[0].from==e.viewport.from&&n[0].to==e.viewport.to)return n;let i=[];for(let{from:r,to:s}of n)r=Math.max(e.state.doc.lineAt(r).from,r-t),s=Math.min(e.state.doc.lineAt(s).to,s+t),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}(e,this.maxLength))gs(e.state.doc,this.regexp,t,i,((t,i)=>this.addMatch(i,e,t,n)));return t.finish()}updateDeco(e,t){let n=1e9,i=-1;return e.docChanged&&e.changes.iterChanges(((t,r,s,o)=>{o>e.view.viewport.from&&s<e.view.viewport.to&&(n=Math.min(s,n),i=Math.max(o,i))})),e.viewportChanged||i-n>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),n,i):t}updateRange(e,t,n,i){for(let r of e.visibleRanges){let s=Math.max(r.from,n),o=Math.min(r.to,i);if(o>s){let n=e.state.doc.lineAt(s),i=n.to<o?e.state.doc.lineAt(o):n,a=Math.max(r.from,n.from),l=Math.min(r.to,i.to);if(this.boundary){for(;s>n.from;s--)if(this.boundary.test(n.text[s-1-n.from])){a=s;break}for(;o<i.to;o++)if(this.boundary.test(i.text[o-i.from])){l=o;break}}let h,c=[],u=(e,t,n)=>c.push(n.range(e,t));if(n==i)for(this.regexp.lastIndex=a-n.from;(h=this.regexp.exec(n.text))&&h.index<l-n.from;)this.addMatch(h,e,h.index+n.from,u);else gs(e.state.doc,this.regexp,a,l,((t,n)=>this.addMatch(n,e,t,u)));t=t.update({filterFrom:a,filterTo:l,filter:(e,t)=>e<a||t>l,add:c})}}return t}}({regexp:e.specialChars,decoration:(t,n,i)=>{let{doc:r}=n.state,s=A(t[0],0);if(9==s){let e=r.lineAt(i),t=n.state.tabSize,s=je(e.text,t,i-e.from);return hn.replace({widget:new ks((t-s%t)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=hn.replace({widget:new Ss(e,s)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(ws);e.startState.facet(ws)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))]}(),function(e={}){return[Nc,$c.of(e),Lr.domEventHandlers({beforeinput(e,t){let n="historyUndo"==e.inputType?Qc:"historyRedo"==e.inputType?Rc:null;return!!n&&(e.preventDefault(),n(t))}})]}(),function(e={}){let t=Object.assign(Object.assign({},kh),e),n=new Ah(t,!0),i=new Ah(t,!1),r=Kn.fromClass(class{constructor(e){this.from=e.viewport.from,this.markers=this.buildMarkers(e)}update(e){(e.docChanged||e.viewportChanged||e.startState.facet(Fl)!=e.state.facet(Fl)||e.startState.field(dh,!1)!=e.state.field(dh,!1)||Nl(e.startState)!=Nl(e.state)||t.foldingChanged(e))&&(this.markers=this.buildMarkers(e.view))}buildMarkers(e){let t=new Re;for(let r of e.viewportLineBlocks){let s=ph(e.state,r.from,r.to)?i:ah(e.state,r.from,r.to)?n:null;s&&t.add(r.from,r.from,s)}return t.finish()}}),{domEventHandlers:s}=t;return[r,ro({class:"cm-foldGutter",markers(e){var t;return(null===(t=e.plugin(r))||void 0===t?void 0:t.markers)||Qe.empty},initialSpacer:()=>new Ah(t,!1),domEventHandlers:Object.assign(Object.assign({},s),{click:(e,t,n)=>{if(s.click&&s.click(e,t,n))return!0;let i=ph(e.state,t.from,t.to);if(i)return e.dispatch({effects:ch.of(i)}),!0;let r=ah(e.state,t.from,t.to);return!!r&&(e.dispatch({effects:hh.of(r)}),!0)}})}),bh()]}(),function(e={}){return[os.of(e),ls,cs,ds,Zn.of(!0)]}(),[fs,ms],Te.allowMultipleSelections.of(!0),Te.transactionFilter.of((e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let n=e.newDoc,{head:i}=e.newSelection.main,r=n.lineAt(i);if(i>r.from+200)return e;let s=n.sliceString(r.from,i);if(!t.some((e=>e.test(s))))return e;let{state:o}=e,a=-1,l=[];for(let{head:e}of o.selection.ranges){let t=o.doc.lineAt(e);if(t.from==a)continue;a=t.from;let n=ql(o,t.from);if(null==n)continue;let i=/^\s*/.exec(t.text)[0],r=jl(o,n);i!=r&&l.push({from:t.from,to:t.from+i.length,insert:r})}return l.length?[e,{changes:l,sequential:!0}]:e})),$h(Ih,{fallback:!0}),function(e={}){return[Mh.of(e),Lh]}(),[hf,rf],function(e={}){return[Mp,Pp,fp.of(e),Qp,vf,Bp]}(),function(e){let t=e?.eventFilter||(e=>e.altKey&&0==e.button);return Lr.mouseSelectionStyle.of(((e,n)=>t(n)?$s(e,n):null))}(),function(e={}){let[t,n]=Ns[e.key||"Alt"],i=Kn.fromClass(class{constructor(e){this.view=e,this.isDown=!1}set(e){this.isDown!=e&&(this.isDown=e,this.view.update([]))}},{eventObservers:{keydown(e){this.set(e.keyCode==t||n(e))},keyup(e){(e.keyCode==t||!n(e))&&this.set(!1)},mousemove(e){this.set(n(e))}}});return[i,Lr.contentAttributes.of((e=>{var t;return null!==(t=e.plugin(i))&&void 0!==t&&t.isDown?Is:null}))]}(),Cs,function(e){let t=[Od,gd];return e&&t.push(dd.of(e)),t}(),Wr.of([...cf,...Gu,...qd,...Gc,...Oh,...yf,...$f])],tm="#e06c75",nm="#abb2bf",im="#7d8799",rm="#d19a66",sm="#2c313a",om="#282c34",am="#353a42",lm="#528bff",hm=Lr.theme({"&":{color:nm,backgroundColor:om},".cm-content":{caretColor:lm},".cm-cursor, .cm-dropCursor":{borderLeftColor:lm},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#3E4451"},".cm-panels":{backgroundColor:"#21252b",color:nm},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:om,color:im,border:"none"},".cm-activeLineGutter":{backgroundColor:sm},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:am},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:am,borderBottomColor:am},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:sm,color:nm}}},{dark:!0});function cm(){return cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},cm.apply(this,arguments)}_h.define([{tag:hl.keyword,color:"#c678dd"},{tag:[hl.name,hl.deleted,hl.character,hl.propertyName,hl.macroName],color:tm},{tag:[hl.function(hl.variableName),hl.labelName],color:"#61afef"},{tag:[hl.color,hl.constant(hl.name),hl.standard(hl.name)],color:rm},{tag:[hl.definition(hl.name),hl.separator],color:nm},{tag:[hl.typeName,hl.className,hl.number,hl.changed,hl.annotation,hl.modifier,hl.self,hl.namespace],color:"#e5c07b"},{tag:[hl.operator,hl.operatorKeyword,hl.url,hl.escape,hl.regexp,hl.link,hl.special(hl.string)],color:"#56b6c2"},{tag:[hl.meta,hl.comment],color:im},{tag:hl.strong,fontWeight:"bold"},{tag:hl.emphasis,fontStyle:"italic"},{tag:hl.strikethrough,textDecoration:"line-through"},{tag:hl.link,color:im,textDecoration:"underline"},{tag:hl.heading,fontWeight:"bold",color:tm},{tag:[hl.atom,hl.bool,hl.special(hl.variableName)],color:rm},{tag:[hl.processingInstruction,hl.string,hl.inserted],color:"#98c379"},{tag:hl.invalid,color:"#ffffff"}]);var um=e=>{var{theme:t,settings:n={},styles:i=[]}=e,r={".cm-gutters":{}},s={};n.background&&(s.backgroundColor=n.background),n.backgroundImage&&(s.backgroundImage=n.backgroundImage),n.foreground&&(s.color=n.foreground),n.fontSize&&(s.fontSize=n.fontSize),(n.background||n.foreground)&&(r["&"]=s),n.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:n.fontFamily}),n.gutterBackground&&(r[".cm-gutters"].backgroundColor=n.gutterBackground),n.gutterForeground&&(r[".cm-gutters"].color=n.gutterForeground),n.gutterBorder&&(r[".cm-gutters"].borderRightColor=n.gutterBorder),n.caret&&(r[".cm-content"]={caretColor:n.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:n.caret});var o={};return n.gutterActiveForeground&&(o.color=n.gutterActiveForeground),n.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:n.lineHighlight},o.backgroundColor=n.lineHighlight),r[".cm-activeLineGutter"]=o,n.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:n.selection+" !important"}),n.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:n.selectionMatch}),[Lr.theme(r,{dark:"dark"===t}),$h(_h.define(i))]},dm={background:"#2e3235",foreground:"#bdbdbd",caret:"#a0a4ae",selection:"#d7d4f063",selectionMatch:"#d7d4f063",gutterBackground:"#2e3235",gutterForeground:"#999",gutterActiveForeground:"#4f5b66",lineHighlight:"#545b6130"},pm=[{tag:hl.keyword,color:"#cf6edf"},{tag:[hl.name,hl.deleted,hl.character,hl.macroName],color:"#56c8d8"},{tag:[hl.propertyName],color:"#facf4e"},{tag:[hl.variableName],color:"#bdbdbd"},{tag:[hl.function(hl.variableName)],color:"#56c8d8"},{tag:[hl.labelName],color:"#cf6edf"},{tag:[hl.color,hl.constant(hl.name),hl.standard(hl.name)],color:"#facf4e"},{tag:[hl.definition(hl.name),hl.separator],color:"#fa5788"},{tag:[hl.brace],color:"#cf6edf"},{tag:[hl.annotation],color:"#ff5f52"},{tag:[hl.number,hl.changed,hl.annotation,hl.modifier,hl.self,hl.namespace],color:"#ffad42"},{tag:[hl.typeName,hl.className],color:"#ffad42"},{tag:[hl.operator,hl.operatorKeyword],color:"#7186f0"},{tag:[hl.tagName],color:"#99d066"},{tag:[hl.squareBracket],color:"#ff5f52"},{tag:[hl.angleBracket],color:"#606f7a"},{tag:[hl.attributeName],color:"#bdbdbd"},{tag:[hl.regexp],color:"#ff5f52"},{tag:[hl.quote],color:"#6abf69"},{tag:[hl.string],color:"#99d066"},{tag:hl.link,color:"#56c8d8",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[hl.url,hl.escape,hl.special(hl.string)],color:"#facf4e"},{tag:[hl.meta],color:"#707d8b"},{tag:[hl.comment],color:"#707d8b",fontStyle:"italic"},{tag:hl.monospace,color:"#bdbdbd"},{tag:hl.strong,fontWeight:"bold",color:"#ff5f52"},{tag:hl.emphasis,fontStyle:"italic",color:"#99d066"},{tag:hl.strikethrough,textDecoration:"line-through"},{tag:hl.heading,fontWeight:"bold",color:"#facf4e"},{tag:hl.heading1,fontWeight:"bold",color:"#facf4e"},{tag:[hl.heading2,hl.heading3,hl.heading4],fontWeight:"bold",color:"#facf4e"},{tag:[hl.heading5,hl.heading6],color:"#facf4e"},{tag:[hl.atom,hl.bool,hl.special(hl.variableName)],color:"#56c8d8"},{tag:[hl.processingInstruction,hl.inserted],color:"#ff5f52"},{tag:[hl.contentSeparator],color:"#56c8d8"},{tag:hl.invalid,color:"#606f7a",borderBottom:"1px dotted #ff5f52"}],fm=e=>{var{theme:t="dark",settings:n={},styles:i=[]}=e||{};return um({theme:t,settings:cm({},dm,n),styles:[...pm,...i]})},mm=fm();fm();var gm={background:"#FAFAFA",foreground:"#90A4AE",caret:"#272727",selection:"#80CBC440",selectionMatch:"#80CBC440",gutterBackground:"#FAFAFA",gutterForeground:"#90A4AE",gutterBorder:"transparent",lineHighlight:"#CCD7DA50"},Om=[{tag:hl.keyword,color:"#39ADB5"},{tag:[hl.name,hl.deleted,hl.character,hl.macroName],color:"#90A4AE"},{tag:[hl.propertyName],color:"#6182B8"},{tag:[hl.processingInstruction,hl.string,hl.inserted,hl.special(hl.string)],color:"#91B859"},{tag:[hl.function(hl.variableName),hl.labelName],color:"#6182B8"},{tag:[hl.color,hl.constant(hl.name),hl.standard(hl.name)],color:"#39ADB5"},{tag:[hl.definition(hl.name),hl.separator],color:"#90A4AE"},{tag:[hl.className],color:"#E2931D"},{tag:[hl.number,hl.changed,hl.annotation,hl.modifier,hl.self,hl.namespace],color:"#F76D47"},{tag:[hl.typeName],color:"#E2931D",fontStyle:"#E2931D"},{tag:[hl.operator,hl.operatorKeyword],color:"#39ADB5"},{tag:[hl.url,hl.escape,hl.regexp,hl.link],color:"#91B859"},{tag:[hl.meta,hl.comment],color:"#90A4AE"},{tag:hl.strong,fontWeight:"bold"},{tag:hl.emphasis,fontStyle:"italic"},{tag:hl.link,textDecoration:"underline"},{tag:hl.heading,fontWeight:"bold",color:"#39ADB5"},{tag:[hl.atom,hl.bool,hl.special(hl.variableName)],color:"#90A4AE"},{tag:hl.invalid,color:"#E5393570"},{tag:hl.strikethrough,textDecoration:"line-through"}],ym=(e=>{var{theme:t="light",settings:n={},styles:i=[]}=e||{};return um({theme:t,settings:cm({},gm,n),styles:[...Om,...i]})})(),vm="#002B36",bm="#839496",wm="#004454AA",xm="#859900",Sm="#268BD2",km="#268BD2",Am="#2AA198",Cm="#CB4B16",_m="#859900",Em="#268BD2",Tm="#D33682",Pm="#586E75",$m="#268BD2",Nm="#DC322F",Im="#DC322F",Qm="#268BD2",Rm={background:vm,foreground:bm,caret:"#D30102",selection:wm,selectionMatch:wm,gutterBackground:vm,gutterForeground:bm,gutterBorder:"transparent",lineHighlight:"#00cafe11"},Mm=[{tag:hl.keyword,color:xm},{tag:[hl.name,hl.deleted,hl.character,hl.macroName],color:Sm},{tag:[hl.propertyName],color:km},{tag:[hl.processingInstruction,hl.string,hl.inserted,hl.special(hl.string)],color:Am},{tag:[hl.function(hl.variableName),hl.labelName],color:km},{tag:[hl.color,hl.constant(hl.name),hl.standard(hl.name)],color:Cm},{tag:[hl.definition(hl.name),hl.separator],color:Sm},{tag:[hl.className],color:Em},{tag:[hl.number,hl.changed,hl.annotation,hl.modifier,hl.self,hl.namespace],color:Tm},{tag:[hl.typeName],color:_m,fontStyle:_m},{tag:[hl.operator,hl.operatorKeyword],color:xm},{tag:[hl.url,hl.escape,hl.regexp,hl.link],color:Im},{tag:[hl.meta,hl.comment],color:Pm},{tag:hl.tagName,color:Qm},{tag:hl.strong,fontWeight:"bold"},{tag:hl.emphasis,fontStyle:"italic"},{tag:hl.link,textDecoration:"underline"},{tag:hl.heading,fontWeight:"bold",color:$m},{tag:[hl.atom,hl.bool,hl.special(hl.variableName)],color:Sm},{tag:hl.invalid,color:Nm},{tag:hl.strikethrough,textDecoration:"line-through"}],Bm=(e=>{var{theme:t="dark",settings:n={},styles:i=[]}=e||{};return um({theme:t,settings:cm({},Rm,n),styles:[...Mm,...i]})})(),Dm="#FDF6E3",Xm="#657B83",Fm="#859900",Lm="#268BD2",Um="#268BD2",Vm="#2AA198",zm="#CB4B16",Zm="#859900",jm="#268BD2",qm="#D33682",Gm="#93A1A1",Wm="#268BD2",Hm="#DC322F",Ym="#DC322F",Jm="#268BD2",Km={background:Dm,foreground:Xm,caret:"#657B83",selection:"#EEE8D5",selectionMatch:"#EEE8D5",gutterBackground:Dm,gutterForeground:Xm,gutterBorder:"transparent",lineHighlight:"#3d392d11"},eg=[{tag:hl.keyword,color:Fm},{tag:[hl.name,hl.deleted,hl.character,hl.macroName],color:Lm},{tag:[hl.propertyName],color:Um},{tag:[hl.processingInstruction,hl.string,hl.inserted,hl.special(hl.string)],color:Vm},{tag:[hl.function(hl.variableName),hl.labelName],color:Um},{tag:[hl.color,hl.constant(hl.name),hl.standard(hl.name)],color:zm},{tag:[hl.definition(hl.name),hl.separator],color:Lm},{tag:[hl.className],color:jm},{tag:[hl.number,hl.changed,hl.annotation,hl.modifier,hl.self,hl.namespace],color:qm},{tag:[hl.typeName],color:Zm,fontStyle:Zm},{tag:[hl.operator,hl.operatorKeyword],color:Fm},{tag:[hl.url,hl.escape,hl.regexp,hl.link],color:Ym},{tag:[hl.meta,hl.comment],color:Gm},{tag:hl.tagName,color:Jm},{tag:hl.strong,fontWeight:"bold"},{tag:hl.emphasis,fontStyle:"italic"},{tag:hl.link,textDecoration:"underline"},{tag:hl.heading,fontWeight:"bold",color:Wm},{tag:[hl.atom,hl.bool,hl.special(hl.variableName)],color:Lm},{tag:hl.invalid,color:Hm},{tag:hl.strikethrough,textDecoration:"line-through"}],tg=(e=>{var{theme:t="light",settings:n={},styles:i=[]}=e||{};return um({theme:t,settings:cm({},Km,n),styles:[...eg,...i]})})();var ng=(e=>(e.xml="xml",e.html="html",e.leiden_plus="leiden_plus",e.edcs="edcs",e.phi="phi",e.default="default",e.xquery="xquery",e.css="css",e.tex="tex",e.markdown="markdown",e.json="json",e))(ng||{}),ig=(e,t)=>n=>(n.dispatch(n.state.changeByRange((n=>({changes:[{from:n.from,insert:e},{from:n.to,insert:t}],range:X.range(n.from+e.length,n.to+e.length)})))),!0),rg=e=>t=>(e=e.replace(/\$\|([^|]+)\|/g,"${$1}"),t.state.selection.ranges.forEach((n=>{let i=t.state.doc.slice(n.from,n.to);qp(e=i.length>0?e.replace(/\${(?:\d+:)?_}/,i.toString()):e.replace(/\${(\d+:)?_}/,"${$1}"))(t,{label:""},n.from,n.to)})),!0);function sg(e,t,n){if(t.create){let e=n.dataset.params;if(e){let n;try{n=JSON.parse(e)}catch{n=[e]}return Array.isArray(n)&&n.length===t.create.length?t.create.apply(null,n):null}}return t}var og={snippet:{create:e=>rg(e)}},ag=class{constructor(e,t=[],n=og){this.threshold=300,this._status=null,this.editor=e,this.commands=n,this.keymap=[],t&&t.forEach((e=>{let t=e.dataset.command,i=n[t];if(i){let t=e.getAttribute("data-key");if(t&&t.length>0){let n=sg(0,i,e);if(n){let e={key:t,run:n};this.keymap.push(e)}}}}))}async getConfig(){let e=this,t=null,n=Kn.fromClass(class{update(n){n.docChanged&&(t&&clearTimeout(t),t=setTimeout((()=>{let t=Nl(n.state),i=n.state.doc.toJSON(),r=e.onUpdate(t,i.join("\n"));try{let t=e.serialize();null!=t&&(e.editor._value=t,e.editor.emitUpdateEvent(r))}catch{}}),e.threshold))}}),i=await this.getExtensions(this.editor),r=[em,Lr.lineWrapping,Wr.of([Wu,...this.keymap]),Es(this.editor.placeholder),...i,n,Ks.of((e=>(this._status=document.createElement("div"),this._status.className="status",this._status.part="status",{dom:this._status})))];if(this.editor&&this.editor.theme){let e=function(e){switch(e){case"dark":return hm;case"material-dark":return mm;case"material-light":return ym;case"solarized-dark":return Bm;case"solarized-light":return tg;default:return null}}(this.editor.theme);e&&r.push(e)}return{extensions:r}}getCommands(){return this.commands}onUpdate(e,t){return t}setFromValue(e){if(!e)return"";if(e instanceof Node||e instanceof NodeList){let t=new XMLSerializer;if(e instanceof NodeList){let n=[];for(let i=0;i<e.length;i++)n.push(t.serializeToString(e[i]));return n.join("")}return t.serializeToString(e)}return"string"==typeof e?e:JSON.stringify(e)}set status(e){this._status&&(this._status.innerHTML=e)}},lg=((o,a,l)=>(l=null!=o?e(r(o)):{},((e,r,o,a)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let l of i(r))!s.call(e,l)&&l!==o&&t(e,l,{get:()=>r[l],enumerable:!(a=n(r,l))||a.enumerable});return e})(!a&&o&&o.__esModule?l:t(l,"default",{value:o,enumerable:!0}),o)))(o(),1);var hg=class extends HTMLElement{constructor(){super(),this._value=null,this.attachShadow({mode:"open"})}static get observedAttributes(){return["value"]}get value(){return this._value}set value(e){this._value=e,e&&e.length>0?fetch(`https://api.zotero.org/groups/${this.group}/items?tag=${this._value}&format=bib&amp;style=digital-humanities-im-deutschsprachigen-raum`).then((e=>{if(e.ok)return e.text()})).then((t=>{let n={label:t,tag:this._value};this._select.addOption(n),this._select.clear(!0),this._select.sync(),this._select.setValue(e,!1),this._select.sync(),this.setAttribute("value",e)})):this.setAttribute("value",e)}connectedCallback(){this.importTheme("default"),this.group=this.getAttribute("group");let e=document.createElement("slot");this.shadowRoot?.appendChild(e);let t=this.querySelector("input,select");t||(t=document.createElement("input"),t.setAttribute("autocomplete","off"),this.appendChild(t));let n=document.createElement("div");n.className="jinn-zotero-picker-output",this.shadowRoot?.appendChild(n);let i=0,r={load:(e,t)=>{if(e.length<4)return[];fetch(`https://api.zotero.org/groups/${this.group}/items?q=${e}&sort=title&include=data,bib`).then((e=>{if(e.ok)return i=parseInt(e.headers.get("Total-Results")||"0"),e.json()})).then((e=>{this._select?.clearOptions();let n=[];i>25&&n.push({label:`${i} matching entries. Showing first 25.`,tag:"note",disabled:!0}),e.forEach(((e,t)=>{if(e.data.tags){let i={label:e.bib};e.data.tags.length>0?i.tag=e.data.tags[0].tag:(i.tag=`item-${t}`,i.disabled=!0),n.push(i)}})),t(n)})).catch((()=>{t()}))},placeholder:"Zotero search",valueField:"tag",closeAfterSelect:!0,searchField:[],create:!1,maxItems:1,loadThrottle:500,render:{option:e=>`<div>${e.label}</div>`,item:e=>`<div>${e.tag}</div>`},onChange:e=>{let t=this._select.getOption(e,!0);t&&(n.innerHTML=t.innerHTML),this._value!==e&&(this._value=e,this.setAttribute("value",this._value),this._select.clearOptions(),this.dispatchEvent(new CustomEvent("change",{detail:this._value})))}};this._select=new lg.default(t,r),this.value=this.getAttribute("value")}attributeChangedCallback(e,t,n){!t||t===n||"value"===e&&(this.value=n)}importTheme(e){let t=this.getRootNode();if(t.getElementById("__jinn-zotero-picker-css"))return;let n=function(e){let t=document.querySelector("script[src*=jinn-codemirror]");return t?new URL(e,t.src).href:new URL(e,window.location.href).href}("../css"),i=document.createElement("link");i.id="__jinn-zotero-picker-css",i.href=`${n}/tom-select.${e}.min.css`,i.rel="stylesheet",t.nodeType===Node.DOCUMENT_NODE?document.head.appendChild(i):t.appendChild(i)}};window.customElements.define("jinn-zotero-picker",hg);var cg=null,ug=Oe.define(),dg=W.define({create:()=>!1,update(e,t){for(let n of t.effects)n.is(ug)&&(e=n.value);return e},provide:e=>Ks.from(e,(e=>e?pg:null))});function pg(e){let t=document.createElement("div");t.className="cm-input-panel";let n=document.createElement("jinn-zotero-picker");return cg&&n.setAttribute("group",cg),n.placeholder="Zotero reference",n.addEventListener("change",(t=>{e.dispatch({effects:ug.of(!1)}),t.detail&&ig(`<ref key="${t.detail}">`,"</ref>")(e),e.focus()})),t.appendChild(n),{top:!1,dom:t,mount:()=>setTimeout((()=>n.focus()),50)}}var fg=Lr.baseTheme({".cm-input-panel":{padding:"5px 10px",display:"block"},".cm-input-panel jinn-zotero-picker":{width:"100%",height:"auto"}});var mg=Oe.define(),gg=W.define({create:()=>!1,update(e,t){for(let n of t.effects)n.is(mg)&&(e=n.value);return e},provide:e=>Ks.from(e,(e=>e?Og:null))});function Og(e){let t=document.createElement("div");t.className="cm-input-panel";let n=document.createElement("input");return n.type="text",n.placeholder="Name of element (enter to confirm, esc to abort)",n.addEventListener("keyup",(t=>{switch(t.key){case"Enter":t.preventDefault();let i=n.value;""!==i&&(ig(`<${i}>`,`</${i}>`)(e),e.focus());case"Esc":case"Escape":e.dispatch({effects:mg.of(!1)})}})),t.appendChild(n),{top:!1,dom:t,mount:()=>setTimeout((()=>n.focus()),50)}}var yg=Lr.baseTheme({".cm-input-panel":{padding:"5px 10px",fontFamily:"monospace"},".cm-input-panel input":{width:"100%"}});function vg(){return[gg,yg]}var bg={selectElement:e=>(e.dispatch(e.state.changeByRange((t=>{let n=null;for(let i=Nl(e.state).resolveInner(t.from);!n&&i.parent;i=i.parent)"Element"==i.name&&(n=i);return n?{selection:X.range(n.from,n.to),range:X.range(n.from,n.to)}:{range:t}}))),!0),removeEnclosing:e=>(e.dispatch(e.state.changeByRange((t=>{let n=null;for(let i=Nl(e.state).resolveInner(t.from);!n&&i.parent;i=i.parent)"Element"==i.name&&(n=i);if(n){let e=n.firstChild,t=n.lastChild;if(e&&t)return"SelfClosingTag"===e.name?{range:X.range(e.from,e.from),changes:[{from:e.from,to:e.to,insert:""}]}:{range:X.range(e.from,t.from-(e.to-e.from)),changes:[{from:e.from,to:e.to,insert:""},{from:t.from,to:t.to,insert:""}]}}return{range:t}}))),!0),encloseWith:e=>(e.dispatch({effects:mg.of(!e.state.field(gg))}),!0),snippet:{create:e=>rg(e)},zotero:{create:e=>(e=>t=>(cg=e,t.dispatch({effects:ug.of(!t.state.field(dg))}),!0))(e)}},wg=e=>e.filter((e=>"info"!==e.severity)),xg=e=>({name:"Fix",apply:(t,n,i)=>{let r=t.state.update({changes:{from:n,to:i,insert:e}});t.dispatch(r)}}),Sg=(e,t)=>n=>{function i(t){e.valid=t,e.dispatchEvent(new CustomEvent(t?"valid":"invalid",{detail:r,composed:!0,bubbles:!0}))}let r=[];if(0===n.state.doc.length)return i(!0),r;let s=Nl(n.state),o=!1,a=[];return s.iterate({enter:e=>{if(e.type.isError&&r.push({message:"Syntax error",severity:"error",from:e.from,to:e.to}),"StartTag"===e.type.name)e.nextSibling(),a.push(n.state.sliceDoc(e.from,e.to));else if("StartCloseTag"===e.type.name){e.nextSibling();let t=n.state.sliceDoc(e.from,e.to),i=a.pop();t!==i&&r.push({message:`Expected closing tag for ${i}`,severity:"error",from:e.from,to:e.to})}else if("SelfCloseEndTag"===e.type.name)a.pop();else if(((e,t)=>"AttributeName"===t.type.name&&"xmlns"===e.state.sliceDoc(t.from,t.to))(n,e)){o=!0,e.nextSibling(),e.nextSibling();let i=n.state.sliceDoc(e.from+1,e.to-1);t&&i!==t&&r.push({message:"Wrong Namespace",severity:"error",from:e.from+1,to:e.to-1,actions:[xg(t)]})}else((e,t)=>"Comment"===t.type.name&&/\<\!\-\- Error\:([^ ])* \-\-\>/.test(e.state.sliceDoc(t.from,t.to)))(n,e)&&r.push({message:"Syntax error in source input",severity:"warning",from:e.from,to:e.to})},leave:e=>{"Document"===e.type.name&&t&&!o&&r.push({message:"Missing TEI namespace",severity:"error",from:e.from,to:e.to}),e.type.isError&&r.push({message:"Syntax error in input",severity:"error",from:e.from,to:e.to})}}),i(0===r.length),r},kg=(e,t,n,i)=>{let r=e.state.update({changes:{from:n,to:i,insert:`${t.label}=""`},selection:{anchor:n+t.label.length+2}});e.dispatch(r)},Ag=class extends ag{constructor(e,t=[],n=null,i=!1,r=!1){super(e,t,bg),this.namespace=n,this.checkNamespace=i,this.unwrap=r}getDefaultExtensions(){return[vg(),[dg,fg],Qf(Sg(this.editor,this.checkNamespace?this.namespace:null),{delay:300,markerFilter:wg}),Kf({markerFilter:wg})]}async getExtensions(){let e=this.editor.schema;if(e){let t=await this.loadSchema(e);return this.getDefaultExtensions().concat(vc(t))}return this.getDefaultExtensions().concat(vc())}async loadSchema(e){let t=await fetch(e).then((e=>e.json())),n=t.elements,i=this.editor.schemaRoot;if(i){let e=t.elements.find((e=>e.name===i));if(e){let i=new Map,r=new Map;t.elements.forEach((e=>r.set(e.name,e))),this.filterSchema(e,r,i),n=Array.from(i.values())}}return this.extendSchema(n),{elements:n}}filterSchema(e,t,n,i=0){e.children.forEach((e=>{let r=n.get(e);if(r)return void(r.top=0===i);let s=t.get(e);s&&(s.top=0===i,n.set(e,s),this.filterSchema(s,t,n,i+1))}))}extendSchema(e){e.forEach((e=>{e.completion.type="keyword",e.attributes.forEach((e=>{e.completion.type="property",e.completion.apply=kg}))}))}serialize(){let e=new DOMParser,t=this.unwrap?`<R xmlns="${this.namespace||""}">${this.editor.content}</R>`:this.editor.content,n=e.parseFromString(t,"application/xml");return n.getElementsByTagName("parsererror").length?null:this.unwrap?n.firstElementChild?.childNodes:n.firstElementChild}},Cg="() <>|?=.0123456789[]",_g=new Sa((e=>{let t="";for(;!(e.next<0);){if(46===e.next&&"lost"===t)return e.advance(),void e.acceptToken(34);let n=String.fromCharCode(e.next);if("~"===n&&"|"===String.fromCharCode(e.peek(1))||Cg.indexOf(n)>-1||803===e.peek(1))break;t+=n,e.advance()}t.length>0&&e.acceptToken(33)})),Eg=new Sa((e=>{let t=0;for(;!(e.next<0||Cg.indexOf(String.fromCharCode(e.next))>-1)&&803===e.peek(1);)t++,e.advance(2);t>0&&e.acceptToken(1)})),Tg=Ra.deserialize({version:14,states:"(vOQOVOOOQOVO'#C_OQOVO'#C`OQOVO'#CaO!nOWO'#CbOQOVO'#CiO!yOVO'#CnO!yOVO'#CoO!yOVO'#CpOOOR'#Cr'#CrO$ZOSO'#CsO!yOVO'#CtOOOR'#D_'#D_OOOR'#Cu'#CuO$`OSO'#CwO!yOVO'#CyO!yOVO'#CyOOOR'#Ch'#ChOOOR'#DP'#DPOOOR'#Cz'#CzQQOVOOO$hOVO,58yO$oOVO,58zO$vOVO,58{OQOVO,58|OQOVO,59OOQOVO,59QO$}OVO,59TOOOR'#C{'#C{O%UOVO,59YO%]OVO,59ZO%dOVO,59[O%nOSO,59_O%sOVO,59`O%}OSO,59cO&SOVO,59eO&ZOcO,59eOOOR-E6x-E6xOOOR1G.e1G.eOOOR1G.f1G.fOOOR1G.g1G.gO&bOVO1G.hO&iOVO1G.jO&pOVO1G.lOOOR1G.o1G.oOOOR-E6y-E6yOOOR1G.t1G.tOOOR1G.u1G.uOOOR1G.v1G.vO&wOSO1G.vOOOR1G.y1G.yOOOR1G.z1G.zO&|OSO1G.zOOOR1G.}1G.}OOOR1G/P1G/POOOR7+$S7+$SOOOR7+$U7+$UOOOR7+$W7+$WOOOR7+$b7+$bOOOR7+$f7+$f",stateData:"'[~OPaO_aO`aOaaOj]OlaOq]Or^OtPOvQOxROySOzTO{UO}VO!PWO!SXO!TYO!VZO!W]O!X]O!Y]O![_O!^`O~OVhOXiOZjO~OPaO_aO`aOaaOj]OlaOq]Or^OzTO{UO}VO!PWO!SXO!TYO!VZO!W]O!X]O!Y]O![_O!^`O~OapO~OarOjrO~OuvO~PQOwwO~PQOwxO~PQO^|O~PQO|!OO~P!yO!O!PO~P!yOe!RO!Q!QO~P!yO!U!SO~Oe!UO!U!TO~P!yO!Z!VO~O!]!WO~P!yO!_!WO~P!yOw!XO~PQOw!YO~PQOw!ZO~PQO!Q![O~O!U!]O~Ol!WXZ_`aZ~",goto:"&X!SPPP!T!T!T!TP!TP!TP!g#XPPPP#X#X#XP#w#w#w#XP#XP#X$g%ZPPP%uPPPPPPPPPPPPP#XqbOPQRTdefghijkyz{pbOPQRTdefghijkyz{ilUVWZ_`mnoqst!ZaOPQRTUVWZ_`defghijkmnoqstyz{!Z[OPQRTUVWZ_`defghijkmnoqstyz{QdOQePQfQQgRQkT`udefgkyz{QyhQziR{jQmUQnVQoWQqZQs_Qt`]}mnoqstqcOPQRTdefghijkyz{",nodeNames:" Unclear Document Div Recto Verso Part PartId Fragment FragmentNum Column ColumnNum Inline Foreign ForeignEnd LineBreakWrapped LineBreak Number AbbrevUnresolved Abbrev Supplied CertLow GapUnknown Gap SuppliedLost Text QuestionMark LostLines Illegible Erasure",maxTerm:61,skippedNodes:[0],repeatNodeCount:2,tokenData:"-h~Rcpq!^xy!cyz#O!O!P#T!Q![$U!^!_(U!_!`)X!`!a)t!a!b)y!c!}'l!}#O*O#P#Q*s#T#`'l#`#a+Q#a#o'l#p#q,_#r#s-R&Fp&Fq-^&Fq&Fr-c~!cO!X~~!hQ}~!a!b!n#p#q!y~!qPyz!t~!yOe~~#OO{~~#TO!O~~#YQ!W~!Q![#`!a!b#|~#eQl~!Q![#`#`#a#k~#nP#]#^#q~#tP#b#c#w~#|Ol~~$RPl~#`#a#k~$ZSaT!O!P$g!Q![$U!c!}'l#T#o'l~$lT`Tpq${}!O%Q#V#W%_#Y#Z&S#d#e'TT%QO`T~%VP_~pq%Y~%_O_~Q%bP#c#d%eQ%hP#`#a%kQ%nP#i#j%qQ%tP#a#b%wQ%zP#b#c%}Q&SOZQ~&VP#f#g&Y~&]P#T#U&`~&cP#Z#[&f~&iP#a#b&l~&oP#X#Y&r~&uP#b#c&x~&{P#h#i'O~'TOX~Q'WP#T#U'ZQ'^P#f#g'aQ'dP#h#i'gQ'lOVQQ'oS!O!P'{!Q!['l!c!}'l#T#o'lQ(OQ#V#W%_#d#e'T~(ZQ!P~!_!`(a!f!g(f~(fOt~~(iP!_!`(l~(oP!O!P(r~(wQy~#f#g(}#j#k)S~)SOv~~)XOx~~)^Q!Y~!`!a)d!f!g)i~)iOu~~)lP!`!a)o~)tOw~~)yO!Q~~*OOj~~*TQ!V~!O!P*Z!}#O*n~*`P!T~!a!b*c~*fP#P#Q*i~*nO!S~~*sO!^~T*xP!UP#P#Q*{S+QO!_SR+TU!O!P'{!Q!['l!c!}'l#T#]'l#]#^+g#^#o'lR+jU!O!P'{!Q!['l!c!}'l#T#b'l#b#c+|#c#o'lR,RS!ZP!O!P'{!Q!['l!c!}'l#T#o'l~,bQyz,h#r#s,m~,mO|~~,pQ!c!},v#T#o,v~,{Q^~!c!},v#T#o,v~-UP#p#q-X~-^Oz~~-cO![~~-hO!]~",tokenizers:[_g,Eg,0,1,2],topRules:{Document:[0,2]},tokenPrec:279}),Pg=["Recto","Verso","Fragment","Part","Div","Column"];function $g(e,t){return e.substring(t.from,t.to)}var Ng=$l.define({parser:Tg.configure({props:[Ua({Number:hl.number,"LineBreak LineBreakWrapped":hl.contentSeparator,"Div Recto Verso Part Fragment":hl.keyword,"Abbrev!":hl.integer,"( ) [ ]":hl.paren,"Supplied!":hl.comment,"SuppliedLost!":hl.comment,"Unclear!":hl.bool})]}),languageData:{closeBrackets:{brackets:["(","[","{","<"]}}});function Ig(e,t){for(let n=0;n<e.childNodes.length;n++)Qg(e.childNodes[n],t)}function Qg(e,t){if(e)switch(e.nodeType){case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:Qg(e.firstElementChild,t);break;case Node.ELEMENT_NODE:let n,i=e;switch(i.localName){case"ab":t.push("<="),Ig(i,t),t.push("=>");break;case"abbr":t.push("(|"),Ig(i,t),t.push("|)");break;case"del":t.push(""),Ig(i,t),t.push("");break;case"div":switch(n=i.getAttribute("n"),i.getAttribute("subtype")){case"column":t.push(`<D=.${n}.column`);break;case"part":t.push(`<D=.${n}.part`);break;default:t.push(`<D=.${n}`)}Ig(i,t),t.push("=D>\n");break;case"expan":case"ex":let e=i.getAttribute("cert");t.push("("),Ig(i,t),"low"===e&&t.push("?"),t.push(")");break;case"gap":!function(e,t){let n=e.getAttribute("unit"),i=e.getAttribute("quantity"),r=e.getAttribute("reason");if(r)switch(r){case"lost":switch(n){case"character":i?t.push(`[.${i}]`):t.push("[.?]");break;case"line":i?t.push(`lost.${i}lin`):t.push("lost.?lin")}break;case"illegible":switch(n){case"character":i?t.push(`.${i}`):t.push(".?");break;case"line":i&&t.push(`.${i}lin`)}}}(i,t);break;case"lb":n=i.getAttribute("n"),t.length>0&&!/\n+$/.test(t[t.length-1])&&t.push("\n");let r=i.getAttribute("break");t.push(`${n}.${"no"===r?"- ":" "}`);break;case"supplied":!function(e,t){let n=e.getAttribute("reason");if(n){let i=e.getAttribute("cert");if("omitted"===n)t.push("<"),Ig(e,t),i&&"low"===i&&t.push("(?)"),t.push(">");else t.push("["),Ig(e,t),i&&"low"===i&&t.push("(?)"),t.push("]")}}(i,t);break;case"unclear":let s=i.textContent||"",o="";for(let e=0;e<s.length;e++){let t=s.codePointAt(e);t&&(o+=String.fromCodePoint(t),o+=String.fromCodePoint(803))}t.push(o);break;case"foreign":t.push("~|"),Ig(i,t),t.push(`|~${i.getAttribute("xml:lang")}`);break;default:throw new Error(`Cannot transform element ${i.localName} to Leiden`)}break;case Node.TEXT_NODE:t.push(e.nodeValue||"")}}function Rg(e){if(!(e instanceof Element))return"";let t=[],n=e.querySelectorAll("cb");if(n.length>0){n=(e=e.cloneNode(!0)).querySelectorAll("cb");for(let i=0;i<=n.length;i++){let r=document.createRange();0===i?r.setStart(e,0):r.setStartAfter(n[i-1]),i===n.length?e.lastChild&&r.setEndAfter(e.lastChild):r.setEndBefore(n[i]);let s=document.createElement("div");s.setAttribute("type","textpart"),s.setAttribute("subtype","column"),s.setAttribute("n",(i+1).toString());let o=document.createElement("ab");s.appendChild(o),o.appendChild(r.extractContents()),Qg(s,t)}}else Qg(e,t);return t.join("")}var Mg=e=>t=>{let n=[],i=Nl(t.state),r=0,s=!1;return i.iterate({enter:e=>{"Abbrev"===e.name?r+=1:e.type.isError&&n.push({message:"Syntaxfehler",severity:"error",from:e.from,to:e.to})},leave:e=>{"Abbrev"===e.name&&(2===r?s=!0:s||n.push({message:'Invalid abbreviation. Abbreviations must\nuse double parenthesis, e.g. "(C(aesar))"',severity:"error",from:e.from,to:e.to,actions:[{name:"Fix",apply:(e,t,n)=>{let i=e.state.wordAt(t);i&&(t=i.from);let r=e.state.doc.sliceString(t,n),s=e.state.update({changes:{from:t,to:n,insert:`(${r.toString()})`}});e.dispatch(s)}}]}),r-=1,0===r&&(s=!1))}}),function(t){e.valid=t,e.dispatchEvent(new CustomEvent(t?"valid":"invalid",{detail:n,composed:!0,bubbles:!0}))}(0===n.length),n},Bg={expan:e=>(e.state.selection.ranges.forEach((t=>{let n=e.state.doc.slice(t.from,t.to).toString(),i="",r="";n.length>0&&(i=n.charAt(0),r=n.substring(1)),qp(`(\${1:${i}}(\${2:${r}}))\${3}`)(e,{label:""},t.from,t.to)})),!0),div:ig("<=\n","\n=>"),fragment:rg("<D=.${1:1}.fragment<=\n${2:_}\n=>=D>${3}"),part:rg("<D=.${1:A}.part<=\n${2:_}\n=>=D>${3}"),recto:ig("<D=.r<=\n","\n=>=D>"),verso:ig("<D=.v<=\n","\n=>=D>"),erasure:ig("",""),foreign:rg("~|${1:_}|~${2:gr}${3}"),unclear:e=>(e.dispatch(e.state.changeByRange((t=>{let n=e.state.doc.slice(t.from,t.to).toString(),i="";for(let e=0;e<n.length;e++)e+1<n.length&&803===n.charCodeAt(e+1)?(i+=n.charAt(e),e++):i+=`${n.charAt(e)}`;return{changes:[{from:t.from,to:t.to,insert:i}],range:X.range(t.from,t.from+i.length)}}))),!0),fixNewlines:e=>{let t,n=e.state.doc.toString();if(-1!==n.indexOf("/"))t=n.split(/(?<!\/)\/\/?/).map(((e,t)=>/^\s+/.test(e)||0===t?`${t+1}. ${e.replace(/^\s+/,"")}`:`${t+1}.- ${e.replace(/^\s+/,"")}`)).join("\n");else{let e=0;t=n.replace(/^(?!\d+\.)/gm,(()=>(e+=1,`${e}. `)))}return e.dispatch({changes:[{from:0,to:e.state.doc.length,insert:t}]}),!0},snippet:{create:e=>rg(e)}},Dg=[{key:"Ctrl-Shift-e",mac:"Cmd-Shift-e",run:Bg.expan},{key:"Ctrl-Shift-a",mac:"Cmd-Shift-a",run:Bg.div},{key:"Ctrl-Shift-f",mac:"Cmd-Shift-f",run:Bg.fragment},{key:"Ctrl-Shift-p",mac:"Cmd-Shift-p",run:Bg.part},{key:"Ctrl-Shift-r",mac:"Cmd-Shift-r",run:Bg.recto},{key:"Ctrl-Shift-v",mac:"Cmd-Shift-v",run:Bg.verso},{key:"Ctrl-Shift-d",mac:"Cmd-Shift-d",run:Bg.erasure},{key:"Ctrl-Shift-u",mac:"Cmd-Shift-u",run:Bg.unclear},{key:"Ctrl-Shift-f",mac:"Cmd-Shift-f",run:Bg.foreign}],Xg=class extends ag{constructor(e,t){super(e,t,Bg)}async getExtensions(){return[new Ll(Ng),Qf(Mg(this.editor)),Wr.of(Dg),Kf()]}getCommands(){return Bg}onUpdate(e,t){return function(e,t=Tg.parse(e)){let n,i=[],r=[],s=!1;return t.iterate({enter:t=>{if(t.type.isError)return void r.push(`\x3c!-- Error:${$g(e,t)} --\x3e`);let o=t.name;switch(o){case"Document":let a=!1;if(t.firstChild())do{Pg.includes(t.type.name)||(a=!/^[\s\n]+$/.test($g(e,t)))}while(t.nextSibling());s=a,s&&r.push("<ab>\n"),t.parent();break;case"Text":case"Number":r.push($g(e,t));break;case"LineBreak":t.firstChild(),n=/^([0-9]+)\..*$/.exec($g(e,t)),r.push(`<lb n="${n?n[1]:""}"/>`);break;case"LineBreakWrapped":t.firstChild(),n=/^([0-9]+)\..*$/.exec($g(e,t)),r.push(`<lb n="${n?n[1]:""}" break="no"/>`);break;case"Div":r.push("<ab>");break;case"Recto":r.push('<div n="r" type="textpart">');break;case"Verso":r.push('<div n="v" type="textpart">');break;case"Fragment":t.firstChild(),n=/^([0-9]+)\..*$/.exec($g(e,t)),r.push(`<div n="${n?n[1]:""}" subtype="fragment" type="textpart">`);break;case"Part":t.firstChild(),n=/^([a-zA-Z0-9]+)\..*$/.exec($g(e,t)),r.push(`<div n="${n?n[1]:""}" subtype="part" type="textpart">`);break;case"Column":t.firstChild(),n=/^([a-zA-Z0-9]+)\..*$/.exec($g(e,t)),r.push(`<div n="${n?n[1]:""}" subtype="column" type="textpart">`);break;case"Foreign":t.lastChild(),n=/^\|\~(.*)$/.exec($g(e,t)),r.push(`<foreign xml:lang="${n?n[1]:""}">`),t.parent();break;case"Unclear":let l=$g(e,t),h="";for(let e=0;e<l.length;e++){let t=l.codePointAt(e);t&&803!==t&&(h+=String.fromCodePoint(t))}return r.push(`<unclear>${h}</unclear>`),!1;case"Gap":return t.next(!0),r.push(`<gap reason="lost" quantity="${$g(e,t)}" unit="character"/>`),!1;case"GapUnknown":return r.push('<gap reason="lost" extent="unknown" unit="character"/>'),!1;case"Illegible":return n=/^\.([0-9?]+)(lin)?$/.exec($g(e,t)),n&&("lin"===n[2]?r.push(`<gap reason="illegible" quantity="${n?n[1]:""}" unit="line"/>`):"?"===n[1]?r.push('<gap reason="illegible" extent="unkown" unit="character"/>'):r.push(`<gap reason="illegible" quantity="${n?n[1]:""}" unit="character"/>`)),!1;case"Erasure":r.push('<del rend="erasure">');break;case"LostLines":return n=/^lost\.([0-9?]+)lin$/.exec($g(e,t)),n&&("?"===n[1]?r.push('<gap reason="lost" extent="unknown" unit="line"/>'):r.push(`<gap reason="lost" quantity="${n?n[1]:""}" unit="line"/>`)),!1;case"AbbrevUnresolved":r.push("<abbr>");break;case"Abbrev":i.length>0?(t.lastChild(),n=$g(e,t),n.length>0&&"?"===n.charAt(n.length-1)?r.push('<ex cert="low">'):r.push("<ex>"),t.parent()):r.push("<expan>"),i.push("expan");break;case"Supplied":t.lastChild(),"CertLow"===t.name?r.push('<supplied reason="omitted" cert="low">'):r.push('<supplied reason="omitted">'),t.parent();break;case"SuppliedLost":t.lastChild(),"CertLow"===t.name?r.push('<supplied reason="lost" cert="low">'):r.push('<supplied reason="lost">'),t.parent();break;case"ForeignEnd":case"CertLow":return!1;case"QuestionMark":return i.length<2&&r.push("?"),!1;case"Inline":break;default:r.push(`<${o}>`)}},leave:e=>{switch(e.name){case"Document":s&&r.push("\n</ab>");break;case"AbbrevUnresolved":r.push("</abbr>");break;case"Abbrev":if(i.length>1){let e=r[r.length-1];e.endsWith("?")&&(r[r.length-1]=e.substring(0,e.length-2)),r.push("</ex>")}else r.push("</expan>");i.pop();break;case"Div":r.push("</ab>");break;case"Recto":case"Verso":case"Fragment":case"Part":case"Column":r.push("</div>\n");break;case"Supplied":case"SuppliedLost":r.push("</supplied>");break;case"Erasure":r.push("</del>");break;case"Foreign":r.push("</foreign>")}}}),"Inline"===t.type.name&&r.push("</ab>"),r.join("")}(t,e)}serialize(){return this.editor.content}setFromValue(e){if(!e)return"";if(e instanceof NodeList){let t=[];return e.forEach((e=>t.push(Rg(e)))),t.join("")}return e instanceof Element?Rg(e):super.setFromValue(e)}};function Fg(e,t){(e=(e=e.toString().replace(/\t+/g,"")).replace(/\r/g,"")).toString().length-e.toString().lastIndexOf(" ")==1&&(e=e.toString().substring(0,e.toString().lastIndexOf(" ")));{let n=0;if(e=(e=(e='<lb n="1"/>'+e).replace(/(\-|-?|\=?)\s?\n/g,(function(e,t){return"-"===t||"="===t?'\n<lb n="'+(2+n++)+'" break="no"/>':'\n<lb n="'+(2+n++)+'"/>'}))).replace(/(\<lb n=\"[0-9]*\"\/\>)\[(\s?\s?){3,50}\]\n(\<lb n=\"[0-9]*\"\/\>)/g,'$1<gap reason="illegible" quantity="1" unit="line"/>\n$3'),"edcs"==t){n=0,e=e.replace(/(\s)?(\/\/)(?!\>)(\s)?/g,(function(e){if("/"===e[0])var t=' break="no"';else t="";return'\n<cb n="'+(2+n++)+'"'+t+"/>"}));let t=/(\s)?(\/{1})(?!\>)(\s)?/g;n=0,e=e.replace(t,(function(e){if("/"===e[0])var t=' break="no"';else t="";return'\n<lb n="'+(2+n++)+'"'+t+"/>"}))}"phi"==t&&(e=(e=(e=e.replace(/#/g,'<gap reason="illegible" quantity="1" unit="character"/>')).replace(/###/g,'<gap reason="illegible" quantity="3" unit="character"/>')).replace(/#/g,'<g type="interpunct"></g>'));let i=/\n<lb n=\'([0-9])\'\/>\1\s/g,r=/(\"[0-9]{1,3}\"\/>)([0-9]{1,3})/g;e=(e=e.replace(i,'\n<lb n="$1"/>')).replace(r,"$1")}if(e=(e=e.replace(/\<([^\x00-\x7F]*[aA-zZ]*)(?!\=)(?!\/)\>/g,'<supplied reason="omitted">$1</supplied>')).replace(/([^\x00-\x7F]*[aA-zZ]*)(?!\=)(?!\/)/g,'<supplied reason="omitted">$1</supplied>'),"edcs"==t){let t=/\<([^\x00-\x7F]*[aA-zZ]*)(\=)([^\x00-\x7F]*[aA-zZ]*)(?!\/)\>/g;e=e.replace(t,"<choice><corr>$1</corr><sic>$3</sic></choice>"),e=(e=(e=(e=(e=(e=(e=e.replace(/\[6\]/g,'<gap reason="lost" quantity="1" unit="line"/>')).replace(/\[3\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[3\s([^\x00-\x7F]*[aA-zZ]*)\]/g,'<gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">$1</supplied>')).replace(/\[3\s/g,'<gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">')).replace(/\s3\s/g," - - - ")).replace(/\s3\]/g," - - -]")).replace(/a\(\)/g,"<abbr>a</abbr>")}let n=/\[(\|\-)\s?(\|\-)\s?(\|\-)\]/g;e=(e=(e=e.replace(/\(\!\)/g,"<note>!</note>")).replace(/\(sic\)/g,"<note>sic</note>")).replace(n,(function(e,t){return'<gap reason="lost" extent="unknown" unit="character"/>'})),n=/\[(?:(?:\s?\.\s?){1,99})([1-9][0-9]*)(?:(?:\s?\.\s?){1,99})\]/g,e=e.replace(n,(function(e,t){return'<gap reason="lost" quantity="'+t+'" unit="character"/>'})),n=/\[(?:(?:\s?\.\s?){1,99})([1-9][0-9]*)(?:(?:\s?\.\s?){1,99})\s/g,e=e.replace(n,(function(e,t){return e.length,'<gap reason="lost" quantity="'+t+'" unit="character"/><supplied reason="lost">'})),n=/\s(?:(?:\s?\.\s?){1,99})([1-9][0-9]*)(?:(?:\s?\.\s?){1,99})\]/g,e=e.replace(n,(function(e,t){return e.length,'</supplied><gap reason="lost" quantity="'+t+'" unit="character"/>'})),n=/\s(?:(?:\s?\.\s?){1,99})([1-9][0-9]*)(?:(?:\s?\.\s?){1,99})\s/g,e=e.replace(n,(function(e,t){return e.length,'</supplied><gap reason="lost" quantity="'+t+'" unit="character"/><supplied reason="lost">'})),n=/\[((\.){1,99})\]/g,e=e.replace(n,(function(e,t){return'<gap reason="lost" quantity="'+(e.length-2)+'" unit="character"/>'})),n=/\[((\.){1,99})\s/g,e=e.replace(n,(function(e,t){return'<gap reason="lost" quantity="'+(e.length-2)+'" unit="character"/><supplied reason="lost">'})),n=/\s((\.){1,99})\]/g,e=e.replace(n,(function(e,t){return'</supplied><gap reason="lost" quantity="'+(e.length-2)+'" unit="character"/>'})),n=/\s((\.){1,99})\s/g,e=e.replace(n,(function(e,t){return'</supplied><gap reason="lost" quantity="'+(e.length-2)+'" unit="character"/><supplied reason="lost">'})),n=/([^\x00-\x7F]*[aA-zZ]*)\[([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)(\])/g;let i='<expan><abbr>$1<supplied reason="lost">$2</supplied></abbr><ex>$3</ex></expan>';e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\[(-||\.\s?){1,20}ca\.(\s?)([1-9][0-9]*)((-)([1-9][0-9]*))(\s?)(-||\.\s?){1,20}\]/g,'<gap reason="lost" atLeast="$3" atMost="$6" unit="character"/>')).replace(/\[(-||\.\s?){1,20}ca\.(\s?)([1-9][0-9]*)(\s?)(-||\.\s?){1,20}\]/g,'<gap reason="lost" quantity="$3" unit="character" precision="low"/>')).replace(/\[(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20}(?:\s?)\]/g,'<gap reason="lost" atLeast="$1" atMost="$2" unit="character"/>')).replace(/\[(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:\s?)(?:[\.]){1,20}(?:\s?)\]/g,'<gap reason="lost" quantity="$1" unit="character" precision="low"/>')).replace(/\[(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20}(?:\s)/g,'<gap reason="lost" atLeast="$1" atMost="$2" unit="character"/><supplied reason="lost">')).replace(/\[(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:\s?)(?:[\.]){1,20}(?:\s)/g,'<gap reason="lost" quantity="$1" unit="character" precision="low"/><supplied reason="lost">')).replace(/\s(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20}(?:\s?)\]/g,'</supplied><gap reason="lost" atLeast="$1" atMost="$2" unit="character"/>')).replace(/\s(?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:\s?)(?:[\.]){1,20}(?:\s?)\]/g,'</supplied><gap reason="lost" quantity="$1" unit="character" precision="low"/>')).replace(/\s(?:[\.]){2,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20}(?:\s)/g,'</supplied><gap reason="lost" atLeast="$1" atMost="$2" unit="character"/><supplied reason="lost">')).replace(/\s(?:[\.]){2,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:\s?)(?:[\.]){1,20}(?:\s)/g,'</supplied><gap reason="lost" quantity="$1" unit="character" precision="low"/><supplied reason="lost">')).replace(/(?:\s|\n)\(([^\x00-\x7F]*[aA-zZ]*)\)/g," <expan><ex>$1</ex></expan>")).replace(/\[{2}/g,"")).replace(/\]{2}/g,"")).replace(/\[([^\x00-\x7F]*[aA-zZ]*[^\]])\]([^\x00-\x7F]*[aA-zZ]*[^\]])\(([^\x00-\x7F]*?[aA-zZ]*?)\)/g,'<expan><abbr><supplied reason="lost">$1</supplied>$2</abbr><ex>$3</ex></expan>')).replace(/(||\[\[)([^\x00-\x7F]*[aA-zZ]*[^\]])(||]])([^\x00-\x7F]*[aA-zZ]*[^\]])\(([^\x00-\x7F]*?[aA-zZ]*?)\)/g,'<expan><abbr><supplied reason="lost">$1</supplied>$2</abbr><ex>$3</ex></expan>')).replace(/\[(\w*?\s?)(?:(?:(?:\-|\|\)\s?){1,20})(\w*?)\](?![^\x00-\x7F]*?[aA-zZ]*?\()/g,'<supplied reason="lost">$1</supplied><gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">$2</supplied>')).replace(/<supplied reason=\"lost\"><\/supplied>/g,"")).replace(/(?:|)(.*?\s?)(?:(?:(?:\-|\|\)\s?){1,20})(.*?)(?:|)(?![^\x00-\x7F]*?[aA-zZ]*?\()/g,'<del rend="erasure">$1</del><gap reason="lost" extent="unknown" unit="character"/><del rend="erasure">$2</del>')).replace(/(?:\s)\[(.*?)\](?:\n)/g,' <supplied reason="lost">$1</supplied>\n')).replace(/(?:\s)\[(.*)\](?:\s)/g,' <supplied reason="lost">$1</supplied> ')).replace(/(?:\s)(?:|)(.*?)(?:|)(?:\n)/g,' <del rend="erasure">$1</del>\n')).replace(/(?:\s)(?:|)(.*?)(?:|)(?:\s)/g,' <del256 rend="erasure">$1</del> ')).replace(n,i),n=/([^\x00-\x7F]*[aA-zZ]*)(?:|)([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)(?:|)/g,i='<expan><abbr>$1<del rend="erasure">$2</del></abbr><ex>$3</ex></expan>',e=e.replace(n,i),n=/([^\x00-\x7F]*[aA-zZ]*)\[([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)(\s)?([^\x00-\x7F]*[aA-zZ]*)?(\s)?(\])/g,i='<expan><abbr>$1<supplied reason="lost">$2</supplied></abbr><ex>$3</ex></expan><supplied reason="lost">$4$5</supplied>',e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/([^\x00-\x7F]*?[aA-zZ]*?[^>])?\[([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\)(.*?[^\-\\])\](?![^\x00-\x7F]*?[aA-zZ]*\()/g,'<expan><abbr>$1<supplied reason="lost">$2</supplied></abbr><ex>$3</ex></expan> <supplied reason="lost">$4</supplied>')).replace(/([^\x00-\x7F]*?[aA-zZ]*?[^\s][^>])?(?:\s?)(?:|)([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\)(.*?[^\-\\])(?:|)(?![^\x00-\x7F]*?[aA-zZ]*\()/g,'<expan><abbr>$1<del rend="erasure">$2</del></abbr><ex>$3</ex></expan> <del rend="erasure">$4</del>')).replace(/([^\x00-\x7F]*?[aA-zZ]+)\[([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\)(.*?[^\-\\])([^\x00-\x7F]*?[aA-zZ]*?)\](?:([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\))/g,'<expan><abbr>$1<supplied reason="lost">$2</supplied></abbr><ex>$3</ex></expan> <supplied reason="lost">$4</supplied><expan><abbr><supplied reason="lost">$5</supplied>$6</abbr><ex>$7</ex></expan>')).replace(/([^\x00-\x7F]*?[aA-zZ]*?)(?:|)([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\)(.*?[^\-\\])([^\x00-\x7F]*?[aA-zZ]*?)(?:|)(?:([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*?[aA-zZ]*?)\))/g,'<expan><abbr>$1<del rend="erasure">$2</del></abbr><ex>$3</ex></expan> <del rend="erasure">$4</del><expan><abbr><del rend="erasure">$5</del>$6</abbr><ex>$7</ex></expan>')).replace(/<supplied reason="lost"> (?:[\.]){1,20}c(?:a?)\.(?:\s?)([1-9][0-9]*)(?:(?:-)([1-9][0-9]*))(?:\s?)(?:[\.]){1,20} <\/supplied>/g,'<gap reason="lost" atLeast="$1" atMost="$2" unit="character"/>')).replace(/<supplied reason=\"lost\">(<gap reason=\"lost\" atLeast=\"[0-9]*\" atMost=\"[0-9]\" unit="character"\/>)<\/supplied>/g,"$1")).replace(/\[(.[^\[\-\\]*)\](?![^\x00-\x7F]*[aA-zZ]*\()/g,'<supplied reason="lost">$1</supplied>')).replace(/(?:|)(.[^\[]*)\](?![^\x00-\x7F]*[aA-zZ]*\()/g,'<del rend="erasure">$1</supplied>')).replace(/(?:\s)\[((.[^\.<])*)\s/g,' <supplied reason="lost"><expan><abbr>$1</abbr><ex>$2</ex></expan></supplied>')).replace(/(?!([^\x00-\x7F]*[aA-zZ]*))(\s)([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)\]/g,'$1<supplied reason="lost"><expan><abbr>$2</abbr><ex>$3</ex></expan></supplied>')).replace(/(\s)([^\x00-\x7F]*?[aA-zZ]*?)\]([^\x00-\x7F]*?[aA-zZ]*?)\(([^\x00-\x7F]*[aA-zZ]*)\)/g,'$1</supplied><expan><abbr><supplied reason="lost">$2</supplied>$3</abbr><ex>$4</ex></expan>')).replace(/(\s)([^\x00-\x7F]+[aA-zZ]+)\[([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)/g,' <expan><abbr>$2<supplied reason="lost">$3</supplied></abbr><ex>$4</ex></expan> <supplied reason="lost">')).replace(/\[([^\x00-\x7F]*[aA-zZ]*)\(\?\)((\s?(\-|\|\)\s?){1,20})\]/g,'<supplied reason="lost" cert="low">$1</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[([^\x00-\x7F]*[aA-zZ]*)((\s?(\-|\|\)\s?){1,20})\]/g,'<supplied reason="lost">$1</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(n,i),n=/(||\[\[)([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)([^\x00-\x7F]*[aA-zZ]*)?(||]])/g,i='<del rend="erasure"><expan><abbr>$2</abbr><ex>$3</ex></expan>$4</del>',e=e.replace(n,i),n=/\[([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)(])/g,i='<supplied reason="lost"><expan><abbr>$1</abbr><ex>$2</ex></expan></supplied>',e=e.replace(n,i),n=/([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\?\)/g,e=e.replace(n,'<expan><abbr>$1</abbr><ex cert="low">$2</ex></expan>'),n=/([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)([^\x00-\x7F]*[aA-zZ]*)*\(([^\x00-\x7F]*[aA-zZ]*)\)/g,i="<expan><abbr>$1</abbr><ex>$2</ex><abbr>$3</abbr><ex>$4</ex></expan>",e=e.replace(n,i),n=/([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)([^\x00-\x7F]*[aA-zZ]*)*/g,i="<expan><abbr>$1</abbr><ex>$2</ex>$3</expan>";e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(n,i)).replace("</expan><expan><abbr>","<abbr>")).replace("\n[------]",'<gap unit="line" />')).replace(/(-){6}/g,'<gap unit="line" />')).replace(/\[(\s?)*\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[---\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[  ca\.([1-9][0-9]*)((-)([1-9][0-9]*))?  \]/g,'<gap reason="lost" quantity="$1" unit="character" precision="low"/>')).replace(/\[   ca\.([1-9][0-9]*)((-)([1-9][0-9]*))?   \]/g,'<gap reason="lost" quantity="$1" unit="character" precision="low"/>')).replace(/\[(-|\s?){1,20}ca\.(\s?)([1-9][0-9]*)?(\s?)(-|\s?){1,20}\]/g,'<gap reason="lost" quantity="$3" unit="character" precision="low"/>')).replace(/\------\?/g,'<gap reason="lost" extent="unknown" unit="line"><certainty match=".." locus="name"/></gap>')).replace(/\[\------\?\]/g,'<gap reason="lost" extent="unknown" unit="line"><certainty match=".." locus="name"/></gap>')).replace(/\[\---\?\]/g,'<gap reason="lost" extent="unknown" unit="line"><certainty match=".." locus="name"/></gap>')).replace(/\[(-||\\s?){1,20}([^\x00-\x7F]*[aA-zZ]*)\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/\[(-||\\s?){1,20}([^\x00-\x7F]*[aA-zZ]*)\]/g,'<gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">$2</supplied>')).replace(/(?:|)(-||\\s?){1,20}([^\x00-\x7F]*[aA-zZ]*)(?:|)/g,'<gap reason="lost" extent="unknown" unit="character"/><del rend="erasure">$2</supplied>')).replace(/\[(?!([\-\\]))(((?!([\-\\\[\]]))[^\x00-\x7F]*[aA-zZ]*(\s?)){1,10})(([\-\\])\s?){1,20}\]/g,'<supplied reason="lost">$2</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(/(([\-\\])\s?){1,20}\]/g,'<gap reason="lost" extent="unknown" unit="character"/>')).replace(/<expan><abbr>\[/g,'<supplied reason="lost"><expan><abbr>')).replace(/<\/expan> <\/supplied></g,"</expan></supplied> <")).replace(/<supplied reason=\"lost\"><expan><abbr>([^\x00-\x7F]*?[aA-zZ]*?)\]/g,'<expan><abbr><supplied reason="lost">$1</supplied>')).replace(/<expan><abbr><\/abbr><ex>/g,"<expan><ex>")).replace(/\[/g,'<supplied reason="lost">')).replace(/\]/g,"</supplied>")).replace(/<\/ex><\/supplied><\/expan>/g,"</ex></expan></supplied>")).replace(/((\s?(\-|\|\)\s?){1,20})<\/supplied>/g,'</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(/((\s?(\-|\|\)\s?){1,20})<\/supplied>/g,'</supplied><gap reason="lost" extent="unknown" unit="character"/>')).replace(/<supplied reason=\"lost\">((\s?(\-|\|\)\s?){1,20})/g,'<gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">')).replace(/<supplied reason=\"lost\"><\/supplied><gap reason=\"lost\" extent=\"unknown\" unit=\"character\"\/><supplied reason=\"lost\"><\/supplied>/g,'</supplied><gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">')).replace(/<supplied reason=\"lost\"> <\/supplied>/g,"")).replace(/<del rend=\"erasure\">\s?<\/del>/g,"")).replace(/<\/supplied>\s?<\/supplied>/g,"</supplied>")).replace(/\/><\/supplied><gap/g,"/><gap")).replace(/\[(?!([\-\\]))((?:\s?(?:(?!(?:[\-\\\[\]]))[^\x00-\x7F]*[aA-zZ](?!\s)*)){1,10})(?:(?:\s?[\-\\])\s?){1,20}((?:(?!([\-\\\[\]]))[^\x00-\x7F]*[aA-zZ]*))\]/g,'<supplied reason="lost">$2</supplied><gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">$3</supplied>')).replace(/(\s?([\-\\])\s?){1,20}/g,'</supplied><gap reason="lost" extent="unknown" unit="character"/><supplied reason="lost">')).replace(/\[(.[^\[]*)(\s)([^\x00-\x7F]*[aA-zZ]*)\]([^\x00-\x7F]*[aA-zZ]*)\(([^\x00-\x7F]*[aA-zZ]*)\)/g,'<supplied reason="lost">$1</supplied><expan><abbr><supplied reason="lost">$3</supplied>$4</abbr><ex>$5</ex></expan>')).replace(/([+])+/g,(function(e){return'<gap reason="illegible" quantity="'+e.length+'" unit="character"/>'}));e=e.replace(/\[({1,20})\]/g,(function(e){return'<gap reason="illegible" quantity="'+(e.length-2)+'" unit="character"/>'}));n=/()(([^\x00-\x7F]*[aA-zZ]*)([\s\,\.]([^\x00-\x7F]*[aA-zZ]*))*)()/gm,i='<del rend="erasure">$2</del>',e=(e=(e=(e=(e=e.replace(/<supplied reason=\"lost\"> <gap/g," <gap")).replace(/(hed\.)/gi,'<g type="hedera"></g>')).replace(/vac\./gi,'<space extent="unknown" unit="character"/>')).replace(/\{([^\x00-\x7F]*[aA-zZ]*)\}/g,"<surplus>$1</surplus>")).replace(n,i),n=/()(([^\x00-\x7F]*[aA-zZ]*)([\s\,\.]([^\x00-\x7F]*[aA-zZ]*))*)()/gm,i='<del rend="erasure">$2</del>',e=e.replace(n,i),n=/(\[){2}(([^\x00-\x7F]*[aA-zZ]*)([\s\,\.]([^\x00-\x7F]*[aA-zZ]*))*)(\]){2}/gm,i='<del rend="erasure">$2</del>';e=(e=e.replace(n,i)).replace(/(\[)(([^\x00-\x7F]*[aA-zZ]*)([\s\,\.]([^\x00-\x7F]*[aA-zZ]*))*)(\])/gm,'<supplied reason="lost">$2</supplied>'),n=new RegExp("a","u");return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/(\[)([^\x00-\x7F]*[aA-zZ]*\s?[^\x00-\x7F]*[aA-zZ]*)(---)?(\])/g,'<supplied reason="lost">$2</supplied><gap reason="lost" />')).replace(/([^\x00-\x7F]?[aA-zZ]?)/g,"<unclear>$1</unclear>")).replace(/(\<\/unclear\>\<unclear\>)/g,"")).replace(/(<gap reason=\"lost\" atLeast=\"[0-9]*\" atMost=\"[0-9]\" unit=\"character\"\/>)<expan><abbr>((?:[^\x00-\x7F]*?[aA-zZ]*?)*)<\/supplied>/g,'$1<expan><abbr><supplied reason="lost">$2</supplied>')).replace(/(<gap reason=\"lost\" atLeast=\"[0-9]*\" atMost=\"[0-9]\" unit=\"character\"\/>)<\/supplied>/g,"$1")).replace(/(<gap reason=\"lost\" atLeast=\"[0-9]*\" atMost=\"[0-9]\" unit=\"character\"\/>)<expan><abbr>((?:[^\x00-\x7F]*?[aA-zZ]*?)*)<\/supplied>/g,'$1<expan><abbr><supplied reason="lost">$2</supplied>')).replace(/(<gap reason=\"lost\" quantity=\"[0-9]*\" unit=\"character\" precision=\"low\"\/>)<\/supplied>/g,"$1")).replace(/(\/\>)\s(\<lb n=\"[0-9]*\"\/\>)/g,"$1\n$2")).replace(/unit=\"line\"\/>\s(\w)/g,'unit="line"/>$1')).replace(/ ? ?/g,' <g type="interpunct"></g> ')).replace(/ ? ?/g,' <g type="denarius"/> ')).replace(//g,' <g type="hedera"></g> ')).replace(/\s\s/g," ")).replace(/ {2,99}/g,"")}var Lg=(e,t)=>n=>{let i=function(e,t){let n=`<ab>${Fg(e,t)}\n</ab>`,i=(new DOMParser).parseFromString(n,"application/xml");return i.firstElementChild?i.querySelector("parsererror")?null:Rg(i.firstElementChild):""}(n.state.doc.toJSON().join("\n"),t);return i?(e._value=i,e.mode="leiden_plus"):alert("Conversion failed due to invalid XML!"),!0},Ug={erasure:ig("[[","]]"),gap:(e=>t=>(t.dispatch(t.state.changeByRange((t=>({changes:[{from:t.from,insert:e}],range:X.range(t.from,t.from)})))),!0))("[---]")},Vg=class extends ag{constructor(e,t=[],n){super(e,t,Object.assign(Ug,{convert:Lg(e,n)})),this._sourceType=n}async getExtensions(){return[Kf()]}onUpdate(e,t){return`<ab>\n${Fg(t,this._sourceType)}\n</ab>`}serialize(){return this.editor.content}},zg=function(){function e(e){return{type:e,style:"keyword"}}for(var t=e("operator"),n={type:"atom",style:"atom"},i={type:"axis_specifier",style:"qualifier"},r={",":{type:"punctuation",style:null}},s=["after","all","allowing","ancestor","ancestor-or-self","any","array","as","ascending","at","attribute","base-uri","before","boundary-space","by","case","cast","castable","catch","child","collation","comment","construction","contains","content","context","copy","copy-namespaces","count","decimal-format","declare","default","delete","descendant","descendant-or-self","descending","diacritics","different","distance","document","document-node","element","else","empty","empty-sequence","encoding","end","entire","every","exactly","except","external","first","following","following-sibling","for","from","ftand","ftnot","ft-option","ftor","function","fuzzy","greatest","group","if","import","in","inherit","insensitive","insert","instance","intersect","into","invoke","is","item","language","last","lax","least","let","levels","lowercase","map","modify","module","most","namespace","next","no","node","nodes","no-inherit","no-preserve","not","occurs","of","only","option","order","ordered","ordering","paragraph","paragraphs","parent","phrase","preceding","preceding-sibling","preserve","previous","processing-instruction","relationship","rename","replace","return","revalidation","same","satisfies","schema","schema-attribute","schema-element","score","self","sensitive","sentence","sentences","sequence","skip","sliding","some","stable","start","stemming","stop","strict","strip","switch","text","then","thesaurus","times","to","transform","treat","try","tumbling","type","typeswitch","union","unordered","update","updating","uppercase","using","validate","value","variable","version","weight","when","where","wildcards","window","with","without","word","words","xquery"],o=0,a=s.length;o<a;o++)r[s[o]]=e(s[o]);var l=["xs:anyAtomicType","xs:anySimpleType","xs:anyType","xs:anyURI","xs:base64Binary","xs:boolean","xs:byte","xs:date","xs:dateTime","xs:dateTimeStamp","xs:dayTimeDuration","xs:decimal","xs:double","xs:duration","xs:ENTITIES","xs:ENTITY","xs:float","xs:gDay","xs:gMonth","xs:gMonthDay","xs:gYear","xs:gYearMonth","xs:hexBinary","xs:ID","xs:IDREF","xs:IDREFS","xs:int","xs:integer","xs:item","xs:java","xs:language","xs:long","xs:Name","xs:NCName","xs:negativeInteger","xs:NMTOKEN","xs:NMTOKENS","xs:nonNegativeInteger","xs:nonPositiveInteger","xs:normalizedString","xs:NOTATION","xs:numeric","xs:positiveInteger","xs:precisionDecimal","xs:QName","xs:short","xs:string","xs:time","xs:token","xs:unsignedByte","xs:unsignedInt","xs:unsignedLong","xs:unsignedShort","xs:untyped","xs:untypedAtomic","xs:yearMonthDuration"];for(o=0,a=l.length;o<a;o++)r[l[o]]=n;var h=["eq","ne","lt","le","gt","ge",":=","=",">",">=","<","<=",".","|","?","and","or","div","idiv","mod","*","/","+","-"];for(o=0,a=h.length;o<a;o++)r[h[o]]=t;var c=["self::","attribute::","child::","descendant::","descendant-or-self::","parent::","ancestor::","ancestor-or-self::","following::","preceding::","following-sibling::","preceding-sibling::"];for(o=0,a=c.length;o<a;o++)r[c[o]]=i;return r}();function Zg(e,t,n){return t.tokenize=n,n(e,t)}function jg(e,t){var n=e.next(),i=!1,r=function(e){return'"'===e.current()?e.match(/^[^\"]+\"\:/,!1):"'"===e.current()&&e.match(/^[^\"]+\'\:/,!1)}(e);if("<"==n){if(e.match("!--",!0))return Zg(e,t,Yg);if(e.match("![CDATA",!1))return t.tokenize=Jg,"tag";if(e.match("?",!1))return Zg(e,t,Kg);var s=e.eat("/");e.eatSpace();for(var o,a="";o=e.eat(/[^\s\u00a0=<>\"\'\/?]/);)a+=o;return Zg(e,t,function(e,t){return function(n,i){return n.eatSpace(),t&&n.eat(">")?(rO(i),i.tokenize=jg,"tag"):(n.eat("/")||iO(i,{type:"tag",name:e,tokenize:jg}),n.eat(">")?(i.tokenize=jg,"tag"):(i.tokenize=Hg,"tag"))}}(a,s))}if("{"==n)return iO(t,{type:"codeblock"}),null;if("}"==n)return rO(t),null;if(eO(t))return">"==n?"tag":"/"==n&&e.eat(">")?(rO(t),"tag"):"variable";if(/\d/.test(n))return e.match(/^\d*(?:\.\d*)?(?:E[+\-]?\d+)?/),"atom";if("("===n&&e.eat(":"))return iO(t,{type:"comment"}),Zg(e,t,qg);if(!r&&('"'===n||"'"===n))return Zg(e,t,Gg(n));if("$"===n)return Zg(e,t,Wg);if(":"===n&&e.eat("="))return"keyword";if("("===n)return iO(t,{type:"paren"}),null;if(")"===n)return rO(t),null;if("["===n)return iO(t,{type:"bracket"}),null;if("]"===n)return rO(t),null;var l=zg.propertyIsEnumerable(n)&&zg[n];if(r&&'"'===n)for(;'"'!==e.next(););if(r&&"'"===n)for(;"'"!==e.next(););l||e.eatWhile(/[\w\$_-]/);var h=e.eat(":");!e.eat(":")&&h&&e.eatWhile(/[\w\$_-]/),e.match(/^[ \t]*\(/,!1)&&(i=!0);var c=e.current();return l=zg.propertyIsEnumerable(c)&&zg[c],i&&!l&&(l={type:"function_call",style:"def"}),function(e){return nO(e,"xmlconstructor")}(t)?(rO(t),"variable"):(("element"==c||"attribute"==c||"axis_specifier"==l.type)&&iO(t,{type:"xmlconstructor"}),l?l.style:"variable")}function qg(e,t){for(var n,i=!1,r=!1,s=0;n=e.next();){if(")"==n&&i){if(!(s>0)){rO(t);break}s--}else":"==n&&r&&s++;i=":"==n,r="("==n}return"comment"}function Gg(e,t){return function(n,i){var r;if(function(e){return nO(e,"string")}(i)&&n.current()==e)return rO(i),t&&(i.tokenize=t),"string";if(iO(i,{type:"string",name:e,tokenize:Gg(e,t)}),n.match("{",!1)&&tO(i))return i.tokenize=jg,"string";for(;r=n.next();){if(r==e){rO(i),t&&(i.tokenize=t);break}if(n.match("{",!1)&&tO(i))return i.tokenize=jg,"string"}return"string"}}function Wg(e,t){var n=/[\w\$_-]/;if(e.eat('"')){for(;'"'!==e.next(););e.eat(":")}else e.eatWhile(n),e.match(":=",!1)||e.eat(":");return e.eatWhile(n),t.tokenize=jg,"variable"}function Hg(e,t){var n=e.next();return"/"==n&&e.eat(">")?(tO(t)&&rO(t),eO(t)&&rO(t),"tag"):">"==n?(tO(t)&&rO(t),"tag"):"="==n?null:'"'==n||"'"==n?Zg(e,t,Gg(n,Hg)):(tO(t)||iO(t,{type:"attribute",tokenize:Hg}),e.eat(/[a-zA-Z_:]/),e.eatWhile(/[-a-zA-Z0-9_:.]/),e.eatSpace(),(e.match(">",!1)||e.match("/",!1))&&(rO(t),t.tokenize=jg),"attribute")}function Yg(e,t){for(var n;n=e.next();)if("-"==n&&e.match("->",!0))return t.tokenize=jg,"comment"}function Jg(e,t){for(var n;n=e.next();)if("]"==n&&e.match("]",!0))return t.tokenize=jg,"comment"}function Kg(e,t){for(var n;n=e.next();)if("?"==n&&e.match(">",!0))return t.tokenize=jg,"processingInstruction"}function eO(e){return nO(e,"tag")}function tO(e){return nO(e,"attribute")}function nO(e,t){return e.stack.length&&e.stack[e.stack.length-1].type==t}function iO(e,t){e.stack.push(t)}function rO(e){e.stack.pop();var t=e.stack.length&&e.stack[e.stack.length-1].tokenize;e.tokenize=t||jg}var sO={name:"xquery",startState:function(){return{tokenize:jg,cc:[],stack:[]}},token:function(e,t){return e.eatSpace()?null:t.tokenize(e,t)},languageData:{commentTokens:{block:{open:"(:",close:":)"}}}},oO=(e,t)=>n=>{let i=[];function r(t){e.valid=t,e.dispatchEvent(new CustomEvent(t?"valid":"invalid",{detail:i,composed:!0,bubbles:!0}))}return t?0===n.state.doc.length?(r(!0),Promise.resolve(i)):new Promise((e=>fetch(t,{method:"POST",headers:{"Content-type":"application/x-www-form-urlencoded"},body:new URLSearchParams({code:n.state.doc.toString()||""}).toString()}).then((e=>e.json())).then((t=>{if("fail"===t.status){let e=n.state.doc.lineAt(t.line);i.push({message:t.message,severity:"error",from:e.from+t.column,to:e.from+e.length})}e(i),r(0===i.length)})))):Promise.resolve(i)},aO=class extends ag{constructor(e,t=[],n=null){super(e,t),this.linterUri=n}async getExtensions(e){return[Yh.define(sO),Qf(oO(e,this.linterUri)),Kf()]}serialize(){return this.editor.content}},lO=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288];function hO(e){return e>=65&&e<=90||e>=97&&e<=122||e>=161}function cO(e){return e>=48&&e<=57}var uO=new Sa(((e,t)=>{for(let n=!1,i=0,r=0;;r++){let{next:s}=e;if(!(hO(s)||45==s||95==s||n&&cO(s))){n&&e.acceptToken(40==s?97:2==i&&t.canShift(2)?2:98);break}!n&&(45!=s||r>0)&&(n=!0),i===r&&45==s&&i++,e.advance()}})),dO=new Sa((e=>{if(lO.includes(e.peek(-1))){let{next:t}=e;(hO(t)||95==t||35==t||46==t||91==t||58==t||45==t)&&e.acceptToken(96)}})),pO=new Sa((e=>{if(!lO.includes(e.peek(-1))){let{next:t}=e;if(37==t&&(e.advance(),e.acceptToken(1)),hO(t)){do{e.advance()}while(hO(e.next));e.acceptToken(1)}}})),fO=Ua({"AtKeyword import charset namespace keyframes media supports":hl.definitionKeyword,"from to selector":hl.keyword,NamespaceName:hl.namespace,KeyframeName:hl.labelName,KeyframeRangeName:hl.operatorKeyword,TagName:hl.tagName,ClassName:hl.className,PseudoClassName:hl.constant(hl.className),IdName:hl.labelName,"FeatureName PropertyName":hl.propertyName,AttributeName:hl.attributeName,NumberLiteral:hl.number,KeywordQuery:hl.keyword,UnaryQueryOp:hl.operatorKeyword,"CallTag ValueName":hl.atom,VariableName:hl.variableName,Callee:hl.operatorKeyword,Unit:hl.unit,"UniversalSelector NestingSelector":hl.definitionOperator,MatchOp:hl.compareOperator,"ChildOp SiblingOp, LogicOp":hl.logicOperator,BinOp:hl.arithmeticOperator,Important:hl.modifier,Comment:hl.blockComment,ColorLiteral:hl.color,"ParenthesizedContent StringLiteral":hl.string,":":hl.punctuation,"PseudoOp #":hl.derefOperator,"; ,":hl.separator,"( )":hl.paren,"[ ]":hl.squareBracket,"{ }":hl.brace}),mO={__proto__:null,lang:32,"nth-child":32,"nth-last-child":32,"nth-of-type":32,"nth-last-of-type":32,dir:32,"host-context":32,url:60,"url-prefix":60,domain:60,regexp:60,selector:134},gO={__proto__:null,"@import":114,"@media":138,"@charset":142,"@namespace":146,"@keyframes":152,"@supports":164},OO={__proto__:null,not:128,only:128},yO=Ra.deserialize({version:14,states:"9bQYQ[OOO#_Q[OOP#fOWOOOOQP'#Cd'#CdOOQP'#Cc'#CcO#kQ[O'#CfO$_QXO'#CaO$fQ[O'#ChO$qQ[O'#DPO$vQ[O'#DTOOQP'#Ej'#EjO${QdO'#DeO%gQ[O'#DrO${QdO'#DtO%xQ[O'#DvO&TQ[O'#DyO&]Q[O'#EPO&kQ[O'#EROOQS'#Ei'#EiOOQS'#EU'#EUQYQ[OOO&rQXO'#CdO'gQWO'#DaO'lQWO'#EpO'wQ[O'#EpQOQWOOP(RO#tO'#C_POOO)C@X)C@XOOQP'#Cg'#CgOOQP,59Q,59QO#kQ[O,59QO(^Q[O'#EXO(xQWO,58{O)QQ[O,59SO$qQ[O,59kO$vQ[O,59oO(^Q[O,59sO(^Q[O,59uO(^Q[O,59vO)]Q[O'#D`OOQS,58{,58{OOQP'#Ck'#CkOOQO'#C}'#C}OOQP,59S,59SO)dQWO,59SO)iQWO,59SOOQP'#DR'#DROOQP,59k,59kOOQO'#DV'#DVO)nQ`O,59oOOQS'#Cp'#CpO${QdO'#CqO)vQvO'#CsO+TQtO,5:POOQO'#Cx'#CxO)iQWO'#CwO+iQWO'#CyOOQS'#Em'#EmOOQO'#Dh'#DhO+nQ[O'#DoO+|QWO'#EqO&]Q[O'#DmO,[QWO'#DpOOQO'#Er'#ErO({QWO,5:^O,aQpO,5:`OOQS'#Dx'#DxO,iQWO,5:bO,nQ[O,5:bOOQO'#D{'#D{O,vQWO,5:eO,{QWO,5:kO-TQWO,5:mOOQS-E8S-E8SO${QdO,59{O-]Q[O'#EZO-jQWO,5;[O-jQWO,5;[POOO'#ET'#ETP-uO#tO,58yPOOO,58y,58yOOQP1G.l1G.lO.lQXO,5:sOOQO-E8V-E8VOOQS1G.g1G.gOOQP1G.n1G.nO)dQWO1G.nO)iQWO1G.nOOQP1G/V1G/VO.yQ`O1G/ZO/dQXO1G/_O/zQXO1G/aO0bQXO1G/bO0xQWO,59zO0}Q[O'#DOO1UQdO'#CoOOQP1G/Z1G/ZO${QdO1G/ZO1]QpO,59]OOQS,59_,59_O${QdO,59aO1eQWO1G/kOOQS,59c,59cO1jQ!bO,59eO1rQWO'#DhO1}QWO,5:TO2SQWO,5:ZO&]Q[O,5:VO&]Q[O'#E[O2[QWO,5;]O2gQWO,5:XO(^Q[O,5:[OOQS1G/x1G/xOOQS1G/z1G/zOOQS1G/|1G/|O2xQWO1G/|O2}QdO'#D|OOQS1G0P1G0POOQS1G0V1G0VOOQS1G0X1G0XO3YQtO1G/gOOQO,5:u,5:uO3pQ[O,5:uOOQO-E8X-E8XO3}QWO1G0vPOOO-E8R-E8RPOOO1G.e1G.eOOQP7+$Y7+$YOOQP7+$u7+$uO${QdO7+$uOOQS1G/f1G/fO4YQXO'#EoO4aQWO,59jO4fQtO'#EVO5ZQdO'#ElO5eQWO,59ZO5jQpO7+$uOOQS1G.w1G.wOOQS1G.{1G.{OOQS7+%V7+%VO5rQWO1G/PO${QdO1G/oOOQO1G/u1G/uOOQO1G/q1G/qO5wQWO,5:vOOQO-E8Y-E8YO6VQXO1G/vOOQS7+%h7+%hO6^QYO'#CsOOQO'#EO'#EOO6iQ`O'#D}OOQO'#D}'#D}O6tQWO'#E]O6|QdO,5:hOOQS,5:h,5:hO7XQtO'#EYO${QdO'#EYO8VQdO7+%ROOQO7+%R7+%ROOQO1G0a1G0aO8jQpO<<HaO8rQWO,5;ZOOQP1G/U1G/UOOQS-E8T-E8TO${QdO'#EWO8zQWO,5;WOOQT1G.u1G.uOOQP<<Ha<<HaOOQS7+$k7+$kO9SQdO7+%ZOOQO7+%b7+%bOOQO,5:i,5:iO3QQdO'#E^O6tQWO,5:wOOQS,5:w,5:wOOQS-E8Z-E8ZOOQS1G0S1G0SO9ZQtO,5:tOOQS-E8W-E8WOOQO<<Hm<<HmOOQPAN={AN={O:XQdO,5:rOOQO-E8U-E8UOOQO<<Hu<<HuOOQO,5:x,5:xOOQO-E8[-E8[OOQS1G0c1G0c",stateData:":k~O#WOS#XQQ~OUYOXYO]VO^VOtWOxXO!YaO!ZZO!g[O!i]O!k^O!n_O!t`O#URO#_TO~OQfOUYOXYO]VO^VOtWOxXO!YaO!ZZO!g[O!i]O!k^O!n_O!t`O#UeO#_TO~O#R#dP~P!ZO#XjO~O#UlO~O]qO^qOpoOtrOxsO|tO!PvO#SuO#_nO~O!RwO~P#pO`}O#TzO#UyO~O#U!OO~O#U!QO~OQ!ZOb!TOf!ZOh!ZOn!YO#T!WO#U!SO#b!UO~Ob!]O!b!_O!e!`O#U![O!R#eP~Oh!eOn!YO#U!dO~Oh!gO#U!gO~Ob!]O!b!_O!e!`O#U![O~O!W#eP~P%gO]WX]!UX^WXpWXtWXxWX|WX!PWX!RWX#SWX#_WX~O]!lO~O!W!mO#R#dX!Q#dX~O#R#dX!Q#dX~P!ZO#Y!pO#Z!pO#[!rO~OUYOXYO]VO^VOtWOxXO#URO#_TO~OpoO!RwO~O`!yO#TzO#UyO~O!Q#dP~P!ZOb#QO~Ob#RO~Ov#SOz#TO~OP#VObgXjgX!WgX!bgX!egX#UgXagXQgXfgXhgXngXpgX!VgX#RgX#TgX#bgXvgX!QgX~Ob!]Oj#WO!b!_O!e!`O#U![O!W#eP~Ob#ZO~Ob!]O!b!_O!e!`O#U#[O~Op#`O!`#_O!R#eX!W#eX~Ob#cO~Oj#WO!W#eO~O!W#fO~Oh#gOn!YO~O!R#hO~O!RwO!`#_O~O!RwO!W#kO~O!W!}X#R!}X!Q!}X~P!ZO!W!mO#R#da!Q#da~O#Y!pO#Z!pO#[#rO~O]qO^qOtrOxsO|tO!PvO#SuO#_nO~Op!{a!R!{aa!{a~P.QOv#tOz#uO~O]qO^qOtrOxsO#_nO~Op{i|{i!P{i!R{i#S{ia{i~P/ROp}i|}i!P}i!R}i#S}ia}i~P/ROp!Oi|!Oi!P!Oi!R!Oi#S!Oia!Oi~P/RO!Q#vO~Oa#cP~P(^Oa#`P~P${Oa#}Oj#WO~O!W$PO~Oh$QOo$QO~O]!^Xa![X!`![X~O]$RO~Oa$SO!`#_O~Op#`O!R#ea!W#ea~O!`#_Op!aa!R!aa!W!aaa!aa~O!W$XO~O!Q$`O#U$ZO#b$YO~Oj#WOp$bO!V$dO!W!Ti#R!Ti!Q!Ti~P${O!W!}a#R!}a!Q!}a~P!ZO!W!mO#R#di!Q#di~Oa#cX~P#pOa$hO~Oj#WOQ!yXa!yXb!yXf!yXh!yXn!yXp!yX#T!yX#U!yX#b!yX~Op$jOa#`X~P${Oa$lO~Oj#WOv$mO~Oa$nO~O!`#_Op#Oa!R#Oa!W#Oa~Oa$pO~P.QOP#VOpgX!RgX~O#b$YOp!qX!R!qX~Op$rO!RwO~O!Q$vO#U$ZO#b$YO~Oj#WOQ!|Xb!|Xf!|Xh!|Xn!|Xp!|X!V!|X!W!|X#R!|X#T!|X#U!|X#b!|X!Q!|X~Op$bO!V$yO!W!Tq#R!Tq!Q!Tq~P${Oj#WOv$zO~OpoOa#ca~Op$jOa#`a~Oa$}O~P${Oj#WOQ!|ab!|af!|ah!|an!|ap!|a!V!|a!W!|a#R!|a#T!|a#U!|a#b!|a!Q!|a~Oa!zap!za~P${O#Wo#X#bj!P#b~",goto:"-Y#gPPP#hP#kP#t$TP#t$d#tPP$jPPP$p$y$yP%]P$yP$y%w&ZPPP&s&y#tP'PP#tP'VP#tP#t#tPPP']'r(PPP#kPP(W(W(b(WP(WP(W(WP#kP#kP#kP(e#kP(h(k(n(u#kP#kP(z)Q)a)o)u*P*V*a*g*mPPPPPPPPPP*s*|P+i+lP,b,e,k,tRkQ_bOPdhw!m#nkYOPdhotuvw!m#Q#c#nkSOPdhotuvw!m#Q#c#nQmTR!snQ{VR!wqQ!w}Q#Y!XR#s!yq!ZZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${p!ZZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${U$]#h$_$rR$q$[q!XZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${p!ZZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${Q!e^R#g!fQ|VR!xqQ!w|R#s!xQ!PWR!zrQ!RXR!{sQxUQ!vpQ#d!bQ#j!iQ#k!jQ$t$^R%Q$sSgPwQ!ohQ#m!mR$e#nZfPhw!m#na!a[`a!V!]!_#_#`R#]!]R!f^R!h_R#i!hS$^#h$_R%O$rV$[#h$_$rQ!qjR#q!qQdOShPwU!kdh#nR#n!mQ#z#RU$i#z$o${Q$o$RR${$jQ$k#zR$|$kQpUS!up$gR$g#wQ$c#lR$x$cQ!ngS#o!n#pR#p!oQ#a!^R$V#aQ$_#hR$u$_Q$s$^R%P$s_cOPdhw!m#n^UOPdhw!m#nQ!toQ!|tQ!}uQ#OvQ#w#QR$W#cR#{#RQ!VZQ!c]Q#U!TQ#l!l[#y#R#z$R$j$o${Q#|#TQ$O#WS$a#l$cQ$f#uR$w$bR#x#QQiPR#PwQ!b[Q!jaR#X!VU!^[a!VQ!i`Q#^!]Q#b!_Q$T#_R$U#`",nodeNames:" Unit VariableName Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent , PseudoClassName ArgList IdSelector # IdName ] AttributeSelector [ AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp } { Block Declaration PropertyName Important ; ImportStatement AtKeyword import KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports AtRule Styles",maxTerm:114,nodeProps:[["openedBy",17,"(",48,"{"],["closedBy",18,")",49,"}"]],propSources:[fO],skippedNodes:[0,3,85],repeatNodeCount:10,tokenData:"J^~R!^OX$}X^%u^p$}pq%uqr)Xrs.Rst/utu6duv$}vw7^wx7oxy9^yz9oz{9t{|:_|}?Q}!O?c!O!P@Q!P!Q@i!Q![Ab![!]B]!]!^CX!^!_$}!_!`Cj!`!aC{!a!b$}!b!cDw!c!}$}!}#OFa#O#P$}#P#QFr#Q#R6d#R#T$}#T#UGT#U#c$}#c#dHf#d#o$}#o#pH{#p#q6d#q#rI^#r#sIo#s#y$}#y#z%u#z$f$}$f$g%u$g#BY$}#BY#BZ%u#BZ$IS$}$IS$I_%u$I_$I|$}$I|$JO%u$JO$JT$}$JT$JU%u$JU$KV$}$KV$KW%u$KW&FU$}&FU&FV%u&FV;'S$};'S;=`JW<%lO$}`%QSOy%^z;'S%^;'S;=`%o<%lO%^`%cSo`Oy%^z;'S%^;'S;=`%o<%lO%^`%rP;=`<%l%^~%zh#W~OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^~'mh#W~o`OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^l)[UOy%^z#]%^#]#^)n#^;'S%^;'S;=`%o<%lO%^l)sUo`Oy%^z#a%^#a#b*V#b;'S%^;'S;=`%o<%lO%^l*[Uo`Oy%^z#d%^#d#e*n#e;'S%^;'S;=`%o<%lO%^l*sUo`Oy%^z#c%^#c#d+V#d;'S%^;'S;=`%o<%lO%^l+[Uo`Oy%^z#f%^#f#g+n#g;'S%^;'S;=`%o<%lO%^l+sUo`Oy%^z#h%^#h#i,V#i;'S%^;'S;=`%o<%lO%^l,[Uo`Oy%^z#T%^#T#U,n#U;'S%^;'S;=`%o<%lO%^l,sUo`Oy%^z#b%^#b#c-V#c;'S%^;'S;=`%o<%lO%^l-[Uo`Oy%^z#h%^#h#i-n#i;'S%^;'S;=`%o<%lO%^l-uS!V[o`Oy%^z;'S%^;'S;=`%o<%lO%^~.UWOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o<%lO.R~.sOh~~.vRO;'S.R;'S;=`/P;=`O.R~/SXOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o;=`<%l.R<%lO.R~/rP;=`<%l.Rn/zYtQOy%^z!Q%^!Q![0j![!c%^!c!i0j!i#T%^#T#Z0j#Z;'S%^;'S;=`%o<%lO%^l0oYo`Oy%^z!Q%^!Q![1_![!c%^!c!i1_!i#T%^#T#Z1_#Z;'S%^;'S;=`%o<%lO%^l1dYo`Oy%^z!Q%^!Q![2S![!c%^!c!i2S!i#T%^#T#Z2S#Z;'S%^;'S;=`%o<%lO%^l2ZYf[o`Oy%^z!Q%^!Q![2y![!c%^!c!i2y!i#T%^#T#Z2y#Z;'S%^;'S;=`%o<%lO%^l3QYf[o`Oy%^z!Q%^!Q![3p![!c%^!c!i3p!i#T%^#T#Z3p#Z;'S%^;'S;=`%o<%lO%^l3uYo`Oy%^z!Q%^!Q![4e![!c%^!c!i4e!i#T%^#T#Z4e#Z;'S%^;'S;=`%o<%lO%^l4lYf[o`Oy%^z!Q%^!Q![5[![!c%^!c!i5[!i#T%^#T#Z5[#Z;'S%^;'S;=`%o<%lO%^l5aYo`Oy%^z!Q%^!Q![6P![!c%^!c!i6P!i#T%^#T#Z6P#Z;'S%^;'S;=`%o<%lO%^l6WSf[o`Oy%^z;'S%^;'S;=`%o<%lO%^d6gUOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^d7QSzSo`Oy%^z;'S%^;'S;=`%o<%lO%^b7cSXQOy%^z;'S%^;'S;=`%o<%lO%^~7rWOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W<%lO7o~8_RO;'S7o;'S;=`8h;=`O7o~8kXOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W;=`<%l7o<%lO7o~9ZP;=`<%l7on9cSb^Oy%^z;'S%^;'S;=`%o<%lO%^~9tOa~n9{UUQjWOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^n:fWjW!PQOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^l;TUo`Oy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^l;nYo`#b[Oy%^z!Q%^!Q![;g![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^l<cYo`Oy%^z{%^{|=R|}%^}!O=R!O!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=WUo`Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=qUo`#b[Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l>[[o`#b[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^n?VSp^Oy%^z;'S%^;'S;=`%o<%lO%^l?hWjWOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^n@VU#_QOy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^~@nTjWOy%^z{@}{;'S%^;'S;=`%o<%lO%^~AUSo`#X~Oy%^z;'S%^;'S;=`%o<%lO%^lAg[#b[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^bBbU]QOy%^z![%^![!]Bt!];'S%^;'S;=`%o<%lO%^bB{S^Qo`Oy%^z;'S%^;'S;=`%o<%lO%^nC^S!W^Oy%^z;'S%^;'S;=`%o<%lO%^dCoSzSOy%^z;'S%^;'S;=`%o<%lO%^bDQU|QOy%^z!`%^!`!aDd!a;'S%^;'S;=`%o<%lO%^bDkS|Qo`Oy%^z;'S%^;'S;=`%o<%lO%^bDzWOy%^z!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^bEk[!YQo`Oy%^z}%^}!OEd!O!Q%^!Q![Ed![!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^bFfSxQOy%^z;'S%^;'S;=`%o<%lO%^lFwSv[Oy%^z;'S%^;'S;=`%o<%lO%^bGWUOy%^z#b%^#b#cGj#c;'S%^;'S;=`%o<%lO%^bGoUo`Oy%^z#W%^#W#XHR#X;'S%^;'S;=`%o<%lO%^bHYS!`Qo`Oy%^z;'S%^;'S;=`%o<%lO%^bHiUOy%^z#f%^#f#gHR#g;'S%^;'S;=`%o<%lO%^fIQS!RUOy%^z;'S%^;'S;=`%o<%lO%^nIcS!Q^Oy%^z;'S%^;'S;=`%o<%lO%^fItU!PQOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^`JZP;=`<%l$}",tokenizers:[dO,pO,uO,1,2,3,4,new xa("m~RRYZ[z{a~~g~aO#Z~~dP!P!Qg~lO#[~~",28,102)],topRules:{StyleSheet:[0,4],Styles:[1,84]},specialized:[{term:97,get:e=>mO[e]||-1},{term:56,get:e=>gO[e]||-1},{term:98,get:e=>OO[e]||-1}],tokenPrec:1169}),vO=null;function bO(){if(!vO&&"object"==typeof document&&document.body){let{style:e}=document.body,t=[],n=new Set;for(let i in e)"cssText"!=i&&"cssFloat"!=i&&"string"==typeof e[i]&&(/[A-Z]/.test(i)&&(i=i.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))),n.has(i)||(t.push(i),n.add(i)));vO=t.sort().map((e=>({type:"property",label:e})))}return vO||[]}var wO=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map((e=>({type:"class",label:e}))),xO=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map((e=>({type:"keyword",label:e}))).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map((e=>({type:"constant",label:e})))),SO=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map((e=>({type:"type",label:e}))),kO=/^(\w[\w-]*|-\w[\w-]*|)$/,AO=/^-(-[\w-]*)?$/;var CO=new Wo,_O=["Declaration"];function EO(e){for(let t=e;;){if(t.type.isTop)return t;if(!(t=t.parent))return e}}function TO(e,t,n){if(t.to-t.from>4096){let i=CO.get(t);if(i)return i;let r=[],s=new Set,o=t.cursor(Eo.IncludeAnonymous);if(o.firstChild())do{for(let t of TO(e,o.node,n))s.has(t.label)||(s.add(t.label),r.push(t))}while(o.nextSibling());return CO.set(t,r),r}{let i=[],r=new Set;return t.cursor().iterate((t=>{var s;if(n(t)&&t.matchContext(_O)&&":"==(null===(s=t.node.nextSibling)||void 0===s?void 0:s.name)){let n=e.sliceString(t.from,t.to);r.has(n)||(r.add(n),i.push({label:n,type:"variable"}))}})),i}}var PO=(e=>t=>{let{state:n,pos:i}=t,r=Nl(n).resolveInner(i,-1),s=r.type.isError&&r.from==r.to-1&&"-"==n.doc.sliceString(r.from,r.to);if("PropertyName"==r.name||(s||"TagName"==r.name)&&/^(Block|Styles)$/.test(r.resolve(r.to).name))return{from:r.from,options:bO(),validFor:kO};if("ValueName"==r.name)return{from:r.from,options:xO,validFor:kO};if("PseudoClassName"==r.name)return{from:r.from,options:wO,validFor:kO};if(e(r)||(t.explicit||s)&&function(e,t){var n;if(("("==e.name||e.type.isError)&&(e=e.parent||e),"ArgList"!=e.name)return!1;let i=null===(n=e.parent)||void 0===n?void 0:n.firstChild;return"Callee"==i?.name&&"var"==t.sliceString(i.from,i.to)}(r,n.doc))return{from:e(r)||s?r.from:i,options:TO(n.doc,EO(r),e),validFor:AO};if("TagName"==r.name){for(let{parent:e}=r;e;e=e.parent)if("Block"==e.name)return{from:r.from,options:bO(),validFor:kO};return{from:r.from,options:SO,validFor:kO}}if(!t.explicit)return null;let o=r.resolve(i),a=o.childBefore(i);return a&&":"==a.name&&"PseudoClassSelector"==o.name?{from:i,options:wO,validFor:kO}:a&&":"==a.name&&"Declaration"==o.name||"ArgList"==o.name?{from:i,options:xO,validFor:kO}:"Block"==o.name||"Styles"==o.name?{from:i,options:bO(),validFor:kO}:null})((e=>"VariableName"==e.name)),$O=$l.define({name:"css",parser:yO.configure({props:[Wl.add({Declaration:nh()}),rh.add({"Block KeyframeList":sh})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});var NO=class extends ag{async getExtensions(e){return[new Ll($O)]}serialize(){return this.editor.content}},IO=Ua({String:hl.string,Number:hl.number,"True False":hl.bool,PropertyName:hl.propertyName,Null:hl.null,",":hl.separator,"[ ]":hl.squareBracket,"{ }":hl.brace}),QO=Ra.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#CjOOQO'#Cp'#CpQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CrOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59U,59UO!iQPO,59UOVQPO,59QOqQPO'#CkO!nQPO,59^OOQO1G.k1G.kOVQPO'#ClO!vQPO,59aOOQO1G.p1G.pOOQO1G.l1G.lOOQO,59V,59VOOQO-E6i-E6iOOQO,59W,59WOOQO-E6j-E6j",stateData:"#O~OcOS~OQSORSOSSOTSOWQO]ROePO~OVXOeUO~O[[O~PVOg^O~Oh_OVfX~OVaO~OhbO[iX~O[dO~Oh_OVfa~OhbO[ia~O",goto:"!kjPPPPPPkPPkqwPPk{!RPPP!XP!ePP!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:" JsonText True False Null Number String } { Object Property PropertyName ] [ Array",maxTerm:25,nodeProps:[["isolate",-2,6,11,""],["openedBy",7,"{",12,"["],["closedBy",8,"}",13,"]"]],propSources:[IO],skippedNodes:[0],repeatNodeCount:2,tokenData:"(|~RaXY!WYZ!W]^!Wpq!Wrs!]|}$u}!O$z!Q!R%T!R![&c![!]&t!}#O&y#P#Q'O#Y#Z'T#b#c'r#h#i(Z#o#p(r#q#r(w~!]Oc~~!`Wpq!]qr!]rs!xs#O!]#O#P!}#P;'S!];'S;=`$o<%lO!]~!}Oe~~#QXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#m~#pR!Q![#y!c!i#y#T#Z#y~#|R!Q![$V!c!i$V#T#Z$V~$YR!Q![$c!c!i$c#T#Z$c~$fR!Q![!]!c!i!]#T#Z!]~$rP;=`<%l!]~$zOh~~$}Q!Q!R%T!R![&c~%YRT~!O!P%c!g!h%w#X#Y%w~%fP!Q![%i~%nRT~!Q![%i!g!h%w#X#Y%w~%zR{|&T}!O&T!Q![&Z~&WP!Q![&Z~&`PT~!Q![&Z~&hST~!O!P%c!Q![&c!g!h%w#X#Y%w~&yOg~~'OO]~~'TO[~~'WP#T#U'Z~'^P#`#a'a~'dP#g#h'g~'jP#X#Y'm~'rOR~~'uP#i#j'x~'{P#`#a(O~(RP#`#a(U~(ZOS~~(^P#f#g(a~(dP#i#j(g~(jP#X#Y(m~(rOQ~~(wOW~~(|OV~",tokenizers:[0],topRules:{JsonText:[0,1]},tokenPrec:0}),RO=()=>e=>{try{JSON.parse(e.state.doc.toString())}catch(t){if(!(t instanceof SyntaxError))throw t;let n=function(e,t){let n;return(n=e.message.match(/at position (\d+)/))?Math.min(+n[1],t.length):(n=e.message.match(/at line (\d+) column (\d+)/))?Math.min(t.line(+n[1]).from+ +n[2]-1,t.length):0}(t,e.state.doc);return[{from:n,message:t.message,severity:"error",to:n}]}return[]};var MO=$l.define({name:"json",parser:QO.configure({props:[Wl.add({Object:nh({except:/^\s*\}/}),Array:nh({except:/^\s*\]/})}),rh.add({"Object Array":sh})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}}),BO=class extends ag{async getExtensions(e){return[new Ll(MO),Qf(RO()),Kf()]}serialize(){return this.editor.content}},DO=class extends ag{async getExtensions(e){return[]}serialize(){return this.editor.content}};function XO(e){function t(e,t){e.cmdState.push(t)}function n(e){return e.cmdState.length>0?e.cmdState[e.cmdState.length-1]:null}function i(e,t,n){return function(){this.name=e,this.bracketNo=0,this.style=t,this.styles=n,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,"bracket"},this.closeBracket=function(){}}}var r={};function s(e,t){e.f=t}function o(e,i){var o;if(e.match(/^\\[a-zA-Z@\xc0-\u1fff\u2060-\uffff]+/)){var h=e.current().slice(1);return t(i,o=new(o=r.hasOwnProperty(h)?r[h]:r.DEFAULT)),s(i,l),o.style}if(e.match(/^\\[$&%#{}_]/)||e.match(/^\\[,;!\/\\]/))return"tag";if(e.match("\\["))return s(i,(function(e,t){return a(e,t,"\\]")})),"keyword";if(e.match("\\("))return s(i,(function(e,t){return a(e,t,"\\)")})),"keyword";if(e.match("$$"))return s(i,(function(e,t){return a(e,t,"$$")})),"keyword";if(e.match("$"))return s(i,(function(e,t){return a(e,t,"$")})),"keyword";var c=e.next();return"%"==c?(e.skipToEnd(),"comment"):"}"==c||"]"==c?(o=n(i))?(o.closeBracket(c),s(i,l),"bracket"):"error":"{"==c||"["==c?(t(i,o=new(o=r.DEFAULT)),"bracket"):/\d/.test(c)?(e.eatWhile(/[\w.%]/),"atom"):(e.eatWhile(/[\w\-_]/),o=function(e){for(var t=e.cmdState,n=t.length-1;n>=0;n--){var i=t[n];if("DEFAULT"!=i.name)return i}return{styleIdentifier:function(){return null}}}(i),"begin"==o.name&&(o.argument=e.current()),o.styleIdentifier())}function a(e,t,n){if(e.eatSpace())return null;if(n&&e.match(n))return s(t,o),"keyword";if(e.match(/^\\[a-zA-Z@]+/))return"tag";if(e.match(/^[a-zA-Z]+/))return"variableName.special";if(e.match(/^\\[$&%#{}_]/)||e.match(/^\\[,;!\/]/)||e.match(/^[\^_&]/))return"tag";if(e.match(/^[+\-<>|=,\/@!*:;'"`~#?]/))return null;if(e.match(/^(\d+\.\d*|\d*\.\d+|\d+)/))return"number";var i=e.next();return"{"==i||"}"==i||"["==i||"]"==i||"("==i||")"==i?"bracket":"%"==i?(e.skipToEnd(),"comment"):"error"}function l(e,t){var i=e.peek();return"{"==i||"["==i?(n(t).openBracket(i),e.eat(i),s(t,o),"bracket"):/[ \t\r]/.test(i)?(e.eat(i),null):(s(t,o),function(e){var t=e.cmdState.pop();t&&t.closeBracket()}(t),o(e,t))}return r.importmodule=i("importmodule","tag",["string","builtin"]),r.documentclass=i("documentclass","tag",["","atom"]),r.usepackage=i("usepackage","tag",["atom"]),r.begin=i("begin","tag",["atom"]),r.end=i("end","tag",["atom"]),r.label=i("label","tag",["atom"]),r.ref=i("ref","tag",["atom"]),r.eqref=i("eqref","tag",["atom"]),r.cite=i("cite","tag",["atom"]),r.bibitem=i("bibitem","tag",["atom"]),r.Bibitem=i("Bibitem","tag",["atom"]),r.RBibitem=i("RBibitem","tag",["atom"]),r.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{name:"stex",startState:function(){var t=e?function(e,t){return a(e,t)}:o;return{cmdState:[],f:t}},copyState:function(e){return{cmdState:e.cmdState.slice(),f:e.f}},token:function(e,t){return t.f(e,t)},blankLine:function(e){e.f=o,e.cmdState.length=0},languageData:{commentTokens:{line:"%"}}}}var FO=XO(!1);XO(!0);var LO=class extends ag{async getExtensions(e){return[Yh.define(FO)]}serialize(){return this.editor.content}},UO={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},VO={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},zO={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function ZO(e){return 45==e||46==e||58==e||e>=65&&e<=90||95==e||e>=97&&e<=122||e>=161}function jO(e){return 9==e||10==e||13==e||32==e}var qO=null,GO=null,WO=0;function HO(e,t){let n=e.pos+t;if(WO==n&&GO==e)return qO;let i=e.peek(t);for(;jO(i);)i=e.peek(++t);let r="";for(;ZO(i);)r+=String.fromCharCode(i),i=e.peek(++t);return GO=e,WO=n,qO=r?r.toLowerCase():i==YO||i==JO?void 0:null}var YO=63,JO=33;function KO(e,t){this.name=e,this.parent=t,this.hash=t?t.hash:0;for(let t=0;t<e.length;t++)this.hash+=(this.hash<<4)+e.charCodeAt(t)+(e.charCodeAt(t)<<8)}var ey=[6,10,7,8,9],ty=new Qa({start:null,shift:(e,t,n,i)=>ey.indexOf(t)>-1?new KO(HO(i,1)||"",e):e,reduce:(e,t)=>20==t&&e?e.parent:e,reuse(e,t,n,i){let r=t.type.id;return 6==r||36==r?new KO(HO(i,1)||"",e):e},hash:e=>e?e.hash:0,strict:!1}),ny=new Sa(((e,t)=>{if(60!=e.next)return void(e.next<0&&t.context&&e.acceptToken(57));e.advance();let n=47==e.next;n&&e.advance();let i=HO(e,0);if(void 0===i)return;if(!i)return e.acceptToken(n?14:6);let r=t.context?t.context.name:null;if(n){if(i==r)return e.acceptToken(11);if(r&&VO[r])return e.acceptToken(57,-2);if(t.dialectEnabled(0))return e.acceptToken(12);for(let e=t.context;e;e=e.parent)if(e.name==i)return;e.acceptToken(13)}else{if("script"==i)return e.acceptToken(7);if("style"==i)return e.acceptToken(8);if("textarea"==i)return e.acceptToken(9);if(UO.hasOwnProperty(i))return e.acceptToken(10);r&&zO[r]&&zO[r][i]?e.acceptToken(57,-1):e.acceptToken(6)}}),{contextual:!0}),iy=new Sa((e=>{for(let t=0,n=0;;n++){if(e.next<0){n&&e.acceptToken(58);break}if(45==e.next)t++;else{if(62==e.next&&t>=2){n>3&&e.acceptToken(58,-2);break}t=0}e.advance()}}));var ry=new Sa(((e,t)=>{if(47==e.next&&62==e.peek(1)){let n=t.dialectEnabled(1)||function(e){for(;e;e=e.parent)if("svg"==e.name||"math"==e.name)return!0;return!1}(t.context);e.acceptToken(n?5:4,2)}else 62==e.next&&e.acceptToken(4,1)}));function sy(e,t,n){let i=2+e.length;return new Sa((r=>{for(let s=0,o=0,a=0;;a++){if(r.next<0){a&&r.acceptToken(t);break}if(0==s&&60==r.next||1==s&&47==r.next||s>=2&&s<i&&r.next==e.charCodeAt(s-2))s++,o++;else if(2!=s&&s!=i||!jO(r.next)){if(s==i&&62==r.next){a>o?r.acceptToken(t,-o):r.acceptToken(n,-(o-2));break}if((10==r.next||13==r.next)&&a){r.acceptToken(t,1);break}s=o=0}else o++;r.advance()}}))}var oy=sy("script",54,1),ay=sy("style",55,2),ly=sy("textarea",56,3),hy=Ua({"Text RawText":hl.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":hl.angleBracket,TagName:hl.tagName,"MismatchedCloseTag/TagName":[hl.tagName,hl.invalid],AttributeName:hl.attributeName,"AttributeValue UnquotedAttributeValue":hl.attributeValue,Is:hl.definitionOperator,"EntityReference CharacterReference":hl.character,Comment:hl.blockComment,ProcessingInst:hl.processingInstruction,DoctypeDecl:hl.documentMeta}),cy=Ra.deserialize({version:14,states:",xOVO!rOOO!WQ#tO'#CqO!]Q#tO'#CzO!bQ#tO'#C}O!gQ#tO'#DQO!lQ#tO'#DSO!qOaO'#CpO!|ObO'#CpO#XOdO'#CpO$eO!rO'#CpOOO`'#Cp'#CpO$lO$fO'#DTO$tQ#tO'#DVO$yQ#tO'#DWOOO`'#Dk'#DkOOO`'#DY'#DYQVO!rOOO%OQ&rO,59]O%WQ&rO,59fO%`Q&rO,59iO%hQ&rO,59lO%sQ&rO,59nOOOa'#D^'#D^O%{OaO'#CxO&WOaO,59[OOOb'#D_'#D_O&`ObO'#C{O&kObO,59[OOOd'#D`'#D`O&sOdO'#DOO'OOdO,59[OOO`'#Da'#DaO'WO!rO,59[O'_Q#tO'#DROOO`,59[,59[OOOp'#Db'#DbO'dO$fO,59oOOO`,59o,59oO'lQ#|O,59qO'qQ#|O,59rOOO`-E7W-E7WO'vQ&rO'#CsOOQW'#DZ'#DZO(UQ&rO1G.wOOOa1G.w1G.wO(^Q&rO1G/QOOOb1G/Q1G/QO(fQ&rO1G/TOOOd1G/T1G/TO(nQ&rO1G/WOOO`1G/W1G/WOOO`1G/Y1G/YO(yQ&rO1G/YOOOa-E7[-E7[O)RQ#tO'#CyOOO`1G.v1G.vOOOb-E7]-E7]O)WQ#tO'#C|OOOd-E7^-E7^O)]Q#tO'#DPOOO`-E7_-E7_O)bQ#|O,59mOOOp-E7`-E7`OOO`1G/Z1G/ZOOO`1G/]1G/]OOO`1G/^1G/^O)gQ,UO,59_OOQW-E7X-E7XOOOa7+$c7+$cOOOb7+$l7+$lOOOd7+$o7+$oOOO`7+$r7+$rOOO`7+$t7+$tO)rQ#|O,59eO)wQ#|O,59hO)|Q#|O,59kOOO`1G/X1G/XO*RO7[O'#CvO*dOMhO'#CvOOQW1G.y1G.yOOO`1G/P1G/POOO`1G/S1G/SOOO`1G/V1G/VOOOO'#D['#D[O*uO7[O,59bOOQW,59b,59bOOOO'#D]'#D]O+WOMhO,59bOOOO-E7Y-E7YOOQW1G.|1G.|OOOO-E7Z-E7Z",stateData:"+s~O!^OS~OUSOVPOWQOXROYTO[]O][O^^O`^Oa^Ob^Oc^Ox^O{_O!dZO~OfaO~OfbO~OfcO~OfdO~OfeO~O!WfOPlP!ZlP~O!XiOQoP!ZoP~O!YlORrP!ZrP~OUSOVPOWQOXROYTOZqO[]O][O^^O`^Oa^Ob^Oc^Ox^O!dZO~O!ZrO~P#dO![sO!euO~OfvO~OfwO~OS|OhyO~OS!OOhyO~OS!QOhyO~OS!SOT!TOhyO~OS!TOhyO~O!WfOPlX!ZlX~OP!WO!Z!XO~O!XiOQoX!ZoX~OQ!ZO!Z!XO~O!YlORrX!ZrX~OR!]O!Z!XO~O!Z!XO~P#dOf!_O~O![sO!e!aO~OS!bO~OS!cO~Oi!dOSgXhgXTgX~OS!fOhyO~OS!gOhyO~OS!hOhyO~OS!iOT!jOhyO~OS!jOhyO~Of!kO~Of!lO~Of!mO~OS!nO~Ok!qO!`!oO!b!pO~OS!rO~OS!sO~OS!tO~Oa!uOb!uOc!uO!`!wO!a!uO~Oa!xOb!xOc!xO!b!wO!c!xO~Oa!uOb!uOc!uO!`!{O!a!uO~Oa!xOb!xOc!xO!b!{O!c!xO~OT~bac!dx{!d~",goto:"%p!`PPPPPPPPPPPPPPPPPPPP!a!gP!mPP!yP!|#P#S#Y#]#`#f#i#l#r#x!aP!a!aP$O$U$l$r$x%O%U%[%bPPPPPPPP%hX^OX`pXUOX`pezabcde{}!P!R!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ}bQ!PcQ!RdQ!UeZ!e{}!P!R!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:" StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:67,context:ty,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,21,30,33,36,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,29,32,35,37,"OpenTag"],["group",-9,14,17,18,19,20,39,40,41,42,"Entity",16,"Entity TextContent",-3,28,31,34,"TextContent Entity"]],propSources:[hy],skippedNodes:[0],repeatNodeCount:9,tokenData:"#%g!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs4ysv-_vw5iwxJ^x}-_}!OKP!O!P-_!P!Q$q!Q![-_![!]!!O!]!^-_!^!_!&W!_!`#$o!`!a&X!a!c-_!c!}!!O!}#R-_#R#S!!O#S#T3V#T#o!!O#o#s-_#s$f$q$f%W-_%W%o!!O%o%p-_%p&a!!O&a&b-_&b1p!!O1p4U-_4U4d!!O4d4e-_4e$IS!!O$IS$I`-_$I`$Ib!!O$Ib$Kh-_$Kh%#t!!O%#t&/x-_&/x&Et!!O&Et&FV-_&FV;'S!!O;'S;:j!&Q;:j;=`4s<%l?&r-_?&r?Ah!!O?Ah?BY$q?BY?Mn!!O?MnO$q!Z$|c`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bX`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UV`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pT`POv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!cpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({W`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!a`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!a`!cpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYkWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]``P!a`!cp!^^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_1n!_!a&X!a#S-_#S#T3V#T#s-_#s$f$q$f;'S-_;'S;=`4s<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/echSkWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!^!_0p!a#S/^#S#T0p#T#s/^#s$f+P$f;'S/^;'S;=`1h<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0uXhSqr0psw0px!P0p!Q!_0p!a#s0p$f;'S0p;'S;=`1b<%l?Ah0p?BY?Mn0pS1eP;=`<%l0p[1kP;=`<%l/^!U1wbhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!U3SP;=`<%l1n!V3bchS`P!a`!cpOq&Xqr3Vrs&}sv3Vvw0pwx(tx!P3V!P!Q&X!Q!^3V!^!_1n!_!a&X!a#s3V#s$f&X$f;'S3V;'S;=`4m<%l?Ah3V?Ah?BY&X?BY?Mn3V?MnO&X!V4pP;=`<%l3V!_4vP;=`<%l-_!Z5SV!`h`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_5rjhSkWc!ROX7dXZ8qZ[7d[^8q^p7dqr:crs8qst@Ttw:cwx8qx!P:c!P!Q7d!Q!]:c!]!^/^!^!_=p!_!a8q!a#S:c#S#T=p#T#s:c#s$f7d$f;'S:c;'S;=`?}<%l?Ah:c?Ah?BY7d?BY?Mn:c?MnO7d!Z7ibkWOX7dXZ8qZ[7d[^8q^p7dqr7drs8qst+Ptw7dwx8qx!]7d!]!^9f!^!a8q!a#S7d#S#T8q#T;'S7d;'S;=`:]<%lO7d!R8tVOp8qqs8qt!]8q!]!^9Z!^;'S8q;'S;=`9`<%lO8q!R9`Oa!R!R9cP;=`<%l8q!Z9mYkWa!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z:`P;=`<%l7d!_:jjhSkWOX7dXZ8qZ[7d[^8q^p7dqr:crs8qst/^tw:cwx8qx!P:c!P!Q7d!Q!]:c!]!^<[!^!_=p!_!a8q!a#S:c#S#T=p#T#s:c#s$f7d$f;'S:c;'S;=`?}<%l?Ah:c?Ah?BY7d?BY?Mn:c?MnO7d!_<echSkWa!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!^!_0p!a#S/^#S#T0p#T#s/^#s$f+P$f;'S/^;'S;=`1h<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V=udhSOp8qqr=prs8qst0ptw=pwx8qx!P=p!P!Q8q!Q!]=p!]!^?T!^!_=p!_!a8q!a#s=p#s$f8q$f;'S=p;'S;=`?w<%l?Ah=p?Ah?BY8q?BY?Mn=p?MnO8q!V?[XhSa!Rqr0psw0px!P0p!Q!_0p!a#s0p$f;'S0p;'S;=`1b<%l?Ah0p?BY?Mn0p!V?zP;=`<%l=p!_@QP;=`<%l:c!_@[ihSkWOXAyXZCTZ[Ay[^CT^pAyqrDrrsCTswDrwxCTx!PDr!P!QAy!Q!]Dr!]!^/^!^!_G|!_!aCT!a#SDr#S#TG|#T#sDr#s$fAy$f;'SDr;'S;=`JW<%l?AhDr?Ah?BYAy?BY?MnDr?MnOAy!ZBOakWOXAyXZCTZ[Ay[^CT^pAyqrAyrsCTswAywxCTx!]Ay!]!^Cu!^!aCT!a#SAy#S#TCT#T;'SAy;'S;=`Dl<%lOAy!RCWUOpCTq!]CT!]!^Cj!^;'SCT;'S;=`Co<%lOCT!RCoOb!R!RCrP;=`<%lCT!ZC|YkWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZDoP;=`<%lAy!_DyihSkWOXAyXZCTZ[Ay[^CT^pAyqrDrrsCTswDrwxCTx!PDr!P!QAy!Q!]Dr!]!^Fh!^!_G|!_!aCT!a#SDr#S#TG|#T#sDr#s$fAy$f;'SDr;'S;=`JW<%l?AhDr?Ah?BYAy?BY?MnDr?MnOAy!_FqchSkWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!^!_0p!a#S/^#S#T0p#T#s/^#s$f+P$f;'S/^;'S;=`1h<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VHRchSOpCTqrG|rsCTswG|wxCTx!PG|!P!QCT!Q!]G|!]!^I^!^!_G|!_!aCT!a#sG|#s$fCT$f;'SG|;'S;=`JQ<%l?AhG|?Ah?BYCT?BY?MnG|?MnOCT!VIeXhSb!Rqr0psw0px!P0p!Q!_0p!a#s0p$f;'S0p;'S;=`1b<%l?Ah0p?BY?Mn0p!VJTP;=`<%lG|!_JZP;=`<%lDr!ZJgW!bx`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aK^lhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMU!O!P-_!P!Q$q!Q!^-_!^!_1n!_!a&X!a#S-_#S#T3V#T#s-_#s$f$q$f;'S-_;'S;=`4s<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aMckhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_1n!_!`&X!`!a! W!a#S-_#S#T3V#T#s-_#s$f$q$f;'S-_;'S;=`4s<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!T! cX`P!a`!cp!eQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!a!!_!ZhSfQ`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!O!!O!O!P!!O!P!Q$q!Q![!!O![!]!!O!]!^-_!^!_1n!_!a&X!a!c-_!c!}!!O!}#R-_#R#S!!O#S#T3V#T#o!!O#o#s-_#s$f$q$f$}-_$}%O!!O%O%W-_%W%o!!O%o%p-_%p&a!!O&a&b-_&b1p!!O1p4U!!O4U4d!!O4d4e-_4e$IS!!O$IS$I`-_$I`$Ib!!O$Ib$Je-_$Je$Jg!!O$Jg$Kh-_$Kh%#t!!O%#t&/x-_&/x&Et!!O&Et&FV-_&FV;'S!!O;'S;:j!&Q;:j;=`4s<%l?&r-_?&r?Ah!!O?Ah?BY$q?BY?Mn!!O?MnO$q!a!&TP;=`<%l!!O!V!&achS!a`!cpOq*Vqr!'lrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!b!Ey!b#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!'uhhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex}1n}!O!)a!O!P1n!P!Q*V!Q!_1n!_!a*V!a!f1n!f!g!,]!g#W1n#W#X!<y#X#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!)jdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex}1n}!O!*x!O!P1n!P!Q*V!Q!_1n!_!a*V!a#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!+TbhS!a`!cp!dPOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!,fdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!q1n!q!r!-t!r#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!-}dhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!e1n!e!f!/]!f#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!/fdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!v1n!v!w!0t!w#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!0}dhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!{1n!{!|!2]!|#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!2fdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!r1n!r!s!3t!s#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!3}dhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!g1n!g!h!5]!h#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!5fchS!a`!cpOq!6qqr!5]rs!7hsv!5]vw!;`wx!9[x!P!5]!P!Q!6q!Q!_!5]!_!`!6q!`!a!:j!a#s!5]#s$f!6q$f;'S!5];'S;=`!<s<%l?Ah!5]?Ah?BY!6q?BY?Mn!5]?MnO!6q!R!6xY!a`!cpOr!6qrs!7hsv!6qvw!8Swx!9[x!`!6q!`!a!:j!a;'S!6q;'S;=`!;Y<%lO!6qq!7mV!cpOv!7hvx!8Sx!`!7h!`!a!8q!a;'S!7h;'S;=`!9U<%lO!7hP!8VTO!`!8S!`!a!8f!a;'S!8S;'S;=`!8k<%lO!8SP!8kO{PP!8nP;=`<%l!8Sq!8xS!cp{POv(Vx;'S(V;'S;=`(h<%lO(Vq!9XP;=`<%l!7ha!9aX!a`Or!9[rs!8Ssv!9[vw!8Sw!`!9[!`!a!9|!a;'S!9[;'S;=`!:d<%lO!9[a!:TT!a`{POr)esv)ew;'S)e;'S;=`)y<%lO)ea!:gP;=`<%l!9[!R!:sV!a`!cp{POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;]P;=`<%l!6qT!;ebhSOq!8Sqr!;`rs!8Ssw!;`wx!8Sx!P!;`!P!Q!8S!Q!_!;`!_!`!8S!`!a!8f!a#s!;`#s$f!8S$f;'S!;`;'S;=`!<m<%l?Ah!;`?Ah?BY!8S?BY?Mn!;`?MnO!8ST!<pP;=`<%l!;`!V!<vP;=`<%l!5]!V!=SdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#c1n#c#d!>b#d#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!>kdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#V1n#V#W!?y#W#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!@SdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#h1n#h#i!Ab#i#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!AkdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#m1n#m#n!By#n#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!CSdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#d1n#d#e!Db#e#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!DkdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#X1n#X#Y!5]#Y#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!FSchS!a`!cpOq!G_qr!Eyrs!HUsv!Eyvw!Ncwx!Jvx!P!Ey!P!Q!G_!Q!_!Ey!_!a!G_!a!b##T!b#s!Ey#s$f!G_$f;'S!Ey;'S;=`#$i<%l?Ah!Ey?Ah?BY!G_?BY?Mn!Ey?MnO!G_!R!GfY!a`!cpOr!G_rs!HUsv!G_vw!Hpwx!Jvx!a!G_!a!b!Lv!b;'S!G_;'S;=`!N]<%lO!G_q!HZV!cpOv!HUvx!Hpx!a!HU!a!b!Iq!b;'S!HU;'S;=`!Jp<%lO!HUP!HsTO!a!Hp!a!b!IS!b;'S!Hp;'S;=`!Ik<%lO!HpP!IVTO!`!Hp!`!a!If!a;'S!Hp;'S;=`!Ik<%lO!HpP!IkOxPP!InP;=`<%l!Hpq!IvV!cpOv!HUvx!Hpx!`!HU!`!a!J]!a;'S!HU;'S;=`!Jp<%lO!HUq!JdS!cpxPOv(Vx;'S(V;'S;=`(h<%lO(Vq!JsP;=`<%l!HUa!J{X!a`Or!Jvrs!Hpsv!Jvvw!Hpw!a!Jv!a!b!Kh!b;'S!Jv;'S;=`!Lp<%lO!Jva!KmX!a`Or!Jvrs!Hpsv!Jvvw!Hpw!`!Jv!`!a!LY!a;'S!Jv;'S;=`!Lp<%lO!Jva!LaT!a`xPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!LsP;=`<%l!Jv!R!L}Y!a`!cpOr!G_rs!HUsv!G_vw!Hpwx!Jvx!`!G_!`!a!Mm!a;'S!G_;'S;=`!N]<%lO!G_!R!MvV!a`!cpxPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!N`P;=`<%l!G_T!NhbhSOq!Hpqr!Ncrs!Hpsw!Ncwx!Hpx!P!Nc!P!Q!Hp!Q!_!Nc!_!a!Hp!a!b# p!b#s!Nc#s$f!Hp$f;'S!Nc;'S;=`#!}<%l?Ah!Nc?Ah?BY!Hp?BY?Mn!Nc?MnO!HpT# ubhSOq!Hpqr!Ncrs!Hpsw!Ncwx!Hpx!P!Nc!P!Q!Hp!Q!_!Nc!_!`!Hp!`!a!If!a#s!Nc#s$f!Hp$f;'S!Nc;'S;=`#!}<%l?Ah!Nc?Ah?BY!Hp?BY?Mn!Nc?MnO!HpT##QP;=`<%l!Nc!V##^chS!a`!cpOq!G_qr!Eyrs!HUsv!Eyvw!Ncwx!Jvx!P!Ey!P!Q!G_!Q!_!Ey!_!`!G_!`!a!Mm!a#s!Ey#s$f!G_$f;'S!Ey;'S;=`#$i<%l?Ah!Ey?Ah?BY!G_?BY?Mn!Ey?MnO!G_!V#$lP;=`<%l!Ey!V#$zXiS`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[oy,ay,ly,ry,ny,iy,0,1,2,3,4,5],topRules:{Document:[0,15]},dialects:{noMatch:0,selfClosing:485},tokenPrec:487});function uy(e,t){let n=Object.create(null);for(let i of e.getChildren(23)){let e=i.getChild(24),r=i.getChild(26)||i.getChild(27);e&&(n[t.read(e.from,e.to)]=r?26==r.type.id?t.read(r.from+1,r.to-1):t.read(r.from,r.to):"")}return n}function dy(e,t){let n=e.getChild(22);return n?t.read(n.from,n.to):" "}function py(e,t,n){let i;for(let r of n)if(!r.attrs||r.attrs(i||(i=uy(e.node.parent.firstChild,t))))return{parser:r.parser};return null}function fy(e=[],t=[]){let n=[],i=[],r=[],s=[];for(let t of e)("script"==t.tag?n:"style"==t.tag?i:"textarea"==t.tag?r:s).push(t);let o=t.length?Object.create(null):null;for(let e of t)(o[e.name]||(o[e.name]=[])).push(e);return Ko(((e,t)=>{let a=e.type.id;if(28==a)return py(e,t,n);if(31==a)return py(e,t,i);if(34==a)return py(e,t,r);if(20==a&&s.length){let n,i=e.node,r=i.firstChild,o=r&&dy(r,t);if(o)for(let e of s)if(e.tag==o&&(!e.attrs||e.attrs(n||(n=uy(i,t))))){let t=i.lastChild;return{parser:e.parser,overlay:[{from:r.to,to:37==t.type.id?t.from:i.to}]}}}if(o&&23==a){let n,i=e.node;if(n=i.firstChild){let e=o[t.read(n.from,n.to)];if(e)for(let n of e){if(n.tagName&&n.tagName!=dy(i.parent,t))continue;let e=i.lastChild;if(26==e.type.id){let t=e.from+1,i=e.lastChild,r=e.to-(i&&i.isError?0:1);if(r>t)return{parser:n.parser,overlay:[{from:t,to:r}]}}else if(27==e.type.id)return{parser:n.parser,overlay:[{from:e.from,to:e.to}]}}}}return null}))}var my=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],gy=new Qa({start:!1,shift:(e,t)=>3==t||4==t||306==t?e:307==t,strict:!1}),Oy=new Sa(((e,t)=>{let{next:n}=e;(125==n||-1==n||t.context)&&e.acceptToken(304)}),{contextual:!0,fallback:!0}),yy=new Sa(((e,t)=>{let n,{next:i}=e;my.indexOf(i)>-1||47==i&&(47==(n=e.peek(1))||42==n)||125!=i&&59!=i&&-1!=i&&!t.context&&e.acceptToken(303)}),{contextual:!0}),vy=new Sa(((e,t)=>{let{next:n}=e;if((43==n||45==n)&&(e.advance(),n==e.next)){e.advance();let n=!t.context&&t.canShift(1);e.acceptToken(n?1:2)}}),{contextual:!0}),by=Ua({"get set async static":hl.modifier,"for while do if else switch try catch finally return throw break continue default case":hl.controlKeyword,"in of await yield void typeof delete instanceof":hl.operatorKeyword,"let var const function class extends":hl.definitionKeyword,"import export from":hl.moduleKeyword,"with debugger as new":hl.keyword,TemplateString:hl.special(hl.string),super:hl.atom,BooleanLiteral:hl.bool,this:hl.self,null:hl.null,Star:hl.modifier,VariableName:hl.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":hl.function(hl.variableName),VariableDefinition:hl.definition(hl.variableName),Label:hl.labelName,PropertyName:hl.propertyName,PrivatePropertyName:hl.special(hl.propertyName),"CallExpression/MemberExpression/PropertyName":hl.function(hl.propertyName),"FunctionDeclaration/VariableDefinition":hl.function(hl.definition(hl.variableName)),"ClassDeclaration/VariableDefinition":hl.definition(hl.className),PropertyDefinition:hl.definition(hl.propertyName),PrivatePropertyDefinition:hl.definition(hl.special(hl.propertyName)),UpdateOp:hl.updateOperator,LineComment:hl.lineComment,BlockComment:hl.blockComment,Number:hl.number,String:hl.string,Escape:hl.escape,ArithOp:hl.arithmeticOperator,LogicOp:hl.logicOperator,BitOp:hl.bitwiseOperator,CompareOp:hl.compareOperator,RegExp:hl.regexp,Equals:hl.definitionOperator,Arrow:hl.function(hl.punctuation),": Spread":hl.punctuation,"( )":hl.paren,"[ ]":hl.squareBracket,"{ }":hl.brace,"InterpolationStart InterpolationEnd":hl.special(hl.brace),".":hl.derefOperator,", ;":hl.separator,"@":hl.meta,TypeName:hl.typeName,TypeDefinition:hl.definition(hl.typeName),"type enum interface implements namespace module declare":hl.definitionKeyword,"abstract global Privacy readonly override":hl.modifier,"is keyof unique infer":hl.operatorKeyword,JSXAttributeValue:hl.attributeValue,JSXText:hl.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":hl.angleBracket,"JSXIdentifier JSXNameSpacedName":hl.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":hl.attributeName,"JSXBuiltin/JSXIdentifier":hl.standard(hl.tagName)}),wy={__proto__:null,export:14,as:19,from:27,default:30,async:35,function:36,extends:46,this:50,true:58,false:58,null:70,void:74,typeof:78,super:96,new:130,delete:146,yield:155,await:159,class:164,public:221,private:221,protected:221,readonly:223,instanceof:242,satisfies:245,in:246,const:248,import:280,keyof:335,unique:339,infer:345,is:381,abstract:401,implements:403,type:405,let:408,var:410,using:413,interface:419,enum:423,namespace:429,module:431,declare:435,global:439,for:458,of:467,while:470,with:474,do:478,if:482,else:484,switch:488,case:494,try:500,catch:504,finally:508,return:512,throw:516,break:520,continue:524,debugger:528},xy={__proto__:null,async:117,get:119,set:121,declare:181,public:183,private:183,protected:183,static:185,abstract:187,override:189,readonly:195,accessor:197,new:385},Sy={__proto__:null,"<":137},ky=Ra.deserialize({version:14,states:"$6tO`QUOOO%TQUOOO'WQWOOP(eOSOOO*sQ(CjO'#CfO*zOpO'#CgO+YO!bO'#CgO+hO07`O'#DZO-yQUO'#DaO.ZQUO'#DlO%TQUO'#DvO0_QUO'#EOOOQ(CY'#EW'#EWO0xQSO'#ETOOQO'#Ei'#EiOOQO'#Ic'#IcO1QQSO'#GkO1]QSO'#EhO1bQSO'#EhO3dQ(CjO'#JdO6TQ(CjO'#JeO6qQSO'#FWO6vQ#tO'#FoOOQ(CY'#F`'#F`O7RO&jO'#F`O7aQ,UO'#FvO8wQSO'#FuOOQ(CY'#Je'#JeOOQ(CW'#Jd'#JdO8|QSO'#GoOOQQ'#KP'#KPO9XQSO'#IPO9^Q(C[O'#IQOOQQ'#JQ'#JQOOQQ'#IU'#IUQ`QUOOO%TQUO'#DnO9fQUO'#DzO9mQUO'#D|O9SQSO'#GkO9tQ,UO'#ClO:SQSO'#EgO:_QSO'#ErO:dQ,UO'#F_O;RQSO'#GkOOQO'#KQ'#KQO;WQSO'#KQO;fQSO'#GsO;fQSO'#GtO;fQSO'#GvO9SQSO'#GyO<]QSO'#G|O=tQSO'#CbO>UQSO'#HYO>^QSO'#H`O>^QSO'#HbO`QUO'#HdO>^QSO'#HfO>^QSO'#HiO>cQSO'#HoO>hQ(C]O'#HuO%TQUO'#HwO>sQ(C]O'#HyO?OQ(C]O'#H{O9^Q(C[O'#H}O?ZQ(CjO'#CfO@]QWO'#DfQOQSOOO%TQUO'#D|O@sQSO'#EPO9tQ,UO'#EgOAOQSO'#EgOAZQ`O'#F_OOQQ'#Cd'#CdOOQ(CW'#Dk'#DkOOQ(CW'#Jh'#JhO%TQUO'#JhOOQO'#Jl'#JlOOQO'#I`'#I`OBZQWO'#E`OOQ(CW'#E_'#E_OCVQ(C`O'#E`OCaQWO'#ESOOQO'#Jk'#JkOCuQWO'#JlOESQWO'#ESOCaQWO'#E`PEaO?MpO'#C`POOO)CDo)CDoOOOO'#IV'#IVOElOpO,59ROOQ(CY,59R,59ROOOO'#IW'#IWOEzO!bO,59RO%TQUO'#D]OOOO'#IY'#IYOFYO07`O,59uOOQ(CY,59u,59uOFhQUO'#IZOF{QSO'#JfOH}QbO'#JfO+vQUO'#JfOIUQSO,59{OIlQSO'#EiOIyQSO'#JtOJUQSO'#JsOJUQSO'#JsOJ^QSO,5;VOJcQSO'#JrOOQ(CY,5:W,5:WOJjQUO,5:WOLkQ(CjO,5:bOM[QSO,5:jOMuQ(C[O'#JqOM|QSO'#JpO8|QSO'#JpONbQSO'#JpONjQSO,5;UONoQSO'#JpO!!wQbO'#JeOOQ(CY'#Cf'#CfO%TQUO'#EOO!#gQ`O,5:oOOQO'#Jm'#JmOOQO-E<a-E<aO9SQSO,5=VO!#}QSO,5=VO!$SQUO,5;SO!&VQ,UO'#EdO!'jQSO,5;SO!)SQ,UO'#DpO!)ZQUO'#DuO!)eQWO,5;]O!)mQWO,5;]O%TQUO,5;]OOQQ'#FO'#FOOOQQ'#FQ'#FQO%TQUO,5;^O%TQUO,5;^O%TQUO,5;^O%TQUO,5;^O%TQUO,5;^O%TQUO,5;^O%TQUO,5;^O%TQUO,5;^O%TQUO,5;^O%TQUO,5;^O%TQUO,5;^OOQQ'#FU'#FUO!){QUO,5;oOOQ(CY,5;t,5;tOOQ(CY,5;u,5;uO!,OQSO,5;uOOQ(CY,5;v,5;vO%TQUO'#IgO!,WQ(C[O,5<cO!&VQ,UO,5;^O!,uQ,UO,5;^O%TQUO,5;rO!,|Q#tO'#FeO!-yQ#tO'#JxO!-eQ#tO'#JxO!.QQ#tO'#JxOOQO'#Jx'#JxO!.fQ#tO,5;}OOOO,5<Z,5<ZO!.wQUO'#FqOOOO'#If'#IfO7RO&jO,5;zO!/OQ#tO'#FsOOQ(CY,5;z,5;zO!/oQ7[O'#CrOOQ(CY'#Cv'#CvO!0SQSO'#CvO!0XO07`O'#CzO!0uQ,UO,5<`O!0|QSO,5<bO!2cQMhO'#GQO!2pQSO'#GRO!2uQSO'#GRO!2zQMhO'#GVO!3yQWO'#GZO!4lQ7[O'#J_OOQ(CY'#J_'#J_O!4vQSO'#J^O!5UQSO'#J]O!5^QSO'#CqOOQ(CY'#Ct'#CtOOQ(CY'#DO'#DOOOQ(CY'#DQ'#DQO0{QSO'#DSO!'oQ,UO'#FxO!'oQ,UO'#FzO!5fQSO'#F|O!5kQSO'#F}O!2uQSO'#GTO!'oQ,UO'#GYO!5pQSO'#EjO!6_QSO,5<aOOQ(CW'#Co'#CoO!6gQSO'#EkO!7aQWO'#ElOOQ(CW'#Jr'#JrO!7hQ(C[O'#KRO9^Q(C[O,5=ZO`QUO,5>kOOQQ'#JY'#JYOOQQ,5>l,5>lOOQQ-E<S-E<SO!9jQ(CjO,5:YO!<WQ(CjO,5:fO%TQUO,5:fO!>qQ(CjO,5:hOOQO,5@l,5@lO!?bQ,UO,5=VO!?pQ(C[O'#JZO8wQSO'#JZO!@RQ(C[O,59WO!@^QWO,59WO!@fQ,UO,59WO9tQ,UO,59WO!@qQSO,5;SO!@yQSO'#HXO!A[QSO'#KUO%TQUO,5;wO!7[QWO,5;yO!AdQSO,5=rO!AiQSO,5=rO!AnQSO,5=rO9^Q(C[O,5=rO;fQSO,5=bOOQO'#Cr'#CrO!A|QWO,5=_O!BUQ,UO,5=`O!BaQSO,5=bO!BfQ`O,5=eO!BnQSO'#KQO>cQSO'#HOO9SQSO'#HQO!BsQSO'#HQO9tQ,UO'#HSO!BxQSO'#HSOOQQ,5=h,5=hO!B}QSO'#HTO!CVQSO'#ClO!C[QSO,58|O!CfQSO,58|O!EkQUO,58|OOQQ,58|,58|O!E{Q(C[O,58|O%TQUO,58|O!HWQUO'#H[OOQQ'#H]'#H]OOQQ'#H^'#H^O`QUO,5=tO!HnQSO,5=tO`QUO,5=zO`QUO,5=|O!HsQSO,5>OO`QUO,5>QO!HxQSO,5>TO!H}QUO,5>ZOOQQ,5>a,5>aO%TQUO,5>aO9^Q(C[O,5>cOOQQ,5>e,5>eO!MXQSO,5>eOOQQ,5>g,5>gO!MXQSO,5>gOOQQ,5>i,5>iO!M^QWO'#DXO%TQUO'#JhO!M{QWO'#JhO!NjQWO'#DgO!N{QWO'#DgO##^QUO'#DgO##eQSO'#JgO##mQSO,5:QO##rQSO'#EmO#$QQSO'#JuO#$YQSO,5;WO#$_QWO'#DgO#$lQWO'#EROOQ(CY,5:k,5:kO%TQUO,5:kO#$sQSO,5:kO>cQSO,5;RO!@^QWO,5;RO!@fQ,UO,5;RO9tQ,UO,5;RO#${QSO,5@SO#%QQ!LQO,5:oOOQO-E<^-E<^O#&WQ(C`O,5:zOCaQWO,5:nO#&bQWO,5:nOCaQWO,5:zO!@RQ(C[O,5:nOOQ(CW'#Ec'#EcOOQO,5:z,5:zO%TQUO,5:zO#&oQ(C[O,5:zO#&zQ(C[O,5:zO!@^QWO,5:nOOQO,5;Q,5;QO#'YQ(C[O,5:zPOOO'#IT'#ITP#'nO?MpO,58zPOOO,58z,58zOOOO-E<T-E<TOOQ(CY1G.m1G.mOOOO-E<U-E<UO#'yQ`O,59wOOOO-E<W-E<WOOQ(CY1G/a1G/aO#(OQbO,5>uO+vQUO,5>uOOQO,5>{,5>{O#(YQUO'#IZOOQO-E<X-E<XO#(gQSO,5@QO#(oQbO,5@QO#(vQSO,5@_OOQ(CY1G/g1G/gO%TQUO,5@`O#)OQSO'#IaOOQO-E<_-E<_O#(vQSO,5@_OOQ(CW1G0q1G0qOOQ(CY1G/r1G/rOOQ(CY1G0U1G0UO%TQUO,5@]O#)dQ(C[O,5@]O#)uQ(C[O,5@]O#)|QSO,5@[O8|QSO,5@[O#*UQSO,5@[O#*dQSO'#IdO#)|QSO,5@[OOQ(CW1G0p1G0pO!)eQWO,5:qO!)pQWO,5:qOOQO,5:s,5:sO#+UQSO,5:sO#+^Q,UO1G2qO9SQSO1G2qOOQ(CY1G0n1G0nO#+lQ(CjO1G0nO#,qQ(ChO,5;OOOQ(CY'#GP'#GPO#-_Q(CjO'#J_O!$SQUO1G0nO#/gQ,UO'#JiO#/qQSO,5:[O#/vQbO'#JjO%TQUO'#JjO#0QQSO,5:aOOQ(CY'#DX'#DXOOQ(CY1G0w1G0wO%TQUO1G0wOOQ(CY1G1a1G1aO#0VQSO1G0wO#2nQ(CjO1G0xO#2uQ(CjO1G0xO#5`Q(CjO1G0xO#5gQ(CjO1G0xO#7qQ(CjO1G0xO#8XQ(CjO1G0xO#;RQ(CjO1G0xO#;YQ(CjO1G0xO#=sQ(CjO1G0xO#=zQ(CjO1G0xO#?rQ(CjO1G0xO#BrQ$IUO'#CfO#DpQ$IUO1G1ZO#DwQ$IUO'#JeO!,RQSO1G1aO#EXQ(CjO,5?ROOQ(CW-E<e-E<eO#E{Q(CjO1G0xOOQ(CY1G0x1G0xO#HWQ(CjO1G1^O#HzQ#tO,5<RO#ISQ#tO,5<SO#I[Q#tO'#FjO#IsQSO'#FiOOQO'#Jy'#JyOOQO'#Ie'#IeO#IxQ#tO1G1iOOQ(CY1G1i1G1iOOOO1G1t1G1tO#JZQ$IUO'#JdO#JeQSO,5<]O!){QUO,5<]OOOO-E<d-E<dOOQ(CY1G1f1G1fO#JjQWO'#JxOOQ(CY,5<_,5<_O#JrQWO,5<_OOQ(CY,59b,59bO!&VQ,UO'#C|OOOO'#IX'#IXO#JwO07`O,59fOOQ(CY,59f,59fO%TQUO1G1zO!5kQSO'#IiO#KSQSO,5<sOOQ(CY,5<p,5<pOOQO'#Gf'#GfO!'oQ,UO,5=POOQO'#Gh'#GhO!'oQ,UO,5=RO!&VQ,UO,5=TOOQO1G1|1G1|O#KbQ`O'#CoO#KuQ`O,5<lO#K|QSO'#J|O9SQSO'#J|O#L[QSO,5<nO!'oQ,UO,5<mO#LaQSO'#GSO#LlQSO,5<mO#LqQ`O'#GPO#MOQ`O'#J}O#MYQSO'#J}O!&VQ,UO'#J}O#M_QSO,5<qO#MdQWO'#G[O!3tQWO'#G[O#MuQSO'#G^O#MzQSO'#G`O!2uQSO'#GcO#NPQ(C[O'#IkO#N[QWO,5<uOOQ(CY,5<u,5<uO#NcQWO'#G[O#NqQWO'#G]O#NyQWO'#G]OOQ(CY,5=U,5=UO!'oQ,UO,5?xO!'oQ,UO,5?xO$ OQSO'#IlO$ ZQSO,5?wO$ cQSO,59]O$!SQ,UO,59nOOQ(CY,59n,59nO$!uQ,UO,5<dO$#hQ,UO,5<fO@TQSO,5<hOOQ(CY,5<i,5<iO$#rQSO,5<oO$#wQ,UO,5<tO$$XQSO'#JpO!$SQUO1G1{O$$^QSO1G1{O8|QSO'#JsO8|QSO'#EmO%TQUO'#EmO8|QSO'#InO$$cQ(C[O,5@mOOQQ1G2u1G2uOOQQ1G4V1G4VOOQ(CY1G/t1G/tO!,OQSO1G/tO$&hQ(CjO1G0QOOQQ1G2q1G2qO!&VQ,UO1G2qO%TQUO1G2qO$'XQSO1G2qO$'dQ,UO'#EdOOQ(CW,5?u,5?uO$'nQ(C[O,5?uOOQQ1G.r1G.rO!@RQ(C[O1G.rO!@^QWO1G.rO!@fQ,UO1G.rO$(PQSO1G0nO$(UQSO'#CfO$(aQSO'#KVO$(iQSO,5=sO$(nQSO'#KVO$(sQSO'#KVO$)OQSO'#ItO$)^QSO,5@pO$)fQbO1G1cOOQ(CY1G1e1G1eO9SQSO1G3^O@TQSO1G3^O$)mQSO1G3^O$)rQSO1G3^OOQQ1G3^1G3^O!BaQSO1G2|O!&VQ,UO1G2yO$)wQSO1G2yOOQQ1G2z1G2zO!&VQ,UO1G2zO$)|QSO1G2zO$*UQWO'#GxOOQQ1G2|1G2|O!3tQWO'#IpO!BfQ`O1G3POOQQ1G3P1G3POOQQ,5=j,5=jO$*^Q,UO,5=lO9SQSO,5=lO#MzQSO,5=nO8wQSO,5=nO!@^QWO,5=nO!@fQ,UO,5=nO9tQ,UO,5=nO$*lQSO'#KTO$*wQSO,5=oOOQQ1G.h1G.hO$*|Q(C[O1G.hO@TQSO1G.hO$+XQSO1G.hO9^Q(C[O1G.hO$-^QbO,5@rO$-nQSO,5@rO8|QSO,5@rO$-yQUO,5=vO$.QQSO,5=vOOQQ1G3`1G3`O`QUO1G3`OOQQ1G3f1G3fOOQQ1G3h1G3hO>^QSO1G3jO$.VQUO1G3lO$2ZQUO'#HkOOQQ1G3o1G3oO$2hQSO'#HqO>cQSO'#HsOOQQ1G3u1G3uO$2pQUO1G3uO9^Q(C[O1G3{OOQQ1G3}1G3}OOQ(CW'#GW'#GWO9^Q(C[O1G4PO9^Q(C[O1G4RO$6wQSO,5@SO!){QUO,5;XO8|QSO,5;XO>cQSO,5:RO!){QUO,5:RO!@^QWO,5:RO$6|Q$IUO,5:ROOQO,5;X,5;XO$7WQWO'#I[O$7nQSO,5@ROOQ(CY1G/l1G/lO$7vQWO'#IbO$8QQSO,5@aOOQ(CW1G0r1G0rO!N{QWO,5:ROOQO'#I_'#I_O$8YQWO,5:mOOQ(CY,5:m,5:mO#$vQSO1G0VOOQ(CY1G0V1G0VO%TQUO1G0VOOQ(CY1G0m1G0mO>cQSO1G0mO!@^QWO1G0mO!@fQ,UO1G0mOOQ(CW1G5n1G5nO!@RQ(C[O1G0YOOQO1G0f1G0fO%TQUO1G0fO$8aQ(C[O1G0fO$8lQ(C[O1G0fO!@^QWO1G0YOCaQWO1G0YO$8zQ(C[O1G0fOOQO1G0Y1G0YO$9`Q(CjO1G0fPOOO-E<R-E<RPOOO1G.f1G.fOOOO1G/c1G/cO$9jQ`O,5<cO$9rQbO1G4aOOQO1G4g1G4gO%TQUO,5>uO$9|QSO1G5lO$:UQSO1G5yO$:^QbO1G5zO8|QSO,5>{O$:hQ(CjO1G5wO%TQUO1G5wO$:xQ(C[O1G5wO$;ZQSO1G5vO$;ZQSO1G5vO8|QSO1G5vO$;cQSO,5?OO8|QSO,5?OOOQO,5?O,5?OO$;wQSO,5?OO$$XQSO,5?OOOQO-E<b-E<bOOQO1G0]1G0]OOQO1G0_1G0_O!,RQSO1G0_OOQQ7+(]7+(]O!&VQ,UO7+(]O%TQUO7+(]O$<VQSO7+(]O$<bQ,UO7+(]O$<pQ(CjO,59nO$>xQ(CjO,5<dO$ATQ(CjO,5<fO$C`Q(CjO,5<tOOQ(CY7+&Y7+&YO$EqQ(CjO7+&YO$FeQ,UO'#I]O$FoQSO,5@TOOQ(CY1G/v1G/vO$FwQUO'#I^O$GUQSO,5@UO$G^QbO,5@UOOQ(CY1G/{1G/{O$GhQSO7+&cOOQ(CY7+&c7+&cO$GmQ$IUO,5:bO%TQUO7+&uO$GwQ$IUO,5:YO$HUQ$IUO,5:fO$H`Q$IUO,5:hOOQ(CY7+&{7+&{OOQO1G1m1G1mOOQO1G1n1G1nO$HjQ#tO,5<UO!){QUO,5<TOOQO-E<c-E<cOOQ(CY7+'T7+'TOOOO7+'`7+'`OOOO1G1w1G1wO$HuQSO1G1wOOQ(CY1G1y1G1yO$HzQ`O,59hOOOO-E<V-E<VOOQ(CY1G/Q1G/QO$IRQ(CjO7+'fOOQ(CY,5?T,5?TO$IuQSO,5?TOOQ(CY1G2_1G2_P$IzQSO'#IiPOQ(CY-E<g-E<gO$JnQ,UO1G2kO$KaQ,UO1G2mO$KkQ`O1G2oOOQ(CY1G2W1G2WO$KrQSO'#IhO$LQQSO,5@hO$LQQSO,5@hO$LYQSO,5@hO$LeQSO,5@hOOQO1G2Y1G2YO$LsQ,UO1G2XO!'oQ,UO1G2XO$MTQMhO'#IjO$MeQSO,5@iO!&VQ,UO,5@iO$MmQ`O,5@iOOQ(CY1G2]1G2]OOQ(CW,5<v,5<vOOQ(CW,5<w,5<wO$$XQSO,5<wOCQQSO,5<wO!@^QWO,5<vOOQO'#G_'#G_O$MwQSO,5<xOOQ(CW,5<z,5<zO$$XQSO,5<}OOQO,5?V,5?VOOQO-E<i-E<iOOQ(CY1G2a1G2aO!3tQWO,5<vO$NPQSO,5<wO#MuQSO,5<xO!3tQWO,5<wO$N[Q,UO1G5dO$NfQ,UO1G5dOOQO,5?W,5?WOOQO-E<j-E<jOOQO1G.w1G.wO!7[QWO,59pO%TQUO,59pO$NsQSO1G2SO!'oQ,UO1G2ZO$NxQ(CjO7+'gOOQ(CY7+'g7+'gO!$SQUO7+'gO% lQSO,5;XOOQ(CW,5?Y,5?YOOQ(CW-E<l-E<lOOQ(CY7+%`7+%`O% qQ`O'#KOO#$vQSO7+(]O% {QbO7+(]O$<YQSO7+(]O%!SQ(ChO'#CfO%!gQ(ChO,5<{O%#XQSO,5<{OOQ(CW1G5a1G5aOOQQ7+$^7+$^O!@RQ(C[O7+$^O!@^QWO7+$^O!$SQUO7+&YO%#^QSO'#IsO%#rQSO,5@qOOQO1G3_1G3_O9SQSO,5@qO%#rQSO,5@qO%#zQSO,5@qOOQO,5?`,5?`OOQO-E<r-E<rOOQ(CY7+&}7+&}O%$PQSO7+(xO9^Q(C[O7+(xO9SQSO7+(xO@TQSO7+(xOOQQ7+(h7+(hO%$UQ(ChO7+(eO!&VQ,UO7+(eO%$`Q`O7+(fOOQQ7+(f7+(fO!&VQ,UO7+(fO%$gQSO'#KSO%$rQSO,5=dOOQO,5?[,5?[OOQO-E<n-E<nOOQQ7+(k7+(kO%&RQWO'#HROOQQ1G3W1G3WO!&VQ,UO1G3WO%TQUO1G3WO%&YQSO1G3WO%&eQ,UO1G3WO9^Q(C[O1G3YO#MzQSO1G3YO8wQSO1G3YO!@^QWO1G3YO!@fQ,UO1G3YO%&sQSO'#IrO%'OQSO,5@oO%'WQWO,5@oOOQ(CW1G3Z1G3ZOOQQ7+$S7+$SO@TQSO7+$SO9^Q(C[O7+$SO%'cQSO7+$SO%TQUO1G6^O%TQUO1G6_O%'hQ(C[O1G6^O%'rQUO1G3bO%'yQSO1G3bO%(OQUO1G3bOOQQ7+(z7+(zO9^Q(C[O7+)UO`QUO7+)WOOQQ'#KY'#KYOOQQ'#Iu'#IuO%(VQUO,5>VOOQQ,5>V,5>VO%TQUO'#HlO%(dQSO'#HnOOQQ,5>],5>]O8|QSO,5>]OOQQ,5>_,5>_OOQQ7+)a7+)aOOQQ7+)g7+)gOOQQ7+)k7+)kOOQQ7+)m7+)mO%(iQWO1G5nO%(}Q$IUO1G0sO%)XQSO1G0sOOQO1G/m1G/mO%)dQ$IUO1G/mO>cQSO1G/mO!){QUO'#DgOOQO,5>v,5>vOOQO-E<Y-E<YOOQO,5>|,5>|OOQO-E<`-E<`O!@^QWO1G/mOOQO-E<]-E<]OOQ(CY1G0X1G0XOOQ(CY7+%q7+%qO#$vQSO7+%qOOQ(CY7+&X7+&XO>cQSO7+&XO!@^QWO7+&XOOQO7+%t7+%tO$9`Q(CjO7+&QOOQO7+&Q7+&QO%TQUO7+&QO%)nQ(C[O7+&QO!@RQ(C[O7+%tO!@^QWO7+%tO%)yQ(C[O7+&QO%*XQ(CjO7++cO%TQUO7++cO%*iQSO7++bO%*iQSO7++bOOQO1G4j1G4jO8|QSO1G4jO%*qQSO1G4jOOQO7+%y7+%yO#$vQSO<<KwO% {QbO<<KwO%+PQSO<<KwOOQQ<<Kw<<KwO!&VQ,UO<<KwO%TQUO<<KwO%+XQSO<<KwO%+dQ(CjO1G2kO%-oQ(CjO1G2mO%/zQ(CjO1G2XO%2]Q,UO,5>wOOQO-E<Z-E<ZO%2gQbO,5>xO%TQUO,5>xOOQO-E<[-E<[O%2qQSO1G5pOOQ(CY<<I}<<I}O%2yQ$IUO1G0nO%5TQ$IUO1G0xO%5[Q$IUO1G0xO%7`Q$IUO1G0xO%7gQ$IUO1G0xO%9[Q$IUO1G0xO%9rQ$IUO1G0xO%<VQ$IUO1G0xO%<^Q$IUO1G0xO%>bQ$IUO1G0xO%>iQ$IUO1G0xO%@aQ$IUO1G0xO%@tQ(CjO<<JaO%AyQ$IUO1G0xO%CoQ$IUO'#J_O%ErQ$IUO1G1^O%FPQ$IUO1G0QO!){QUO'#FlOOQO'#Jz'#JzOOQO1G1p1G1pO%FZQSO1G1oO%F`Q$IUO,5?ROOOO7+'c7+'cOOOO1G/S1G/SOOQ(CY1G4o1G4oO!'oQ,UO7+(ZO%FjQSO,5?SO9SQSO,5?SOOQO-E<f-E<fO%FxQSO1G6SO%FxQSO1G6SO%GQQSO1G6SO%G]Q,UO7+'sO%GmQ`O,5?UO%GwQSO,5?UO!&VQ,UO,5?UOOQO-E<h-E<hO%G|Q`O1G6TO%HWQSO1G6TOOQ(CW1G2c1G2cO$$XQSO1G2cOOQ(CW1G2b1G2bO%H`QSO1G2dO!&VQ,UO1G2dOOQ(CW1G2i1G2iO!@^QWO1G2bOCQQSO1G2cO%HeQSO1G2dO%HmQSO1G2cO!'oQ,UO7++OOOQ(CY1G/[1G/[O%HxQSO1G/[OOQ(CY7+'n7+'nO%H}Q,UO7+'uO%I_Q(CjO<<KROOQ(CY<<KR<<KRO%JRQSO1G0sO!&VQ,UO'#ImO%JWQSO,5@jO!&VQ,UO1G2gOOQQ<<Gx<<GxO!@RQ(C[O<<GxO%J`Q(CjO<<ItOOQ(CY<<It<<ItOOQO,5?_,5?_O%KSQSO,5?_O$(sQSO,5?_OOQO-E<q-E<qO%KXQSO1G6]O%KXQSO1G6]O9SQSO1G6]O@TQSO<<LdOOQQ<<Ld<<LdO%KaQSO<<LdO9^Q(C[O<<LdOOQQ<<LP<<LPO%$UQ(ChO<<LPOOQQ<<LQ<<LQO%$`Q`O<<LQO%KfQWO'#IoO%KqQSO,5@nO!){QUO,5@nOOQQ1G3O1G3OO%KyQUO'#JhOOQO'#Iq'#IqO9^Q(C[O'#IqO%LTQWO,5=mOOQQ,5=m,5=mO%L[QWO'#E`O%LpQSO7+(rO%LuQSO7+(rOOQQ7+(r7+(rO!&VQ,UO7+(rO%TQUO7+(rO%L}QSO7+(rOOQQ7+(t7+(tO9^Q(C[O7+(tO#MzQSO7+(tO8wQSO7+(tO!@^QWO7+(tO%MYQSO,5?^OOQO-E<p-E<pOOQO'#HU'#HUO%MeQSO1G6ZO9^Q(C[O<<GnOOQQ<<Gn<<GnO@TQSO<<GnO%MmQSO7++xO%MrQSO7++yO%TQUO7++xO%TQUO7++yOOQQ7+(|7+(|O%MwQSO7+(|O%M|QUO7+(|O%NTQSO7+(|OOQQ<<Lp<<LpOOQQ<<Lr<<LrOOQQ-E<s-E<sOOQQ1G3q1G3qO%NYQSO,5>WOOQQ,5>Y,5>YO%N_QSO1G3wO8|QSO7+&_O!){QUO7+&_OOQO7+%X7+%XO%NdQ$IUO1G5zO>cQSO7+%XOOQ(CY<<I]<<I]OOQ(CY<<Is<<IsO>cQSO<<IsOOQO<<Il<<IlO$9`Q(CjO<<IlO%TQUO<<IlOOQO<<I`<<I`O!@RQ(C[O<<I`O%NnQ(C[O<<IlO%NyQ(CjO<<N}O& ZQSO<<N|OOQO7+*U7+*UO8|QSO7+*UOOQQANAcANAcO& cQSOANAcO!&VQ,UOANAcO#$vQSOANAcO% {QbOANAcO%TQUOANAcO& kQ(CjO7+'sO&#|Q(CjO7+'uO&&_QbO1G4dO&&iQ$IUO7+&YO&&vQ$IUO,59nO&(yQ$IUO,5<dO&*|Q$IUO,5<fO&-PQ$IUO,5<tO&.uQ$IUO7+'fO&/SQ$IUO7+'gO&/aQSO,5<WOOQO7+'Z7+'ZO&/fQ,UO<<KuOOQO1G4n1G4nO&/mQSO1G4nO&/xQSO1G4nO&0WQSO7++nO&0WQSO7++nO!&VQ,UO1G4pO&0`Q`O1G4pO&0jQSO7++oOOQ(CW7+'}7+'}O$$XQSO7+(OO&0rQ`O7+(OOOQ(CW7+'|7+'|O$$XQSO7+'}O&0yQSO7+(OO!&VQ,UO7+(OOCQQSO7+'}O&1OQ,UO<<NjOOQ(CY7+$v7+$vO&1YQ`O,5?XOOQO-E<k-E<kO&1dQ(ChO7+(ROOQQAN=dAN=dO9SQSO1G4yOOQO1G4y1G4yO&1tQSO1G4yO&1yQSO7++wO&1yQSO7++wO9^Q(C[OANBOO@TQSOANBOOOQQANBOANBOOOQQANAkANAkOOQQANAlANAlO&2RQSO,5?ZOOQO-E<m-E<mO&2^Q$IUO1G6YO&4nQbO'#CfOOQO,5?],5?]OOQO-E<o-E<oOOQQ1G3X1G3XO%KyQUO,5<xOOQQ<<L^<<L^O!&VQ,UO<<L^O%LpQSO<<L^O&4xQSO<<L^O%TQUO<<L^OOQQ<<L`<<L`O9^Q(C[O<<L`O#MzQSO<<L`O8wQSO<<L`O&5QQWO1G4xO&5]QSO7++uOOQQAN=YAN=YO9^Q(C[OAN=YOOQQ<= d<= dOOQQ<= e<= eO&5eQSO<= dO&5jQSO<= eOOQQ<<Lh<<LhO&5oQSO<<LhO&5tQUO<<LhOOQQ1G3r1G3rO>cQSO7+)cO&5{QSO<<IyO&6WQ$IUO<<IyOOQO<<Hs<<HsOOQ(CYAN?_AN?_OOQOAN?WAN?WO$9`Q(CjOAN?WOOQOAN>zAN>zO%TQUOAN?WOOQO<<Mp<<MpOOQQG26}G26}O!&VQ,UOG26}O#$vQSOG26}O&6bQSOG26}O% {QbOG26}O&6jQ$IUO<<JaO&6wQ$IUO1G2XO&8mQ$IUO1G2kO&:pQ$IUO1G2mO&<sQ$IUO<<KRO&=QQ$IUO<<ItOOQO1G1r1G1rO!'oQ,UOANAaOOQO7+*Y7+*YO&=_QSO7+*YO&=jQSO<= YO&=rQ`O7+*[OOQ(CW<<Kj<<KjO$$XQSO<<KjOOQ(CW<<Ki<<KiO&=|Q`O<<KjO$$XQSO<<KiOOQO7+*e7+*eO9SQSO7+*eO&>TQSO<= cOOQQG27jG27jO9^Q(C[OG27jO!){QUO1G4uO&>]QSO7++tO%LpQSOANAxOOQQANAxANAxO!&VQ,UOANAxO&>eQSOANAxOOQQANAzANAzO9^Q(C[OANAzO#MzQSOANAzOOQO'#HV'#HVOOQO7+*d7+*dOOQQG22tG22tOOQQANEOANEOOOQQANEPANEPOOQQANBSANBSO&>mQSOANBSOOQQ<<L}<<L}O!){QUOAN?eOOQOG24rG24rO$9`Q(CjOG24rO#$vQSOLD,iOOQQLD,iLD,iO!&VQ,UOLD,iO&>rQSOLD,iO&>zQ$IUO7+'sO&@pQ$IUO7+'uO&BfQ,UOG26{OOQO<<Mt<<MtOOQ(CWANAUANAUO$$XQSOANAUOOQ(CWANATANATOOQO<<NP<<NPOOQQLD-ULD-UO&BvQ$IUO7+*aOOQQG27dG27dO%LpQSOG27dO!&VQ,UOG27dOOQQG27fG27fO9^Q(C[OG27fOOQQG27nG27nO&CQQ$IUOG25POOQOLD*^LD*^OOQQ!$(!T!$(!TO#$vQSO!$(!TO!&VQ,UO!$(!TO&C[Q(CjOG26{OOQ(CWG26pG26pOOQQLD-OLD-OO%LpQSOLD-OOOQQLD-QLD-QOOQQ!)9Eo!)9EoO#$vQSO!)9EoOOQQ!$(!j!$(!jOOQQ!.K;Z!.K;ZO&EmQ$IUOG26{O!){QUO'#DvO0xQSO'#ETO&GcQbO'#JdO!){QUO'#DnO&GjQUO'#DzO&GqQbO'#CfO&JXQbO'#CfO!){QUO'#D|O&JiQUO,5;SO!){QUO,5;^O!){QUO,5;^O!){QUO,5;^O!){QUO,5;^O!){QUO,5;^O!){QUO,5;^O!){QUO,5;^O!){QUO,5;^O!){QUO,5;^O!){QUO,5;^O!){QUO,5;^O!){QUO'#IgO&LlQSO,5<cO&LtQ,UO,5;^O&NXQ,UO,5;^O!){QUO,5;rO0{QSO'#DSO0{QSO'#DSO!&VQ,UO'#FxO&LtQ,UO'#FxO!&VQ,UO'#FzO&LtQ,UO'#FzO!&VQ,UO'#GYO&LtQ,UO'#GYO!){QUO,5:fO!){QUO,5@`O&JiQUO1G0nO&N`Q$IUO'#CfO!){QUO1G1zO!&VQ,UO,5=PO&LtQ,UO,5=PO!&VQ,UO,5=RO&LtQ,UO,5=RO!&VQ,UO,5<mO&LtQ,UO,5<mO&JiQUO1G1{O!){QUO7+&uO!&VQ,UO1G2XO&LtQ,UO1G2XO!&VQ,UO1G2ZO&LtQ,UO1G2ZO&JiQUO7+'gO&JiQUO7+&YO!&VQ,UOANAaO&LtQ,UOANAaO&NjQSO'#EhO&NoQSO'#EhO&NwQSO'#FWO&N|QSO'#ErO' RQSO'#JtO' ^QSO'#JrO' iQSO,5;SO' nQ,UO,5<`O' uQSO'#GRO' zQSO'#GRO'!PQSO,5<aO'!XQSO,5;SO'!aQ$IUO1G1ZO'!hQSO,5<mO'!mQSO,5<mO'!rQSO,5<oO'!wQSO,5<oO'!|QSO1G1{O'#RQSO1G0nO'#WQ,UO<<KuO'#_Q,UO<<KuO7aQ,UO'#FvO8wQSO'#FuOAOQSO'#EgO!){QUO,5;oO!2uQSO'#GRO!2uQSO'#GRO!2uQSO'#GTO!2uQSO'#GTO!'oQ,UO7+(ZO!'oQ,UO7+(ZO$KkQ`O1G2oO$KkQ`O1G2oO!&VQ,UO,5=TO!&VQ,UO,5=T",stateData:"'$h~O'nOS'oOSROS'pRQ~OPYOQYOV!UO^qOayObxOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!XXO!ctO!hZO!kYO!lYO!mYO!ouO!qvO!twO!x]O#p!OO$Q{O$UfO%`|O%b!PO%d}O%e}O%f}O%i!QO%k!RO%n!SO%o!SO%q!TO%}!VO&T!WO&V!XO&X!YO&Z!ZO&^![O&d!]O&j!^O&l!_O&n!`O&p!aO&r!bO'uSO'wTO'zUO(SVO(b[O(oiO~OPYOQYOa!iOb!hOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!X!dO!ctO!hZO!kYO!lYO!mYO!ouO!q!fO!t!gO$Q!jO$UfO'u!cO'wTO'zUO(SVO(b[O(oiO~O^!uOl!mO|!nO![!wO!]!tO!^!tO!x9qO!|!oO!}!oO#O!vO#P!oO#Q!oO#T!xO#U!xO'v!kO'wTO'zUO(V!lO(b!rO~O'p!yO~OPYXXYX^YXkYXyYXzYX|YX!VYX!eYX!fYX!hYX!lYX#XYX#dcX#gYX#hYX#iYX#jYX#kYX#lYX#mYX#nYX#oYX#qYX#sYX#uYX#vYX#{YX'lYX(SYX(cYX(jYX(kYX~O!a$zX~P(jO[!{O'w!}O'x!{O'y!}O~O[#OO'y!}O'z!}O'{#OO~Oq#QO!O#RO(T#RO(U#TO~OPYOQYOa!iOb!hOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!X!dO!ctO!hZO!kYO!lYO!mYO!ouO!q!fO!t!gO$Q!jO$UfO'u9uO'wTO'zUO(SVO(b[O(oiO~O!U#XO!V#UO!S(YP!S(gP~P+vO!W#aO~P`OPYOQYOa!iOb!hOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!X!dO!ctO!hZO!kYO!lYO!mYO!ouO!q!fO!t!gO$Q!jO$UfO'wTO'zUO(SVO(b[O(oiO~Oi#kO!U#gO!x]O#b#jO#c#gO'u9vO!g(dP~P.bO!h#mO'u#lO~O!t#qO!x]O%`#rO~O#d#sO~O!a#tO#d#sO~OP$[OX$cOk$POy#xOz#yO|#zO!V$`O!e$RO!f#vO!h#wO!l$[O#g#}O#h$OO#i$OO#j$OO#k$QO#l$RO#m$RO#n$bO#o$RO#q$SO#s$UO#u$WO#v$XO(SVO(c$YO(j#{O(k#|O~O^(WX'l(WX'j(WX!g(WX!S(WX!X(WX%a(WX!a(WX~P1jO#X$dO#{$dOP(XXX(XXk(XXy(XXz(XX|(XX!V(XX!e(XX!h(XX!l(XX#g(XX#h(XX#i(XX#j(XX#k(XX#l(XX#m(XX#n(XX#o(XX#q(XX#s(XX#u(XX#v(XX(S(XX(c(XX(j(XX(k(XX!X(XX%a(XX~O^(XX!f(XX'l(XX'j(XX!S(XX!g(XXo(XX!a(XX~P4QO#X$dO~O$W$fO$Y$eO$a$kO~O!X$lO$UfO$d$mO$f$oO~Oi%ROk$sOl$rOm$rOs%SOu%TOw%UO|$zO!X${O!c%ZO!h$wO#c%[O$Q%XO$m%VO$o%WO$r%YO'u$qO'wTO'zUO(O%QO(S$tOd(PP~O!h%]O~O|%`O!X%aO'u%_O~O!a%eO~O^%fO'l%fO~O'v!kO~P%TO%f%mO~P%TO!h%]O'u%_O'v!kO(O%QO~Ob%tO!h%]O'u%_O~O#o$RO~Oy%yO!X%vO!h%xO%b%|O'u%_O'v!kO'wTO'zUO](xP~O!t#qO~O%k&OO|(tX!X(tX'u(tX~O'u&PO~O!q&UO#p!OO%b!PO%d}O%e}O%f}O%i!QO%k!RO%n!SO%o!SO~Oa&ZOb&YO!t&WO%`&XO%s&VO~P;kOa&^ObxO!X&]O!q&UO!twO!x]O#p!OO%`|O%d}O%e}O%f}O%i!QO%k!RO%n!SO%o!SO%q!TO~O_&aO#X&dO%b&_O'v!kO~P<pO!h&eO!q&iO~O!h#mO~O!XXO~O^%fO'k&qO'l%fO~O^%fO'k&tO'l%fO~O^%fO'k&vO'l%fO~O'jYX!SYXoYX!gYX&RYX!XYX%aYX!aYX~P(jO!['TO!]&|O!^&|O'v!kO'wTO'zUO~Ol&zO|&yO!U&}O(V&xO!W(ZP!W(iP~P?wOg'WO!X'UO'u%_O~Ob']O!h%]O'u%_O~Oy%yO!h%xO~Ol!mO|!nO!x9qO!|!oO!}!oO#P!oO#Q!oO'v!kO'wTO'zUO(V!lO(b!rO~O!['cO!]'bO!^'bO#O!oO#T'dO#U'dO~PAcO^%fO!a#tO!h%]O'l%fO(O%QO(c'fO~O!l'jO#X'hO~PBqOl!mO|!nO'wTO'zUO(V!lO(b!rO~O!XXOl(`X|(`X![(`X!](`X!^(`X!x(`X!|(`X!}(`X#O(`X#P(`X#Q(`X#T(`X#U(`X'v(`X'w(`X'z(`X(V(`X(b(`X~O!]'bO!^'bO'v!kO~PCaO'q'nO'r'nO's'pO~O[!{O'w'rO'x!{O'y'rO~O[#OO'y'rO'z'rO'{#OO~Oq#QO!O#RO(T#RO(U'vO~O!U'xO!S&}X!S'TX!V&}X!V'TX~P+vO!V'zO!S(YX~OP$[OX$cOk$POy#xOz#yO|#zO!V'zO!e$RO!f#vO!h#wO!l$[O#g#}O#h$OO#i$OO#j$OO#k$QO#l$RO#m$RO#n$bO#o$RO#q$SO#s$UO#u$WO#v$XO(SVO(c$YO(j#{O(k#|O~O!S(YX~PGTO!S(PO~O!S(fX!V(fX!a(fX!g(fX(c(fX~O#X(fX#d#]X!W(fX~PIZO#X(QO!S(hX!V(hX~O!V(RO!S(gX~O!S(UO~O#X$dO~PIZO!W(VO~P`Oy#xOz#yO|#zO!f#vO!h#wO(SVOP!jaX!jak!ja!V!ja!e!ja!l!ja#g!ja#h!ja#i!ja#j!ja#k!ja#l!ja#m!ja#n!ja#o!ja#q!ja#s!ja#u!ja#v!ja(c!ja(j!ja(k!ja~O^!ja'l!ja'j!ja!S!ja!g!jao!ja!X!ja%a!ja!a!ja~PJqO!g(WO~O!a#tO#X(XO(c'fO!V(eX^(eX'l(eX~O!g(eX~PMaO|%`O!X%aO!x]O#b(^O#c(]O'u%_O~O!V(_O!g(dX~O!g(aO~O|%`O!X%aO#c(]O'u%_O~OP(XXX(XXk(XXy(XXz(XX|(XX!V(XX!e(XX!f(XX!h(XX!l(XX#g(XX#h(XX#i(XX#j(XX#k(XX#l(XX#m(XX#n(XX#o(XX#q(XX#s(XX#u(XX#v(XX(S(XX(c(XX(j(XX(k(XX~O!a#tO!g(XX~PN}Oy(bOz(cO!f#vO!h#wO!x!wa|!wa~O!t!wa%`!wa!X!wa#b!wa#c!wa'u!wa~P!#RO!t(gO~OPYOQYOa!iOb!hOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!XXO!ctO!hZO!kYO!lYO!mYO!ouO!q!fO!t!gO$Q!jO$UfO'u!cO'wTO'zUO(SVO(b[O(oiO~Oi%ROk$sOl$rOm$rOs%SOu%TOw:ZO|$zO!X${O!c;eO!h$wO#c:aO$Q%XO$m:]O$o:_O$r%YO'u(kO'wTO'zUO(O%QO(S$tO~O#d(mO~Oi%ROk$sOl$rOm$rOs%SOu%TOw%UO|$zO!X${O!c%ZO!h$wO#c%[O$Q%XO$m%VO$o%WO$r%YO'u(kO'wTO'zUO(O%QO(S$tO~Od(]P~P!'oO!U(qO!g(^P~P%TO(V(sO(b[O~O|(uO!h#wO(V(sO(b[O~OP9pOQ9pOa;aOb!hOikOk9pOlkOmkOskOu9pOw9pO|WO!QkO!RkO!X!dO!c9sO!hZO!k9pO!l9pO!m9pO!o9tO!q9wO!t!gO$Q!jO$UfO'u)TO'wTO'zUO(SVO(b[O(o;_O~Oz)WO!h#wO~O!V$`O^$ka'l$ka'j$ka!g$ka!S$ka!X$ka%a$ka!a$ka~O#p)[O~P!&VOy)_O!a)^O!X$XX$T$XX$W$XX$Y$XX$a$XX~O!a)^O!X(lX$T(lX$W(lX$Y(lX$a(lX~Oy)_O~P!-eOy)_O!X(lX$T(lX$W(lX$Y(lX$a(lX~O!X)aO$T)eO$W)`O$Y)`O$a)fO~O!U)iO~P!){O$W$fO$Y$eO$a)mO~Og$sXy$sX|$sX!f$sX(j$sX(k$sX~OdfXd$sXgfX!VfX#XfX~P!/ZOl)oO~Oq)pO(T)qO(U)sO~Og)|Oy)uO|)vO(j)xO(k)zO~Od)tO~P!0dOd)}O~Oi%ROk$sOl$rOm$rOs%SOu%TOw:ZO|$zO!X${O!c;eO!h$wO#c:aO$Q%XO$m:]O$o:_O$r%YO'wTO'zUO(O%QO(S$tO~O!U*RO'u*OO!g(pP~P!1RO#d*TO~O!h*UO~O!U*ZO'u*WO!S(qP~P!1ROk*gO|*_O![*eO!]*^O!^*^O!h*UO#T*fO%W*aO'v!kO(V!lO~O!W*dO~P!3XO!f#vOg(RXy(RX|(RX(j(RX(k(RX!V(RX#X(RX~Od(RX#y(RX~P!4QOg*jO#X*iOd(QX!V(QX~O!V*kOd(PX~O'u&POd(PP~O!h*rO~O'u(kO~Oi*vO|%`O!U#gO!X%aO!x]O#b#jO#c#gO'u%_O!g(dP~O!a#tO#d*wO~O|%`O!U*yO!V(RO!X%aO'u%_O!S(gP~Ol'QO|*{O!U*zO'wTO'zUO(V(sO~O!W(iP~P!6{O!V*|O^(uX'l(uX~OP$[OX$cOk$POy#xOz#yO|#zO!e$RO!f#vO!h#wO!l$[O#g#}O#h$OO#i$OO#j$OO#k$QO#l$RO#m$RO#n$bO#o$RO#q$SO#s$UO#u$WO#v$XO(SVO(c$YO(j#{O(k#|O~O^!ba!V!ba'l!ba'j!ba!S!ba!g!bao!ba!X!ba%a!ba!a!ba~P!7sOy#xOz#yO|#zO!f#vO!h#wO(SVOP!naX!nak!na!V!na!e!na!l!na#g!na#h!na#i!na#j!na#k!na#l!na#m!na#n!na#o!na#q!na#s!na#u!na#v!na(c!na(j!na(k!na~O^!na'l!na'j!na!S!na!g!nao!na!X!na%a!na!a!na~P!:^Oy#xOz#yO|#zO!f#vO!h#wO(SVOP!paX!pak!pa!V!pa!e!pa!l!pa#g!pa#h!pa#i!pa#j!pa#k!pa#l!pa#m!pa#n!pa#o!pa#q!pa#s!pa#u!pa#v!pa(c!pa(j!pa(k!pa~O^!pa'l!pa'j!pa!S!pa!g!pao!pa!X!pa%a!pa!a!pa~P!<wOg+VO!X'UO%a+UO(O%QO~O!a+XO^'}X!X'}X'l'}X!V'}X~O^%fO!XXO'l%fO~O!h%]O(O%QO~O!h%]O'u%_O(O%QO~O!a#tO#d(mO~O%b+eO'u+aO'wTO'zUO!W(yP~O!V+fO](xX~OX+jO~O]+kO~O!X%vO'u%_O'v!kO](xP~O#X+pO(O%QO~Og+sO!X${O(O%QO~O!X+uO~Oy+wO!XXO~O%f%mO~O!t+|O~Ob,RO~O'u#lO!W(wP~Ob%tO~O%b!PO'u&PO~P<pOX,XO],WO~OPYOQYOayObxOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!ctO!hZO!kYO!lYO!mYO!ouO!twO!x]O$UfO%`|O'wTO'zUO(SVO(b[O(oiO~O!X!dO!q!fO$Q!jO'u!cO~P!CnO],WO^%fO'l%fO~OPYOQYOa!iOb!hOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!X!dO!ctO!hZO!kYO!lYO!mYO!ouO!t!gO$Q!jO$UfO'u!cO'wTO'zUO(SVO(b[O(oiO~O^,^O!qvO#p}O%d}O%e}O%f}O~P!FWO!h&eO~O&T,dO~O!X,fO~O&f,hO&h,iOP&caQ&caV&ca^&caa&cab&cai&cak&cal&cam&cas&cau&caw&ca|&ca!Q&ca!R&ca!X&ca!c&ca!h&ca!k&ca!l&ca!m&ca!o&ca!q&ca!t&ca!x&ca#p&ca$Q&ca$U&ca%`&ca%b&ca%d&ca%e&ca%f&ca%i&ca%k&ca%n&ca%o&ca%q&ca%}&ca&T&ca&V&ca&X&ca&Z&ca&^&ca&d&ca&j&ca&l&ca&n&ca&p&ca&r&ca'j&ca'u&ca'w&ca'z&ca(S&ca(b&ca(o&ca!W&ca&[&ca_&ca&a&ca~O'u,nO~O!V{X!V!_X!W{X!W!_X!a{X!a!_X!h!_X#X{X(O!_X~O!a,sO#X,rO!V#aX!V([X!W#aX!W([X!a([X!h([X(O([X~O!a,uO!h%]O(O%QO!V!ZX!W!ZX~Ol!mO|!nO'wTO'zUO(V!lO~OP9pOQ9pOa;aOb!hOikOk9pOlkOmkOskOu9pOw9pO|WO!QkO!RkO!X!dO!c9sO!hZO!k9pO!l9pO!m9pO!o9tO!q9wO!t!gO$Q!jO$UfO'wTO'zUO(SVO(b[O(o;_O~O'u:fO~P# ^O!V,yO!W(ZX~O!W,{O~O!a,sO#X,rO!V#aX!W#aX~O!V,|O!W(iX~O!W-OO~O!]-PO!^-PO'v!kO~P!N{O!W-SO~P'WOg-VO!X'UO~O!S-[O~Ol!wa![!wa!]!wa!^!wa!|!wa!}!wa#O!wa#P!wa#Q!wa#T!wa#U!wa'v!wa'w!wa'z!wa(V!wa(b!wa~P!#RO!l-aO#X-_O~PBqO!]-cO!^-cO'v!kO~PCaO^%fO#X-_O'l%fO~O^%fO!a#tO#X-_O'l%fO~O^%fO!a#tO!l-aO#X-_O'l%fO(c'fO~O'q'nO'r'nO's-hO~Oo-iO~O!S&}a!V&}a~P!7sO!U-mO!S&}X!V&}X~P%TO!V'zO!S(Ya~O!S(Ya~PGTO!V(RO!S(ga~O|%`O!U-qO!X%aO'u%_O!S'TX!V'TX~O#X-sO!V(ea!g(ea^(ea'l(ea~O!a#tO~P#)dO!V(_O!g(da~O|%`O!X%aO#c-wO'u%_O~Oi-|O|%`O!U-yO!X%aO!x]O#b-{O#c-yO'u%_O!V'WX!g'WX~Oz.QO!h#wO~Og.TO!X'UO%a.SO(O%QO~O^#[i!V#[i'l#[i'j#[i!S#[i!g#[io#[i!X#[i%a#[i!a#[i~P!7sOg;kOy)uO|)vO(j)xO(k)zO~O#d#Wa^#Wa#X#Wa'l#Wa!V#Wa!g#Wa!X#Wa!S#Wa~P#,`O#d(RXP(RXX(RX^(RXk(RXz(RX!e(RX!h(RX!l(RX#g(RX#h(RX#i(RX#j(RX#k(RX#l(RX#m(RX#n(RX#o(RX#q(RX#s(RX#u(RX#v(RX'l(RX(S(RX(c(RX!g(RX!S(RX'j(RXo(RX!X(RX%a(RX!a(RX~P!4QO!V.^Od(]X~P!0dOd.`O~O!V.aO!g(^X~P!7sO!g.dO~O!S.fO~OP$[Oy#xOz#yO|#zO!f#vO!h#wO!l$[O(SVOX#fi^#fik#fi!V#fi!e#fi#h#fi#i#fi#j#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi'l#fi(c#fi(j#fi(k#fi'j#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~O#g#fi~P#0[O#g#}O~P#0[OP$[Oy#xOz#yO|#zO!f#vO!h#wO!l$[O#g#}O#h$OO#i$OO#j$OO(SVOX#fi^#fi!V#fi!e#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi'l#fi(c#fi(j#fi(k#fi'j#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~Ok#fi~P#2|Ok$PO~P#2|OP$[Ok$POy#xOz#yO|#zO!f#vO!h#wO!l$[O#g#}O#h$OO#i$OO#j$OO#k$QO(SVO^#fi!V#fi#q#fi#s#fi#u#fi#v#fi'l#fi(c#fi(j#fi(k#fi'j#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~OX#fi!e#fi#l#fi#m#fi#n#fi#o#fi~P#5nOX$cO!e$RO#l$RO#m$RO#n$bO#o$RO~P#5nOP$[OX$cOk$POy#xOz#yO|#zO!e$RO!f#vO!h#wO!l$[O#g#}O#h$OO#i$OO#j$OO#k$QO#l$RO#m$RO#n$bO#o$RO#q$SO(SVO^#fi!V#fi#s#fi#u#fi#v#fi'l#fi(c#fi(k#fi'j#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~O(j#fi~P#8oO(j#{O~P#8oOP$[OX$cOk$POy#xOz#yO|#zO!e$RO!f#vO!h#wO!l$[O#g#}O#h$OO#i$OO#j$OO#k$QO#l$RO#m$RO#n$bO#o$RO#q$SO#s$UO(SVO(j#{O^#fi!V#fi#u#fi#v#fi'l#fi(c#fi'j#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~O(k#fi~P#;aO(k#|O~P#;aOP$[OX$cOk$POy#xOz#yO|#zO!e$RO!f#vO!h#wO!l$[O#g#}O#h$OO#i$OO#j$OO#k$QO#l$RO#m$RO#n$bO#o$RO#q$SO#s$UO#u$WO(SVO(j#{O(k#|O~O^#fi!V#fi#v#fi'l#fi(c#fi'j#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~P#>ROPYXXYXkYXyYXzYX|YX!eYX!fYX!hYX!lYX#XYX#dcX#gYX#hYX#iYX#jYX#kYX#lYX#mYX#nYX#oYX#qYX#sYX#uYX#vYX#{YX(SYX(cYX(jYX(kYX!VYX!WYX~O#yYX~P#@lOP$[OX:XOk9{Oy#xOz#yO|#zO!e9}O!f#vO!h#wO!l$[O#g9yO#h9zO#i9zO#j9zO#k9|O#l9}O#m9}O#n:WO#o9}O#q:OO#s:QO#u:SO#v:TO(SVO(c$YO(j#{O(k#|O~O#y.hO~P#ByO#X:YO#{:YO#y(XX!W(XX~PN}O^'Za!V'Za'l'Za'j'Za!g'Za!S'Zao'Za!X'Za%a'Za!a'Za~P!7sOP#fiX#fi^#fik#fiz#fi!V#fi!e#fi!f#fi!h#fi!l#fi#g#fi#h#fi#i#fi#j#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi'l#fi(S#fi(c#fi'j#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~P#,`O^#zi!V#zi'l#zi'j#zi!S#zi!g#zio#zi!X#zi%a#zi!a#zi~P!7sO$W.mO$Y.mO~O$W.nO$Y.nO~O!a)^O#X.oO!X$^X$T$^X$W$^X$Y$^X$a$^X~O!U.pO~O!X)aO$T.rO$W)`O$Y)`O$a.sO~O!V:UO!W(WX~P#ByO!W.tO~O!a)^O$a(lX~O$a.vO~Oq)pO(T)qO(U.yO~Ol.|O!S.}O'wTO'zUO~O!VcX!acX!gcX!g$sX(ccX~P!/ZO!g/TO~P#,`O!V/UO!a#tO(c'fO!g(pX~O!g/ZO~O!U*RO'u%_O!g(pP~O#d/]O~O!S$sX!V$sX!a$zX~P!/ZO!V/^O!S(qX~P#,`O!a/`O~O!S/bO~Ok/fO!a#tO!h%]O(O%QO(c'fO~O'u/hO~O!a+XO~O^%fO!V/lO'l%fO~O!W/nO~P!3XO!]/oO!^/oO'v!kO(V!lO~O|/qO(V!lO~O#T/rO~O'u&POd'`X!V'`X~O!V*kOd(Pa~Od/wO~Oy/xOz/xO|/yOgva(jva(kva!Vva#Xva~Odva#yva~P$ hOy)uO|)vOg$la(j$la(k$la!V$la#X$la~Od$la#y$la~P$!^Oy)uO|)vOg$na(j$na(k$na!V$na#X$na~Od$na#y$na~P$#PO#d/{O~Od$|a!V$|a#X$|a#y$|a~P!0dO!a#tO~O#d0OO~O!V*|O^(ua'l(ua~Oy#xOz#yO|#zO!f#vO!h#wO(SVOP!niX!nik!ni!V!ni!e!ni!l!ni#g!ni#h!ni#i!ni#j!ni#k!ni#l!ni#m!ni#n!ni#o!ni#q!ni#s!ni#u!ni#v!ni(c!ni(j!ni(k!ni~O^!ni'l!ni'j!ni!S!ni!g!nio!ni!X!ni%a!ni!a!ni~P$$nOg.TO!X'UO%a.SO~Oi0YO'u0XO~P!1UO!a+XO^'}a!X'}a'l'}a!V'}a~O#d0`O~OXYX!VcX!WcX~O!V0aO!W(yX~O!W0cO~OX0dO~O'u+aO'wTO'zUO~O!X%vO'u%_O]'hX!V'hX~O!V+fO](xa~O!g0iO~P!7sOX0lO~O]0mO~O#X0pO~Og0sO!X${O~O(V(sO!W(vP~Og0|O!X0yO%a0{O(O%QO~OX1WO!V1UO!W(wX~O!W1XO~O]1ZO^%fO'l%fO~O'u#lO'wTO'zUO~O#X$dO#{$dOP(XXX(XXk(XXy(XXz(XX|(XX!V(XX!e(XX!h(XX!l(XX#g(XX#h(XX#i(XX#j(XX#k(XX#l(XX#m(XX#n(XX#q(XX#s(XX#u(XX#v(XX(S(XX(c(XX(j(XX(k(XX~O#o1^O&R1_O^(XX!f(XX~P$+dO#X$dO#o1^O&R1_O~O^1aO~P%TO^1cO~O&[1fOP&YiQ&YiV&Yi^&Yia&Yib&Yii&Yik&Yil&Yim&Yis&Yiu&Yiw&Yi|&Yi!Q&Yi!R&Yi!X&Yi!c&Yi!h&Yi!k&Yi!l&Yi!m&Yi!o&Yi!q&Yi!t&Yi!x&Yi#p&Yi$Q&Yi$U&Yi%`&Yi%b&Yi%d&Yi%e&Yi%f&Yi%i&Yi%k&Yi%n&Yi%o&Yi%q&Yi%}&Yi&T&Yi&V&Yi&X&Yi&Z&Yi&^&Yi&d&Yi&j&Yi&l&Yi&n&Yi&p&Yi&r&Yi'j&Yi'u&Yi'w&Yi'z&Yi(S&Yi(b&Yi(o&Yi!W&Yi_&Yi&a&Yi~O_1lO!W1jO&a1kO~P`O!XXO!h1nO~O&h,iOP&ciQ&ciV&ci^&cia&cib&cii&cik&cil&cim&cis&ciu&ciw&ci|&ci!Q&ci!R&ci!X&ci!c&ci!h&ci!k&ci!l&ci!m&ci!o&ci!q&ci!t&ci!x&ci#p&ci$Q&ci$U&ci%`&ci%b&ci%d&ci%e&ci%f&ci%i&ci%k&ci%n&ci%o&ci%q&ci%}&ci&T&ci&V&ci&X&ci&Z&ci&^&ci&d&ci&j&ci&l&ci&n&ci&p&ci&r&ci'j&ci'u&ci'w&ci'z&ci(S&ci(b&ci(o&ci!W&ci&[&ci_&ci&a&ci~O!S1tO~O!V!Za!W!Za~P#ByOl!mO|!nO!U1zO(V!lO!V'OX!W'OX~P?wO!V,yO!W(Za~O!V'UX!W'UX~P!6{O!V,|O!W(ia~O!W2RO~P'WO^%fO#X2[O'l%fO~O^%fO!a#tO#X2[O'l%fO~O^%fO!a#tO!l2`O#X2[O'l%fO(c'fO~O^%fO'l%fO~P!7sO!V$`Oo$ka~O!S&}i!V&}i~P!7sO!V'zO!S(Yi~O!V(RO!S(gi~O!S(hi!V(hi~P!7sO!V(ei!g(ei^(ei'l(ei~P!7sO#X2bO!V(ei!g(ei^(ei'l(ei~O!V(_O!g(di~O|%`O!X%aO!x]O#b2gO#c2fO'u%_O~O|%`O!X%aO#c2fO'u%_O~Og2nO!X'UO%a2mO~Og2nO!X'UO%a2mO(O%QO~O#dvaPvaXva^vakva!eva!fva!hva!lva#gva#hva#iva#jva#kva#lva#mva#nva#ova#qva#sva#uva#vva'lva(Sva(cva!gva!Sva'jvaova!Xva%ava!ava~P$ hO#d$laP$laX$la^$lak$laz$la!e$la!f$la!h$la!l$la#g$la#h$la#i$la#j$la#k$la#l$la#m$la#n$la#o$la#q$la#s$la#u$la#v$la'l$la(S$la(c$la!g$la!S$la'j$lao$la!X$la%a$la!a$la~P$!^O#d$naP$naX$na^$nak$naz$na!e$na!f$na!h$na!l$na#g$na#h$na#i$na#j$na#k$na#l$na#m$na#n$na#o$na#q$na#s$na#u$na#v$na'l$na(S$na(c$na!g$na!S$na'j$nao$na!X$na%a$na!a$na~P$#PO#d$|aP$|aX$|a^$|ak$|az$|a!V$|a!e$|a!f$|a!h$|a!l$|a#g$|a#h$|a#i$|a#j$|a#k$|a#l$|a#m$|a#n$|a#o$|a#q$|a#s$|a#u$|a#v$|a'l$|a(S$|a(c$|a!g$|a!S$|a'j$|a#X$|ao$|a!X$|a%a$|a!a$|a~P#,`O^#[q!V#[q'l#[q'j#[q!S#[q!g#[qo#[q!X#[q%a#[q!a#[q~P!7sOd'PX!V'PX~P!'oO!V.^Od(]a~O!U2vO!V'QX!g'QX~P%TO!V.aO!g(^a~O!V.aO!g(^a~P!7sO!S2yO~O#y!ja!W!ja~PJqO#y!ba!V!ba!W!ba~P#ByO#y!na!W!na~P!:^O#y!pa!W!pa~P!<wO!X3]O$UfO$_3^O~O!W3bO~Oo3cO~P#,`O^$hq!V$hq'l$hq'j$hq!S$hq!g$hqo$hq!X$hq%a$hq!a$hq~P!7sO!S3dO~Ol.|O'wTO'zUO~Oy)uO|)vO(k)zOg%Xi(j%Xi!V%Xi#X%Xi~Od%Xi#y%Xi~P$JVOy)uO|)vOg%Zi(j%Zi(k%Zi!V%Zi#X%Zi~Od%Zi#y%Zi~P$JxO(c$YO~P#,`O!U3gO'u%_O!V'[X!g'[X~O!V/UO!g(pa~O!V/UO!a#tO!g(pa~O!V/UO!a#tO(c'fO!g(pa~Od$ui!V$ui#X$ui#y$ui~P!0dO!U3oO'u*WO!S'^X!V'^X~P!1RO!V/^O!S(qa~O!V/^O!S(qa~P#,`O!a#tO#o3wO~Ok3zO!a#tO(c'fO~Od(Qi!V(Qi~P!0dO#X3}Od(Qi!V(Qi~P!0dO!g4QO~O^$iq!V$iq'l$iq'j$iq!S$iq!g$iqo$iq!X$iq%a$iq!a$iq~P!7sO!S4UO~O!V4VO!X(rX~P#,`O!f#vO~P4QO^$sX!X$sX%UYX'l$sX!V$sX~P!/ZO%U4XO^hXghXyhX|hX!XhX'lhX(jhX(khX!VhX~O%U4XO~O%b4`O'u+aO'wTO'zUO!V'gX!W'gX~O!V0aO!W(ya~OX4dO~O]4eO~O^%fO'l%fO~P#,`O!X${O~P#,`O!V4mO#X4oO!W(vX~O!W4pO~Ol!mO|4qO![!wO!]!tO!^!tO!x9qO!|!oO!}!oO#O!oO#P!oO#Q!oO#T4vO#U!xO'v!kO'wTO'zUO(V!lO(b!rO~O!W4uO~P%$wOg4{O!X0yO%a4zO~Og4{O!X0yO%a4zO(O%QO~O'u#lO!V'fX!W'fX~O!V1UO!W(wa~O'wTO'zUO(V5UO~O]5YO~O#o5]O&R5^O~PMaO!g5_O~P%TO^5aO~O^5aO~P%TO_1lO!W5fO&a1kO~P`O!a5hO~O!a5jO!V([i!W([i!a([i!h([i(O([i~O!V#ai!W#ai~P#ByO#X5kO!V#ai!W#ai~O!V!Zi!W!Zi~P#ByO^%fO#X5tO'l%fO~O^%fO!a#tO#X5tO'l%fO~O!V(eq!g(eq^(eq'l(eq~P!7sO!V(_O!g(dq~O|%`O!X%aO#c5{O'u%_O~O!X'UO%a6OO~Og6RO!X'UO%a6OO~O#d%XiP%XiX%Xi^%Xik%Xiz%Xi!e%Xi!f%Xi!h%Xi!l%Xi#g%Xi#h%Xi#i%Xi#j%Xi#k%Xi#l%Xi#m%Xi#n%Xi#o%Xi#q%Xi#s%Xi#u%Xi#v%Xi'l%Xi(S%Xi(c%Xi!g%Xi!S%Xi'j%Xio%Xi!X%Xi%a%Xi!a%Xi~P$JVO#d%ZiP%ZiX%Zi^%Zik%Ziz%Zi!e%Zi!f%Zi!h%Zi!l%Zi#g%Zi#h%Zi#i%Zi#j%Zi#k%Zi#l%Zi#m%Zi#n%Zi#o%Zi#q%Zi#s%Zi#u%Zi#v%Zi'l%Zi(S%Zi(c%Zi!g%Zi!S%Zi'j%Zio%Zi!X%Zi%a%Zi!a%Zi~P$JxO#d$uiP$uiX$ui^$uik$uiz$ui!V$ui!e$ui!f$ui!h$ui!l$ui#g$ui#h$ui#i$ui#j$ui#k$ui#l$ui#m$ui#n$ui#o$ui#q$ui#s$ui#u$ui#v$ui'l$ui(S$ui(c$ui!g$ui!S$ui'j$ui#X$uio$ui!X$ui%a$ui!a$ui~P#,`Od'Pa!V'Pa~P!0dO!V'Qa!g'Qa~P!7sO!V.aO!g(^i~O#y#[i!V#[i!W#[i~P#ByOP$[Oy#xOz#yO|#zO!f#vO!h#wO!l$[O(SVOX#fik#fi!e#fi#h#fi#i#fi#j#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi#y#fi(c#fi(j#fi(k#fi!V#fi!W#fi~O#g#fi~P%3WO#g9yO~P%3WOP$[Oy#xOz#yO|#zO!f#vO!h#wO!l$[O#g9yO#h9zO#i9zO#j9zO(SVOX#fi!e#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi#y#fi(c#fi(j#fi(k#fi!V#fi!W#fi~Ok#fi~P%5cOk9{O~P%5cOP$[Ok9{Oy#xOz#yO|#zO!f#vO!h#wO!l$[O#g9yO#h9zO#i9zO#j9zO#k9|O(SVO#q#fi#s#fi#u#fi#v#fi#y#fi(c#fi(j#fi(k#fi!V#fi!W#fi~OX#fi!e#fi#l#fi#m#fi#n#fi#o#fi~P%7nOX:XO!e9}O#l9}O#m9}O#n:WO#o9}O~P%7nOP$[OX:XOk9{Oy#xOz#yO|#zO!e9}O!f#vO!h#wO!l$[O#g9yO#h9zO#i9zO#j9zO#k9|O#l9}O#m9}O#n:WO#o9}O#q:OO(SVO#s#fi#u#fi#v#fi#y#fi(c#fi(k#fi!V#fi!W#fi~O(j#fi~P%:YO(j#{O~P%:YOP$[OX:XOk9{Oy#xOz#yO|#zO!e9}O!f#vO!h#wO!l$[O#g9yO#h9zO#i9zO#j9zO#k9|O#l9}O#m9}O#n:WO#o9}O#q:OO#s:QO(SVO(j#{O#u#fi#v#fi#y#fi(c#fi!V#fi!W#fi~O(k#fi~P%<eO(k#|O~P%<eOP$[OX:XOk9{Oy#xOz#yO|#zO!e9}O!f#vO!h#wO!l$[O#g9yO#h9zO#i9zO#j9zO#k9|O#l9}O#m9}O#n:WO#o9}O#q:OO#s:QO#u:SO(SVO(j#{O(k#|O~O#v#fi#y#fi(c#fi!V#fi!W#fi~P%>pO^#wy!V#wy'l#wy'j#wy!S#wy!g#wyo#wy!X#wy%a#wy!a#wy~P!7sOg;lOy)uO|)vO(j)xO(k)zO~OP#fiX#fik#fiz#fi!e#fi!f#fi!h#fi!l#fi#g#fi#h#fi#i#fi#j#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi#y#fi(S#fi(c#fi!V#fi!W#fi~P%AhO!f#vOP(RXX(RXg(RXk(RXy(RXz(RX|(RX!e(RX!h(RX!l(RX#g(RX#h(RX#i(RX#j(RX#k(RX#l(RX#m(RX#n(RX#o(RX#q(RX#s(RX#u(RX#v(RX#y(RX(S(RX(c(RX(j(RX(k(RX!V(RX!W(RX~O#y#zi!V#zi!W#zi~P#ByO#y!ni!W!ni~P$$nO!W6_O~O!V'Za!W'Za~P#ByO!a#tO(c'fO!V'[a!g'[a~O!V/UO!g(pi~O!V/UO!a#tO!g(pi~Od$uq!V$uq#X$uq#y$uq~P!0dO!S'^a!V'^a~P#,`O!a6fO~O!V/^O!S(qi~P#,`O!V/^O!S(qi~O!S6jO~O!a#tO#o6oO~Ok6pO!a#tO(c'fO~O!S6rO~Od$wq!V$wq#X$wq#y$wq~P!0dO^$iy!V$iy'l$iy'j$iy!S$iy!g$iyo$iy!X$iy%a$iy!a$iy~P!7sO!a5jO~O!V4VO!X(ra~O^#[y!V#[y'l#[y'j#[y!S#[y!g#[yo#[y!X#[y%a#[y!a#[y~P!7sOX6wO~O!V0aO!W(yi~O]6}O~O(V(sO!V'cX!W'cX~O!V4mO!W(va~OikO'u7UO~P.bO!W7XO~P%$wOl!mO|7YO'wTO'zUO(V!lO(b!rO~O!X0yO~O!X0yO%a7[O~Og7_O!X0yO%a7[O~OX7dO!V'fa!W'fa~O!V1UO!W(wi~O!g7hO~O!g7iO~O!g7lO~O!g7lO~P%TO^7nO~O!a7oO~O!g7pO~O!V(hi!W(hi~P#ByO^%fO#X7xO'l%fO~O!V(ey!g(ey^(ey'l(ey~P!7sO!V(_O!g(dy~O!X'UO%a7{O~O#d$uqP$uqX$uq^$uqk$uqz$uq!V$uq!e$uq!f$uq!h$uq!l$uq#g$uq#h$uq#i$uq#j$uq#k$uq#l$uq#m$uq#n$uq#o$uq#q$uq#s$uq#u$uq#v$uq'l$uq(S$uq(c$uq!g$uq!S$uq'j$uq#X$uqo$uq!X$uq%a$uq!a$uq~P#,`O#d$wqP$wqX$wq^$wqk$wqz$wq!V$wq!e$wq!f$wq!h$wq!l$wq#g$wq#h$wq#i$wq#j$wq#k$wq#l$wq#m$wq#n$wq#o$wq#q$wq#s$wq#u$wq#v$wq'l$wq(S$wq(c$wq!g$wq!S$wq'j$wq#X$wqo$wq!X$wq%a$wq!a$wq~P#,`O!V'Qi!g'Qi~P!7sO#y#[q!V#[q!W#[q~P#ByOy/xOz/xO|/yOPvaXvagvakva!eva!fva!hva!lva#gva#hva#iva#jva#kva#lva#mva#nva#ova#qva#sva#uva#vva#yva(Sva(cva(jva(kva!Vva!Wva~Oy)uO|)vOP$laX$lag$lak$laz$la!e$la!f$la!h$la!l$la#g$la#h$la#i$la#j$la#k$la#l$la#m$la#n$la#o$la#q$la#s$la#u$la#v$la#y$la(S$la(c$la(j$la(k$la!V$la!W$la~Oy)uO|)vOP$naX$nag$nak$naz$na!e$na!f$na!h$na!l$na#g$na#h$na#i$na#j$na#k$na#l$na#m$na#n$na#o$na#q$na#s$na#u$na#v$na#y$na(S$na(c$na(j$na(k$na!V$na!W$na~OP$|aX$|ak$|az$|a!e$|a!f$|a!h$|a!l$|a#g$|a#h$|a#i$|a#j$|a#k$|a#l$|a#m$|a#n$|a#o$|a#q$|a#s$|a#u$|a#v$|a#y$|a(S$|a(c$|a!V$|a!W$|a~P%AhO#y$hq!V$hq!W$hq~P#ByO#y$iq!V$iq!W$iq~P#ByO!W8VO~O#y8WO~P!0dO!a#tO!V'[i!g'[i~O!a#tO(c'fO!V'[i!g'[i~O!V/UO!g(pq~O!S'^i!V'^i~P#,`O!V/^O!S(qq~O!S8^O~P#,`O!S8^O~Od(Qy!V(Qy~P!0dO!V'aa!X'aa~P#,`O^%Tq!X%Tq'l%Tq!V%Tq~P#,`OX8cO~O!V0aO!W(yq~O#X8gO!V'ca!W'ca~O!V4mO!W(vi~P#ByOPYXXYXkYXyYXzYX|YX!SYX!VYX!eYX!fYX!hYX!lYX#XYX#dcX#gYX#hYX#iYX#jYX#kYX#lYX#mYX#nYX#oYX#qYX#sYX#uYX#vYX#{YX(SYX(cYX(jYX(kYX~O!a%RX#o%RX~P&2hO!X0yO%a8kO~O'wTO'zUO(V8pO~O!V1UO!W(wq~O!g8sO~O!g8tO~O!g8uO~O!g8uO~P%TO#X8xO!V#ay!W#ay~O!V#ay!W#ay~P#ByO!X'UO%a8}O~O#y#wy!V#wy!W#wy~P#ByOP$uiX$uik$uiz$ui!e$ui!f$ui!h$ui!l$ui#g$ui#h$ui#i$ui#j$ui#k$ui#l$ui#m$ui#n$ui#o$ui#q$ui#s$ui#u$ui#v$ui#y$ui(S$ui(c$ui!V$ui!W$ui~P%AhOy)uO|)vO(k)zOP%XiX%Xig%Xik%Xiz%Xi!e%Xi!f%Xi!h%Xi!l%Xi#g%Xi#h%Xi#i%Xi#j%Xi#k%Xi#l%Xi#m%Xi#n%Xi#o%Xi#q%Xi#s%Xi#u%Xi#v%Xi#y%Xi(S%Xi(c%Xi(j%Xi!V%Xi!W%Xi~Oy)uO|)vOP%ZiX%Zig%Zik%Ziz%Zi!e%Zi!f%Zi!h%Zi!l%Zi#g%Zi#h%Zi#i%Zi#j%Zi#k%Zi#l%Zi#m%Zi#n%Zi#o%Zi#q%Zi#s%Zi#u%Zi#v%Zi#y%Zi(S%Zi(c%Zi(j%Zi(k%Zi!V%Zi!W%Zi~O#y$iy!V$iy!W$iy~P#ByO#y#[y!V#[y!W#[y~P#ByO!a#tO!V'[q!g'[q~O!V/UO!g(py~O!S'^q!V'^q~P#,`O!S9UO~P#,`O!V0aO!W(yy~O!V4mO!W(vq~O!X0yO%a9]O~O!g9`O~O!X'UO%a9eO~OP$uqX$uqk$uqz$uq!e$uq!f$uq!h$uq!l$uq#g$uq#h$uq#i$uq#j$uq#k$uq#l$uq#m$uq#n$uq#o$uq#q$uq#s$uq#u$uq#v$uq#y$uq(S$uq(c$uq!V$uq!W$uq~P%AhOP$wqX$wqk$wqz$wq!e$wq!f$wq!h$wq!l$wq#g$wq#h$wq#i$wq#j$wq#k$wq#l$wq#m$wq#n$wq#o$wq#q$wq#s$wq#u$wq#v$wq#y$wq(S$wq(c$wq!V$wq!W$wq~P%AhOd%]!Z!V%]!Z#X%]!Z#y%]!Z~P!0dO!V'cq!W'cq~P#ByO!V#a!Z!W#a!Z~P#ByO#d%]!ZP%]!ZX%]!Z^%]!Zk%]!Zz%]!Z!V%]!Z!e%]!Z!f%]!Z!h%]!Z!l%]!Z#g%]!Z#h%]!Z#i%]!Z#j%]!Z#k%]!Z#l%]!Z#m%]!Z#n%]!Z#o%]!Z#q%]!Z#s%]!Z#u%]!Z#v%]!Z'l%]!Z(S%]!Z(c%]!Z!g%]!Z!S%]!Z'j%]!Z#X%]!Zo%]!Z!X%]!Z%a%]!Z!a%]!Z~P#,`OP%]!ZX%]!Zk%]!Zz%]!Z!e%]!Z!f%]!Z!h%]!Z!l%]!Z#g%]!Z#h%]!Z#i%]!Z#j%]!Z#k%]!Z#l%]!Z#m%]!Z#n%]!Z#o%]!Z#q%]!Z#s%]!Z#u%]!Z#v%]!Z#y%]!Z(S%]!Z(c%]!Z!V%]!Z!W%]!Z~P%AhOo(WX~P1jO'v!kO~P!){O!ScX!VcX#XcX~P&2hOPYXXYXkYXyYXzYX|YX!VYX!VcX!eYX!fYX!hYX!lYX#XYX#XcX#dcX#gYX#hYX#iYX#jYX#kYX#lYX#mYX#nYX#oYX#qYX#sYX#uYX#vYX#{YX(SYX(cYX(jYX(kYX~O!acX!gYX!gcX(ccX~P&HOOP9pOQ9pOa;aOb!hOikOk9pOlkOmkOskOu9pOw9pO|WO!QkO!RkO!XXO!c9sO!hZO!k9pO!l9pO!m9pO!o9tO!q9wO!t!gO$Q!jO$UfO'u)TO'wTO'zUO(SVO(b[O(o;_O~O!V:UO!W$ka~Oi%ROk$sOl$rOm$rOs%SOu%TOw:[O|$zO!X${O!c;fO!h$wO#c:bO$Q%XO$m:^O$o:`O$r%YO'u(kO'wTO'zUO(O%QO(S$tO~O#p)[O~P&LtO!WYX!WcX~P&HOO#d9xO~O!a#tO#d9xO~O#X:YO~O#o9}O~O#X:dO!V(hX!W(hX~O#X:YO!V(fX!W(fX~O#d:eO~Od:gO~P!0dO#d:lO~O#d:mO~O!a#tO#d:nO~O!a#tO#d:eO~O#y:oO~P#ByO#d:pO~O#d:qO~O#d:rO~O#d:sO~O#d:tO~O#d:uO~O#y:vO~P!0dO#y:wO~P!0dO$U~!f!|!}#P#Q#T#b#c#n(o$m$o$r%U%`%a%b%i%k%n%o%q%s~'pR$U(o#h!R'n'v#il#g#jky'o(V'o'u$W$Y$W~",goto:"$&O(}PPPP)OP)RP)cP*r.uPPPP5WPP5mP;h>mP?QP?QPPP?QP@pP?QP?QP?QP@tPP@yPAdPFZPPPF_PPPPF_I_PPPIeJ`PF_PLmPPPPN{F_PPPF_PF_P!#ZF_P!&n!'p!'yP!(l!(p!(lPPPPP!+z!'pPP!,h!-bP!0UF_F_!0Z!3d!7x!7x!;mPPP!;tF_PPPPPPPPPPP!?QP!@cPPF_!ApPF_PF_F_F_F_PF_!CSPP!FZP!I^P!Ib!Il!Ip!IpP!FWP!It!ItP!LwP!L{F_F_!MR#!T?QP?QP?Q?QP##_?Q?Q#%X?Q#'f?Q#)Y?Q?Q#)v#+r#+r#+v#,O#+r#,WP#+rP?Q#,p?Q#-x?Q?Q5WPPP#/TPPP#/m#/mP#/mP#0S#/mPP#0YP#0PP#0P#0l#0P#1W#1^5T)R#1a)RP#1h#1h#1hP)RP)RP)RP)RPP)RP#1n#1qP#1q)RP#1uP#1xP)RP)RP)RP)RP)RP)R)RPP#2O#2U#2`#2f#2l#2r#2x#3W#3^#3d#3n#3t#4O#4_#4e#5U#5h#5n#5t#6S#6i#7y#8X#8_#8e#8k#8q#8{#9R#9X#9c#9u#9{PPPPPPPPPP#:RPPPPPPP#:u#=|P#?]#?d#?lPPPP#Cv#Fl#MS#MV#MY#NR#NU#NX#N`#NhPP#Nn#Nr$ j$!i$!m$#RPP$#V$#]$#aP$#d$#h$#k$$a$$w$%_$%c$%f$%i$%o$%r$%v$%zR!zRmqOXs!Y#b%e&h&j&k&m,a,f1f1iY!tQ'U-R0y4tQ%kuQ%sxQ%z{Q&`!US&|!d,yQ'[!hS'b!q!wS*^${*cQ+_%tQ+l%|Q,Q&YQ-P'TQ-Z']Q-c'cQ/o*eQ1T,RR:c9t$|dOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$`$d%e%k%x&a&d&h&j&k&m&q&y'W'h'x'z(Q(X(m(q(u)t*w*{,^,a,f-V-_-m-s.a.h/y0O0`0|1^1_1a1c1f1i1k2[2b2v4q4{5]5^5a5t7Y7_7n7xS#o]9q!r)V$Z$l&})i,r,u.p1z3]4o5k8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bQ*n%UQ+d%vQ,S&]Q,Z&eQ.W:ZQ0V+VQ0Z+XQ0f+eQ1],XQ2j.TQ4_0aQ5S1UQ6Q2nQ6W:[Q6y4`R8O6R&zkOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$Z$`$d$l%e%k%x&a&d&e&h&j&k&m&q&y&}'W'h'x'z(Q(X(m(q(u)i)t*w*{+V,^,a,f,r,u-V-_-m-s.T.a.h.p/y0O0`0|1^1_1a1c1f1i1k1z2[2b2n2v3]4o4q4{5]5^5a5k5t6R7Y7_7n7x8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bt!mQ!q!t!w!x&|'T'U'b'c'd,y-P-R-c0y4t4v$Y$ri#t#v$b$c$w$z%V%W%[)p)y){)|*T*Z*i*j+U+X+p+s.S.^/]/^/`/{0p0s0{2m3e3o3w3}4V4X4z6O6f6o7[7{8W8k8}9]9e:W:X:]:^:_:`:a:b:h:i:j:k:l:m:p:q:r:s:v:w;_;g;h;k;lQ%}{Q&z!dS'Q%a,|Q+d%vS.|)v/OQ/z*rQ0f+eQ0k+kQ1[,WQ1],XQ4_0aQ4h0mQ5V1WQ5W1ZQ6y4`Q6|4eQ7g5YQ8f6}R8q7dpnOXs!U!Y#b%e&_&h&j&k&m,a,f1f1iR,U&a&t^OPXYstuvy!Y!_!f!i!n#Q#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$Z$`$d$l%e%k%x&a&d&e&h&j&k&m&q&y'W'h'z(Q(X(m(q(u)i)t*w*{+V,^,a,f,r,u-V-_-m-s.T.a.h.p/y0O0`0|1^1_1a1c1f1i1k1z2[2b2n2v3]4o4q4{5]5^5a5k5t6R7Y7_7n7x8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;a;b[#ZWZ#U#X&}'x!S%bm#f#g#j%]%`(R(](^(_*y*z*|,],s-q-w-x-y-{1n2f2g5j5{Q%nwQ%rxS%w{%|Q&T!SQ'X!gQ'Z!hQ(f#qS*Q$w*US+^%s%tQ+b%vQ+{&WQ,P&YS-Y'[']Q.V(gQ/Y*RQ0_+_Q0e+eQ0g+fQ0j+jQ1O+|S1S,Q,RQ2W-ZQ3f/UQ4^0aQ4b0dQ4g0lQ5R1TQ6c3gQ6x4`Q6{4dQ8b6wR9W8cv$yi#v%V%W%[)y){*T*i*j.^/]/{3e3}8W;_;g;h!S%px!h!s%r%s%t&{'Z'[']'a'k*]+^+_,v-Y-Z-b/g0_2P2W2_3yQ+W%nQ+q&QQ+t&RQ,O&YQ.U(fQ0}+{U1R,P,Q,RQ2o.VQ4|1OS5Q1S1TQ7c5R!z;c#t$b$c$w$z)p)|*Z+U+X+p+s.S/^/`0p0s0{2m3o3w4V4X4z6O6f6o7[7{8k8}9]9e:]:_:a:h:j:l:p:r:v;k;lg;d:W:X:^:`:b:i:k:m:q:s:wW%Oi%Q*k;_S&Q!P&_Q&R!QQ&S!RR+o&O$Z$}i#t#v$b$c$w$z%V%W%[)p)y){)|*T*Z*i*j+U+X+p+s.S.^/]/^/`/{0p0s0{2m3e3o3w3}4V4X4z6O6f6o7[7{8W8k8}9]9e:W:X:]:^:_:`:a:b:h:i:j:k:l:m:p:q:r:s:v:w;_;g;h;k;lT)q$t)rV*o%U:Z:[U'Q!d%a,|S(t#x#yQ+i%yS.O(b(cQ0t+uQ4O/xR7R4m&zkOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$Z$`$d$l%e%k%x&a&d&e&h&j&k&m&q&y&}'W'h'x'z(Q(X(m(q(u)i)t*w*{+V,^,a,f,r,u-V-_-m-s.T.a.h.p/y0O0`0|1^1_1a1c1f1i1k1z2[2b2n2v3]4o4q4{5]5^5a5k5t6R7Y7_7n7x8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;b$i$_c#W#c%i%j%l'w'}(i(p(x(y(z({(|(})O)P)Q)R)S)U)X)])g+S+h,w-f-k-p-r.].c.g.i.j.k.z/|1u1x2Y2a2u2z2{2|2}3O3P3Q3R3S3T3U3V3W3Z3[3a4S4[5m5s5x6U6V6[6]7T7r7v8P8T8U8z9Y9a9r;UT#RV#S&{kOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$Z$`$d$l%e%k%x&a&d&e&h&j&k&m&q&y&}'W'h'x'z(Q(X(m(q(u)i)t*w*{+V,^,a,f,r,u-V-_-m-s.T.a.h.p/y0O0`0|1^1_1a1c1f1i1k1z2[2b2n2v3]4o4q4{5]5^5a5k5t6R7Y7_7n7x8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bQ'O!dR1{,yv!mQ!d!q!t!w!x&|'T'U'b'c'd,y-P-R-c0y4t4vS*]${*cS/g*^*eQ/p*fQ0v+wQ3y/oR3|/rlqOXs!Y#b%e&h&j&k&m,a,f1f1iQ&o!]Q'l!vS(h#s9xQ+[%qQ+y&TQ+z&VQ-W'YQ-e'eS.[(m:eS/}*w:nQ0]+]Q0x+xQ1m,hQ1o,iQ1w,tQ2U-XQ2X-]S4T0O:tQ4Y0^S4]0`:uQ5l1yQ5p2VQ5u2^Q6v4ZQ7s5nQ7t5qQ7w5vR8w7p$d$^c#W#c%j%l'w'}(i(p(x(y(z({(|(})O)P)Q)R)S)U)X)])g+S+h,w-f-k-p-r.].c.g.j.k.z/|1u1x2Y2a2u2z2{2|2}3O3P3Q3R3S3T3U3V3W3Z3[3a4S4[5m5s5x6U6V6[6]7T7r7v8P8T8U8z9Y9a9r;US(e#n'_U*h$|(l3YS+R%i.iQ2k0VQ5}2jQ7}6QR9O8O$d$]c#W#c%j%l'w'}(i(p(x(y(z({(|(})O)P)Q)R)S)U)X)])g+S+h,w-f-k-p-r.].c.g.j.k.z/|1u1x2Y2a2u2z2{2|2}3O3P3Q3R3S3T3U3V3W3Z3[3a4S4[5m5s5x6U6V6[6]7T7r7v8P8T8U8z9Y9a9r;US(d#n'_S(v#y$^S+Q%i.iS.P(c(eQ.l)WQ0S+RR2h.Q&zkOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$Z$`$d$l%e%k%x&a&d&e&h&j&k&m&q&y&}'W'h'x'z(Q(X(m(q(u)i)t*w*{+V,^,a,f,r,u-V-_-m-s.T.a.h.p/y0O0`0|1^1_1a1c1f1i1k1z2[2b2n2v3]4o4q4{5]5^5a5k5t6R7Y7_7n7x8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bS#o]9qQ&j!WQ&k!XQ&m!ZQ&n![R1e,dQ'V!gQ+T%nQ-U'XS.R(f+WQ2S-TW2l.U.V0U0WQ5o2TU5|2i2k2oS7z5}6PS8|7|7}S9c8{9OQ9k9dR9n9lU!uQ'U-RT4r0y4t!O_OXZ`s!U!Y#b#f%]%e&_&a&h&j&k&m(_,a,f-x1f1i]!oQ!q'U-R0y4tT#o]9q%WzOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$`$d%e%k%x&a&d&e&h&j&k&m&q&y'W'h'x'z(Q(X(m(q(u)t*w*{+V,^,a,f-V-_-m-s.T.a.h/y0O0`0|1^1_1a1c1f1i1k2[2b2n2v4q4{5]5^5a5t6R7Y7_7n7xS(t#x#yS.O(b(c!s:{$Z$l&})i,r,u.p1z3]4o5k8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bY!sQ'U-R0y4tQ'a!qS'k!t!wS'm!x4vS-b'b'cQ-d'dR2_-cQ'j!sS(Z#e1`S-a'a'mQ/X*QQ/e*]Q2`-dQ3k/YS3t/f/pQ6b3fS6m3z3|Q8Y6cR8a6pQ#ubQ'i!sS(Y#e1`S([#k*vQ*x%^Q+Y%oQ+`%uU-`'a'j'mQ-t(ZQ/W*QQ/d*]Q/j*`Q0[+ZQ1P+}S2]-a-dQ2e-|S3j/X/YS3s/e/pQ3v/iQ3x/kQ5O1QQ5w2`Q6a3fQ6e3kS6i3t3|Q6n3{Q7a5PS8X6b6cQ8]6jQ8_6mQ8n7bQ9S8YQ9T8^Q9V8aQ9_8oQ9g9UQ;O:yQ;Z;SR;[;TV!uQ'U-R%WaOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$`$d%e%k%x&a&d&e&h&j&k&m&q&y'W'h'x'z(Q(X(m(q(u)t*w*{+V,^,a,f-V-_-m-s.T.a.h/y0O0`0|1^1_1a1c1f1i1k2[2b2n2v4q4{5]5^5a5t6R7Y7_7n7xS#uy!i!r:x$Z$l&})i,r,u.p1z3]4o5k8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bR;O;a%WbOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$`$d%e%k%x&a&d&e&h&j&k&m&q&y'W'h'x'z(Q(X(m(q(u)t*w*{+V,^,a,f-V-_-m-s.T.a.h/y0O0`0|1^1_1a1c1f1i1k2[2b2n2v4q4{5]5^5a5t6R7Y7_7n7xQ%^j!S%ox!h!s%r%s%t&{'Z'[']'a'k*]+^+_,v-Y-Z-b/g0_2P2W2_3yS%uy!iQ+Z%pQ+}&YW1Q,O,P,Q,RU5P1R1S1TS7b5Q5RQ8o7c!r:y$Z$l&})i,r,u.p1z3]4o5k8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bQ;S;`R;T;a$zeOPXYstuv!Y!_!f!n#Q#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$`$d%e%k%x&a&d&h&j&k&m&q&y'W'h'z(Q(X(m(q(u)t*w*{+V,^,a,f-V-_-m-s.T.a.h/y0O0`0|1^1_1a1c1f1i1k2[2b2n2v4q4{5]5^5a5t6R7Y7_7n7xY#`WZ#U#X'x!S%bm#f#g#j%]%`(R(](^(_*y*z*|,],s-q-w-x-y-{1n2f2g5j5{Q,[&e!p:z$Z$l)i,r,u.p1z3]4o5k8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bR:}&}S'R!d%aR1},|$|dOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$`$d%e%k%x&a&d&h&j&k&m&q&y'W'h'x'z(Q(X(m(q(u)t*w*{,^,a,f-V-_-m-s.a.h/y0O0`0|1^1_1a1c1f1i1k2[2b2v4q4{5]5^5a5t7Y7_7n7x!r)V$Z$l&})i,r,u.p1z3]4o5k8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bQ,Z&eQ0V+VQ2j.TQ6Q2nR8O6R!f$Tc#W%i'w'}(i(p)P)Q)R)S)X)]+h-f-k-p-r.].c.z/|2Y2a2u3W4S4[5s5x6U7v8z9r!T:P)U)g,w.i1u1x2z3S3T3U3V3Z3a5m6V6[6]7T7r8P8T8U9Y9a;U!b$Vc#W%i'w'}(i(p)R)S)X)]+h-f-k-p-r.].c.z/|2Y2a2u3W4S4[5s5x6U7v8z9r!P:R)U)g,w.i1u1x2z3U3V3Z3a5m6V6[6]7T7r8P8T8U9Y9a;U!^$Zc#W%i'w'}(i(p)X)]+h-f-k-p-r.].c.z/|2Y2a2u3W4S4[5s5x6U7v8z9rQ3e/Sz;b)U)g,w.i1u1x2z3Z3a5m6V6[6]7T7r8P8T8U9Y9a;UQ;g;iR;h;j&zkOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$Z$`$d$l%e%k%x&a&d&e&h&j&k&m&q&y&}'W'h'x'z(Q(X(m(q(u)i)t*w*{+V,^,a,f,r,u-V-_-m-s.T.a.h.p/y0O0`0|1^1_1a1c1f1i1k1z2[2b2n2v3]4o4q4{5]5^5a5k5t6R7Y7_7n7x8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bS$mh$nR3^.o'RgOPWXYZhstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$Z$`$d$l$n%e%k%x&a&d&e&h&j&k&m&q&y&}'W'h'x'z(Q(X(m(q(u)i)t*w*{+V,^,a,f,r,u-V-_-m-s.T.a.h.o.p/y0O0`0|1^1_1a1c1f1i1k1z2[2b2n2v3]4o4q4{5]5^5a5k5t6R7Y7_7n7x8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bT$if$oQ$gfS)`$j)dR)l$oT$hf$oT)b$j)d'RhOPWXYZhstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$Z$`$d$l$n%e%k%x&a&d&e&h&j&k&m&q&y&}'W'h'x'z(Q(X(m(q(u)i)t*w*{+V,^,a,f,r,u-V-_-m-s.T.a.h.o.p/y0O0`0|1^1_1a1c1f1i1k1z2[2b2n2v3]4o4q4{5]5^5a5k5t6R7Y7_7n7x8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;bT$mh$nQ$phR)k$n%WjOPWXYZstuv!Y!_!f!n#Q#U#X#b#m#s#w#z#}$O$P$Q$R$S$T$U$V$W$X$`$d%e%k%x&a&d&e&h&j&k&m&q&y'W'h'x'z(Q(X(m(q(u)t*w*{+V,^,a,f-V-_-m-s.T.a.h/y0O0`0|1^1_1a1c1f1i1k2[2b2n2v4q4{5]5^5a5t6R7Y7_7n7x!s;`$Z$l&})i,r,u.p1z3]4o5k8g8x9p9s9t9w9x9y9z9{9|9}:O:P:Q:R:S:T:U:Y:c:d:e:g:n:o:t:u;b#alOPXZs!Y!_!n#Q#b#m#z$l%e&a&d&e&h&j&k&m&q&y'W(u)i*{+V,^,a,f-V.T.p/y0|1^1_1a1c1f1i1k2n3]4q4{5]5^5a6R7Y7_7nv$|i#v%V%W%[)y){*T*i*j.^/]/{3e3}8W;_;g;h!z(l#t$b$c$w$z)p)|*Z+U+X+p+s.S/^/`0p0s0{2m3o3w4V4X4z6O6f6o7[7{8k8}9]9e:]:_:a:h:j:l:p:r:v;k;lQ*s%YQ.{)ug3Y:W:X:^:`:b:i:k:m:q:s:wv$xi#v%V%W%[)y){*T*i*j.^/]/{3e3}8W;_;g;hQ*V$yS*`${*cQ*t%ZQ/k*a!z;Q#t$b$c$w$z)p)|*Z+U+X+p+s.S/^/`0p0s0{2m3o3w4V4X4z6O6f6o7[7{8k8}9]9e:]:_:a:h:j:l:p:r:v;k;lf;R:W:X:^:`:b:i:k:m:q:s:wQ;V;cQ;W;dQ;X;eR;Y;fv$|i#v%V%W%[)y){*T*i*j.^/]/{3e3}8W;_;g;h!z(l#t$b$c$w$z)p)|*Z+U+X+p+s.S/^/`0p0s0{2m3o3w4V4X4z6O6f6o7[7{8k8}9]9e:]:_:a:h:j:l:p:r:v;k;lg3Y:W:X:^:`:b:i:k:m:q:s:wloOXs!Y#b%e&h&j&k&m,a,f1f1iQ*Y$zQ,o&tQ,p&vR3n/^$Y$}i#t#v$b$c$w$z%V%W%[)p)y){)|*T*Z*i*j+U+X+p+s.S.^/]/^/`/{0p0s0{2m3e3o3w3}4V4X4z6O6f6o7[7{8W8k8}9]9e:W:X:]:^:_:`:a:b:h:i:j:k:l:m:p:q:r:s:v:w;_;g;h;k;lQ+r&RQ0r+tQ4k0qR7Q4lT*b${*cS*b${*cT4s0y4tS/i*_4qT3{/q7YQ+Y%oQ/j*`Q0[+ZQ1P+}Q5O1QQ7a5PQ8n7bR9_8on)y$u(n*u/[/s/t2s3l4R6`6q9R;P;];^!W:h(j)Z*P*X.Z.w/S/a0T0o0q2r3m3q4j4l6S6T6g6k6s6u8[8`9f;i;j]:i3X6Z8Q9P9Q9op){$u(n*u/Q/[/s/t2s3l4R6`6q9R;P;];^!Y:j(j)Z*P*X.Z.w/S/a0T0o0q2p2r3m3q4j4l6S6T6g6k6s6u8[8`9f;i;j_:k3X6Z8Q8R9P9Q9opnOXs!U!Y#b%e&_&h&j&k&m,a,f1f1iQ&[!TR,^&epnOXs!U!Y#b%e&_&h&j&k&m,a,f1f1iR&[!TQ+v&SR0n+oqnOXs!U!Y#b%e&_&h&j&k&m,a,f1f1iQ0z+{S4y0}1OU7Z4w4x4|S8j7]7^S9Z8i8lQ9h9[R9m9iQ&c!UR,V&_R5V1WS%w{%|R0g+fQ&h!VR,a&iR,g&nT1g,f1iR,k&oQ,j&oR1p,kQ'o!yR-g'oQsOQ#bXT%hs#bQ!|TR'q!|Q#PUR's#PQ)r$tR.x)rQ#SVR'u#SQ#VWU'{#V'|-nQ'|#WR-n'}Q,z'OR1|,zQ._(nR2t._Q.b(pS2w.b2xR2x.cQ-R'UR2Q-RY!qQ'U-R0y4tR'`!qS#]W%`U(S#](T-oQ(T#^R-o(OQ,}'RR2O,}r`OXs!U!Y#b%e&_&a&h&j&k&m,a,f1f1iS#fZ%]U#p`#f-xR-x(_Q(`#hQ-u([W-}(`-u2c5yQ2c-vR5y2dQ)d$jR.q)dQ$nhR)j$nQ$acU)Y$a-j:VQ-j9rR:V)gQ/V*QW3h/V3i6d8ZU3i/W/X/YS6d3j3kR8Z6e#m)w$u(j(n)Z*P*X*p*q*u.X.Y.Z.w/Q/R/S/[/a/s/t0T0o0q2p2q2r2s3X3l3m3q4R4j4l6S6T6X6Y6Z6`6g6k6q6s6u8Q8R8S8[8`9P9Q9R9f9o;P;];^;i;jQ/_*XU3p/_3r6hQ3r/aR6h3qQ*c${R/m*cQ*l%PR/v*lQ4W0TR6t4WQ*}%cR0R*}Q4n0tS7S4n8hR8h7TQ+x&TR0w+xQ4t0yR7W4tQ1V,SS5T1V7eR7e5VQ0b+bW4a0b4c6z8dQ4c0eQ6z4bR8d6{Q+g%wR0h+gQ1i,fR5e1iWrOXs#bQ&l!YQ+P%eQ,`&hQ,b&jQ,c&kQ,e&mQ1d,aS1g,f1iR5d1fQ%gpQ&p!^Q&s!`Q&u!aQ&w!bQ'g!sQ+O%dQ+[%qQ+n%}Q,U&cQ,m&rW-^'a'i'j'mQ-e'eQ/l*bQ0]+]S1Y,V,YQ1q,lQ1r,oQ1s,pQ2X-]W2Z-`-a-d-fQ4Y0^Q4f0kQ4i0oQ4}1PQ5X1[Q5c1eU5r2Y2]2`Q5u2^Q6v4ZQ7O4hQ7P4jQ7V4sQ7`5OQ7f5WS7u5s5wQ7w5vQ8e6|Q8m7aQ8r7gQ8y7vQ9X8fQ9^8nQ9b8zR9j9_Q%qxQ'Y!hQ'e!sU+]%r%s%tQ,t&{U-X'Z'[']S-]'a'kQ/c*]S0^+^+_Q1y,vS2V-Y-ZQ2^-bQ3u/gQ4Z0_Q5n2PQ5q2WQ5v2_R6l3yS$vi;_R*m%QU%Pi%Q;_R/u*kQ$uiS(j#t+XQ(n#vS)Z$b$cQ*P$wQ*X$zQ*p%VQ*q%WQ*u%[Q.X:]Q.Y:_Q.Z:aQ.w)pQ/Q)yQ/R){Q/S)|Q/[*TQ/a*ZQ/s*iQ/t*jh0T+U.S0{2m4z6O7[7{8k8}9]9eQ0o+pQ0q+sQ2p:hQ2q:jQ2r:lQ2s.^S3X:W:XQ3l/]Q3m/^Q3q/`Q4R/{Q4j0pQ4l0sQ6S:pQ6T:rQ6X:^Q6Y:`Q6Z:bQ6`3eQ6g3oQ6k3wQ6q3}Q6s4VQ6u4XQ8Q:mQ8R:iQ8S:kQ8[6fQ8`6oQ9P:qQ9Q:sQ9R8WQ9f:vQ9o:wQ;P;_Q;];gQ;^;hQ;i;kR;j;llpOXs!Y#b%e&h&j&k&m,a,f1f1iQ!ePS#dZ#mQ&r!_U'^!n4q7YQ't#QQ(w#zQ)h$lS,Y&a&dQ,_&eQ,l&qQ,q&yQ-T'WQ.e(uQ.u)iQ0P*{Q0W+VQ1b,^Q2T-VQ2k.TQ3`.pQ4P/yQ4x0|Q5Z1^Q5[1_Q5`1aQ5b1cQ5g1kQ5}2nQ6^3]Q7^4{Q7j5]Q7k5^Q7m5aQ7}6RQ8l7_R8v7n#UcOPXZs!Y!_!n#b#m#z%e&a&d&e&h&j&k&m&q&y'W(u*{+V,^,a,f-V.T/y0|1^1_1a1c1f1i1k2n4q4{5]5^5a6R7Y7_7nQ#WWQ#cYQ%itQ%juS%lv!fS'w#U'zQ'}#XQ(i#sQ(p#wQ(x#}Q(y$OQ(z$PQ({$QQ(|$RQ(}$SQ)O$TQ)P$UQ)Q$VQ)R$WQ)S$XQ)U$ZQ)X$`Q)]$dW)g$l)i.p3]Q+S%kQ+h%xS,w&}1zQ-f'hS-k'x-mQ-p(QQ-r(XQ.](mQ.c(qQ.g9pQ.i9sQ.j9tQ.k9wQ.z)tQ/|*wQ1u,rQ1x,uQ2Y-_Q2a-sQ2u.aQ2z9xQ2{9yQ2|9zQ2}9{Q3O9|Q3P9}Q3Q:OQ3R:PQ3S:QQ3T:RQ3U:SQ3V:TQ3W.hQ3Z:YQ3[:cQ3a:UQ4S0OQ4[0`Q5m:dQ5s2[Q5x2bQ6U2vQ6V:eQ6[:gQ6]:nQ7T4oQ7r5kQ7v5tQ8P:oQ8T:tQ8U:uQ8z7xQ9Y8gQ9a8xQ9r#QR;U;bR#YWR'P!dY!sQ'U-R0y4tS&{!d,yQ'a!qS'k!t!wS'm!x4vS,v&|'TS-b'b'cQ-d'dQ2P-PR2_-cR(o#vR(r#wQ!eQT-Q'U-R]!pQ!q'U-R0y4tQ#n]R'_9qT#iZ%]S#hZ%]S%cm,]U([#f#g#jS-v(](^Q-z(_Q0Q*|Q2d-wU2e-x-y-{S5z2f2gR7y5{`#[W#U#X%`'x(R*y-qr#eZm#f#g#j%](](^(_*|-w-x-y-{2f2g5{Q1`,]Q1v,sQ5i1nQ7q5jT:|&}*zT#_W%`S#^W%`S'y#U(RS(O#X*yS,x&}*zT-l'x-qT'S!d%aQ$jfR)n$oT)c$j)dR3_.oT*S$w*UR*[$zQ0U+UQ2i.SQ4w0{Q6P2mQ7]4zQ7|6OQ8i7[Q8{7{Q9[8kQ9d8}Q9i9]R9l9elqOXs!Y#b%e&h&j&k&m,a,f1f1iQ&b!UR,U&_rmOXs!T!U!Y#b%e&_&h&j&k&m,a,f1f1iR,]&eT%dm,]R0u+uR,T&]Q%{{R+m%|R+c%vT&f!V&iT&g!V&iT1h,f1i",nodeNames:" ArithOp ArithOp LineComment BlockComment Script ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > TypeParamList TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . ?. PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewExpression new TypeArgList CompareOp < ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in const CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXStartTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast ArrowFunction TypeParamList SequenceExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:366,context:gy,nodeProps:[["group",-26,6,14,16,62,199,203,207,208,210,213,216,226,228,234,236,238,240,243,249,255,257,259,261,263,265,266,"Statement",-32,10,11,25,28,29,35,45,48,49,51,56,64,72,76,78,80,81,103,104,113,114,131,134,136,137,138,139,141,142,162,163,165,"Expression",-23,24,26,30,34,36,38,166,168,170,171,173,174,175,177,178,179,181,182,183,193,195,197,198,"Type",-3,84,96,102,"ClassItem"],["openedBy",31,"InterpolationStart",50,"[",54,"{",69,"(",143,"JSXStartTag",155,"JSXStartTag JSXStartCloseTag"],["closedBy",33,"InterpolationEnd",44,"]",55,"}",70,")",144,"JSXSelfCloseEndTag JSXEndTag",160,"JSXEndTag"]],propSources:[by],skippedNodes:[0,3,4,269],repeatNodeCount:33,tokenData:"$>y(CSR!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tu>PuvBavwDxwxGgxyMvyz! Qz{!![{|!%O|}!&]}!O!%O!O!P!'g!P!Q!1w!Q!R#0t!R![#3T![!]#@T!]!^#Aa!^!_#Bk!_!`#GS!`!a#In!a!b#N{!b!c$$z!c!}>P!}#O$&U#O#P$'`#P#Q$,w#Q#R$.R#R#S>P#S#T$/`#T#o$0j#o#p$4z#p#q$5p#q#r$7Q#r#s$8^#s$f%Z$f$g+g$g#BY>P#BY#BZ$9h#BZ$IS>P$IS$I_$9h$I_$I|>P$I|$I}$<s$I}$JO$<s$JO$JT>P$JT$JU$9h$JU$KV>P$KV$KW$9h$KW&FU>P&FU&FV$9h&FV;'S>P;'S;=`BZ<%l?HT>P?HT?HU$9h?HUO>P(n%d_$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$d&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$d&j'{!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU'{!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$d&j'xpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU'xpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX'xp'{!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z(CS+rq$d&j'xp'{!b'n(;dOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z(CS.ST'y#S$d&j'o(;dO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c(CS.n_$d&j'xp'{!b'o(;dOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`/x`$d&j!l$Ip'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S1V`#q$Id$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S2d_#q$Id$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$2b3l_'w$(n$d&j'{!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k*r4r_$d&j'{!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k)`5vX$d&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q)`6jT$_#t$d&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#t6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y#t7bO$_#t#t7eP;=`<%l6y)`7kP;=`<%l5q*r7w]$_#t$d&j'{!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}%W8uZ'{!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p%W9oU$_#t'{!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}%W:UP;=`<%l8p*r:[P;=`<%l4k#%|:hg$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}st%Ztu<Puw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}<P!}#O%Z#O#P&c#P#R%Z#R#S<P#S#T%Z#T#o<P#o#p*g#p$g%Z$g;'S<P;'S;=`=y<%lO<P#%|<[i$d&j(b!L^'xp'{!bOY%ZYZ&cZr%Zrs&}st%Ztu<Puw%Zwx(rx!Q%Z!Q![<P![!^%Z!^!_*g!_!c%Z!c!}<P!}#O%Z#O#P&c#P#R%Z#R#S<P#S#T%Z#T#o<P#o#p*g#p$g%Z$g;'S<P;'S;=`=y<%lO<P#%|=|P;=`<%l<P(CS>`k$d&j'xp'{!b(V!LY'u&;d$W#tOY%ZYZ&cZr%Zrs&}st%Ztu>Puw%Zwx(rx}%Z}!O@T!O!Q%Z!Q![>P![!^%Z!^!_*g!_!c%Z!c!}>P!}#O%Z#O#P&c#P#R%Z#R#S>P#S#T%Z#T#o>P#o#p*g#p$g%Z$g;'S>P;'S;=`BZ<%lO>P+d@`k$d&j'xp'{!b$W#tOY%ZYZ&cZr%Zrs&}st%Ztu@Tuw%Zwx(rx}%Z}!O@T!O!Q%Z!Q![@T![!^%Z!^!_*g!_!c%Z!c!}@T!}#O%Z#O#P&c#P#R%Z#R#S@T#S#T%Z#T#o@T#o#p*g#p$g%Z$g;'S@T;'S;=`BT<%lO@T+dBWP;=`<%l@T(CSB^P;=`<%l>P%#SBl`$d&j'xp'{!b#i$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SCy_$d&j#{$Id'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%DfETa(k%<v$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sv%ZvwFYwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SFe`$d&j#u$Id'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$2bGp_'z$)`$d&j'xpOYHoYZIuZrHorsIuswHowxKVx!^Ho!^!_LX!_#OHo#O#PIu#P#oHo#o#pLX#p;'SHo;'S;=`Mp<%lOHo*QHv_$d&j'xpOYHoYZIuZrHorsIuswHowxKVx!^Ho!^!_LX!_#OHo#O#PIu#P#oHo#o#pLX#p;'SHo;'S;=`Mp<%lOHo)`IzX$d&jOwIuwx6cx!^Iu!^!_Jg!_#oIu#o#pJg#p;'SIu;'S;=`KP<%lOIu#tJjTOwJgwx7]x;'SJg;'S;=`Jy<%lOJg#tJ|P;=`<%lJg)`KSP;=`<%lIu*QK`]$_#t$d&j'xpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r$fL^Z'xpOYLXYZJgZrLXrsJgswLXwxMPx#OLX#O#PJg#P;'SLX;'S;=`Mj<%lOLX$fMWU$_#t'xpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r$fMmP;=`<%lLX*QMsP;=`<%lHo(*QNR_!h(!b$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'l! ]_!gM|$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h!!ib$d&j'xp'{!b'v#)d#j$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!#q{!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S!#|`$d&j'xp'{!b#g$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&-O!%Z`$d&j'xp'{!bk&%`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&C[!&h_!V&;l$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!'rc$d&j'xp'{!by'<nOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!(}!P!Q%Z!Q![!+g![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!)Wa$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!*]!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!*h_!UMt$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!+rg$d&j'xp'{!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!+g![!^%Z!^!_*g!_!g%Z!g!h!-Z!h#O%Z#O#P&c#P#R%Z#R#S!+g#S#X%Z#X#Y!-Z#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!-dg$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!.{|}%Z}!O!.{!O!Q%Z!Q![!0a![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!0a#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!/Uc$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!0a![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!0a#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!0lc$d&j'xp'{!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!0a![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!0a#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!2Sf$d&j'xp'{!b#h$IdOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}xz!3hz{#$s{!P!3h!P!Q#&Y!Q!^!3h!^!_!Mh!_!`#-x!`!a#/_!a!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h(r!3sb$d&j'xp'{!b!RSOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}x!P!3h!P!Q!Kh!Q!^!3h!^!_!Mh!_!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h(Q!5U`$d&j'{!b!RSOY!4{YZ&cZw!4{wx!6Wx!P!4{!P!Q!=o!Q!^!4{!^!_!?g!_!}!4{!}#O!Bn#O#P!<w#P#o!4{#o#p!?g#p;'S!4{;'S;=`!Cw<%lO!4{&n!6_^$d&j!RSOY!6WYZ&cZ!P!6W!P!Q!7Z!Q!^!6W!^!_!8g!_!}!6W!}#O!;U#O#P!<w#P#o!6W#o#p!8g#p;'S!6W;'S;=`!=i<%lO!6W&n!7ba$d&j!RSO!^&c!_#Z&c#Z#[!7Z#[#]&c#]#^!7Z#^#a&c#a#b!7Z#b#g&c#g#h!7Z#h#i&c#i#j!7Z#j#m&c#m#n!7Z#n#o&c#p;'S&c;'S;=`&w<%lO&cS!8lX!RSOY!8gZ!P!8g!P!Q!9X!Q!}!8g!}#O!9p#O#P!:o#P;'S!8g;'S;=`!;O<%lO!8gS!9^U!RS#Z#[!9X#]#^!9X#a#b!9X#g#h!9X#i#j!9X#m#n!9XS!9sVOY!9pZ#O!9p#O#P!:Y#P#Q!8g#Q;'S!9p;'S;=`!:i<%lO!9pS!:]SOY!9pZ;'S!9p;'S;=`!:i<%lO!9pS!:lP;=`<%l!9pS!:rSOY!8gZ;'S!8g;'S;=`!;O<%lO!8gS!;RP;=`<%l!8g&n!;Z[$d&jOY!;UYZ&cZ!^!;U!^!_!9p!_#O!;U#O#P!<P#P#Q!6W#Q#o!;U#o#p!9p#p;'S!;U;'S;=`!<q<%lO!;U&n!<UX$d&jOY!;UYZ&cZ!^!;U!^!_!9p!_#o!;U#o#p!9p#p;'S!;U;'S;=`!<q<%lO!;U&n!<tP;=`<%l!;U&n!<|X$d&jOY!6WYZ&cZ!^!6W!^!_!8g!_#o!6W#o#p!8g#p;'S!6W;'S;=`!=i<%lO!6W&n!=lP;=`<%l!6W(Q!=xi$d&j'{!b!RSOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#Z&}#Z#[!=o#[#]&}#]#^!=o#^#a&}#a#b!=o#b#g&}#g#h!=o#h#i&}#i#j!=o#j#m&}#m#n!=o#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!f!?nZ'{!b!RSOY!?gZw!?gwx!8gx!P!?g!P!Q!@a!Q!}!?g!}#O!Ap#O#P!:o#P;'S!?g;'S;=`!Bh<%lO!?g!f!@hb'{!b!RSOY'}Zw'}x#O'}#P#Z'}#Z#[!@a#[#]'}#]#^!@a#^#a'}#a#b!@a#b#g'}#g#h!@a#h#i'}#i#j!@a#j#m'}#m#n!@a#n;'S'};'S;=`(f<%lO'}!f!AuX'{!bOY!ApZw!Apwx!9px#O!Ap#O#P!:Y#P#Q!?g#Q;'S!Ap;'S;=`!Bb<%lO!Ap!f!BeP;=`<%l!Ap!f!BkP;=`<%l!?g(Q!Bu^$d&j'{!bOY!BnYZ&cZw!Bnwx!;Ux!^!Bn!^!_!Ap!_#O!Bn#O#P!<P#P#Q!4{#Q#o!Bn#o#p!Ap#p;'S!Bn;'S;=`!Cq<%lO!Bn(Q!CtP;=`<%l!Bn(Q!CzP;=`<%l!4{'`!DW`$d&j'xp!RSOY!C}YZ&cZr!C}rs!6Ws!P!C}!P!Q!EY!Q!^!C}!^!_!GQ!_!}!C}!}#O!JX#O#P!<w#P#o!C}#o#p!GQ#p;'S!C};'S;=`!Kb<%lO!C}'`!Eci$d&j'xp!RSOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#Z(r#Z#[!EY#[#](r#]#^!EY#^#a(r#a#b!EY#b#g(r#g#h!EY#h#i(r#i#j!EY#j#m(r#m#n!EY#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rt!GXZ'xp!RSOY!GQZr!GQrs!8gs!P!GQ!P!Q!Gz!Q!}!GQ!}#O!IZ#O#P!:o#P;'S!GQ;'S;=`!JR<%lO!GQt!HRb'xp!RSOY)rZr)rs#O)r#P#Z)r#Z#[!Gz#[#])r#]#^!Gz#^#a)r#a#b!Gz#b#g)r#g#h!Gz#h#i)r#i#j!Gz#j#m)r#m#n!Gz#n;'S)r;'S;=`*Z<%lO)rt!I`X'xpOY!IZZr!IZrs!9ps#O!IZ#O#P!:Y#P#Q!GQ#Q;'S!IZ;'S;=`!I{<%lO!IZt!JOP;=`<%l!IZt!JUP;=`<%l!GQ'`!J`^$d&j'xpOY!JXYZ&cZr!JXrs!;Us!^!JX!^!_!IZ!_#O!JX#O#P!<P#P#Q!C}#Q#o!JX#o#p!IZ#p;'S!JX;'S;=`!K[<%lO!JX'`!K_P;=`<%l!JX'`!KeP;=`<%l!C}(r!Ksk$d&j'xp'{!b!RSOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#Z%Z#Z#[!Kh#[#]%Z#]#^!Kh#^#a%Z#a#b!Kh#b#g%Z#g#h!Kh#h#i%Z#i#j!Kh#j#m%Z#m#n!Kh#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#W!Mq]'xp'{!b!RSOY!MhZr!Mhrs!?gsw!Mhwx!GQx!P!Mh!P!Q!Nj!Q!}!Mh!}#O#!U#O#P!:o#P;'S!Mh;'S;=`##U<%lO!Mh#W!Nse'xp'{!b!RSOY*gZr*grs'}sw*gwx)rx#O*g#P#Z*g#Z#[!Nj#[#]*g#]#^!Nj#^#a*g#a#b!Nj#b#g*g#g#h!Nj#h#i*g#i#j!Nj#j#m*g#m#n!Nj#n;'S*g;'S;=`+Z<%lO*g#W#!]Z'xp'{!bOY#!UZr#!Urs!Apsw#!Uwx!IZx#O#!U#O#P!:Y#P#Q!Mh#Q;'S#!U;'S;=`##O<%lO#!U#W##RP;=`<%l#!U#W##XP;=`<%l!Mh(r##e`$d&j'xp'{!bOY##[YZ&cZr##[rs!Bnsw##[wx!JXx!^##[!^!_#!U!_#O##[#O#P!<P#P#Q!3h#Q#o##[#o#p#!U#p;'S##[;'S;=`#$g<%lO##[(r#$jP;=`<%l##[(r#$pP;=`<%l!3h(CS#%Qb$d&j'xp'{!b'p(;d!RSOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}x!P!3h!P!Q!Kh!Q!^!3h!^!_!Mh!_!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h(CS#&e_$d&j'xp'{!bR(;dOY#&YYZ&cZr#&Yrs#'dsw#&Ywx#*tx!^#&Y!^!_#,s!_#O#&Y#O#P#(f#P#o#&Y#o#p#,s#p;'S#&Y;'S;=`#-r<%lO#&Y(Bb#'m]$d&j'{!bR(;dOY#'dYZ&cZw#'dwx#(fx!^#'d!^!_#)w!_#O#'d#O#P#(f#P#o#'d#o#p#)w#p;'S#'d;'S;=`#*n<%lO#'d(AO#(mX$d&jR(;dOY#(fYZ&cZ!^#(f!^!_#)Y!_#o#(f#o#p#)Y#p;'S#(f;'S;=`#)q<%lO#(f(;d#)_SR(;dOY#)YZ;'S#)Y;'S;=`#)k<%lO#)Y(;d#)nP;=`<%l#)Y(AO#)tP;=`<%l#(f(<v#*OW'{!bR(;dOY#)wZw#)wwx#)Yx#O#)w#O#P#)Y#P;'S#)w;'S;=`#*h<%lO#)w(<v#*kP;=`<%l#)w(Bb#*qP;=`<%l#'d(Ap#*}]$d&j'xpR(;dOY#*tYZ&cZr#*trs#(fs!^#*t!^!_#+v!_#O#*t#O#P#(f#P#o#*t#o#p#+v#p;'S#*t;'S;=`#,m<%lO#*t(<U#+}W'xpR(;dOY#+vZr#+vrs#)Ys#O#+v#O#P#)Y#P;'S#+v;'S;=`#,g<%lO#+v(<U#,jP;=`<%l#+v(Ap#,pP;=`<%l#*t(=h#,|Y'xp'{!bR(;dOY#,sZr#,srs#)wsw#,swx#+vx#O#,s#O#P#)Y#P;'S#,s;'S;=`#-l<%lO#,s(=h#-oP;=`<%l#,s(CS#-uP;=`<%l#&Y%#W#.Vb$d&j#{$Id'xp'{!b!RSOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}x!P!3h!P!Q!Kh!Q!^!3h!^!_!Mh!_!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h+h#/lb$T#t$d&j'xp'{!b!RSOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}x!P!3h!P!Q!Kh!Q!^!3h!^!_!Mh!_!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h$/l#1Pp$d&j'xp'{!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!+g!P!Q%Z!Q![#3T![!^%Z!^!_*g!_!g%Z!g!h!-Z!h#O%Z#O#P&c#P#R%Z#R#S#3T#S#U%Z#U#V#6_#V#X%Z#X#Y!-Z#Y#b%Z#b#c#5T#c#d#9g#d#l%Z#l#m#<i#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#3`k$d&j'xp'{!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!+g!P!Q%Z!Q![#3T![!^%Z!^!_*g!_!g%Z!g!h!-Z!h#O%Z#O#P&c#P#R%Z#R#S#3T#S#X%Z#X#Y!-Z#Y#b%Z#b#c#5T#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#5`_$d&j'xp'{!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#6hd$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#7v!R!S#7v!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#7v#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#8Rf$d&j'xp'{!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#7v!R!S#7v!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#7v#S#b%Z#b#c#5T#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#9pc$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#:{!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#:{#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#;We$d&j'xp'{!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#:{!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#:{#S#b%Z#b#c#5T#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#<rg$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#>Z![!^%Z!^!_*g!_!c%Z!c!i#>Z!i#O%Z#O#P&c#P#R%Z#R#S#>Z#S#T%Z#T#Z#>Z#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#>fi$d&j'xp'{!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#>Z![!^%Z!^!_*g!_!c%Z!c!i#>Z!i#O%Z#O#P&c#P#R%Z#R#S#>Z#S#T%Z#T#Z#>Z#Z#b%Z#b#c#5T#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh#@b_!a$b$d&j#y%<f'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Al_^l$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS#Bz^(O!*v!e'.r'xp'{!b$U)d(oSOY*gZr*grs'}sw*gwx)rx!P*g!P!Q#Cv!Q!^*g!^!_#Dl!_!`#F^!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#DPX$f&j'xp'{!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#DuZ#k$Id'xp'{!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Eh!`#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#EqX#{$Id'xp'{!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#FgX#l$Id'xp'{!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Gh#G_a#X%?x$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a#Hd!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#W#Ho_#d$Ih$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh#I}adBf#l$Id$a#|$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`#KS!`!a#L^!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S#K__#l$Id$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S#Lia#k$Id$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`!a#Mn!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S#My`#k$Id$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h$ Wc(c$Ip$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P$!c!P!^%Z!^!_*g!_!a%Z!a!b$#m!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+`$!n_z'#p$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$#x`$d&j#v$Id'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&^$%V_!x!Ln$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(@^$&a_|(8n$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$'eZ$d&jO!^$(W!^!_$(n!_#i$(W#i#j$(s#j#l$(W#l#m$*f#m#o$(W#o#p$(n#p;'S$(W;'S;=`$,q<%lO$(W(n$(_T[#S$d&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$(sO[#S(n$(x[$d&jO!Q&c!Q![$)n![!^&c!_!c&c!c!i$)n!i#T&c#T#Z$)n#Z#o&c#o#p$,U#p;'S&c;'S;=`&w<%lO&c(n$)sZ$d&jO!Q&c!Q![$*f![!^&c!_!c&c!c!i$*f!i#T&c#T#Z$*f#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$*kZ$d&jO!Q&c!Q![$+^![!^&c!_!c&c!c!i$+^!i#T&c#T#Z$+^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$+cZ$d&jO!Q&c!Q![$(W![!^&c!_!c&c!c!i$(W!i#T&c#T#Z$(W#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$,XR!Q![$,b!c!i$,b#T#Z$,b#S$,eS!Q![$,b!c!i$,b#T#Z$,b#q#r$(n(n$,tP;=`<%l$(W!'l$-S_!SM|$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$.^`#s$Id$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&,v$/k_$d&j'xp'{!b(S&%WOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$0yk$d&j'xp'{!b(V!LY'u&;d$Y#tOY%ZYZ&cZr%Zrs&}st%Ztu$0juw%Zwx(rx}%Z}!O$2n!O!Q%Z!Q![$0j![!^%Z!^!_*g!_!c%Z!c!}$0j!}#O%Z#O#P&c#P#R%Z#R#S$0j#S#T%Z#T#o$0j#o#p*g#p$g%Z$g;'S$0j;'S;=`$4t<%lO$0j+d$2yk$d&j'xp'{!b$Y#tOY%ZYZ&cZr%Zrs&}st%Ztu$2nuw%Zwx(rx}%Z}!O$2n!O!Q%Z!Q![$2n![!^%Z!^!_*g!_!c%Z!c!}$2n!}#O%Z#O#P&c#P#R%Z#R#S$2n#S#T%Z#T#o$2n#o#p*g#p$g%Z$g;'S$2n;'S;=`$4n<%lO$2n+d$4qP;=`<%l$2n(CS$4wP;=`<%l$0j!5p$5TX!X!3l'xp'{!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Df$5{a(j%<v$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$#m#q;'S%Z;'S;=`+a<%lO%Z%#`$7__!W$I`o`$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(r$8i_!mS$d&j'xp'{!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$9y|$d&j'xp'{!b'n(;d(V!LY'u&;d$W#tOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%Ztu>Puw%Zwx(rx}%Z}!O@T!O!Q%Z!Q![>P![!^%Z!^!_*g!_!c%Z!c!}>P!}#O%Z#O#P&c#P#R%Z#R#S>P#S#T%Z#T#o>P#o#p*g#p$f%Z$f$g+g$g#BY>P#BY#BZ$9h#BZ$IS>P$IS$I_$9h$I_$JT>P$JT$JU$9h$JU$KV>P$KV$KW$9h$KW&FU>P&FU&FV$9h&FV;'S>P;'S;=`BZ<%l?HT>P?HT?HU$9h?HUO>P(CS$=Uk$d&j'xp'{!b'o(;d(V!LY'u&;d$W#tOY%ZYZ&cZr%Zrs&}st%Ztu>Puw%Zwx(rx}%Z}!O@T!O!Q%Z!Q![>P![!^%Z!^!_*g!_!c%Z!c!}>P!}#O%Z#O#P&c#P#R%Z#R#S>P#S#T%Z#T#o>P#o#p*g#p$g%Z$g;'S>P;'S;=`BZ<%lO>P",tokenizers:[yy,vy,2,3,4,5,6,7,8,9,10,11,12,13,Oy,new xa("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOq~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!O~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(U~~",141,327),new xa("j~RQYZXz{^~^O'r~~aP!P!Qd~iO's~~",25,309)],topRules:{Script:[0,5],SingleExpression:[1,267],SingleClassItem:[2,268]},dialects:{jsx:12810,ts:12812},dynamicPrecedences:{76:1,78:1,163:1,191:1},specialized:[{term:313,get:e=>wy[e]||-1},{term:329,get:e=>xy[e]||-1},{term:67,get:e=>Sy[e]||-1}],tokenPrec:12836}),Ay=[Jp("function ${name}(${params}) {\n\t${}\n}",{label:"function",detail:"definition",type:"keyword"}),Jp("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n\t${}\n}",{label:"for",detail:"loop",type:"keyword"}),Jp("for (let ${name} of ${collection}) {\n\t${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Jp("do {\n\t${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Jp("while (${}) {\n\t${}\n}",{label:"while",detail:"loop",type:"keyword"}),Jp("try {\n\t${}\n} catch (${error}) {\n\t${}\n}",{label:"try",detail:"/ catch block",type:"keyword"}),Jp("if (${}) {\n\t${}\n}",{label:"if",detail:"block",type:"keyword"}),Jp("if (${}) {\n\t${}\n} else {\n\t${}\n}",{label:"if",detail:"/ else block",type:"keyword"}),Jp("class ${name} {\n\tconstructor(${params}) {\n\t\t${}\n\t}\n}",{label:"class",detail:"definition",type:"keyword"}),Jp('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Jp('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],Cy=new Wo,_y=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Ey(e){return(t,n)=>{let i=t.node.getChild("VariableDefinition");return i&&n(i,e),!0}}var Ty=["FunctionDeclaration"],Py={FunctionDeclaration:Ey("function"),ClassDeclaration:Ey("class"),ClassExpression:()=>!0,EnumDeclaration:Ey("constant"),TypeAliasDeclaration:Ey("type"),NamespaceDeclaration:Ey("namespace"),VariableDefinition(e,t){e.matchContext(Ty)||t(e,"variable")},TypeDefinition(e,t){t(e,"type")},__proto__:null};function $y(e,t){let n=Cy.get(t);if(n)return n;let i=[],r=!0;function s(t,n){let r=e.sliceString(t.from,t.to);i.push({label:r,type:n})}return t.cursor(Eo.IncludeAnonymous).iterate((t=>{if(r)r=!1;else if(t.name){let e=Py[t.name];if(e&&e(t,s)||_y.has(t.name))return!1}else if(t.to-t.from>8192){for(let n of $y(e,t.node))i.push(n);return!1}})),Cy.set(t,i),i}var Ny=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,Iy=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName",".","?."];function Qy(e){let t=Nl(e.state).resolveInner(e.pos,-1);if(Iy.indexOf(t.name)>-1)return null;let n="VariableName"==t.name||t.to-t.from<20&&Ny.test(e.state.sliceDoc(t.from,t.to));if(!n&&!e.explicit)return null;let i=[];for(let n=t;n;n=n.parent)_y.has(n.name)&&(i=i.concat($y(e.state.doc,n)));return{options:i,from:n?t.from:e.pos,validFor:Ny}}var Ry=$l.define({name:"javascript",parser:ky.configure({props:[Wl.add({IfStatement:nh({except:/^\s*({|else\b)/}),TryStatement:nh({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:e=>e.baseIndent,SwitchBody:e=>{let t=e.textAfter,n=/^\s*\}/.test(t),i=/^\s*(case|default)\b/.test(t);return e.baseIndent+(n?0:i?1:2)*e.unit},Block:function({closing:e,align:t=!0,units:n=1}){return i=>th(i,t,n,e)}({closing:"}"}),ArrowFunction:e=>e.baseIndent+e.unit,"TemplateString BlockComment":()=>null,"Statement Property":nh({except:/^{/}),JSXElement(e){let t=/^\s*<\//.test(e.textAfter);return e.lineIndent(e.node.from)+(t?0:e.unit)},JSXEscape(e){let t=/\s*\}/.test(e.textAfter);return e.lineIndent(e.node.from)+(t?0:e.unit)},"JSXOpenTag JSXSelfClosingTag":e=>e.column(e.node.from)+e.unit}),rh.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":sh,BlockComment:e=>({from:e.from+2,to:e.to-2})})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),My={test:e=>/^JSX/.test(e.name),facet:_l({commentTokens:{block:{open:"{/*",close:"*/}"}}})},By=Ry.configure({dialect:"ts"},"typescript"),Dy=Ry.configure({dialect:"jsx",props:[El.add((e=>e.isTop?[My]:void 0))]}),Xy=Ry.configure({dialect:"jsx ts",props:[El.add((e=>e.isTop?[My]:void 0))]},"typescript"),Fy="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map((e=>({label:e,type:"keyword"})));function Ly(e={}){let t=e.jsx?e.typescript?Xy:Dy:e.typescript?By:Ry;return new Ll(t,[Ry.data.of({autocomplete:ip(Iy,np(Ay.concat(Fy)))}),Ry.data.of({autocomplete:Qy}),e.jsx?zy:[]])}function Uy(e,t,n=e.length){for(let i=t?.firstChild;i;i=i.nextSibling)if("JSXIdentifier"==i.name||"JSXBuiltin"==i.name||"JSXNamespacedName"==i.name||"JSXMemberExpression"==i.name)return e.sliceString(i.from,Math.min(i.to,n));return""}var Vy="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),zy=Lr.inputHandler.of(((e,t,n,i)=>{if((Vy?e.composing:e.compositionStarted)||e.state.readOnly||t!=n||">"!=i&&"/"!=i||!Ry.isActiveAt(e.state,t,-1))return!1;let{state:r}=e,s=r.changeByRange((e=>{var t;let n,{head:s}=e,o=Nl(r).resolveInner(s,-1);if("JSXStartTag"==o.name&&(o=o.parent),!("JSXAttributeValue"==o.name&&o.to>s)){if(">"==i&&"JSXFragmentTag"==o.name)return{range:X.cursor(s+1),changes:{from:s,insert:"></>"}};if("/"==i&&"JSXFragmentTag"==o.name){let e=o.parent,i=e?.parent;if(e.from==s-1&&"JSXEndTag"!=(null===(t=i.lastChild)||void 0===t?void 0:t.name)&&(n=Uy(r.doc,i?.firstChild,s))){let e=`/${n}>`;return{range:X.cursor(s+e.length),changes:{from:s,insert:e}}}}else if(">"==i){let e=function(e){for(;;){if("JSXOpenTag"==e.name||"JSXSelfClosingTag"==e.name||"JSXFragmentTag"==e.name)return e;if("JSXEscape"==e.name||!e.parent)return null;e=e.parent}}(o);if(e&&!function(e){return e&&("JSXEndTag"==e.name||"JSXSelfCloseEndTag"==e.name)}(e.lastChild)&&"</"!=r.sliceDoc(s,s+2)&&(n=Uy(r.doc,e,s)))return{range:X.cursor(s+1),changes:{from:s,insert:`></${n}>`}}}}return{range:e}}));return!s.changes.empty&&(e.dispatch(s,{userEvent:"input.type",scrollIntoView:!0}),!0)})),Zy=["_blank","_self","_top","_parent"],jy=["ascii","utf-8","utf-16","latin1","latin1"],qy=["get","post","put","delete"],Gy=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],Wy=["true","false"],Hy={},Yy={a:{attrs:{href:null,ping:null,type:null,media:null,target:Zy,hreflang:null}},abbr:Hy,address:Hy,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:Hy,aside:Hy,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:Hy,base:{attrs:{href:null,target:Zy}},bdi:Hy,bdo:Hy,blockquote:{attrs:{cite:null}},body:Hy,br:Hy,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:Gy,formmethod:qy,formnovalidate:["novalidate"],formtarget:Zy,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:Hy,center:Hy,cite:Hy,code:Hy,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:Hy,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:Hy,div:Hy,dl:Hy,dt:Hy,em:Hy,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:Hy,figure:Hy,footer:Hy,form:{attrs:{action:null,name:null,"accept-charset":jy,autocomplete:["on","off"],enctype:Gy,method:qy,novalidate:["novalidate"],target:Zy}},h1:Hy,h2:Hy,h3:Hy,h4:Hy,h5:Hy,h6:Hy,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:Hy,hgroup:Hy,hr:Hy,html:{attrs:{manifest:null}},i:Hy,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:Gy,formmethod:qy,formnovalidate:["novalidate"],formtarget:Zy,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:Hy,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:Hy,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:Hy,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:jy,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:Hy,noscript:Hy,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:Hy,param:{attrs:{name:null,value:null}},pre:Hy,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:Hy,rt:Hy,ruby:Hy,samp:Hy,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:jy}},section:Hy,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:Hy,source:{attrs:{src:null,type:null,media:null}},span:Hy,strong:Hy,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:Hy,summary:Hy,sup:Hy,table:Hy,tbody:Hy,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:Hy,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:Hy,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:Hy,time:{attrs:{datetime:null}},title:Hy,tr:Hy,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:Hy,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:Hy},Jy={accesskey:null,class:null,contenteditable:Wy,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:Wy,autocorrect:Wy,autocapitalize:Wy,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":Wy,"aria-autocomplete":["inline","list","both","none"],"aria-busy":Wy,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":Wy,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":Wy,"aria-hidden":Wy,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":Wy,"aria-multiselectable":Wy,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":Wy,"aria-relevant":null,"aria-required":Wy,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},Ky="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map((e=>"on"+e));for(let e of Ky)Jy[e]=null;var ev=class{constructor(e,t){this.tags=Object.assign(Object.assign({},Yy),e),this.globalAttrs=Object.assign(Object.assign({},Jy),t),this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}};function tv(e,t,n=e.length){if(!t)return"";let i=t.firstChild,r=i&&i.getChild("TagName");return r?e.sliceString(r.from,Math.min(r.to,n)):""}function nv(e,t=!1){for(;e;e=e.parent)if("Element"==e.name){if(!t)return e;t=!1}return null}function iv(e,t,n){return n.tags[tv(e,nv(t))]?.children||n.allTags}function rv(e,t){let n=[];for(let i=nv(t);i&&!i.type.isTop;i=nv(i.parent)){let r=tv(e,i);if(r&&"CloseTag"==i.lastChild.name)break;r&&n.indexOf(r)<0&&("EndTag"==t.name||t.from>=i.firstChild.to)&&n.push(r)}return n}ev.default=new ev;var sv=/^[:\-\.\w\u00b7-\uffff]*$/;function ov(e,t,n,i,r){let s=/\s*>/.test(e.sliceDoc(r,r+5))?"":">",o=nv(n,!0);return{from:i,to:r,options:iv(e.doc,o,t).map((e=>({label:e,type:"type"}))).concat(rv(e.doc,n).map(((e,t)=>({label:"/"+e,apply:"/"+e+s,type:"type",boost:99-t})))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function av(e,t,n,i){let r=/\s*>/.test(e.sliceDoc(i,i+5))?"":">";return{from:n,to:i,options:rv(e.doc,t).map(((e,t)=>({label:e,apply:e+r,type:"type",boost:99-t}))),validFor:sv}}function lv(e,t){let{state:n,pos:i}=t,r=Nl(n).resolveInner(i,-1),s=r.resolve(i);for(let e,t=i;s==r&&(e=r.childBefore(t));){let n=e.lastChild;if(!n||!n.type.isError||n.from<n.to)break;s=r=e,t=n.from}return"TagName"==r.name?r.parent&&/CloseTag$/.test(r.parent.name)?av(n,r,r.from,i):ov(n,e,r,r.from,i):"StartTag"==r.name?ov(n,e,r,i,i):"StartCloseTag"==r.name||"IncompleteCloseTag"==r.name?av(n,r,i,i):"OpenTag"==r.name||"SelfClosingTag"==r.name||"AttributeName"==r.name?function(e,t,n,i,r){let s=nv(n),o=s?t.tags[tv(e.doc,s)]:null,a=o&&o.attrs?Object.keys(o.attrs):[];return{from:i,to:r,options:(o&&!1===o.globalAttrs?a:a.length?a.concat(t.globalAttrNames):t.globalAttrNames).map((e=>({label:e,type:"property"}))),validFor:sv}}(n,e,r,"AttributeName"==r.name?r.from:i,i):"Is"==r.name||"AttributeValue"==r.name||"UnquotedAttributeValue"==r.name?function(e,t,n,i,r){var s;let o,a=null===(s=n.parent)||void 0===s?void 0:s.getChild("AttributeName"),l=[];if(a){let s=e.sliceDoc(a.from,a.to),h=t.globalAttrs[s];if(!h){let i=nv(n),r=i?t.tags[tv(e.doc,i)]:null;h=r?.attrs&&r.attrs[s]}if(h){let t=e.sliceDoc(i,r).toLowerCase(),n='"',s='"';/^['"]/.test(t)?(o='"'==t[0]?/^[^"]*$/:/^[^']*$/,n="",s=e.sliceDoc(r,r+1)==t[0]?"":t[0],t=t.slice(1),i++):o=/^[^\s<>='"]*$/;for(let e of h)l.push({label:e,apply:n+e+s,type:"constant"})}}return{from:i,to:r,options:l,validFor:o}}(n,e,r,"Is"==r.name?i:r.from,i):!t.explicit||"Element"!=s.name&&"Text"!=s.name&&"Document"!=s.name?null:function(e,t,n,i){let r=[],s=0;for(let i of iv(e.doc,n,t))r.push({label:"<"+i,type:"type"});for(let t of rv(e.doc,n))r.push({label:"</"+t+">",type:"type",boost:99-s++});return{from:i,to:i,options:r,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}(n,e,r,i)}function hv(e){let{extraTags:t,extraGlobalAttributes:n}=e,i=n||t?new ev(t,n):ev.default;return e=>lv(i,e)}var cv=Ry.parser.configure({top:"SingleExpression"}),uv=[{tag:"script",attrs:e=>"text/typescript"==e.type||"ts"==e.lang,parser:By.parser},{tag:"script",attrs:e=>"text/babel"==e.type||"text/jsx"==e.type,parser:Dy.parser},{tag:"script",attrs:e=>"text/typescript-jsx"==e.type,parser:Xy.parser},{tag:"script",attrs:e=>/^(importmap|speculationrules|application\/(.+\+)?json)$/i.test(e.type),parser:cv},{tag:"script",attrs:e=>!e.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(e.type),parser:Ry.parser},{tag:"style",attrs:e=>(!e.lang||"css"==e.lang)&&(!e.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(e.type)),parser:$O.parser}],dv=[{name:"style",parser:$O.parser.configure({top:"Styles"})}].concat(Ky.map((e=>({name:e,parser:Ry.parser})))),pv=$l.define({name:"html",parser:cy.configure({props:[Wl.add({Element(e){let t=/^(\s*)(<\/)?/.exec(e.textAfter);return e.node.to<=e.pos+t[0].length?e.continue():e.lineIndent(e.node.from)+(t[2]?0:e.unit)},"OpenTag CloseTag SelfClosingTag":e=>e.column(e.node.from)+e.unit,Document(e){if(e.pos+/\s*/.exec(e.textAfter)[0].length<e.node.to)return e.continue();let t,n=null;for(let t=e.node;;){let e=t.lastChild;if(!e||"Element"!=e.name||e.to!=t.to)break;n=t=e}return n&&(!(t=n.lastChild)||"CloseTag"!=t.name&&"SelfClosingTag"!=t.name)?e.lineIndent(n.from)+e.unit:null}}),rh.add({Element(e){let t=e.firstChild,n=e.lastChild;return t&&"OpenTag"==t.name?{from:t.to,to:"CloseTag"==n.name?n.from:e.to}:null}}),Uh.add({"OpenTag CloseTag":e=>e.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-._"}}),fv=pv.configure({wrap:fy(uv,dv)});function mv(e={}){let t,n="";!1===e.matchClosingTags&&(n="noMatch"),!0===e.selfClosingTags&&(n=(n?n+" ":"")+"selfClosing"),(e.nestedLanguages&&e.nestedLanguages.length||e.nestedAttributes&&e.nestedAttributes.length)&&(t=fy((e.nestedLanguages||[]).concat(uv),(e.nestedAttributes||[]).concat(dv)));let i=t?pv.configure({wrap:t,dialect:n}):n?fv.configure({dialect:n}):fv;return new Ll(i,[fv.data.of({autocomplete:hv(e)}),!1!==e.autoCloseTags?yv:[],Ly().support,new Ll($O,$O.data.of({autocomplete:PO})).support])}var gv,Ov=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),yv=Lr.inputHandler.of(((e,t,n,i,r)=>{if(e.composing||e.state.readOnly||t!=n||">"!=i&&"/"!=i||!fv.isActiveAt(e.state,t,-1))return!1;let s=r(),{state:o}=s,a=o.changeByRange((e=>{var t,n,r;let s,a=o.doc.sliceString(e.from-1,e.to)==i,{head:l}=e,h=Nl(o).resolveInner(l,-1);if(a&&">"==i&&"EndTag"==h.name){let i=h.parent;if("CloseTag"!=(null===(n=null===(t=i.parent)||void 0===t?void 0:t.lastChild)||void 0===n?void 0:n.name)&&(s=tv(o.doc,i.parent,l))&&!Ov.has(s)){return{range:e,changes:{from:l,to:l+(">"===o.doc.sliceString(l,l+1)?1:0),insert:`</${s}>`}}}}else if(a&&"/"==i&&"IncompleteCloseTag"==h.name){let e=h.parent;if(h.from==l-2&&"CloseTag"!=(null===(r=e.lastChild)||void 0===r?void 0:r.name)&&(s=tv(o.doc,e,l))&&!Ov.has(s)){let e=l+(">"===o.doc.sliceString(l,l+1)?1:0),t=`${s}>`;return{range:X.cursor(l+t.length,-1),changes:{from:l,to:e,insert:t}}}}return{range:e}}));return!a.changes.empty&&(e.dispatch([s,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)})),vv=class extends ag{constructor(e,t=[]){super(e,t,bg)}async getExtensions(e){return[mv({selfClosingTags:!1}),vg()]}serialize(){return this.editor.content}},bv=class e{static create(t,n,i,r,s){return new e(t,n,i,r+(r<<8)+t+(n<<4)|0,s,[],[])}constructor(e,t,n,i,r,s,o){this.type=e,this.value=t,this.from=n,this.hash=i,this.end=r,this.children=s,this.positions=o,this.hashProp=[[ko.contextHash,i]]}addChild(e,t){e.prop(ko.contextHash)!=this.hash&&(e=new No(e.type,e.children,e.positions,e.length,this.hashProp)),this.children.push(e),this.positions.push(t)}toTree(e,t=this.end){let n=this.children.length-1;return n>=0&&(t=Math.max(t,this.positions[n]+this.children[n].length+this.from)),new No(e.types[this.type],this.children,this.positions,t-this.from).balance({makeTree:(e,t,n)=>new No(_o.none,e,t,n,this.hashProp)})}};!function(e){e[e.Document=1]="Document",e[e.CodeBlock=2]="CodeBlock",e[e.FencedCode=3]="FencedCode",e[e.Blockquote=4]="Blockquote",e[e.HorizontalRule=5]="HorizontalRule",e[e.BulletList=6]="BulletList",e[e.OrderedList=7]="OrderedList",e[e.ListItem=8]="ListItem",e[e.ATXHeading1=9]="ATXHeading1",e[e.ATXHeading2=10]="ATXHeading2",e[e.ATXHeading3=11]="ATXHeading3",e[e.ATXHeading4=12]="ATXHeading4",e[e.ATXHeading5=13]="ATXHeading5",e[e.ATXHeading6=14]="ATXHeading6",e[e.SetextHeading1=15]="SetextHeading1",e[e.SetextHeading2=16]="SetextHeading2",e[e.HTMLBlock=17]="HTMLBlock",e[e.LinkReference=18]="LinkReference",e[e.Paragraph=19]="Paragraph",e[e.CommentBlock=20]="CommentBlock",e[e.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",e[e.Escape=22]="Escape",e[e.Entity=23]="Entity",e[e.HardBreak=24]="HardBreak",e[e.Emphasis=25]="Emphasis",e[e.StrongEmphasis=26]="StrongEmphasis",e[e.Link=27]="Link",e[e.Image=28]="Image",e[e.InlineCode=29]="InlineCode",e[e.HTMLTag=30]="HTMLTag",e[e.Comment=31]="Comment",e[e.ProcessingInstruction=32]="ProcessingInstruction",e[e.URL=33]="URL",e[e.HeaderMark=34]="HeaderMark",e[e.QuoteMark=35]="QuoteMark",e[e.ListMark=36]="ListMark",e[e.LinkMark=37]="LinkMark",e[e.EmphasisMark=38]="EmphasisMark",e[e.CodeMark=39]="CodeMark",e[e.CodeText=40]="CodeText",e[e.CodeInfo=41]="CodeInfo",e[e.LinkTitle=42]="LinkTitle",e[e.LinkLabel=43]="LinkLabel"}(gv||(gv={}));function wv(e,t,n){if(n.pos==n.text.length||e!=t.block&&n.indent>=t.stack[n.depth+1].value+n.baseIndent)return!0;if(n.indent>=n.baseIndent+4)return!1;let i=(e.type==gv.OrderedList?$v:Pv)(n,t,!1);return i>0&&(e.type!=gv.BulletList||Ev(n,t,!1)<0)&&n.text.charCodeAt(n.pos+i-1)==e.value}var xv={[gv.Blockquote]:(e,t,n)=>62==n.next&&(n.markers.push(nb(gv.QuoteMark,t.lineStart+n.pos,t.lineStart+n.pos+1)),n.moveBase(n.pos+(Sv(n.text.charCodeAt(n.pos+1))?2:1)),e.end=t.lineStart+n.text.length,!0),[gv.ListItem]:(e,t,n)=>!(n.indent<n.baseIndent+e.value&&n.next>-1)&&(n.moveBaseColumn(n.baseIndent+e.value),!0),[gv.OrderedList]:wv,[gv.BulletList]:wv,[gv.Document]:()=>!0};function Sv(e){return 32==e||9==e||10==e||13==e}function kv(e,t=0){for(;t<e.length&&Sv(e.charCodeAt(t));)t++;return t}function Av(e,t,n){for(;t>n&&Sv(e.charCodeAt(t-1));)t--;return t}function Cv(e){if(96!=e.next&&126!=e.next)return-1;let t=e.pos+1;for(;t<e.text.length&&e.text.charCodeAt(t)==e.next;)t++;if(t<e.pos+3)return-1;if(96==e.next)for(let n=t;n<e.text.length;n++)if(96==e.text.charCodeAt(n))return-1;return t}function _v(e){return 62!=e.next?-1:32==e.text.charCodeAt(e.pos+1)?2:1}function Ev(e,t,n){if(42!=e.next&&45!=e.next&&95!=e.next)return-1;let i=1;for(let t=e.pos+1;t<e.text.length;t++){let n=e.text.charCodeAt(t);if(n==e.next)i++;else if(!Sv(n))return-1}return n&&45==e.next&&Iv(e)>-1&&e.depth==t.stack.length||i<3?-1:1}function Tv(e,t){for(let n=e.stack.length-1;n>=0;n--)if(e.stack[n].type==t)return!0;return!1}function Pv(e,t,n){return 45!=e.next&&43!=e.next&&42!=e.next||e.pos!=e.text.length-1&&!Sv(e.text.charCodeAt(e.pos+1))||!(!n||Tv(t,gv.BulletList)||e.skipSpace(e.pos+2)<e.text.length)?-1:1}function $v(e,t,n){let i=e.pos,r=e.next;for(;r>=48&&r<=57;){if(i++,i==e.text.length)return-1;r=e.text.charCodeAt(i)}return i==e.pos||i>e.pos+9||46!=r&&41!=r||i<e.text.length-1&&!Sv(e.text.charCodeAt(i+1))||n&&!Tv(t,gv.OrderedList)&&(e.skipSpace(i+1)==e.text.length||i>e.pos+1||49!=e.next)?-1:i+1-e.pos}function Nv(e){if(35!=e.next)return-1;let t=e.pos+1;for(;t<e.text.length&&35==e.text.charCodeAt(t);)t++;if(t<e.text.length&&32!=e.text.charCodeAt(t))return-1;let n=t-e.pos;return n>6?-1:n}function Iv(e){if(45!=e.next&&61!=e.next||e.indent>=e.baseIndent+4)return-1;let t=e.pos+1;for(;t<e.text.length&&e.text.charCodeAt(t)==e.next;)t++;let n=t;for(;t<e.text.length&&Sv(e.text.charCodeAt(t));)t++;return t==e.text.length?n:-1}var Qv=/^[ \t]*$/,Rv=/-->/,Mv=/\?>/,Bv=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,Rv],[/^\s*<\?/,Mv],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,Qv],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,Qv]];function Dv(e,t,n){if(60!=e.next)return-1;let i=e.text.slice(e.pos);for(let e=0,t=Bv.length-(n?1:0);e<t;e++)if(Bv[e][0].test(i))return e;return-1}function Xv(e,t){let n=e.countIndent(t,e.pos,e.indent),i=e.countIndent(e.skipSpace(t),t,n);return i>=n+5?n+1:i}function Fv(e,t,n){let i=e.length-1;i>=0&&e[i].to==t&&e[i].type==gv.CodeText?e[i].to=n:e.push(nb(gv.CodeText,t,n))}var Lv={LinkReference:void 0,IndentedCode(e,t){let n=t.baseIndent+4;if(t.indent<n)return!1;let i=t.findColumn(n),r=e.lineStart+i,s=e.lineStart+t.text.length,o=[],a=[];for(Fv(o,r,s);e.nextLine()&&t.depth>=e.stack.length;)if(t.pos==t.text.length){Fv(a,e.lineStart-1,e.lineStart);for(let e of t.markers)a.push(e)}else{if(t.indent<n)break;{if(a.length){for(let e of a)e.type==gv.CodeText?Fv(o,e.from,e.to):o.push(e);a=[]}Fv(o,e.lineStart-1,e.lineStart);for(let e of t.markers)o.push(e);s=e.lineStart+t.text.length;let n=e.lineStart+t.findColumn(t.baseIndent+4);n<s&&Fv(o,n,s)}}return a.length&&(a=a.filter((e=>e.type!=gv.CodeText)),a.length&&(t.markers=a.concat(t.markers))),e.addNode(e.buffer.writeElements(o,-r).finish(gv.CodeBlock,s-r),r),!0},FencedCode(e,t){let n=Cv(t);if(n<0)return!1;let i=e.lineStart+t.pos,r=t.next,s=n-t.pos,o=t.skipSpace(n),a=Av(t.text,t.text.length,o),l=[nb(gv.CodeMark,i,i+s)];o<a&&l.push(nb(gv.CodeInfo,e.lineStart+o,e.lineStart+a));for(let n=!0;e.nextLine()&&t.depth>=e.stack.length;n=!1){let i=t.pos;if(t.indent-t.baseIndent<4)for(;i<t.text.length&&t.text.charCodeAt(i)==r;)i++;if(i-t.pos>=s&&t.skipSpace(i)==t.text.length){for(let e of t.markers)l.push(e);l.push(nb(gv.CodeMark,e.lineStart+t.pos,e.lineStart+i)),e.nextLine();break}{n||Fv(l,e.lineStart-1,e.lineStart);for(let e of t.markers)l.push(e);let i=e.lineStart+t.basePos,r=e.lineStart+t.text.length;i<r&&Fv(l,i,r)}}return e.addNode(e.buffer.writeElements(l,-i).finish(gv.FencedCode,e.prevLineEnd()-i),i),!0},Blockquote(e,t){let n=_v(t);return!(n<0)&&(e.startContext(gv.Blockquote,t.pos),e.addNode(gv.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1),t.moveBase(t.pos+n),null)},HorizontalRule(e,t){if(Ev(t,e,!1)<0)return!1;let n=e.lineStart+t.pos;return e.nextLine(),e.addNode(gv.HorizontalRule,n),!0},BulletList(e,t){let n=Pv(t,e,!1);if(n<0)return!1;e.block.type!=gv.BulletList&&e.startContext(gv.BulletList,t.basePos,t.next);let i=Xv(t,t.pos+1);return e.startContext(gv.ListItem,t.basePos,i-t.baseIndent),e.addNode(gv.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+n),t.moveBaseColumn(i),null},OrderedList(e,t){let n=$v(t,e,!1);if(n<0)return!1;e.block.type!=gv.OrderedList&&e.startContext(gv.OrderedList,t.basePos,t.text.charCodeAt(t.pos+n-1));let i=Xv(t,t.pos+n);return e.startContext(gv.ListItem,t.basePos,i-t.baseIndent),e.addNode(gv.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+n),t.moveBaseColumn(i),null},ATXHeading(e,t){let n=Nv(t);if(n<0)return!1;let i=t.pos,r=e.lineStart+i,s=Av(t.text,t.text.length,i),o=s;for(;o>i&&t.text.charCodeAt(o-1)==t.next;)o--;(o==s||o==i||!Sv(t.text.charCodeAt(o-1)))&&(o=t.text.length);let a=e.buffer.write(gv.HeaderMark,0,n).writeElements(e.parser.parseInline(t.text.slice(i+n+1,o),r+n+1),-r);o<t.text.length&&a.write(gv.HeaderMark,o-i,s-i);let l=a.finish(gv.ATXHeading1-1+n,t.text.length-i);return e.nextLine(),e.addNode(l,r),!0},HTMLBlock(e,t){let n=Dv(t,0,!1);if(n<0)return!1;let i=e.lineStart+t.pos,r=Bv[n][1],s=[],o=r!=Qv;for(;!r.test(t.text)&&e.nextLine();){if(t.depth<e.stack.length){o=!1;break}for(let e of t.markers)s.push(e)}o&&e.nextLine();let a=r==Rv?gv.CommentBlock:r==Mv?gv.ProcessingInstructionBlock:gv.HTMLBlock,l=e.prevLineEnd();return e.addNode(e.buffer.writeElements(s,-i).finish(a,l-i),i),!0},SetextHeading:void 0};function Uv(e,t){for(;t<e.length;t++){let n=e.charCodeAt(t);if(10==n)break;if(!Sv(n))return-1}return t}var Vv={LinkReference:(e,t)=>91==t.content.charCodeAt(0)?new class{constructor(e){this.stage=0,this.elts=[],this.pos=0,this.start=e.start,this.advance(e.content)}nextLine(e,t,n){if(-1==this.stage)return!1;let i=n.content+"\n"+t.scrub(),r=this.advance(i);return r>-1&&r<i.length&&this.complete(e,n,r)}finish(e,t){return(2==this.stage||3==this.stage)&&kv(t.content,this.pos)==t.content.length&&this.complete(e,t,t.content.length)}complete(e,t,n){return e.addLeafElement(t,nb(gv.LinkReference,this.start,this.start+n,this.elts)),!0}nextStage(e){return e?(this.pos=e.to-this.start,this.elts.push(e),this.stage++,!0):(!1===e&&(this.stage=-1),!1)}advance(e){for(;;){if(-1==this.stage)return-1;if(0==this.stage){if(!this.nextStage(fb(e,this.pos,this.start,!0)))return-1;if(58!=e.charCodeAt(this.pos))return this.stage=-1;this.elts.push(nb(gv.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else{if(1!=this.stage){if(2==this.stage){let t=kv(e,this.pos),n=0;if(t>this.pos){let i=pb(e,t,this.start);if(i){let t=Uv(e,i.to-this.start);t>0&&(this.nextStage(i),n=t)}}return n||(n=Uv(e,this.pos)),n>0&&n<e.length?n:-1}return Uv(e,this.pos)}if(!this.nextStage(db(e,kv(e,this.pos),this.start)))return-1}}}}(t):null,SetextHeading:()=>new class{nextLine(e,t,n){let i=t.depth<e.stack.length?-1:Iv(t),r=t.next;if(i<0)return!1;let s=nb(gv.HeaderMark,e.lineStart+t.pos,e.lineStart+i);return e.nextLine(),e.addLeafElement(n,nb(61==r?gv.SetextHeading1:gv.SetextHeading2,n.start,e.prevLineEnd(),[...e.parser.parseInline(n.content,n.start),s])),!0}finish(){return!1}}},zv=[(e,t)=>Nv(t)>=0,(e,t)=>Cv(t)>=0,(e,t)=>_v(t)>=0,(e,t)=>Pv(t,e,!0)>=0,(e,t)=>$v(t,e,!0)>=0,(e,t)=>Ev(t,e,!0)>=0,(e,t)=>Dv(t,0,!0)>=0],Zv={text:"",end:0};function jv(e,t,n,i,r){let s=e[t].to,o=[],a=[],l=n.from+i;function h(n,r){for(;r?n>=s:n>s;){let r=e[t+1].from-s;i+=r,n+=r,t++,s=e[t].to}}for(let c=n.firstChild;c;c=c.nextSibling){h(c.from+i,!0);let n,u=c.from+i,d=r.get(c.tree);d?n=d:c.to+i>s?(n=jv(e,t,c,i,r),h(c.to+i,!1)):n=c.toTree(),o.push(n),a.push(u-l)}return h(n.to+i,!1),new No(n.type,o,a,n.to+i-l,n.tree?n.tree.propValues:void 0)}var qv=class e extends Yo{constructor(e,t,n,i,r,s,o,a,l){super(),this.nodeSet=e,this.blockParsers=t,this.leafBlockParsers=n,this.blockNames=i,this.endLeafBlock=r,this.skipContextMarkup=s,this.inlineParsers=o,this.inlineNames=a,this.wrappers=l,this.nodeTypes=Object.create(null);for(let t of e.types)this.nodeTypes[t.name]=t.id}createParse(e,t,n){let i=new class{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.line=new class{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent),this.pos=e,this.next=e==this.text.length?-1:this.text.charCodeAt(e)}skipSpace(e){return kv(this.text,e)}reset(e){for(this.text=e,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(e){this.basePos=e,this.baseIndent=this.countIndent(e,this.pos,this.indent)}moveBaseColumn(e){this.baseIndent=e,this.basePos=this.findColumn(e)}addMarker(e){this.markers.push(e)}countIndent(e,t=0,n=0){for(let i=t;i<e;i++)n+=9==this.text.charCodeAt(i)?4-n%4:1;return n}findColumn(e){let t=0;for(let n=0;t<this.text.length&&n<e;t++)n+=9==this.text.charCodeAt(t)?4-n%4:1;return t}scrub(){if(!this.baseIndent)return this.text;let e="";for(let t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)}},this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=i[i.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=i[0].from,this.block=bv.create(gv.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=n.length?new yb(n,t):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(null!=this.stoppedAt&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:e}=this;for(;;){for(;e.depth<this.stack.length;)this.finishContext();for(let t of e.markers)this.addNode(t.type,t.from,t.to);if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(let t of this.parser.blockParsers)if(t){let n=t(this,e);if(0!=n){if(1==n)return null;e.forward();continue e}}break}let t=new class{constructor(e,t){this.start=e,this.content=t,this.marks=[],this.parsers=[]}}(this.lineStart+e.pos,e.text.slice(e.pos));for(let e of this.parser.leafBlockParsers)if(e){let n=e(this,t);n&&t.parsers.push(n)}e:for(;this.nextLine()&&e.pos!=e.text.length;){if(e.indent<e.baseIndent+4)for(let n of this.parser.endLeafBlock)if(n(this,e,t))break e;for(let n of t.parsers)if(n.nextLine(this,e,t))return null;t.content+="\n"+e.scrub();for(let n of e.markers)t.marks.push(n)}return this.finishLeaf(t),null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}reuseFragment(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let t=this.fragments.takeNodes(this);return!!t&&(this.absoluteLineStart+=t,this.lineStart=vb(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0)}get depth(){return this.stack.length}parentType(e=this.depth-1){return this.parser.nodeSet.types[this.stack[e].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(e){let t=Zv;if(t.end=e,e>=this.to)t.text="";else if(t.text=this.lineChunkAt(e),t.end+=t.text.length,this.ranges.length>1){let e=this.absoluteLineStart,n=this.rangeI;for(;this.ranges[n].to<t.end;){n++;let i=this.ranges[n].from,r=this.lineChunkAt(i);t.end=i+r.length,t.text=t.text.slice(0,this.ranges[n-1].to-e)+r,e=t.end-t.text.length}}return t}readLine(){let{line:e}=this,{text:t,end:n}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=n,e.reset(t);e.depth<this.stack.length;e.depth++){let t=this.stack[e.depth],n=this.parser.skipContextMarkup[t.type];if(!n)throw new Error("Unhandled block context "+gv[t.type]);if(!n(t,this,e))break;e.forward()}}lineChunkAt(e){let t,n=this.input.chunk(e);if(this.input.lineChunks)t="\n"==n?"":n;else{let e=n.indexOf("\n");t=e<0?n:n.slice(0,e)}return e+t.length>this.to?t.slice(0,this.to-e):t}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(e,t,n=0){this.block=bv.create(e,n,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(e,t,n=0){this.startContext(this.parser.getNodeType(e),t,n)}addNode(e,t,n){"number"==typeof e&&(e=new No(this.parser.nodeSet.types[e],Jv,Jv,(n??this.prevLineEnd())-t)),this.block.addChild(e,t-this.block.from)}addElement(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)}addLeafElement(e,t){this.addNode(this.buffer.writeElements(gb(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)}finishContext(){let e=this.stack.pop(),t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from),this.block=t}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(e){return this.ranges.length>1?jv(this.ranges,0,e.topNode,this.ranges[0].from,this.reusePlaceholders):e}finishLeaf(e){for(let t of e.parsers)if(t.finish(this,e))return;let t=gb(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(t,-e.start).finish(gv.Paragraph,e.content.length),e.start)}elt(e,t,n,i){return"string"==typeof e?nb(this.parser.getNodeType(e),t,n,i):new tb(e,t)}get buffer(){return new Kv(this.parser.nodeSet)}}(this,e,t,n);for(let r of this.wrappers)i=r(i,e,t,n);return i}configure(t){let n=Wv(t);if(!n)return this;let{nodeSet:i,skipContextMarkup:r}=this,s=this.blockParsers.slice(),o=this.leafBlockParsers.slice(),a=this.blockNames.slice(),l=this.inlineParsers.slice(),h=this.inlineNames.slice(),c=this.endLeafBlock.slice(),u=this.wrappers;if(Gv(n.defineNodes)){r=Object.assign({},r);let e,t=i.types.slice();for(let i of n.defineNodes){let{name:n,block:s,composite:o,style:a}="string"==typeof i?{name:i}:i;if(t.some((e=>e.name==n)))continue;o&&(r[t.length]=(e,t,n)=>o(t,n,e.value));let l=t.length,h=o?["Block","BlockContext"]:s?l>=gv.ATXHeading1&&l<=gv.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;t.push(_o.define({id:l,name:n,props:h&&[[ko.group,h]]})),a&&(e||(e={}),Array.isArray(a)||a instanceof Xa?e[n]=a:Object.assign(e,a))}i=new To(t),e&&(i=i.extend(Ua(e)))}if(Gv(n.props)&&(i=i.extend(...n.props)),Gv(n.remove))for(let e of n.remove){let t=this.blockNames.indexOf(e),n=this.inlineNames.indexOf(e);t>-1&&(s[t]=o[t]=void 0),n>-1&&(l[n]=void 0)}if(Gv(n.parseBlock))for(let e of n.parseBlock){let t=a.indexOf(e.name);if(t>-1)s[t]=e.parse,o[t]=e.leaf;else{let t=e.before?Hv(a,e.before):e.after?Hv(a,e.after)+1:a.length-1;s.splice(t,0,e.parse),o.splice(t,0,e.leaf),a.splice(t,0,e.name)}e.endLeaf&&c.push(e.endLeaf)}if(Gv(n.parseInline))for(let e of n.parseInline){let t=h.indexOf(e.name);if(t>-1)l[t]=e.parse;else{let t=e.before?Hv(h,e.before):e.after?Hv(h,e.after)+1:h.length-1;l.splice(t,0,e.parse),h.splice(t,0,e.name)}}return n.wrap&&(u=u.concat(n.wrap)),new e(i,s,o,a,c,r,l,h,u)}getNodeType(e){let t=this.nodeTypes[e];if(null==t)throw new RangeError(`Unknown node type '${e}'`);return t}parseInline(e,t){let n=new mb(this,e,t);e:for(let e=t;e<n.end;){let t=n.char(e);for(let i of this.inlineParsers)if(i){let r=i(n,t,e);if(r>=0){e=r;continue e}}e++}return n.resolveMarkers(0)}};function Gv(e){return null!=e&&e.length>0}function Wv(e){if(!Array.isArray(e))return e;if(0==e.length)return null;let t=Wv(e[0]);if(1==e.length)return t;let n=Wv(e.slice(1));if(!n||!t)return t||n;let i=(e,t)=>(e||Jv).concat(t||Jv),r=t.wrap,s=n.wrap;return{props:i(t.props,n.props),defineNodes:i(t.defineNodes,n.defineNodes),parseBlock:i(t.parseBlock,n.parseBlock),parseInline:i(t.parseInline,n.parseInline),remove:i(t.remove,n.remove),wrap:r?s?(e,t,n,i)=>r(s(e,t,n,i),t,n,i):r:s}}function Hv(e,t){let n=e.indexOf(t);if(n<0)throw new RangeError(`Position specified relative to unknown parser ${t}`);return n}var Yv=[_o.none];for(let e,t=1;e=gv[t];t++)Yv[t]=_o.define({id:t,name:e,props:t>=gv.Escape?[]:[[ko.group,t in xv?["Block","BlockContext"]:["Block","LeafBlock"]]],top:"Document"==e});var Jv=[],Kv=class{constructor(e){this.nodeSet=e,this.content=[],this.nodes=[]}write(e,t,n,i=0){return this.content.push(e,t,n,4+4*i),this}writeElements(e,t=0){for(let n of e)n.writeTo(this,t);return this}finish(e,t){return No.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:t})}},eb=class{constructor(e,t,n,i=Jv){this.type=e,this.from=t,this.to=n,this.children=i}writeTo(e,t){let n=e.content.length;e.writeElements(this.children,t),e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-n)}toTree(e){return new Kv(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}},tb=class{constructor(e,t){this.tree=e,this.from=t}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return Jv}writeTo(e,t){e.nodes.push(this.tree),e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)}toTree(){return this.tree}};function nb(e,t,n,i){return new eb(e,t,n,i)}var ib={resolve:"Emphasis",mark:"EmphasisMark"},rb={resolve:"Emphasis",mark:"EmphasisMark"},sb={},ob={},ab=class{constructor(e,t,n,i){this.type=e,this.from=t,this.to=n,this.side=i}},lb="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~",hb=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{hb=new RegExp("[\\p{Pc}|\\p{Pd}|\\p{Pe}|\\p{Pf}|\\p{Pi}|\\p{Po}|\\p{Ps}]","u")}catch{}var cb={Escape(e,t,n){if(92!=t||n==e.end-1)return-1;let i=e.char(n+1);for(let t=0;t<lb.length;t++)if(lb.charCodeAt(t)==i)return e.append(nb(gv.Escape,n,n+2));return-1},Entity(e,t,n){if(38!=t)return-1;let i=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(e.slice(n+1,n+31));return i?e.append(nb(gv.Entity,n,n+1+i[0].length)):-1},InlineCode(e,t,n){if(96!=t||n&&96==e.char(n-1))return-1;let i=n+1;for(;i<e.end&&96==e.char(i);)i++;let r=i-n,s=0;for(;i<e.end;i++)if(96==e.char(i)){if(s++,s==r&&96!=e.char(i+1))return e.append(nb(gv.InlineCode,n,i+1,[nb(gv.CodeMark,n,n+r),nb(gv.CodeMark,i+1-r,i+1)]))}else s=0;return-1},HTMLTag(e,t,n){if(60!=t||n==e.end-1)return-1;let i=e.slice(n+1,e.end),r=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(i);if(r)return e.append(nb(gv.URL,n,n+1+r[0].length));let s=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(i);if(s)return e.append(nb(gv.Comment,n,n+1+s[0].length));let o=/^\?[^]*?\?>/.exec(i);if(o)return e.append(nb(gv.ProcessingInstruction,n,n+1+o[0].length));let a=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(i);return a?e.append(nb(gv.HTMLTag,n,n+1+a[0].length)):-1},Emphasis(e,t,n){if(95!=t&&42!=t)return-1;let i=n+1;for(;e.char(i)==t;)i++;let r=e.slice(n-1,n),s=e.slice(i,i+1),o=hb.test(r),a=hb.test(s),l=/\s|^$/.test(r),h=/\s|^$/.test(s),c=!h&&(!a||l||o),u=!l&&(!o||h||a),d=c&&(42==t||!u||o),p=u&&(42==t||!c||a);return e.append(new ab(95==t?ib:rb,n,i,(d?1:0)|(p?2:0)))},HardBreak(e,t,n){if(92==t&&10==e.char(n+1))return e.append(nb(gv.HardBreak,n,n+2));if(32==t){let t=n+1;for(;32==e.char(t);)t++;if(10==e.char(t)&&t>=n+2)return e.append(nb(gv.HardBreak,n,t+1))}return-1},Link:(e,t,n)=>91==t?e.append(new ab(sb,n,n+1,1)):-1,Image:(e,t,n)=>33==t&&91==e.char(n+1)?e.append(new ab(ob,n,n+2,1)):-1,LinkEnd(e,t,n){if(93!=t)return-1;for(let t=e.parts.length-1;t>=0;t--){let i=e.parts[t];if(i instanceof ab&&(i.type==sb||i.type==ob)){if(!i.side||e.skipSpace(i.to)==n&&!/[(\[]/.test(e.slice(n+1,n+2)))return e.parts[t]=null,-1;let r=e.takeContent(t),s=e.parts[t]=ub(e,r,i.type==sb?gv.Link:gv.Image,i.from,n+1);if(i.type==sb)for(let n=0;n<t;n++){let t=e.parts[n];t instanceof ab&&t.type==sb&&(t.side=0)}return s.to}}return-1}};function ub(e,t,n,i,r){let{text:s}=e,o=e.char(r),a=r;if(t.unshift(nb(gv.LinkMark,i,i+(n==gv.Image?2:1))),t.push(nb(gv.LinkMark,r-1,r)),40==o){let n,i=e.skipSpace(r+1),o=db(s,i-e.offset,e.offset);o&&(i=e.skipSpace(o.to),n=pb(s,i-e.offset,e.offset),n&&(i=e.skipSpace(n.to))),41==e.char(i)&&(t.push(nb(gv.LinkMark,r,r+1)),a=i+1,o&&t.push(o),n&&t.push(n),t.push(nb(gv.LinkMark,i,a)))}else if(91==o){let n=fb(s,r-e.offset,e.offset,!1);n&&(t.push(n),a=n.to)}return nb(n,i,a,t)}function db(e,t,n){if(60==e.charCodeAt(t)){for(let i=t+1;i<e.length;i++){let r=e.charCodeAt(i);if(62==r)return nb(gv.URL,t+n,i+1+n);if(60==r||10==r)return!1}return null}{let i=0,r=t;for(let t=!1;r<e.length;r++){let n=e.charCodeAt(r);if(Sv(n))break;if(t)t=!1;else if(40==n)i++;else if(41==n){if(!i)break;i--}else 92==n&&(t=!0)}return r>t?nb(gv.URL,t+n,r+n):r==e.length&&null}}function pb(e,t,n){let i=e.charCodeAt(t);if(39!=i&&34!=i&&40!=i)return!1;let r=40==i?41:i;for(let i=t+1,s=!1;i<e.length;i++){let o=e.charCodeAt(i);if(s)s=!1;else{if(o==r)return nb(gv.LinkTitle,t+n,i+1+n);92==o&&(s=!0)}}return null}function fb(e,t,n,i){for(let r=!1,s=t+1,o=Math.min(e.length,s+999);s<o;s++){let o=e.charCodeAt(s);if(r)r=!1;else{if(93==o)return!i&&nb(gv.LinkLabel,t+n,s+1+n);if(i&&!Sv(o)&&(i=!1),91==o)return!1;92==o&&(r=!0)}}return null}var mb=class{constructor(e,t,n){this.parser=e,this.text=t,this.offset=n,this.parts=[]}char(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)}get end(){return this.offset+this.text.length}slice(e,t){return this.text.slice(e-this.offset,t-this.offset)}append(e){return this.parts.push(e),e.to}addDelimiter(e,t,n,i,r){return this.append(new ab(e,t,n,(i?1:0)|(r?2:0)))}addElement(e){return this.append(e)}resolveMarkers(e){for(let t=e;t<this.parts.length;t++){let n=this.parts[t];if(!(n instanceof ab&&n.type.resolve&&2&n.side))continue;let i,r=n.type==ib||n.type==rb,s=n.to-n.from,o=t-1;for(;o>=e;o--){let e=this.parts[o];if(e instanceof ab&&1&e.side&&e.type==n.type&&!(r&&(1&n.side||2&e.side)&&(e.to-e.from+s)%3==0&&((e.to-e.from)%3||s%3))){i=e;break}}if(!i)continue;let a=n.type.resolve,l=[],h=i.from,c=n.to;if(r){let e=Math.min(2,i.to-i.from,s);h=i.to-e,c=n.from+e,a=1==e?"Emphasis":"StrongEmphasis"}i.type.mark&&l.push(this.elt(i.type.mark,h,i.to));for(let e=o+1;e<t;e++)this.parts[e]instanceof eb&&l.push(this.parts[e]),this.parts[e]=null;n.type.mark&&l.push(this.elt(n.type.mark,n.from,c));let u=this.elt(a,h,c,l);this.parts[o]=r&&i.from!=h?new ab(i.type,i.from,h,i.side):null,(this.parts[t]=r&&n.to!=c?new ab(n.type,c,n.to,n.side):null)?this.parts.splice(t,0,u):this.parts[t]=u}let t=[];for(let n=e;n<this.parts.length;n++){let e=this.parts[n];e instanceof eb&&t.push(e)}return t}findOpeningDelimiter(e){for(let t=this.parts.length-1;t>=0;t--){let n=this.parts[t];if(n instanceof ab&&n.type==e)return t}return null}takeContent(e){let t=this.resolveMarkers(e);return this.parts.length=e,t}skipSpace(e){return kv(this.text,e-this.offset)+this.offset}elt(e,t,n,i){return"string"==typeof e?nb(this.parser.getNodeType(e),t,n,i):new tb(e,t)}};function gb(e,t){if(!t.length)return e;if(!e.length)return t;let n=e.slice(),i=0;for(let e of t){for(;i<n.length&&n[i].to<e.to;)i++;if(i<n.length&&n[i].from<e.from){let t=n[i];t instanceof eb&&(n[i]=new eb(t.type,t.from,t.to,gb(t.children,[e])))}else n.splice(i++,0,e)}return n}var Ob=[gv.CodeBlock,gv.ListItem,gv.OrderedList,gv.BulletList],yb=class{constructor(e,t){this.fragments=e,this.input=t,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,e.length&&(this.fragment=e[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(e,t){for(;this.fragment&&this.fragment.to<=e;)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return!1;if(this.fragmentEnd<0){let e=this.fragment.to;for(;e>0&&"\n"!=this.input.read(e-1,e);)e--;this.fragmentEnd=e?e-1:0}let n=this.cursor;n||(n=this.cursor=this.fragment.tree.cursor(),n.firstChild());let i=e+this.fragment.offset;for(;n.to<=i;)if(!n.parent())return!1;for(;;){if(n.from>=i)return this.fragment.from<=t;if(!n.childAfter(i))return!1}}matches(e){let t=this.cursor.tree;return t&&t.prop(ko.contextHash)==e}takeNodes(e){let t=this.cursor,n=this.fragment.offset,i=this.fragmentEnd-(this.fragment.openEnd?1:0),r=e.absoluteLineStart,s=r,o=e.block.children.length,a=s,l=o;for(;;){if(t.to-n>i){if(t.type.isAnonymous&&t.firstChild())continue;break}let r=vb(t.from-n,e.ranges);if(t.to-n<=e.ranges[e.rangeI].to)e.addNode(t.tree,r);else{let n=new No(e.parser.nodeSet.types[gv.Paragraph],[],[],0,e.block.hashProp);e.reusePlaceholders.set(n,t.tree),e.addNode(n,r)}if(t.type.is("Block")&&(Ob.indexOf(t.type.id)<0?(s=t.to-n,o=e.block.children.length):(s=a,o=l,a=t.to-n,l=e.block.children.length)),!t.nextSibling())break}for(;e.block.children.length>o;)e.block.children.pop(),e.block.positions.pop();return s-r}};function vb(e,t){let n=e;for(let i=1;i<t.length;i++){let r=t[i-1].to,s=t[i].from;r<e&&(n-=s-r)}return n}var bb=Ua({"Blockquote/...":hl.quote,HorizontalRule:hl.contentSeparator,"ATXHeading1/... SetextHeading1/...":hl.heading1,"ATXHeading2/... SetextHeading2/...":hl.heading2,"ATXHeading3/...":hl.heading3,"ATXHeading4/...":hl.heading4,"ATXHeading5/...":hl.heading5,"ATXHeading6/...":hl.heading6,"Comment CommentBlock":hl.comment,Escape:hl.escape,Entity:hl.character,"Emphasis/...":hl.emphasis,"StrongEmphasis/...":hl.strong,"Link/... Image/...":hl.link,"OrderedList/... BulletList/...":hl.list,"BlockQuote/...":hl.quote,"InlineCode CodeText":hl.monospace,URL:hl.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":hl.processingInstruction,"CodeInfo LinkLabel":hl.labelName,LinkTitle:hl.string,Paragraph:hl.content}),wb=new qv(new To(Yv).extend(bb),Object.keys(Lv).map((e=>Lv[e])),Object.keys(Lv).map((e=>Vv[e])),Object.keys(Lv),zv,xv,Object.keys(cb).map((e=>cb[e])),Object.keys(cb),[]);function xb(e,t,n){let i=[];for(let r=e.firstChild,s=t;;r=r.nextSibling){let e=r?r.from:n;if(e>s&&i.push({from:s,to:e}),!r)break;s=r.to}return i}var Sb={resolve:"Strikethrough",mark:"StrikethroughMark"},kb={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":hl.strikethrough}},{name:"StrikethroughMark",style:hl.processingInstruction}],parseInline:[{name:"Strikethrough",parse(e,t,n){if(126!=t||126!=e.char(n+1)||126==e.char(n+2))return-1;let i=e.slice(n-1,n),r=e.slice(n+2,n+3),s=/\s|^$/.test(i),o=/\s|^$/.test(r),a=hb.test(i),l=hb.test(r);return e.addDelimiter(Sb,n,n+2,!o&&(!l||s||a),!s&&(!a||o||l))},after:"Emphasis"}]};function Ab(e,t,n=0,i,r=0){let s=0,o=!0,a=-1,l=-1,h=!1,c=()=>{i.push(e.elt("TableCell",r+a,r+l,e.parser.parseInline(t.slice(a,l),r+a)))};for(let u=n;u<t.length;u++){let n=t.charCodeAt(u);124!=n||h?(h||32!=n&&9!=n)&&(a<0&&(a=u),l=u+1):((!o||a>-1)&&s++,o=!1,i&&(a>-1&&c(),i.push(e.elt("TableDelimiter",u+r,u+r+1))),a=l=-1),h=!h&&92==n}return a>-1&&(s++,i&&c()),s}function Cb(e,t){for(let n=t;n<e.length;n++){let t=e.charCodeAt(n);if(124==t)return!0;92==t&&n++}return!1}var _b=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/,Eb=class{constructor(){this.rows=null}nextLine(e,t,n){if(null==this.rows){let i;if(this.rows=!1,(45==t.next||58==t.next||124==t.next)&&_b.test(i=t.text.slice(t.pos))){let r=[];Ab(e,n.content,0,r,n.start)==Ab(e,i,t.pos)&&(this.rows=[e.elt("TableHeader",n.start,n.start+n.content.length,r),e.elt("TableDelimiter",e.lineStart+t.pos,e.lineStart+t.text.length)])}}else if(this.rows){let n=[];Ab(e,t.text,t.pos,n,e.lineStart),this.rows.push(e.elt("TableRow",e.lineStart+t.pos,e.lineStart+t.text.length,n))}return!1}finish(e,t){return!!this.rows&&(e.addLeafElement(t,e.elt("Table",t.start,t.start+t.content.length,this.rows)),!0)}},Tb={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":hl.heading}},"TableRow",{name:"TableCell",style:hl.content},{name:"TableDelimiter",style:hl.processingInstruction}],parseBlock:[{name:"Table",leaf:(e,t)=>Cb(t.content,0)?new Eb:null,endLeaf(e,t,n){if(n.parsers.some((e=>e instanceof Eb))||!Cb(t.text,t.basePos))return!1;let i=e.scanLine(e.absoluteLineEnd+1).text;return _b.test(i)&&Ab(e,t.text,t.basePos)==Ab(e,i,t.basePos)},before:"SetextHeading"}]},Pb={defineNodes:[{name:"Task",block:!0,style:hl.list},{name:"TaskMarker",style:hl.atom}],parseBlock:[{name:"TaskList",leaf:(e,t)=>/^\[[ xX]\][ \t]/.test(t.content)&&"ListItem"==e.parentType().name?new class{nextLine(){return!1}finish(e,t){return e.addLeafElement(t,e.elt("Task",t.start,t.start+t.content.length,[e.elt("TaskMarker",t.start,t.start+3),...e.parser.parseInline(t.content.slice(3),t.start+3)])),!0}}:null,after:"SetextHeading"}]},$b=[Tb,Pb,kb];function Nb(e,t,n){return(i,r,s)=>{if(r!=e||i.char(s+1)==e)return-1;let o=[i.elt(n,s,s+1)];for(let r=s+1;r<i.end;r++){let a=i.char(r);if(a==e)return i.addElement(i.elt(t,s,r+1,o.concat(i.elt(n,r,r+1))));if(92==a&&o.push(i.elt("Escape",r,2+r++)),Sv(a))break}return-1}}var Ib={defineNodes:[{name:"Superscript",style:hl.special(hl.content)},{name:"SuperscriptMark",style:hl.processingInstruction}],parseInline:[{name:"Superscript",parse:Nb(94,"Superscript","SuperscriptMark")}]},Qb={defineNodes:[{name:"Subscript",style:hl.special(hl.content)},{name:"SubscriptMark",style:hl.processingInstruction}],parseInline:[{name:"Subscript",parse:Nb(126,"Subscript","SubscriptMark")}]},Rb={defineNodes:[{name:"Emoji",style:hl.character}],parseInline:[{name:"Emoji",parse(e,t,n){let i;return 58==t&&(i=/^[a-zA-Z_0-9]+:/.exec(e.slice(n+1,e.end)))?e.addElement(e.elt("Emoji",n,n+1+i[0].length)):-1}}]},Mb=_l({commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}}}),Bb=new ko,Db=wb.configure({props:[rh.add((e=>!e.is("Block")||e.is("Document")||null!=Xb(e)||function(e){return"OrderedList"==e.name||"BulletList"==e.name}(e)?void 0:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to}))),Bb.add(Xb),Wl.add({Document:()=>null}),Cl.add({Document:Mb})]});function Xb(e){let t=/^(?:ATX|Setext)Heading(\d)$/.exec(e.name);return t?+t[1]:void 0}function Fb(e,t){let n=e;for(;;){let e,i=n.nextSibling;if(!i||null!=(e=Xb(i.type))&&e<=t)break;n=i}return n.to}var Lb=ih.of(((e,t,n)=>{for(let i=Nl(e).resolveInner(n,-1);i&&!(i.from<t);i=i.parent){let e=i.type.prop(Bb);if(null==e)continue;let t=Fb(i,e);if(t>n)return{from:n,to:t}}return null}));function Ub(e){return new Tl(Mb,e,[Lb],"markdown")}var Vb=Ub(Db),zb=Db.configure([$b,Qb,Ib,Rb,{props:[rh.add({Table:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to})})]}]),Zb=Ub(zb);var jb=class{constructor(e,t,n,i,r,s,o){this.node=e,this.from=t,this.to=n,this.spaceBefore=i,this.spaceAfter=r,this.type=s,this.item=o}blank(e,t=!0){let n=this.spaceBefore+("Blockquote"==this.node.name?">":"");if(null!=e){for(;n.length<e;)n+=" ";return n}for(let e=this.to-this.from-n.length-this.spaceAfter.length;e>0;e--)n+=" ";return n+(t?this.spaceAfter:"")}marker(e,t){let n="OrderedList"==this.node.name?String(+Gb(this.item,e)[2]+t):"";return this.spaceBefore+n+this.type+this.spaceAfter}};function qb(e,t){let n=[];for(let t=e;t&&"Document"!=t.name;t=t.parent)("ListItem"==t.name||"Blockquote"==t.name||"FencedCode"==t.name)&&n.push(t);let i=[];for(let e=n.length-1;e>=0;e--){let r,s=n[e],o=t.lineAt(s.from),a=s.from-o.from;if("FencedCode"==s.name)i.push(new jb(s,a,a,"","","",null));else if("Blockquote"==s.name&&(r=/^ *>( ?)/.exec(o.text.slice(a))))i.push(new jb(s,a,a+r[0].length,"",r[1],">",null));else if("ListItem"==s.name&&"OrderedList"==s.parent.name&&(r=/^( *)\d+([.)])( *)/.exec(o.text.slice(a)))){let e=r[3],t=r[0].length;e.length>=4&&(e=e.slice(0,e.length-4),t-=4),i.push(new jb(s.parent,a,a+t,r[1],e,r[2],s))}else if("ListItem"==s.name&&"BulletList"==s.parent.name&&(r=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(o.text.slice(a)))){let e=r[4],t=r[0].length;e.length>4&&(e=e.slice(0,e.length-4),t-=4);let n=r[2];r[3]&&(n+=r[3].replace(/[xX]/," ")),i.push(new jb(s.parent,a,a+t,r[1],e,n,s))}}return i}function Gb(e,t){return/^(\s*)(\d+)(?=[.)])/.exec(t.sliceString(e.from,e.from+10))}function Wb(e,t,n,i=0){for(let r=-1,s=e;;){if("ListItem"==s.name){let e=Gb(s,t),o=+e[2];if(r>=0){if(o!=r+1)return;n.push({from:s.from+e[1].length,to:s.from+e[0].length,insert:String(r+2+i)})}r=o}let e=s.nextSibling;if(!e)break;s=e}}function Hb(e,t){let n=/^[ \t]*/.exec(e)[0].length;if(!n||"\t"!=t.facet(zl))return e;let i="";for(let t=je(e,4,n);t>0;)t>=4?(i+="\t",t-=4):(i+=" ",t--);return i+e.slice(n)}function Yb(e){return"QuoteMark"==e.name||"ListMark"==e.name}function Jb(e,t,n){let i="";for(let t=0,r=e.length-2;t<=r;t++)i+=e[t].blank(t<r?je(n.text,4,e[t+1].from)-i.length:null,t<r);return Hb(i,t)}var Kb=[{key:"Enter",run:({state:e,dispatch:t})=>{let n=Nl(e),{doc:i}=e,r=null,s=e.changeByRange((t=>{if(!t.empty||!Zb.isActiveAt(e,t.from))return r={range:t};let s=t.from,o=i.lineAt(s),a=qb(n.resolveInner(s,-1),i);for(;a.length&&a[a.length-1].from>s-o.from;)a.pop();if(!a.length)return r={range:t};let l=a[a.length-1];if(l.to-l.spaceAfter.length>s-o.from)return r={range:t};let h=s>=l.to-l.spaceAfter.length&&!/\S/.test(o.text.slice(l.to));if(l.item&&h){let t=l.node.firstChild,n=l.node.getChild("ListItem","ListItem");if(t.to>=s||n&&n.to<s||o.from>0&&!/[^\s>]/.test(i.lineAt(o.from-1).text)){let e,t=a.length>1?a[a.length-2]:null,n="";t&&t.item?(e=o.from+t.from,n=t.marker(i,1)):e=o.from+(t?t.to:0);let r=[{from:e,to:s,insert:n}];return"OrderedList"==l.node.name&&Wb(l.item,i,r,-2),t&&"OrderedList"==t.node.name&&Wb(t.item,i,r),{range:X.cursor(e+n.length),changes:r}}{let t=Jb(a,e,o);return{range:X.cursor(s+t.length+1),changes:{from:o.from,insert:t+e.lineBreak}}}}if("Blockquote"==l.node.name&&h&&o.from){let n=i.lineAt(o.from-1),r=/>\s*$/.exec(n.text);if(r&&r.index==l.from){let i=e.changes([{from:n.from+r.index,to:n.to},{from:o.from+l.from,to:o.to}]);return{range:t.map(i),changes:i}}}let c=[];"OrderedList"==l.node.name&&Wb(l.item,i,c);let u=l.item&&l.item.from<o.from,d="";if(!u||/^[\s\d.)\-+*>]*/.exec(o.text)[0].length>=l.to)for(let e=0,t=a.length-1;e<=t;e++)d+=e!=t||u?a[e].blank(e<t?je(o.text,4,a[e+1].from)-d.length:null):a[e].marker(i,1);let p=s;for(;p>o.from&&/\s/.test(o.text.charAt(p-o.from-1));)p--;return d=Hb(d,e),function(e,t){if("OrderedList"!=e.name&&"BulletList"!=e.name)return!1;let n=e.firstChild,i=e.getChild("ListItem","ListItem");if(!i)return!1;let r=t.lineAt(n.to),s=t.lineAt(i.from),o=/^[\s>]*$/.test(r.text);return r.number+(o?0:1)<s.number}(l.node,e.doc)&&(d=Jb(a,e,o)+e.lineBreak+d),c.push({from:p,to:s,insert:e.lineBreak+d}),{range:X.cursor(p+d.length+1),changes:c}}));return!r&&(t(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0)}},{key:"Backspace",run:({state:e,dispatch:t})=>{let n=Nl(e),i=null,r=e.changeByRange((t=>{let r=t.from,{doc:s}=e;if(t.empty&&Zb.isActiveAt(e,t.from)){let t=s.lineAt(r),i=qb(function(e,t){let n,i=e.resolveInner(t,-1),r=t;for(Yb(i)&&(r=i.from,i=i.parent);n=i.childBefore(r);)if(Yb(n))r=n.from;else{if("OrderedList"!=n.name&&"BulletList"!=n.name)break;i=n.lastChild,r=i.to}return i}(n,r),s);if(i.length){let n=i[i.length-1],s=n.to-n.spaceAfter.length+(n.spaceAfter?1:0);if(r-t.from>s&&!/\S/.test(t.text.slice(s,r-t.from)))return{range:X.cursor(t.from+s),changes:{from:t.from+s,to:r}};if(r-t.from==s&&(!n.item||t.from<=n.item.from||!/\S/.test(t.text.slice(0,n.to)))){let i=t.from+n.from;if(n.item&&n.node.from<n.item.from&&/\S/.test(t.text.slice(n.from,n.to))){let r=n.blank(je(t.text,4,n.to)-je(t.text,4,n.from));return i==t.from&&(r=Hb(r,e)),{range:X.cursor(i+r.length),changes:{from:i,to:t.from+n.to,insert:r}}}if(i<r)return{range:X.cursor(i),changes:{from:i,to:r}}}}}return i={range:t}}));return!i&&(t(e.update(r,{scrollIntoView:!0,userEvent:"delete"})),!0)}}],ew=mv({matchClosingTags:!1});function tw(e={}){let{codeLanguages:t,defaultCodeLanguage:n,addKeymap:i=!0,base:{parser:r}=Vb,completeHTMLTags:s=!0}=e;if(!(r instanceof qv))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let o,a=e.extensions?[e.extensions]:[],l=[ew.support];n instanceof Ll?(l.push(n.support),o=n.language):n&&(o=n);let h=t||o?function(e,t){return n=>{if(n&&e){let t=null;if(n=/\S*/.exec(n)[0],t="function"==typeof e?e(n):Ul.matchLanguageName(e,n,!0),t instanceof Ul)return t.support?t.support.language.parser:Ql.getSkippingParser(t.load());if(t)return t.parser}return t?t.parser:null}}(t,o):void 0;a.push(function(e){let{codeParser:t,htmlParser:n}=e;return{wrap:Ko(((e,i)=>{let r=e.type.id;if(!t||r!=gv.CodeBlock&&r!=gv.FencedCode){if(n&&(r==gv.HTMLBlock||r==gv.HTMLTag))return{parser:n,overlay:xb(e.node,e.from,e.to)}}else{let n="";if(r==gv.FencedCode){let t=e.node.getChild(gv.CodeInfo);t&&(n=i.read(t.from,t.to))}let s=t(n);if(s)return{parser:s,overlay:e=>e.type.id==gv.CodeText}}return null}))}}({codeParser:h,htmlParser:ew.language.parser})),i&&l.push(te.high(Wr.of(Kb)));let c=Ub(r.configure(a));return s&&l.push(c.data.of({autocomplete:nw})),new Ll(c,l)}function nw(e){let{state:t,pos:n}=e,i=/<[:\-\.\w\u00b7-\uffff]*$/.exec(t.sliceDoc(n-25,n));if(!i)return null;let r=Nl(t).resolveInner(n,-1);for(;r&&!r.type.isTop;){if("CodeBlock"==r.name||"FencedCode"==r.name||"ProcessingInstructionBlock"==r.name||"CommentBlock"==r.name||"Link"==r.name||"Image"==r.name)return null;r=r.parent}return{from:n-i[0].length,to:n,options:rw(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}var iw=null;function rw(){if(iw)return iw;let e=function(e){return lv(ev.default,e)}(new ep(Te.create({extensions:ew}),0,!0));return iw=e?e.options:[]}var sw=class extends ag{constructor(e,t=[]){super(e,t)}async getExtensions(e){return[tw()]}serialize(){return this.editor.content}},ow=class extends HTMLElement{constructor(){super(),this._mode="xml",this._placeholder="",this.attachShadow({mode:"open"})}static get observedAttributes(){return["placeholder","mode","code"]}connectedCallback(){let e=document.createElement("style");e.innerHTML=this.styles(),this.shadowRoot?.appendChild(e);let t=document.createElement("slot");t.name="header",this.shadowRoot?.appendChild(t);let n=document.createElement("slot");n.name="toolbar",this.shadowRoot?.appendChild(n);let i=document.createElement("div");i.id="editor",this.shadowRoot?.appendChild(i),this.registerToolbar(this.shadowRoot?.querySelector("[name=toolbar]")),this._placeholder=this.getAttribute("placeholder")||"",this.namespace=this.getAttribute("namespace"),this.linter=this.getAttribute("linter"),this.mode=this.initModes()||this.getAttribute("mode")||"xml",this.hasAttribute("mode")||this.setAttribute("mode",this._mode),this.hasAttribute("code")&&(this.value=this.getAttribute("code")),this.hasAttribute("theme")&&(this.theme=this.getAttribute("theme")),this.addEventListener("blur",(e=>{let t=e.relatedTarget;if(t){let n=t.parentNode;for(;n;){if(n===this)return e.preventDefault(),void e.stopPropagation();n=n.parentNode}}}))}attributeChangedCallback(e,t,n){if(t&&t!==n)switch(e){case"placeholder":this.placeholder=n;break;case"mode":this.mode=n;break;case"code":this.value=n}}focus(){this._editor&&this._editor.focus()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.setMode(this.mode)}set mode(e){this.setMode(e)}setMode(e,t=!0){let n=this.shadowRoot?.getElementById("editor");if(!n)return;this._editor&&(this._editor.destroy(),n.innerHTML=""),this._mode=ng[e],this.activateToolbar(this.shadowRoot?.querySelector("[name=toolbar]")),this.configure();let i=this.querySelector("[name=modes]");i&&i instanceof HTMLSelectElement&&(i.value=this._mode),this._config?.getConfig().then((e=>{this._editor=new Lr({state:Te.create(e),parent:n}),this._config&&t&&(this.content=this._config.setFromValue(this._value))}))}configure(){let e=this.getToolbarControls(this.shadowRoot?.querySelector("[name=toolbar]"));switch(this._mode){case"edcs":case"phi":this._config=new Vg(this,e,this._mode);break;case"leiden_plus":this._config=new Xg(this,e);break;case"xquery":this._config=new aO(this,e,this.linter);break;case"css":this._config=new NO(this,e);break;case"json":this._config=new BO(this,e);break;case"tex":this._config=new LO(this,e);break;case"html":this._config=new vv(this,e);break;case"xml":this._config=new Ag(this,e,this.namespace);break;case"markdown":this._config=new sw(this,e);break;default:this._config=new DO(this,e)}}get mode(){return this._mode}set valid(e){this.setAttribute("valid",e.toString())}get valid(){return!!this.hasAttribute("valid")}set status(e){this._config.status=e}set content(e){this._editor&&setTimeout((()=>this._editor.dispatch({changes:{from:0,to:this._editor.state.doc.length,insert:e}})))}get content(){return this._editor?.state.doc.toString()||""}set value(e){this.setValue(e)&&this._editor&&this._config&&(this.content=this._config?.setFromValue(this._value))}get value(){return this.getValue()}setValue(e){if(!this._config)return!1;let t=this._config.setFromValue(e);return this._value!==t&&(this._value=e,!0)}getValue(){return this._value?this._value:null}set code(e){this.value=e}clear(){this._value="",this._editor.dispatch({changes:{from:0,to:this._editor.state.doc.length,insert:""}})}emitUpdateEvent(e){this.dispatchEvent(new CustomEvent("update",{detail:{content:e},composed:!0,bubbles:!0}))}initModes(){let e=this.querySelector("[name=modes]");return e&&e instanceof HTMLSelectElement?(e.addEventListener("change",(()=>{this.mode=e.value})),e.value):null}registerToolbar(e){e?.assignedElements().forEach((e=>{e.querySelectorAll("slot").forEach((e=>this.registerToolbar(e))),e.querySelectorAll("[data-command]").forEach((e=>{let t=e.dataset.command;e.hasAttribute("data-key")&&(e.title=`${e.title} (${e.getAttribute("data-key")})`),e.addEventListener("click",(()=>{if(!this._config)return;let n=this._config.getCommands()[t];if(n){let i=sg(0,n,e);i&&(i(this._editor),"encloseWithCommand"!==t&&this._editor?.focus())}}))}))}))}activateToolbar(e){e?.assignedElements().forEach((e=>{e.querySelectorAll("slot").forEach((e=>this.activateToolbar(e))),e.querySelectorAll("[data-command]").forEach((e=>{let t=e;t.dataset.mode&&t.dataset.mode!==this._mode?t.style.display="none":t.style.display="inline"}))}))}getToolbarControls(e,t=[]){return e?.assignedElements().forEach((e=>{e.querySelectorAll("[data-command]").forEach((e=>{t.push(e)})),e.querySelectorAll("slot").forEach((e=>this.getToolbarControls(e,t)))})),t}styles(){return"\n            :host > div {\n                width: 100%;\n                background-color: var(--jinn-codemirror-background-color, #fff);\n            }\n\n            .cm-cursor {\n                min-height: 1rem;\n            }\n\n            .status {\n                padding-left: .5rem;\n            }\n        "}};window.customElements.define("jinn-codemirror",ow);customElements.get("jinn-xml-editor")||window.customElements.define("jinn-xml-editor",class extends ow{constructor(){super(),this.unwrap=!1,this.schema=null,this.schemaRoot=null}connectedCallback(){this.schema=this.getAttribute("schema"),this.schemaRoot=this.getAttribute("schema-root"),this.unwrap=this.hasAttribute("unwrap"),super.connectedCallback();let e=this.getAttribute("wrapper");if(e){let t=new DOMParser,n=t.parseFromString(e,"application/xml"),i=n.getElementsByTagName("parsererror"),r=null;if(i.length);else{if(r=n.firstElementChild,r&&this.hasAttribute("code")){let e=this.getAttribute("code")||"";n=t.parseFromString(e,"application/xml"),i=n.getElementsByTagName("parsererror"),i.length||n.firstElementChild&&r.appendChild(n.firstElementChild)}this.setValue(r)}}}configure(){let e=this.getToolbarControls(this.shadowRoot?.querySelector("[name=toolbar]")),t=this.hasAttribute("check-namespace");this._config=new Ag(this,e,this.namespace,t,this.unwrap)}emitUpdateEvent(e){if(!this.unwrap)return super.emitUpdateEvent(e);this.updateValue(),super.emitUpdateEvent(this._wrapper)}updateValue(){if(!this._wrapper)return null;if(this._wrapper.replaceChildren(),this._value)if(this._value instanceof NodeList)for(let e=0;e<this._value.length;e++){let t=this._wrapper.ownerDocument.importNode(this._value[e],!0);this._wrapper?.appendChild(t)}else{if(!(this._value instanceof Node))throw new Error("value is not a node");this._wrapper?.appendChild(this._value)}else;}setValue(e){if(!this.unwrap)return super.setValue(e);if(this._config?.setFromValue(this._wrapper)===this._config?.setFromValue(e))return!1;if(e||(this._wrapper=null),"string"==typeof e){let t=(new DOMParser).parseFromString(e,"application/xml");if(!t.firstElementChild)return!1;e=t.firstElementChild}return this._wrapper=e,this._value=e?.childNodes,!0}getValue(){if(!this.unwrap)return super.getValue();if(!this._wrapper)return null;if(!(this._wrapper instanceof Element))throw new Error("Value is not a node");return this.updateValue(),this._wrapper}});var aw=["Shift","Alt","Meta","Control","ArrowLeft","ArrowRight","ArrowDown","ArrowUp","PageDown","PageUp","Home","End"],lw={leiden_plus:"Leiden+",edcs:"EDCS/EDH",default:"Petrae"};var hw=class extends HTMLElement{constructor(){super(),this.mode="leiden_plus",this.placeholder="",this.showLeiden=!1,this.xmlEditor=null,this.valid=!0,this.unwrap=!1,this.schema=null,this.schemaRoot=null,this.modeSelect=!1,this.attachShadow({mode:"open"})}set value(e){this.xmlEditor.value=e}get value(){return this.xmlEditor.value}connectedCallback(){this.unwrap=this.hasAttribute("unwrap"),this.schema=this.getAttribute("schema"),this.schemaRoot=this.getAttribute("schema-root"),this.modeSelect=this.hasAttribute("mode-select"),this.mode=this.getAttribute("mode")||"leiden_plus",this.placeholder=this.getAttribute("placeholder")||"",this.showLeiden=this.hasAttribute("show-leiden"),this.shadowRoot.innerHTML=`\n            <style>\n                \n    :host {\n        display: block;\n        width: 100%;\n    }\n    jinn-codemirror {\n        font-size: 1rem;\n        display:block;\n        width:100%;\n    }\n    jinn-codemirror[valid="true"] {\n        outline: thin solid green;\n    }\n    jinn-codemirror[valid="false"] {\n        outline: thin solid red;\n    }\n    #leiden-editor {\n        margin-bottom:0.5rem;\n    }\n    [slot=toolbar] {\n        display: flex;\n    }\n    .hidden {\n        display: none;\n    }\n    #close-leiden {\n        margin-left: .75rem;\n        font-weight: bold;\n    }\n            </style>\n            <jinn-codemirror id="leiden-editor" class="${this.showLeiden?"":"hidden"}" mode="${this.mode}">\n                <div slot="header"><slot name="leiden-header"></slot></div>\n                <div slot="toolbar">\n                    ${this.modeSelect?function(e){let t=[];return Object.entries(lw).forEach((([n,i])=>{t.push(`<option value="${n}" ${n===e?"selected":""}>${i}</option>`)})),`<select name="modes">${t.join("\n")}</select>`}(this.mode):""}\n                    <slot name="leiden-toolbar"></slot>\n                    <button part="button" id="close-leiden">Close</button>\n                </div>\n            </jinn-codemirror>\n            <jinn-xml-editor id="xml-editor" ${this.unwrap?"unwrap":""} schema="${this.schema}"\n                schema-root="${this.schemaRoot}" placeholder="${this.placeholder}">\n                <div slot="header"><slot name="xml-header"></slot></div>\n                <div slot="toolbar">\n                    <slot name="open-leiden" id="import" class="${this.showLeiden?"hidden":""}">\n                        <button part="button" title="Import from Leiden markup">Leiden Editor</button>\n                    </slot>\n                    <slot name="xml-toolbar"></slot>\n                </div>\n            </jinn-xml-editor>\n        `,this.xmlEditor=this.shadowRoot?.querySelector("#xml-editor");let e=this.shadowRoot?.querySelector("#leiden-editor"),t=this.shadowRoot?.querySelector("#import"),n=this.shadowRoot?.querySelector("#close-leiden");if(!(this.xmlEditor&&e&&t&&n))throw new Error("One or more components were not initialized");let i=!0,r=this.showLeiden;e.addEventListener("update",(e=>{e.stopPropagation(),this.showLeiden=!1,i&&(this.xmlEditor.content=e.detail.content),i=!0})),this.xmlEditor.addEventListener("keyup",(e=>{if(r){if(aw.indexOf(e.key)>-1)return;o()}}));let s=()=>{t.classList.add("hidden"),e.classList.remove("hidden"),r=!0,e.focus()},o=()=>{e.classList.add("hidden"),t.classList.remove("hidden"),r=!1,this.xmlEditor?.focus(),i=!1,e?.clear()},a=()=>{if(e.classList.contains("hidden")||this.showLeiden)if(this.xmlEditor.content.length>0){if(!this.valid)return void alert("The XML contains errors. Cannot convert to Leiden+");let t=this.xmlEditor?.value;i=!1,e.setMode("leiden_plus",!1);try{this.unwrap&&t instanceof Element?e.value=t.childNodes:e.value=t,this.xmlEditor.status="",s()}catch(e){this.xmlEditor.status=e.message,o()}}else s(),e.value="";else o()};t.addEventListener("click",(()=>{a()})),n.addEventListener("click",(()=>{o()})),this.xmlEditor.addEventListener("invalid",(e=>{e.stopPropagation(),this.valid=!1,this.setAttribute("valid",this.valid.toString()),this.dispatchEvent(new CustomEvent("invalid",{detail:e.detail,composed:!0,bubbles:!0}))})),this.xmlEditor.addEventListener("valid",(e=>{e.stopPropagation(),this.valid=!0,this.setAttribute("valid",this.valid.toString()),this.dispatchEvent(new CustomEvent("valid",{detail:e.detail,composed:!0,bubbles:!0}))})),this.xmlEditor.addEventListener("update",(()=>{this.showLeiden&&a(),this.showLeiden=!1}),{once:!0})}};customElements.get("jinn-epidoc-editor")||window.customElements.define("jinn-epidoc-editor",hw)})();
/*! Bundled license information:

tom-select/dist/js/tom-select.complete.js:
  (*! @orchidjs/unicode-variants | https://github.com/orchidjs/unicode-variants | Apache License (v2) *)
  (*! sifter.js | https://github.com/orchidjs/sifter.js | Apache License (v2) *)
*/
class Zl extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.mode="xml",this.isResizing=!1,this.lastX=0,document.addEventListener("DOMContentLoaded",(()=>{this.fores=Array.from(document.querySelectorAll("fx-fore")),this.render(),document.addEventListener("ready",(e=>{Array.from(document.querySelectorAll("fx-fore"))})),this.fores.forEach((e=>{e.addEventListener("ready",(()=>{this.render()})),e.addEventListener("value-changed",(e=>{this.update();const t=`${e.detail.foreId}#${e.detail.instanceId}`,n=this.shadowRoot.querySelector(`summary[data-id="${t}"]`);this.flashEffect(n)})),e.addEventListener("deleted",(e=>{this.update();const t=`${e.detail.foreId}#${e.detail.instanceId}`,n=this.shadowRoot.querySelector(`summary[data-id="${t}"]`);this.flashEffect(n)})),e.addEventListener("insert",(e=>{this.update();const t=`${e.detail.foreId}#${e.detail.instanceId}`,n=this.shadowRoot.querySelector(`summary[data-id="${t}"]`);this.flashEffect(n)}))})),this.lastWidth=this.offsetWidth}))}flashEffect(e){e.style.background="rgba(55,55,255,0.1)",setTimeout((()=>{e.style.background="ghostwhite"}),1e3)}async render(){this.shadowRoot.innerHTML="";Array.from(document.querySelectorAll("fx-fore"));const e=Array.from(document.querySelectorAll("fx-instance")),t=JSON.parse(localStorage.getItem("lens-panels")||"[]");this.shadowRoot.innerHTML=`\n        <style>\n            \n          :host {\n            position:fixed;\n            display: block;\n            width:var(--inspector-handle-width);\n            top:0;\n            right:0;\n            bottom:0;\n            height: 100vh;\n            background: aliceblue;\n            color: white;\n            overflow: hidden;\n            z-index:900;\n            max-width:calc(100vw - var(--inspector-handle-width));\n            min-width:var(--inspector-handle-width);\n            box-shadow:-2px -2px 8px rgba(0,0,0,0.3);\n          }\n            \n          :host:has(.handle:hover){\n            box-shadow:-2px -2px 8px rgba(0,0,0,0.6);\n          }\n          jinn-codemirror{\n            min-height:5rem;\n          }\n          :host([open]){\n            width: 40vw;\n          }\n          details{\n            margin:0;\n            width:calc(100% - 17px);\n            position:relative;\n          }\n          .main{\n            padding-left:var(--inspector-handle-width);\n            color:var(--inspector-color);\n            overflow:scroll;\n            height:100vh;\n            background:ghostwhite);\n            overflow:hidden;\n            \n          }\n          .main > div{\n            overflow:auto;\n            height:100vh;\n          }\n          .handle{\n            display:flex;\n            justify-content:center;\n            height:100%;\n            width:var(--inspector-handle-width);\n            background:var(--inspector-handle-bg);\n            position:absolute;\n            left:0;\n            color:white;\n            cursor:pointer;\n            z-index:800;\n          }\n          .handle:hover{\n            opacity:1;\n          }\n          .handle::before{\n            content: 'Data Lens';\n            white-space: nowrap;\n            transform: rotate(-90deg);\n            display: inline-block;\n            position: absolute;\n            left: -85px;\n            width: 200px;\n            top: 0px;\n            z-index:801;\n          }\n          .handle a,\n          .handle a:visited,\n          .handle a:link{\n            text-decoration:none;\n            color:white;\n            width:1.5rem;\n            height:1.5rem;\n            display:inline-flex;\n            align-items:center;\n            justify-content:center;\n            position:absolute;\n            z-index:850;\n            \n           }\n          .fore-section summary{\n            cursor:pointer;\n            padding:1rem 0.5rem;\n            background:papayawhip;\n            font-size:1.2rem;\n            transition: background 0.5s ease-in-out;\n          }\n          header{\n            padding:0.5rem;\n          }\n          details.instance summary{\n            font-size:1.2rem;\n            background:ghostwhite;\n            padding:0.5rem;\n          }\n          .resizer{\n            width:0.25rem;\n            background:blue;\n            height:100vh;\n            background:rgba(215,220,235,0.3);\n            cursor: ew-resize;\n            position:absolute;\n            top:0;\n            left:0;\n            z-index:999;\n          }\n        \n        </style>\n          <details class="main" open>\n              <div class="resizer"></div>  \n              <summary class="handle"><a href="#" id="reset" title="reset panel state to defaults">&#x2715;</a></summary>\n              <div>\n                ${e.map(((e,t)=>{const n=e.closest("fx-fore").id;return`<details  id="d${t}" class="instance"><summary data-id="${n}#${e.id}">${n}#${e.id}</summary><jinn-codemirror mode="${e.type}"></jinn-codemirror></details>`})).join("")}\n              </div>\n          </details>\n        `;const n=localStorage.getItem("lens-width");n&&(this.style.width=`${n}px`);const i=this.shadowRoot.querySelector(".main"),r=localStorage.getItem("lens-open");r?"true"===r?i.setAttribute("open","open"):(i.removeAttribute("open"),this.removeAttribute("open"),this.removeAttribute("style")):i.setAttribute("open","open");for(let t=0;t<e.length;t++){Array.from(this.shadowRoot.querySelectorAll("jinn-codemirror"))[t].value=e[t].instanceData}this.shadowRoot.querySelector(".handle").addEventListener("click",(e=>{this.hasAttribute("open")?(this.removeAttribute("open"),this.removeAttribute("style"),localStorage.setItem("lens-open","false")):(this.setAttribute("open","open"),n&&(this.style.width=`${n}px`),localStorage.setItem("lens-open","true"),this.render())}));this.shadowRoot.querySelector(".handle a").addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),localStorage.removeItem("lens-width"),localStorage.removeItem("lens-open"),localStorage.removeItem("lens-panels")}));const s=this.shadowRoot.querySelectorAll("summary");Array.from(s).forEach((e=>{e.addEventListener("click",(e=>{const t=e.target.parentNode,n=t.id,i=JSON.parse(localStorage.getItem("lens-panels")||"[]");if(t.hasAttribute("open")){if(i.includes(n)){const e=i.indexOf(n);i.splice(e,1),localStorage.setItem("lens-panels",JSON.stringify(i))}}else i.includes(n)||(i.push(n),localStorage.setItem("lens-panels",JSON.stringify(i)))}))}));const o=this.shadowRoot.querySelectorAll("details.instance");Array.from(o).forEach((e=>{t.includes(e.id)?e.setAttribute("open","open"):e.removeAttribute("open")})),this.resizer=this.shadowRoot.querySelector(".resizer"),this.resizer.addEventListener("mousedown",(e=>{this.isResizing=!0,this.lastX=e.clientX,this.lastWidth=this.offsetWidth})),document.addEventListener("mousemove",(e=>{if(e.preventDefault(),e.stopPropagation(),!this.isResizing)return;const t=e.clientX-this.lastX;this.style.width=this.lastWidth-t+"px"})),document.addEventListener("mouseup",(e=>{e.preventDefault(),e.stopPropagation(),this.isResizing=!1,this.lastX=e.clientX,this.lastWidth=this.offsetWidth,this.hasAttribute("open")&&localStorage.setItem("lens-width",this.lastWidth)}))}update(){const e=Array.from(document.querySelectorAll("fx-instance")),t=Array.from(this.shadowRoot.querySelectorAll("jinn-codemirror"));for(let n=0;n<e.length;n++)t[n].value=e[n].instanceData}}customElements.get("fx-lens")||customElements.define("fx-lens",Zl);class jl extends ml{constructor(){super(),this.inited=!1,this.attachShadow({mode:"open"})}static get properties(){return{...ml.properties,accept:{type:String},fileNameExpr:{type:String},mimetypeExpr:{type:String}}}connectedCallback(){this.updateEvent="change",this.accept=this.hasAttribute("accept")?this.getAttribute("accept"):"",this.label=this.hasAttribute("label")?this.getAttribute("label"):null;this.shadowRoot.innerHTML=`\n            <style>\n                \n            :host{\n                display:inline-block;\n            }\n        \n            </style>\n            ${this.renderHTML(this.ref)}\n        `,this.widget=this.getWidget(),this.addEventListener("mousedown",(e=>{Ga.isWidget(e.target)||e.target?.classList.contains("fx-hint")||e.preventDefault(),this.widget.focus()}));let e=this.widget;this.debounceDelay?e.addEventListener(this.updateEvent,Ol(this,(()=>{this._importUploadedContent()}),this.debounceDelay)):e.addEventListener(this.updateEvent,(async e=>{this._importUploadedContent(e)})),this.boundInitialized=!1,this.fileNameExpr=this.getAttribute("filename"),this.mimetypeExpr=this.getAttribute("mimetype")}async _importUploadedContent(e){const t=e.target.files[0];this.evalInContext();const n=Ma(this.fileNameExpr,this.nodeset,this.getOwnerForm());n&&(this.fileName=n.nodeValue=t.name),this.mimetype=t.type;const i=Ma(this.mimetypeExpr,this.nodeset,this.getOwnerForm());i&&(i.nodeValue=this.mimetype);let r=await this._readFile(t);if(t.type.endsWith("xml")){r=(new DOMParser).parseFromString(r,"application/xml").firstElementChild}this.setValue(r)}async _readFile(e){return new Promise(((t,n)=>{const i=new FileReader,r=e.type.startsWith("text/"),s=r?"readAsText":"readAsDataURL";i.onload=()=>{const e=i.result;if(r)t(e);else{const n=e.split(",")[1];t(n)}},i.onerror=()=>n(new Error("Error reading file")),i[s](e)}))}setValue(e){this.value=e;const t=this.getModelItem();if(this.mimetype.endsWith("xml"))this.nodeset.textContent="",this.nodeset.append(document.importNode(e,!0));else if(t.value=e,this.mimetype.startsWith("text/")){const t=this.nodeset.ownerDocument.createCDATASection(e);this.nodeset.textContent="",this.nodeset.append(t)}else this.nodeset.textContent="",this.nodeset.append(e);this.getAttribute("class")?this.classList.add("visited"):this.setAttribute("class","visited"),t?.readonly||(this.modelItem instanceof Ha&&!this.modelItem?.boundControls.includes(this)&&this.modelItem.boundControls.push(this),this.getModel(),Ga.dispatch(this,"value-changed",{path:this.modelItem.path,value:this.modelItem.value,oldvalue:"",instanceId:this.modelItem.instanceId,foreId:this.getOwnerForm().id}),this.getModel().updateModel(),this.getOwnerForm().refresh(!0))}renderHTML(e){return`\n            ${this.label?`${this.label}`:""}\n            <slot></slot>\n            <input type="file" ${""!==this.accept?`accept="${this.accept}"`:""}>\n            <fx-setvalue id="setvalue" ref="${e}"></fx-setvalue>\n        `}getWidget(){return this.shadowRoot.querySelector("input")}async updateWidgetValue(){let{widget:e}=this;e||(e=this),e.value,this.value}async refresh(e){super.refresh(e),Ga.refreshChildren(this,e)}evalLabel(e,t,n){const i=e.substring(1,e.length-1);if(!i)return;const r=Xa(i,t,this);n.textContent=r}createEntry(){return this.template.content.firstElementChild.cloneNode(!0)}_getValueAttribute(e){let t;return Array.from(e.attributes).forEach((e=>{-1!==e.value.indexOf("{")&&(t=e)})),t}}async function ql(e){return new Promise((t=>setTimeout((()=>t()),e)))}customElements.get("fx-upload")||window.customElements.define("fx-upload",jl);class Gl extends Ka{static get properties(){return{...super.properties,defaultAction:{type:String},delay:{type:Number},detail:{type:Object},event:{type:Object},handler:{type:Object},ifExpr:{type:String},iterateExpr:{type:String},needsUpdate:{type:Boolean},observer:{type:Object},phase:{type:String},propagate:{type:String},target:{type:String},whileExpr:{type:String}}}constructor(){super(),this.detail={},this.needsUpdate=!1}disconnectedCallback(){}connectedCallback(){this.setAttribute("inert","true"),this.style.display="none",this.propagate=this.hasAttribute("propagate")?this.getAttribute("propagate"):"continue",this.repeatContext=void 0,this.hasAttribute("event")&&(this.event=this.getAttribute("event")),this.hasAttribute("defaultAction")?this.defaultAction=this.getAttribute("defaultAction"):this.defaultAction="perform",this.hasAttribute("phase")?this.phase=this.getAttribute("phase"):this.phase="default",this.ifExpr=this.hasAttribute("if")?this.getAttribute("if"):null,this.whileExpr=this.hasAttribute("while")?this.getAttribute("while"):null,this.delay=this.hasAttribute("delay")?Number(this.getAttribute("delay")):0,this.iterateExpr=this.hasAttribute("iterate")?this.getAttribute("iterate"):null,this._addUpdateListener()}_addUpdateListener(){if(this.target=this.getAttribute("target"),this.target)if("#window"===this.target)window.addEventListener(this.event,(e=>this.execute(e)),{capture:"capture"===this.phase});else if("#document"===this.target)document.addEventListener(this.event,(e=>this.execute(e)),{capture:"capture"===this.phase});else{if(this.targetElement=Ea(this.target,this),!this.targetElement)return;this?.targetElement.addEventListener(this.event,(e=>this.execute(e)),{capture:"capture"===this.phase})}else this.targetElement=this.parentNode,this.targetElement.addEventListener(this.event,(e=>this.execute(e)),{capture:"capture"===this.phase})}async performSafe(){try{return await this.perform(),!0}catch(e){return await Ga.dispatch(this,"error",{origin:this,message:"Action execution failed",expr:va.getDocPath(this),level:"Error"}),!1}}async execute(e){if(!this.getModel().modelConstructed)return;if(this.event&&this.event,e&&e.target.nodeType!==Node.DOCUMENT_NODE&&e.target!==window&&e.target.closest("fx-fore")&&e.target.closest("fx-fore")!==this.closest("fx-fore"))return;"stop"===this.propagate&&e.stopPropagation(),"cancel"===this.defaultAction&&e.preventDefault();let t=()=>{};e&&e.listenerPromises&&e.listenerPromises.push(new Promise((e=>{t=e}))),null===hl.outermostHandler&&(hl.outermostHandler=this,this.dispatchEvent(new CustomEvent("outermost-action-start",{composed:!0,bubbles:!0,cancelable:!0,detail:{cause:e?.type}}))),e&&(this.currentEvent=e),this.needsUpdate=!1;try{this.evalInContext()}catch(e){}if(this.targetElement&&this.targetElement.nodeset&&(this.nodeset=this.targetElement.nodeset),this.iterateExpr)return await this.handleIterateExpr(),void this._finalizePerform(t);if(!this.ifExpr||Da(this.ifExpr,qa(this),this)){if(this.whileExpr)return await this.handleWhileExpr(),void this._finalizePerform(t);if(this.delay&&(await ql(this.delay),!va.contains(this.getOwnerForm(),this)))return this.actionPerformed(),void t();await this.performSafe(),this._finalizePerform(t)}else this._finalizePerform(t)}async handleWhileExpr(){await ql(this.delay||0),va.contains(this.getOwnerForm(),this)&&Da(this.whileExpr,qa(this),this)&&this.performSafe()&&(this.delay?this.handleWhileExpr():await this.handleWhileExpr())}async handleIterateExpr(){try{const e=Ra(this.iterateExpr,qa(this),this);if(0===e.length)return;if(!va.contains(this.getOwnerForm(),this))return;for(const t of e)if(this.delay&&await ql(this.delay||0),this.currentContext=t,!await this.performSafe())return}finally{this.currentContext=null}}_finalizePerform(e){this.currentEvent=null,this.actionPerformed(),hl.outermostHandler===this&&(hl.outermostHandler=null,this.dispatchEvent(new CustomEvent("outermost-action-end",{composed:!0,bubbles:!0,cancelable:!0}))),e()}async perform(){(this.isBound()||"FX-ACTION"===this.nodeName)&&this.evalInContext(),this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}}))}actionPerformed(){const e=this.getModel();e&&e.inited&&(hl.outermostHandler&&!va.contains(hl.outermostHandler.ownerDocument,hl.outermostHandler)&&(hl.outermostHandler=null),!this.needsUpdate||hl.outermostHandler!==this&&hl.outermostHandler?this.needsUpdate&&(hl.outermostHandler.needsUpdate=!0):(e.recalculate(),e.revalidate(),e.parentNode.refresh(!0),this.dispatchActionPerformed()))}dispatchActionPerformed(){Ga.dispatch(this,"action-performed",{})}}Gl.dataChanged=!1,customElements.get("abstract-action")||window.customElements.define("abstract-action",Gl);class Wl extends Gl{static get properties(){return{...Gl.properties,ref:{type:String},repeat:{type:String},clear:{type:String}}}constructor(){super(),this.repeat=""}connectedCallback(){super.connectedCallback(),this.ref=this.getAttribute("ref"),this.repeat=this.getAttribute("repeat")}async perform(){super.perform(),this._dataFromTemplate(),this.needsUpdate=!0}actionPerformed(){super.actionPerformed(),this._dispatch()}_dataFromTemplate(){const e=this.getInScopeContext(),t=this.getOwnerForm().querySelector(`#${this.repeat}`),n=t.shadowRoot.querySelector("template"),i=e.ownerDocument.createElement(t.ref),r=this._generateInstance(n.content,i);e.appendChild(r)}_dispatch(){const e=Ea(this.repeat,this);Ga.dispatch(e,"index-changed",{index:e.nodeset.length})}_clear(e){let t=e.firstChild;const n=e.attributes;for(let e=0;e<n.length;e+=1)n[e].value="";for(;t;)1===t.nodeType&&t.hasAttributes()&&(t.textContent=""),this._clear(t),t=t.nextSibling}_generateInstance(e,t){if(1===e.nodeType&&e.hasAttribute("ref")){const n=e.getAttribute("ref");let i;"."===n||(n.startsWith("@")?t.setAttribute(n.substring(1),""):(i=document.createElement(n),t.appendChild(i),0===e.children.length&&(i.textContent=e.textContent)))}if(e.hasChildNodes()){const n=e.children;for(let e=0;e<n.length;e+=1)this._generateInstance(n[e],t)}return t}getInstanceId(){return this.ref.startsWith("instance(")?"not implemented":"default"}}customElements.get("fx-append")||window.customElements.define("fx-append",Wl);class Hl extends Gl{static get properties(){return{...super.properties,ref:{type:String}}}async perform(){const e=qa(this.getAttributeNode("ref")||this,this.ref);this.nodeset=Ba(this.ref,e,this);const t=va.resolveInstance(this,this.ref),n=this.getModel().getInstance(t),i=Ga.getDomNodeIndexString(this.nodeset),r=this.nodeset;let s;if(this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event,path:i}})),Array.isArray(r)){if(0===r.length)return;s=r[0].parentNode,r.forEach((e=>{this._deleteNode(s,e)}))}else s=r.parentNode,this._deleteNode(s,r);const o=this.getOwnerForm().id;await Ga.dispatch(n,"deleted",{ref:i,deletedNodes:r,instanceId:t,foreId:o}),this.needsUpdate=!0}_deleteNode(e,t){if(e.nodeType===Node.DOCUMENT_NODE)return;if(t.nodeType===Node.DOCUMENT_NODE)return;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return;if(null===t.parentNode)return;this.getModelItem().readonly||e.removeChild(t)}actionPerformed(){this.getModel().rebuild(),super.actionPerformed()}}customElements.get("fx-delete")||window.customElements.define("fx-delete",Hl);class Yl extends Gl{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.control=this.hasAttribute("control")?this.getAttribute("control"):null}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}}));const e=`#${this.control}`;let t=document.querySelector(e);if(!t)return void Ga.dispatch(this,"error",{origin:this,message:`Instance '${this.control}' not found`,level:"Error"});const n=t.closest("fx-repeatitem");n&&(t=n.querySelector(e),this._focus(t));const i=t.closest("fx-repeatitem, .fx-repeatitem");if(i){t=i.parentNode.querySelector(`[repeat-index] ${e}`)}this._focus(t),this.hasAttribute("select")&&this._select(t)}_focus(e){e&&"function"==typeof e.getWidget&&e.getWidget().focus(),e&&e.nodeType===Node.ELEMENT_NODE&&e.click()}_select(e){e&&e.getWidget().select()}}customElements.get("fx-setfocus")||window.customElements.define("fx-setfocus",Yl);class Jl extends Gl{static get properties(){return{...super.properties,at:{type:Number},position:{type:Number},origin:{type:Object},keepValues:{type:Boolean}}}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){super.connectedCallback&&super.connectedCallback();this.shadowRoot.innerHTML="\n        <style>\n            \n        :host{\n            display:none;\n        }\n    \n        </style>\n        <slot></slot>\n    ",this.at=Number(this.hasAttribute("at")?this.getAttribute("at"):0),this.position=this.hasAttribute("position")?this.getAttribute("position"):"after",this.origin=this.hasAttribute("origin")?this.getAttribute("origin"):null,this.keepValues=!!this.hasAttribute("keep-values")}_getOriginSequence(e,t){let n;if(this.origin){let t;try{t=Ma(this.origin,e,this),Array.isArray(t)&&0===t.length&&(n=null),n=t}catch(e){}}else t&&(n=t,n&&!this.keepValues&&this._clear(n));return n}_cloneOriginSequence(e,t){let n;if(this.origin){let t;try{t=Ma(this.origin,e,this),Array.isArray(t)&&0===t.length&&(n=null),n=t.cloneNode(!0)}catch(e){}}else t&&(n=this._cloneTargetSequence(t),n&&!this.keepValues&&this._clear(n));return n}_getInsertIndex(e,t){return 0===t.length?null:this.hasAttribute("at")?Fa(this.getAttribute("at"),e,this):t.length}async perform(){let e,t,n=[];const i=qa(this);this.hasAttribute("context")&&([t]=Ba(this.getAttribute("context"),i,this.getOwnerForm()),e=i),this.hasAttribute("ref")&&(e||(e=qa(this.getAttributeNode("ref"),this.ref)),n=Ba(this.ref,e,this));const r=this._cloneOriginSequence(e,n);if(!r)return;let s,o;if(0===n.length)t?(s=t,t.appendChild(r),o=1):(s=e,e.appendChild(r),o=1);else{if(this.hasAttribute("at")?(o=Fa(this.getAttribute("at"),e,this),s=n[o-1]):(o=n.length,s=n[n.length-1]),!s){o=1,s=n;o=Fa("count(preceding::*)",n,this.getOwnerForm())+1}this.position&&"before"===this.position&&s.parentNode.insertBefore(r,s),this.position&&"after"===this.position&&(o+=1,this.hasAttribute("context")&&this.hasAttribute("ref")?e.append(r):this.hasAttribute("context")?(o=1,s.prepend(r)):s.insertAdjacentElement("afterend",r))}const a=va.resolveInstance(this,this.ref),l=this.getModel().getInstance(a),h=va.getPath(s.parentNode,a),c=Ga.getDomNodeIndexString(r);return this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event,path:c}})),Ga.dispatch(l,"insert",{"inserted-nodes":r,"insert-location-node":s,position:this.position,instanceId:a,foreId:this.getOwnerForm().id}),document.dispatchEvent(new CustomEvent("index-changed",{composed:!0,bubbles:!0,detail:{insertedNodes:r,index:o}})),this.needsUpdate=!0,[h]}_cloneTargetSequence(e){return Array.isArray(e)&&0!==e.length?e[e.length-1].cloneNode(!0):!Array.isArray(e)&&e?e.cloneNode(!0):null}actionPerformed(e){this.getModel().rebuild(),super.actionPerformed()}_clear(e){const t=e.attributes;for(let e=0;e<t.length;e+=1)t[e].value="";e.textContent&&(e.textContent="");let n=e.firstChild;for(;n;)1===n.nodeType&&n.hasAttributes()&&(n.textContent=""),this._clear(n),n=n.nextSibling}}customElements.get("fx-insert")||window.customElements.define("fx-insert",Jl);class Kl extends Gl{constructor(){super(),this.attachShadow({mode:"open"})}static get properties(){return{...Gl.properties,modelItem:void 0,messageTextContent:{type:String,get value(){return"here!"}}}}connectedCallback(){super.connectedCallback(),this.event=this.hasAttribute("event")?this.getAttribute("event"):"",this.level=this.hasAttribute("level")?this.getAttribute("level"):"ephemeral",this.message="",this.messageTextContent=this.textContent;this.shadowRoot.innerHTML=`\n        <style>\n            \n        :host{\n            display:none;\n        }\n    \n        </style>\n        ${this.renderHTML()}\n    `}renderHTML(){return"\n        <slot></slot>\n    "}async perform(){super.perform(),this.hasAttribute("value")?this.message=this._getValue():(this.getOwnerForm().evaluateTemplateExpression(this.messageTextContent,this.firstChild),this.message=this.textContent),this.dispatchEvent(new CustomEvent("message",{composed:!1,bubbles:!0,detail:{level:this.level,message:this.message}}))}_getValue(){if(this.hasAttribute("value")){const e=this.getAttribute("value");try{return Xa(e,qa(this,e),this)}catch(e){Ga.dispatch(this,"error",{message:e})}}return this.textContent?this.textContent:null}}customElements.get("fx-message")||window.customElements.define("fx-message",Kl);class eh extends Gl{static get properties(){return{...super.properties,ref:{type:String},valueAttr:{type:String}}}constructor(){super(),this.ref="",this.valueAttr=""}connectedCallback(){if(super.connectedCallback&&super.connectedCallback(),!this.hasAttribute("ref"))throw new Error('fx-setvalue must specify a "ref" attribute');this.ref=this.getAttribute("ref"),this.valueAttr=this.getAttribute("value")}async perform(){super.perform();let{value:e}=this;null!==this.valueAttr?[e]=Ra(this.valueAttr,this.nodeset,this,this.detail):e=""!==this.textContent?this.textContent:"",e?.nodeType&&e.nodeType===Node.ATTRIBUTE_NODE&&(e=e.nodeValue);const t=this.getModelItem();this.setValue(t,e)}dispatchExecute(){}setValue(e,t){const n=e;if(n&&n.value!==t){const i=Ga.getDomNodeIndexString(e.node),r=this.event,s=this;this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:s,event:r,value:t,path:i}})),t?.nodeType?(t.nodeType===Node.ELEMENT_NODE&&(n.value=t),t.nodeType===Node.ATTRIBUTE_NODE&&(n.value=t.getValue()),t.nodeType===Node.TEXT_NODE&&(n.value=t.textContent)):(n.value=t,n.node.textContent=t),this.getModel().changed.push(e),this.needsUpdate=!0}}}customElements.get("fx-setvalue")||window.customElements.define("fx-setvalue",eh);class th extends Gl{constructor(){super(),this.value="",this.url=null,this.target=null}connectedCallback(){super.connectedCallback(),this.submission=this.getAttribute("submission"),this.url=this.hasAttribute("url")?this.getAttribute("url"):null,this.target=this.hasAttribute("target")?this.getAttribute("target"):null,this.connection=this.hasAttribute("connection")?this.getAttribute("connection"):null}async perform(){if(super.perform(),this.getOwnerForm().classList.remove("submit-validation-failed"),this.connection){return null===this.getModel().querySelector(`#${this.connection}`)?void this.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,cancelable:!0,detail:{id:this.id,origin:this,message:`<fx-connection id="${this.connection}"> not found`,expr:va.getDocPath(this),level:"Error"}})):void this._emitToChannel()}const e=this.getModel().querySelector(`#${this.submission}`);if(null!==e){if(this.url){const t=this.evaluateAttributeTemplateExpression(this.url,this);e.parameters.set("url",t)}if(this.target){const t=this.evaluateAttributeTemplateExpression(this.target,this);e.parameters.set("target",t)}await e.submit(),"instance"===e.replace&&(this.getModel().updateModel(),this.getOwnerForm().refresh())}else this.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,cancelable:!0,detail:{id:this.id,origin:this,message:`<fx-submission id="${this.submission}"> not found`,expr:va.getDocPath(this),level:"Error"}}))}_emitToChannel(){const e=this.getModel().querySelector(`#${this.connection}`);null!==e&&e.send()}}customElements.get("fx-send")||window.customElements.define("fx-send",th);class nh extends Gl{connectedCallback(){super.connectedCallback(),this.hasAttribute("case")&&(this.case=this.getAttribute("case"))}async perform(){if(super.perform(),this.case){const e=this.getOwnerForm().querySelector(`#${this.case}`);if(!e)return void Ga.dispatch(this,"error",{message:`fx-case id not found: ${this.case}`});e.parentNode.toggle(e)}this.needsUpdate=!0}}customElements.get("fx-toggle")||window.customElements.define("fx-toggle",nh);class ih extends Gl{static get properties(){return{...super.properties,name:{type:String},targetid:{type:String},details:{type:String}}}constructor(){super(),this.name=null,this.targetid=null,this.details=null,this.attachShadow({mode:"open"})}connectedCallback(){if(super.connectedCallback(),this.name=this.getAttribute("name"),!this.name)throw new Error("no event specified for dispatch",this);this.targetid=this.hasAttribute("targetid")?this.getAttribute("targetid"):null}async perform(){super.perform();const e=this.querySelectorAll("fx-property"),t={};if(Array.from(e).forEach((e=>{const n=e.getAttribute("name"),i=e.getAttribute("value"),r=e.getAttribute("expr");if(r){if(i)throw new Error('if "expr" is given there must not be a "value" attribute');const[e]=Ra(r,this.getInScopeContext(),this);let s=null;if(e.nodeName){s=(new XMLSerializer).serializeToString(e)}t[n]=s||e}i&&(t[n]=i)})),this.targetid){let e=Ea(this.targetid,this.parentNode,null);if(e||(e=document.getElementById(this.targetid)),!e)throw new Error(`targetid ${this.targetid} does not exist in document`);e.dispatchEvent(new CustomEvent(this.name,{composed:!0,bubbles:!0,detail:t}))}else document.dispatchEvent(new CustomEvent(this.name,{composed:!0,bubbles:!0,detail:t}))}}customElements.get("fx-dispatch")||window.customElements.define("fx-dispatch",ih);class rh extends Gl{async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}})),this.getModel().updateModel()}}customElements.get("fx-update")||window.customElements.define("fx-update",rh);class sh extends Gl{async perform(){if(this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}})),this.hasAttribute("self")){const e=va.getClosest("fx-control",this);if(e)return void e.refresh()}if(this.hasAttribute("force"))this.getOwnerForm().forceRefresh();else if(this.hasAttribute("control")){const e=Ea(this.getAttribute("control"),this);e&&Ga.isUiElement(e.nodeName)&&"function"==typeof e.refresh&&e.refresh()}else this.getOwnerForm().refresh()}}customElements.get("fx-refresh")||window.customElements.define("fx-refresh",sh);class oh extends Gl{static get properties(){return{...super.properties,with:{type:String},replaceNode:Object}}constructor(){super(),this.with=""}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.with=this.getAttribute("with")}async perform(){super.perform();const e=Ma(this.with,this.nodeset,this);e&&this.replace(this.nodeset,e)}actionPerformed(){this.getModel().rebuild(),super.actionPerformed()}replace(e,t){if(e&&t&&e.nodeName&&t.nodeName){if(e.nodeType===Node.ATTRIBUTE_NODE){const{ownerElement:n}=e;n.setAttribute(t.nodeName,t.textContent),n.removeAttribute(e.nodeName)}else if(e.nodeType===Node.ELEMENT_NODE){const n=t.cloneNode(!0);e.replaceWith(n)}this.needsUpdate=!0}}}customElements.get("fx-replace")||window.customElements.define("fx-replace",oh);class ah extends Gl{connectedCallback(){super.connectedCallback&&super.connectedCallback()}async perform(){super.perform();const e=new CustomEvent("return",{composed:!0,bubbles:!0,detail:{nodeset:this.nodeset}});this.getOwnerForm().dispatchEvent(e)}}customElements.get("fx-return")||window.customElements.define("fx-return",ah);class lh extends Gl{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.src=this.hasAttribute("src")?this.getAttribute("src"):null;this.shadowRoot.innerHTML="\n        <style>\n            \n        :host{\n            display:none;\n        }\n    \n        </style>\n        <slot></slot>\n    "}async perform(){super.perform();const{children:e}=this;if(this.src){this.innerHTML="";const e=document.createElement("script");e.src=this.src,this.appendChild(e)}else{for(const t of e){if("fx-var"===t.localName)continue;const e=t;e.detail=this.detail,await e.execute()}this.dispatchActionPerformed(),this.needsUpdate=!0}}}customElements.get("fx-action")||window.customElements.define("fx-action",lh);class hh extends lh{static get properties(){return{...lh.properties,message:{type:String}}}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.message=this.hasAttribute("message")?this.getAttribute("message"):null}async perform(){window.confirm(this.message)&&await super.perform()}}customElements.get("fx-confirm")||window.customElements.define("fx-confirm",hh);class ch extends lh{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.dialog=this.getAttribute("dialog"),this.dialog||Ga.dispatch(this,"error",{message:"dialog does not exist"})}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}}));const e=Ea(this.dialog,this);e.open(),Ga.dispatch(e,"dialog-shown",{})}}customElements.get("fx-show")||window.customElements.define("fx-show",ch);class uh extends Gl{static get properties(){return{...super.properties,dialog:{type:String}}}connectedCallback(){super.connectedCallback(),this.dialog=this.getAttribute("dialog"),this.dialog||Ga.dispatch(this,"error",{message:"dialog does not exist"})}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}}));const e=Ea(this.dialog,this);e.hide(),Ga.dispatch(e,"dialog-hidden",{})}}customElements.get("fx-hide")||window.customElements.define("fx-hide",uh);class dh extends Gl{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.addEventListener("reload",(()=>{window.location.reload()}),{once:!0})}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}})),Ga.dispatch(this,"reload",{})}}customElements.get("fx-reload")||window.customElements.define("fx-reload",dh);class ph extends Gl{static get properties(){return{...super.properties,instance:{type:String}}}connectedCallback(){super.connectedCallback(),this.instance=this.getAttribute("instance"),this.instance||Ga.dispatch(this,"error",{message:"instance does not exist"})}async perform(){this.dispatchEvent(new CustomEvent("execute-action",{composed:!0,bubbles:!0,cancelable:!0,detail:{action:this,event:this.event}}));this.getModel().getInstance(this.instance).reset(),this.needsUpdate=!0}}customElements.get("fx-reset")||window.customElements.define("fx-reset",ph);class fh extends Gl{static get properties(){return{...super.properties,attachTo:{type:String},url:{type:String}}}constructor(){super(),this.attachShadow({mode:"open"}),this.url=""}connectedCallback(){super.connectedCallback(),this.attachTo=this.hasAttribute("attach-to")?this.getAttribute("attach-to"):"_self",this.awaitEvent=this.hasAttribute("await")?this.getAttribute("await"):"",this.url=this.hasAttribute("url")?this.getAttribute("url"):"";this.shadowRoot.innerHTML=`\n            <style>\n                \n            :host{\n                display:none;\n            }\n        \n            </style>\n            ${this.renderHTML()}`}disconnectedCallback(){this.targetElement.removeEventListener(this.event,(e=>this.execute(e)))}renderHTML(){return"\n        <slot></slot>\n    "}async perform(){await super.perform();const e=this.querySelector("template");if(e){const t=e.content.cloneNode(!0),n=document.importNode(t,!0);if(this.attachTo.startsWith("#")){const e=Ea(this.attachTo.substring(1),this);for(;e.firstChild;)e.removeChild(e.firstChild);if(this.awaitEvent){let t;const i=new Promise((e=>{t=e})),r=()=>{t(),e.removeEventListener(this.awaitEvent,r)};return e.appendChild(n),e.addEventListener(this.awaitEvent,r),await i,this.needsUpdate=!0,void Ga.dispatch(this,"loaded",{attachPoint:this.attachTo,content:n})}e.appendChild(n),this.needsUpdate=!0}return void Ga.dispatch(this,"loaded",{})}if(!this.url)return void this.dispatchEvent(new CustomEvent("error",{composed:!1,bubbles:!0,cancelable:!0,detail:{origin:this,message:"neither template element nor Url was specified.",level:"Error"}}));const t=this.evaluateAttributeTemplateExpression(this.url,this);"_blank"===this.attachTo&&window.open(this.url),"_self"===this.attachTo&&(window.location.href=this.url);try{const e=await fetch(t,{method:"GET",mode:"cors",credentials:"same-origin",headers:{"Content-Type":"text/html"}}),n=await e.text();this.attachTo||(this.innerHtml=n),this._attachToElement(n),Ga.dispatch(this,"loaded",{url:this.url})}catch(e){throw new Error(`failed loading data ${e}`)}}_attachToElement(e){let t;if(e.nodeType)t=e;else try{t=(new DOMParser).parseFromString(e,"text/html").firstElementChild}catch(e){Ga.dispatch(this,"error",{message:"parsing of content as HTML failed"})}if(this.attachTo.startsWith("_")||this.attachTo.startsWith("#")||Ga.dispatch(this,"error",{message:'valid values for "attach-to" start with "_" or "#"'}),this.attachTo.startsWith("#")){const e=Ea(this.attachTo.substring(1),this);if(e.innerHTML="",t.querySelector("fx-fore"))return void e.append(t.querySelector("fx-fore").cloneNode(!0));const n=t.querySelector("body").cloneNode(!0);e.appendChild(n.firstElementChild)}}_evaluateUrlExpression(){const e=this.getAttribute("url");if(!e)throw new Error("url not specified");return e.replace(/{[^}]*}/g,(e=>{if("{}"===e)return e;const t=e.substring(1,e.length-1),n=qa(this,t);if(!n)return e;const i=va.getInstanceId(t);i?this.getModel().getInstance(i):this.getModel().getDefaultInstance();try{return Xa(t,n,this,null)}catch(t){return e}}))}}customElements.get("fx-load")||window.customElements.define("fx-load",fh);class mh extends Gl{static get properties(){return{...super.properties,ref:{type:String},valueAttr:{type:String},value:{type:Boolean}}}constructor(){super(),this.ref="",this.valueAttr="",this.value=!1}connectedCallback(){if(super.connectedCallback&&super.connectedCallback(),!this.hasAttribute("ref"))throw new Error('fx-togglealue must specify a "ref" attribute');this.ref=this.getAttribute("ref")}async perform(){super.perform();const e=this.getModelItem();"true"===e.value?e.node.textContent="false":e.node.textContent="true",this.needsUpdate=!0}}customElements.get("fx-toggleboolean")||window.customElements.define("fx-toggleboolean",mh);class gh extends Gl{static get properties(){return{...super.properties,action:{type:String},fn:{type:String}}}constructor(){super(),this.action="",this.fn=""}connectedCallback(){if(super.connectedCallback&&super.connectedCallback(),this.hasAttribute("action"))this.action=this.getAttribute("action");else{if(!this.hasAttribute("function"))throw new Error('fx-call must specify an "action" or "function" attribute');this.fn=this.getAttribute("function")}}async perform(){super.perform(),this.action&&await this._callAction(),this.fn&&this._callFunction()}async _callAction(){const e=document.querySelector(`#${this.action}`);e?await e.perform():Ga.dispatch(this,"error",{origin:this,message:`Action '${this.action}' not found`,expr:va.getDocPath(this),level:"Error"})}_callFunction(){const e=qa(this,"instance()");Ra(this.fn,e,this)}}customElements.get("fx-call")||window.customElements.define("fx-call",gh);class Oh extends Gl{static get properties(){return{...super.properties,ref:{type:String},attrName:{type:String},attrValue:{type:String}}}constructor(){super(),this.ref="",this.attrName="",this.attrValue=""}connectedCallback(){if(super.connectedCallback&&super.connectedCallback(),!this.hasAttribute("ref"))throw new Error('fx-setvalue must specify a "ref" attribute');this.ref=this.getAttribute("ref"),this.attrName=this.hasAttribute("name")?this.getAttribute("name"):null,this.attrValue=this.hasAttribute("value")?this.getAttribute("value"):"",this.attrName||Ga.dispatch("this","error",{message:"name or value not specified"})}async perform(){super.perform();const e=this.getModelItem();e.node.nodeType===Node.ELEMENT_NODE?(e.node.setAttribute(this.attrName,this.attrValue),this.needsUpdate=!0):Ga.dispatch("this","error",{message:"referenced item is not an element"})}}customElements.get("fx-setattribute")||window.customElements.define("fx-setattribute",Oh);class yh extends lh{connectedCallback(){super.connectedCallback(),"FX-MODEL"===this.parentNode.nodeName?this.parentNode.addEventListener("model-construct-done",(e=>{super.perform()})):Ga.dispatch(this,"error",{message:"parent is not a model"})}}customElements.get("fx-construct-done")||window.customElements.define("fx-construct-done",yh);class vh extends Gl{constructor(){super()}async perform(){this.getOwnerForm().markAsClean()}}function bh(e,t){e.signature;const n=e.type??"text/xpath",i=e.signature.match(/(?:(?<prefix>[a-zA-Z_\-][a-zA-Z0-9_\-]*):)?(?<localName>[a-zA-Z_\-][a-zA-Z0-9_\-]*\s*)\((?<params>(?:[^()]*|\([^()]*\))*)\)\s*(?:as\s+(?<returnType>.*))?/);if(!i)throw new Error(`Function signature ${e.signature} could not be parsed`);const{prefix:r,localName:s,params:o,returnType:a}=i.groups,l="local"!==r&&r?`${r}:${s}`:{namespaceURI:"http://www.w3.org/2005/xquery-local-functions",localName:s};r||Aa.push(s);const h=o?o.split(",").map((e=>{const t=e.match(/(?<variableName>\$[^\s]+)(?:\sas\s(?<varType>[^\s]+))/);if(!t)throw new Error(`Param ${e} could not be parsed`);const{variableName:n,varType:i}=t.groups;return{variableName:n,variableType:i||"item()*"}})):[];switch(n){case"text/javascript":{const n=new Function("_domFacade",...h.map((e=>e.variableName)),"form",e.functionBody);ga(l,h.map((e=>e.variableType)),a||"item()*",((...e)=>n.apply(t.getInScopeContext(),[...e,t.getOwnerForm()])));break}case"text/xquf":case"text/xquery":case"text/xpath":{const i=h.map((e=>sa(e.variableType))),r="text/xpath"===n?"XPath3.1":"text/xquery"===n?"XQuery3.1":"XQueryUpdate3.1",s=(n,...s)=>Ra(e.functionBody,t.getInScopeContext(),t.getOwnerForm(),h.reduce(((e,t,r)=>(e[t.variableName.replace("$","")]=i[r](s[r],n),e)),{}),{language:r});ga(l,h.map((e=>e.variableType)),a||"item()*",s);break}default:throw new Error(`Unexpected mimetype ${n} for function`)}}customElements.get("fx-unmodified")||window.customElements.define("fx-unmodified",vh);class wh extends Ka{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.style.display="none",this.signature=this.hasAttribute("signature")?this.getAttribute("signature"):null,this.type=this.hasAttribute("type")?this.getAttribute("type"):null,this.shadowRoot.innerHTML="<slot></slot>",this.override=this.hasAttribute("override")?this.getAttribute("override"):"true",this.functionBody=this.innerText,bh(this,this)}}customElements.get("fx-function")||customElements.define("fx-function",wh);class xh extends Ka{constructor(){super(),this._resolve=null,this.readyPromise=new Promise((e=>this._resolveLoading=e))}async connectedCallback(){this.style.display="none";const e=this.getAttribute("src"),t=await fetch(e);t.ok;const n=await t.text(),i=(new DOMParser).parseFromString(n,"text/html"),r=Array.from(i.querySelectorAll("fx-function"));for(const e of r){bh({type:e.getAttribute("type"),signature:e.getAttribute("signature"),functionBody:e.innerText},this)}this._resolveLoading(void 0)}}customElements.get("fx-functionlib")||customElements.define("fx-functionlib",xh);class Sh extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.href=""}connectedCallback(){this.href=this.getAttribute("href");const e=`\n            <a href="${this.href}">\n                <div class="logo-corner">\n                    <img class="logo fore" src="/doc/light-blue1.png" alt="Fore">\n                </div>\n            </a>\n        `;this.shadowRoot.innerHTML=`\n            <style>\n                \n          :host {\n            display: block;\n            max-width:100%;\n          }\n          .logo-corner {\n            transform: rotate(-74deg);\n            position: fixed;\n            z-index:100;\n            right: -2.5rem;\n            top: -2.9rem;\n            width: 6rem;\n            height: 5rem;\n            /* background: ghostwhite; */\n            border: thin solid lightsteelblue;\n            background: rgba(255, 255, 255, 0.3);\n            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);\n            backdrop-filter: blur(4.3px);\n            -webkit-backdrop-filter: blur(4.3px);\n            border: 1px solid rgba(255, 255, 255, 0.3);\n            border-top-left-radius: 0.2rem;\n            border:2px solid white;\n        }\n        .logo-corner:hover{\n            // background: ghostwhite;\n            box-shadow: 0 6px 40px rgba(0, 0, 0, 0.7);\n        }\n        \n        .logo-corner .logo {\n            width: 3rem;\n            position: absolute;\n            top: 1.25rem;\n            left: -0.4rem;\n            transform: rotate(75deg);\n        }\n        \n        \n            </style>\n            ${e}\n        `}}customElements.get("fore-corner")||customElements.define("fore-corner",Sh);
